Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 8FC123DD361
	for <lists+linux-stm32@lfdr.de>; Mon,  2 Aug 2021 11:51:51 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 530E9C5AB62;
	Mon,  2 Aug 2021 09:51:51 +0000 (UTC)
Received: from mail-il1-f171.google.com (mail-il1-f171.google.com
 [209.85.166.171])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 0C119C3FAD6
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Sun, 11 Jul 2021 09:49:36 +0000 (UTC)
Received: by mail-il1-f171.google.com with SMTP id w1so13882085ilg.10
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Sun, 11 Jul 2021 02:49:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=UifErnrfUevuKx3Ect53Sj6o6SQ8Ql1Ip98jbngKx/Q=;
 b=Etocc65JEwgE3oPOPzaw8lyjNBlDazm7Pgz3RlSWWPvcuik8qianFQDNeEYSEOb/cI
 pgvSIbaj6BSpImOYQpgvbUWVoIFVYqYUCkjnDYw0aKlnKGY/g5sRrNFzyQXlArcOs0E4
 yg6dCFLG0PzNSenDBzHd68nV6KANHVqO8Rw327aYANqXPpEjmUCS6Qs6vFVC/BrBgr/U
 93rqlAUekeoUMT2o7e9kyxMgwYyIbgztjYD/Dbw+hiyoMfLqA9LhQJUdXPneQqm4xS62
 52sUkS8E0NBKiHQznyBqb5iB9/vcG7827Ne8xQ6u1CWEe9GnmUr4KUt8tX9EnoHmey9l
 Grig==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=UifErnrfUevuKx3Ect53Sj6o6SQ8Ql1Ip98jbngKx/Q=;
 b=C7XqTsetHD1Z4dfOpnsV+Idd0CPJDX2E4ID0lUuEUqLermvvMUMbVYkOhku+hwjyPh
 BGkUY0YEkc8rDEWw1KmOYI3LUf4jlnTSmWWlpuJHP4Vrqo6fsODaoe8oiIDbiq1LBs23
 IFqLpG7gFKiP62h3XVmKf0BMudfLpPEd2SsF/2L+pkjgwjV3af7ZzmUJbemhn6UPxFlU
 x5B82FMl3cmeINzuJg3LKjkCtaYDJRvx8ktVGwBjFFEcHzI3CNRc3yduv+UtiAalSsrg
 mmsf8FqIj0yaRmUOaxkukThpLfAY8kedElRdbK22IQbFZ9+ITCVrkXHbRw9HKEumgz3S
 rwDA==
X-Gm-Message-State: AOAM5339lbW/hmhPECwOlE363kJVPTdJ5eaBbc6l5z/Pia4EMyZqSji0
 opT5krgONkTumZgAVlDEKPEwgNz0omJRNRPzdrI=
X-Google-Smtp-Source: ABdhPJxOBRUGxdKqaBGkLvufjRBcbGXBCFm2ROKfHSkwy8/UVH1cg3hxNygObyCFb2/1QK3tKvhIjxl6v76Jhx0Id6U=
X-Received: by 2002:a05:6e02:106d:: with SMTP id
 q13mr11638142ilj.164.1625996975557; 
 Sun, 11 Jul 2021 02:49:35 -0700 (PDT)
MIME-Version: 1.0
References: <cover.1625471640.git.vilhelm.gray@gmail.com>
 <834dadaa68af74c703f19f8ddcca5512dd1d177e.1625471640.git.vilhelm.gray@gmail.com>
In-Reply-To: <834dadaa68af74c703f19f8ddcca5512dd1d177e.1625471640.git.vilhelm.gray@gmail.com>
From: Syed Nayyar Waris <syednwaris@gmail.com>
Date: Sun, 11 Jul 2021 15:19:20 +0530
Message-ID: <CACG_h5rzvSKZKtxkRpen_G03+B+uFf9rjpcmFZVqrEqb7dNbbg@mail.gmail.com>
To: William Breathitt Gray <vilhelm.gray@gmail.com>
X-Mailman-Approved-At: Mon, 02 Aug 2021 09:51:10 +0000
Cc: kamel.bouhara@bootlin.com, Gwendal Grignou <gwendal@chromium.org>,
 david@lechnology.com, linux-iio@vger.kernel.org,
 patrick.havelange@essensium.com, alexandre.belloni@bootlin.com,
 mcoquelin.stm32@gmail.com,
 Linux Kernel Mailing List <linux-kernel@vger.kernel.org>,
 o.rempel@pengutronix.de, jarkko.nikula@linux.intel.com,
 linux-arm Mailing List <linux-arm-kernel@lists.infradead.org>,
 kernel@pengutronix.de, Dan Carpenter <dan.carpenter@oracle.com>,
 fabrice.gasnier@st.com, linux-stm32@st-md-mailman.stormreply.com,
 Jonathan Cameron <jic23@kernel.org>, alexandre.torgue@st.com
Subject: Re: [Linux-stm32] [PATCH v12 06/17] counter: Internalize sysfs
	interface code
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

T24gTW9uLCBKdWwgNSwgMjAyMSBhdCAxOjQ5IFBNIFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkKPHZp
bGhlbG0uZ3JheUBnbWFpbC5jb20+IHdyb3RlOgo+Cj4gVGhpcyBpcyBhIHJlaW1wbGVtZW50YXRp
b24gb2YgdGhlIEdlbmVyaWMgQ291bnRlciBkcml2ZXIgaW50ZXJmYWNlLgo+IFRoZXJlIGFyZSBu
byBtb2RpZmljYXRpb25zIHRvIHRoZSBDb3VudGVyIHN1YnN5c3RlbSB1c2Vyc3BhY2UgaW50ZXJm
YWNlLAo+IHNvIGV4aXN0aW5nIHVzZXJzcGFjZSBhcHBsaWNhdGlvbnMgc2hvdWxkIGNvbnRpbnVl
IHRvIHJ1biBzZWFtbGVzc2x5Lgo+Cj4gVGhlIHB1cnBvc2Ugb2YgdGhpcyBwYXRjaCBpcyB0byBp
bnRlcm5hbGl6ZSB0aGUgc3lzZnMgaW50ZXJmYWNlIGNvZGUKPiBhbW9uZyB0aGUgdmFyaW91cyBj
b3VudGVyIGRyaXZlcnMgaW50byBhIHNoYXJlZCBtb2R1bGUuIENvdW50ZXIgZHJpdmVycwo+IHBh
c3MgYW5kIHRha2UgZGF0YSBuYXRpdmVseSAoaS5lLiB1OCwgdTY0LCBldGMuKSBhbmQgdGhlIHNo
YXJlZCBjb3VudGVyCj4gbW9kdWxlIGhhbmRsZXMgdGhlIHRyYW5zbGF0aW9uIGJldHdlZW4gdGhl
IHN5c2ZzIGludGVyZmFjZSBhbmQgdGhlCj4gZGV2aWNlIGRyaXZlcnMuIFRoaXMgZ3VhcmFudGVl
cyBhIHN0YW5kYXJkIHVzZXJzcGFjZSBpbnRlcmZhY2UgZm9yIGFsbAo+IGNvdW50ZXIgZHJpdmVy
cywgYW5kIGhlbHBzIGdlbmVyYWxpemUgdGhlIEdlbmVyaWMgQ291bnRlciBkcml2ZXIgQUJJIGlu
Cj4gb3JkZXIgdG8gc3VwcG9ydCB0aGUgR2VuZXJpYyBDb3VudGVyIGNocmRldiBpbnRlcmZhY2Ug
KGludHJvZHVjZWQgaW4gYQo+IHN1YnNlcXVlbnQgcGF0Y2gpIHdpdGhvdXQgc2lnbmlmaWNhbnQg
Y2hhbmdlcyB0byB0aGUgZXhpc3RpbmcgY291bnRlcgo+IGRyaXZlcnMuCj4KPiBOb3RlLCBDb3Vu
dGVyIGRldmljZSByZWdpc3RyYXRpb24gaXMgdGhlIHNhbWUgYXMgYmVmb3JlOiBkcml2ZXJzCj4g
cG9wdWxhdGUgYSBzdHJ1Y3QgY291bnRlcl9kZXZpY2Ugd2l0aCBjb21wb25lbnRzIGFuZCBjYWxs
YmFja3MsIHRoZW4KPiBwYXNzIHRoZSBzdHJ1Y3R1cmUgdG8gdGhlIGRldm1fY291bnRlcl9yZWdp
c3RlciBmdW5jdGlvbi4gSG93ZXZlciwKPiB3aGF0J3MgZGlmZmVyZW50IG5vdyBpcyBob3cgdGhl
IENvdW50ZXIgc3Vic3lzdGVtIGNvZGUgaGFuZGxlcyB0aGlzCj4gcmVnaXN0cmF0aW9uIGludGVy
bmFsbHkuCj4KPiBXaGVyZWFzIGJlZm9yZSBjYWxsYmFja3Mgd291bGQgaW50ZXJhY3QgZGlyZWN0
bHkgd2l0aCBzeXNmcyBkYXRhLCB0aGlzCj4gaW50ZXJhY3Rpb24gaXMgbm93IGFic3RyYWN0ZWQg
YW5kIGluc3RlYWQgY2FsbGJhY2tzIGludGVyYWN0IHdpdGggbmF0aXZlCj4gQyBkYXRhIHR5cGVz
LiBUaGUgY291bnRlcl9jb21wIHN0cnVjdHVyZSBmb3JtcyB0aGUgYmFzaXMgZm9yIENvdW50ZXIK
PiBleHRlbnNpb25zLgo+Cj4gVGhlIGNvdW50ZXItc3lzZnMuYyBmaWxlIGNvbnRhaW5zIHRoZSBj
b2RlIHRvIHBhcnNlIHRocm91Z2ggdGhlCj4gY291bnRlcl9kZXZpY2Ugc3RydWN0dXJlIGFuZCBy
ZWdpc3RlciB0aGUgcmVxdWVzdGVkIGNvbXBvbmVudHMgYW5kCj4gZXh0ZW5zaW9ucy4gQXR0cmli
dXRlcyBhcmUgY3JlYXRlZCBhbmQgcG9wdWxhdGVkIGJhc2VkIG9uIHR5cGUsIHdpdGgKPiByZXNw
ZWN0aXZlIHRyYW5zbGF0aW9uIGZ1bmN0aW9ucyB0byBoYW5kbGUgdGhlIG1hcHBpbmcgYmV0d2Vl
biBzeXNmcyBhbmQKPiB0aGUgY291bnRlciBkcml2ZXIgY2FsbGJhY2tzLgo+Cj4gVGhlIHRyYW5z
bGF0aW9uIHBlcmZvcm1lZCBmb3IgZWFjaCBhdHRyaWJ1dGUgaXMgc3RyYWlnaHRmb3J3YXJkOiB0
aGUKPiBhdHRyaWJ1dGUgdHlwZSBhbmQgZGF0YSBpcyBwYXJzZWQgZnJvbSB0aGUgY291bnRlcl9h
dHRyaWJ1dGUgc3RydWN0dXJlLAo+IHRoZSByZXNwZWN0aXZlIGNvdW50ZXIgZHJpdmVyIHJlYWQv
d3JpdGUgY2FsbGJhY2sgaXMgY2FsbGVkLCBhbmQgc3lzZnMKPiBJL08gaXMgaGFuZGxlZCBiZWZv
cmUgb3IgYWZ0ZXIgdGhlIGRyaXZlciByZWFkL3dyaXRlIGZ1bmN0aW9uIGlzIGNhbGxlZC4KPgo+
IENjOiBTeWVkIE5heXlhciBXYXJpcyA8c3llZG53YXJpc0BnbWFpbC5jb20+Cj4gQ2M6IEphcmtr
byBOaWt1bGEgPGphcmtrby5uaWt1bGFAbGludXguaW50ZWwuY29tPgo+IENjOiBQYXRyaWNrIEhh
dmVsYW5nZSA8cGF0cmljay5oYXZlbGFuZ2VAZXNzZW5zaXVtLmNvbT4KPiBDYzogS2FtZWwgQm91
aGFyYSA8a2FtZWwuYm91aGFyYUBib290bGluLmNvbT4KPiBDYzogRmFicmljZSBHYXNuaWVyIDxm
YWJyaWNlLmdhc25pZXJAc3QuY29tPgo+IENjOiBNYXhpbWUgQ29xdWVsaW4gPG1jb3F1ZWxpbi5z
dG0zMkBnbWFpbC5jb20+Cj4gQ2M6IEFsZXhhbmRyZSBUb3JndWUgPGFsZXhhbmRyZS50b3JndWVA
c3QuY29tPgo+IENjOiBEYW4gQ2FycGVudGVyIDxkYW4uY2FycGVudGVyQG9yYWNsZS5jb20+Cj4g
UmV2aWV3ZWQtYnk6IERhdmlkIExlY2huZXIgPGRhdmlkQGxlY2hub2xvZ3kuY29tPgo+IFRlc3Rl
ZC1ieTogRGF2aWQgTGVjaG5lciA8ZGF2aWRAbGVjaG5vbG9neS5jb20+Cj4gU2lnbmVkLW9mZi1i
eTogV2lsbGlhbSBCcmVhdGhpdHQgR3JheSA8dmlsaGVsbS5ncmF5QGdtYWlsLmNvbT4KPiAtLS0K
PiAgTUFJTlRBSU5FUlMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgMSAtCj4gIGRy
aXZlcnMvY291bnRlci8xMDQtcXVhZC04LmMgICAgICAgICAgICB8ICA0NDkgKysrLS0tLQoKRm9y
IDEwNC1RdWFkLTgsCgpBY2tlZC1ieTogU3llZCBOYXl5YXIgV2FyaXMgPHN5ZWRud2FyaXNAZ21h
aWwuY29tPgoKCj4gIGRyaXZlcnMvY291bnRlci9NYWtlZmlsZSAgICAgICAgICAgICAgICB8ICAg
IDEgKwo+ICBkcml2ZXJzL2NvdW50ZXIvY291bnRlci1jb3JlLmMgICAgICAgICAgfCAgMTQ1ICsr
Kwo+ICBkcml2ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5jICAgICAgICAgfCAgODQ2ICsrKysr
KysrKysrKysKPiAgZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuaCAgICAgICAgIHwgICAx
MyArCj4gIGRyaXZlcnMvY291bnRlci9jb3VudGVyLmMgICAgICAgICAgICAgICB8IDE0OTYgLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0KPiAgZHJpdmVycy9jb3VudGVyL2Z0bS1xdWFkZGVjLmMgICAg
ICAgICAgIHwgICA1NiArLQo+ICBkcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMgICAgICAgICAg
ICAgfCAgMTQ0ICstLQo+ICBkcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5jICAgICAgICAg
fCAgIDYyICstCj4gIGRyaXZlcnMvY291bnRlci9taWNyb2NoaXAtdGNiLWNhcHR1cmUuYyB8ICAg
OTMgKy0KPiAgZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmMgICAgIHwgIDE2MiAr
Ky0KPiAgZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jICAgICAgIHwgIDE0NyArLS0K
PiAgZHJpdmVycy9jb3VudGVyL3RpLWVxZXAuYyAgICAgICAgICAgICAgIHwgIDE4MCArLS0KPiAg
aW5jbHVkZS9saW51eC9jb3VudGVyLmggICAgICAgICAgICAgICAgIHwgIDY1OCArKysrKy0tLS0t
Cj4gIGluY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmggICAgICAgICAgICB8ICAgNDUgLQo+ICAx
NiBmaWxlcyBjaGFuZ2VkLCAxOTIwIGluc2VydGlvbnMoKyksIDI1NzggZGVsZXRpb25zKC0pCj4g
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2NvdW50ZXIvY291bnRlci1jb3JlLmMKPiAgY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmMKPiAgY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmgKPiAgZGVsZXRlIG1v
ZGUgMTAwNjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLmMKPiAgZGVsZXRlIG1vZGUgMTAwNjQ0
IGluY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmgKPgo+IGRpZmYgLS1naXQgYS9NQUlOVEFJTkVS
UyBiL01BSU5UQUlORVJTCj4gaW5kZXggOWJmNTUzZTUzZjBmLi4yY2FjMTUyMTZiYTkgMTAwNjQ0
Cj4gLS0tIGEvTUFJTlRBSU5FUlMKPiArKysgYi9NQUlOVEFJTkVSUwo+IEBAIC00Njg3LDcgKzQ2
ODcsNiBAQCBGOiAgICAgICAgRG9jdW1lbnRhdGlvbi9BQkkvdGVzdGluZy9zeXNmcy1idXMtY291
bnRlcgo+ICBGOiAgICAgRG9jdW1lbnRhdGlvbi9kcml2ZXItYXBpL2dlbmVyaWMtY291bnRlci5y
c3QKPiAgRjogICAgIGRyaXZlcnMvY291bnRlci8KPiAgRjogICAgIGluY2x1ZGUvbGludXgvY291
bnRlci5oCj4gLUY6ICAgICBpbmNsdWRlL2xpbnV4L2NvdW50ZXJfZW51bS5oCj4KPiAgQ1AyNjE1
IEkyQyBEUklWRVIKPiAgTTogICAgIEJlbmNlIENzw7Nrw6FzIDxiZW5jZTk4QHNjaC5ibWUuaHU+
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci8xMDQtcXVhZC04LmMgYi9kcml2ZXJzL2Nv
dW50ZXIvMTA0LXF1YWQtOC5jCj4gaW5kZXggNTI4M2ZmMTI4YzE3Li5kMTE2MWMyN2M0ODggMTAw
NjQ0Cj4gLS0tIGEvZHJpdmVycy9jb3VudGVyLzEwNC1xdWFkLTguYwo+ICsrKyBiL2RyaXZlcnMv
Y291bnRlci8xMDQtcXVhZC04LmMKPiBAQCAtMTE2LDcgKzExNiw3IEBAIHN0YXRpYyBpbnQgcXVh
ZDhfc2lnbmFsX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4KPiAg
c3RhdGljIGludCBxdWFkOF9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyAq
dmFsKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHU2NCAqdmFsKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYg
PSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+
YmFzZSArIDIgKiBjb3VudC0+aWQ7Cj4gQEAgLTE0Nyw3ICsxNDcsNyBAQCBzdGF0aWMgaW50IHF1
YWQ4X2NvdW50X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4KPiAg
c3RhdGljIGludCBxdWFkOF9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHVuc2lnbmVkIGxvbmcg
dmFsKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB1NjQgdmFsKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYg
PSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+
YmFzZSArIDIgKiBjb3VudC0+aWQ7Cj4gQEAgLTE4NywyMiArMTg3LDE2IEBAIHN0YXRpYyBpbnQg
cXVhZDhfY291bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAg
ICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1lbnVtIHF1YWQ4X2NvdW50X2Z1bmN0aW9uIHsKPiAtICAg
ICAgIFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTiA9IDAsCj4gLSAgICAgICBR
VUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gxLAo+IC0gICAgICAgUVVBRDhfQ09VTlRf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YMiwKPiAtICAgICAgIFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FV
QURSQVRVUkVfWDQKPiAtfTsKPiAtCj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rp
b24gcXVhZDhfY291bnRfZnVuY3Rpb25zX2xpc3RbXSA9IHsKPiAtICAgICAgIFtRVUFEOF9DT1VO
VF9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT05dID0gQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJF
Q1RJT04sCj4gLSAgICAgICBbUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV0gPSBD
T1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQSwKPiAtICAgICAgIFtRVUFEOF9DT1VOVF9G
VU5DVElPTl9RVUFEUkFUVVJFX1gyXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9B
LAo+IC0gICAgICAgW1FVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDRdID0gQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Cj4gKyAgICAgICBDT1VOVEVSX0ZVTkNUSU9OX1BVTFNF
X0RJUkVDVElPTiwKPiArICAgICAgIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BLAo+
ICsgICAgICAgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0EsCj4gKyAgICAgICBDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gIH07Cj4KPiAtc3RhdGljIGludCBxdWFkOF9m
dW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50
IHF1YWQ4X2Z1bmN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAq
ZnVuY3Rpb24pCj4gIHsKPiAgICAgICAgIHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50
ZXItPnByaXY7Cj4gICAgICAgICBjb25zdCBpbnQgaWQgPSBjb3VudC0+aWQ7Cj4gQEAgLTIxMiwy
NSArMjA2LDI2IEBAIHN0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAgICAgICAgIGlmIChwcml2LT5xdWFkcmF0dXJlX21vZGVbaWRd
KQo+ICAgICAgICAgICAgICAgICBzd2l0Y2ggKHByaXYtPnF1YWRyYXR1cmVfc2NhbGVbaWRdKSB7
Cj4gICAgICAgICAgICAgICAgIGNhc2UgMDoKPiAtICAgICAgICAgICAgICAgICAgICAgICAqZnVu
Y3Rpb24gPSBRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gxOwo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9B
Owo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgICAgICAgICBjYXNl
IDE6Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgKmZ1bmN0aW9uID0gUVVBRDhfQ09VTlRfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YMjsKPiArICAgICAgICAgICAgICAgICAgICAgICAqZnVuY3Rpb24g
PSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQTsKPiAgICAgICAgICAgICAgICAgICAg
ICAgICBicmVhazsKPiAgICAgICAgICAgICAgICAgY2FzZSAyOgo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICpmdW5jdGlvbiA9IFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ7Cj4g
KyAgICAgICAgICAgICAgICAgICAgICAgKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0Owo+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgICAg
ICAgICB9Cj4gICAgICAgICBlbHNlCj4gLSAgICAgICAgICAgICAgICpmdW5jdGlvbiA9IFFVQUQ4
X0NPVU5UX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTjsKPiArICAgICAgICAgICAgICAgKmZ1bmN0
aW9uID0gQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT047Cj4KPiAgICAgICAgIG11dGV4
X3VubG9jaygmcHJpdi0+bG9jayk7Cj4KPiAgICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3Rh
dGljIGludCBxdWFkOF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgZnVuY3Rpb24p
Cj4gK3N0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBj
b3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgcXVhZDggKmNv
bnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgY29uc3QgaW50IGlkID0gY291bnQt
PmlkOwo+IEBAIC0yNDYsNyArMjQxLDcgQEAgc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl9zZXQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAgICAgbW9kZV9jZmcgPSBwcml2
LT5jb3VudF9tb2RlW2lkXSA8PCAxOwo+ICAgICAgICAgaWRyX2NmZyA9IHByaXYtPmluZGV4X3Bv
bGFyaXR5W2lkXSA8PCAxOwo+Cj4gLSAgICAgICBpZiAoZnVuY3Rpb24gPT0gUVVBRDhfQ09VTlRf
RlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OKSB7Cj4gKyAgICAgICBpZiAoZnVuY3Rpb24gPT0gQ09V
TlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04pIHsKPiAgICAgICAgICAgICAgICAgKnF1YWRy
YXR1cmVfbW9kZSA9IDA7Cj4KPiAgICAgICAgICAgICAgICAgLyogUXVhZHJhdHVyZSBzY2FsaW5n
IG9ubHkgYXZhaWxhYmxlIGluIHF1YWRyYXR1cmUgbW9kZSAqLwo+IEBAIC0yNjIsMTUgKzI1Nywx
NSBAQCBzdGF0aWMgaW50IHF1YWQ4X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gICAgICAgICAgICAgICAgICpxdWFkcmF0dXJlX21vZGUgPSAxOwo+Cj4gICAg
ICAgICAgICAgICAgIHN3aXRjaCAoZnVuY3Rpb24pIHsKPiAtICAgICAgICAgICAgICAgY2FzZSBR
VUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gxOgo+ICsgICAgICAgICAgICAgICBjYXNl
IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BOgo+ICAgICAgICAgICAgICAgICAgICAg
ICAgICpzY2FsZSA9IDA7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgbW9kZV9jZmcgfD0gUVVB
RDhfQ01SX1FVQURSQVRVUkVfWDE7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4g
LSAgICAgICAgICAgICAgIGNhc2UgUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMjoK
PiArICAgICAgICAgICAgICAgY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQToK
PiAgICAgICAgICAgICAgICAgICAgICAgICAqc2NhbGUgPSAxOwo+ICAgICAgICAgICAgICAgICAg
ICAgICAgIG1vZGVfY2ZnIHw9IFFVQUQ4X0NNUl9RVUFEUkFUVVJFX1gyOwo+ICAgICAgICAgICAg
ICAgICAgICAgICAgIGJyZWFrOwo+IC0gICAgICAgICAgICAgICBjYXNlIFFVQUQ4X0NPVU5UX0ZV
TkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gKyAgICAgICAgICAgICAgIGNhc2UgQ09VTlRFUl9GVU5D
VElPTl9RVUFEUkFUVVJFX1g0Ogo+ICAgICAgICAgICAgICAgICAgICAgICAgICpzY2FsZSA9IDI7
Cj4gICAgICAgICAgICAgICAgICAgICAgICAgbW9kZV9jZmcgfD0gUVVBRDhfQ01SX1FVQURSQVRV
UkVfWDQ7Cj4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gQEAgLTI4OSw4ICsyODQs
OSBAQCBzdGF0aWMgaW50IHF1YWQ4X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gICAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRpYyB2b2lkIHF1YWQ4
X2RpcmVjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBlbnVtIGNvdW50ZXJfY291bnRfZGlyZWN0aW9u
ICpkaXJlY3Rpb24pCj4gK3N0YXRpYyBpbnQgcXVhZDhfZGlyZWN0aW9uX3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlvbiAqZGlyZWN0aW9uKQo+ICB7Cj4gICAg
ICAgICBjb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAg
ICAgICAgdW5zaWduZWQgaW50IHVkX2ZsYWc7Cj4gQEAgLTMwMSw3NiArMjk3LDc0IEBAIHN0YXRp
YyB2b2lkIHF1YWQ4X2RpcmVjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+Cj4gICAgICAgICAqZGlyZWN0aW9uID0gKHVkX2ZsYWcpID8gQ09VTlRFUl9DT1VOVF9ESVJF
Q1RJT05fRk9SV0FSRCA6Cj4gICAgICAgICAgICAgICAgIENPVU5URVJfQ09VTlRfRElSRUNUSU9O
X0JBQ0tXQVJEOwo+IC19Cj4KPiAtZW51bSBxdWFkOF9zeW5hcHNlX2FjdGlvbiB7Cj4gLSAgICAg
ICBRVUFEOF9TWU5BUFNFX0FDVElPTl9OT05FID0gMCwKPiAtICAgICAgIFFVQUQ4X1NZTkFQU0Vf
QUNUSU9OX1JJU0lOR19FREdFLAo+IC0gICAgICAgUVVBRDhfU1lOQVBTRV9BQ1RJT05fRkFMTElO
R19FREdFLAo+IC0gICAgICAgUVVBRDhfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUwo+IC19Owo+
ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPgo+ICBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX3N5
bmFwc2VfYWN0aW9uIHF1YWQ4X2luZGV4X2FjdGlvbnNfbGlzdFtdID0gewo+IC0gICAgICAgW1FV
QUQ4X1NZTkFQU0VfQUNUSU9OX05PTkVdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+
IC0gICAgICAgW1FVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0UKPiArICAgICAgIENPVU5URVJfU1lOQVBTRV9BQ1RJT05f
Tk9ORSwKPiArICAgICAgIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gIH07
Cj4KPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBxdWFkOF9zeW5h
cHNlX2FjdGlvbnNfbGlzdFtdID0gewo+IC0gICAgICAgW1FVQUQ4X1NZTkFQU0VfQUNUSU9OX05P
TkVdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+IC0gICAgICAgW1FVQUQ4X1NZTkFQ
U0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VE
R0UsCj4gLSAgICAgICBbUVVBRDhfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFXSA9IENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+IC0gICAgICAgW1FVQUQ4X1NZTkFQU0Vf
QUNUSU9OX0JPVEhfRURHRVNdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4g
KyAgICAgICBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gKyAgICAgICBDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ICsgICAgICAgQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9GQUxMSU5HX0VER0UsCj4gKyAgICAgICBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVMsCj4gIH07Cj4KPiAtc3RhdGljIGludCBxdWFkOF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwg
c3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtICAgICAgIHNpemVfdCAqYWN0aW9u
KQo+ICtzdGF0aWMgaW50IHF1YWQ4X2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVy
X3N5bmFwc2UgKnN5bmFwc2UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGNv
dW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+ICAgICAgICAgc3RydWN0IHF1YWQ4
ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIGludCBlcnI7Cj4gLSAgICAg
ICBzaXplX3QgZnVuY3Rpb24gPSAwOwo+ICsgICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1
bmN0aW9uOwo+ICAgICAgICAgY29uc3Qgc2l6ZV90IHNpZ25hbF9hX2lkID0gY291bnQtPnN5bmFw
c2VzWzBdLnNpZ25hbC0+aWQ7Cj4gICAgICAgICBlbnVtIGNvdW50ZXJfY291bnRfZGlyZWN0aW9u
IGRpcmVjdGlvbjsKPgo+ICAgICAgICAgLyogSGFuZGxlIEluZGV4IHNpZ25hbHMgKi8KPiAgICAg
ICAgIGlmIChzeW5hcHNlLT5zaWduYWwtPmlkID49IDE2KSB7Cj4gICAgICAgICAgICAgICAgIGlm
IChwcml2LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF0pCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgKmFjdGlvbiA9IFFVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19F
REdFOwo+ICAgICAgICAgICAgICAgICBlbHNlCj4gLSAgICAgICAgICAgICAgICAgICAgICAgKmFj
dGlvbiA9IFFVQUQ4X1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPgo+ICAgICAgICAgICAg
ICAgICByZXR1cm4gMDsKPiAgICAgICAgIH0KPgo+IC0gICAgICAgZXJyID0gcXVhZDhfZnVuY3Rp
b25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICsgICAgICAgZXJyID0gcXVhZDhf
ZnVuY3Rpb25fcmVhZChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiAgICAgICAgIGlmIChl
cnIpCj4gICAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4KPiAgICAgICAgIC8qIERlZmF1bHQg
YWN0aW9uIG1vZGUgKi8KPiAtICAgICAgICphY3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9O
T05FOwo+ICsgICAgICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPgo+
ICAgICAgICAgLyogRGV0ZXJtaW5lIGFjdGlvbiBtb2RlIGJhc2VkIG9uIGN1cnJlbnQgY291bnQg
ZnVuY3Rpb24gbW9kZSAqLwo+ICAgICAgICAgc3dpdGNoIChmdW5jdGlvbikgewo+IC0gICAgICAg
Y2FzZSBRVUFEOF9DT1VOVF9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT046Cj4gKyAgICAgICBjYXNl
IENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOgo+ICAgICAgICAgICAgICAgICBpZiAo
c3luYXBzZS0+c2lnbmFsLT5pZCA9PSBzaWduYWxfYV9pZCkKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5H
X0VER0U7Cj4gICAgICAgICAgICAgICAgIHJldHVybiAwOwo+IC0gICAgICAgY2FzZSBRVUFEOF9D
T1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gxOgo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0ZVTkNU
SU9OX1FVQURSQVRVUkVfWDFfQToKPiAgICAgICAgICAgICAgICAgaWYgKHN5bmFwc2UtPnNpZ25h
bC0+aWQgPT0gc2lnbmFsX2FfaWQpIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICBxdWFkOF9k
aXJlY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZGlyZWN0aW9uKTsKPiArICAgICAgICAgICAg
ICAgICAgICAgICBlcnIgPSBxdWFkOF9kaXJlY3Rpb25fcmVhZChjb3VudGVyLCBjb3VudCwgJmRp
cmVjdGlvbik7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycikKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4KPiAgICAgICAgICAgICAgICAgICAg
ICAgICBpZiAoZGlyZWN0aW9uID09IENPVU5URVJfQ09VTlRfRElSRUNUSU9OX0ZPUldBUkQpCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9B
Q1RJT05fUklTSU5HX0VER0U7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqYWN0
aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiAgICAgICAgICAgICAg
ICAgICAgICAgICBlbHNlCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9u
ID0gUVVBRDhfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOwo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19F
REdFOwo+ICAgICAgICAgICAgICAgICB9Cj4gICAgICAgICAgICAgICAgIHJldHVybiAwOwo+IC0g
ICAgICAgY2FzZSBRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gyOgo+ICsgICAgICAg
Y2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQToKPiAgICAgICAgICAgICAgICAg
aWYgKHN5bmFwc2UtPnNpZ25hbC0+aWQgPT0gc2lnbmFsX2FfaWQpCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgKmFjdGlvbiA9IFFVQUQ4X1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9U
SF9FREdFUzsKPiAgICAgICAgICAgICAgICAgcmV0dXJuIDA7Cj4gLSAgICAgICBjYXNlIFFVQUQ4
X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gLSAgICAgICAgICAgICAgICphY3Rpb24g
PSBRVUFEOF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsgICAgICAgY2FzZSBDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gKyAgICAgICAgICAgICAgICphY3Rpb24gPSBDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gICAgICAgICAgICAgICAgIHJldHVybiAw
Owo+ICAgICAgICAgZGVmYXVsdDoKPiAgICAgICAgICAgICAgICAgLyogc2hvdWxkIG5ldmVyIHJl
YWNoIHRoaXMgcGF0aCAqLwo+IEBAIC0zODIsOSArMzc2LDkgQEAgc3RhdGljIGNvbnN0IHN0cnVj
dCBjb3VudGVyX29wcyBxdWFkOF9vcHMgPSB7Cj4gICAgICAgICAuc2lnbmFsX3JlYWQgPSBxdWFk
OF9zaWduYWxfcmVhZCwKPiAgICAgICAgIC5jb3VudF9yZWFkID0gcXVhZDhfY291bnRfcmVhZCwK
PiAgICAgICAgIC5jb3VudF93cml0ZSA9IHF1YWQ4X2NvdW50X3dyaXRlLAo+IC0gICAgICAgLmZ1
bmN0aW9uX2dldCA9IHF1YWQ4X2Z1bmN0aW9uX2dldCwKPiAtICAgICAgIC5mdW5jdGlvbl9zZXQg
PSBxdWFkOF9mdW5jdGlvbl9zZXQsCj4gLSAgICAgICAuYWN0aW9uX2dldCA9IHF1YWQ4X2FjdGlv
bl9nZXQKPiArICAgICAgIC5mdW5jdGlvbl9yZWFkID0gcXVhZDhfZnVuY3Rpb25fcmVhZCwKPiAr
ICAgICAgIC5mdW5jdGlvbl93cml0ZSA9IHF1YWQ4X2Z1bmN0aW9uX3dyaXRlLAo+ICsgICAgICAg
LmFjdGlvbl9yZWFkID0gcXVhZDhfYWN0aW9uX3JlYWQKPiAgfTsKPgo+ICBzdGF0aWMgY29uc3Qg
Y2hhciAqY29uc3QgcXVhZDhfaW5kZXhfcG9sYXJpdHlfbW9kZXNbXSA9IHsKPiBAQCAtMzkzLDcg
KzM4Nyw4IEBAIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9pbmRleF9wb2xhcml0eV9t
b2Rlc1tdID0gewo+ICB9Owo+Cj4gIHN0YXRpYyBpbnQgcXVhZDhfaW5kZXhfcG9sYXJpdHlfZ2V0
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgIHN0cnVjdCBjb3VudGVy
X3NpZ25hbCAqc2lnbmFsLCBzaXplX3QgKmluZGV4X3BvbGFyaXR5KQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiAqaW5kZXhfcG9sYXJpdHkpCj4g
IHsKPiAgICAgICAgIGNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnBy
aXY7Cj4gICAgICAgICBjb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLSAxNjsK
PiBAQCAtNDA0LDcgKzM5OSw4IEBAIHN0YXRpYyBpbnQgcXVhZDhfaW5kZXhfcG9sYXJpdHlfZ2V0
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgfQo+Cj4gIHN0YXRpYyBpbnQgcXVh
ZDhfaW5kZXhfcG9sYXJpdHlfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAt
ICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCBzaXplX3QgaW5kZXhfcG9sYXJp
dHkpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJf
c2lnbmFsICpzaWduYWwsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTMy
IGluZGV4X3BvbGFyaXR5KQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYg
PSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWdu
YWwtPmlkIC0gMTY7Cj4gQEAgLTQyNSwyMCArNDIxLDE0IEBAIHN0YXRpYyBpbnQgcXVhZDhfaW5k
ZXhfcG9sYXJpdHlfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgICAgICAg
IHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4
dCBxdWFkOF9pbmRleF9wb2xfZW51bSA9IHsKPiAtICAgICAgIC5pdGVtcyA9IHF1YWQ4X2luZGV4
X3BvbGFyaXR5X21vZGVzLAo+IC0gICAgICAgLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUocXVhZDhf
aW5kZXhfcG9sYXJpdHlfbW9kZXMpLAo+IC0gICAgICAgLmdldCA9IHF1YWQ4X2luZGV4X3BvbGFy
aXR5X2dldCwKPiAtICAgICAgIC5zZXQgPSBxdWFkOF9pbmRleF9wb2xhcml0eV9zZXQKPiAtfTsK
PiAtCj4gIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9zeW5jaHJvbm91c19tb2Rlc1td
ID0gewo+ICAgICAgICAgIm5vbi1zeW5jaHJvbm91cyIsCj4gICAgICAgICAic3luY2hyb25vdXMi
Cj4gIH07Cj4KPiAgc3RhdGljIGludCBxdWFkOF9zeW5jaHJvbm91c19tb2RlX2dldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwg
KnNpZ25hbCwgc2l6ZV90ICpzeW5jaHJvbm91c19tb2RlKQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIgKnN5bmNocm9ub3VzX21vZGUpCj4g
IHsKPiAgICAgICAgIGNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnBy
aXY7Cj4gICAgICAgICBjb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLSAxNjsK
PiBAQCAtNDQ5LDcgKzQzOSw4IEBAIHN0YXRpYyBpbnQgcXVhZDhfc3luY2hyb25vdXNfbW9kZV9n
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4KPiAgc3RhdGljIGludCBx
dWFkOF9zeW5jaHJvbm91c19tb2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90IHN5bmNocm9u
b3VzX21vZGUpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
Y291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHUzMiBzeW5jaHJvbm91c19tb2RlKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgcXVhZDgg
KmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgY29uc3Qgc2l6ZV90IGNoYW5u
ZWxfaWQgPSBzaWduYWwtPmlkIC0gMTY7Cj4gQEAgLTQ3NiwyMiArNDY3LDE4IEBAIHN0YXRpYyBp
bnQgcXVhZDhfc3luY2hyb25vdXNfbW9kZV9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICAgICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3RydWN0IGNvdW50ZXJf
c2lnbmFsX2VudW1fZXh0IHF1YWQ4X3N5bl9tb2RlX2VudW0gPSB7Cj4gLSAgICAgICAuaXRlbXMg
PSBxdWFkOF9zeW5jaHJvbm91c19tb2RlcywKPiAtICAgICAgIC5udW1faXRlbXMgPSBBUlJBWV9T
SVpFKHF1YWQ4X3N5bmNocm9ub3VzX21vZGVzKSwKPiAtICAgICAgIC5nZXQgPSBxdWFkOF9zeW5j
aHJvbm91c19tb2RlX2dldCwKPiAtICAgICAgIC5zZXQgPSBxdWFkOF9zeW5jaHJvbm91c19tb2Rl
X3NldAo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfZmxvb3JfcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBxdWFk
OF9jb3VudF9mbG9vcl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1NjQgKmZsb29yKQo+ICB7Cj4gICAgICAgICAvKiBPbmx5IGEgZmxvb3Igb2YgMCBpcyBzdXBw
b3J0ZWQgKi8KPiAtICAgICAgIHJldHVybiBzcHJpbnRmKGJ1ZiwgIjBcbiIpOwo+ICsgICAgICAg
KmZsb29yID0gMDsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRpYyBpbnQg
cXVhZDhfY291bnRfbW9kZV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0g
ICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgKmNudF9tb2RlKQo+ICtz
dGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gY291
bnRlcl9jb3VudF9tb2RlICpjbnRfbW9kZSkKPiAgewo+ICAgICAgICAgY29uc3Qgc3RydWN0IHF1
YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPgo+IEBAIC01MTQsMjYgKzUwMSwyOCBA
QCBzdGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAgICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIGludCBxdWFkOF9j
b3VudF9tb2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCBjbnRfbW9kZSkKPiArc3RhdGljIGlu
dCBxdWFkOF9jb3VudF9tb2RlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGNvdW50ZXJf
Y291bnRfbW9kZSBjbnRfbW9kZSkKPiAgewo+ICAgICAgICAgc3RydWN0IHF1YWQ4ICpjb25zdCBw
cml2ID0gY291bnRlci0+cHJpdjsKPiArICAgICAgIHVuc2lnbmVkIGludCBjb3VudF9tb2RlOwo+
ICAgICAgICAgdW5zaWduZWQgaW50IG1vZGVfY2ZnOwo+ICAgICAgICAgY29uc3QgaW50IGJhc2Vf
b2Zmc2V0ID0gcHJpdi0+YmFzZSArIDIgKiBjb3VudC0+aWQgKyAxOwo+Cj4gICAgICAgICAvKiBN
YXAgR2VuZXJpYyBDb3VudGVyIGNvdW50IG1vZGUgdG8gMTA0LVFVQUQtOCBjb3VudCBtb2RlICov
Cj4gICAgICAgICBzd2l0Y2ggKGNudF9tb2RlKSB7Cj4gICAgICAgICBjYXNlIENPVU5URVJfQ09V
TlRfTU9ERV9OT1JNQUw6Cj4gLSAgICAgICAgICAgICAgIGNudF9tb2RlID0gMDsKPiArICAgICAg
ICAgICAgICAgY291bnRfbW9kZSA9IDA7Cj4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAgICAg
ICAgY2FzZSBDT1VOVEVSX0NPVU5UX01PREVfUkFOR0VfTElNSVQ6Cj4gLSAgICAgICAgICAgICAg
IGNudF9tb2RlID0gMTsKPiArICAgICAgICAgICAgICAgY291bnRfbW9kZSA9IDE7Cj4gICAgICAg
ICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgY2FzZSBDT1VOVEVSX0NPVU5UX01PREVfTk9OX1JF
Q1lDTEU6Cj4gLSAgICAgICAgICAgICAgIGNudF9tb2RlID0gMjsKPiArICAgICAgICAgICAgICAg
Y291bnRfbW9kZSA9IDI7Cj4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgY2FzZSBD
T1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX046Cj4gLSAgICAgICAgICAgICAgIGNudF9tb2RlID0g
MzsKPiArICAgICAgICAgICAgICAgY291bnRfbW9kZSA9IDM7Cj4gICAgICAgICAgICAgICAgIGJy
ZWFrOwo+ICAgICAgICAgZGVmYXVsdDoKPiAgICAgICAgICAgICAgICAgLyogc2hvdWxkIG5ldmVy
IHJlYWNoIHRoaXMgcGF0aCAqLwo+IEBAIC01NDIsMTAgKzUzMSwxMCBAQCBzdGF0aWMgaW50IHF1
YWQ4X2NvdW50X21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPgo+ICAg
ICAgICAgbXV0ZXhfbG9jaygmcHJpdi0+bG9jayk7Cj4KPiAtICAgICAgIHByaXYtPmNvdW50X21v
ZGVbY291bnQtPmlkXSA9IGNudF9tb2RlOwo+ICsgICAgICAgcHJpdi0+Y291bnRfbW9kZVtjb3Vu
dC0+aWRdID0gY291bnRfbW9kZTsKPgo+ICAgICAgICAgLyogU2V0IGNvdW50IG1vZGUgY29uZmln
dXJhdGlvbiB2YWx1ZSAqLwo+IC0gICAgICAgbW9kZV9jZmcgPSBjbnRfbW9kZSA8PCAxOwo+ICsg
ICAgICAgbW9kZV9jZmcgPSBjb3VudF9tb2RlIDw8IDE7Cj4KPiAgICAgICAgIC8qIEFkZCBxdWFk
cmF0dXJlIG1vZGUgY29uZmlndXJhdGlvbiAqLwo+ICAgICAgICAgaWYgKHByaXYtPnF1YWRyYXR1
cmVfbW9kZVtjb3VudC0+aWRdKQo+IEBAIC01NTksNTYgKzU0OCwzNSBAQCBzdGF0aWMgaW50IHF1
YWQ4X2NvdW50X21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgICAg
ICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvdW50X2VudW1f
ZXh0IHF1YWQ4X2NudF9tb2RlX2VudW0gPSB7Cj4gLSAgICAgICAuaXRlbXMgPSBjb3VudGVyX2Nv
dW50X21vZGVfc3RyLAo+IC0gICAgICAgLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUoY291bnRlcl9j
b3VudF9tb2RlX3N0ciksCj4gLSAgICAgICAuZ2V0ID0gcXVhZDhfY291bnRfbW9kZV9nZXQsCj4g
LSAgICAgICAuc2V0ID0gcXVhZDhfY291bnRfbW9kZV9zZXQKPiAtfTsKPiAtCj4gLXN0YXRpYyBz
c2l6ZV90IHF1YWQ4X2NvdW50X2RpcmVjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJp
diwgY2hhciAqYnVmKQo+IC17Cj4gLSAgICAgICBlbnVtIGNvdW50ZXJfY291bnRfZGlyZWN0aW9u
IGRpcjsKPiAtCj4gLSAgICAgICBxdWFkOF9kaXJlY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAm
ZGlyKTsKPiAtCj4gLSAgICAgICByZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291bnRlcl9j
b3VudF9kaXJlY3Rpb25fc3RyW2Rpcl0pOwo+IC19Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBxdWFk
OF9jb3VudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1
ZikKPiArc3RhdGljIGludCBxdWFkOF9jb3VudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4ICplbmFibGUpCj4gIHsKPiAgICAgICAgIGNvbnN0
IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4KPiAtICAgICAgIHJl
dHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBwcml2LT5hYl9lbmFibGVbY291bnQtPmlkXSk7Cj4g
KyAgICAgICAqZW5hYmxlID0gcHJpdi0+YWJfZW5hYmxlW2NvdW50LT5pZF07Cj4gKwo+ICsgICAg
ICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9lbmFibGVf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsIHNpemVf
dCBsZW4pCj4gK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IGVuYWJsZSkKPiAgewo+ICAgICAgICAg
c3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIGNvbnN0
IGludCBiYXNlX29mZnNldCA9IHByaXYtPmJhc2UgKyAyICogY291bnQtPmlkOwo+IC0gICAgICAg
aW50IGVycjsKPiAtICAgICAgIGJvb2wgYWJfZW5hYmxlOwo+ICAgICAgICAgdW5zaWduZWQgaW50
IGlvcl9jZmc7Cj4KPiAtICAgICAgIGVyciA9IGtzdHJ0b2Jvb2woYnVmLCAmYWJfZW5hYmxlKTsK
PiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gLQo+ICAg
ICAgICAgbXV0ZXhfbG9jaygmcHJpdi0+bG9jayk7Cj4KPiAtICAgICAgIHByaXYtPmFiX2VuYWJs
ZVtjb3VudC0+aWRdID0gYWJfZW5hYmxlOwo+ICsgICAgICAgcHJpdi0+YWJfZW5hYmxlW2NvdW50
LT5pZF0gPSBlbmFibGU7Cj4KPiAtICAgICAgIGlvcl9jZmcgPSBhYl9lbmFibGUgfCBwcml2LT5w
cmVzZXRfZW5hYmxlW2NvdW50LT5pZF0gPDwgMTsKPiArICAgICAgIGlvcl9jZmcgPSBlbmFibGUg
fCBwcml2LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF0gPDwgMTsKPgo+ICAgICAgICAgLyogTG9h
ZCBJL08gY29udHJvbCBjb25maWd1cmF0aW9uICovCj4gICAgICAgICBvdXRiKFFVQUQ4X0NUUl9J
T1IgfCBpb3JfY2ZnLCBiYXNlX29mZnNldCArIDEpOwo+Cj4gICAgICAgICBtdXRleF91bmxvY2so
JnByaXYtPmxvY2spOwo+Cj4gLSAgICAgICByZXR1cm4gbGVuOwo+ICsgICAgICAgcmV0dXJuIDA7
Cj4gIH0KPgo+ICBzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgcXVhZDhfbm9pc2VfZXJyb3Jfc3Rh
dGVzW10gPSB7Cj4gQEAgLTYxNyw3ICs1ODUsNyBAQCBzdGF0aWMgY29uc3QgY2hhciAqY29uc3Qg
cXVhZDhfbm9pc2VfZXJyb3Jfc3RhdGVzW10gPSB7Cj4gIH07Cj4KPiAgc3RhdGljIGludCBxdWFk
OF9lcnJvcl9ub2lzZV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgKm5vaXNlX2Vycm9yKQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgdTMyICpub2lzZV9lcnJvcikKPiAgewo+ICAgICAgICAgY29uc3Qgc3RydWN0IHF1YWQ4ICpj
b25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIGNvbnN0IGludCBiYXNlX29mZnNl
dCA9IHByaXYtPmJhc2UgKyAyICogY291bnQtPmlkICsgMTsKPiBAQCAtNjI3LDE4ICs1OTUsMTQg
QEAgc3RhdGljIGludCBxdWFkOF9lcnJvcl9ub2lzZV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICAgICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3RydWN0IGNv
dW50ZXJfY291bnRfZW51bV9leHQgcXVhZDhfZXJyb3Jfbm9pc2VfZW51bSA9IHsKPiAtICAgICAg
IC5pdGVtcyA9IHF1YWQ4X25vaXNlX2Vycm9yX3N0YXRlcywKPiAtICAgICAgIC5udW1faXRlbXMg
PSBBUlJBWV9TSVpFKHF1YWQ4X25vaXNlX2Vycm9yX3N0YXRlcyksCj4gLSAgICAgICAuZ2V0ID0g
cXVhZDhfZXJyb3Jfbm9pc2VfZ2V0Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9j
b3VudF9wcmVzZXRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAg
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikK
PiArc3RhdGljIGludCBxdWFkOF9jb3VudF9wcmVzZXRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqcHJlc2V0KQo+ICB7Cj4gICAgICAgICBjb25zdCBz
dHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+Cj4gLSAgICAgICByZXR1
cm4gc3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+cHJlc2V0W2NvdW50LT5pZF0pOwo+ICsgICAg
ICAgKnByZXNldCA9IHByaXYtPnByZXNldFtjb3VudC0+aWRdOwo+ICsKPiArICAgICAgIHJldHVy
biAwOwo+ICB9Cj4KPiAgc3RhdGljIHZvaWQgcXVhZDhfcHJlc2V0X3JlZ2lzdGVyX3NldChzdHJ1
Y3QgcXVhZDggKmNvbnN0IHByaXYsIGNvbnN0IGludCBpZCwKPiBAQCAtNjU3LDE2ICs2MjEsMTAg
QEAgc3RhdGljIHZvaWQgcXVhZDhfcHJlc2V0X3JlZ2lzdGVyX3NldChzdHJ1Y3QgcXVhZDggKmNv
bnN0IHByaXYsIGNvbnN0IGludCBpZCwKPiAgICAgICAgICAgICAgICAgb3V0YihwcmVzZXQgPj4g
KDggKiBpKSwgYmFzZV9vZmZzZXQpOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291
bnRfcHJlc2V0X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAq
YnVmLCBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50X3ByZXNldF93cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgcHJlc2V0KQo+ICB7
Cj4gICAgICAgICBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+IC0g
ICAgICAgdW5zaWduZWQgaW50IHByZXNldDsKPiAtICAgICAgIGludCByZXQ7Cj4gLQo+IC0gICAg
ICAgcmV0ID0ga3N0cnRvdWludChidWYsIDAsICZwcmVzZXQpOwo+IC0gICAgICAgaWYgKHJldCkK
PiAtICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPgo+ICAgICAgICAgLyogT25seSAyNC1iaXQg
dmFsdWVzIGFyZSBzdXBwb3J0ZWQgKi8KPiAgICAgICAgIGlmIChwcmVzZXQgPiAweEZGRkZGRikK
PiBAQCAtNjc4LDExICs2MzYsMTEgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfcHJlc2V0
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPgo+ICAgICAgICAgbXV0ZXhf
dW5sb2NrKCZwcml2LT5sb2NrKTsKPgo+IC0gICAgICAgcmV0dXJuIGxlbjsKPiArICAgICAgIHJl
dHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfY2VpbGluZ19yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHF1
YWQ4X2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB1NjQgKmNlaWxpbmcpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBxdWFkOCAqY29uc3Qg
cHJpdiA9IGNvdW50ZXItPnByaXY7Cj4KPiBAQCAtNjkyLDI2ICs2NTAsMjMgQEAgc3RhdGljIHNz
aXplX3QgcXVhZDhfY291bnRfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAgICAgICAgIHN3aXRjaCAocHJpdi0+Y291bnRfbW9kZVtjb3VudC0+aWRdKSB7Cj4g
ICAgICAgICBjYXNlIDE6Cj4gICAgICAgICBjYXNlIDM6Cj4gLSAgICAgICAgICAgICAgIG11dGV4
X3VubG9jaygmcHJpdi0+bG9jayk7Cj4gLSAgICAgICAgICAgICAgIHJldHVybiBzcHJpbnRmKGJ1
ZiwgIiV1XG4iLCBwcml2LT5wcmVzZXRbY291bnQtPmlkXSk7Cj4gKyAgICAgICAgICAgICAgICpj
ZWlsaW5nID0gcHJpdi0+cHJlc2V0W2NvdW50LT5pZF07Cj4gKyAgICAgICAgICAgICAgIGJyZWFr
Owo+ICsgICAgICAgZGVmYXVsdDoKPiArICAgICAgICAgICAgICAgLyogQnkgZGVmYXVsdCAweDFG
RkZGRkYgKDI1IGJpdHMgdW5zaWduZWQpIGlzIG1heGltdW0gY291bnQgKi8KPiArICAgICAgICAg
ICAgICAgKmNlaWxpbmcgPSAweDFGRkZGRkY7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICAg
ICAgICAgfQo+Cj4gICAgICAgICBtdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+Cj4gLSAgICAg
ICAvKiBCeSBkZWZhdWx0IDB4MUZGRkZGRiAoMjUgYml0cyB1bnNpZ25lZCkgaXMgbWF4aW11bSBj
b3VudCAqLwo+IC0gICAgICAgcmV0dXJuIHNwcmludGYoYnVmLCAiMzM1NTQ0MzFcbiIpOwo+ICsg
ICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9jZWls
aW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAqYnVmLCBz
aXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50X2NlaWxpbmdfd3JpdGUoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCBjZWlsaW5nKQo+ICB7Cj4g
ICAgICAgICBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+IC0gICAg
ICAgdW5zaWduZWQgaW50IGNlaWxpbmc7Cj4gLSAgICAgICBpbnQgcmV0Owo+IC0KPiAtICAgICAg
IHJldCA9IGtzdHJ0b3VpbnQoYnVmLCAwLCAmY2VpbGluZyk7Cj4gLSAgICAgICBpZiAocmV0KQo+
IC0gICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+Cj4gICAgICAgICAvKiBPbmx5IDI0LWJpdCB2
YWx1ZXMgYXJlIHN1cHBvcnRlZCAqLwo+ICAgICAgICAgaWYgKGNlaWxpbmcgPiAweEZGRkZGRikK
PiBAQCAtNzI1LDcgKzY4MCw3IEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2NlaWxpbmdf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAgICAgY2FzZSAzOgo+
ICAgICAgICAgICAgICAgICBxdWFkOF9wcmVzZXRfcmVnaXN0ZXJfc2V0KHByaXYsIGNvdW50LT5p
ZCwgY2VpbGluZyk7Cj4gICAgICAgICAgICAgICAgIG11dGV4X3VubG9jaygmcHJpdi0+bG9jayk7
Cj4gLSAgICAgICAgICAgICAgIHJldHVybiBsZW47Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAw
Owo+ICAgICAgICAgfQo+Cj4gICAgICAgICBtdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+IEBA
IC03MzMsMjcgKzY4OCwyNSBAQCBzdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9jZWlsaW5nX3dy
aXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgICAgICAgIHJldHVybiAtRUlO
VkFMOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfcHJlc2V0X2VuYWJsZV9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50
IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHU4ICpwcmVzZXRfZW5hYmxlKQo+ICB7Cj4gICAgICAgICBjb25zdCBzdHJ1Y3Qg
cXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+Cj4gLSAgICAgICByZXR1cm4gc3By
aW50ZihidWYsICIldVxuIiwgIXByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlkXSk7Cj4gKyAg
ICAgICAqcHJlc2V0X2VuYWJsZSA9ICFwcml2LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF07Cj4g
Kwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3Vu
dF9wcmVzZXRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAt
ICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY29uc3Qg
Y2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50X3ByZXNldF9l
bmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU4IHByZXNl
dF9lbmFibGUpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50
ZXItPnByaXY7Cj4gICAgICAgICBjb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsg
MiAqIGNvdW50LT5pZCArIDE7Cj4gLSAgICAgICBib29sIHByZXNldF9lbmFibGU7Cj4gLSAgICAg
ICBpbnQgcmV0Owo+ICAgICAgICAgdW5zaWduZWQgaW50IGlvcl9jZmc7Cj4KPiAtICAgICAgIHJl
dCA9IGtzdHJ0b2Jvb2woYnVmLCAmcHJlc2V0X2VuYWJsZSk7Cj4gLSAgICAgICBpZiAocmV0KQo+
IC0gICAgICAgICAgICAgICByZXR1cm4gcmV0Owo+IC0KPiAgICAgICAgIC8qIFByZXNldCBlbmFi
bGUgaXMgYWN0aXZlIGxvdyBpbiBJbnB1dC9PdXRwdXQgQ29udHJvbCByZWdpc3RlciAqLwo+ICAg
ICAgICAgcHJlc2V0X2VuYWJsZSA9ICFwcmVzZXRfZW5hYmxlOwo+Cj4gQEAgLTc2MSwyNSArNzE0
LDI0IEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+Cj4gICAgICAgICBwcml2LT5wcmVzZXRfZW5h
YmxlW2NvdW50LT5pZF0gPSBwcmVzZXRfZW5hYmxlOwo+Cj4gLSAgICAgICBpb3JfY2ZnID0gcHJp
di0+YWJfZW5hYmxlW2NvdW50LT5pZF0gfCAodW5zaWduZWQgaW50KXByZXNldF9lbmFibGUgPDwg
MTsKPiArICAgICAgIGlvcl9jZmcgPSBwcml2LT5hYl9lbmFibGVbY291bnQtPmlkXSB8IHByZXNl
dF9lbmFibGUgPDwgMTsKPgo+ICAgICAgICAgLyogTG9hZCBJL08gY29udHJvbCBjb25maWd1cmF0
aW9uIHRvIElucHV0IC8gT3V0cHV0IENvbnRyb2wgUmVnaXN0ZXIgKi8KPiAgICAgICAgIG91dGIo
UVVBRDhfQ1RSX0lPUiB8IGlvcl9jZmcsIGJhc2Vfb2Zmc2V0KTsKPgo+ICAgICAgICAgbXV0ZXhf
dW5sb2NrKCZwcml2LT5sb2NrKTsKPgo+IC0gICAgICAgcmV0dXJuIGxlbjsKPiArICAgICAgIHJl
dHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0
X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFs
LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnBy
aXZhdGUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU4ICpjYWJsZV9mYXVsdCkK
PiAgewo+ICAgICAgICAgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsK
PiAgICAgICAgIGNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAvIDI7Cj4gICAg
ICAgICBib29sIGRpc2FibGVkOwo+ICAgICAgICAgdW5zaWduZWQgaW50IHN0YXR1czsKPiAtICAg
ICAgIHVuc2lnbmVkIGludCBmYXVsdDsKPgo+ICAgICAgICAgbXV0ZXhfbG9jaygmcHJpdi0+bG9j
ayk7Cj4KPiBAQCAtNzk2LDM2ICs3NDgsMzEgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFs
X2NhYmxlX2ZhdWx0X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAg
ICAgbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPgo+ICAgICAgICAgLyogTWFzayByZXNwZWN0
aXZlIGNoYW5uZWwgYW5kIGludmVydCBsb2dpYyAqLwo+IC0gICAgICAgZmF1bHQgPSAhKHN0YXR1
cyAmIEJJVChjaGFubmVsX2lkKSk7Cj4gKyAgICAgICAqY2FibGVfZmF1bHQgPSAhKHN0YXR1cyAm
IEJJVChjaGFubmVsX2lkKSk7Cj4KPiAtICAgICAgIHJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4i
LCBmYXVsdCk7Cj4gKyAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRpYyBzc2l6ZV90IHF1
YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFibGVfcmVhZCgKPiAtICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gLSAg
ICAgICB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgcXVhZDhfc2lnbmFs
X2NhYmxlX2ZhdWx0X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
Y291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1OCAqZW5hYmxlKQo+ICB7Cj4gICAgICAgICBjb25zdCBzdHJ1Y3Qg
cXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgY29uc3Qgc2l6ZV90
IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC8gMjsKPiAtICAgICAgIGNvbnN0IHVuc2lnbmVkIGlu
dCBlbmIgPSAhIShwcml2LT5jYWJsZV9mYXVsdF9lbmFibGUgJiBCSVQoY2hhbm5lbF9pZCkpOwo+
Cj4gLSAgICAgICByZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgZW5iKTsKPiArICAgICAgICpl
bmFibGUgPSAhIShwcml2LT5jYWJsZV9mYXVsdF9lbmFibGUgJiBCSVQoY2hhbm5lbF9pZCkpOwo+
ICsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfc2ln
bmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV93cml0ZSgKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gLSAgICAgICB2
b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQg
cXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1OCBlbmFibGUpCj4gIHsKPiAgICAgICAg
IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gICAgICAgICBjb25z
dCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+IC0gICAgICAgYm9vbCBlbmFi
bGU7Cj4gLSAgICAgICBpbnQgcmV0Owo+ICAgICAgICAgdW5zaWduZWQgaW50IGNhYmxlX2ZhdWx0
X2VuYWJsZTsKPgo+IC0gICAgICAgcmV0ID0ga3N0cnRvYm9vbChidWYsICZlbmFibGUpOwo+IC0g
ICAgICAgaWYgKHJldCkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiAtCj4gICAgICAg
ICBtdXRleF9sb2NrKCZwcml2LT5sb2NrKTsKPgo+ICAgICAgICAgaWYgKGVuYWJsZSkKPiBAQCAt
ODQwLDMxICs3ODcsMjcgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0
X2VuYWJsZV93cml0ZSgKPgo+ICAgICAgICAgbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPgo+
IC0gICAgICAgcmV0dXJuIGxlbjsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGlj
IHNzaXplX3QgcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwg
dm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9mY2tf
cHJlc2NhbGVyX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwg
KnNpZ25hbCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTgg
KnByZXNjYWxlcikKPiAgewo+ICAgICAgICAgY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKPiAtICAgICAgIGNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2ln
bmFsLT5pZCAvIDI7Cj4KPiAtICAgICAgIHJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBwcml2
LT5mY2tfcHJlc2NhbGVyW2NoYW5uZWxfaWRdKTsKPiArICAgICAgICpwcmVzY2FsZXIgPSBwcml2
LT5mY2tfcHJlc2NhbGVyW3NpZ25hbC0+aWQgLyAyXTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsK
PiAgfQo+Cj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgIHN0cnVjdCBjb3VudGVy
X3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsCj4gLSAgICAg
ICBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dy
aXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTggcHJlc2NhbGVy
KQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2
Owo+ICAgICAgICAgY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC8gMjsKPiAg
ICAgICAgIGNvbnN0IGludCBiYXNlX29mZnNldCA9IHByaXYtPmJhc2UgKyAyICogY2hhbm5lbF9p
ZDsKPiAtICAgICAgIHU4IHByZXNjYWxlcjsKPiAtICAgICAgIGludCByZXQ7Cj4gLQo+IC0gICAg
ICAgcmV0ID0ga3N0cnRvdTgoYnVmLCAwLCAmcHJlc2NhbGVyKTsKPiAtICAgICAgIGlmIChyZXQp
Cj4gLSAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4KPiAgICAgICAgIG11dGV4X2xvY2soJnBy
aXYtPmxvY2spOwo+Cj4gQEAgLTg4MCwzMSArODIzLDMwIEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4
X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPgo+ICAgICAgICAgbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPgo+IC0gICAgICAgcmV0
dXJuIGxlbjsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIGNvbnN0IHN0cnVj
dCBjb3VudGVyX3NpZ25hbF9leHQgcXVhZDhfc2lnbmFsX2V4dFtdID0gewo+IC0gICAgICAgewo+
IC0gICAgICAgICAgICAgICAubmFtZSA9ICJjYWJsZV9mYXVsdCIsCj4gLSAgICAgICAgICAgICAg
IC5yZWFkID0gcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQKPiAtICAgICAgIH0sCj4gLSAg
ICAgICB7Cj4gLSAgICAgICAgICAgICAgIC5uYW1lID0gImNhYmxlX2ZhdWx0X2VuYWJsZSIsCj4g
LSAgICAgICAgICAgICAgIC5yZWFkID0gcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV9y
ZWFkLAo+IC0gICAgICAgICAgICAgICAud3JpdGUgPSBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRf
ZW5hYmxlX3dyaXRlCj4gLSAgICAgICB9LAo+IC0gICAgICAgewo+IC0gICAgICAgICAgICAgICAu
bmFtZSA9ICJmaWx0ZXJfY2xvY2tfcHJlc2NhbGVyIiwKPiAtICAgICAgICAgICAgICAgLnJlYWQg
PSBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl9yZWFkLAo+IC0gICAgICAgICAgICAgICAud3Jp
dGUgPSBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl93cml0ZQo+IC0gICAgICAgfQo+ICtzdGF0
aWMgc3RydWN0IGNvdW50ZXJfY29tcCBxdWFkOF9zaWduYWxfZXh0W10gPSB7Cj4gKyAgICAgICBD
T1VOVEVSX0NPTVBfU0lHTkFMX0JPT0woImNhYmxlX2ZhdWx0IiwgcXVhZDhfc2lnbmFsX2NhYmxl
X2ZhdWx0X3JlYWQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCksCj4g
KyAgICAgICBDT1VOVEVSX0NPTVBfU0lHTkFMX0JPT0woImNhYmxlX2ZhdWx0X2VuYWJsZSIsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0
X2VuYWJsZV9yZWFkLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQ4X3Np
Z25hbF9jYWJsZV9mYXVsdF9lbmFibGVfd3JpdGUpLAo+ICsgICAgICAgQ09VTlRFUl9DT01QX1NJ
R05BTF9VOCgiZmlsdGVyX2Nsb2NrX3ByZXNjYWxlciIsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3JlYWQsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dyaXRlKQo+ICB9
Owo+Cj4gLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0IHF1YWQ4X2luZGV4
X2V4dFtdID0gewo+IC0gICAgICAgQ09VTlRFUl9TSUdOQUxfRU5VTSgiaW5kZXhfcG9sYXJpdHki
LCAmcXVhZDhfaW5kZXhfcG9sX2VudW0pLAo+IC0gICAgICAgQ09VTlRFUl9TSUdOQUxfRU5VTV9B
VkFJTEFCTEUoImluZGV4X3BvbGFyaXR5IiwgJnF1YWQ4X2luZGV4X3BvbF9lbnVtKSwKPiAtICAg
ICAgIENPVU5URVJfU0lHTkFMX0VOVU0oInN5bmNocm9ub3VzX21vZGUiLCAmcXVhZDhfc3luX21v
ZGVfZW51bSksCj4gLSAgICAgICBDT1VOVEVSX1NJR05BTF9FTlVNX0FWQUlMQUJMRSgic3luY2hy
b25vdXNfbW9kZSIsICZxdWFkOF9zeW5fbW9kZV9lbnVtKQo+ICtzdGF0aWMgREVGSU5FX0NPVU5U
RVJfRU5VTShxdWFkOF9pbmRleF9wb2xfZW51bSwgcXVhZDhfaW5kZXhfcG9sYXJpdHlfbW9kZXMp
Owo+ICtzdGF0aWMgREVGSU5FX0NPVU5URVJfRU5VTShxdWFkOF9zeW5jaF9tb2RlX2VudW0sIHF1
YWQ4X3N5bmNocm9ub3VzX21vZGVzKTsKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21w
IHF1YWQ4X2luZGV4X2V4dFtdID0gewo+ICsgICAgICAgQ09VTlRFUl9DT01QX1NJR05BTF9FTlVN
KCJpbmRleF9wb2xhcml0eSIsIHF1YWQ4X2luZGV4X3BvbGFyaXR5X2dldCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBxdWFkOF9pbmRleF9wb2xhcml0eV9zZXQsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVhZDhfaW5kZXhfcG9sX2VudW0pLAo+ICsgICAg
ICAgQ09VTlRFUl9DT01QX1NJR05BTF9FTlVNKCJzeW5jaHJvbm91c19tb2RlIiwgcXVhZDhfc3lu
Y2hyb25vdXNfbW9kZV9nZXQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVh
ZDhfc3luY2hyb25vdXNfbW9kZV9zZXQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcXVhZDhfc3luY2hfbW9kZV9lbnVtKSwKPiAgfTsKPgo+ICAjZGVmaW5lIFFVQUQ4X1FVQURf
U0lHTkFMKF9pZCwgX25hbWUpIHsgICAgICAgICAgICAgICAgXAo+IEBAIC05NzMsMzkgKzkxNSwz
MCBAQCBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc3luYXBzZSBxdWFkOF9jb3VudF9zeW5hcHNlc1td
WzNdID0gewo+ICAgICAgICAgUVVBRDhfQ09VTlRfU1lOQVBTRVMoNiksIFFVQUQ4X0NPVU5UX1NZ
TkFQU0VTKDcpCj4gIH07Cj4KPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4
dCBxdWFkOF9jb3VudF9leHRbXSA9IHsKPiAtICAgICAgIHsKPiAtICAgICAgICAgICAgICAgLm5h
bWUgPSAiY2VpbGluZyIsCj4gLSAgICAgICAgICAgICAgIC5yZWFkID0gcXVhZDhfY291bnRfY2Vp
bGluZ19yZWFkLAo+IC0gICAgICAgICAgICAgICAud3JpdGUgPSBxdWFkOF9jb3VudF9jZWlsaW5n
X3dyaXRlCj4gLSAgICAgICB9LAo+IC0gICAgICAgewo+IC0gICAgICAgICAgICAgICAubmFtZSA9
ICJmbG9vciIsCj4gLSAgICAgICAgICAgICAgIC5yZWFkID0gcXVhZDhfY291bnRfZmxvb3JfcmVh
ZAo+IC0gICAgICAgfSwKPiAtICAgICAgIENPVU5URVJfQ09VTlRfRU5VTSgiY291bnRfbW9kZSIs
ICZxdWFkOF9jbnRfbW9kZV9lbnVtKSwKPiAtICAgICAgIENPVU5URVJfQ09VTlRfRU5VTV9BVkFJ
TEFCTEUoImNvdW50X21vZGUiLCAmcXVhZDhfY250X21vZGVfZW51bSksCj4gLSAgICAgICB7Cj4g
LSAgICAgICAgICAgICAgIC5uYW1lID0gImRpcmVjdGlvbiIsCj4gLSAgICAgICAgICAgICAgIC5y
ZWFkID0gcXVhZDhfY291bnRfZGlyZWN0aW9uX3JlYWQKPiAtICAgICAgIH0sCj4gLSAgICAgICB7
Cj4gLSAgICAgICAgICAgICAgIC5uYW1lID0gImVuYWJsZSIsCj4gLSAgICAgICAgICAgICAgIC5y
ZWFkID0gcXVhZDhfY291bnRfZW5hYmxlX3JlYWQsCj4gLSAgICAgICAgICAgICAgIC53cml0ZSA9
IHF1YWQ4X2NvdW50X2VuYWJsZV93cml0ZQo+IC0gICAgICAgfSwKPiAtICAgICAgIENPVU5URVJf
Q09VTlRfRU5VTSgiZXJyb3Jfbm9pc2UiLCAmcXVhZDhfZXJyb3Jfbm9pc2VfZW51bSksCj4gLSAg
ICAgICBDT1VOVEVSX0NPVU5UX0VOVU1fQVZBSUxBQkxFKCJlcnJvcl9ub2lzZSIsICZxdWFkOF9l
cnJvcl9ub2lzZV9lbnVtKSwKPiAtICAgICAgIHsKPiAtICAgICAgICAgICAgICAgLm5hbWUgPSAi
cHJlc2V0IiwKPiAtICAgICAgICAgICAgICAgLnJlYWQgPSBxdWFkOF9jb3VudF9wcmVzZXRfcmVh
ZCwKPiAtICAgICAgICAgICAgICAgLndyaXRlID0gcXVhZDhfY291bnRfcHJlc2V0X3dyaXRlCj4g
LSAgICAgICB9LAo+IC0gICAgICAgewo+IC0gICAgICAgICAgICAgICAubmFtZSA9ICJwcmVzZXRf
ZW5hYmxlIiwKPiAtICAgICAgICAgICAgICAgLnJlYWQgPSBxdWFkOF9jb3VudF9wcmVzZXRfZW5h
YmxlX3JlYWQsCj4gLSAgICAgICAgICAgICAgIC53cml0ZSA9IHF1YWQ4X2NvdW50X3ByZXNldF9l
bmFibGVfd3JpdGUKPiAtICAgICAgIH0KPiArc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9jb3Vu
dF9tb2RlIHF1YWQ4X2NudF9tb2Rlc1tdID0gewo+ICsgICAgICAgQ09VTlRFUl9DT1VOVF9NT0RF
X05PUk1BTCwKPiArICAgICAgIENPVU5URVJfQ09VTlRfTU9ERV9SQU5HRV9MSU1JVCwKPiArICAg
ICAgIENPVU5URVJfQ09VTlRfTU9ERV9OT05fUkVDWUNMRSwKPiArICAgICAgIENPVU5URVJfQ09V
TlRfTU9ERV9NT0RVTE9fTiwKPiArfTsKPiArCj4gK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9BVkFJ
TEFCTEUocXVhZDhfY291bnRfbW9kZV9hdmFpbGFibGUsIHF1YWQ4X2NudF9tb2Rlcyk7Cj4gKwo+
ICtzdGF0aWMgREVGSU5FX0NPVU5URVJfRU5VTShxdWFkOF9lcnJvcl9ub2lzZV9lbnVtLCBxdWFk
OF9ub2lzZV9lcnJvcl9zdGF0ZXMpOwo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAg
cXVhZDhfY291bnRfZXh0W10gPSB7Cj4gKyAgICAgICBDT1VOVEVSX0NPTVBfQ0VJTElORyhxdWFk
OF9jb3VudF9jZWlsaW5nX3JlYWQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdWFk
OF9jb3VudF9jZWlsaW5nX3dyaXRlKSwKPiArICAgICAgIENPVU5URVJfQ09NUF9GTE9PUihxdWFk
OF9jb3VudF9mbG9vcl9yZWFkLCBOVUxMKSwKPiArICAgICAgIENPVU5URVJfQ09NUF9DT1VOVF9N
T0RFKHF1YWQ4X2NvdW50X21vZGVfcmVhZCwgcXVhZDhfY291bnRfbW9kZV93cml0ZSwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1YWQ4X2NvdW50X21vZGVfYXZhaWxhYmxlKSwK
PiArICAgICAgIENPVU5URVJfQ09NUF9ESVJFQ1RJT04ocXVhZDhfZGlyZWN0aW9uX3JlYWQpLAo+
ICsgICAgICAgQ09VTlRFUl9DT01QX0VOQUJMRShxdWFkOF9jb3VudF9lbmFibGVfcmVhZCwgcXVh
ZDhfY291bnRfZW5hYmxlX3dyaXRlKSwKPiArICAgICAgIENPVU5URVJfQ09NUF9DT1VOVF9FTlVN
KCJlcnJvcl9ub2lzZSIsIHF1YWQ4X2Vycm9yX25vaXNlX2dldCwgTlVMTCwKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHF1YWQ4X2Vycm9yX25vaXNlX2VudW0pLAo+ICsgICAgICAg
Q09VTlRFUl9DT01QX1BSRVNFVChxdWFkOF9jb3VudF9wcmVzZXRfcmVhZCwgcXVhZDhfY291bnRf
cHJlc2V0X3dyaXRlKSwKPiArICAgICAgIENPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKHF1YWQ4
X2NvdW50X3ByZXNldF9lbmFibGVfcmVhZCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3JpdGUpLAo+ICB9Owo+Cj4gICNkZWZp
bmUgUVVBRDhfQ09VTlQoX2lkLCBfY250bmFtZSkgeyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgXAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvTWFrZWZpbGUgYi9kcml2
ZXJzL2NvdW50ZXIvTWFrZWZpbGUKPiBpbmRleCAxOTc0MmU2ZjVlM2UuLjFhYjdlMDg3ZmRjMiAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL2Nv
dW50ZXIvTWFrZWZpbGUKPiBAQCAtNCw2ICs0LDcgQEAKPiAgIwo+Cj4gIG9iai0kKENPTkZJR19D
T1VOVEVSKSArPSBjb3VudGVyLm8KPiArY291bnRlci15IDo9IGNvdW50ZXItY29yZS5vIGNvdW50
ZXItc3lzZnMubwo+Cj4gIG9iai0kKENPTkZJR18xMDRfUVVBRF84KSAgICAgICArPSAxMDQtcXVh
ZC04Lm8KPiAgb2JqLSQoQ09ORklHX0lOVEVSUlVQVF9DTlQpICAgICAgICAgICAgKz0gaW50ZXJy
dXB0LWNudC5vCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci9jb3VudGVyLWNvcmUuYyBi
L2RyaXZlcnMvY291bnRlci9jb3VudGVyLWNvcmUuYwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4g
aW5kZXggMDAwMDAwMDAwMDAwLi4xNWY3MzVlZjI5NmUKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIv
ZHJpdmVycy9jb3VudGVyL2NvdW50ZXItY29yZS5jCj4gQEAgLTAsMCArMSwxNDUgQEAKPiArLy8g
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKPiArLyoKPiArICogR2VuZXJpYyBDb3Vu
dGVyIGludGVyZmFjZQo+ICsgKiBDb3B5cmlnaHQgKEMpIDIwMjAgV2lsbGlhbSBCcmVhdGhpdHQg
R3JheQo+ICsgKi8KPiArI2luY2x1ZGUgPGxpbnV4L2NvdW50ZXIuaD4KPiArI2luY2x1ZGUgPGxp
bnV4L2RldmljZS5oPgo+ICsjaW5jbHVkZSA8bGludXgvZXhwb3J0Lmg+Cj4gKyNpbmNsdWRlIDxs
aW51eC9nZnAuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2lkci5oPgo+ICsjaW5jbHVkZSA8bGludXgv
aW5pdC5oPgo+ICsjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Cj4gKwo+ICsjaW5jbHVkZSAiY291
bnRlci1zeXNmcy5oIgo+ICsKPiArLyogUHJvdmlkZXMgYSB1bmlxdWUgSUQgZm9yIGVhY2ggY291
bnRlciBkZXZpY2UgKi8KPiArc3RhdGljIERFRklORV9JREEoY291bnRlcl9pZGEpOwo+ICsKPiAr
c3RhdGljIHZvaWQgY291bnRlcl9kZXZpY2VfcmVsZWFzZShzdHJ1Y3QgZGV2aWNlICpkZXYpCj4g
K3sKPiArICAgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9n
ZXRfZHJ2ZGF0YShkZXYpOwo+ICsKPiArICAgICAgIGNvdW50ZXJfY2hyZGV2X3JlbW92ZShjb3Vu
dGVyKTsKPiArICAgICAgIGlkYV9mcmVlKCZjb3VudGVyX2lkYSwgZGV2LT5pZCk7Cj4gK30KPiAr
Cj4gK3N0YXRpYyBzdHJ1Y3QgZGV2aWNlX3R5cGUgY291bnRlcl9kZXZpY2VfdHlwZSA9IHsKPiAr
ICAgICAgIC5uYW1lID0gImNvdW50ZXJfZGV2aWNlIiwKPiArICAgICAgIC5yZWxlYXNlID0gY291
bnRlcl9kZXZpY2VfcmVsZWFzZSwKPiArfTsKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgYnVzX3R5cGUg
Y291bnRlcl9idXNfdHlwZSA9IHsKPiArICAgICAgIC5uYW1lID0gImNvdW50ZXIiLAo+ICsgICAg
ICAgLmRldl9uYW1lID0gImNvdW50ZXIiLAo+ICt9Owo+ICsKPiArLyoqCj4gKyAqIGNvdW50ZXJf
cmVnaXN0ZXIgLSByZWdpc3RlciBDb3VudGVyIHRvIHRoZSBzeXN0ZW0KPiArICogQGNvdW50ZXI6
ICAgcG9pbnRlciB0byBDb3VudGVyIHRvIHJlZ2lzdGVyCj4gKyAqCj4gKyAqIFRoaXMgZnVuY3Rp
b24gcmVnaXN0ZXJzIGEgQ291bnRlciB0byB0aGUgc3lzdGVtLiBBIHN5c2ZzICJjb3VudGVyIiBk
aXJlY3RvcnkKPiArICogd2lsbCBiZSBjcmVhdGVkIGFuZCBwb3B1bGF0ZWQgd2l0aCBzeXNmcyBh
dHRyaWJ1dGVzIGNvcnJlbGF0aW5nIHdpdGggdGhlCj4gKyAqIENvdW50ZXIgU2lnbmFscywgU3lu
YXBzZXMsIGFuZCBDb3VudHMgcmVzcGVjdGl2ZWx5Lgo+ICsgKi8KPiAraW50IGNvdW50ZXJfcmVn
aXN0ZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+ICt7Cj4gKyAgICAg
ICBzdHJ1Y3QgZGV2aWNlICpjb25zdCBkZXYgPSAmY291bnRlci0+ZGV2Owo+ICsgICAgICAgaW50
IGlkOwo+ICsgICAgICAgaW50IGVycjsKPiArCj4gKyAgICAgICAvKiBBY3F1aXJlIHVuaXF1ZSBJ
RCAqLwo+ICsgICAgICAgaWQgPSBpZGFfYWxsb2MoJmNvdW50ZXJfaWRhLCBHRlBfS0VSTkVMKTsK
PiArICAgICAgIGlmIChpZCA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiBpZDsKPiArCj4g
KyAgICAgICAvKiBDb25maWd1cmUgZGV2aWNlIHN0cnVjdHVyZSBmb3IgQ291bnRlciAqLwo+ICsg
ICAgICAgZGV2LT5pZCA9IGlkOwo+ICsgICAgICAgZGV2LT50eXBlID0gJmNvdW50ZXJfZGV2aWNl
X3R5cGU7Cj4gKyAgICAgICBkZXYtPmJ1cyA9ICZjb3VudGVyX2J1c190eXBlOwo+ICsgICAgICAg
aWYgKGNvdW50ZXItPnBhcmVudCkgewo+ICsgICAgICAgICAgICAgICBkZXYtPnBhcmVudCA9IGNv
dW50ZXItPnBhcmVudDsKPiArICAgICAgICAgICAgICAgZGV2LT5vZl9ub2RlID0gY291bnRlci0+
cGFyZW50LT5vZl9ub2RlOwo+ICsgICAgICAgfQo+ICsgICAgICAgZGV2aWNlX2luaXRpYWxpemUo
ZGV2KTsKPiArICAgICAgIGRldl9zZXRfZHJ2ZGF0YShkZXYsIGNvdW50ZXIpOwo+ICsKPiArICAg
ICAgIC8qIEFkZCBDb3VudGVyIHN5c2ZzIGF0dHJpYnV0ZXMgKi8KPiArICAgICAgIGVyciA9IGNv
dW50ZXJfc3lzZnNfYWRkKGNvdW50ZXIpOwo+ICsgICAgICAgaWYgKGVyciA8IDApCj4gKyAgICAg
ICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfaWQ7Cj4gKwo+ICsgICAgICAgLyogQWRkIGRldmljZSB0
byBzeXN0ZW0gKi8KPiArICAgICAgIGVyciA9IGRldmljZV9hZGQoZGV2KTsKPiArICAgICAgIGlm
IChlcnIgPCAwKQo+ICsgICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX2lkOwo+ICsKPiArICAg
ICAgIHJldHVybiAwOwo+ICsKPiArZXJyX2ZyZWVfaWQ6Cj4gKyAgICAgICBwdXRfZGV2aWNlKGRl
dik7Cj4gKyAgICAgICByZXR1cm4gZXJyOwo+ICt9Cj4gK0VYUE9SVF9TWU1CT0xfR1BMKGNvdW50
ZXJfcmVnaXN0ZXIpOwo+ICsKPiArLyoqCj4gKyAqIGNvdW50ZXJfdW5yZWdpc3RlciAtIHVucmVn
aXN0ZXIgQ291bnRlciBmcm9tIHRoZSBzeXN0ZW0KPiArICogQGNvdW50ZXI6ICAgcG9pbnRlciB0
byBDb3VudGVyIHRvIHVucmVnaXN0ZXIKPiArICoKPiArICogVGhlIENvdW50ZXIgaXMgdW5yZWdp
c3RlcmVkIGZyb20gdGhlIHN5c3RlbS4KPiArICovCj4gK3ZvaWQgY291bnRlcl91bnJlZ2lzdGVy
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiArewo+ICsgICAgICAgaWYg
KCFjb3VudGVyKQo+ICsgICAgICAgICAgICAgICByZXR1cm47Cj4gKwo+ICsgICAgICAgZGV2aWNl
X3VucmVnaXN0ZXIoJmNvdW50ZXItPmRldik7Cj4gK30KPiArRVhQT1JUX1NZTUJPTF9HUEwoY291
bnRlcl91bnJlZ2lzdGVyKTsKPiArCj4gK3N0YXRpYyB2b2lkIGRldm1fY291bnRlcl9yZWxlYXNl
KHZvaWQgKmNvdW50ZXIpCj4gK3sKPiArICAgICAgIGNvdW50ZXJfdW5yZWdpc3Rlcihjb3VudGVy
KTsKPiArfQo+ICsKPiArLyoqCj4gKyAqIGRldm1fY291bnRlcl9yZWdpc3RlciAtIFJlc291cmNl
LW1hbmFnZWQgY291bnRlcl9yZWdpc3Rlcgo+ICsgKiBAZGV2OiAgICAgICBkZXZpY2UgdG8gYWxs
b2NhdGUgY291bnRlcl9kZXZpY2UgZm9yCj4gKyAqIEBjb3VudGVyOiAgIHBvaW50ZXIgdG8gQ291
bnRlciB0byByZWdpc3Rlcgo+ICsgKgo+ICsgKiBNYW5hZ2VkIGNvdW50ZXJfcmVnaXN0ZXIuIFRo
ZSBDb3VudGVyIHJlZ2lzdGVyZWQgd2l0aCB0aGlzIGZ1bmN0aW9uIGlzCj4gKyAqIGF1dG9tYXRp
Y2FsbHkgdW5yZWdpc3RlcmVkIG9uIGRyaXZlciBkZXRhY2guIFRoaXMgZnVuY3Rpb24gY2FsbHMK
PiArICogY291bnRlcl9yZWdpc3RlciBpbnRlcm5hbGx5LiBSZWZlciB0byB0aGF0IGZ1bmN0aW9u
IGZvciBtb3JlIGluZm9ybWF0aW9uLgo+ICsgKgo+ICsgKiBSRVRVUk5TOgo+ICsgKiAwIG9uIHN1
Y2Nlc3MsIG5lZ2F0aXZlIGVycm9yIG51bWJlciBvbiBmYWlsdXJlLgo+ICsgKi8KPiAraW50IGRl
dm1fY291bnRlcl9yZWdpc3RlcihzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gK3sKPiAr
ICAgICAgIGludCBlcnI7Cj4gKwo+ICsgICAgICAgZXJyID0gY291bnRlcl9yZWdpc3Rlcihjb3Vu
dGVyKTsKPiArICAgICAgIGlmIChlcnIgPCAwKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJy
Owo+ICsKPiArICAgICAgIHJldHVybiBkZXZtX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGV2LCBkZXZt
X2NvdW50ZXJfcmVsZWFzZSwgY291bnRlcik7Cj4gK30KPiArRVhQT1JUX1NZTUJPTF9HUEwoZGV2
bV9jb3VudGVyX3JlZ2lzdGVyKTsKPiArCj4gK3N0YXRpYyBpbnQgX19pbml0IGNvdW50ZXJfaW5p
dCh2b2lkKQo+ICt7Cj4gKyAgICAgICByZXR1cm4gYnVzX3JlZ2lzdGVyKCZjb3VudGVyX2J1c190
eXBlKTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgX19leGl0IGNvdW50ZXJfZXhpdCh2b2lkKQo+
ICt7Cj4gKyAgICAgICBidXNfdW5yZWdpc3RlcigmY291bnRlcl9idXNfdHlwZSk7Cj4gK30KPiAr
Cj4gK3N1YnN5c19pbml0Y2FsbChjb3VudGVyX2luaXQpOwo+ICttb2R1bGVfZXhpdChjb3VudGVy
X2V4aXQpOwo+ICsKPiArTU9EVUxFX0FVVEhPUigiV2lsbGlhbSBCcmVhdGhpdHQgR3JheSA8dmls
aGVsbS5ncmF5QGdtYWlsLmNvbT4iKTsKPiArTU9EVUxFX0RFU0NSSVBUSU9OKCJHZW5lcmljIENv
dW50ZXIgaW50ZXJmYWNlIik7Cj4gK01PRFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuYyBiL2RyaXZlcnMvY291bnRlci9j
b3VudGVyLXN5c2ZzLmMKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAw
MC4uMDc1ODgxMzA2MDBhCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL2RyaXZlcnMvY291bnRlci9j
b3VudGVyLXN5c2ZzLmMKPiBAQCAtMCwwICsxLDg0NiBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMAo+ICsvKgo+ICsgKiBHZW5lcmljIENvdW50ZXIgc3lzZnMgaW50ZXJm
YWNlCj4gKyAqIENvcHlyaWdodCAoQykgMjAyMCBXaWxsaWFtIEJyZWF0aGl0dCBHcmF5Cj4gKyAq
Lwo+ICsjaW5jbHVkZSA8bGludXgvY291bnRlci5oPgo+ICsjaW5jbHVkZSA8bGludXgvZGV2aWNl
Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9lcnIuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2dmcC5oPgo+
ICsjaW5jbHVkZSA8bGludXgva2VybmVsLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+Cj4g
KyNpbmNsdWRlIDxsaW51eC9zdHJpbmcuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3N5c2ZzLmg+Cj4g
KyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ICsKPiArI2luY2x1ZGUgImNvdW50ZXItc3lzZnMu
aCIKPiArCj4gKy8qKgo+ICsgKiBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgLSBDb3VudGVyIHN5
c2ZzIGF0dHJpYnV0ZQo+ICsgKiBAZGV2X2F0dHI6ICBkZXZpY2UgYXR0cmlidXRlIGZvciBzeXNm
cwo+ICsgKiBAbDogICAgICAgICBub2RlIHRvIGFkZCBDb3VudGVyIGF0dHJpYnV0ZSB0byBhdHRy
aWJ1dGUgZ3JvdXAgbGlzdAo+ICsgKiBAY29tcDogICAgICBDb3VudGVyIGNvbXBvbmVudCBjYWxs
YmFja3MgYW5kIGRhdGEKPiArICogQHNjb3BlOiAgICAgQ291bnRlciBzY29wZSBvZiB0aGUgYXR0
cmlidXRlCj4gKyAqIEBwYXJlbnQ6ICAgIHBvaW50ZXIgdG8gdGhlIHBhcmVudCBjb21wb25lbnQK
PiArICovCj4gK3N0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSB7Cj4gKyAgICAgICBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSBkZXZfYXR0cjsKPiArICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgbDsKPiAr
Cj4gKyAgICAgICBzdHJ1Y3QgY291bnRlcl9jb21wIGNvbXA7Cj4gKyAgICAgICBlbnVtIGNvdW50
ZXJfc2NvcGUgc2NvcGU7Cj4gKyAgICAgICB2b2lkICpwYXJlbnQ7Cj4gK307Cj4gKwo+ICsjZGVm
aW5lIHRvX2NvdW50ZXJfYXR0cmlidXRlKF9kZXZfYXR0cikgXAo+ICsgICAgICAgY29udGFpbmVy
X29mKF9kZXZfYXR0ciwgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlLCBkZXZfYXR0cikKPiArCj4g
Ky8qKgo+ICsgKiBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgLSBjb250YWluZXIgZm9y
IGF0dHJpYnV0ZSBncm91cAo+ICsgKiBAbmFtZTogICAgICBuYW1lIG9mIHRoZSBhdHRyaWJ1dGUg
Z3JvdXAKPiArICogQGF0dHJfbGlzdDogbGlzdCB0byBrZWVwIHRyYWNrIG9mIGNyZWF0ZWQgYXR0
cmlidXRlcwo+ICsgKiBAbnVtX2F0dHI6ICBudW1iZXIgb2YgYXR0cmlidXRlcwo+ICsgKi8KPiAr
c3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwIHsKPiArICAgICAgIGNvbnN0IGNoYXIgKm5h
bWU7Cj4gKyAgICAgICBzdHJ1Y3QgbGlzdF9oZWFkIGF0dHJfbGlzdDsKPiArICAgICAgIHNpemVf
dCBudW1fYXR0cjsKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCBjaGFyICpjb25zdCBjb3VudGVy
X2Z1bmN0aW9uX3N0cltdID0gewo+ICsgICAgICAgW0NPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0Vd
ID0gImluY3JlYXNlIiwKPiArICAgICAgIFtDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFXSA9ICJk
ZWNyZWFzZSIsCj4gKyAgICAgICBbQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT05dID0g
InB1bHNlLWRpcmVjdGlvbiIsCj4gKyAgICAgICBbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJF
X1gxX0FdID0gInF1YWRyYXR1cmUgeDEgYSIsCj4gKyAgICAgICBbQ09VTlRFUl9GVU5DVElPTl9R
VUFEUkFUVVJFX1gxX0JdID0gInF1YWRyYXR1cmUgeDEgYiIsCj4gKyAgICAgICBbQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1gyX0FdID0gInF1YWRyYXR1cmUgeDIgYSIsCj4gKyAgICAgICBb
Q09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0JdID0gInF1YWRyYXR1cmUgeDIgYiIsCj4g
KyAgICAgICBbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0XSA9ICJxdWFkcmF0dXJlIHg0
Igo+ICt9Owo+ICsKPiArc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfc2lnbmFsX3Zh
bHVlX3N0cltdID0gewo+ICsgICAgICAgW0NPVU5URVJfU0lHTkFMX0xFVkVMX0xPV10gPSAibG93
IiwKPiArICAgICAgIFtDT1VOVEVSX1NJR05BTF9MRVZFTF9ISUdIXSA9ICJoaWdoIgo+ICt9Owo+
ICsKPiArc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfc3luYXBzZV9hY3Rpb25fc3Ry
W10gPSB7Cj4gKyAgICAgICBbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FXSA9ICJub25lIiwK
PiArICAgICAgIFtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9ICJyaXNpbmcg
ZWRnZSIsCj4gKyAgICAgICBbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0VdID0g
ImZhbGxpbmcgZWRnZSIsCj4gKyAgICAgICBbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VE
R0VTXSA9ICJib3RoIGVkZ2VzIgo+ICt9Owo+ICsKPiArc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0
IGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0cltdID0gewo+ICsgICAgICAgW0NPVU5URVJfQ09V
TlRfRElSRUNUSU9OX0ZPUldBUkRdID0gImZvcndhcmQiLAo+ICsgICAgICAgW0NPVU5URVJfQ09V
TlRfRElSRUNUSU9OX0JBQ0tXQVJEXSA9ICJiYWNrd2FyZCIKPiArfTsKPiArCj4gK3N0YXRpYyBj
b25zdCBjaGFyICpjb25zdCBjb3VudGVyX2NvdW50X21vZGVfc3RyW10gPSB7Cj4gKyAgICAgICBb
Q09VTlRFUl9DT1VOVF9NT0RFX05PUk1BTF0gPSAibm9ybWFsIiwKPiArICAgICAgIFtDT1VOVEVS
X0NPVU5UX01PREVfUkFOR0VfTElNSVRdID0gInJhbmdlIGxpbWl0IiwKPiArICAgICAgIFtDT1VO
VEVSX0NPVU5UX01PREVfTk9OX1JFQ1lDTEVdID0gIm5vbi1yZWN5Y2xlIiwKPiArICAgICAgIFtD
T1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX05dID0gIm1vZHVsby1uIgo+ICt9Owo+ICsKPiArc3Rh
dGljIHNzaXplX3QgY291bnRlcl9jb21wX3U4X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLCBjaGFyICpidWYpCj4gK3sKPiArICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX2F0
dHJpYnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsgICAgICAg
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRl
dik7Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsgICAgICAgdTggZGF0YSA9IDA7Cj4gKwo+ICsgICAg
ICAgc3dpdGNoIChhLT5zY29wZSkgewo+ICsgICAgICAgY2FzZSBDT1VOVEVSX1NDT1BFX0RFVklD
RToKPiArICAgICAgICAgICAgICAgZXJyID0gYS0+Y29tcC5kZXZpY2VfdThfcmVhZChjb3VudGVy
LCAmZGF0YSk7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgY2FzZSBDT1VOVEVS
X1NDT1BFX1NJR05BTDoKPiArICAgICAgICAgICAgICAgZXJyID0gYS0+Y29tcC5zaWduYWxfdThf
cmVhZChjb3VudGVyLCBhLT5wYXJlbnQsICZkYXRhKTsKPiArICAgICAgICAgICAgICAgYnJlYWs7
Cj4gKyAgICAgICBjYXNlIENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4gKyAgICAgICAgICAgICAgIGVy
ciA9IGEtPmNvbXAuY291bnRfdThfcmVhZChjb3VudGVyLCBhLT5wYXJlbnQsICZkYXRhKTsKPiAr
ICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBkZWZhdWx0Ogo+ICsgICAgICAgICAgICAg
ICByZXR1cm4gLUVJTlZBTDsKPiArICAgICAgIH0KPiArICAgICAgIGlmIChlcnIgPCAwKQo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsKPiArICAgICAgIGlmIChhLT5jb21wLnR5cGUg
PT0gQ09VTlRFUl9DT01QX0JPT0wpCj4gKyAgICAgICAgICAgICAgIGRhdGEgPSAhIWRhdGE7Cj4g
Kwo+ICsgICAgICAgcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsICh1bnNpZ25lZCBpbnQpZGF0
YSk7Cj4gK30KPiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91OF9zdG9yZShzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3sKPiArICAgICAgIGNv
bnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmli
dXRlKGF0dHIpOwo+ICsgICAgICAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVy
ID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsgICAgICAgYm9v
bCBib29sX2RhdGEgPSAwOwo+ICsgICAgICAgdTggZGF0YSA9IDA7Cj4gKwo+ICsgICAgICAgaWYg
KGEtPmNvbXAudHlwZSA9PSBDT1VOVEVSX0NPTVBfQk9PTCkgewo+ICsgICAgICAgICAgICAgICBl
cnIgPSBrc3RydG9ib29sKGJ1ZiwgJmJvb2xfZGF0YSk7Cj4gKyAgICAgICAgICAgICAgIGRhdGEg
PSBib29sX2RhdGE7Cj4gKyAgICAgICB9IGVsc2UKPiArICAgICAgICAgICAgICAgZXJyID0ga3N0
cnRvdTgoYnVmLCAwLCAmZGF0YSk7Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAg
ICAgICAgcmV0dXJuIGVycjsKPiArCj4gKyAgICAgICBzd2l0Y2ggKGEtPnNjb3BlKSB7Cj4gKyAg
ICAgICBjYXNlIENPVU5URVJfU0NPUEVfREVWSUNFOgo+ICsgICAgICAgICAgICAgICBlcnIgPSBh
LT5jb21wLmRldmljZV91OF93cml0ZShjb3VudGVyLCBkYXRhKTsKPiArICAgICAgICAgICAgICAg
YnJlYWs7Cj4gKyAgICAgICBjYXNlIENPVU5URVJfU0NPUEVfU0lHTkFMOgo+ICsgICAgICAgICAg
ICAgICBlcnIgPSBhLT5jb21wLnNpZ25hbF91OF93cml0ZShjb3VudGVyLCBhLT5wYXJlbnQsIGRh
dGEpOwo+ICsgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIGNhc2UgQ09VTlRFUl9TQ09Q
RV9DT1VOVDoKPiArICAgICAgICAgICAgICAgZXJyID0gYS0+Y29tcC5jb3VudF91OF93cml0ZShj
b3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+ICsgICAgICAgICAgICAgICBicmVhazsKPiArICAg
ICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgICAg
fQo+ICsgICAgICAgaWYgKGVyciA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4g
Kwo+ICsgICAgICAgcmV0dXJuIGxlbjsKPiArfQo+ICsKPiArc3RhdGljIHNzaXplX3QgY291bnRl
cl9jb21wX3UzMl9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1
ZikKPiArewo+ICsgICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlICpjb25zdCBh
ID0gdG9fY291bnRlcl9hdHRyaWJ1dGUoYXR0cik7Cj4gKyAgICAgICBzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiArICAgICAgIGNv
bnN0IHN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSAqY29uc3QgYXZhaWwgPSBhLT5jb21wLnByaXY7
Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsgICAgICAgdTMyIGRhdGEgPSAwOwo+ICsKPiArICAgICAg
IHN3aXRjaCAoYS0+c2NvcGUpIHsKPiArICAgICAgIGNhc2UgQ09VTlRFUl9TQ09QRV9ERVZJQ0U6
Cj4gKyAgICAgICAgICAgICAgIGVyciA9IGEtPmNvbXAuZGV2aWNlX3UzMl9yZWFkKGNvdW50ZXIs
ICZkYXRhKTsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBjYXNlIENPVU5URVJf
U0NPUEVfU0lHTkFMOgo+ICsgICAgICAgICAgICAgICBlcnIgPSBhLT5jb21wLnNpZ25hbF91MzJf
cmVhZChjb3VudGVyLCBhLT5wYXJlbnQsICZkYXRhKTsKPiArICAgICAgICAgICAgICAgYnJlYWs7
Cj4gKyAgICAgICBjYXNlIENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4gKyAgICAgICAgICAgICAgIGlm
IChhLT5jb21wLnR5cGUgPT0gQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OKQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGVyciA9IGEtPmNvbXAuYWN0aW9uX3JlYWQoY291bnRlciwgYS0+cGFy
ZW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YS0+Y29tcC5wcml2LCAmZGF0YSk7Cj4gKyAgICAgICAgICAgICAgIGVsc2UKPiArICAgICAgICAg
ICAgICAgICAgICAgICBlcnIgPSBhLT5jb21wLmNvdW50X3UzMl9yZWFkKGNvdW50ZXIsIGEtPnBh
cmVudCwgJmRhdGEpOwo+ICsgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIGRlZmF1bHQ6
Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgICAgfQo+ICsgICAgICAg
aWYgKGVyciA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gKwo+ICsgICAgICAg
c3dpdGNoIChhLT5jb21wLnR5cGUpIHsKPiArICAgICAgIGNhc2UgQ09VTlRFUl9DT01QX0ZVTkNU
SU9OOgo+ICsgICAgICAgICAgICAgICByZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwgY291
bnRlcl9mdW5jdGlvbl9zdHJbZGF0YV0pOwo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0NPTVBfU0lH
TkFMX0xFVkVMOgo+ICsgICAgICAgICAgICAgICByZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xu
IiwgY291bnRlcl9zaWduYWxfdmFsdWVfc3RyW2RhdGFdKTsKPiArICAgICAgIGNhc2UgQ09VTlRF
Ul9DT01QX1NZTkFQU0VfQUNUSU9OOgo+ICsgICAgICAgICAgICAgICByZXR1cm4gc3lzZnNfZW1p
dChidWYsICIlc1xuIiwgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHJbZGF0YV0pOwo+ICsgICAg
ICAgY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKPiArICAgICAgICAgICAgICAgcmV0dXJuIHN5c2Zz
X2VtaXQoYnVmLCAiJXNcbiIsIGF2YWlsLT5zdHJzW2RhdGFdKTsKPiArICAgICAgIGNhc2UgQ09V
TlRFUl9DT01QX0NPVU5UX0RJUkVDVElPTjoKPiArICAgICAgICAgICAgICAgcmV0dXJuIHN5c2Zz
X2VtaXQoYnVmLCAiJXNcbiIsIGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0cltkYXRhXSk7Cj4g
KyAgICAgICBjYXNlIENPVU5URVJfQ09NUF9DT1VOVF9NT0RFOgo+ICsgICAgICAgICAgICAgICBy
ZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwgY291bnRlcl9jb3VudF9tb2RlX3N0cltkYXRh
XSk7Cj4gKyAgICAgICBkZWZhdWx0Ogo+ICsgICAgICAgICAgICAgICByZXR1cm4gc3ByaW50Zihi
dWYsICIldVxuIiwgKHVuc2lnbmVkIGludClkYXRhKTsKPiArICAgICAgIH0KPiArfQo+ICsKPiAr
c3RhdGljIGludCBjb3VudGVyX2ZpbmRfZW51bSh1MzIgKmNvbnN0IGVudW1faXRlbSwgY29uc3Qg
dTMyICpjb25zdCBlbnVtcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNp
emVfdCBudW1fZW51bXMsIGNvbnN0IGNoYXIgKmNvbnN0IGJ1ZiwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmNvbnN0IHN0cmluZ19hcnJheVtdKQo+ICt7Cj4gKyAg
ICAgICBzaXplX3QgaW5kZXg7Cj4gKwo+ICsgICAgICAgZm9yIChpbmRleCA9IDA7IGluZGV4IDwg
bnVtX2VudW1zOyBpbmRleCsrKSB7Cj4gKyAgICAgICAgICAgICAgICplbnVtX2l0ZW0gPSBlbnVt
c1tpbmRleF07Cj4gKyAgICAgICAgICAgICAgIGlmIChzeXNmc19zdHJlcShidWYsIHN0cmluZ19h
cnJheVsqZW51bV9pdGVtXSkpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7Cj4g
KyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gK30KPiArCj4gK3N0YXRp
YyBzc2l6ZV90IGNvdW50ZXJfY29tcF91MzJfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1
dGUgKmF0dHIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBj
aGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3sKPiArICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVy
X2F0dHJpYnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsgICAg
ICAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRh
KGRldik7Cj4gKyAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBhLT5w
YXJlbnQ7Cj4gKyAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpjb25zdCBzeW5hcHNlID0g
YS0+Y29tcC5wcml2Owo+ICsgICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfYXZhaWxhYmxlICpj
b25zdCBhdmFpbCA9IGEtPmNvbXAucHJpdjsKPiArICAgICAgIGludCBlcnI7Cj4gKyAgICAgICB1
MzIgZGF0YSA9IDA7Cj4gKwo+ICsgICAgICAgc3dpdGNoIChhLT5jb21wLnR5cGUpIHsKPiArICAg
ICAgIGNhc2UgQ09VTlRFUl9DT01QX0ZVTkNUSU9OOgo+ICsgICAgICAgICAgICAgICBlcnIgPSBj
b3VudGVyX2ZpbmRfZW51bSgmZGF0YSwgY291bnQtPmZ1bmN0aW9uc19saXN0LAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudC0+bnVtX2Z1bmN0aW9ucywgYnVm
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyX2Z1bmN0
aW9uX3N0cik7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgY2FzZSBDT1VOVEVS
X0NPTVBfU1lOQVBTRV9BQ1RJT046Cj4gKyAgICAgICAgICAgICAgIGVyciA9IGNvdW50ZXJfZmlu
ZF9lbnVtKCZkYXRhLCBzeW5hcHNlLT5hY3Rpb25zX2xpc3QsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN5bmFwc2UtPm51bV9hY3Rpb25zLCBidWYsCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXJfc3luYXBzZV9hY3Rpb25f
c3RyKTsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBjYXNlIENPVU5URVJfQ09N
UF9FTlVNOgo+ICsgICAgICAgICAgICAgICBlcnIgPSBfX3N5c2ZzX21hdGNoX3N0cmluZyhhdmFp
bC0+c3RycywgYXZhaWwtPm51bV9pdGVtcywgYnVmKTsKPiArICAgICAgICAgICAgICAgZGF0YSA9
IGVycjsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBjYXNlIENPVU5URVJfQ09N
UF9DT1VOVF9NT0RFOgo+ICsgICAgICAgICAgICAgICBlcnIgPSBjb3VudGVyX2ZpbmRfZW51bSgm
ZGF0YSwgYXZhaWwtPmVudW1zLCBhdmFpbC0+bnVtX2l0ZW1zLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBidWYsIGNvdW50ZXJfY291bnRfbW9kZV9zdHIpOwo+ICsg
ICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAgICAgICAg
IGVyciA9IGtzdHJ0b3UzMihidWYsIDAsICZkYXRhKTsKPiArICAgICAgICAgICAgICAgYnJlYWs7
Cj4gKyAgICAgICB9Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAgICAgICAgcmV0
dXJuIGVycjsKPiArCj4gKyAgICAgICBzd2l0Y2ggKGEtPnNjb3BlKSB7Cj4gKyAgICAgICBjYXNl
IENPVU5URVJfU0NPUEVfREVWSUNFOgo+ICsgICAgICAgICAgICAgICBlcnIgPSBhLT5jb21wLmRl
dmljZV91MzJfd3JpdGUoY291bnRlciwgZGF0YSk7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+
ICsgICAgICAgY2FzZSBDT1VOVEVSX1NDT1BFX1NJR05BTDoKPiArICAgICAgICAgICAgICAgZXJy
ID0gYS0+Y29tcC5zaWduYWxfdTMyX3dyaXRlKGNvdW50ZXIsIGEtPnBhcmVudCwgZGF0YSk7Cj4g
KyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgY2FzZSBDT1VOVEVSX1NDT1BFX0NPVU5U
Ogo+ICsgICAgICAgICAgICAgICBpZiAoYS0+Y29tcC50eXBlID09IENPVU5URVJfQ09NUF9TWU5B
UFNFX0FDVElPTikKPiArICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBhLT5jb21wLmFjdGlv
bl93cml0ZShjb3VudGVyLCBjb3VudCwgc3luYXBzZSwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhKTsKPiArICAgICAgICAgICAgICAgZWxz
ZQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9IGEtPmNvbXAuY291bnRfdTMyX3dyaXRl
KGNvdW50ZXIsIGNvdW50LCBkYXRhKTsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAg
ICBkZWZhdWx0Ogo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiArICAgICAgIH0K
PiArICAgICAgIGlmIChlcnIgPCAwKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsK
PiArICAgICAgIHJldHVybiBsZW47Cj4gK30KPiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJf
Y29tcF91NjRfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYp
Cj4gK3sKPiArICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9
IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsgICAgICAgc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKyAgICAgICBpbnQg
ZXJyOwo+ICsgICAgICAgdTY0IGRhdGEgPSAwOwo+ICsKPiArICAgICAgIHN3aXRjaCAoYS0+c2Nv
cGUpIHsKPiArICAgICAgIGNhc2UgQ09VTlRFUl9TQ09QRV9ERVZJQ0U6Cj4gKyAgICAgICAgICAg
ICAgIGVyciA9IGEtPmNvbXAuZGV2aWNlX3U2NF9yZWFkKGNvdW50ZXIsICZkYXRhKTsKPiArICAg
ICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBjYXNlIENPVU5URVJfU0NPUEVfU0lHTkFMOgo+
ICsgICAgICAgICAgICAgICBlcnIgPSBhLT5jb21wLnNpZ25hbF91NjRfcmVhZChjb3VudGVyLCBh
LT5wYXJlbnQsICZkYXRhKTsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBjYXNl
IENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4gKyAgICAgICAgICAgICAgIGVyciA9IGEtPmNvbXAuY291
bnRfdTY0X3JlYWQoY291bnRlciwgYS0+cGFyZW50LCAmZGF0YSk7Cj4gKyAgICAgICAgICAgICAg
IGJyZWFrOwo+ICsgICAgICAgZGVmYXVsdDoKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7Cj4gKyAgICAgICB9Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAgICAgICAg
cmV0dXJuIGVycjsKPiArCj4gKyAgICAgICByZXR1cm4gc3ByaW50ZihidWYsICIlbGx1XG4iLCAo
dW5zaWduZWQgbG9uZyBsb25nKWRhdGEpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCBjb3Vu
dGVyX2NvbXBfdTY0X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXpl
X3QgbGVuKQo+ICt7Cj4gKyAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNv
bnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKPiArICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ICsgICAg
ICAgaW50IGVycjsKPiArICAgICAgIHU2NCBkYXRhID0gMDsKPiArCj4gKyAgICAgICBlcnIgPSBr
c3RydG91NjQoYnVmLCAwLCAmZGF0YSk7Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAg
ICAgICAgICAgcmV0dXJuIGVycjsKPiArCj4gKyAgICAgICBzd2l0Y2ggKGEtPnNjb3BlKSB7Cj4g
KyAgICAgICBjYXNlIENPVU5URVJfU0NPUEVfREVWSUNFOgo+ICsgICAgICAgICAgICAgICBlcnIg
PSBhLT5jb21wLmRldmljZV91NjRfd3JpdGUoY291bnRlciwgZGF0YSk7Cj4gKyAgICAgICAgICAg
ICAgIGJyZWFrOwo+ICsgICAgICAgY2FzZSBDT1VOVEVSX1NDT1BFX1NJR05BTDoKPiArICAgICAg
ICAgICAgICAgZXJyID0gYS0+Y29tcC5zaWduYWxfdTY0X3dyaXRlKGNvdW50ZXIsIGEtPnBhcmVu
dCwgZGF0YSk7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgY2FzZSBDT1VOVEVS
X1NDT1BFX0NPVU5UOgo+ICsgICAgICAgICAgICAgICBlcnIgPSBhLT5jb21wLmNvdW50X3U2NF93
cml0ZShjb3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+ICsgICAgICAgICAgICAgICBicmVhazsK
PiArICAgICAgIGRlZmF1bHQ6Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsg
ICAgICAgfQo+ICsgICAgICAgaWYgKGVyciA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiBl
cnI7Cj4gKwo+ICsgICAgICAgcmV0dXJuIGxlbjsKPiArfQo+ICsKPiArc3RhdGljIHNzaXplX3Qg
ZW51bXNfYXZhaWxhYmxlX3Nob3coY29uc3QgdTMyICpjb25zdCBlbnVtcywKPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzaXplX3QgbnVtX2VudW1zLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmNvbnN0IHN0cnNbXSwg
Y2hhciAqYnVmKQo+ICt7Cj4gKyAgICAgICBzaXplX3QgbGVuID0gMDsKPiArICAgICAgIHNpemVf
dCBpbmRleDsKPiArCj4gKyAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBudW1fZW51bXM7
IGluZGV4KyspCj4gKyAgICAgICAgICAgICAgIGxlbiArPSBzeXNmc19lbWl0X2F0KGJ1ZiwgbGVu
LCAiJXNcbiIsIHN0cnNbZW51bXNbaW5kZXhdXSk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIGxlbjsK
PiArfQo+ICsKPiArc3RhdGljIHNzaXplX3Qgc3Ryc19hdmFpbGFibGVfc2hvdyhjb25zdCBzdHJ1
Y3QgY291bnRlcl9hdmFpbGFibGUgKmNvbnN0IGF2YWlsLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY2hhciAqYnVmKQo+ICt7Cj4gKyAgICAgICBzaXplX3QgbGVuID0gMDsK
PiArICAgICAgIHNpemVfdCBpbmRleDsKPiArCj4gKyAgICAgICBmb3IgKGluZGV4ID0gMDsgaW5k
ZXggPCBhdmFpbC0+bnVtX2l0ZW1zOyBpbmRleCsrKQo+ICsgICAgICAgICAgICAgICBsZW4gKz0g
c3lzZnNfZW1pdF9hdChidWYsIGxlbiwgIiVzXG4iLCBhdmFpbC0+c3Ryc1tpbmRleF0pOwo+ICsK
PiArICAgICAgIHJldHVybiBsZW47Cj4gK30KPiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJf
Y29tcF9hdmFpbGFibGVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyICpidWYp
Cj4gK3sKPiArICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9
IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsgICAgICAgY29uc3Qgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gYS0+cGFyZW50Owo+ICsgICAgICAgY29uc3Qgc3RydWN0
IGNvdW50ZXJfc3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGEtPmNvbXAucHJpdjsKPiArICAgICAg
IGNvbnN0IHN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSAqY29uc3QgYXZhaWwgPSBhLT5jb21wLnBy
aXY7Cj4gKwo+ICsgICAgICAgc3dpdGNoIChhLT5jb21wLnR5cGUpIHsKPiArICAgICAgIGNhc2Ug
Q09VTlRFUl9DT01QX0ZVTkNUSU9OOgo+ICsgICAgICAgICAgICAgICByZXR1cm4gZW51bXNfYXZh
aWxhYmxlX3Nob3coY291bnQtPmZ1bmN0aW9uc19saXN0LAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY291bnQtPm51bV9mdW5jdGlvbnMsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyX2Z1bmN0aW9uX3N0ciwg
YnVmKTsKPiArICAgICAgIGNhc2UgQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OOgo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gZW51bXNfYXZhaWxhYmxlX3Nob3coc3luYXBzZS0+YWN0aW9uc19s
aXN0LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3luYXBz
ZS0+bnVtX2FjdGlvbnMsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0ciwgYnVmKTsKPiArICAgICAgIGNhc2UgQ09V
TlRFUl9DT01QX0VOVU06Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBzdHJzX2F2YWlsYWJsZV9z
aG93KGF2YWlsLCBidWYpOwo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERToK
PiArICAgICAgICAgICAgICAgcmV0dXJuIGVudW1zX2F2YWlsYWJsZV9zaG93KGF2YWlsLT5lbnVt
cywgYXZhaWwtPm51bV9pdGVtcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvdW50ZXJfY291bnRfbW9kZV9zdHIsIGJ1Zik7Cj4gKyAgICAgICBkZWZhdWx0
Ogo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiArICAgICAgIH0KPiArfQo+ICsK
PiArc3RhdGljIGludCBjb3VudGVyX2F2YWlsX2F0dHJfY3JlYXRlKHN0cnVjdCBkZXZpY2UgKmNv
bnN0IGRldiwKPiArICAgICAgIHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqY29uc3Qg
Z3JvdXAsCj4gKyAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb21wICpjb25zdCBjb21wLCB2
b2lkICpjb25zdCBwYXJlbnQpCj4gK3sKPiArICAgICAgIHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0
ZSAqY291bnRlcl9hdHRyOwo+ICsgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmRldl9h
dHRyOwo+ICsKPiArICAgICAgIC8qIEFsbG9jYXRlIENvdW50ZXIgYXR0cmlidXRlICovCj4gKyAg
ICAgICBjb3VudGVyX2F0dHIgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmNvdW50ZXJfYXR0
ciksIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFjb3VudGVyX2F0dHIpCj4gKyAgICAgICAg
ICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsKPiArICAgICAgIC8qIENvbmZpZ3VyZSBDb3VudGVy
IGF0dHJpYnV0ZSAqLwo+ICsgICAgICAgY291bnRlcl9hdHRyLT5jb21wLnR5cGUgPSBjb21wLT50
eXBlOwo+ICsgICAgICAgY291bnRlcl9hdHRyLT5jb21wLnByaXYgPSBjb21wLT5wcml2Owo+ICsg
ICAgICAgY291bnRlcl9hdHRyLT5wYXJlbnQgPSBwYXJlbnQ7Cj4gKwo+ICsgICAgICAgLyogSW5p
dGlhbGl6ZSBzeXNmcyBhdHRyaWJ1dGUgKi8KPiArICAgICAgIGRldl9hdHRyID0gJmNvdW50ZXJf
YXR0ci0+ZGV2X2F0dHI7Cj4gKyAgICAgICBzeXNmc19hdHRyX2luaXQoJmRldl9hdHRyLT5hdHRy
KTsKPiArCj4gKyAgICAgICAvKiBDb25maWd1cmUgZGV2aWNlIGF0dHJpYnV0ZSAqLwo+ICsgICAg
ICAgZGV2X2F0dHItPmF0dHIubmFtZSA9IGRldm1fa2FzcHJpbnRmKGRldiwgR0ZQX0tFUk5FTCwg
IiVzX2F2YWlsYWJsZSIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29tcC0+bmFtZSk7Cj4gKyAgICAgICBpZiAoIWRldl9hdHRyLT5hdHRyLm5hbWUpCj4g
KyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+ICsgICAgICAgZGV2X2F0dHItPmF0dHIu
bW9kZSA9IDA0NDQ7Cj4gKyAgICAgICBkZXZfYXR0ci0+c2hvdyA9IGNvdW50ZXJfY29tcF9hdmFp
bGFibGVfc2hvdzsKPiArCj4gKyAgICAgICAvKiBTdG9yZSBsaXN0IG5vZGUgKi8KPiArICAgICAg
IGxpc3RfYWRkKCZjb3VudGVyX2F0dHItPmwsICZncm91cC0+YXR0cl9saXN0KTsKPiArICAgICAg
IGdyb3VwLT5udW1fYXR0cisrOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgaW50IGNvdW50ZXJfYXR0cl9jcmVhdGUoc3RydWN0IGRldmljZSAqY29uc3QgZGV2LAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVf
Z3JvdXAgKmNvbnN0IGdyb3VwLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25z
dCBzdHJ1Y3QgY291bnRlcl9jb21wICpjb25zdCBjb21wLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBlbnVtIGNvdW50ZXJfc2NvcGUgc2NvcGUsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHZvaWQgKmNvbnN0IHBhcmVudCkKPiArewo+ICsgICAgICAgc3Ry
dWN0IGNvdW50ZXJfYXR0cmlidXRlICpjb3VudGVyX2F0dHI7Cj4gKyAgICAgICBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqZGV2X2F0dHI7Cj4gKwo+ICsgICAgICAgLyogQWxsb2NhdGUgQ291bnRl
ciBhdHRyaWJ1dGUgKi8KPiArICAgICAgIGNvdW50ZXJfYXR0ciA9IGRldm1fa3phbGxvYyhkZXYs
IHNpemVvZigqY291bnRlcl9hdHRyKSwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICBpZiAoIWNvdW50
ZXJfYXR0cikKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsgICAgICAg
LyogQ29uZmlndXJlIENvdW50ZXIgYXR0cmlidXRlICovCj4gKyAgICAgICBjb3VudGVyX2F0dHIt
PmNvbXAgPSAqY29tcDsKPiArICAgICAgIGNvdW50ZXJfYXR0ci0+c2NvcGUgPSBzY29wZTsKPiAr
ICAgICAgIGNvdW50ZXJfYXR0ci0+cGFyZW50ID0gcGFyZW50Owo+ICsKPiArICAgICAgIC8qIENv
bmZpZ3VyZSBkZXZpY2UgYXR0cmlidXRlICovCj4gKyAgICAgICBkZXZfYXR0ciA9ICZjb3VudGVy
X2F0dHItPmRldl9hdHRyOwo+ICsgICAgICAgc3lzZnNfYXR0cl9pbml0KCZkZXZfYXR0ci0+YXR0
cik7Cj4gKyAgICAgICBkZXZfYXR0ci0+YXR0ci5uYW1lID0gY29tcC0+bmFtZTsKPiArICAgICAg
IHN3aXRjaCAoY29tcC0+dHlwZSkgewo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0NPTVBfVTg6Cj4g
KyAgICAgICBjYXNlIENPVU5URVJfQ09NUF9CT09MOgo+ICsgICAgICAgICAgICAgICBpZiAoY29t
cC0+ZGV2aWNlX3U4X3JlYWQpIHsKPiArICAgICAgICAgICAgICAgICAgICAgICBkZXZfYXR0ci0+
YXR0ci5tb2RlIHw9IDA0NDQ7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZGV2X2F0dHItPnNo
b3cgPSBjb3VudGVyX2NvbXBfdThfc2hvdzsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAg
ICAgICAgICBpZiAoY29tcC0+ZGV2aWNlX3U4X3dyaXRlKSB7Cj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAwOwo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGRldl9hdHRyLT5zdG9yZSA9IGNvdW50ZXJfY29tcF91OF9zdG9yZTsKPiArICAgICAgICAg
ICAgICAgfQo+ICsgICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIGNhc2UgQ09VTlRFUl9D
T01QX1NJR05BTF9MRVZFTDoKPiArICAgICAgIGNhc2UgQ09VTlRFUl9DT01QX0ZVTkNUSU9OOgo+
ICsgICAgICAgY2FzZSBDT1VOVEVSX0NPTVBfU1lOQVBTRV9BQ1RJT046Cj4gKyAgICAgICBjYXNl
IENPVU5URVJfQ09NUF9FTlVNOgo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0NPTVBfQ09VTlRfRElS
RUNUSU9OOgo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERToKPiArICAgICAg
ICAgICAgICAgaWYgKGNvbXAtPmRldmljZV91MzJfcmVhZCkgewo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDQ0NDsKPiArICAgICAgICAgICAgICAgICAg
ICAgICBkZXZfYXR0ci0+c2hvdyA9IGNvdW50ZXJfY29tcF91MzJfc2hvdzsKPiArICAgICAgICAg
ICAgICAgfQo+ICsgICAgICAgICAgICAgICBpZiAoY29tcC0+ZGV2aWNlX3UzMl93cml0ZSkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDIwMDsKPiAr
ICAgICAgICAgICAgICAgICAgICAgICBkZXZfYXR0ci0+c3RvcmUgPSBjb3VudGVyX2NvbXBfdTMy
X3N0b3JlOwo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsg
ICAgICAgY2FzZSBDT1VOVEVSX0NPTVBfVTY0Ogo+ICsgICAgICAgICAgICAgICBpZiAoY29tcC0+
ZGV2aWNlX3U2NF9yZWFkKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgZGV2X2F0dHItPmF0
dHIubW9kZSB8PSAwNDQ0Owo+ICsgICAgICAgICAgICAgICAgICAgICAgIGRldl9hdHRyLT5zaG93
ID0gY291bnRlcl9jb21wX3U2NF9zaG93Owo+ICsgICAgICAgICAgICAgICB9Cj4gKyAgICAgICAg
ICAgICAgIGlmIChjb21wLT5kZXZpY2VfdTY0X3dyaXRlKSB7Cj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAwOwo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIGRldl9hdHRyLT5zdG9yZSA9IGNvdW50ZXJfY29tcF91NjRfc3RvcmU7Cj4gKyAgICAgICAg
ICAgICAgIH0KPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBkZWZhdWx0Ogo+ICsg
ICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICAv
KiBTdG9yZSBsaXN0IG5vZGUgKi8KPiArICAgICAgIGxpc3RfYWRkKCZjb3VudGVyX2F0dHItPmws
ICZncm91cC0+YXR0cl9saXN0KTsKPiArICAgICAgIGdyb3VwLT5udW1fYXR0cisrOwo+ICsKPiAr
ICAgICAgIC8qIENyZWF0ZSAiKl9hdmFpbGFibGUiIGF0dHJpYnV0ZSBpZiBuZWVkZWQgKi8KPiAr
ICAgICAgIHN3aXRjaCAoY29tcC0+dHlwZSkgewo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0NPTVBf
RlVOQ1RJT046Cj4gKyAgICAgICBjYXNlIENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjoKPiAr
ICAgICAgIGNhc2UgQ09VTlRFUl9DT01QX0VOVU06Cj4gKyAgICAgICBjYXNlIENPVU5URVJfQ09N
UF9DT1VOVF9NT0RFOgo+ICsgICAgICAgICAgICAgICByZXR1cm4gY291bnRlcl9hdmFpbF9hdHRy
X2NyZWF0ZShkZXYsIGdyb3VwLCBjb21wLCBwYXJlbnQpOwo+ICsgICAgICAgZGVmYXVsdDoKPiAr
ICAgICAgICAgICAgICAgcmV0dXJuIDA7Cj4gKyAgICAgICB9Cj4gK30KPiArCj4gK3N0YXRpYyBz
c2l6ZV90IGNvdW50ZXJfY29tcF9uYW1lX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUg
KmF0dHIsIGNoYXIgKmJ1ZikKPiArewo+ICsgICAgICAgcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAi
JXNcbiIsIHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpLT5jb21wLm5hbWUpOwo+ICt9Cj4gKwo+
ICtzdGF0aWMgaW50IGNvdW50ZXJfbmFtZV9hdHRyX2NyZWF0ZShzdHJ1Y3QgZGV2aWNlICpjb25z
dCBkZXYsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50
ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBncm91cCwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjb25zdCBjaGFyICpjb25zdCBuYW1lKQo+ICt7Cj4gKyAgICAgICBzdHJ1
Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNvdW50ZXJfYXR0cjsKPiArCj4gKyAgICAgICAvKiBBbGxv
Y2F0ZSBDb3VudGVyIGF0dHJpYnV0ZSAqLwo+ICsgICAgICAgY291bnRlcl9hdHRyID0gZGV2bV9r
emFsbG9jKGRldiwgc2l6ZW9mKCpjb3VudGVyX2F0dHIpLCBHRlBfS0VSTkVMKTsKPiArICAgICAg
IGlmICghY291bnRlcl9hdHRyKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiAr
Cj4gKyAgICAgICAvKiBDb25maWd1cmUgQ291bnRlciBhdHRyaWJ1dGUgKi8KPiArICAgICAgIGNv
dW50ZXJfYXR0ci0+Y29tcC5uYW1lID0gbmFtZTsKPiArCj4gKyAgICAgICAvKiBDb25maWd1cmUg
ZGV2aWNlIGF0dHJpYnV0ZSAqLwo+ICsgICAgICAgc3lzZnNfYXR0cl9pbml0KCZjb3VudGVyX2F0
dHItPmRldl9hdHRyLmF0dHIpOwo+ICsgICAgICAgY291bnRlcl9hdHRyLT5kZXZfYXR0ci5hdHRy
Lm5hbWUgPSAibmFtZSI7Cj4gKyAgICAgICBjb3VudGVyX2F0dHItPmRldl9hdHRyLmF0dHIubW9k
ZSA9IDA0NDQ7Cj4gKyAgICAgICBjb3VudGVyX2F0dHItPmRldl9hdHRyLnNob3cgPSBjb3VudGVy
X2NvbXBfbmFtZV9zaG93Owo+ICsKPiArICAgICAgIC8qIFN0b3JlIGxpc3Qgbm9kZSAqLwo+ICsg
ICAgICAgbGlzdF9hZGQoJmNvdW50ZXJfYXR0ci0+bCwgJmdyb3VwLT5hdHRyX2xpc3QpOwo+ICsg
ICAgICAgZ3JvdXAtPm51bV9hdHRyKys7Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiAr
Cj4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21wIGNvdW50ZXJfc2lnbmFsX2NvbXAgPSB7Cj4g
KyAgICAgICAudHlwZSA9IENPVU5URVJfQ09NUF9TSUdOQUxfTEVWRUwsCj4gKyAgICAgICAubmFt
ZSA9ICJzaWduYWwiLAo+ICt9Owo+ICsKPiArc3RhdGljIGludCBjb3VudGVyX3NpZ25hbF9hdHRy
c19jcmVhdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyLAo+ICsgICAgICAg
c3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBncm91cCwKPiArICAgICAgIHN0
cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qgc2lnbmFsKQo+ICt7Cj4gKyAgICAgICBjb25zdCBl
bnVtIGNvdW50ZXJfc2NvcGUgc2NvcGUgPSBDT1VOVEVSX1NDT1BFX1NJR05BTDsKPiArICAgICAg
IHN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7Cj4gKyAgICAgICBpbnQg
ZXJyOwo+ICsgICAgICAgc3RydWN0IGNvdW50ZXJfY29tcCBjb21wOwo+ICsgICAgICAgc2l6ZV90
IGk7Cj4gKwo+ICsgICAgICAgLyogQ3JlYXRlIG1haW4gU2lnbmFsIGF0dHJpYnV0ZSAqLwo+ICsg
ICAgICAgY29tcCA9IGNvdW50ZXJfc2lnbmFsX2NvbXA7Cj4gKyAgICAgICBjb21wLnNpZ25hbF91
MzJfcmVhZCA9IGNvdW50ZXItPm9wcy0+c2lnbmFsX3JlYWQ7Cj4gKyAgICAgICBlcnIgPSBjb3Vu
dGVyX2F0dHJfY3JlYXRlKGRldiwgZ3JvdXAsICZjb21wLCBzY29wZSwgc2lnbmFsKTsKPiArICAg
ICAgIGlmIChlcnIgPCAwKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsKPiArICAg
ICAgIC8qIENyZWF0ZSBTaWduYWwgbmFtZSBhdHRyaWJ1dGUgKi8KPiArICAgICAgIGVyciA9IGNv
dW50ZXJfbmFtZV9hdHRyX2NyZWF0ZShkZXYsIGdyb3VwLCBzaWduYWwtPm5hbWUpOwo+ICsgICAg
ICAgaWYgKGVyciA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gKwo+ICsgICAg
ICAgLyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBleHRlbnNpb24gKi8KPiArICAgICAg
IGZvciAoaSA9IDA7IGkgPCBzaWduYWwtPm51bV9leHQ7IGkrKykgewo+ICsgICAgICAgICAgICAg
ICBlcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgZ3JvdXAsIHNpZ25hbC0+ZXh0ICsgaSwg
c2NvcGUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2lnbmFs
KTsKPiArICAgICAgICAgICAgICAgaWYgKGVyciA8IDApCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIGVycjsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+
ICsKPiArc3RhdGljIGludCBjb3VudGVyX3N5c2ZzX3NpZ25hbHNfYWRkKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY29uc3QgY291bnRlciwKPiArICAgICAgIHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0
ZV9ncm91cCAqY29uc3QgZ3JvdXBzKQo+ICt7Cj4gKyAgICAgICBzaXplX3QgaTsKPiArICAgICAg
IGludCBlcnI7Cj4gKwo+ICsgICAgICAgLyogQWRkIGVhY2ggU2lnbmFsICovCj4gKyAgICAgICBm
b3IgKGkgPSAwOyBpIDwgY291bnRlci0+bnVtX3NpZ25hbHM7IGkrKykgewo+ICsgICAgICAgICAg
ICAgICAvKiBHZW5lcmF0ZSBTaWduYWwgYXR0cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCj4gKyAg
ICAgICAgICAgICAgIGdyb3Vwc1tpXS5uYW1lID0gZGV2bV9rYXNwcmludGYoJmNvdW50ZXItPmRl
diwgR0ZQX0tFUk5FTCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAic2lnbmFsJXp1IiwgaSk7Cj4gKyAgICAgICAgICAgICAgIGlmICghZ3JvdXBzW2ld
Lm5hbWUpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsg
ICAgICAgICAgICAgICAvKiBDcmVhdGUgYWxsIGF0dHJpYnV0ZXMgYXNzb2NpYXRlZCB3aXRoIFNp
Z25hbCAqLwo+ICsgICAgICAgICAgICAgICBlcnIgPSBjb3VudGVyX3NpZ25hbF9hdHRyc19jcmVh
dGUoY291bnRlciwgZ3JvdXBzICsgaSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGNvdW50ZXItPnNpZ25hbHMgKyBpKTsKPiArICAgICAgICAgICAg
ICAgaWYgKGVyciA8IDApCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPiAr
ICAgICAgIH0KPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBj
b3VudGVyX3N5c2ZzX3N5bmFwc2VzX2FkZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNv
dW50ZXIsCj4gKyAgICAgICBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGdy
b3VwLAo+ICsgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50KQo+ICt7Cj4g
KyAgICAgICBzaXplX3QgaTsKPiArCj4gKyAgICAgICAvKiBBZGQgZWFjaCBTeW5hcHNlICovCj4g
KyAgICAgICBmb3IgKGkgPSAwOyBpIDwgY291bnQtPm51bV9zeW5hcHNlczsgaSsrKSB7Cj4gKyAg
ICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7Cj4g
KyAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2U7Cj4gKyAgICAg
ICAgICAgICAgIHNpemVfdCBpZDsKPiArICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY29t
cCBjb21wOwo+ICsgICAgICAgICAgICAgICBpbnQgZXJyOwo+ICsKPiArICAgICAgICAgICAgICAg
c3luYXBzZSA9IGNvdW50LT5zeW5hcHNlcyArIGk7Cj4gKwo+ICsgICAgICAgICAgICAgICAvKiBH
ZW5lcmF0ZSBTeW5hcHNlIGFjdGlvbiBuYW1lICovCj4gKyAgICAgICAgICAgICAgIGlkID0gc3lu
YXBzZS0+c2lnbmFsIC0gY291bnRlci0+c2lnbmFsczsKPiArICAgICAgICAgICAgICAgY29tcC5u
YW1lID0gZGV2bV9rYXNwcmludGYoZGV2LCBHRlBfS0VSTkVMLCAic2lnbmFsJXp1X2FjdGlvbiIs
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkKTsKPiArICAg
ICAgICAgICAgICAgaWYgKCFjb21wLm5hbWUpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIC1FTk9NRU07Cj4gKwo+ICsgICAgICAgICAgICAgICAvKiBDcmVhdGUgYWN0aW9uIGF0dHJp
YnV0ZSAqLwo+ICsgICAgICAgICAgICAgICBjb21wLnR5cGUgPSBDT1VOVEVSX0NPTVBfU1lOQVBT
RV9BQ1RJT047Cj4gKyAgICAgICAgICAgICAgIGNvbXAuYWN0aW9uX3JlYWQgPSBjb3VudGVyLT5v
cHMtPmFjdGlvbl9yZWFkOwo+ICsgICAgICAgICAgICAgICBjb21wLmFjdGlvbl93cml0ZSA9IGNv
dW50ZXItPm9wcy0+YWN0aW9uX3dyaXRlOwo+ICsgICAgICAgICAgICAgICBjb21wLnByaXYgPSBz
eW5hcHNlOwo+ICsgICAgICAgICAgICAgICBlcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwg
Z3JvdXAsICZjb21wLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IENPVU5URVJfU0NPUEVfQ09VTlQsIGNvdW50KTsKPiArICAgICAgICAgICAgICAgaWYgKGVyciA8
IDApCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPiArICAgICAgIH0KPiAr
Cj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2Nv
bXAgY291bnRlcl9jb3VudF9jb21wID0KPiArICAgICAgIENPVU5URVJfQ09NUF9DT1VOVF9VNjQo
ImNvdW50IiwgTlVMTCwgTlVMTCk7Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBj
b3VudGVyX2Z1bmN0aW9uX2NvbXAgPSB7Cj4gKyAgICAgICAudHlwZSA9IENPVU5URVJfQ09NUF9G
VU5DVElPTiwKPiArICAgICAgIC5uYW1lID0gImZ1bmN0aW9uIiwKPiArfTsKPiArCj4gK3N0YXRp
YyBpbnQgY291bnRlcl9jb3VudF9hdHRyc19jcmVhdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b25zdCBjb3VudGVyLAo+ICsgICAgICAgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpj
b25zdCBncm91cCwKPiArICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCkK
PiArewo+ICsgICAgICAgY29uc3QgZW51bSBjb3VudGVyX3Njb3BlIHNjb3BlID0gQ09VTlRFUl9T
Q09QRV9DT1VOVDsKPiArICAgICAgIHN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVy
LT5kZXY7Cj4gKyAgICAgICBpbnQgZXJyOwo+ICsgICAgICAgc3RydWN0IGNvdW50ZXJfY29tcCBj
b21wOwo+ICsgICAgICAgc2l6ZV90IGk7Cj4gKwo+ICsgICAgICAgLyogQ3JlYXRlIG1haW4gQ291
bnQgYXR0cmlidXRlICovCj4gKyAgICAgICBjb21wID0gY291bnRlcl9jb3VudF9jb21wOwo+ICsg
ICAgICAgY29tcC5jb3VudF91NjRfcmVhZCA9IGNvdW50ZXItPm9wcy0+Y291bnRfcmVhZDsKPiAr
ICAgICAgIGNvbXAuY291bnRfdTY0X3dyaXRlID0gY291bnRlci0+b3BzLT5jb3VudF93cml0ZTsK
PiArICAgICAgIGVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBncm91cCwgJmNvbXAsIHNj
b3BlLCBjb3VudCk7Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAgICAgICAgcmV0
dXJuIGVycjsKPiArCj4gKyAgICAgICAvKiBDcmVhdGUgQ291bnQgbmFtZSBhdHRyaWJ1dGUgKi8K
PiArICAgICAgIGVyciA9IGNvdW50ZXJfbmFtZV9hdHRyX2NyZWF0ZShkZXYsIGdyb3VwLCBjb3Vu
dC0+bmFtZSk7Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAgICAgICAgcmV0dXJu
IGVycjsKPiArCj4gKyAgICAgICAvKiBDcmVhdGUgQ291bnQgZnVuY3Rpb24gYXR0cmlidXRlICov
Cj4gKyAgICAgICBjb21wID0gY291bnRlcl9mdW5jdGlvbl9jb21wOwo+ICsgICAgICAgY29tcC5j
b3VudF91MzJfcmVhZCA9IGNvdW50ZXItPm9wcy0+ZnVuY3Rpb25fcmVhZDsKPiArICAgICAgIGNv
bXAuY291bnRfdTMyX3dyaXRlID0gY291bnRlci0+b3BzLT5mdW5jdGlvbl93cml0ZTsKPiArICAg
ICAgIGVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBncm91cCwgJmNvbXAsIHNjb3BlLCBj
b3VudCk7Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIGVy
cjsKPiArCj4gKyAgICAgICAvKiBDcmVhdGUgYW4gYXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lv
biAqLwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IGNvdW50LT5udW1fZXh0OyBpKyspIHsKPiAr
ICAgICAgICAgICAgICAgZXJyID0gY291bnRlcl9hdHRyX2NyZWF0ZShkZXYsIGdyb3VwLCBjb3Vu
dC0+ZXh0ICsgaSwgc2NvcGUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY291bnQpOwo+ICsgICAgICAgICAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVy
biAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJfc3lzZnNfY291bnRzX2FkZChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIsCj4gKyAgICAgICBzdHJ1Y3QgY291bnRl
cl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGdyb3VwcykKPiArewo+ICsgICAgICAgc2l6ZV90IGk7
Cj4gKyAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQ7Cj4gKyAgICAgICBpbnQgZXJy
Owo+ICsKPiArICAgICAgIC8qIEFkZCBlYWNoIENvdW50ICovCj4gKyAgICAgICBmb3IgKGkgPSAw
OyBpIDwgY291bnRlci0+bnVtX2NvdW50czsgaSsrKSB7Cj4gKyAgICAgICAgICAgICAgIGNvdW50
ID0gY291bnRlci0+Y291bnRzICsgaTsKPiArCj4gKyAgICAgICAgICAgICAgIC8qIEdlbmVyYXRl
IENvdW50IGF0dHJpYnV0ZSBkaXJlY3RvcnkgbmFtZSAqLwo+ICsgICAgICAgICAgICAgICBncm91
cHNbaV0ubmFtZSA9IGRldm1fa2FzcHJpbnRmKCZjb3VudGVyLT5kZXYsIEdGUF9LRVJORUwsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvdW50JXp1
IiwgaSk7Cj4gKyAgICAgICAgICAgICAgIGlmICghZ3JvdXBzW2ldLm5hbWUpCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsgICAgICAgICAgICAgICAvKiBB
ZGQgc3lzZnMgYXR0cmlidXRlcyBvZiB0aGUgU3luYXBzZXMgKi8KPiArICAgICAgICAgICAgICAg
ZXJyID0gY291bnRlcl9zeXNmc19zeW5hcHNlc19hZGQoY291bnRlciwgZ3JvdXBzICsgaSwgY291
bnQpOwo+ICsgICAgICAgICAgICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gZXJyOwo+ICsKPiArICAgICAgICAgICAgICAgLyogQ3JlYXRlIGFsbCBhdHRy
aWJ1dGVzIGFzc29jaWF0ZWQgd2l0aCBDb3VudCAqLwo+ICsgICAgICAgICAgICAgICBlcnIgPSBj
b3VudGVyX2NvdW50X2F0dHJzX2NyZWF0ZShjb3VudGVyLCBncm91cHMgKyBpLCBjb3VudCk7Cj4g
KyAgICAgICAgICAgICAgIGlmIChlcnIgPCAwKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiBlcnI7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4g
K3N0YXRpYyBpbnQgY291bnRlcl9udW1fc2lnbmFsc19yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwgdTggKnZhbCkKPiArewo+ICsgICAgICAgKnZhbCA9IGNvdW50ZXItPm51bV9z
aWduYWxzOwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgY291bnRl
cl9udW1fY291bnRzX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB1OCAqdmFs
KQo+ICt7Cj4gKyAgICAgICAqdmFsID0gY291bnRlci0+bnVtX2NvdW50czsKPiArICAgICAgIHJl
dHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBjb3VudGVyX251
bV9zaWduYWxzX2NvbXAgPQo+ICsgICAgICAgQ09VTlRFUl9DT01QX0RFVklDRV9VOCgibnVtX3Np
Z25hbHMiLCBjb3VudGVyX251bV9zaWduYWxzX3JlYWQsIE5VTEwpOwo+ICsKPiArc3RhdGljIHN0
cnVjdCBjb3VudGVyX2NvbXAgY291bnRlcl9udW1fY291bnRzX2NvbXAgPQo+ICsgICAgICAgQ09V
TlRFUl9DT01QX0RFVklDRV9VOCgibnVtX2NvdW50cyIsIGNvdW50ZXJfbnVtX2NvdW50c19yZWFk
LCBOVUxMKTsKPiArCj4gK3N0YXRpYyBpbnQgY291bnRlcl9zeXNmc19hdHRyX2FkZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqZ3JvdXApCj4gK3sKPiAr
ICAgICAgIGNvbnN0IGVudW0gY291bnRlcl9zY29wZSBzY29wZSA9IENPVU5URVJfU0NPUEVfREVW
SUNFOwo+ICsgICAgICAgc3RydWN0IGRldmljZSAqY29uc3QgZGV2ID0gJmNvdW50ZXItPmRldjsK
PiArICAgICAgIGludCBlcnI7Cj4gKyAgICAgICBzaXplX3QgaTsKPiArCj4gKyAgICAgICAvKiBB
ZGQgU2lnbmFscyBzeXNmcyBhdHRyaWJ1dGVzICovCj4gKyAgICAgICBlcnIgPSBjb3VudGVyX3N5
c2ZzX3NpZ25hbHNfYWRkKGNvdW50ZXIsIGdyb3VwKTsKPiArICAgICAgIGlmIChlcnIgPCAwKQo+
ICsgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsgICAgICAgZ3JvdXAgKz0gY291bnRlci0+
bnVtX3NpZ25hbHM7Cj4gKwo+ICsgICAgICAgLyogQWRkIENvdW50cyBzeXNmcyBhdHRyaWJ1dGVz
ICovCj4gKyAgICAgICBlcnIgPSBjb3VudGVyX3N5c2ZzX2NvdW50c19hZGQoY291bnRlciwgZ3Jv
dXApOwo+ICsgICAgICAgaWYgKGVyciA8IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiBlcnI7
Cj4gKyAgICAgICBncm91cCArPSBjb3VudGVyLT5udW1fY291bnRzOwo+ICsKPiArICAgICAgIC8q
IENyZWF0ZSBuYW1lIGF0dHJpYnV0ZSAqLwo+ICsgICAgICAgZXJyID0gY291bnRlcl9uYW1lX2F0
dHJfY3JlYXRlKGRldiwgZ3JvdXAsIGNvdW50ZXItPm5hbWUpOwo+ICsgICAgICAgaWYgKGVyciA8
IDApCj4gKyAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gKwo+ICsgICAgICAgLyogQ3JlYXRl
IG51bV9zaWduYWxzIGF0dHJpYnV0ZSAqLwo+ICsgICAgICAgZXJyID0gY291bnRlcl9hdHRyX2Ny
ZWF0ZShkZXYsIGdyb3VwLCAmY291bnRlcl9udW1fc2lnbmFsc19jb21wLCBzY29wZSwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCk7Cj4gKyAgICAgICBpZiAoZXJyIDwg
MCkKPiArICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPiArCj4gKyAgICAgICAvKiBDcmVhdGUg
bnVtX2NvdW50cyBhdHRyaWJ1dGUgKi8KPiArICAgICAgIGVyciA9IGNvdW50ZXJfYXR0cl9jcmVh
dGUoZGV2LCBncm91cCwgJmNvdW50ZXJfbnVtX2NvdW50c19jb21wLCBzY29wZSwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgTlVMTCk7Cj4gKyAgICAgICBpZiAoZXJyIDwgMCkK
PiArICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPiArCj4gKyAgICAgICAvKiBDcmVhdGUgYW4g
YXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8
IGNvdW50ZXItPm51bV9leHQ7IGkrKykgewo+ICsgICAgICAgICAgICAgICBlcnIgPSBjb3VudGVy
X2F0dHJfY3JlYXRlKGRldiwgZ3JvdXAsIGNvdW50ZXItPmV4dCArIGksIHNjb3BlLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5VTEwpOwo+ICsgICAgICAgICAg
ICAgICBpZiAoZXJyIDwgMCkKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+
ICsgICAgICAgfQo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICt9Cj4gKwo+ICsvKioKPiArICog
Y291bnRlcl9zeXNmc19hZGQgLSBBZGRzIENvdW50ZXIgc3lzZnMgYXR0cmlidXRlcyB0byB0aGUg
ZGV2aWNlIHN0cnVjdHVyZQo+ICsgKiBAY291bnRlcjogICBQb2ludGVyIHRvIHRoZSBDb3VudGVy
IGRldmljZSBzdHJ1Y3R1cmUKPiArICoKPiArICogQ291bnRlciBzeXNmcyBhdHRyaWJ1dGVzIGFy
ZSBjcmVhdGVkIGFuZCBhZGRlZCB0byB0aGUgcmVzcGVjdGl2ZSBkZXZpY2UKPiArICogc3RydWN0
dXJlIGZvciBsYXRlciByZWdpc3RyYXRpb24gdG8gdGhlIHN5c3RlbS4gUmVzb3VyY2UtbWFuYWdl
ZCBtZW1vcnkKPiArICogYWxsb2NhdGlvbiBpcyBwZXJmb3JtZWQgYnkgdGhpcyBmdW5jdGlvbiwg
YW5kIHRoaXMgbWVtb3J5IHNob3VsZCBiZSBmcmVlZAo+ICsgKiB3aGVuIG5vIGxvbmdlciBuZWVk
ZWQgKGF1dG9tYXRpY2FsbHkgYnkgYSBkZXZpY2VfdW5yZWdpc3RlciBjYWxsLCBvcgo+ICsgKiBt
YW51YWxseSBieSBhIGRldnJlc19yZWxlYXNlX2FsbCBjYWxsKS4KPiArICovCj4gK2ludCBjb3Vu
dGVyX3N5c2ZzX2FkZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gK3sK
PiArICAgICAgIHN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7Cj4gKyAg
ICAgICBjb25zdCBzaXplX3QgbnVtX2dyb3VwcyA9IGNvdW50ZXItPm51bV9zaWduYWxzICsgY291
bnRlci0+bnVtX2NvdW50cyArIDE7Cj4gKyAgICAgICBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVf
Z3JvdXAgKmdyb3VwczsKPiArICAgICAgIHNpemVfdCBpLCBqOwo+ICsgICAgICAgaW50IGVycjsK
PiArICAgICAgIHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmdyb3VwOwo+ICsgICAgICAgc3RydWN0
IGNvdW50ZXJfYXR0cmlidXRlICpwOwo+ICsKPiArICAgICAgIC8qIEFsbG9jYXRlIHNwYWNlIGZv
ciBhdHRyaWJ1dGUgZ3JvdXBzIChzaWduYWxzLCBjb3VudHMsIGFuZCBleHQpICovCj4gKyAgICAg
ICBncm91cHMgPSBkZXZtX2tjYWxsb2MoZGV2LCBudW1fZ3JvdXBzLCBzaXplb2YoKmdyb3Vwcyks
IEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFncm91cHMpCj4gKyAgICAgICAgICAgICAgIHJl
dHVybiAtRU5PTUVNOwo+ICsKPiArICAgICAgIC8qIEluaXRpYWxpemUgYXR0cmlidXRlIGxpc3Rz
ICovCj4gKyAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtX2dyb3VwczsgaSsrKQo+ICsgICAgICAg
ICAgICAgICBJTklUX0xJU1RfSEVBRCgmZ3JvdXBzW2ldLmF0dHJfbGlzdCk7Cj4gKwo+ICsgICAg
ICAgLyogQWRkIENvdW50ZXIgZGV2aWNlIHN5c2ZzIGF0dHJpYnV0ZXMgKi8KPiArICAgICAgIGVy
ciA9IGNvdW50ZXJfc3lzZnNfYXR0cl9hZGQoY291bnRlciwgZ3JvdXBzKTsKPiArICAgICAgIGlm
IChlcnIgPCAwKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+ICsKPiArICAgICAgIC8q
IEFsbG9jYXRlIGF0dHJpYnV0ZSBncm91cHMgZm9yIGFzc29jaWF0aW9uIHdpdGggZGV2aWNlICov
Cj4gKyAgICAgICBkZXYtPmdyb3VwcyA9IGRldm1fa2NhbGxvYyhkZXYsIG51bV9ncm91cHMgKyAx
LCBzaXplb2YoKmRldi0+Z3JvdXBzKSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYgKCFkZXYtPmdyb3VwcykKPiArICAgICAgICAg
ICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsgICAgICAgLyogUHJlcGFyZSBlYWNoIGdyb3Vw
IG9mIGF0dHJpYnV0ZXMgZm9yIGFzc29jaWF0aW9uICovCj4gKyAgICAgICBmb3IgKGkgPSAwOyBp
IDwgbnVtX2dyb3VwczsgaSsrKSB7Cj4gKyAgICAgICAgICAgICAgIC8qIEFsbG9jYXRlIHNwYWNl
IGZvciBhdHRyaWJ1dGUgZ3JvdXAgKi8KPiArICAgICAgICAgICAgICAgZ3JvdXAgPSBkZXZtX2t6
YWxsb2MoZGV2LCBzaXplb2YoKmdyb3VwKSwgR0ZQX0tFUk5FTCk7Cj4gKyAgICAgICAgICAgICAg
IGlmICghZ3JvdXApCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4g
KyAgICAgICAgICAgICAgIGdyb3VwLT5uYW1lID0gZ3JvdXBzW2ldLm5hbWU7Cj4gKwo+ICsgICAg
ICAgICAgICAgICAvKiBBbGxvY2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIHBvaW50ZXJzICovCj4g
KyAgICAgICAgICAgICAgIGdyb3VwLT5hdHRycyA9IGRldm1fa2NhbGxvYyhkZXYsIGdyb3Vwc1tp
XS5udW1fYXR0ciArIDEsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzaXplb2YoKmdyb3VwLT5hdHRycyksIEdGUF9LRVJORUwpOwo+ICsgICAgICAgICAgICAg
ICBpZiAoIWdyb3VwLT5hdHRycykKPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVO
T01FTTsKPiArCj4gKyAgICAgICAgICAgICAgIC8qIEFkZCBhdHRyaWJ1dGUgcG9pbnRlcnMgdG8g
YXR0cmlidXRlIGdyb3VwICovCj4gKyAgICAgICAgICAgICAgIGogPSAwOwo+ICsgICAgICAgICAg
ICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KHAsICZncm91cHNbaV0uYXR0cl9saXN0LCBsKQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLT5hdHRyc1tqKytdID0gJnAtPmRldl9hdHRyLmF0
dHI7Cj4gKwo+ICsgICAgICAgICAgICAgICAvKiBBc3NvY2lhdGUgYXR0cmlidXRlIGdyb3VwICov
Cj4gKyAgICAgICAgICAgICAgIGRldi0+Z3JvdXBzW2ldID0gZ3JvdXA7Cj4gKyAgICAgICB9Cj4g
Kwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVy
L2NvdW50ZXItc3lzZnMuaCBiL2RyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmgKPiBuZXcg
ZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAwMC4uMTRmZTU2NmFjYTBlCj4gLS0t
IC9kZXYvbnVsbAo+ICsrKyBiL2RyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmgKPiBAQCAt
MCwwICsxLDEzIEBACj4gKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCj4g
Ky8qCj4gKyAqIENvdW50ZXIgc3lzZnMgaW50ZXJmYWNlCj4gKyAqIENvcHlyaWdodCAoQykgMjAy
MCBXaWxsaWFtIEJyZWF0aGl0dCBHcmF5Cj4gKyAqLwo+ICsjaWZuZGVmIF9DT1VOVEVSX1NZU0ZT
X0hfCj4gKyNkZWZpbmUgX0NPVU5URVJfU1lTRlNfSF8KPiArCj4gKyNpbmNsdWRlIDxsaW51eC9j
b3VudGVyLmg+Cj4gKwo+ICtpbnQgY291bnRlcl9zeXNmc19hZGQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb25zdCBjb3VudGVyKTsKPiArCj4gKyNlbmRpZiAvKiBfQ09VTlRFUl9TWVNGU19IXyAq
Lwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci5jIGIvZHJpdmVycy9jb3Vu
dGVyL2NvdW50ZXIuYwo+IGRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IGRlOTIxZThh
M2Y3Mi4uMDAwMDAwMDAwMDAwCj4gLS0tIGEvZHJpdmVycy9jb3VudGVyL2NvdW50ZXIuYwo+ICsr
KyAvZGV2L251bGwKPiBAQCAtMSwxNDk2ICswLDAgQEAKPiAtLy8gU1BEWC1MaWNlbnNlLUlkZW50
aWZpZXI6IEdQTC0yLjAKPiAtLyoKPiAtICogR2VuZXJpYyBDb3VudGVyIGludGVyZmFjZQo+IC0g
KiBDb3B5cmlnaHQgKEMpIDIwMTggV2lsbGlhbSBCcmVhdGhpdHQgR3JheQo+IC0gKi8KPiAtI2lu
Y2x1ZGUgPGxpbnV4L2NvdW50ZXIuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgo+IC0j
aW5jbHVkZSA8bGludXgvZXJyLmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9leHBvcnQuaD4KPiAtI2lu
Y2x1ZGUgPGxpbnV4L2ZzLmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9nZnAuaD4KPiAtI2luY2x1ZGUg
PGxpbnV4L2lkci5oPgo+IC0jaW5jbHVkZSA8bGludXgvaW5pdC5oPgo+IC0jaW5jbHVkZSA8bGlu
dXgva2VybmVsLmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9saXN0Lmg+Cj4gLSNpbmNsdWRlIDxsaW51
eC9tb2R1bGUuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L3ByaW50ay5oPgo+IC0jaW5jbHVkZSA8bGlu
dXgvc2xhYi5oPgo+IC0jaW5jbHVkZSA8bGludXgvc3RyaW5nLmg+Cj4gLSNpbmNsdWRlIDxsaW51
eC9zeXNmcy5oPgo+IC0jaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KPiAtCj4gLWNvbnN0IGNoYXIg
KmNvbnN0IGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0clsyXSA9IHsKPiAtICAgICAgIFtDT1VO
VEVSX0NPVU5UX0RJUkVDVElPTl9GT1JXQVJEXSA9ICJmb3J3YXJkIiwKPiAtICAgICAgIFtDT1VO
VEVSX0NPVU5UX0RJUkVDVElPTl9CQUNLV0FSRF0gPSAiYmFja3dhcmQiCj4gLX07Cj4gLUVYUE9S
VF9TWU1CT0xfR1BMKGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0cik7Cj4gLQo+IC1jb25zdCBj
aGFyICpjb25zdCBjb3VudGVyX2NvdW50X21vZGVfc3RyWzRdID0gewo+IC0gICAgICAgW0NPVU5U
RVJfQ09VTlRfTU9ERV9OT1JNQUxdID0gIm5vcm1hbCIsCj4gLSAgICAgICBbQ09VTlRFUl9DT1VO
VF9NT0RFX1JBTkdFX0xJTUlUXSA9ICJyYW5nZSBsaW1pdCIsCj4gLSAgICAgICBbQ09VTlRFUl9D
T1VOVF9NT0RFX05PTl9SRUNZQ0xFXSA9ICJub24tcmVjeWNsZSIsCj4gLSAgICAgICBbQ09VTlRF
Ul9DT1VOVF9NT0RFX01PRFVMT19OXSA9ICJtb2R1bG8tbiIKPiAtfTsKPiAtRVhQT1JUX1NZTUJP
TF9HUEwoY291bnRlcl9jb3VudF9tb2RlX3N0cik7Cj4gLQo+IC1zc2l6ZV90IGNvdW50ZXJfc2ln
bmFsX2VudW1fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHZv
aWQgKnByaXYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqYnVmKQo+
IC17Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51bV9leHQgKmNvbnN0
IGUgPSBwcml2Owo+IC0gICAgICAgaW50IGVycjsKPiAtICAgICAgIHNpemVfdCBpbmRleDsKPiAt
Cj4gLSAgICAgICBpZiAoIWUtPmdldCkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
Cj4gLQo+IC0gICAgICAgZXJyID0gZS0+Z2V0KGNvdW50ZXIsIHNpZ25hbCwgJmluZGV4KTsKPiAt
ICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gLQo+IC0gICAg
ICAgaWYgKGluZGV4ID49IGUtPm51bV9pdGVtcykKPiAtICAgICAgICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7Cj4gLQo+IC0gICAgICAgcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGUtPml0ZW1z
W2luZGV4XSk7Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9zaWduYWxfZW51bV9y
ZWFkKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9zaWduYWxfZW51bV93cml0ZShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2LAo+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gLXsK
PiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCAqY29uc3QgZSA9
IHByaXY7Cj4gLSAgICAgICBzc2l6ZV90IGluZGV4Owo+IC0gICAgICAgaW50IGVycjsKPiAtCj4g
LSAgICAgICBpZiAoIWUtPnNldCkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4g
LQo+IC0gICAgICAgaW5kZXggPSBfX3N5c2ZzX21hdGNoX3N0cmluZyhlLT5pdGVtcywgZS0+bnVt
X2l0ZW1zLCBidWYpOwo+IC0gICAgICAgaWYgKGluZGV4IDwgMCkKPiAtICAgICAgICAgICAgICAg
cmV0dXJuIGluZGV4Owo+IC0KPiAtICAgICAgIGVyciA9IGUtPnNldChjb3VudGVyLCBzaWduYWws
IGluZGV4KTsKPiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBlcnI7
Cj4gLQo+IC0gICAgICAgcmV0dXJuIGxlbjsKPiAtfQo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3Vu
dGVyX3NpZ25hbF9lbnVtX3dyaXRlKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9zaWduYWxfZW51
bV9hdmFpbGFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCAqc2lnbmFsLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2
b2lkICpwcml2LCBjaGFyICpidWYpCj4gLXsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVy
X3NpZ25hbF9lbnVtX2V4dCAqY29uc3QgZSA9IHByaXY7Cj4gLSAgICAgICBzaXplX3QgaTsKPiAt
ICAgICAgIHNpemVfdCBsZW4gPSAwOwo+IC0KPiAtICAgICAgIGlmICghZS0+bnVtX2l0ZW1zKQo+
IC0gICAgICAgICAgICAgICByZXR1cm4gMDsKPiAtCj4gLSAgICAgICBmb3IgKGkgPSAwOyBpIDwg
ZS0+bnVtX2l0ZW1zOyBpKyspCj4gLSAgICAgICAgICAgICAgIGxlbiArPSBzcHJpbnRmKGJ1ZiAr
IGxlbiwgIiVzXG4iLCBlLT5pdGVtc1tpXSk7Cj4gLQo+IC0gICAgICAgcmV0dXJuIGxlbjsKPiAt
fQo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3NpZ25hbF9lbnVtX2F2YWlsYWJsZV9yZWFk
KTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9jb3VudF9lbnVtX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2LAo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY2hhciAqYnVmKQo+IC17Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRl
cl9jb3VudF9lbnVtX2V4dCAqY29uc3QgZSA9IHByaXY7Cj4gLSAgICAgICBpbnQgZXJyOwo+IC0g
ICAgICAgc2l6ZV90IGluZGV4Owo+IC0KPiAtICAgICAgIGlmICghZS0+Z2V0KQo+IC0gICAgICAg
ICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiAtCj4gLSAgICAgICBlcnIgPSBlLT5nZXQoY291bnRl
ciwgY291bnQsICZpbmRleCk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAgICAgICBy
ZXR1cm4gZXJyOwo+IC0KPiAtICAgICAgIGlmIChpbmRleCA+PSBlLT5udW1faXRlbXMpCj4gLSAg
ICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+IC0KPiAtICAgICAgIHJldHVybiBzcHJpbnRm
KGJ1ZiwgIiVzXG4iLCBlLT5pdGVtc1tpbmRleF0pOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xfR1BM
KGNvdW50ZXJfY291bnRfZW51bV9yZWFkKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9jb3VudF9l
bnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnBy
aXYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqYnVmLCBz
aXplX3QgbGVuKQo+IC17Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9lbnVt
X2V4dCAqY29uc3QgZSA9IHByaXY7Cj4gLSAgICAgICBzc2l6ZV90IGluZGV4Owo+IC0gICAgICAg
aW50IGVycjsKPiAtCj4gLSAgICAgICBpZiAoIWUtPnNldCkKPiAtICAgICAgICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7Cj4gLQo+IC0gICAgICAgaW5kZXggPSBfX3N5c2ZzX21hdGNoX3N0cmluZyhl
LT5pdGVtcywgZS0+bnVtX2l0ZW1zLCBidWYpOwo+IC0gICAgICAgaWYgKGluZGV4IDwgMCkKPiAt
ICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4Owo+IC0KPiAtICAgICAgIGVyciA9IGUtPnNldChj
b3VudGVyLCBjb3VudCwgaW5kZXgpOwo+IC0gICAgICAgaWYgKGVycikKPiAtICAgICAgICAgICAg
ICAgcmV0dXJuIGVycjsKPiAtCj4gLSAgICAgICByZXR1cm4gbGVuOwo+IC19Cj4gLUVYUE9SVF9T
WU1CT0xfR1BMKGNvdW50ZXJfY291bnRfZW51bV93cml0ZSk7Cj4gLQo+IC1zc2l6ZV90IGNvdW50
ZXJfY291bnRfZW51bV9hdmFpbGFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1ZikKPiAtewo+IC0gICAgICAgY29uc3Qgc3RydWN0
IGNvdW50ZXJfY291bnRfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+IC0gICAgICAgc2l6ZV90
IGk7Cj4gLSAgICAgICBzaXplX3QgbGVuID0gMDsKPiAtCj4gLSAgICAgICBpZiAoIWUtPm51bV9p
dGVtcykKPiAtICAgICAgICAgICAgICAgcmV0dXJuIDA7Cj4gLQo+IC0gICAgICAgZm9yIChpID0g
MDsgaSA8IGUtPm51bV9pdGVtczsgaSsrKQo+IC0gICAgICAgICAgICAgICBsZW4gKz0gc3ByaW50
ZihidWYgKyBsZW4sICIlc1xuIiwgZS0+aXRlbXNbaV0pOwo+IC0KPiAtICAgICAgIHJldHVybiBs
ZW47Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9jb3VudF9lbnVtX2F2YWlsYWJs
ZV9yZWFkKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9kZXZpY2VfZW51bV9yZWFkKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwgdm9pZCAqcHJpdiwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBjaGFyICpidWYpCj4gLXsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3Vu
dGVyX2RldmljZV9lbnVtX2V4dCAqY29uc3QgZSA9IHByaXY7Cj4gLSAgICAgICBpbnQgZXJyOwo+
IC0gICAgICAgc2l6ZV90IGluZGV4Owo+IC0KPiAtICAgICAgIGlmICghZS0+Z2V0KQo+IC0gICAg
ICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsKPiAtCj4gLSAgICAgICBlcnIgPSBlLT5nZXQoY291
bnRlciwgJmluZGV4KTsKPiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIHJldHVy
biBlcnI7Cj4gLQo+IC0gICAgICAgaWYgKGluZGV4ID49IGUtPm51bV9pdGVtcykKPiAtICAgICAg
ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gLQo+IC0gICAgICAgcmV0dXJuIHNwcmludGYoYnVm
LCAiJXNcbiIsIGUtPml0ZW1zW2luZGV4XSk7Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291
bnRlcl9kZXZpY2VfZW51bV9yZWFkKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9kZXZpY2VfZW51
bV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHZvaWQgKnByaXYsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxl
bikKPiAtewo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2VudW1fZXh0ICpj
b25zdCBlID0gcHJpdjsKPiAtICAgICAgIHNzaXplX3QgaW5kZXg7Cj4gLSAgICAgICBpbnQgZXJy
Owo+IC0KPiAtICAgICAgIGlmICghZS0+c2V0KQo+IC0gICAgICAgICAgICAgICByZXR1cm4gLUVJ
TlZBTDsKPiAtCj4gLSAgICAgICBpbmRleCA9IF9fc3lzZnNfbWF0Y2hfc3RyaW5nKGUtPml0ZW1z
LCBlLT5udW1faXRlbXMsIGJ1Zik7Cj4gLSAgICAgICBpZiAoaW5kZXggPCAwKQo+IC0gICAgICAg
ICAgICAgICByZXR1cm4gaW5kZXg7Cj4gLQo+IC0gICAgICAgZXJyID0gZS0+c2V0KGNvdW50ZXIs
IGluZGV4KTsKPiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBlcnI7
Cj4gLQo+IC0gICAgICAgcmV0dXJuIGxlbjsKPiAtfQo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3Vu
dGVyX2RldmljZV9lbnVtX3dyaXRlKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9kZXZpY2VfZW51
bV9hdmFpbGFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1
ZikKPiAtewo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2VudW1fZXh0ICpj
b25zdCBlID0gcHJpdjsKPiAtICAgICAgIHNpemVfdCBpOwo+IC0gICAgICAgc2l6ZV90IGxlbiA9
IDA7Cj4gLQo+IC0gICAgICAgaWYgKCFlLT5udW1faXRlbXMpCj4gLSAgICAgICAgICAgICAgIHJl
dHVybiAwOwo+IC0KPiAtICAgICAgIGZvciAoaSA9IDA7IGkgPCBlLT5udW1faXRlbXM7IGkrKykK
PiAtICAgICAgICAgICAgICAgbGVuICs9IHNwcmludGYoYnVmICsgbGVuLCAiJXNcbiIsIGUtPml0
ZW1zW2ldKTsKPiAtCj4gLSAgICAgICByZXR1cm4gbGVuOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xf
R1BMKGNvdW50ZXJfZGV2aWNlX2VudW1fYXZhaWxhYmxlX3JlYWQpOwo+IC0KPiAtc3RydWN0IGNv
dW50ZXJfYXR0cl9wYXJtIHsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dy
b3VwICpncm91cDsKPiAtICAgICAgIGNvbnN0IGNoYXIgKnByZWZpeDsKPiAtICAgICAgIGNvbnN0
IGNoYXIgKm5hbWU7Cj4gLSAgICAgICBzc2l6ZV90ICgqc2hvdykoc3RydWN0IGRldmljZSAqZGV2
LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtICAgICAgICAgICAgICAgICAgICAg
ICBjaGFyICpidWYpOwo+IC0gICAgICAgc3NpemVfdCAoKnN0b3JlKShzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+IC0gICAgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pOwo+IC0gICAgICAgdm9pZCAqY29tcG9u
ZW50Owo+IC19Owo+IC0KPiAtc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgewo+IC0gICAgICAg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgZGV2X2F0dHI7Cj4gLSAgICAgICBzdHJ1Y3QgbGlzdF9o
ZWFkIGw7Cj4gLSAgICAgICB2b2lkICpjb21wb25lbnQ7Cj4gLX07Cj4gLQo+IC1zdGF0aWMgaW50
IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZShjb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0g
KmNvbnN0IHBhcm0pCj4gLXsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpj
b3VudGVyX2F0dHI7Cj4gLSAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqZGV2X2F0dHI7
Cj4gLSAgICAgICBpbnQgZXJyOwo+IC0gICAgICAgc3RydWN0IGxpc3RfaGVhZCAqY29uc3QgYXR0
cl9saXN0ID0gJnBhcm0tPmdyb3VwLT5hdHRyX2xpc3Q7Cj4gLQo+IC0gICAgICAgLyogQWxsb2Nh
dGUgYSBDb3VudGVyIGRldmljZSBhdHRyaWJ1dGUgKi8KPiAtICAgICAgIGNvdW50ZXJfYXR0ciA9
IGt6YWxsb2Moc2l6ZW9mKCpjb3VudGVyX2F0dHIpLCBHRlBfS0VSTkVMKTsKPiAtICAgICAgIGlm
ICghY291bnRlcl9hdHRyKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiAtICAg
ICAgIGRldl9hdHRyID0gJmNvdW50ZXJfYXR0ci0+ZGV2X2F0dHI7Cj4gLQo+IC0gICAgICAgc3lz
ZnNfYXR0cl9pbml0KCZkZXZfYXR0ci0+YXR0cik7Cj4gLQo+IC0gICAgICAgLyogQ29uZmlndXJl
IGRldmljZSBhdHRyaWJ1dGUgKi8KPiAtICAgICAgIGRldl9hdHRyLT5hdHRyLm5hbWUgPSBrYXNw
cmludGYoR0ZQX0tFUk5FTCwgIiVzJXMiLCBwYXJtLT5wcmVmaXgsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHBhcm0tPm5hbWUpOwo+IC0gICAgICAgaWYgKCFkZXZf
YXR0ci0+YXR0ci5uYW1lKSB7Cj4gLSAgICAgICAgICAgICAgIGVyciA9IC1FTk9NRU07Cj4gLSAg
ICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfY291bnRlcl9hdHRyOwo+IC0gICAgICAgfQo+IC0g
ICAgICAgaWYgKHBhcm0tPnNob3cpIHsKPiAtICAgICAgICAgICAgICAgZGV2X2F0dHItPmF0dHIu
bW9kZSB8PSAwNDQ0Owo+IC0gICAgICAgICAgICAgICBkZXZfYXR0ci0+c2hvdyA9IHBhcm0tPnNo
b3c7Cj4gLSAgICAgICB9Cj4gLSAgICAgICBpZiAocGFybS0+c3RvcmUpIHsKPiAtICAgICAgICAg
ICAgICAgZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAwOwo+IC0gICAgICAgICAgICAgICBkZXZf
YXR0ci0+c3RvcmUgPSBwYXJtLT5zdG9yZTsKPiAtICAgICAgIH0KPiAtCj4gLSAgICAgICAvKiBT
dG9yZSBhc3NvY2lhdGVkIENvdW50ZXIgY29tcG9uZW50IHdpdGggYXR0cmlidXRlICovCj4gLSAg
ICAgICBjb3VudGVyX2F0dHItPmNvbXBvbmVudCA9IHBhcm0tPmNvbXBvbmVudDsKPiAtCj4gLSAg
ICAgICAvKiBLZWVwIHRyYWNrIG9mIHRoZSBhdHRyaWJ1dGUgZm9yIGxhdGVyIGNsZWFudXAgKi8K
PiAtICAgICAgIGxpc3RfYWRkKCZjb3VudGVyX2F0dHItPmwsIGF0dHJfbGlzdCk7Cj4gLSAgICAg
ICBwYXJtLT5ncm91cC0+bnVtX2F0dHIrKzsKPiAtCj4gLSAgICAgICByZXR1cm4gMDsKPiAtCj4g
LWVycl9mcmVlX2NvdW50ZXJfYXR0cjoKPiAtICAgICAgIGtmcmVlKGNvdW50ZXJfYXR0cik7Cj4g
LSAgICAgICByZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC0jZGVmaW5lIHRvX2NvdW50ZXJfYXR0cihf
ZGV2X2F0dHIpIFwKPiAtICAgICAgIGNvbnRhaW5lcl9vZihfZGV2X2F0dHIsIHN0cnVjdCBjb3Vu
dGVyX2RldmljZV9hdHRyLCBkZXZfYXR0cikKPiAtCj4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbF91
bml0IHsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsOwo+IC19Owo+IC0K
PiAtc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfc2lnbmFsX2xldmVsX3N0cltdID0g
ewo+IC0gICAgICAgW0NPVU5URVJfU0lHTkFMX0xFVkVMX0xPV10gPSAibG93IiwKPiAtICAgICAg
IFtDT1VOVEVSX1NJR05BTF9MRVZFTF9ISUdIXSA9ICJoaWdoIgo+IC19Owo+IC0KPiAtc3RhdGlj
IHNzaXplX3QgY291bnRlcl9zaWduYWxfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQo+IC17Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0
IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBj
b3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIp
Owo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX3VuaXQgKmNvbnN0IGNvbXBv
bmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCAqY29uc3Qgc2lnbmFsID0gY29tcG9uZW50LT5zaWduYWw7Cj4gLSAgICAgICBpbnQgZXJyOwo+
IC0gICAgICAgZW51bSBjb3VudGVyX3NpZ25hbF9sZXZlbCBsZXZlbDsKPiAtCj4gLSAgICAgICBl
cnIgPSBjb3VudGVyLT5vcHMtPnNpZ25hbF9yZWFkKGNvdW50ZXIsIHNpZ25hbCwgJmxldmVsKTsK
PiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gLQo+IC0g
ICAgICAgcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGNvdW50ZXJfc2lnbmFsX2xldmVsX3N0
cltsZXZlbF0pOwo+IC19Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9uYW1lX3VuaXQgewo+IC0gICAg
ICAgY29uc3QgY2hhciAqbmFtZTsKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJf
ZGV2aWNlX2F0dHJfbmFtZV9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAq
YXR0ciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFy
ICpidWYpCj4gLXsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX25hbWVfdW5pdCAqY29u
c3QgY29tcCA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKS0+Y29tcG9uZW50Owo+IC0KPiAtICAgICAg
IHJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb21wLT5uYW1lKTsKPiAtfQo+IC0KPiAtc3Rh
dGljIGludCBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0ZSgKPiAtICAgICAgIHN0cnVjdCBj
b3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiAtICAgICAgIGNvbnN0IGNo
YXIgKmNvbnN0IG5hbWUpCj4gLXsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX25hbWVfdW5pdCAq
bmFtZV9jb21wOwo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Cj4gLSAg
ICAgICBpbnQgZXJyOwo+IC0KPiAtICAgICAgIC8qIFNraXAgaWYgbm8gbmFtZSAqLwo+IC0gICAg
ICAgaWYgKCFuYW1lKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gMDsKPiAtCj4gLSAgICAgICAv
KiBBbGxvY2F0ZSBuYW1lIGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiAtICAgICAgIG5hbWVfY29t
cCA9IGttYWxsb2Moc2l6ZW9mKCpuYW1lX2NvbXApLCBHRlBfS0VSTkVMKTsKPiAtICAgICAgIGlm
ICghbmFtZV9jb21wKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsKPiAtICAgICAg
IG5hbWVfY29tcC0+bmFtZSA9IG5hbWU7Cj4gLQo+IC0gICAgICAgLyogQWxsb2NhdGUgU2lnbmFs
IG5hbWUgYXR0cmlidXRlICovCj4gLSAgICAgICBwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gLSAgICAg
ICBwYXJtLnByZWZpeCA9ICIiOwo+IC0gICAgICAgcGFybS5uYW1lID0gIm5hbWUiOwo+IC0gICAg
ICAgcGFybS5zaG93ID0gY291bnRlcl9kZXZpY2VfYXR0cl9uYW1lX3Nob3c7Cj4gLSAgICAgICBw
YXJtLnN0b3JlID0gTlVMTDsKPiAtICAgICAgIHBhcm0uY29tcG9uZW50ID0gbmFtZV9jb21wOwo+
IC0gICAgICAgZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAtICAgICAg
IGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfbmFtZV9jb21wOwo+IC0K
PiAtICAgICAgIHJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfbmFtZV9jb21wOgo+IC0gICAgICAg
a2ZyZWUobmFtZV9jb21wKTsKPiAtICAgICAgIHJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0cnVj
dCBjb3VudGVyX3NpZ25hbF9leHRfdW5pdCB7Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWdu
YWwgKnNpZ25hbDsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgKmV4
dDsKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfc2lnbmFsX2V4dF9zaG93KHN0
cnVjdCBkZXZpY2UgKmRldiwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+IC17Cj4gLSAgICAg
ICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2Nv
dW50ZXJfYXR0cihhdHRyKTsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9l
eHRfdW5pdCAqY29uc3QgY29tcCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtICAgICAgIGNvbnN0
IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgKmNvbnN0IGV4dCA9IGNvbXAtPmV4dDsKPiAtCj4g
LSAgICAgICByZXR1cm4gZXh0LT5yZWFkKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBjb21wLT5zaWdu
YWwsIGV4dC0+cHJpdiwgYnVmKTsKPiAtfQo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9z
aWduYWxfZXh0X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGxlbikKPiAtewo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIg
KmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLSAgICAgICBjb25zdCBz
dHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0X3VuaXQgKmNvbnN0IGNvbXAgPSBkZXZhdHRyLT5jb21w
b25lbnQ7Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0ICpjb25zdCBl
eHQgPSBjb21wLT5leHQ7Cj4gLQo+IC0gICAgICAgcmV0dXJuIGV4dC0+d3JpdGUoZGV2X2dldF9k
cnZkYXRhKGRldiksIGNvbXAtPnNpZ25hbCwgZXh0LT5wcml2LCBidWYsCj4gLSAgICAgICAgICAg
ICAgIGxlbik7Cj4gLX0KPiAtCj4gLXN0YXRpYyB2b2lkIGNvdW50ZXJfZGV2aWNlX2F0dHJfbGlz
dF9mcmVlKHN0cnVjdCBsaXN0X2hlYWQgKmF0dHJfbGlzdCkKPiAtewo+IC0gICAgICAgc3RydWN0
IGNvdW50ZXJfZGV2aWNlX2F0dHIgKnAsICpuOwo+IC0KPiAtICAgICAgIGxpc3RfZm9yX2VhY2hf
ZW50cnlfc2FmZShwLCBuLCBhdHRyX2xpc3QsIGwpIHsKPiAtICAgICAgICAgICAgICAgLyogZnJl
ZSBhdHRyaWJ1dGUgbmFtZSBhbmQgYXNzb2NpYXRlZCBjb21wb25lbnQgbWVtb3J5ICovCj4gLSAg
ICAgICAgICAgICAgIGtmcmVlKHAtPmRldl9hdHRyLmF0dHIubmFtZSk7Cj4gLSAgICAgICAgICAg
ICAgIGtmcmVlKHAtPmNvbXBvbmVudCk7Cj4gLSAgICAgICAgICAgICAgIGxpc3RfZGVsKCZwLT5s
KTsKPiAtICAgICAgICAgICAgICAga2ZyZWUocCk7Cj4gLSAgICAgICB9Cj4gLX0KPiAtCj4gLXN0
YXRpYyBpbnQgY291bnRlcl9zaWduYWxfZXh0X3JlZ2lzdGVyKAo+IC0gICAgICAgc3RydWN0IGNv
dW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3VwLAo+IC0gICAgICAgc3RydWN0IGNv
dW50ZXJfc2lnbmFsICpjb25zdCBzaWduYWwpCj4gLXsKPiAtICAgICAgIGNvbnN0IHNpemVfdCBu
dW1fZXh0ID0gc2lnbmFsLT5udW1fZXh0Owo+IC0gICAgICAgc2l6ZV90IGk7Cj4gLSAgICAgICBj
b25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0ICpleHQ7Cj4gLSAgICAgICBzdHJ1Y3QgY291
bnRlcl9zaWduYWxfZXh0X3VuaXQgKnNpZ25hbF9leHRfY29tcDsKPiAtICAgICAgIHN0cnVjdCBj
b3VudGVyX2F0dHJfcGFybSBwYXJtOwo+IC0gICAgICAgaW50IGVycjsKPiAtCj4gLSAgICAgICAv
KiBDcmVhdGUgYW4gYXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwo+IC0gICAgICAgZm9y
IChpID0gMCA7IGkgPCBudW1fZXh0OyBpKyspIHsKPiAtICAgICAgICAgICAgICAgZXh0ID0gc2ln
bmFsLT5leHQgKyBpOwo+IC0KPiAtICAgICAgICAgICAgICAgLyogQWxsb2NhdGUgc2lnbmFsX2V4
dCBhdHRyaWJ1dGUgY29tcG9uZW50ICovCj4gLSAgICAgICAgICAgICAgIHNpZ25hbF9leHRfY29t
cCA9IGttYWxsb2Moc2l6ZW9mKCpzaWduYWxfZXh0X2NvbXApLCBHRlBfS0VSTkVMKTsKPiAtICAg
ICAgICAgICAgICAgaWYgKCFzaWduYWxfZXh0X2NvbXApIHsKPiAtICAgICAgICAgICAgICAgICAg
ICAgICBlcnIgPSAtRU5PTUVNOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX2Zy
ZWVfYXR0cl9saXN0Owo+IC0gICAgICAgICAgICAgICB9Cj4gLSAgICAgICAgICAgICAgIHNpZ25h
bF9leHRfY29tcC0+c2lnbmFsID0gc2lnbmFsOwo+IC0gICAgICAgICAgICAgICBzaWduYWxfZXh0
X2NvbXAtPmV4dCA9IGV4dDsKPiAtCj4gLSAgICAgICAgICAgICAgIC8qIEFsbG9jYXRlIGEgQ291
bnRlciBkZXZpY2UgYXR0cmlidXRlICovCj4gLSAgICAgICAgICAgICAgIHBhcm0uZ3JvdXAgPSBn
cm91cDsKPiAtICAgICAgICAgICAgICAgcGFybS5wcmVmaXggPSAiIjsKPiAtICAgICAgICAgICAg
ICAgcGFybS5uYW1lID0gZXh0LT5uYW1lOwo+IC0gICAgICAgICAgICAgICBwYXJtLnNob3cgPSAo
ZXh0LT5yZWFkKSA/IGNvdW50ZXJfc2lnbmFsX2V4dF9zaG93IDogTlVMTDsKPiAtICAgICAgICAg
ICAgICAgcGFybS5zdG9yZSA9IChleHQtPndyaXRlKSA/IGNvdW50ZXJfc2lnbmFsX2V4dF9zdG9y
ZSA6IE5VTEw7Cj4gLSAgICAgICAgICAgICAgIHBhcm0uY29tcG9uZW50ID0gc2lnbmFsX2V4dF9j
b21wOwo+IC0gICAgICAgICAgICAgICBlcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBh
cm0pOwo+IC0gICAgICAgICAgICAgICBpZiAoZXJyKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAg
ICAga2ZyZWUoc2lnbmFsX2V4dF9jb21wKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBnb3Rv
IGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtICAgICAgICAgICAgICAgfQo+IC0gICAgICAgfQo+IC0K
PiAtICAgICAgIHJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfYXR0cl9saXN0Ogo+IC0gICAgICAg
Y291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwo+IC0gICAg
ICAgcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBjb3VudGVyX3NpZ25hbF9hdHRy
aWJ1dGVzX2NyZWF0ZSgKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3Vw
ICpjb25zdCBncm91cCwKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29u
c3QgY291bnRlciwKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qgc2lnbmFs
KQo+IC17Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWxfdW5pdCAqc2lnbmFsX2NvbXA7
Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiAtICAgICAgIGludCBl
cnI7Cj4gLQo+IC0gICAgICAgLyogQWxsb2NhdGUgU2lnbmFsIGF0dHJpYnV0ZSBjb21wb25lbnQg
Ki8KPiAtICAgICAgIHNpZ25hbF9jb21wID0ga21hbGxvYyhzaXplb2YoKnNpZ25hbF9jb21wKSwg
R0ZQX0tFUk5FTCk7Cj4gLSAgICAgICBpZiAoIXNpZ25hbF9jb21wKQo+IC0gICAgICAgICAgICAg
ICByZXR1cm4gLUVOT01FTTsKPiAtICAgICAgIHNpZ25hbF9jb21wLT5zaWduYWwgPSBzaWduYWw7
Cj4gLQo+IC0gICAgICAgLyogQ3JlYXRlIG1haW4gU2lnbmFsIGF0dHJpYnV0ZSAqLwo+IC0gICAg
ICAgcGFybS5ncm91cCA9IGdyb3VwOwo+IC0gICAgICAgcGFybS5wcmVmaXggPSAiIjsKPiAtICAg
ICAgIHBhcm0ubmFtZSA9ICJzaWduYWwiOwo+IC0gICAgICAgcGFybS5zaG93ID0gKGNvdW50ZXIt
Pm9wcy0+c2lnbmFsX3JlYWQpID8gY291bnRlcl9zaWduYWxfc2hvdyA6IE5VTEw7Cj4gLSAgICAg
ICBwYXJtLnN0b3JlID0gTlVMTDsKPiAtICAgICAgIHBhcm0uY29tcG9uZW50ID0gc2lnbmFsX2Nv
bXA7Cj4gLSAgICAgICBlcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+IC0g
ICAgICAgaWYgKGVycikgewo+IC0gICAgICAgICAgICAgICBrZnJlZShzaWduYWxfY29tcCk7Cj4g
LSAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gLSAgICAgICB9Cj4gLQo+IC0gICAgICAgLyog
Q3JlYXRlIFNpZ25hbCBuYW1lIGF0dHJpYnV0ZSAqLwo+IC0gICAgICAgZXJyID0gY291bnRlcl9u
YW1lX2F0dHJpYnV0ZV9jcmVhdGUoZ3JvdXAsIHNpZ25hbC0+bmFtZSk7Cj4gLSAgICAgICBpZiAo
ZXJyKQo+IC0gICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCj4gLSAg
ICAgICAvKiBSZWdpc3RlciBTaWduYWwgZXh0ZW5zaW9uIGF0dHJpYnV0ZXMgKi8KPiAtICAgICAg
IGVyciA9IGNvdW50ZXJfc2lnbmFsX2V4dF9yZWdpc3Rlcihncm91cCwgc2lnbmFsKTsKPiAtICAg
ICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+
IC0KPiAtICAgICAgIHJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfYXR0cl9saXN0Ogo+IC0gICAg
ICAgY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwo+IC0g
ICAgICAgcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBjb3VudGVyX3NpZ25hbHNf
cmVnaXN0ZXIoCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29u
c3QgZ3JvdXBzX2xpc3QsCj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
bnN0IGNvdW50ZXIpCj4gLXsKPiAtICAgICAgIGNvbnN0IHNpemVfdCBudW1fc2lnbmFscyA9IGNv
dW50ZXItPm51bV9zaWduYWxzOwo+IC0gICAgICAgc2l6ZV90IGk7Cj4gLSAgICAgICBzdHJ1Y3Qg
Y291bnRlcl9zaWduYWwgKnNpZ25hbDsKPiAtICAgICAgIGNvbnN0IGNoYXIgKm5hbWU7Cj4gLSAg
ICAgICBpbnQgZXJyOwo+IC0KPiAtICAgICAgIC8qIFJlZ2lzdGVyIGVhY2ggU2lnbmFsICovCj4g
LSAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtX3NpZ25hbHM7IGkrKykgewo+IC0gICAgICAgICAg
ICAgICBzaWduYWwgPSBjb3VudGVyLT5zaWduYWxzICsgaTsKPiAtCj4gLSAgICAgICAgICAgICAg
IC8qIEdlbmVyYXRlIFNpZ25hbCBhdHRyaWJ1dGUgZGlyZWN0b3J5IG5hbWUgKi8KPiAtICAgICAg
ICAgICAgICAgbmFtZSA9IGthc3ByaW50ZihHRlBfS0VSTkVMLCAic2lnbmFsJWQiLCBzaWduYWwt
PmlkKTsKPiAtICAgICAgICAgICAgICAgaWYgKCFuYW1lKSB7Cj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgZXJyID0gLUVOT01FTTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9m
cmVlX2F0dHJfZ3JvdXBzOwo+IC0gICAgICAgICAgICAgICB9Cj4gLSAgICAgICAgICAgICAgIGdy
b3Vwc19saXN0W2ldLmF0dHJfZ3JvdXAubmFtZSA9IG5hbWU7Cj4gLQo+IC0gICAgICAgICAgICAg
ICAvKiBDcmVhdGUgYWxsIGF0dHJpYnV0ZXMgYXNzb2NpYXRlZCB3aXRoIFNpZ25hbCAqLwo+IC0g
ICAgICAgICAgICAgICBlcnIgPSBjb3VudGVyX3NpZ25hbF9hdHRyaWJ1dGVzX2NyZWF0ZShncm91
cHNfbGlzdCArIGksIGNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHNpZ25hbCk7Cj4gLSAgICAgICAgICAgICAgIGlmIChlcnIp
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9hdHRyX2dyb3VwczsKPiAt
ICAgICAgIH0KPiAtCj4gLSAgICAgICByZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2F0dHJfZ3Jv
dXBzOgo+IC0gICAgICAgZG8gewo+IC0gICAgICAgICAgICAgICBrZnJlZShncm91cHNfbGlzdFtp
XS5hdHRyX2dyb3VwLm5hbWUpOwo+IC0gICAgICAgICAgICAgICBjb3VudGVyX2RldmljZV9hdHRy
X2xpc3RfZnJlZSgmZ3JvdXBzX2xpc3RbaV0uYXR0cl9saXN0KTsKPiAtICAgICAgIH0gd2hpbGUg
KGktLSk7Cj4gLSAgICAgICByZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdGF0aWMgY29uc3QgY2hh
ciAqY29uc3QgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHJbXSA9IHsKPiAtICAgICAgIFtDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX05PTkVdID0gIm5vbmUiLAo+IC0gICAgICAgW0NPVU5URVJfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0VdID0gInJpc2luZyBlZGdlIiwKPiAtICAgICAgIFtDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRV0gPSAiZmFsbGluZyBlZGdlIiwKPiAtICAg
ICAgIFtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVNdID0gImJvdGggZWRnZXMiCj4g
LX07Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9hY3Rpb25fdW5pdCB7Cj4gLSAgICAgICBzdHJ1Y3Qg
Y291bnRlcl9zeW5hcHNlICpzeW5hcHNlOwo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50Owo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9hY3Rpb25fc2hvdyhz
dHJ1Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+IC17Cj4gLSAgICAgICBj
b25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50
ZXJfYXR0cihhdHRyKTsKPiAtICAgICAgIGludCBlcnI7Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtICAgICAg
IGNvbnN0IHN0cnVjdCBjb3VudGVyX2FjdGlvbl91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZh
dHRyLT5jb21wb25lbnQ7Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291
bnQgPSBjb21wb25lbnQtPmNvdW50Owo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAq
Y29uc3Qgc3luYXBzZSA9IGNvbXBvbmVudC0+c3luYXBzZTsKPiAtICAgICAgIHNpemVfdCBhY3Rp
b25faW5kZXg7Cj4gLSAgICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uOwo+
IC0KPiAtICAgICAgIGVyciA9IGNvdW50ZXItPm9wcy0+YWN0aW9uX2dldChjb3VudGVyLCBjb3Vu
dCwgc3luYXBzZSwgJmFjdGlvbl9pbmRleCk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAg
ICAgICAgICByZXR1cm4gZXJyOwo+IC0KPiAtICAgICAgIHN5bmFwc2UtPmFjdGlvbiA9IGFjdGlv
bl9pbmRleDsKPiAtCj4gLSAgICAgICBhY3Rpb24gPSBzeW5hcHNlLT5hY3Rpb25zX2xpc3RbYWN0
aW9uX2luZGV4XTsKPiAtICAgICAgIHJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb3VudGVy
X3N5bmFwc2VfYWN0aW9uX3N0clthY3Rpb25dKTsKPiAtfQo+IC0KPiAtc3RhdGljIHNzaXplX3Qg
Y291bnRlcl9hY3Rpb25fc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90
IGxlbikKPiAtewo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNv
bnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLSAgICAgICBjb25zdCBzdHJ1
Y3QgY291bnRlcl9hY3Rpb25fdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9u
ZW50Owo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGNv
bXBvbmVudC0+c3luYXBzZTsKPiAtICAgICAgIHNpemVfdCBhY3Rpb25faW5kZXg7Cj4gLSAgICAg
ICBjb25zdCBzaXplX3QgbnVtX2FjdGlvbnMgPSBzeW5hcHNlLT5udW1fYWN0aW9uczsKPiAtICAg
ICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rpb247Cj4gLSAgICAgICBpbnQgZXJy
Owo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dl
dF9kcnZkYXRhKGRldik7Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291
bnQgPSBjb21wb25lbnQtPmNvdW50Owo+IC0KPiAtICAgICAgIC8qIEZpbmQgcmVxdWVzdGVkIGFj
dGlvbiBtb2RlICovCj4gLSAgICAgICBmb3IgKGFjdGlvbl9pbmRleCA9IDA7IGFjdGlvbl9pbmRl
eCA8IG51bV9hY3Rpb25zOyBhY3Rpb25faW5kZXgrKykgewo+IC0gICAgICAgICAgICAgICBhY3Rp
b24gPSBzeW5hcHNlLT5hY3Rpb25zX2xpc3RbYWN0aW9uX2luZGV4XTsKPiAtICAgICAgICAgICAg
ICAgaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHJbYWN0aW9u
XSkpCj4gLSAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gLSAgICAgICB9Cj4gLSAgICAg
ICAvKiBJZiByZXF1ZXN0ZWQgYWN0aW9uIG1vZGUgbm90IGZvdW5kICovCj4gLSAgICAgICBpZiAo
YWN0aW9uX2luZGV4ID49IG51bV9hY3Rpb25zKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gLUVJ
TlZBTDsKPiAtCj4gLSAgICAgICBlcnIgPSBjb3VudGVyLT5vcHMtPmFjdGlvbl9zZXQoY291bnRl
ciwgY291bnQsIHN5bmFwc2UsIGFjdGlvbl9pbmRleCk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0g
ICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+IC0KPiAtICAgICAgIHN5bmFwc2UtPmFjdGlvbiA9
IGFjdGlvbl9pbmRleDsKPiAtCj4gLSAgICAgICByZXR1cm4gbGVuOwo+IC19Cj4gLQo+IC1zdHJ1
Y3QgY291bnRlcl9hY3Rpb25fYXZhaWxfdW5pdCB7Cj4gLSAgICAgICBjb25zdCBlbnVtIGNvdW50
ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbnNfbGlzdDsKPiAtICAgICAgIHNpemVfdCBudW1fYWN0
aW9uczsKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfc3luYXBzZV9hY3Rpb25f
YXZhaWxhYmxlX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+IC0gICAgICAgc3RydWN0IGRldmlj
ZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAtewo+IC0gICAgICAgY29uc3Qgc3RydWN0
IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0
cik7Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9hY3Rpb25fYXZhaWxfdW5pdCAqY29u
c3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0gICAgICAgc2l6ZV90IGk7Cj4g
LSAgICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uOwo+IC0gICAgICAgc3Np
emVfdCBsZW4gPSAwOwo+IC0KPiAtICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb21wb25lbnQtPm51
bV9hY3Rpb25zOyBpKyspIHsKPiAtICAgICAgICAgICAgICAgYWN0aW9uID0gY29tcG9uZW50LT5h
Y3Rpb25zX2xpc3RbaV07Cj4gLSAgICAgICAgICAgICAgIGxlbiArPSBzcHJpbnRmKGJ1ZiArIGxl
biwgIiVzXG4iLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudGVyX3N5bmFw
c2VfYWN0aW9uX3N0clthY3Rpb25dKTsKPiAtICAgICAgIH0KPiAtCj4gLSAgICAgICByZXR1cm4g
bGVuOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJfc3luYXBzZXNfcmVnaXN0ZXIoCj4g
LSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCj4g
LSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIsCj4gLSAg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQsIGNvbnN0IGNoYXIgKmNvbnN0
IGNvdW50X2F0dHJfbmFtZSkKPiAtewo+IC0gICAgICAgc2l6ZV90IGk7Cj4gLSAgICAgICBzdHJ1
Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlOwo+IC0gICAgICAgY29uc3QgY2hhciAqcHJlZml4
Owo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfYWN0aW9uX3VuaXQgKmFjdGlvbl9jb21wOwo+IC0g
ICAgICAgc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Cj4gLSAgICAgICBpbnQgZXJyOwo+
IC0gICAgICAgc3RydWN0IGNvdW50ZXJfYWN0aW9uX2F2YWlsX3VuaXQgKmF2YWlsX2NvbXA7Cj4g
LQo+IC0gICAgICAgLyogUmVnaXN0ZXIgZWFjaCBTeW5hcHNlICovCj4gLSAgICAgICBmb3IgKGkg
PSAwOyBpIDwgY291bnQtPm51bV9zeW5hcHNlczsgaSsrKSB7Cj4gLSAgICAgICAgICAgICAgIHN5
bmFwc2UgPSBjb3VudC0+c3luYXBzZXMgKyBpOwo+IC0KPiAtICAgICAgICAgICAgICAgLyogR2Vu
ZXJhdGUgYXR0cmlidXRlIHByZWZpeCAqLwo+IC0gICAgICAgICAgICAgICBwcmVmaXggPSBrYXNw
cmludGYoR0ZQX0tFUk5FTCwgInNpZ25hbCVkXyIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzeW5hcHNlLT5zaWduYWwtPmlkKTsKPiAtICAgICAgICAgICAgICAgaWYgKCFw
cmVmaXgpIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSAtRU5PTUVNOwo+IC0gICAg
ICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0gICAgICAgICAg
ICAgICB9Cj4gLQo+IC0gICAgICAgICAgICAgICAvKiBBbGxvY2F0ZSBhY3Rpb24gYXR0cmlidXRl
IGNvbXBvbmVudCAqLwo+IC0gICAgICAgICAgICAgICBhY3Rpb25fY29tcCA9IGttYWxsb2Moc2l6
ZW9mKCphY3Rpb25fY29tcCksIEdGUF9LRVJORUwpOwo+IC0gICAgICAgICAgICAgICBpZiAoIWFj
dGlvbl9jb21wKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZXJyID0gLUVOT01FTTsKPiAt
ICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX3ByZWZpeDsKPiAtICAgICAgICAg
ICAgICAgfQo+IC0gICAgICAgICAgICAgICBhY3Rpb25fY29tcC0+c3luYXBzZSA9IHN5bmFwc2U7
Cj4gLSAgICAgICAgICAgICAgIGFjdGlvbl9jb21wLT5jb3VudCA9IGNvdW50Owo+IC0KPiAtICAg
ICAgICAgICAgICAgLyogQ3JlYXRlIGFjdGlvbiBhdHRyaWJ1dGUgKi8KPiAtICAgICAgICAgICAg
ICAgcGFybS5ncm91cCA9IGdyb3VwOwo+IC0gICAgICAgICAgICAgICBwYXJtLnByZWZpeCA9IHBy
ZWZpeDsKPiAtICAgICAgICAgICAgICAgcGFybS5uYW1lID0gImFjdGlvbiI7Cj4gLSAgICAgICAg
ICAgICAgIHBhcm0uc2hvdyA9IChjb3VudGVyLT5vcHMtPmFjdGlvbl9nZXQpID8gY291bnRlcl9h
Y3Rpb25fc2hvdyA6IE5VTEw7Cj4gLSAgICAgICAgICAgICAgIHBhcm0uc3RvcmUgPSAoY291bnRl
ci0+b3BzLT5hY3Rpb25fc2V0KSA/IGNvdW50ZXJfYWN0aW9uX3N0b3JlIDogTlVMTDsKPiAtICAg
ICAgICAgICAgICAgcGFybS5jb21wb25lbnQgPSBhY3Rpb25fY29tcDsKPiAtICAgICAgICAgICAg
ICAgZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAtICAgICAgICAgICAg
ICAgaWYgKGVycikgewo+IC0gICAgICAgICAgICAgICAgICAgICAgIGtmcmVlKGFjdGlvbl9jb21w
KTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX3ByZWZpeDsKPiAtICAg
ICAgICAgICAgICAgfQo+IC0KPiAtICAgICAgICAgICAgICAgLyogQWxsb2NhdGUgYWN0aW9uIGF2
YWlsYWJsZSBhdHRyaWJ1dGUgY29tcG9uZW50ICovCj4gLSAgICAgICAgICAgICAgIGF2YWlsX2Nv
bXAgPSBrbWFsbG9jKHNpemVvZigqYXZhaWxfY29tcCksIEdGUF9LRVJORUwpOwo+IC0gICAgICAg
ICAgICAgICBpZiAoIWF2YWlsX2NvbXApIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICBlcnIg
PSAtRU5PTUVNOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfcHJlZml4
Owo+IC0gICAgICAgICAgICAgICB9Cj4gLSAgICAgICAgICAgICAgIGF2YWlsX2NvbXAtPmFjdGlv
bnNfbGlzdCA9IHN5bmFwc2UtPmFjdGlvbnNfbGlzdDsKPiAtICAgICAgICAgICAgICAgYXZhaWxf
Y29tcC0+bnVtX2FjdGlvbnMgPSBzeW5hcHNlLT5udW1fYWN0aW9uczsKPiAtCj4gLSAgICAgICAg
ICAgICAgIC8qIENyZWF0ZSBhY3Rpb25fYXZhaWxhYmxlIGF0dHJpYnV0ZSAqLwo+IC0gICAgICAg
ICAgICAgICBwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gLSAgICAgICAgICAgICAgIHBhcm0ucHJlZml4
ID0gcHJlZml4Owo+IC0gICAgICAgICAgICAgICBwYXJtLm5hbWUgPSAiYWN0aW9uX2F2YWlsYWJs
ZSI7Cj4gLSAgICAgICAgICAgICAgIHBhcm0uc2hvdyA9IGNvdW50ZXJfc3luYXBzZV9hY3Rpb25f
YXZhaWxhYmxlX3Nob3c7Cj4gLSAgICAgICAgICAgICAgIHBhcm0uc3RvcmUgPSBOVUxMOwo+IC0g
ICAgICAgICAgICAgICBwYXJtLmNvbXBvbmVudCA9IGF2YWlsX2NvbXA7Cj4gLSAgICAgICAgICAg
ICAgIGVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLSAgICAgICAgICAg
ICAgIGlmIChlcnIpIHsKPiAtICAgICAgICAgICAgICAgICAgICAgICBrZnJlZShhdmFpbF9jb21w
KTsKPiAtICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX3ByZWZpeDsKPiAtICAg
ICAgICAgICAgICAgfQo+IC0KPiAtICAgICAgICAgICAgICAga2ZyZWUocHJlZml4KTsKPiAtICAg
ICAgIH0KPiAtCj4gLSAgICAgICByZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX3ByZWZpeDoKPiAt
ICAgICAgIGtmcmVlKHByZWZpeCk7Cj4gLWVycl9mcmVlX2F0dHJfbGlzdDoKPiAtICAgICAgIGNv
dW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsKPiAtICAgICAg
IHJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgewo+IC0g
ICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50Owo+IC19Owo+IC0KPiAtc3RhdGljIHNz
aXplX3QgY291bnRlcl9jb3VudF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKmJ1ZikKPiAtewo+IC0gICAg
ICAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRh
KGRldik7Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3Qg
ZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBj
b3VudGVyX2NvdW50X3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsK
PiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGNvbXBvbmVudC0+
Y291bnQ7Cj4gLSAgICAgICBpbnQgZXJyOwo+IC0gICAgICAgdW5zaWduZWQgbG9uZyB2YWw7Cj4g
LQo+IC0gICAgICAgZXJyID0gY291bnRlci0+b3BzLT5jb3VudF9yZWFkKGNvdW50ZXIsIGNvdW50
LCAmdmFsKTsKPiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBlcnI7
Cj4gLQo+IC0gICAgICAgcmV0dXJuIHNwcmludGYoYnVmLCAiJWx1XG4iLCB2YWwpOwo+IC19Cj4g
LQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvdW50X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0
cmlidXRlICphdHRyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
Y2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtICAgICAgIGNvbnN0
IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9h
dHRyKGF0dHIpOwo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqY29u
c3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0gICAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gY29tcG9uZW50LT5jb3VudDsKPiAtICAgICAgIGludCBl
cnI7Cj4gLSAgICAgICB1bnNpZ25lZCBsb25nIHZhbDsKPiAtCj4gLSAgICAgICBlcnIgPSBrc3Ry
dG91bChidWYsIDAsICZ2YWwpOwo+IC0gICAgICAgaWYgKGVycikKPiAtICAgICAgICAgICAgICAg
cmV0dXJuIGVycjsKPiAtCj4gLSAgICAgICBlcnIgPSBjb3VudGVyLT5vcHMtPmNvdW50X3dyaXRl
KGNvdW50ZXIsIGNvdW50LCB2YWwpOwo+IC0gICAgICAgaWYgKGVycikKPiAtICAgICAgICAgICAg
ICAgcmV0dXJuIGVycjsKPiAtCj4gLSAgICAgICByZXR1cm4gbGVuOwo+IC19Cj4gLQo+IC1zdGF0
aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9mdW5jdGlvbl9zdHJbXSA9IHsKPiAtICAgICAg
IFtDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFXSA9ICJpbmNyZWFzZSIsCj4gLSAgICAgICBbQ09V
TlRFUl9GVU5DVElPTl9ERUNSRUFTRV0gPSAiZGVjcmVhc2UiLAo+IC0gICAgICAgW0NPVU5URVJf
RlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OXSA9ICJwdWxzZS1kaXJlY3Rpb24iLAo+IC0gICAgICAg
W0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BXSA9ICJxdWFkcmF0dXJlIHgxIGEiLAo+
IC0gICAgICAgW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9CXSA9ICJxdWFkcmF0dXJl
IHgxIGIiLAo+IC0gICAgICAgW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BXSA9ICJx
dWFkcmF0dXJlIHgyIGEiLAo+IC0gICAgICAgW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
Ml9CXSA9ICJxdWFkcmF0dXJlIHgyIGIiLAo+IC0gICAgICAgW0NPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YNF0gPSAicXVhZHJhdHVyZSB4NCIKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90
IGNvdW50ZXJfZnVuY3Rpb25fc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBj
aGFyICpidWYpCj4gLXsKPiAtICAgICAgIGludCBlcnI7Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtICAgICAg
IGNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291
bnRlcl9hdHRyKGF0dHIpOwo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfdW5p
dCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0gICAgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gY29tcG9uZW50LT5jb3VudDsKPiAtICAgICAg
IHNpemVfdCBmdW5jX2luZGV4Owo+IC0gICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0
aW9uOwo+IC0KPiAtICAgICAgIGVyciA9IGNvdW50ZXItPm9wcy0+ZnVuY3Rpb25fZ2V0KGNvdW50
ZXIsIGNvdW50LCAmZnVuY19pbmRleCk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAg
ICAgICByZXR1cm4gZXJyOwo+IC0KPiAtICAgICAgIGNvdW50LT5mdW5jdGlvbiA9IGZ1bmNfaW5k
ZXg7Cj4gLQo+IC0gICAgICAgZnVuY3Rpb24gPSBjb3VudC0+ZnVuY3Rpb25zX2xpc3RbZnVuY19p
bmRleF07Cj4gLSAgICAgICByZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291bnRlcl9mdW5j
dGlvbl9zdHJbZnVuY3Rpb25dKTsKPiAtfQo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9m
dW5jdGlvbl9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxl
bikKPiAtewo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0
IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3Qg
Y291bnRlcl9jb3VudF91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZhdHRyLT5jb21wb25lbnQ7
Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBjb21wb25lbnQt
PmNvdW50Owo+IC0gICAgICAgY29uc3Qgc2l6ZV90IG51bV9mdW5jdGlvbnMgPSBjb3VudC0+bnVt
X2Z1bmN0aW9uczsKPiAtICAgICAgIHNpemVfdCBmdW5jX2luZGV4Owo+IC0gICAgICAgZW51bSBj
b3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uOwo+IC0gICAgICAgaW50IGVycjsKPiAtICAgICAgIHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYp
Owo+IC0KPiAtICAgICAgIC8qIEZpbmQgcmVxdWVzdGVkIENvdW50IGZ1bmN0aW9uIG1vZGUgKi8K
PiAtICAgICAgIGZvciAoZnVuY19pbmRleCA9IDA7IGZ1bmNfaW5kZXggPCBudW1fZnVuY3Rpb25z
OyBmdW5jX2luZGV4KyspIHsKPiAtICAgICAgICAgICAgICAgZnVuY3Rpb24gPSBjb3VudC0+ZnVu
Y3Rpb25zX2xpc3RbZnVuY19pbmRleF07Cj4gLSAgICAgICAgICAgICAgIGlmIChzeXNmc19zdHJl
cShidWYsIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSkpCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7Cj4gLSAgICAgICB9Cj4gLSAgICAgICAvKiBSZXR1cm4gZXJyb3IgaWYg
cmVxdWVzdGVkIENvdW50IGZ1bmN0aW9uIG1vZGUgbm90IGZvdW5kICovCj4gLSAgICAgICBpZiAo
ZnVuY19pbmRleCA+PSBudW1fZnVuY3Rpb25zKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gLUVJ
TlZBTDsKPiAtCj4gLSAgICAgICBlcnIgPSBjb3VudGVyLT5vcHMtPmZ1bmN0aW9uX3NldChjb3Vu
dGVyLCBjb3VudCwgZnVuY19pbmRleCk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAg
ICAgICByZXR1cm4gZXJyOwo+IC0KPiAtICAgICAgIGNvdW50LT5mdW5jdGlvbiA9IGZ1bmNfaW5k
ZXg7Cj4gLQo+IC0gICAgICAgcmV0dXJuIGxlbjsKPiAtfQo+IC0KPiAtc3RydWN0IGNvdW50ZXJf
Y291bnRfZXh0X3VuaXQgewo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50Owo+
IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0ICpleHQ7Cj4gLX07Cj4gLQo+
IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvdW50X2V4dF9zaG93KHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkZXZpY2Vf
YXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gLXsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBj
b3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIp
Owo+IC0gICAgICAgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0X3VuaXQgKmNvbnN0IGNv
bXAgPSBkZXZhdHRyLT5jb21wb25lbnQ7Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9j
b3VudF9leHQgKmNvbnN0IGV4dCA9IGNvbXAtPmV4dDsKPiAtCj4gLSAgICAgICByZXR1cm4gZXh0
LT5yZWFkKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBjb21wLT5jb3VudCwgZXh0LT5wcml2LCBidWYp
Owo+IC19Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvdW50X2V4dF9zdG9yZShzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17Cj4gLSAgICAg
ICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2Nv
dW50ZXJfYXR0cihhdHRyKTsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4
dF91bml0ICpjb25zdCBjb21wID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0gICAgICAgY29uc3Qg
c3RydWN0IGNvdW50ZXJfY291bnRfZXh0ICpjb25zdCBleHQgPSBjb21wLT5leHQ7Cj4gLQo+IC0g
ICAgICAgcmV0dXJuIGV4dC0+d3JpdGUoZGV2X2dldF9kcnZkYXRhKGRldiksIGNvbXAtPmNvdW50
LCBleHQtPnByaXYsIGJ1ZiwKPiAtICAgICAgICAgICAgICAgbGVuKTsKPiAtfQo+IC0KPiAtc3Rh
dGljIGludCBjb3VudGVyX2NvdW50X2V4dF9yZWdpc3RlcigKPiAtICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiAtICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb25zdCBjb3VudCkKPiAtewo+IC0gICAgICAgc2l6ZV90IGk7Cj4gLSAgICAg
ICBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgKmV4dDsKPiAtICAgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50X2V4dF91bml0ICpjb3VudF9leHRfY29tcDsKPiAtICAgICAgIHN0cnVjdCBj
b3VudGVyX2F0dHJfcGFybSBwYXJtOwo+IC0gICAgICAgaW50IGVycjsKPiAtCj4gLSAgICAgICAv
KiBDcmVhdGUgYW4gYXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwo+IC0gICAgICAgZm9y
IChpID0gMCA7IGkgPCBjb3VudC0+bnVtX2V4dDsgaSsrKSB7Cj4gLSAgICAgICAgICAgICAgIGV4
dCA9IGNvdW50LT5leHQgKyBpOwo+IC0KPiAtICAgICAgICAgICAgICAgLyogQWxsb2NhdGUgY291
bnRfZXh0IGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiAtICAgICAgICAgICAgICAgY291bnRfZXh0
X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqY291bnRfZXh0X2NvbXApLCBHRlBfS0VSTkVMKTsKPiAt
ICAgICAgICAgICAgICAgaWYgKCFjb3VudF9leHRfY29tcCkgewo+IC0gICAgICAgICAgICAgICAg
ICAgICAgIGVyciA9IC1FTk9NRU07Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJf
ZnJlZV9hdHRyX2xpc3Q7Cj4gLSAgICAgICAgICAgICAgIH0KPiAtICAgICAgICAgICAgICAgY291
bnRfZXh0X2NvbXAtPmNvdW50ID0gY291bnQ7Cj4gLSAgICAgICAgICAgICAgIGNvdW50X2V4dF9j
b21wLT5leHQgPSBleHQ7Cj4gLQo+IC0gICAgICAgICAgICAgICAvKiBBbGxvY2F0ZSBjb3VudF9l
eHQgYXR0cmlidXRlICovCj4gLSAgICAgICAgICAgICAgIHBhcm0uZ3JvdXAgPSBncm91cDsKPiAt
ICAgICAgICAgICAgICAgcGFybS5wcmVmaXggPSAiIjsKPiAtICAgICAgICAgICAgICAgcGFybS5u
YW1lID0gZXh0LT5uYW1lOwo+IC0gICAgICAgICAgICAgICBwYXJtLnNob3cgPSAoZXh0LT5yZWFk
KSA/IGNvdW50ZXJfY291bnRfZXh0X3Nob3cgOiBOVUxMOwo+IC0gICAgICAgICAgICAgICBwYXJt
LnN0b3JlID0gKGV4dC0+d3JpdGUpID8gY291bnRlcl9jb3VudF9leHRfc3RvcmUgOiBOVUxMOwo+
IC0gICAgICAgICAgICAgICBwYXJtLmNvbXBvbmVudCA9IGNvdW50X2V4dF9jb21wOwo+IC0gICAg
ICAgICAgICAgICBlcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+IC0gICAg
ICAgICAgICAgICBpZiAoZXJyKSB7Cj4gLSAgICAgICAgICAgICAgICAgICAgICAga2ZyZWUoY291
bnRfZXh0X2NvbXApOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfYXR0
cl9saXN0Owo+IC0gICAgICAgICAgICAgICB9Cj4gLSAgICAgICB9Cj4gLQo+IC0gICAgICAgcmV0
dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6Cj4gLSAgICAgICBjb3VudGVyX2Rldmlj
ZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlzdCk7Cj4gLSAgICAgICByZXR1cm4gZXJy
Owo+IC19Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9mdW5jX2F2YWlsX3VuaXQgewo+IC0gICAgICAg
Y29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbnNfbGlzdDsKPiAtICAgICAgIHNp
emVfdCBudW1fZnVuY3Rpb25zOwo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9m
dW5jdGlvbl9hdmFpbGFibGVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAgICBzdHJ1
Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+IC17Cj4gLSAgICAgICBjb25z
dCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJf
YXR0cihhdHRyKTsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX2Z1bmNfYXZhaWxfdW5p
dCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0gICAgICAgY29uc3Qg
ZW51bSBjb3VudGVyX2Z1bmN0aW9uICpjb25zdCBmdW5jX2xpc3QgPSBjb21wb25lbnQtPmZ1bmN0
aW9uc19saXN0Owo+IC0gICAgICAgY29uc3Qgc2l6ZV90IG51bV9mdW5jdGlvbnMgPSBjb21wb25l
bnQtPm51bV9mdW5jdGlvbnM7Cj4gLSAgICAgICBzaXplX3QgaTsKPiAtICAgICAgIGVudW0gY291
bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiAtICAgICAgIHNzaXplX3QgbGVuID0gMDsKPiAtCj4g
LSAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtX2Z1bmN0aW9uczsgaSsrKSB7Cj4gLSAgICAgICAg
ICAgICAgIGZ1bmN0aW9uID0gZnVuY19saXN0W2ldOwo+IC0gICAgICAgICAgICAgICBsZW4gKz0g
c3ByaW50ZihidWYgKyBsZW4sICIlc1xuIiwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY291bnRlcl9mdW5jdGlvbl9zdHJbZnVuY3Rpb25dKTsKPiAtICAgICAgIH0KPiAtCj4gLSAg
ICAgICByZXR1cm4gbGVuOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJfY291bnRfYXR0
cmlidXRlc19jcmVhdGUoCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91
cCAqY29uc3QgZ3JvdXAsCj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
bnN0IGNvdW50ZXIsCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQp
Cj4gLXsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgKmNvdW50X2NvbXA7Cj4g
LSAgICAgICBzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiAtICAgICAgIGludCBlcnI7
Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudF91bml0ICpmdW5jX2NvbXA7Cj4gLSAgICAg
ICBzdHJ1Y3QgY291bnRlcl9mdW5jX2F2YWlsX3VuaXQgKmF2YWlsX2NvbXA7Cj4gLQo+IC0gICAg
ICAgLyogQWxsb2NhdGUgY291bnQgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+IC0gICAgICAgY291
bnRfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpjb3VudF9jb21wKSwgR0ZQX0tFUk5FTCk7Cj4gLSAg
ICAgICBpZiAoIWNvdW50X2NvbXApCj4gLSAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+
IC0gICAgICAgY291bnRfY29tcC0+Y291bnQgPSBjb3VudDsKPiAtCj4gLSAgICAgICAvKiBDcmVh
dGUgbWFpbiBDb3VudCBhdHRyaWJ1dGUgKi8KPiAtICAgICAgIHBhcm0uZ3JvdXAgPSBncm91cDsK
PiAtICAgICAgIHBhcm0ucHJlZml4ID0gIiI7Cj4gLSAgICAgICBwYXJtLm5hbWUgPSAiY291bnQi
Owo+IC0gICAgICAgcGFybS5zaG93ID0gKGNvdW50ZXItPm9wcy0+Y291bnRfcmVhZCkgPyBjb3Vu
dGVyX2NvdW50X3Nob3cgOiBOVUxMOwo+IC0gICAgICAgcGFybS5zdG9yZSA9IChjb3VudGVyLT5v
cHMtPmNvdW50X3dyaXRlKSA/IGNvdW50ZXJfY291bnRfc3RvcmUgOiBOVUxMOwo+IC0gICAgICAg
cGFybS5jb21wb25lbnQgPSBjb3VudF9jb21wOwo+IC0gICAgICAgZXJyID0gY291bnRlcl9hdHRy
aWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAtICAgICAgIGlmIChlcnIpIHsKPiAtICAgICAgICAgICAg
ICAga2ZyZWUoY291bnRfY29tcCk7Cj4gLSAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4gLSAg
ICAgICB9Cj4gLQo+IC0gICAgICAgLyogQWxsb2NhdGUgZnVuY3Rpb24gYXR0cmlidXRlIGNvbXBv
bmVudCAqLwo+IC0gICAgICAgZnVuY19jb21wID0ga21hbGxvYyhzaXplb2YoKmZ1bmNfY29tcCks
IEdGUF9LRVJORUwpOwo+IC0gICAgICAgaWYgKCFmdW5jX2NvbXApIHsKPiAtICAgICAgICAgICAg
ICAgZXJyID0gLUVOT01FTTsKPiAtICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9hdHRyX2xp
c3Q7Cj4gLSAgICAgICB9Cj4gLSAgICAgICBmdW5jX2NvbXAtPmNvdW50ID0gY291bnQ7Cj4gLQo+
IC0gICAgICAgLyogQ3JlYXRlIENvdW50IGZ1bmN0aW9uIGF0dHJpYnV0ZSAqLwo+IC0gICAgICAg
cGFybS5ncm91cCA9IGdyb3VwOwo+IC0gICAgICAgcGFybS5wcmVmaXggPSAiIjsKPiAtICAgICAg
IHBhcm0ubmFtZSA9ICJmdW5jdGlvbiI7Cj4gLSAgICAgICBwYXJtLnNob3cgPSAoY291bnRlci0+
b3BzLT5mdW5jdGlvbl9nZXQpID8gY291bnRlcl9mdW5jdGlvbl9zaG93IDogTlVMTDsKPiAtICAg
ICAgIHBhcm0uc3RvcmUgPSAoY291bnRlci0+b3BzLT5mdW5jdGlvbl9zZXQpID8gY291bnRlcl9m
dW5jdGlvbl9zdG9yZSA6IE5VTEw7Cj4gLSAgICAgICBwYXJtLmNvbXBvbmVudCA9IGZ1bmNfY29t
cDsKPiAtICAgICAgIGVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLSAg
ICAgICBpZiAoZXJyKSB7Cj4gLSAgICAgICAgICAgICAgIGtmcmVlKGZ1bmNfY29tcCk7Cj4gLSAg
ICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0gICAgICAgfQo+IC0KPiAt
ICAgICAgIC8qIEFsbG9jYXRlIGZ1bmN0aW9uIGF2YWlsYWJsZSBhdHRyaWJ1dGUgY29tcG9uZW50
ICovCj4gLSAgICAgICBhdmFpbF9jb21wID0ga21hbGxvYyhzaXplb2YoKmF2YWlsX2NvbXApLCBH
RlBfS0VSTkVMKTsKPiAtICAgICAgIGlmICghYXZhaWxfY29tcCkgewo+IC0gICAgICAgICAgICAg
ICBlcnIgPSAtRU5PTUVNOwo+IC0gICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX2F0dHJfbGlz
dDsKPiAtICAgICAgIH0KPiAtICAgICAgIGF2YWlsX2NvbXAtPmZ1bmN0aW9uc19saXN0ID0gY291
bnQtPmZ1bmN0aW9uc19saXN0Owo+IC0gICAgICAgYXZhaWxfY29tcC0+bnVtX2Z1bmN0aW9ucyA9
IGNvdW50LT5udW1fZnVuY3Rpb25zOwo+IC0KPiAtICAgICAgIC8qIENyZWF0ZSBDb3VudCBmdW5j
dGlvbl9hdmFpbGFibGUgYXR0cmlidXRlICovCj4gLSAgICAgICBwYXJtLmdyb3VwID0gZ3JvdXA7
Cj4gLSAgICAgICBwYXJtLnByZWZpeCA9ICIiOwo+IC0gICAgICAgcGFybS5uYW1lID0gImZ1bmN0
aW9uX2F2YWlsYWJsZSI7Cj4gLSAgICAgICBwYXJtLnNob3cgPSBjb3VudGVyX2Z1bmN0aW9uX2F2
YWlsYWJsZV9zaG93Owo+IC0gICAgICAgcGFybS5zdG9yZSA9IE5VTEw7Cj4gLSAgICAgICBwYXJt
LmNvbXBvbmVudCA9IGF2YWlsX2NvbXA7Cj4gLSAgICAgICBlcnIgPSBjb3VudGVyX2F0dHJpYnV0
ZV9jcmVhdGUoJnBhcm0pOwo+IC0gICAgICAgaWYgKGVycikgewo+IC0gICAgICAgICAgICAgICBr
ZnJlZShhdmFpbF9jb21wKTsKPiAtICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9hdHRyX2xp
c3Q7Cj4gLSAgICAgICB9Cj4gLQo+IC0gICAgICAgLyogQ3JlYXRlIENvdW50IG5hbWUgYXR0cmli
dXRlICovCj4gLSAgICAgICBlcnIgPSBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0ZShncm91
cCwgY291bnQtPm5hbWUpOwo+IC0gICAgICAgaWYgKGVycikKPiAtICAgICAgICAgICAgICAgZ290
byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQo+IC0gICAgICAgLyogUmVnaXN0ZXIgQ291bnQgZXh0
ZW5zaW9uIGF0dHJpYnV0ZXMgKi8KPiAtICAgICAgIGVyciA9IGNvdW50ZXJfY291bnRfZXh0X3Jl
Z2lzdGVyKGdyb3VwLCBjb3VudCk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAgICAg
ICBnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCj4gLSAgICAgICByZXR1cm4gMDsKPiAtCj4g
LWVycl9mcmVlX2F0dHJfbGlzdDoKPiAtICAgICAgIGNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9m
cmVlKCZncm91cC0+YXR0cl9saXN0KTsKPiAtICAgICAgIHJldHVybiBlcnI7Cj4gLX0KPiAtCj4g
LXN0YXRpYyBpbnQgY291bnRlcl9jb3VudHNfcmVnaXN0ZXIoCj4gLSAgICAgICBzdHJ1Y3QgY291
bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXBzX2xpc3QsCj4gLSAgICAgICBjb25z
dCBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gLXsKPiAtICAgICAgIHNp
emVfdCBpOwo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50Owo+IC0gICAgICAg
Y29uc3QgY2hhciAqbmFtZTsKPiAtICAgICAgIGludCBlcnI7Cj4gLQo+IC0gICAgICAgLyogUmVn
aXN0ZXIgZWFjaCBDb3VudCAqLwo+IC0gICAgICAgZm9yIChpID0gMDsgaSA8IGNvdW50ZXItPm51
bV9jb3VudHM7IGkrKykgewo+IC0gICAgICAgICAgICAgICBjb3VudCA9IGNvdW50ZXItPmNvdW50
cyArIGk7Cj4gLQo+IC0gICAgICAgICAgICAgICAvKiBHZW5lcmF0ZSBDb3VudCBhdHRyaWJ1dGUg
ZGlyZWN0b3J5IG5hbWUgKi8KPiAtICAgICAgICAgICAgICAgbmFtZSA9IGthc3ByaW50ZihHRlBf
S0VSTkVMLCAiY291bnQlZCIsIGNvdW50LT5pZCk7Cj4gLSAgICAgICAgICAgICAgIGlmICghbmFt
ZSkgewo+IC0gICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FTk9NRU07Cj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9hdHRyX2dyb3VwczsKPiAtICAgICAgICAgICAg
ICAgfQo+IC0gICAgICAgICAgICAgICBncm91cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUgPSBu
YW1lOwo+IC0KPiAtICAgICAgICAgICAgICAgLyogUmVnaXN0ZXIgdGhlIFN5bmFwc2VzIGFzc29j
aWF0ZWQgd2l0aCBlYWNoIENvdW50ICovCj4gLSAgICAgICAgICAgICAgIGVyciA9IGNvdW50ZXJf
c3luYXBzZXNfcmVnaXN0ZXIoZ3JvdXBzX2xpc3QgKyBpLCBjb3VudGVyLCBjb3VudCwKPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lKTsKPiAtICAg
ICAgICAgICAgICAgaWYgKGVycikKPiAtICAgICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9m
cmVlX2F0dHJfZ3JvdXBzOwo+IC0KPiAtICAgICAgICAgICAgICAgLyogQ3JlYXRlIGFsbCBhdHRy
aWJ1dGVzIGFzc29jaWF0ZWQgd2l0aCBDb3VudCAqLwo+IC0gICAgICAgICAgICAgICBlcnIgPSBj
b3VudGVyX2NvdW50X2F0dHJpYnV0ZXNfY3JlYXRlKGdyb3Vwc19saXN0ICsgaSwgY291bnRlciwK
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b3VudCk7Cj4gLSAgICAgICAgICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgZ290byBlcnJfZnJlZV9hdHRyX2dyb3VwczsKPiAtICAgICAgIH0KPiAtCj4gLSAgICAgICBy
ZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2F0dHJfZ3JvdXBzOgo+IC0gICAgICAgZG8gewo+IC0g
ICAgICAgICAgICAgICBrZnJlZShncm91cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUpOwo+IC0g
ICAgICAgICAgICAgICBjb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXBzX2xpc3Rb
aV0uYXR0cl9saXN0KTsKPiAtICAgICAgIH0gd2hpbGUgKGktLSk7Cj4gLSAgICAgICByZXR1cm4g
ZXJyOwo+IC19Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9zaXplX3VuaXQgewo+IC0gICAgICAgc2l6
ZV90IHNpemU7Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2RldmljZV9hdHRy
X3NpemVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqYnVmKQo+IC17
Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9zaXplX3VuaXQgKmNvbnN0IGNvbXAgPSB0
b19jb3VudGVyX2F0dHIoYXR0ciktPmNvbXBvbmVudDsKPiAtCj4gLSAgICAgICByZXR1cm4gc3By
aW50ZihidWYsICIlenVcbiIsIGNvbXAtPnNpemUpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNv
dW50ZXJfc2l6ZV9hdHRyaWJ1dGVfY3JlYXRlKAo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfZGV2
aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3VwLAo+IC0gICAgICAgY29uc3Qgc2l6ZV90IHNpemUs
IGNvbnN0IGNoYXIgKmNvbnN0IG5hbWUpCj4gLXsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX3Np
emVfdW5pdCAqc2l6ZV9jb21wOwo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBh
cm07Cj4gLSAgICAgICBpbnQgZXJyOwo+IC0KPiAtICAgICAgIC8qIEFsbG9jYXRlIHNpemUgYXR0
cmlidXRlIGNvbXBvbmVudCAqLwo+IC0gICAgICAgc2l6ZV9jb21wID0ga21hbGxvYyhzaXplb2Yo
KnNpemVfY29tcCksIEdGUF9LRVJORUwpOwo+IC0gICAgICAgaWYgKCFzaXplX2NvbXApCj4gLSAg
ICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+IC0gICAgICAgc2l6ZV9jb21wLT5zaXplID0g
c2l6ZTsKPiAtCj4gLSAgICAgICBwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gLSAgICAgICBwYXJtLnBy
ZWZpeCA9ICIiOwo+IC0gICAgICAgcGFybS5uYW1lID0gbmFtZTsKPiAtICAgICAgIHBhcm0uc2hv
dyA9IGNvdW50ZXJfZGV2aWNlX2F0dHJfc2l6ZV9zaG93Owo+IC0gICAgICAgcGFybS5zdG9yZSA9
IE5VTEw7Cj4gLSAgICAgICBwYXJtLmNvbXBvbmVudCA9IHNpemVfY29tcDsKPiAtICAgICAgIGVy
ciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLSAgICAgICBpZiAoZXJyKQo+
IC0gICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX3NpemVfY29tcDsKPiAtCj4gLSAgICAgICBy
ZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX3NpemVfY29tcDoKPiAtICAgICAgIGtmcmVlKHNpemVf
Y29tcCk7Cj4gLSAgICAgICByZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9l
eHRfdW5pdCB7Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZXh0ICpleHQ7
Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2RldmljZV9leHRfc2hvdyhzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAtewo+IC0gICAgICAg
Y29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3Vu
dGVyX2F0dHIoYXR0cik7Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9leHRfdW5pdCAq
Y29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0gICAgICAgY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlX2V4dCAqY29uc3QgZXh0ID0gY29tcG9uZW50LT5leHQ7Cj4gLQo+
IC0gICAgICAgcmV0dXJuIGV4dC0+cmVhZChkZXZfZ2V0X2RydmRhdGEoZGV2KSwgZXh0LT5wcml2
LCBidWYpOwo+IC19Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2RldmljZV9leHRfc3Rv
cmUoc3RydWN0IGRldmljZSAqZGV2LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17
Cj4gLSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0
ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiAtICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVy
X2V4dF91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZhdHRyLT5jb21wb25lbnQ7Cj4gLSAgICAg
ICBjb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZXh0ICpjb25zdCBleHQgPSBjb21wb25lbnQt
PmV4dDsKPiAtCj4gLSAgICAgICByZXR1cm4gZXh0LT53cml0ZShkZXZfZ2V0X2RydmRhdGEoZGV2
KSwgZXh0LT5wcml2LCBidWYsIGxlbik7Cj4gLX0KPiAtCj4gLXN0YXRpYyBpbnQgY291bnRlcl9k
ZXZpY2VfZXh0X3JlZ2lzdGVyKAo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJf
Z3JvdXAgKmNvbnN0IGdyb3VwLAo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25z
dCBjb3VudGVyKQo+IC17Cj4gLSAgICAgICBzaXplX3QgaTsKPiAtICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2V4dF91bml0ICpleHRfY29tcDsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2F0dHJfcGFy
bSBwYXJtOwo+IC0gICAgICAgaW50IGVycjsKPiAtCj4gLSAgICAgICAvKiBDcmVhdGUgYW4gYXR0
cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwo+IC0gICAgICAgZm9yIChpID0gMCA7IGkgPCBj
b3VudGVyLT5udW1fZXh0OyBpKyspIHsKPiAtICAgICAgICAgICAgICAgLyogQWxsb2NhdGUgZXh0
ZW5zaW9uIGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiAtICAgICAgICAgICAgICAgZXh0X2NvbXAg
PSBrbWFsbG9jKHNpemVvZigqZXh0X2NvbXApLCBHRlBfS0VSTkVMKTsKPiAtICAgICAgICAgICAg
ICAgaWYgKCFleHRfY29tcCkgewo+IC0gICAgICAgICAgICAgICAgICAgICAgIGVyciA9IC1FTk9N
RU07Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4g
LSAgICAgICAgICAgICAgIH0KPiAtCj4gLSAgICAgICAgICAgICAgIGV4dF9jb21wLT5leHQgPSBj
b3VudGVyLT5leHQgKyBpOwo+IC0KPiAtICAgICAgICAgICAgICAgLyogQWxsb2NhdGUgZXh0ZW5z
aW9uIGF0dHJpYnV0ZSAqLwo+IC0gICAgICAgICAgICAgICBwYXJtLmdyb3VwID0gZ3JvdXA7Cj4g
LSAgICAgICAgICAgICAgIHBhcm0ucHJlZml4ID0gIiI7Cj4gLSAgICAgICAgICAgICAgIHBhcm0u
bmFtZSA9IGNvdW50ZXItPmV4dFtpXS5uYW1lOwo+IC0gICAgICAgICAgICAgICBwYXJtLnNob3cg
PSAoY291bnRlci0+ZXh0W2ldLnJlYWQpID8gY291bnRlcl9kZXZpY2VfZXh0X3Nob3cgOiBOVUxM
Owo+IC0gICAgICAgICAgICAgICBwYXJtLnN0b3JlID0gKGNvdW50ZXItPmV4dFtpXS53cml0ZSkg
PyBjb3VudGVyX2RldmljZV9leHRfc3RvcmUgOiBOVUxMOwo+IC0gICAgICAgICAgICAgICBwYXJt
LmNvbXBvbmVudCA9IGV4dF9jb21wOwo+IC0gICAgICAgICAgICAgICBlcnIgPSBjb3VudGVyX2F0
dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+IC0gICAgICAgICAgICAgICBpZiAoZXJyKSB7Cj4gLSAg
ICAgICAgICAgICAgICAgICAgICAga2ZyZWUoZXh0X2NvbXApOwo+IC0gICAgICAgICAgICAgICAg
ICAgICAgIGdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0gICAgICAgICAgICAgICB9Cj4gLSAg
ICAgICB9Cj4gLQo+IC0gICAgICAgcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6
Cj4gLSAgICAgICBjb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlz
dCk7Cj4gLSAgICAgICByZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJf
Z2xvYmFsX2F0dHJfcmVnaXN0ZXIoCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0
cl9ncm91cCAqY29uc3QgZ3JvdXAsCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
bnN0IGNvdW50ZXIpCj4gLXsKPiAtICAgICAgIGludCBlcnI7Cj4gLQo+IC0gICAgICAgLyogQ3Jl
YXRlIG5hbWUgYXR0cmlidXRlICovCj4gLSAgICAgICBlcnIgPSBjb3VudGVyX25hbWVfYXR0cmli
dXRlX2NyZWF0ZShncm91cCwgY291bnRlci0+bmFtZSk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0g
ICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+IC0KPiAtICAgICAgIC8qIENyZWF0ZSBudW1fY291
bnRzIGF0dHJpYnV0ZSAqLwo+IC0gICAgICAgZXJyID0gY291bnRlcl9zaXplX2F0dHJpYnV0ZV9j
cmVhdGUoZ3JvdXAsIGNvdW50ZXItPm51bV9jb3VudHMsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAibnVtX2NvdW50cyIpOwo+IC0gICAgICAgaWYgKGVycikK
PiAtICAgICAgICAgICAgICAgZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQo+IC0gICAgICAg
LyogQ3JlYXRlIG51bV9zaWduYWxzIGF0dHJpYnV0ZSAqLwo+IC0gICAgICAgZXJyID0gY291bnRl
cl9zaXplX2F0dHJpYnV0ZV9jcmVhdGUoZ3JvdXAsIGNvdW50ZXItPm51bV9zaWduYWxzLAo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIm51bV9zaWduYWxzIik7
Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX2F0dHJf
bGlzdDsKPiAtCj4gLSAgICAgICAvKiBSZWdpc3RlciBDb3VudGVyIGRldmljZSBleHRlbnNpb24g
YXR0cmlidXRlcyAqLwo+IC0gICAgICAgZXJyID0gY291bnRlcl9kZXZpY2VfZXh0X3JlZ2lzdGVy
KGdyb3VwLCBjb3VudGVyKTsKPiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIGdv
dG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0KPiAtICAgICAgIHJldHVybiAwOwo+IC0KPiAtZXJy
X2ZyZWVfYXR0cl9saXN0Ogo+IC0gICAgICAgY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUo
Jmdyb3VwLT5hdHRyX2xpc3QpOwo+IC0gICAgICAgcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3Rh
dGljIHZvaWQgY291bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3RfZnJlZSgKPiAtICAgICAgIHN0cnVj
dCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cHNfbGlzdCwKPiAtICAgICAg
IGNvbnN0IHNpemVfdCBudW1fZ3JvdXBzKQo+IC17Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9k
ZXZpY2VfYXR0cl9ncm91cCAqZ3JvdXA7Cj4gLSAgICAgICBzaXplX3QgaTsKPiAtCj4gLSAgICAg
ICAvKiBsb29wIHRocm91Z2ggYWxsIGF0dHJpYnV0ZSBncm91cHMgKHNpZ25hbHMsIGNvdW50cywg
Z2xvYmFsLCBldGMuKSAqLwo+IC0gICAgICAgZm9yIChpID0gMDsgaSA8IG51bV9ncm91cHM7IGkr
Kykgewo+IC0gICAgICAgICAgICAgICBncm91cCA9IGdyb3Vwc19saXN0ICsgaTsKPiAtCj4gLSAg
ICAgICAgICAgICAgIC8qIGZyZWUgYWxsIGF0dHJpYnV0ZSBncm91cCBhbmQgYXNzb2NpYXRlZCBh
dHRyaWJ1dGVzIG1lbW9yeSAqLwo+IC0gICAgICAgICAgICAgICBrZnJlZShncm91cC0+YXR0cl9n
cm91cC5uYW1lKTsKPiAtICAgICAgICAgICAgICAga2ZyZWUoZ3JvdXAtPmF0dHJfZ3JvdXAuYXR0
cnMpOwo+IC0gICAgICAgICAgICAgICBjb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3Jv
dXAtPmF0dHJfbGlzdCk7Cj4gLSAgICAgICB9Cj4gLQo+IC0gICAgICAga2ZyZWUoZ3JvdXBzX2xp
c3QpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJfZGV2aWNlX2dyb3Vwc19saXN0X3By
ZXBhcmUoCj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4g
LXsKPiAtICAgICAgIGNvbnN0IHNpemVfdCB0b3RhbF9udW1fZ3JvdXBzID0KPiAtICAgICAgICAg
ICAgICAgY291bnRlci0+bnVtX3NpZ25hbHMgKyBjb3VudGVyLT5udW1fY291bnRzICsgMTsKPiAt
ICAgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpncm91cHNfbGlzdDsKPiAt
ICAgICAgIHNpemVfdCBpOwo+IC0gICAgICAgaW50IGVycjsKPiAtICAgICAgIHNpemVfdCBudW1f
Z3JvdXBzID0gMDsKPiAtCj4gLSAgICAgICAvKiBBbGxvY2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRl
IGdyb3VwcyAoc2lnbmFscywgY291bnRzLCBhbmQgZXh0KSAqLwo+IC0gICAgICAgZ3JvdXBzX2xp
c3QgPSBrY2FsbG9jKHRvdGFsX251bV9ncm91cHMsIHNpemVvZigqZ3JvdXBzX2xpc3QpLAo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdGUF9LRVJORUwpOwo+IC0gICAgICAgaWYgKCFn
cm91cHNfbGlzdCkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gLQo+IC0gICAg
ICAgLyogSW5pdGlhbGl6ZSBhdHRyaWJ1dGUgbGlzdHMgKi8KPiAtICAgICAgIGZvciAoaSA9IDA7
IGkgPCB0b3RhbF9udW1fZ3JvdXBzOyBpKyspCj4gLSAgICAgICAgICAgICAgIElOSVRfTElTVF9I
RUFEKCZncm91cHNfbGlzdFtpXS5hdHRyX2xpc3QpOwo+IC0KPiAtICAgICAgIC8qIFJlZ2lzdGVy
IFNpZ25hbHMgKi8KPiAtICAgICAgIGVyciA9IGNvdW50ZXJfc2lnbmFsc19yZWdpc3Rlcihncm91
cHNfbGlzdCwgY291bnRlcik7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAgICAgICBn
b3RvIGVycl9mcmVlX2dyb3Vwc19saXN0Owo+IC0gICAgICAgbnVtX2dyb3VwcyArPSBjb3VudGVy
LT5udW1fc2lnbmFsczsKPiAtCj4gLSAgICAgICAvKiBSZWdpc3RlciBDb3VudHMgYW5kIHJlc3Bl
Y3RpdmUgU3luYXBzZXMgKi8KPiAtICAgICAgIGVyciA9IGNvdW50ZXJfY291bnRzX3JlZ2lzdGVy
KGdyb3Vwc19saXN0ICsgbnVtX2dyb3VwcywgY291bnRlcik7Cj4gLSAgICAgICBpZiAoZXJyKQo+
IC0gICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX2dyb3Vwc19saXN0Owo+IC0gICAgICAgbnVt
X2dyb3VwcyArPSBjb3VudGVyLT5udW1fY291bnRzOwo+IC0KPiAtICAgICAgIC8qIFJlZ2lzdGVy
IENvdW50ZXIgZ2xvYmFsIGF0dHJpYnV0ZXMgKi8KPiAtICAgICAgIGVyciA9IGNvdW50ZXJfZ2xv
YmFsX2F0dHJfcmVnaXN0ZXIoZ3JvdXBzX2xpc3QgKyBudW1fZ3JvdXBzLCBjb3VudGVyKTsKPiAt
ICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfZ3JvdXBzX2xp
c3Q7Cj4gLSAgICAgICBudW1fZ3JvdXBzKys7Cj4gLQo+IC0gICAgICAgLyogU3RvcmUgZ3JvdXBz
X2xpc3QgaW4gZGV2aWNlX3N0YXRlICovCj4gLSAgICAgICBjb3VudGVyLT5kZXZpY2Vfc3RhdGUt
Pmdyb3Vwc19saXN0ID0gZ3JvdXBzX2xpc3Q7Cj4gLSAgICAgICBjb3VudGVyLT5kZXZpY2Vfc3Rh
dGUtPm51bV9ncm91cHMgPSBudW1fZ3JvdXBzOwo+IC0KPiAtICAgICAgIHJldHVybiAwOwo+IC0K
PiAtZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q6Cj4gLSAgICAgICBjb3VudGVyX2RldmljZV9ncm91cHNf
bGlzdF9mcmVlKGdyb3Vwc19saXN0LCBudW1fZ3JvdXBzKTsKPiAtICAgICAgIHJldHVybiBlcnI7
Cj4gLX0KPiAtCj4gLXN0YXRpYyBpbnQgY291bnRlcl9kZXZpY2VfZ3JvdXBzX3ByZXBhcmUoCj4g
LSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgKmNvbnN0IGRldmljZV9zdGF0ZSkK
PiAtewo+IC0gICAgICAgc2l6ZV90IGksIGo7Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZp
Y2VfYXR0cl9ncm91cCAqZ3JvdXA7Cj4gLSAgICAgICBpbnQgZXJyOwo+IC0gICAgICAgc3RydWN0
IGNvdW50ZXJfZGV2aWNlX2F0dHIgKnA7Cj4gLQo+IC0gICAgICAgLyogQWxsb2NhdGUgYXR0cmli
dXRlIGdyb3VwcyBmb3IgYXNzb2NpYXRpb24gd2l0aCBkZXZpY2UgKi8KPiAtICAgICAgIGRldmlj
ZV9zdGF0ZS0+Z3JvdXBzID0ga2NhbGxvYyhkZXZpY2Vfc3RhdGUtPm51bV9ncm91cHMgKyAxLAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVvZigqZGV2aWNlX3N0
YXRlLT5ncm91cHMpLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdG
UF9LRVJORUwpOwo+IC0gICAgICAgaWYgKCFkZXZpY2Vfc3RhdGUtPmdyb3VwcykKPiAtICAgICAg
ICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gLQo+IC0gICAgICAgLyogUHJlcGFyZSBlYWNoIGdy
b3VwIG9mIGF0dHJpYnV0ZXMgZm9yIGFzc29jaWF0aW9uICovCj4gLSAgICAgICBmb3IgKGkgPSAw
OyBpIDwgZGV2aWNlX3N0YXRlLT5udW1fZ3JvdXBzOyBpKyspIHsKPiAtICAgICAgICAgICAgICAg
Z3JvdXAgPSBkZXZpY2Vfc3RhdGUtPmdyb3Vwc19saXN0ICsgaTsKPiAtCj4gLSAgICAgICAgICAg
ICAgIC8qIEFsbG9jYXRlIHNwYWNlIGZvciBhdHRyaWJ1dGUgcG9pbnRlcnMgaW4gYXR0cmlidXRl
IGdyb3VwICovCj4gLSAgICAgICAgICAgICAgIGdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzID0ga2Nh
bGxvYyhncm91cC0+bnVtX2F0dHIgKyAxLAo+IC0gICAgICAgICAgICAgICAgICAgICAgIHNpemVv
ZigqZ3JvdXAtPmF0dHJfZ3JvdXAuYXR0cnMpLCBHRlBfS0VSTkVMKTsKPiAtICAgICAgICAgICAg
ICAgaWYgKCFncm91cC0+YXR0cl9ncm91cC5hdHRycykgewo+IC0gICAgICAgICAgICAgICAgICAg
ICAgIGVyciA9IC1FTk9NRU07Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgZ290byBlcnJfZnJl
ZV9ncm91cHM7Cj4gLSAgICAgICAgICAgICAgIH0KPiAtCj4gLSAgICAgICAgICAgICAgIC8qIEFk
ZCBhdHRyaWJ1dGUgcG9pbnRlcnMgdG8gYXR0cmlidXRlIGdyb3VwICovCj4gLSAgICAgICAgICAg
ICAgIGogPSAwOwo+IC0gICAgICAgICAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KHAsICZncm91
cC0+YXR0cl9saXN0LCBsKQo+IC0gICAgICAgICAgICAgICAgICAgICAgIGdyb3VwLT5hdHRyX2dy
b3VwLmF0dHJzW2orK10gPSAmcC0+ZGV2X2F0dHIuYXR0cjsKPiAtCj4gLSAgICAgICAgICAgICAg
IC8qIEdyb3VwIGF0dHJpYnV0ZXMgaW4gYXR0cmlidXRlIGdyb3VwICovCj4gLSAgICAgICAgICAg
ICAgIGRldmljZV9zdGF0ZS0+Z3JvdXBzW2ldID0gJmdyb3VwLT5hdHRyX2dyb3VwOwo+IC0gICAg
ICAgfQo+IC0gICAgICAgLyogQXNzb2NpYXRlIGF0dHJpYnV0ZXMgd2l0aCBkZXZpY2UgKi8KPiAt
ICAgICAgIGRldmljZV9zdGF0ZS0+ZGV2Lmdyb3VwcyA9IGRldmljZV9zdGF0ZS0+Z3JvdXBzOwo+
IC0KPiAtICAgICAgIHJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfZ3JvdXBzOgo+IC0gICAgICAg
ZG8gewo+IC0gICAgICAgICAgICAgICBncm91cCA9IGRldmljZV9zdGF0ZS0+Z3JvdXBzX2xpc3Qg
KyBpOwo+IC0gICAgICAgICAgICAgICBrZnJlZShncm91cC0+YXR0cl9ncm91cC5hdHRycyk7Cj4g
LSAgICAgICAgICAgICAgIGdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzID0gTlVMTDsKPiAtICAgICAg
IH0gd2hpbGUgKGktLSk7Cj4gLSAgICAgICBrZnJlZShkZXZpY2Vfc3RhdGUtPmdyb3Vwcyk7Cj4g
LSAgICAgICByZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC0vKiBQcm92aWRlcyBhIHVuaXF1ZSBJRCBm
b3IgZWFjaCBjb3VudGVyIGRldmljZSAqLwo+IC1zdGF0aWMgREVGSU5FX0lEQShjb3VudGVyX2lk
YSk7Cj4gLQo+IC1zdGF0aWMgdm9pZCBjb3VudGVyX2RldmljZV9yZWxlYXNlKHN0cnVjdCBkZXZp
Y2UgKmRldikKPiAtewo+IC0gICAgICAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3Vu
dGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZp
Y2Vfc3RhdGUgKmNvbnN0IGRldmljZV9zdGF0ZSA9IGNvdW50ZXItPmRldmljZV9zdGF0ZTsKPiAt
Cj4gLSAgICAgICBrZnJlZShkZXZpY2Vfc3RhdGUtPmdyb3Vwcyk7Cj4gLSAgICAgICBjb3VudGVy
X2RldmljZV9ncm91cHNfbGlzdF9mcmVlKGRldmljZV9zdGF0ZS0+Z3JvdXBzX2xpc3QsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRldmljZV9zdGF0ZS0+bnVtX2dy
b3Vwcyk7Cj4gLSAgICAgICBpZGFfc2ltcGxlX3JlbW92ZSgmY291bnRlcl9pZGEsIGRldmljZV9z
dGF0ZS0+aWQpOwo+IC0gICAgICAga2ZyZWUoZGV2aWNlX3N0YXRlKTsKPiAtfQo+IC0KPiAtc3Rh
dGljIHN0cnVjdCBkZXZpY2VfdHlwZSBjb3VudGVyX2RldmljZV90eXBlID0gewo+IC0gICAgICAg
Lm5hbWUgPSAiY291bnRlcl9kZXZpY2UiLAo+IC0gICAgICAgLnJlbGVhc2UgPSBjb3VudGVyX2Rl
dmljZV9yZWxlYXNlCj4gLX07Cj4gLQo+IC1zdGF0aWMgc3RydWN0IGJ1c190eXBlIGNvdW50ZXJf
YnVzX3R5cGUgPSB7Cj4gLSAgICAgICAubmFtZSA9ICJjb3VudGVyIgo+IC19Owo+IC0KPiAtLyoq
Cj4gLSAqIGNvdW50ZXJfcmVnaXN0ZXIgLSByZWdpc3RlciBDb3VudGVyIHRvIHRoZSBzeXN0ZW0K
PiAtICogQGNvdW50ZXI6ICAgcG9pbnRlciB0byBDb3VudGVyIHRvIHJlZ2lzdGVyCj4gLSAqCj4g
LSAqIFRoaXMgZnVuY3Rpb24gcmVnaXN0ZXJzIGEgQ291bnRlciB0byB0aGUgc3lzdGVtLiBBIHN5
c2ZzICJjb3VudGVyIiBkaXJlY3RvcnkKPiAtICogd2lsbCBiZSBjcmVhdGVkIGFuZCBwb3B1bGF0
ZWQgd2l0aCBzeXNmcyBhdHRyaWJ1dGVzIGNvcnJlbGF0aW5nIHdpdGggdGhlCj4gLSAqIENvdW50
ZXIgU2lnbmFscywgU3luYXBzZXMsIGFuZCBDb3VudHMgcmVzcGVjdGl2ZWx5Lgo+IC0gKi8KPiAt
aW50IGNvdW50ZXJfcmVnaXN0ZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVy
KQo+IC17Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgKmRldmljZV9zdGF0
ZTsKPiAtICAgICAgIGludCBlcnI7Cj4gLQo+IC0gICAgICAgLyogQWxsb2NhdGUgaW50ZXJuYWwg
c3RhdGUgY29udGFpbmVyIGZvciBDb3VudGVyIGRldmljZSAqLwo+IC0gICAgICAgZGV2aWNlX3N0
YXRlID0ga3phbGxvYyhzaXplb2YoKmRldmljZV9zdGF0ZSksIEdGUF9LRVJORUwpOwo+IC0gICAg
ICAgaWYgKCFkZXZpY2Vfc3RhdGUpCj4gLSAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOwo+
IC0gICAgICAgY291bnRlci0+ZGV2aWNlX3N0YXRlID0gZGV2aWNlX3N0YXRlOwo+IC0KPiAtICAg
ICAgIC8qIEFjcXVpcmUgdW5pcXVlIElEICovCj4gLSAgICAgICBkZXZpY2Vfc3RhdGUtPmlkID0g
aWRhX3NpbXBsZV9nZXQoJmNvdW50ZXJfaWRhLCAwLCAwLCBHRlBfS0VSTkVMKTsKPiAtICAgICAg
IGlmIChkZXZpY2Vfc3RhdGUtPmlkIDwgMCkgewo+IC0gICAgICAgICAgICAgICBlcnIgPSBkZXZp
Y2Vfc3RhdGUtPmlkOwo+IC0gICAgICAgICAgICAgICBnb3RvIGVycl9mcmVlX2RldmljZV9zdGF0
ZTsKPiAtICAgICAgIH0KPiAtCj4gLSAgICAgICAvKiBDb25maWd1cmUgZGV2aWNlIHN0cnVjdHVy
ZSBmb3IgQ291bnRlciAqLwo+IC0gICAgICAgZGV2aWNlX3N0YXRlLT5kZXYudHlwZSA9ICZjb3Vu
dGVyX2RldmljZV90eXBlOwo+IC0gICAgICAgZGV2aWNlX3N0YXRlLT5kZXYuYnVzID0gJmNvdW50
ZXJfYnVzX3R5cGU7Cj4gLSAgICAgICBpZiAoY291bnRlci0+cGFyZW50KSB7Cj4gLSAgICAgICAg
ICAgICAgIGRldmljZV9zdGF0ZS0+ZGV2LnBhcmVudCA9IGNvdW50ZXItPnBhcmVudDsKPiAtICAg
ICAgICAgICAgICAgZGV2aWNlX3N0YXRlLT5kZXYub2Zfbm9kZSA9IGNvdW50ZXItPnBhcmVudC0+
b2Zfbm9kZTsKPiAtICAgICAgIH0KPiAtICAgICAgIGRldl9zZXRfbmFtZSgmZGV2aWNlX3N0YXRl
LT5kZXYsICJjb3VudGVyJWQiLCBkZXZpY2Vfc3RhdGUtPmlkKTsKPiAtICAgICAgIGRldmljZV9p
bml0aWFsaXplKCZkZXZpY2Vfc3RhdGUtPmRldik7Cj4gLSAgICAgICBkZXZfc2V0X2RydmRhdGEo
JmRldmljZV9zdGF0ZS0+ZGV2LCBjb3VudGVyKTsKPiAtCj4gLSAgICAgICAvKiBQcmVwYXJlIGRl
dmljZSBhdHRyaWJ1dGVzICovCj4gLSAgICAgICBlcnIgPSBjb3VudGVyX2RldmljZV9ncm91cHNf
bGlzdF9wcmVwYXJlKGNvdW50ZXIpOwo+IC0gICAgICAgaWYgKGVycikKPiAtICAgICAgICAgICAg
ICAgZ290byBlcnJfZnJlZV9pZDsKPiAtCj4gLSAgICAgICAvKiBPcmdhbml6ZSBkZXZpY2UgYXR0
cmlidXRlcyB0byBncm91cHMgYW5kIG1hdGNoIHRvIGRldmljZSAqLwo+IC0gICAgICAgZXJyID0g
Y291bnRlcl9kZXZpY2VfZ3JvdXBzX3ByZXBhcmUoZGV2aWNlX3N0YXRlKTsKPiAtICAgICAgIGlm
IChlcnIpCj4gLSAgICAgICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q7Cj4gLQo+
IC0gICAgICAgLyogQWRkIGRldmljZSB0byBzeXN0ZW0gKi8KPiAtICAgICAgIGVyciA9IGRldmlj
ZV9hZGQoJmRldmljZV9zdGF0ZS0+ZGV2KTsKPiAtICAgICAgIGlmIChlcnIpCj4gLSAgICAgICAg
ICAgICAgIGdvdG8gZXJyX2ZyZWVfZ3JvdXBzOwo+IC0KPiAtICAgICAgIHJldHVybiAwOwo+IC0K
PiAtZXJyX2ZyZWVfZ3JvdXBzOgo+IC0gICAgICAga2ZyZWUoZGV2aWNlX3N0YXRlLT5ncm91cHMp
Owo+IC1lcnJfZnJlZV9ncm91cHNfbGlzdDoKPiAtICAgICAgIGNvdW50ZXJfZGV2aWNlX2dyb3Vw
c19saXN0X2ZyZWUoZGV2aWNlX3N0YXRlLT5ncm91cHNfbGlzdCwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZGV2aWNlX3N0YXRlLT5udW1fZ3JvdXBzKTsKPiAtZXJy
X2ZyZWVfaWQ6Cj4gLSAgICAgICBpZGFfc2ltcGxlX3JlbW92ZSgmY291bnRlcl9pZGEsIGRldmlj
ZV9zdGF0ZS0+aWQpOwo+IC1lcnJfZnJlZV9kZXZpY2Vfc3RhdGU6Cj4gLSAgICAgICBrZnJlZShk
ZXZpY2Vfc3RhdGUpOwo+IC0gICAgICAgcmV0dXJuIGVycjsKPiAtfQo+IC1FWFBPUlRfU1lNQk9M
X0dQTChjb3VudGVyX3JlZ2lzdGVyKTsKPiAtCj4gLS8qKgo+IC0gKiBjb3VudGVyX3VucmVnaXN0
ZXIgLSB1bnJlZ2lzdGVyIENvdW50ZXIgZnJvbSB0aGUgc3lzdGVtCj4gLSAqIEBjb3VudGVyOiAg
IHBvaW50ZXIgdG8gQ291bnRlciB0byB1bnJlZ2lzdGVyCj4gLSAqCj4gLSAqIFRoZSBDb3VudGVy
IGlzIHVucmVnaXN0ZXJlZCBmcm9tIHRoZSBzeXN0ZW07IGFsbCBhbGxvY2F0ZWQgbWVtb3J5IGlz
IGZyZWVkLgo+IC0gKi8KPiAtdm9pZCBjb3VudGVyX3VucmVnaXN0ZXIoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb25zdCBjb3VudGVyKQo+IC17Cj4gLSAgICAgICBpZiAoY291bnRlcikKPiAtICAg
ICAgICAgICAgICAgZGV2aWNlX2RlbCgmY291bnRlci0+ZGV2aWNlX3N0YXRlLT5kZXYpOwo+IC19
Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfdW5yZWdpc3Rlcik7Cj4gLQo+IC1zdGF0aWMg
dm9pZCBkZXZtX2NvdW50ZXJfdW5yZWcoc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICpyZXMpCj4g
LXsKPiAtICAgICAgIGNvdW50ZXJfdW5yZWdpc3RlcigqKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
KilyZXMpOwo+IC19Cj4gLQo+IC0vKioKPiAtICogZGV2bV9jb3VudGVyX3JlZ2lzdGVyIC0gUmVz
b3VyY2UtbWFuYWdlZCBjb3VudGVyX3JlZ2lzdGVyCj4gLSAqIEBkZXY6ICAgICAgIGRldmljZSB0
byBhbGxvY2F0ZSBjb3VudGVyX2RldmljZSBmb3IKPiAtICogQGNvdW50ZXI6ICAgcG9pbnRlciB0
byBDb3VudGVyIHRvIHJlZ2lzdGVyCj4gLSAqCj4gLSAqIE1hbmFnZWQgY291bnRlcl9yZWdpc3Rl
ci4gVGhlIENvdW50ZXIgcmVnaXN0ZXJlZCB3aXRoIHRoaXMgZnVuY3Rpb24gaXMKPiAtICogYXV0
b21hdGljYWxseSB1bnJlZ2lzdGVyZWQgb24gZHJpdmVyIGRldGFjaC4gVGhpcyBmdW5jdGlvbiBj
YWxscwo+IC0gKiBjb3VudGVyX3JlZ2lzdGVyIGludGVybmFsbHkuIFJlZmVyIHRvIHRoYXQgZnVu
Y3Rpb24gZm9yIG1vcmUgaW5mb3JtYXRpb24uCj4gLSAqCj4gLSAqIElmIGFuIENvdW50ZXIgcmVn
aXN0ZXJlZCB3aXRoIHRoaXMgZnVuY3Rpb24gbmVlZHMgdG8gYmUgdW5yZWdpc3RlcmVkCj4gLSAq
IHNlcGFyYXRlbHksIGRldm1fY291bnRlcl91bnJlZ2lzdGVyIG11c3QgYmUgdXNlZC4KPiAtICoK
PiAtICogUkVUVVJOUzoKPiAtICogMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBudW1iZXIg
b24gZmFpbHVyZS4KPiAtICovCj4gLWludCBkZXZtX2NvdW50ZXJfcmVnaXN0ZXIoc3RydWN0IGRl
dmljZSAqZGV2LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb25zdCBjb3VudGVyKQo+IC17Cj4gLSAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KipwdHI7Cj4gLSAgICAgICBpbnQgcmV0Owo+IC0KPiAtICAgICAgIHB0ciA9IGRldnJlc19hbGxv
YyhkZXZtX2NvdW50ZXJfdW5yZWcsIHNpemVvZigqcHRyKSwgR0ZQX0tFUk5FTCk7Cj4gLSAgICAg
ICBpZiAoIXB0cikKPiAtICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07Cj4gLQo+IC0gICAg
ICAgcmV0ID0gY291bnRlcl9yZWdpc3Rlcihjb3VudGVyKTsKPiAtICAgICAgIGlmICghcmV0KSB7
Cj4gLSAgICAgICAgICAgICAgICpwdHIgPSBjb3VudGVyOwo+IC0gICAgICAgICAgICAgICBkZXZy
ZXNfYWRkKGRldiwgcHRyKTsKPiAtICAgICAgIH0gZWxzZSB7Cj4gLSAgICAgICAgICAgICAgIGRl
dnJlc19mcmVlKHB0cik7Cj4gLSAgICAgICB9Cj4gLQo+IC0gICAgICAgcmV0dXJuIHJldDsKPiAt
fQo+IC1FWFBPUlRfU1lNQk9MX0dQTChkZXZtX2NvdW50ZXJfcmVnaXN0ZXIpOwo+IC0KPiAtc3Rh
dGljIGludCBkZXZtX2NvdW50ZXJfbWF0Y2goc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICpyZXMs
IHZvaWQgKmRhdGEpCj4gLXsKPiAtICAgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZSAqKnIgPSBy
ZXM7Cj4gLQo+IC0gICAgICAgaWYgKCFyIHx8ICEqcikgewo+IC0gICAgICAgICAgICAgICBXQVJO
X09OKCFyIHx8ICEqcik7Cj4gLSAgICAgICAgICAgICAgIHJldHVybiAwOwo+IC0gICAgICAgfQo+
IC0KPiAtICAgICAgIHJldHVybiAqciA9PSBkYXRhOwo+IC19Cj4gLQo+IC0vKioKPiAtICogZGV2
bV9jb3VudGVyX3VucmVnaXN0ZXIgLSBSZXNvdXJjZS1tYW5hZ2VkIGNvdW50ZXJfdW5yZWdpc3Rl
cgo+IC0gKiBAZGV2OiAgICAgICBkZXZpY2UgdGhpcyBjb3VudGVyX2RldmljZSBiZWxvbmdzIHRv
Cj4gLSAqIEBjb3VudGVyOiAgIHBvaW50ZXIgdG8gQ291bnRlciBhc3NvY2lhdGVkIHdpdGggdGhl
IGRldmljZQo+IC0gKgo+IC0gKiBVbnJlZ2lzdGVyIENvdW50ZXIgcmVnaXN0ZXJlZCB3aXRoIGRl
dm1fY291bnRlcl9yZWdpc3Rlci4KPiAtICovCj4gLXZvaWQgZGV2bV9jb3VudGVyX3VucmVnaXN0
ZXIoc3RydWN0IGRldmljZSAqZGV2LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+IC17Cj4gLSAgICAgICBpbnQgcmM7
Cj4gLQo+IC0gICAgICAgcmMgPSBkZXZyZXNfcmVsZWFzZShkZXYsIGRldm1fY291bnRlcl91bnJl
ZywgZGV2bV9jb3VudGVyX21hdGNoLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICBjb3Vu
dGVyKTsKPiAtICAgICAgIFdBUk5fT04ocmMpOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGRl
dm1fY291bnRlcl91bnJlZ2lzdGVyKTsKPiAtCj4gLXN0YXRpYyBpbnQgX19pbml0IGNvdW50ZXJf
aW5pdCh2b2lkKQo+IC17Cj4gLSAgICAgICByZXR1cm4gYnVzX3JlZ2lzdGVyKCZjb3VudGVyX2J1
c190eXBlKTsKPiAtfQo+IC0KPiAtc3RhdGljIHZvaWQgX19leGl0IGNvdW50ZXJfZXhpdCh2b2lk
KQo+IC17Cj4gLSAgICAgICBidXNfdW5yZWdpc3RlcigmY291bnRlcl9idXNfdHlwZSk7Cj4gLX0K
PiAtCj4gLXN1YnN5c19pbml0Y2FsbChjb3VudGVyX2luaXQpOwo+IC1tb2R1bGVfZXhpdChjb3Vu
dGVyX2V4aXQpOwo+IC0KPiAtTU9EVUxFX0FVVEhPUigiV2lsbGlhbSBCcmVhdGhpdHQgR3JheSA8
dmlsaGVsbS5ncmF5QGdtYWlsLmNvbT4iKTsKPiAtTU9EVUxFX0RFU0NSSVBUSU9OKCJHZW5lcmlj
IENvdW50ZXIgaW50ZXJmYWNlIik7Cj4gLU1PRFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL2Z0bS1xdWFkZGVjLmMgYi9kcml2ZXJzL2NvdW50ZXIv
ZnRtLXF1YWRkZWMuYwo+IGluZGV4IDUzYzE1Zjg0OTA5Yi4uMDkyYTgwNmE0NmQ4IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvY291bnRlci9mdG0tcXVhZGRlYy5jCj4gKysrIGIvZHJpdmVycy9jb3Vu
dGVyL2Z0bS1xdWFkZGVjLmMKPiBAQCAtMTQsNiArMTQsNyBAQAo+ICAjaW5jbHVkZSA8bGludXgv
bXV0ZXguaD4KPiAgI2luY2x1ZGUgPGxpbnV4L2NvdW50ZXIuaD4KPiAgI2luY2x1ZGUgPGxpbnV4
L2JpdGZpZWxkLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+Cj4gICNkZWZpbmUgRlRN
X0ZJRUxEX1VQREFURShmdG0sIG9mZnNldCwgbWFzaywgdmFsKSAgICAgICAgICAgICAgICAgICAg
ICAgXAo+ICAgICAgICAgKHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFwKPiBAQCAtMTE1LDggKzExNiw3IEBAIHN0YXRpYyB2b2lk
IGZ0bV9xdWFkZGVjX2Rpc2FibGUodm9pZCAqZnRtKQo+ICB9Cj4KPiAgc3RhdGljIGludCBmdG1f
cXVhZGRlY19nZXRfcHJlc2NhbGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgKmNu
dF9tb2RlKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsIHUzMiAqY250X21vZGUpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBm
dG1fcXVhZGRlYyAqZnRtID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIHVpbnQzMl90IHNjZmxh
Z3M7Cj4gQEAgLTEyOSw4ICsxMjksNyBAQCBzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2dldF9wcmVz
Y2FsZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4KPiAgc3RhdGljIGlu
dCBmdG1fcXVhZGRlY19zZXRfcHJlc2NhbGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXpl
X3QgY250X21vZGUpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyIGNudF9tb2RlKQo+ICB7Cj4gICAgICAgICBzdHJ1
Y3QgZnRtX3F1YWRkZWMgKmZ0bSA9IGNvdW50ZXItPnByaXY7Cj4KPiBAQCAtMTUxLDMzICsxNTAs
MjEgQEAgc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBmdG1fcXVhZGRlY19wcmVzY2FsZXJbXSA9
IHsKPiAgICAgICAgICIxIiwgIjIiLCAiNCIsICI4IiwgIjE2IiwgIjMyIiwgIjY0IiwgIjEyOCIK
PiAgfTsKPgo+IC1zdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnRfZW51bV9leHQgZnRtX3F1YWRk
ZWNfcHJlc2NhbGVyX2VudW0gPSB7Cj4gLSAgICAgICAuaXRlbXMgPSBmdG1fcXVhZGRlY19wcmVz
Y2FsZXIsCj4gLSAgICAgICAubnVtX2l0ZW1zID0gQVJSQVlfU0laRShmdG1fcXVhZGRlY19wcmVz
Y2FsZXIpLAo+IC0gICAgICAgLmdldCA9IGZ0bV9xdWFkZGVjX2dldF9wcmVzY2FsZXIsCj4gLSAg
ICAgICAuc2V0ID0gZnRtX3F1YWRkZWNfc2V0X3ByZXNjYWxlcgo+IC19Owo+IC0KPiAtZW51bSBm
dG1fcXVhZGRlY19zeW5hcHNlX2FjdGlvbiB7Cj4gLSAgICAgICBGVE1fUVVBRERFQ19TWU5BUFNF
X0FDVElPTl9CT1RIX0VER0VTLAo+IC19Owo+IC0KPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRl
cl9zeW5hcHNlX2FjdGlvbiBmdG1fcXVhZGRlY19zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAtICAg
ICAgIFtGVE1fUVVBRERFQ19TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTXSA9Cj4gICAgICAgICBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMKPiAgfTsKPgo+ICBlbnVtIGZ0bV9xdWFk
ZGVjX2NvdW50X2Z1bmN0aW9uIHsKPiAtICAgICAgIEZUTV9RVUFEREVDX0NPVU5UX0VOQ09ERVJf
TU9ERV8xLAo+ICsgICAgICAgRlRNX1FVQURERUNfQ09VTlRfRU5DT0RFUl9NT0RFXzEgPSBDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gIH07Cj4KPiAgc3RhdGljIGNvbnN0IGVudW0g
Y291bnRlcl9mdW5jdGlvbiBmdG1fcXVhZGRlY19jb3VudF9mdW5jdGlvbnNbXSA9IHsKPiAtICAg
ICAgIFtGVE1fUVVBRERFQ19DT1VOVF9FTkNPREVSX01PREVfMV0gPSBDT1VOVEVSX0ZVTkNUSU9O
X1FVQURSQVRVUkVfWDQKPiArICAgICAgIEZUTV9RVUFEREVDX0NPVU5UX0VOQ09ERVJfTU9ERV8x
Cj4gIH07Cj4KPiAgc3RhdGljIGludCBmdG1fcXVhZGRlY19jb3VudF9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1bnNpZ25lZCBsb25nICp2YWwpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHU2NCAqdmFsKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgZnRtX3F1YWRkZWMgKmNvbnN0
IGZ0bSA9IGNvdW50ZXItPnByaXY7Cj4gICAgICAgICB1aW50MzJfdCBjbnR2YWw7Cj4gQEAgLTE5
MSw3ICsxNzgsNyBAQCBzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2NvdW50X3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+Cj4gIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfY291bnRf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5zaWduZWQgbG9uZyB2YWwpCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1NjQgdmFsKQo+ICB7Cj4gICAg
ICAgICBzdHJ1Y3QgZnRtX3F1YWRkZWMgKmNvbnN0IGZ0bSA9IGNvdW50ZXItPnByaXY7Cj4KPiBA
QCAtMjA1LDIxICsxOTIsMjEgQEAgc3RhdGljIGludCBmdG1fcXVhZGRlY19jb3VudF93cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gICAgICAgICByZXR1cm4gMDsKPiAgfQo+
Cj4gLXN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfY291bnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICpmdW5jdGlvbikKPiArc3RhdGljIGludCBm
dG1fcXVhZGRlY19jb3VudF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKQo+ICB7Cj4gICAgICAg
ICAqZnVuY3Rpb24gPSBGVE1fUVVBRERFQ19DT1VOVF9FTkNPREVSX01PREVfMTsKPgo+ICAgICAg
ICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2FjdGlvbl9nZXQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCAqYWN0aW9uKQo+ICtzdGF0aWMg
aW50IGZ0bV9xdWFkZGVjX2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBj
b3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+IC0gICAgICAg
KmFjdGlvbiA9IEZUTV9RVUFEREVDX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gKyAgICAg
ICAqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+Cj4gICAgICAg
ICByZXR1cm4gMDsKPiAgfQo+IEBAIC0yMjcsOCArMjE0LDggQEAgc3RhdGljIGludCBmdG1fcXVh
ZGRlY19hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyBmdG1fcXVhZGRlY19jbnRfb3BzID0gewo+ICAgICAg
ICAgLmNvdW50X3JlYWQgPSBmdG1fcXVhZGRlY19jb3VudF9yZWFkLAo+ICAgICAgICAgLmNvdW50
X3dyaXRlID0gZnRtX3F1YWRkZWNfY291bnRfd3JpdGUsCj4gLSAgICAgICAuZnVuY3Rpb25fZ2V0
ID0gZnRtX3F1YWRkZWNfY291bnRfZnVuY3Rpb25fZ2V0LAo+IC0gICAgICAgLmFjdGlvbl9nZXQg
PSBmdG1fcXVhZGRlY19hY3Rpb25fZ2V0LAo+ICsgICAgICAgLmZ1bmN0aW9uX3JlYWQgPSBmdG1f
cXVhZGRlY19jb3VudF9mdW5jdGlvbl9yZWFkLAo+ICsgICAgICAgLmFjdGlvbl9yZWFkID0gZnRt
X3F1YWRkZWNfYWN0aW9uX3JlYWQsCj4gIH07Cj4KPiAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3Np
Z25hbCBmdG1fcXVhZGRlY19zaWduYWxzW10gPSB7Cj4gQEAgLTI1NSw5ICsyNDIsMTIgQEAgc3Rh
dGljIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgZnRtX3F1YWRkZWNfY291bnRfc3luYXBzZXNbXSA9
IHsKPiAgICAgICAgIH0KPiAgfTsKPgo+IC1zdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291
bnRfZXh0IGZ0bV9xdWFkZGVjX2NvdW50X2V4dFtdID0gewo+IC0gICAgICAgQ09VTlRFUl9DT1VO
VF9FTlVNKCJwcmVzY2FsZXIiLCAmZnRtX3F1YWRkZWNfcHJlc2NhbGVyX2VudW0pLAo+IC0gICAg
ICAgQ09VTlRFUl9DT1VOVF9FTlVNX0FWQUlMQUJMRSgicHJlc2NhbGVyIiwgJmZ0bV9xdWFkZGVj
X3ByZXNjYWxlcl9lbnVtKSwKPiArc3RhdGljIERFRklORV9DT1VOVEVSX0VOVU0oZnRtX3F1YWRk
ZWNfcHJlc2NhbGVyX2VudW0sIGZ0bV9xdWFkZGVjX3ByZXNjYWxlcik7Cj4gKwo+ICtzdGF0aWMg
c3RydWN0IGNvdW50ZXJfY29tcCBmdG1fcXVhZGRlY19jb3VudF9leHRbXSA9IHsKPiArICAgICAg
IENPVU5URVJfQ09NUF9DT1VOVF9FTlVNKCJwcmVzY2FsZXIiLCBmdG1fcXVhZGRlY19nZXRfcHJl
c2NhbGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnRtX3F1YWRkZWNfc2V0
X3ByZXNjYWxlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ0bV9xdWFkZGVj
X3ByZXNjYWxlcl9lbnVtKSwKPiAgfTsKPgo+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnQg
ZnRtX3F1YWRkZWNfY291bnRzID0gewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvaW50
ZWwtcWVwLmMgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMKPiBpbmRleCBmNGJlOWQ3OGM4
NGMuLmVjMDU2ZjMxZmE1NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVw
LmMKPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMKPiBAQCAtNjMsMTMgKzYzLDYg
QEAKPgo+ICAjZGVmaW5lIElOVEVMX1FFUF9DTEtfUEVSSU9EX05TICAgICAgICAgICAgICAgIDEw
Cj4KPiAtI2RlZmluZSBJTlRFTF9RRVBfQ09VTlRFUl9FWFRfUlcoX25hbWUpICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBcCj4gLXsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwKPiAtICAgICAgIC5uYW1lID0gI19uYW1l
LCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXAo+IC0gICAgICAgLnJl
YWQgPSBfbmFtZSMjX3JlYWQsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcCj4g
LSAgICAgICAud3JpdGUgPSBfbmFtZSMjX3dyaXRlLCAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIFwKPiAtfQo+IC0KPiAgc3RydWN0IGludGVsX3FlcCB7Cj4gICAgICAgICBzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgY291bnRlcjsKPiAgICAgICAgIHN0cnVjdCBtdXRleCBsb2NrOwo+IEBA
IC0xMTUsOCArMTA4LDcgQEAgc3RhdGljIHZvaWQgaW50ZWxfcWVwX2luaXQoc3RydWN0IGludGVs
X3FlcCAqcWVwKQo+ICB9Cj4KPiAgc3RhdGljIGludCBpbnRlbF9xZXBfY291bnRfcmVhZChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBsb25nICp2YWwpCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsKQo+ICB7Cj4gICAg
ICAgICBzdHJ1Y3QgaW50ZWxfcWVwICpjb25zdCBxZXAgPSBjb3VudGVyLT5wcml2Owo+Cj4gQEAg
LTEzMSwxMSArMTIzLDExIEBAIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gaW50
ZWxfcWVwX2NvdW50X2Z1bmN0aW9uc1tdID0gewo+ICAgICAgICAgQ09VTlRFUl9GVU5DVElPTl9R
VUFEUkFUVVJFX1g0LAo+ICB9Owo+Cj4gLXN0YXRpYyBpbnQgaW50ZWxfcWVwX2Z1bmN0aW9uX2dl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICpmdW5jdGlvbikKPiArc3RhdGljIGludCBpbnRl
bF9xZXBfZnVuY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGNvdW50ZXJfZnVu
Y3Rpb24gKmZ1bmN0aW9uKQo+ICB7Cj4gLSAgICAgICAqZnVuY3Rpb24gPSAwOwo+ICsgICAgICAg
KmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Owo+Cj4gICAgICAgICBy
ZXR1cm4gMDsKPiAgfQo+IEBAIC0xNDQsMTkgKzEzNiwxOSBAQCBzdGF0aWMgY29uc3QgZW51bSBj
b3VudGVyX3N5bmFwc2VfYWN0aW9uIGludGVsX3FlcF9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAg
ICAgICAgIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiAgfTsKPgo+IC1zdGF0
aWMgaW50IGludGVsX3FlcF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVy
X3N5bmFwc2UgKnN5bmFwc2UsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXpl
X3QgKmFjdGlvbikKPiArc3RhdGljIGludCBpbnRlbF9xZXBfYWN0aW9uX3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKQo+
ICB7Cj4gLSAgICAgICAqYWN0aW9uID0gMDsKPiArICAgICAgICphY3Rpb24gPSBDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gICAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgaW50ZWxfcWVwX2NvdW50ZXJfb3BzID0gewo+
ICAgICAgICAgLmNvdW50X3JlYWQgPSBpbnRlbF9xZXBfY291bnRfcmVhZCwKPiAtICAgICAgIC5m
dW5jdGlvbl9nZXQgPSBpbnRlbF9xZXBfZnVuY3Rpb25fZ2V0LAo+IC0gICAgICAgLmFjdGlvbl9n
ZXQgPSBpbnRlbF9xZXBfYWN0aW9uX2dldCwKPiArICAgICAgIC5mdW5jdGlvbl9yZWFkID0gaW50
ZWxfcWVwX2Z1bmN0aW9uX3JlYWQsCj4gKyAgICAgICAuYWN0aW9uX3JlYWQgPSBpbnRlbF9xZXBf
YWN0aW9uX3JlYWQsCj4gIH07Cj4KPiAgI2RlZmluZSBJTlRFTF9RRVBfU0lHTkFMKF9pZCwgX25h
bWUpIHsgICAgICAgICAgICAgICAgICAgICAgICAgXAo+IEBAIC0xODIsMzEgKzE3NCwyNyBAQCBz
dGF0aWMgc3RydWN0IGNvdW50ZXJfc3luYXBzZSBpbnRlbF9xZXBfY291bnRfc3luYXBzZXNbXSA9
IHsKPiAgICAgICAgIElOVEVMX1FFUF9TWU5BUFNFKDIpLAo+ICB9Owo+Cj4gLXN0YXRpYyBzc2l6
ZV90IGNlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+ICtzdGF0aWMg
aW50IGludGVsX3FlcF9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsIHU2NCAqY2VpbGluZykKPiAgewo+ICAgICAgICAgc3RydWN0IGludGVsX3FlcCAq
cWVwID0gY291bnRlci0+cHJpdjsKPiAtICAgICAgIHUzMiByZWc7Cj4KPiAgICAgICAgIHBtX3J1
bnRpbWVfZ2V0X3N5bmMocWVwLT5kZXYpOwo+IC0gICAgICAgcmVnID0gaW50ZWxfcWVwX3JlYWRs
KHFlcCwgSU5URUxfUUVQTUFYKTsKPiArICAgICAgICpjZWlsaW5nID0gaW50ZWxfcWVwX3JlYWRs
KHFlcCwgSU5URUxfUUVQTUFYKTsKPiAgICAgICAgIHBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsK
Pgo+IC0gICAgICAgcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJXVcbiIsIHJlZyk7Cj4gKyAgICAg
ICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRpYyBzc2l6ZV90IGNlaWxpbmdfd3JpdGUoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdm9pZCAqcHJpdiwgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50
IGludGVsX3FlcF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwgdTY0IG1heCkKPiAgewo+ICAgICAgICAgc3RydWN0IGludGVsX3FlcCAqcWVwID0g
Y291bnRlci0+cHJpdjsKPiAtICAgICAgIHUzMiBtYXg7Cj4gLSAgICAgICBpbnQgcmV0Owo+ICsg
ICAgICAgaW50IHJldCA9IDA7Cj4KPiAtICAgICAgIHJldCA9IGtzdHJ0b3UzMihidWYsIDAsICZt
YXgpOwo+IC0gICAgICAgaWYgKHJldCA8IDApCj4gLSAgICAgICAgICAgICAgIHJldHVybiByZXQ7
Cj4gKyAgICAgICAvKiBJbnRlbCBRRVAgY2VpbGluZyBjb25maWd1cmF0aW9uIG9ubHkgc3VwcG9y
dHMgMzItYml0IHZhbHVlcyAqLwo+ICsgICAgICAgaWYgKG1heCAhPSAodTMyKW1heCkKPiArICAg
ICAgICAgICAgICAgcmV0dXJuIC1FUkFOR0U7Cj4KPiAgICAgICAgIG11dGV4X2xvY2soJnFlcC0+
bG9jayk7Cj4gICAgICAgICBpZiAocWVwLT5lbmFibGVkKSB7Cj4gQEAgLTIxNywzNCArMjA1LDI4
IEBAIHN0YXRpYyBzc2l6ZV90IGNlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+ICAgICAgICAgcG1fcnVudGltZV9nZXRfc3luYyhxZXAtPmRldik7Cj4gICAgICAg
ICBpbnRlbF9xZXBfd3JpdGVsKHFlcCwgSU5URUxfUUVQTUFYLCBtYXgpOwo+ICAgICAgICAgcG1f
cnVudGltZV9wdXQocWVwLT5kZXYpOwo+IC0gICAgICAgcmV0ID0gbGVuOwo+Cj4gIG91dDoKPiAg
ICAgICAgIG11dGV4X3VubG9jaygmcWVwLT5sb2NrKTsKPiAgICAgICAgIHJldHVybiByZXQ7Cj4g
IH0KPgo+IC1zdGF0aWMgc3NpemVfdCBlbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXYsIGNoYXIg
KmJ1ZikKPiArc3RhdGljIGludCBpbnRlbF9xZXBfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggKmVuYWJsZSkKPiAgewo+ICAgICAgICAgc3RydWN0
IGludGVsX3FlcCAqcWVwID0gY291bnRlci0+cHJpdjsKPgo+IC0gICAgICAgcmV0dXJuIHN5c2Zz
X2VtaXQoYnVmLCAiJXVcbiIsIHFlcC0+ZW5hYmxlZCk7Cj4gKyAgICAgICAqZW5hYmxlID0gcWVw
LT5lbmFibGVkOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXpl
X3QgZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpwcml2LCBjb25zdCBjaGFyICpidWYsIHNpemVf
dCBsZW4pCj4gK3N0YXRpYyBpbnQgaW50ZWxfcWVwX2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggdmFsKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qg
aW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgdTMyIHJlZzsKPiAtICAg
ICAgIGJvb2wgdmFsLCBjaGFuZ2VkOwo+IC0gICAgICAgaW50IHJldDsKPiAtCj4gLSAgICAgICBy
ZXQgPSBrc3RydG9ib29sKGJ1ZiwgJnZhbCk7Cj4gLSAgICAgICBpZiAocmV0KQo+IC0gICAgICAg
ICAgICAgICByZXR1cm4gcmV0Owo+ICsgICAgICAgYm9vbCBjaGFuZ2VkOwo+Cj4gICAgICAgICBt
dXRleF9sb2NrKCZxZXAtPmxvY2spOwo+ICAgICAgICAgY2hhbmdlZCA9IHZhbCBeIHFlcC0+ZW5h
YmxlZDsKPiBAQCAtMjY4LDEyICsyNTAsMTIgQEAgc3RhdGljIHNzaXplX3QgZW5hYmxlX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPgo+ICBvdXQ6Cj4gICAgICAgICBtdXRl
eF91bmxvY2soJnFlcC0+bG9jayk7Cj4gLSAgICAgICByZXR1cm4gbGVuOwo+ICsgICAgICAgcmV0
dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBzcGlrZV9maWx0ZXJfbnNfcmVhZChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBp
bnRlbF9xZXBfc3Bpa2VfZmlsdGVyX25zX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB1NjQgKmxlbmd0aCkKPiAgewo+ICAgICAgICAgc3RydWN0IGludGVsX3FlcCAqcWVw
ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIHUzMiByZWc7Cj4gQEAgLTI4MiwyNiArMjY0LDI0
IEBAIHN0YXRpYyBzc2l6ZV90IHNwaWtlX2ZpbHRlcl9uc19yZWFkKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiAgICAgICAgIHJlZyA9IGludGVsX3FlcF9yZWFkbChxZXAsIElOVEVM
X1FFUENPTik7Cj4gICAgICAgICBpZiAoIShyZWcgJiBJTlRFTF9RRVBDT05fRkxUX0VOKSkgewo+
ICAgICAgICAgICAgICAgICBwbV9ydW50aW1lX3B1dChxZXAtPmRldik7Cj4gLSAgICAgICAgICAg
ICAgIHJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIjBcbiIpOwo+ICsgICAgICAgICAgICAgICByZXR1
cm4gMDsKPiAgICAgICAgIH0KPiAgICAgICAgIHJlZyA9IElOVEVMX1FFUEZMVF9NQVhfQ09VTlQo
aW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5URUxfUUVQRkxUKSk7Cj4gICAgICAgICBwbV9ydW50aW1l
X3B1dChxZXAtPmRldik7Cj4KPiAtICAgICAgIHJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiV1XG4i
LCAocmVnICsgMikgKiBJTlRFTF9RRVBfQ0xLX1BFUklPRF9OUyk7Cj4gKyAgICAgICAqbGVuZ3Ro
ID0gKHJlZyArIDIpICogSU5URUxfUUVQX0NMS19QRVJJT0RfTlM7Cj4gKwo+ICsgICAgICAgcmV0
dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBzcGlrZV9maWx0ZXJfbnNfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXYsIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90
IGxlbikKPiArc3RhdGljIGludCBpbnRlbF9xZXBfc3Bpa2VfZmlsdGVyX25zX3dyaXRlKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1NjQgbGVuZ3RoKQo+ICB7Cj4gICAgICAg
ICBzdHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owo+IC0gICAgICAgdTMyIHJl
ZywgbGVuZ3RoOwo+ICsgICAgICAgdTMyIHJlZzsKPiAgICAgICAgIGJvb2wgZW5hYmxlOwo+IC0g
ICAgICAgaW50IHJldDsKPiAtCj4gLSAgICAgICByZXQgPSBrc3RydG91MzIoYnVmLCAwLCAmbGVu
Z3RoKTsKPiAtICAgICAgIGlmIChyZXQgPCAwKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gcmV0
Owo+ICsgICAgICAgaW50IHJldCA9IDA7Cj4KPiAgICAgICAgIC8qCj4gICAgICAgICAgKiBTcGlr
ZSBmaWx0ZXIgbGVuZ3RoIGlzIChNQVhfQ09VTlQgKyAyKSBjbG9jayBwZXJpb2RzLgo+IEBAIC0z
MzcsMTYgKzMxNywxNSBAQCBzdGF0aWMgc3NpemVfdCBzcGlrZV9maWx0ZXJfbnNfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAgICAgaW50ZWxfcWVwX3dyaXRlbChx
ZXAsIElOVEVMX1FFUEZMVCwgbGVuZ3RoKTsKPiAgICAgICAgIGludGVsX3FlcF93cml0ZWwocWVw
LCBJTlRFTF9RRVBDT04sIHJlZyk7Cj4gICAgICAgICBwbV9ydW50aW1lX3B1dChxZXAtPmRldik7
Cj4gLSAgICAgICByZXQgPSBsZW47Cj4KPiAgb3V0Ogo+ICAgICAgICAgbXV0ZXhfdW5sb2NrKCZx
ZXAtPmxvY2spOwo+ICAgICAgICAgcmV0dXJuIHJldDsKPiAgfQo+Cj4gLXN0YXRpYyBzc2l6ZV90
IHByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqcHJpdiwgY2hhciAq
YnVmKQo+ICtzdGF0aWMgaW50IGludGVsX3FlcF9wcmVzZXRfZW5hYmxlX3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHU4ICpwcmVzZXRfZW5hYmxlKQo+ICB7Cj4gICAgICAgICBz
dHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgdTMyIHJlZzsK
PiBAQCAtMzU0LDIxICszMzMsMTggQEAgc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgICAgICAgIHBtX3J1bnRpbWVfZ2V0
X3N5bmMocWVwLT5kZXYpOwo+ICAgICAgICAgcmVnID0gaW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5U
RUxfUUVQQ09OKTsKPiAgICAgICAgIHBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsKPiAtICAgICAg
IHJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiV1XG4iLCAhKHJlZyAmIElOVEVMX1FFUENPTl9DT1VO
VF9SU1RfTU9ERSkpOwo+ICsKPiArICAgICAgICpwcmVzZXRfZW5hYmxlID0gIShyZWcgJiBJTlRF
TF9RRVBDT05fQ09VTlRfUlNUX01PREUpOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4K
PiAtc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2b2lkICpwcml2LCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQg
aW50ZWxfcWVwX3ByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1OCB2YWwpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBpbnRlbF9x
ZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7Cj4gICAgICAgICB1MzIgcmVnOwo+IC0gICAgICAgYm9v
bCB2YWw7Cj4gLSAgICAgICBpbnQgcmV0Owo+IC0KPiAtICAgICAgIHJldCA9IGtzdHJ0b2Jvb2wo
YnVmLCAmdmFsKTsKPiAtICAgICAgIGlmIChyZXQpCj4gLSAgICAgICAgICAgICAgIHJldHVybiBy
ZXQ7Cj4gKyAgICAgICBpbnQgcmV0ID0gMDsKPgo+ICAgICAgICAgbXV0ZXhfbG9jaygmcWVwLT5s
b2NrKTsKPiAgICAgICAgIGlmIChxZXAtPmVuYWJsZWQpIHsKPiBAQCAtMzg1LDcgKzM2MSw2IEBA
IHN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+Cj4gICAgICAgICBpbnRlbF9xZXBfd3JpdGVsKHFlcCwgSU5URUxfUUVQQ09O
LCByZWcpOwo+ICAgICAgICAgcG1fcnVudGltZV9wdXQocWVwLT5kZXYpOwo+IC0gICAgICAgcmV0
ID0gbGVuOwo+Cj4gIG91dDoKPiAgICAgICAgIG11dGV4X3VubG9jaygmcWVwLT5sb2NrKTsKPiBA
QCAtMzkzLDExICszNjgsMTQgQEAgc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV93cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gICAgICAgICByZXR1cm4gcmV0Owo+ICB9
Cj4KPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCBpbnRlbF9xZXBfY291
bnRfZXh0W10gPSB7Cj4gLSAgICAgICBJTlRFTF9RRVBfQ09VTlRFUl9FWFRfUlcoY2VpbGluZyks
Cj4gLSAgICAgICBJTlRFTF9RRVBfQ09VTlRFUl9FWFRfUlcoZW5hYmxlKSwKPiAtICAgICAgIElO
VEVMX1FFUF9DT1VOVEVSX0VYVF9SVyhzcGlrZV9maWx0ZXJfbnMpLAo+IC0gICAgICAgSU5URUxf
UUVQX0NPVU5URVJfRVhUX1JXKHByZXNldF9lbmFibGUpCj4gK3N0YXRpYyBzdHJ1Y3QgY291bnRl
cl9jb21wIGludGVsX3FlcF9jb3VudF9leHRbXSA9IHsKPiArICAgICAgIENPVU5URVJfQ09NUF9F
TkFCTEUoaW50ZWxfcWVwX2VuYWJsZV9yZWFkLCBpbnRlbF9xZXBfZW5hYmxlX3dyaXRlKSwKPiAr
ICAgICAgIENPVU5URVJfQ09NUF9DRUlMSU5HKGludGVsX3FlcF9jZWlsaW5nX3JlYWQsIGludGVs
X3FlcF9jZWlsaW5nX3dyaXRlKSwKPiArICAgICAgIENPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxF
KGludGVsX3FlcF9wcmVzZXRfZW5hYmxlX3JlYWQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpbnRlbF9xZXBfcHJlc2V0X2VuYWJsZV93cml0ZSksCj4gKyAgICAgICBDT1VO
VEVSX0NPTVBfQ09VTlRfVTY0KCJzcGlrZV9maWx0ZXJfbnMiLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpbnRlbF9xZXBfc3Bpa2VfZmlsdGVyX25zX3JlYWQsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGludGVsX3FlcF9zcGlrZV9maWx0ZXJfbnNfd3JpdGUpLAo+
ICB9Owo+Cj4gIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb3VudCBpbnRlbF9xZXBfY291bnRlcl9j
b3VudFtdID0gewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5j
IGIvZHJpdmVycy9jb3VudGVyL2ludGVycnVwdC1jbnQuYwo+IGluZGV4IDFkZTQyNDNkYjQ4OC4u
ODUxNGE4N2ZjYmVlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvY291bnRlci9pbnRlcnJ1cHQtY250
LmMKPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5jCj4gQEAgLTEwLDYgKzEw
LDcgQEAKPiAgI2luY2x1ZGUgPGxpbnV4L21vZF9kZXZpY2V0YWJsZS5oPgo+ICAjaW5jbHVkZSA8
bGludXgvbW9kdWxlLmg+Cj4gICNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KPiAr
I2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4KPiAgI2RlZmluZSBJTlRFUlJVUFRfQ05UX05BTUUg
ImludGVycnVwdC1jbnQiCj4KPiBAQCAtMzMsMzAgKzM0LDIzIEBAIHN0YXRpYyBpcnFyZXR1cm5f
dCBpbnRlcnJ1cHRfY250X2lzcihpbnQgaXJxLCB2b2lkICpkZXZfaWQpCj4gICAgICAgICByZXR1
cm4gSVJRX0hBTkRMRUQ7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBpbnRlcnJ1cHRfY250X2Vu
YWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXZhdGUs
IGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBpbnRlcnJ1cHRfY250X2VuYWJsZV9yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCAqZW5hYmxlKQo+ICB7Cj4g
ICAgICAgICBzdHJ1Y3QgaW50ZXJydXB0X2NudF9wcml2ICpwcml2ID0gY291bnRlci0+cHJpdjsK
Pgo+IC0gICAgICAgcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJWRcbiIsIHByaXYtPmVuYWJsZWQp
Owo+ICsgICAgICAgKmVuYWJsZSA9IHByaXYtPmVuYWJsZWQ7Cj4gKwo+ICsgICAgICAgcmV0dXJu
IDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBpbnRlcnJ1cHRfY250X2VuYWJsZV93cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNo
YXIgKmJ1ZiwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXpl
X3QgbGVuKQo+ICtzdGF0aWMgaW50IGludGVycnVwdF9jbnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggZW5hYmxlKQo+ICB7Cj4gICAg
ICAgICBzdHJ1Y3QgaW50ZXJydXB0X2NudF9wcml2ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiAt
ICAgICAgIGJvb2wgZW5hYmxlOwo+IC0gICAgICAgc3NpemVfdCByZXQ7Cj4gLQo+IC0gICAgICAg
cmV0ID0ga3N0cnRvYm9vbChidWYsICZlbmFibGUpOwo+IC0gICAgICAgaWYgKHJldCkKPiAtICAg
ICAgICAgICAgICAgcmV0dXJuIHJldDsKPgo+ICAgICAgICAgaWYgKHByaXYtPmVuYWJsZWQgPT0g
ZW5hYmxlKQo+IC0gICAgICAgICAgICAgICByZXR1cm4gbGVuOwo+ICsgICAgICAgICAgICAgICBy
ZXR1cm4gMDsKPgo+ICAgICAgICAgaWYgKGVuYWJsZSkgewo+ICAgICAgICAgICAgICAgICBwcml2
LT5lbmFibGVkID0gdHJ1ZTsKPiBAQCAtNjYsMzMgKzYwLDMwIEBAIHN0YXRpYyBzc2l6ZV90IGlu
dGVycnVwdF9jbnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAgICAgICAgICAgICAgICAgcHJpdi0+ZW5hYmxlZCA9IGZhbHNlOwo+ICAgICAgICAgfQo+Cj4g
LSAgICAgICByZXR1cm4gbGVuOwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMg
Y29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0IGludGVycnVwdF9jbnRfZXh0W10gPSB7Cj4g
LSAgICAgICB7Cj4gLSAgICAgICAgICAgICAgIC5uYW1lID0gImVuYWJsZSIsCj4gLSAgICAgICAg
ICAgICAgIC5yZWFkID0gaW50ZXJydXB0X2NudF9lbmFibGVfcmVhZCwKPiAtICAgICAgICAgICAg
ICAgLndyaXRlID0gaW50ZXJydXB0X2NudF9lbmFibGVfd3JpdGUsCj4gLSAgICAgICB9LAo+ICtz
dGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBpbnRlcnJ1cHRfY250X2V4dFtdID0gewo+ICsgICAg
ICAgQ09VTlRFUl9DT01QX0VOQUJMRShpbnRlcnJ1cHRfY250X2VuYWJsZV9yZWFkLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnJ1cHRfY250X2VuYWJsZV93cml0ZSksCj4gIH07
Cj4KPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBpbnRlcnJ1cHRf
Y250X3N5bmFwc2VfYWN0aW9uc1tdID0gewo+ICAgICAgICAgQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9SSVNJTkdfRURHRSwKPiAgfTsKPgo+IC1zdGF0aWMgaW50IGludGVycnVwdF9jbnRfYWN0aW9u
X2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFw
c2UsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICphY3Rpb24p
Cj4gK3N0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9hY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rp
b24pCj4gIHsKPiAtICAgICAgICphY3Rpb24gPSAwOwo+ICsgICAgICAgKmFjdGlvbiA9IENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4KPiAgICAgICAgIHJldHVybiAwOwo+ICB9
Cj4KPiAgc3RhdGljIGludCBpbnRlcnJ1cHRfY250X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyAqdmFsKQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2YWwpCj4gIHsKPiAg
ICAgICAgIHN0cnVjdCBpbnRlcnJ1cHRfY250X3ByaXYgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+
Cj4gQEAgLTEwMiw4ICs5Myw3IEBAIHN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgfQo+Cj4gIHN0YXRpYyBpbnQgaW50ZXJydXB0
X2NudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdW5zaWduZWQgbG9uZyB2YWwpCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgY29u
c3QgdTY0IHZhbCkKPiAgewo+ICAgICAgICAgc3RydWN0IGludGVycnVwdF9jbnRfcHJpdiAqcHJp
diA9IGNvdW50ZXItPnByaXY7Cj4KPiBAQCAtMTE5LDExICsxMDksMTEgQEAgc3RhdGljIGNvbnN0
IGVudW0gY291bnRlcl9mdW5jdGlvbiBpbnRlcnJ1cHRfY250X2Z1bmN0aW9uc1tdID0gewo+ICAg
ICAgICAgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKPiAgfTsKPgo+IC1zdGF0aWMgaW50IGlu
dGVycnVwdF9jbnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVf
dCAqZnVuY3Rpb24pCj4gK3N0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9mdW5jdGlvbl9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlv
bikKPiAgewo+IC0gICAgICAgKmZ1bmN0aW9uID0gMDsKPiArICAgICAgICpmdW5jdGlvbiA9IENP
VU5URVJfRlVOQ1RJT05fSU5DUkVBU0U7Cj4KPiAgICAgICAgIHJldHVybiAwOwo+ICB9Cj4gQEAg
LTE0OCwxMCArMTM4LDEwIEBAIHN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9zaWduYWxfcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPgo+ICBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfb3BzIGludGVycnVwdF9jbnRfb3BzID0gewo+IC0gICAgICAgLmFjdGlvbl9n
ZXQgPSBpbnRlcnJ1cHRfY250X2FjdGlvbl9nZXQsCj4gKyAgICAgICAuYWN0aW9uX3JlYWQgPSBp
bnRlcnJ1cHRfY250X2FjdGlvbl9yZWFkLAo+ICAgICAgICAgLmNvdW50X3JlYWQgPSBpbnRlcnJ1
cHRfY250X3JlYWQsCj4gICAgICAgICAuY291bnRfd3JpdGUgPSBpbnRlcnJ1cHRfY250X3dyaXRl
LAo+IC0gICAgICAgLmZ1bmN0aW9uX2dldCA9IGludGVycnVwdF9jbnRfZnVuY3Rpb25fZ2V0LAo+
ICsgICAgICAgLmZ1bmN0aW9uX3JlYWQgPSBpbnRlcnJ1cHRfY250X2Z1bmN0aW9uX3JlYWQsCj4g
ICAgICAgICAuc2lnbmFsX3JlYWQgID0gaW50ZXJydXB0X2NudF9zaWduYWxfcmVhZCwKPiAgfTsK
Pgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvbWljcm9jaGlwLXRjYi1jYXB0dXJlLmMg
Yi9kcml2ZXJzL2NvdW50ZXIvbWljcm9jaGlwLXRjYi1jYXB0dXJlLmMKPiBpbmRleCA0YzU3ZDQz
ZTdkNjYuLjc5ZTBjODRhM2I4MSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvbWljcm9j
aGlwLXRjYi1jYXB0dXJlLmMKPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvbWljcm9jaGlwLXRjYi1j
YXB0dXJlLmMKPiBAQCAtMzIsMjggKzMyLDE2IEBAIHN0cnVjdCBtY2hwX3RjX2RhdGEgewo+ICAg
ICAgICAgYm9vbCB0cmlnX2ludmVydGVkOwo+ICB9Owo+Cj4gLWVudW0gbWNocF90Y19jb3VudF9m
dW5jdGlvbiB7Cj4gLSAgICAgICBNQ0hQX1RDX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0gICAgICAg
TUNIUF9UQ19GVU5DVElPTl9RVUFEUkFUVVJFLAo+IC19Owo+IC0KPiAtc3RhdGljIGNvbnN0IGVu
dW0gY291bnRlcl9jb3VudF9mdW5jdGlvbiBtY2hwX3RjX2NvdW50X2Z1bmN0aW9uc1tdID0gewo+
IC0gICAgICAgW01DSFBfVENfRlVOQ1RJT05fSU5DUkVBU0VdID0gQ09VTlRFUl9GVU5DVElPTl9J
TkNSRUFTRSwKPiAtICAgICAgIFtNQ0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRVUkVdID0gQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1g0LAo+IC19Owo+IC0KPiAtZW51bSBtY2hwX3RjX3N5bmFw
c2VfYWN0aW9uIHsKPiAtICAgICAgIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORSA9IDAsCj4g
LSAgICAgICBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+IC0gICAgICAgTUNI
UF9UQ19TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gLSAgICAgICBNQ0hQX1RDX1NZTkFQ
U0VfQUNUSU9OX0JPVEhfRURHRQo+ICtzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9u
IG1jaHBfdGNfY291bnRfZnVuY3Rpb25zW10gPSB7Cj4gKyAgICAgICBDT1VOVEVSX0ZVTkNUSU9O
X0lOQ1JFQVNFLAo+ICsgICAgICAgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0LAo+ICB9
Owo+Cj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gbWNocF90Y19z
eW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAtICAgICAgIFtNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX05P
TkVdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+IC0gICAgICAgW01DSFBfVENfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0VdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdf
RURHRSwKPiAtICAgICAgIFtNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRV0gPSBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiAtICAgICAgIFtNQ0hQX1RDX1NZ
TkFQU0VfQUNUSU9OX0JPVEhfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVMsCj4gKyAgICAgICBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gKyAgICAgICBDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ICsgICAgICAgQ09VTlRFUl9TWU5BUFNF
X0FDVElPTl9GQUxMSU5HX0VER0UsCj4gKyAgICAgICBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVMsCj4gIH07Cj4KPiAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbCBtY2hwX3Rj
X2NvdW50X3NpZ25hbHNbXSA9IHsKPiBAQCAtODAsMjMgKzY4LDIzIEBAIHN0YXRpYyBzdHJ1Y3Qg
Y291bnRlcl9zeW5hcHNlIG1jaHBfdGNfY291bnRfc3luYXBzZXNbXSA9IHsKPiAgICAgICAgIH0K
PiAgfTsKPgo+IC1zdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNpemVfdCAqZnVuY3Rpb24pCj4gK3N0YXRpYyBpbnQgbWNocF90
Y19jb3VudF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBj
b3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKPiAgewo+ICAgICAgICAgc3RydWN0IG1jaHBfdGNf
ZGF0YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4KPiAgICAgICAgIGlmIChwcml2LT5x
ZGVjX21vZGUpCj4gLSAgICAgICAgICAgICAgICpmdW5jdGlvbiA9IE1DSFBfVENfRlVOQ1RJT05f
UVVBRFJBVFVSRTsKPiArICAgICAgICAgICAgICAgKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElP
Tl9RVUFEUkFUVVJFX1g0Owo+ICAgICAgICAgZWxzZQo+IC0gICAgICAgICAgICAgICAqZnVuY3Rp
b24gPSBNQ0hQX1RDX0ZVTkNUSU9OX0lOQ1JFQVNFOwo+ICsgICAgICAgICAgICAgICAqZnVuY3Rp
b24gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOwo+Cj4gICAgICAgICByZXR1cm4gMDsKPiAg
fQo+Cj4gLXN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc2l6ZV90IGZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IG1jaHBfdGNfY291
bnRfZnVuY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gY291
bnRlcl9mdW5jdGlvbiBmdW5jdGlvbikKPiAgewo+ICAgICAgICAgc3RydWN0IG1jaHBfdGNfZGF0
YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gICAgICAgICB1MzIgYm1yLCBjbXI7Cj4g
QEAgLTEwOCw3ICs5Niw3IEBAIHN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9zZXQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAgICAgY21yICY9IH5BVE1FTF9U
Q19XQVZFOwo+Cj4gICAgICAgICBzd2l0Y2ggKGZ1bmN0aW9uKSB7Cj4gLSAgICAgICBjYXNlIE1D
SFBfVENfRlVOQ1RJT05fSU5DUkVBU0U6Cj4gKyAgICAgICBjYXNlIENPVU5URVJfRlVOQ1RJT05f
SU5DUkVBU0U6Cj4gICAgICAgICAgICAgICAgIHByaXYtPnFkZWNfbW9kZSA9IDA7Cj4gICAgICAg
ICAgICAgICAgIC8qIFNldCBoaWdoZXN0IHJhdGUgYmFzZWQgb24gd2hldGhlciBzb2MgaGFzIGdj
bGsgb3Igbm90ICovCj4gICAgICAgICAgICAgICAgIGJtciAmPSB+KEFUTUVMX1RDX1FERU4gfCBB
VE1FTF9UQ19QT1NFTik7Cj4gQEAgLTEyMCw3ICsxMDgsNyBAQCBzdGF0aWMgaW50IG1jaHBfdGNf
Y291bnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgICAg
ICAgICAgICAgICAgY21yIHw9ICBBVE1FTF9UQ19DTVJfTUFTSzsKPiAgICAgICAgICAgICAgICAg
Y21yICY9IH4oQVRNRUxfVENfQUJFVFJHIHwgQVRNRUxfVENfWEMwKTsKPiAgICAgICAgICAgICAg
ICAgYnJlYWs7Cj4gLSAgICAgICBjYXNlIE1DSFBfVENfRlVOQ1RJT05fUVVBRFJBVFVSRToKPiAr
ICAgICAgIGNhc2UgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Ogo+ICAgICAgICAgICAg
ICAgICBpZiAoIXByaXYtPnRjX2NmZy0+aGFzX3FkZWMpCj4gICAgICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIC1FSU5WQUw7Cj4gICAgICAgICAgICAgICAgIC8qIEluIFFERUMgbW9kZSBzZXR0
aW5ncyBib3RoIGNoYW5uZWxzIDAgYW5kIDEgYXJlIHJlcXVpcmVkICovCj4gQEAgLTE3NiwxMCAr
MTY0LDEwIEBAIHN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9zaWduYWxfcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gICAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRp
YyBpbnQgbWNocF90Y19jb3VudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzaXplX3QgKmFjdGlvbikKPiArc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2Fj
dGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNl
ICpzeW5hcHNlLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGNv
dW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+ICAgICAgICAgc3RydWN0IG1jaHBf
dGNfZGF0YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gICAgICAgICB1MzIgY21yOwo+
IEBAIC0xODgsMjYgKzE3NiwyNiBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfYWN0aW9uX2dl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4KPiAgICAgICAgIHN3aXRjaCAoY21y
ICYgQVRNRUxfVENfRVRSR0VERykgewo+ICAgICAgICAgZGVmYXVsdDoKPiAtICAgICAgICAgICAg
ICAgKmFjdGlvbiA9IE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiArICAgICAgICAgICAg
ICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiAgICAgICAgICAgICAg
ICAgYnJlYWs7Cj4gICAgICAgICBjYXNlIEFUTUVMX1RDX0VUUkdFREdfUklTSU5HOgo+IC0gICAg
ICAgICAgICAgICAqYWN0aW9uID0gTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsK
PiArICAgICAgICAgICAgICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5H
X0VER0U7Cj4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgY2FzZSBBVE1FTF9UQ19F
VFJHRURHX0ZBTExJTkc6Cj4gLSAgICAgICAgICAgICAgICphY3Rpb24gPSBNQ0hQX1RDX1NZTkFQ
U0VfQUNUSU9OX0ZBTExJTkdfRURHRTsKPiArICAgICAgICAgICAgICAgKmFjdGlvbiA9IENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOwo+ICAgICAgICAgICAgICAgICBicmVhazsK
PiAgICAgICAgIGNhc2UgQVRNRUxfVENfRVRSR0VER19CT1RIOgo+IC0gICAgICAgICAgICAgICAq
YWN0aW9uID0gTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9CT1RIX0VER0U7Cj4gKyAgICAgICAgICAg
ICAgICphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gICAgICAg
ICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgfQo+Cj4gICAgICAgICByZXR1cm4gMDsKPiAgfQo+
Cj4gLXN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9hY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzaXplX3QgYWN0aW9uKQo+ICtzdGF0aWMgaW50IG1jaHBfdGNf
Y291bnRfYWN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpj
b3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3Vu
dGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uKQo+ICB7Cj4gICAgICAgICBz
dHJ1Y3QgbWNocF90Y19kYXRhICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAg
IHUzMiBlZGdlID0gQVRNRUxfVENfRVRSR0VER19OT05FOwo+IEBAIC0yMTcsMTYgKzIwNSwxNiBA
QCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfYWN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOwo+Cj4gICAgICAg
ICBzd2l0Y2ggKGFjdGlvbikgewo+IC0gICAgICAgY2FzZSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9O
X05PTkU6Cj4gKyAgICAgICBjYXNlIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORToKPiAgICAg
ICAgICAgICAgICAgZWRnZSA9IEFUTUVMX1RDX0VUUkdFREdfTk9ORTsKPiAgICAgICAgICAgICAg
ICAgYnJlYWs7Cj4gLSAgICAgICBjYXNlIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VE
R0U6Cj4gKyAgICAgICBjYXNlIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U6Cj4g
ICAgICAgICAgICAgICAgIGVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX1JJU0lORzsKPiAgICAgICAg
ICAgICAgICAgYnJlYWs7Cj4gLSAgICAgICBjYXNlIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fRkFM
TElOR19FREdFOgo+ICsgICAgICAgY2FzZSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdf
RURHRToKPiAgICAgICAgICAgICAgICAgZWRnZSA9IEFUTUVMX1RDX0VUUkdFREdfRkFMTElORzsK
PiAgICAgICAgICAgICAgICAgYnJlYWs7Cj4gLSAgICAgICBjYXNlIE1DSFBfVENfU1lOQVBTRV9B
Q1RJT05fQk9USF9FREdFOgo+ICsgICAgICAgY2FzZSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVM6Cj4gICAgICAgICAgICAgICAgIGVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX0JPVEg7
Cj4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgZGVmYXVsdDoKPiBAQCAtMjQwLDgg
KzIyOCw3IEBAIHN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9hY3Rpb25fc2V0KHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiAgfQo+Cj4gIHN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdW5zaWduZWQgbG9uZyAqdmFsKQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2YWwpCj4gIHsKPiAg
ICAgICAgIHN0cnVjdCBtY2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+
ICAgICAgICAgdTMyIGNudDsKPiBAQCAtMjY0LDEyICsyNTEsMTIgQEAgc3RhdGljIHN0cnVjdCBj
b3VudGVyX2NvdW50IG1jaHBfdGNfY291bnRzW10gPSB7Cj4gIH07Cj4KPiAgc3RhdGljIGNvbnN0
IHN0cnVjdCBjb3VudGVyX29wcyBtY2hwX3RjX29wcyA9IHsKPiAtICAgICAgIC5zaWduYWxfcmVh
ZCAgPSBtY2hwX3RjX2NvdW50X3NpZ25hbF9yZWFkLAo+IC0gICAgICAgLmNvdW50X3JlYWQgICA9
IG1jaHBfdGNfY291bnRfcmVhZCwKPiAtICAgICAgIC5mdW5jdGlvbl9nZXQgPSBtY2hwX3RjX2Nv
dW50X2Z1bmN0aW9uX2dldCwKPiAtICAgICAgIC5mdW5jdGlvbl9zZXQgPSBtY2hwX3RjX2NvdW50
X2Z1bmN0aW9uX3NldCwKPiAtICAgICAgIC5hY3Rpb25fZ2V0ICAgPSBtY2hwX3RjX2NvdW50X2Fj
dGlvbl9nZXQsCj4gLSAgICAgICAuYWN0aW9uX3NldCAgID0gbWNocF90Y19jb3VudF9hY3Rpb25f
c2V0Cj4gKyAgICAgICAuc2lnbmFsX3JlYWQgICAgPSBtY2hwX3RjX2NvdW50X3NpZ25hbF9yZWFk
LAo+ICsgICAgICAgLmNvdW50X3JlYWQgICAgID0gbWNocF90Y19jb3VudF9yZWFkLAo+ICsgICAg
ICAgLmZ1bmN0aW9uX3JlYWQgID0gbWNocF90Y19jb3VudF9mdW5jdGlvbl9yZWFkLAo+ICsgICAg
ICAgLmZ1bmN0aW9uX3dyaXRlID0gbWNocF90Y19jb3VudF9mdW5jdGlvbl93cml0ZSwKPiArICAg
ICAgIC5hY3Rpb25fcmVhZCAgICA9IG1jaHBfdGNfY291bnRfYWN0aW9uX3JlYWQsCj4gKyAgICAg
ICAuYWN0aW9uX3dyaXRlICAgPSBtY2hwX3RjX2NvdW50X2FjdGlvbl93cml0ZQo+ICB9Owo+Cj4g
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgYXRtZWxfdGNiX2NvbmZpZyB0Y2Jfcm05MjAwX2NvbmZpZyA9
IHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmMgYi9k
cml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYwo+IGluZGV4IDEzNjU2OTU3YzQ1Zi4u
YWVmNzhhNDIxN2I1IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvY291bnRlci9zdG0zMi1scHRpbWVy
LWNudC5jCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmMKPiBAQCAt
MTcsNiArMTcsNyBAQAo+ICAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Cj4gICNpbmNsdWRlIDxs
aW51eC9waW5jdHJsL2NvbnN1bWVyLmg+Cj4gICNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZp
Y2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4KPiAgc3RydWN0IHN0bTMyX2xwdGlt
X2NudCB7Cj4gICAgICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgY291bnRlcjsKPiBAQCAtMTMw
LDMyICsxMzEsNDYgQEAgc3RhdGljIGludCBzdG0zMl9scHRpbV9zZXR1cChzdHJ1Y3Qgc3RtMzJf
bHB0aW1fY250ICpwcml2LCBpbnQgZW5hYmxlKQo+ICAgKiArLS0tLS0tLS0tKy0tLS0tLS0tLS0r
LS0tLS0tLS0tLSstLS0tLS0tLS0rLS0tLS0tLS0tLSstLS0tLS0tLS0rCj4gICAqLwo+ICBlbnVt
IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbiB7Cj4gLSAgICAgICBTVE0zMl9MUFRJTV9DT1VOVEVS
X0lOQ1JFQVNFLAo+IC0gICAgICAgU1RNMzJfTFBUSU1fRU5DT0RFUl9CT1RIX0VER0UsCj4gKyAg
ICAgICBTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNFID0gQ09VTlRFUl9GVU5DVElPTl9JTkNS
RUFTRSwKPiArICAgICAgIFNUTTMyX0xQVElNX0VOQ09ERVJfQk9USF9FREdFID0gQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1g0LAo+ICB9Owo+Cj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50
ZXJfZnVuY3Rpb24gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uc1tdID0gewo+IC0gICAgICAgW1NU
TTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0VdID0gQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSwK
PiAtICAgICAgIFtTVE0zMl9MUFRJTV9FTkNPREVSX0JPVEhfRURHRV0gPSBDT1VOVEVSX0ZVTkNU
SU9OX1FVQURSQVRVUkVfWDQsCj4gKyAgICAgICBTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNF
LAo+ICsgICAgICAgU1RNMzJfTFBUSU1fRU5DT0RFUl9CT1RIX0VER0UsCj4gIH07Cj4KPiAgZW51
bSBzdG0zMl9scHRpbV9zeW5hcHNlX2FjdGlvbiB7Cj4gKyAgICAgICAvKiBJbmRleCBtdXN0IG1h
dGNoIHdpdGggc3RtMzJfbHB0aW1fY250X3BvbGFyaXR5W10gKHByaXYtPnBvbGFyaXR5KSAqLwo+
ICAgICAgICAgU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gICAgICAg
ICBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gICAgICAgICBTVE0z
Ml9MUFRJTV9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+ICAgICAgICAgU1RNMzJfTFBUSU1f
U1lOQVBTRV9BQ1RJT05fTk9ORSwKPiAgfTsKPgo+IC1zdGF0aWMgY29uc3QgZW51bSBjb3VudGVy
X3N5bmFwc2VfYWN0aW9uIHN0bTMyX2xwdGltX2NudF9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAt
ICAgICAgIC8qIEluZGV4IG11c3QgbWF0Y2ggd2l0aCBzdG0zMl9scHRpbV9jbnRfcG9sYXJpdHlb
XSAocHJpdi0+cG9sYXJpdHkpICovCj4gK3N0YXRpYyBjb25zdCBlbnVtIHN0bTMyX2xwdGltX3N5
bmFwc2VfYWN0aW9uIHN0bTMyX2xwdGltX2MybF9hY3Rpb25zX21hcFtdID0gewo+ICsgICAgICAg
W0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0VdID0gU1RNMzJfTFBUSU1fU1lOQVBT
RV9BQ1RJT05fUklTSU5HX0VER0UsCj4gKyAgICAgICBbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9G
QUxMSU5HX0VER0VdID0gU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+
ICsgICAgICAgW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFU10gPSBTVE0zMl9MUFRJ
TV9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+ICsgICAgICAgW0NPVU5URVJfU1lOQVBTRV9B
Q1RJT05fTk9ORV0gPSBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9OT05FLAo+ICt9Owo+ICsK
PiArc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9scHRpbV9s
MmNfYWN0aW9uc19tYXBbXSA9IHsKPiAgICAgICAgIFtTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElP
Tl9SSVNJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ICAg
ICAgICAgW1NUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRV0gPSBDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiAgICAgICAgIFtTVE0zMl9MUFRJTV9TWU5B
UFNFX0FDVElPTl9CT1RIX0VER0VTXSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdF
UywKPiAgICAgICAgIFtTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9OT05FXSA9IENPVU5URVJf
U1lOQVBTRV9BQ1RJT05fTk9ORSwKPiAgfTsKPgo+ICtzdGF0aWMgY29uc3QgZW51bSBjb3VudGVy
X3N5bmFwc2VfYWN0aW9uIHN0bTMyX2xwdGltX2NudF9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAr
ICAgICAgIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gKyAgICAgICBDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiArICAgICAgIENPVU5URVJfU1lOQVBT
RV9BQ1RJT05fQk9USF9FREdFUywKPiArICAgICAgIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9O
RSwKPiArfTsKPiArCj4gIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nICp2YWwpCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2
NCAqdmFsKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIHUzMiBjbnQ7Cj4gQEAgLTE3MCw5ICsxODUsOSBA
QCBzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAgICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIGludCBzdG0zMl9s
cHRpbV9jbnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXpl
X3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAq
ZnVuY3Rpb24pCj4gIHsKPiAgICAgICAgIHN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+Cj4gQEAgLTE4OSw5ICsyMDQsOSBAQCBzdGF0aWMgaW50IHN0
bTMyX2xwdGltX2NudF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gIH0KPgo+IC1zdGF0aWMgaW50IHN0bTMyX2xw
dGltX2NudF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVf
dCBmdW5jdGlvbikKPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fd3JpdGUo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24g
ZnVuY3Rpb24pCj4gIHsKPiAgICAgICAgIHN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+Cj4gQEAgLTIxMiw5ICsyMjcsOSBAQCBzdGF0aWMgaW50IHN0
bTMyX2xwdGltX2NudF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICAgICAgICAgfQo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3Qgc3RtMzJfbHB0aW1fY250X2Vu
YWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpwcml2
YXRlLCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2VuYWJsZV9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTggKmVuYWJsZSkKPiAgewo+ICAgICAgICAg
c3RydWN0IHN0bTMyX2xwdGltX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gICAg
ICAgICBpbnQgcmV0Owo+IEBAIC0yMjMsMjIgKzIzOCwxOCBAQCBzdGF0aWMgc3NpemVfdCBzdG0z
Ml9scHRpbV9jbnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICAgICAgICAgaWYgKHJldCA8IDApCj4gICAgICAgICAgICAgICAgIHJldHVybiByZXQ7Cj4KPiAt
ICAgICAgIHJldHVybiBzY25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgcmV0KTsKPiAr
ICAgICAgICplbmFibGUgPSByZXQ7Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1z
dGF0aWMgc3NpemVfdCBzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXZhdGUsCj4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4p
Cj4gK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgdTggZW5hYmxlKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgc3RtMzJf
bHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAtICAgICAgIGJvb2wgZW5h
YmxlOwo+ICAgICAgICAgaW50IHJldDsKPgo+IC0gICAgICAgcmV0ID0ga3N0cnRvYm9vbChidWYs
ICZlbmFibGUpOwo+IC0gICAgICAgaWYgKHJldCkKPiAtICAgICAgICAgICAgICAgcmV0dXJuIHJl
dDsKPiAtCj4gICAgICAgICAvKiBDaGVjayBub2JvZHkgdXNlcyB0aGUgdGltZXIsIG9yIGFscmVh
ZHkgZGlzYWJsZWQvZW5hYmxlZCAqLwo+ICAgICAgICAgcmV0ID0gc3RtMzJfbHB0aW1faXNfZW5h
YmxlZChwcml2KTsKPiAgICAgICAgIGlmICgocmV0IDwgMCkgfHwgKCFyZXQgJiYgIWVuYWJsZSkp
Cj4gQEAgLTI1NCw2NSArMjY1LDU0IEBAIHN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9l
bmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAgICAgaWYg
KHJldCkKPiAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPgo+IC0gICAgICAgcmV0dXJuIGxl
bjsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3Qgc3RtMzJfbHB0
aW1fY250X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250
X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTY0ICpjZWlsaW5n
KQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291
bnRlci0+cHJpdjsKPgo+IC0gICAgICAgcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAi
JXVcbiIsIHByaXYtPmNlaWxpbmcpOwo+ICsgICAgICAgKmNlaWxpbmcgPSBwcml2LT5jZWlsaW5n
Owo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3Qgc3RtMzJf
bHB0aW1fY250X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB2b2lkICpwcml2YXRlLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGljIGludCBz
dG0zMl9scHRpbV9jbnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB1NjQgY2VpbGluZykKPiAgewo+ICAgICAgICAgc3RydWN0IHN0bTMyX2xwdGltX2NudCAq
Y29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gLSAgICAgICB1bnNpZ25lZCBpbnQgY2VpbGlu
ZzsKPiAtICAgICAgIGludCByZXQ7Cj4KPiAgICAgICAgIGlmIChzdG0zMl9scHRpbV9pc19lbmFi
bGVkKHByaXYpKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gLUVCVVNZOwo+Cj4gLSAgICAgICBy
ZXQgPSBrc3RydG91aW50KGJ1ZiwgMCwgJmNlaWxpbmcpOwo+IC0gICAgICAgaWYgKHJldCkKPiAt
ICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiAtCj4gICAgICAgICBpZiAoY2VpbGluZyA+IFNU
TTMyX0xQVElNX01BWF9BUlIpCj4gICAgICAgICAgICAgICAgIHJldHVybiAtRVJBTkdFOwo+Cj4g
ICAgICAgICBwcml2LT5jZWlsaW5nID0gY2VpbGluZzsKPgo+IC0gICAgICAgcmV0dXJuIGxlbjsK
PiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVy
X2NvdW50X2V4dCBzdG0zMl9scHRpbV9jbnRfZXh0W10gPSB7Cj4gLSAgICAgICB7Cj4gLSAgICAg
ICAgICAgICAgIC5uYW1lID0gImVuYWJsZSIsCj4gLSAgICAgICAgICAgICAgIC5yZWFkID0gc3Rt
MzJfbHB0aW1fY250X2VuYWJsZV9yZWFkLAo+IC0gICAgICAgICAgICAgICAud3JpdGUgPSBzdG0z
Ml9scHRpbV9jbnRfZW5hYmxlX3dyaXRlCj4gLSAgICAgICB9LAo+IC0gICAgICAgewo+IC0gICAg
ICAgICAgICAgICAubmFtZSA9ICJjZWlsaW5nIiwKPiAtICAgICAgICAgICAgICAgLnJlYWQgPSBz
dG0zMl9scHRpbV9jbnRfY2VpbGluZ19yZWFkLAo+IC0gICAgICAgICAgICAgICAud3JpdGUgPSBz
dG0zMl9scHRpbV9jbnRfY2VpbGluZ193cml0ZQo+IC0gICAgICAgfSwKPiArc3RhdGljIHN0cnVj
dCBjb3VudGVyX2NvbXAgc3RtMzJfbHB0aW1fY250X2V4dFtdID0gewo+ICsgICAgICAgQ09VTlRF
Ul9DT01QX0VOQUJMRShzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3JlYWQsCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUpLAo+ICsgICAgICAg
Q09VTlRFUl9DT01QX0NFSUxJTkcoc3RtMzJfbHB0aW1fY250X2NlaWxpbmdfcmVhZCwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3dyaXRlKSwK
PiAgfTsKPgo+IC1zdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgKmFjdGlvbikKPiArc3Rh
dGljIGludCBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0
aW9uKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0g
Y291bnRlci0+cHJpdjsKPiAtICAgICAgIHNpemVfdCBmdW5jdGlvbjsKPiArICAgICAgIGVudW0g
Y291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiAgICAgICAgIGludCBlcnI7Cj4KPiAtICAgICAg
IGVyciA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9nZXQoY291bnRlciwgY291bnQsICZmdW5j
dGlvbik7Cj4gKyAgICAgICBlcnIgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fcmVhZChjb3Vu
dGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiAgICAgICAgIGlmIChlcnIpCj4gICAgICAgICAgICAg
ICAgIHJldHVybiBlcnI7Cj4KPiBAQCAtMzIwLDEyICszMjAsMTIgQEAgc3RhdGljIGludCBzdG0z
Ml9scHRpbV9jbnRfYWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
ICAgICAgICBjYXNlIFNUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0U6Cj4gICAgICAgICAgICAg
ICAgIC8qIExQIFRpbWVyIGFjdHMgYXMgdXAtY291bnRlciBvbiBpbnB1dCAxICovCj4gICAgICAg
ICAgICAgICAgIGlmIChzeW5hcHNlLT5zaWduYWwtPmlkID09IGNvdW50LT5zeW5hcHNlc1swXS5z
aWduYWwtPmlkKQo+IC0gICAgICAgICAgICAgICAgICAgICAgICphY3Rpb24gPSBwcml2LT5wb2xh
cml0eTsKPiArICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gc3RtMzJfbHB0aW1fbDJj
X2FjdGlvbnNfbWFwW3ByaXYtPnBvbGFyaXR5XTsKPiAgICAgICAgICAgICAgICAgZWxzZQo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICphY3Rpb24gPSBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElP
Tl9OT05FOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICphY3Rpb24gPSBDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX05PTkU7Cj4gICAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICAgICAgICAgY2Fz
ZSBTVE0zMl9MUFRJTV9FTkNPREVSX0JPVEhfRURHRToKPiAtICAgICAgICAgICAgICAgKmFjdGlv
biA9IHByaXYtPnBvbGFyaXR5Owo+ICsgICAgICAgICAgICAgICAqYWN0aW9uID0gc3RtMzJfbHB0
aW1fbDJjX2FjdGlvbnNfbWFwW3ByaXYtPnBvbGFyaXR5XTsKPiAgICAgICAgICAgICAgICAgcmV0
dXJuIDA7Cj4gICAgICAgICBkZWZhdWx0Ogo+ICAgICAgICAgICAgICAgICAvKiBzaG91bGQgbmV2
ZXIgcmVhY2ggdGhpcyBwYXRoICovCj4gQEAgLTMzMyw0MyArMzMzLDM5IEBAIHN0YXRpYyBpbnQg
c3RtMzJfbHB0aW1fY250X2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICAgICAgICAgfQo+ICB9Cj4KPiAtc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfYWN0aW9u
X3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpz
eW5hcHNlLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IGFj
dGlvbikKPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX3dyaXRlKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGNvdW50ZXJfc3lu
YXBzZV9hY3Rpb24gYWN0aW9uKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250
ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAtICAgICAgIHNpemVfdCBmdW5jdGlvbjsK
PiArICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiAgICAgICAgIGludCBl
cnI7Cj4KPiAgICAgICAgIGlmIChzdG0zMl9scHRpbV9pc19lbmFibGVkKHByaXYpKQo+ICAgICAg
ICAgICAgICAgICByZXR1cm4gLUVCVVNZOwo+Cj4gLSAgICAgICBlcnIgPSBzdG0zMl9scHRpbV9j
bnRfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICsgICAgICAgZXJy
ID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3JlYWQoY291bnRlciwgY291bnQsICZmdW5jdGlv
bik7Cj4gICAgICAgICBpZiAoZXJyKQo+ICAgICAgICAgICAgICAgICByZXR1cm4gZXJyOwo+Cj4g
ICAgICAgICAvKiBvbmx5IHNldCBwb2xhcml0eSB3aGVuIGluIGNvdW50ZXIgbW9kZSAob24gaW5w
dXQgMSkgKi8KPiAtICAgICAgIGlmIChmdW5jdGlvbiA9PSBTVE0zMl9MUFRJTV9DT1VOVEVSX0lO
Q1JFQVNFCj4gLSAgICAgICAgICAgJiYgc3luYXBzZS0+c2lnbmFsLT5pZCA9PSBjb3VudC0+c3lu
YXBzZXNbMF0uc2lnbmFsLT5pZCkgewo+IC0gICAgICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikg
ewo+IC0gICAgICAgICAgICAgICBjYXNlIFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX1JJU0lO
R19FREdFOgo+IC0gICAgICAgICAgICAgICBjYXNlIFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9O
X0ZBTExJTkdfRURHRToKPiAtICAgICAgICAgICAgICAgY2FzZSBTVE0zMl9MUFRJTV9TWU5BUFNF
X0FDVElPTl9CT1RIX0VER0VTOgo+IC0gICAgICAgICAgICAgICAgICAgICAgIHByaXYtPnBvbGFy
aXR5ID0gYWN0aW9uOwo+IC0gICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOwo+IC0gICAg
ICAgICAgICAgICB9Cj4gLSAgICAgICB9Cj4gKyAgICAgICBpZiAoKGVudW0gc3RtMzJfbHB0aW1f
Y250X2Z1bmN0aW9uKWZ1bmN0aW9uICE9IFNUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0UKPiAr
ICAgICAgICAgICB8fCBzeW5hcHNlLT5zaWduYWwtPmlkICE9IGNvdW50LT5zeW5hcHNlc1swXS5z
aWduYWwtPmlkCj4gKyAgICAgICAgICAgfHwgYWN0aW9uID09IENPVU5URVJfU1lOQVBTRV9BQ1RJ
T05fTk9ORSkKPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4KPiAtICAgICAgIHJl
dHVybiAtRUlOVkFMOwo+ICsgICAgICAgcHJpdi0+cG9sYXJpdHkgPSBzdG0zMl9scHRpbV9jMmxf
YWN0aW9uc19tYXBbYWN0aW9uXTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gIHN0
YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgc3RtMzJfbHB0aW1fY250X29wcyA9IHsKPiAg
ICAgICAgIC5jb3VudF9yZWFkID0gc3RtMzJfbHB0aW1fY250X3JlYWQsCj4gLSAgICAgICAuZnVu
Y3Rpb25fZ2V0ID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX2dldCwKPiAtICAgICAgIC5mdW5j
dGlvbl9zZXQgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0LAo+IC0gICAgICAgLmFjdGlv
bl9nZXQgPSBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX2dldCwKPiAtICAgICAgIC5hY3Rpb25fc2V0
ID0gc3RtMzJfbHB0aW1fY250X2FjdGlvbl9zZXQsCj4gKyAgICAgICAuZnVuY3Rpb25fcmVhZCA9
IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFkLAo+ICsgICAgICAgLmZ1bmN0aW9uX3dyaXRl
ID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3dyaXRlLAo+ICsgICAgICAgLmFjdGlvbl9yZWFk
ID0gc3RtMzJfbHB0aW1fY250X2FjdGlvbl9yZWFkLAo+ICsgICAgICAgLmFjdGlvbl93cml0ZSA9
IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fd3JpdGUsCj4gIH07Cj4KPiAgc3RhdGljIHN0cnVjdCBj
b3VudGVyX3NpZ25hbCBzdG0zMl9scHRpbV9jbnRfc2lnbmFsc1tdID0gewo+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL2NvdW50ZXIvc3RtMzItdGltZXItY250LmMgYi9kcml2ZXJzL2NvdW50ZXIvc3Rt
MzItdGltZXItY250LmMKPiBpbmRleCAzZmIwZGViZDc0MjUuLmM2OTBiNzZlNWRhYiAxMDA2NDQK
PiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvc3RtMzItdGltZXItY250LmMKPiArKysgYi9kcml2ZXJz
L2NvdW50ZXIvc3RtMzItdGltZXItY250LmMKPiBAQCAtMTMsNiArMTMsNyBAQAo+ICAjaW5jbHVk
ZSA8bGludXgvbW9kdWxlLmg+Cj4gICNpbmNsdWRlIDxsaW51eC9waW5jdHJsL2NvbnN1bWVyLmg+
Cj4gICNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4
L3R5cGVzLmg+Cj4KPiAgI2RlZmluZSBUSU1fQ0NNUl9DQ1hTICAoQklUKDgpIHwgQklUKDApKQo+
ICAjZGVmaW5lIFRJTV9DQ01SX01BU0sgIChUSU1fQ0NNUl9DQzFTIHwgVElNX0NDTVJfQ0MyUyB8
IFwKPiBAQCAtNDQsMjEgKzQ1LDIxIEBAIHN0cnVjdCBzdG0zMl90aW1lcl9jbnQgewo+ICAgKiBA
U1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzM6IGNvdW50cyBvbiBib3RoIFRJMUZQMSBhbmQgVEky
RlAyIGVkZ2VzCj4gICAqLwo+ICBlbnVtIHN0bTMyX2NvdW50X2Z1bmN0aW9uIHsKPiArICAgICAg
IFNUTTMyX0NPVU5UX1NMQVZFX01PREVfRElTQUJMRUQgPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JF
QVNFLAo+ICsgICAgICAgU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzEgPSBDT1VOVEVSX0ZVTkNU
SU9OX1FVQURSQVRVUkVfWDJfQSwKPiArICAgICAgIFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8y
ID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0IsCj4gKyAgICAgICBTVE0zMl9DT1VO
VF9FTkNPREVSX01PREVfMyA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiArfTsK
PiArCj4gK3N0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gc3RtMzJfY291bnRfZnVu
Y3Rpb25zW10gPSB7Cj4gICAgICAgICBTVE0zMl9DT1VOVF9TTEFWRV9NT0RFX0RJU0FCTEVELAo+
ICAgICAgICAgU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzEsCj4gICAgICAgICBTVE0zMl9DT1VO
VF9FTkNPREVSX01PREVfMiwKPiAgICAgICAgIFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zLAo+
ICB9Owo+Cj4gLXN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gc3RtMzJfY291bnRf
ZnVuY3Rpb25zW10gPSB7Cj4gLSAgICAgICBbU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxF
RF0gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0gICAgICAgW1NUTTMyX0NPVU5UX0VO
Q09ERVJfTU9ERV8xXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BLAo+IC0gICAg
ICAgW1NUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJB
VFVSRV9YMl9CLAo+IC0gICAgICAgW1NUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zXSA9IENPVU5U
RVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiAtfTsKPiAtCj4gIHN0YXRpYyBpbnQgc3RtMzJf
Y291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9u
ZyAqdmFsKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsIHU2NCAqdmFsKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgc3RtMzJfdGltZXJfY250
ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIHUzMiBjbnQ7Cj4gQEAgLTcw
LDggKzcxLDcgQEAgc3RhdGljIGludCBzdG0zMl9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiAgfQo+Cj4gIHN0YXRpYyBpbnQgc3RtMzJfY291bnRfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgY29uc3QgdW5zaWduZWQgbG9uZyB2YWwpCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIGNvbnN0IHU2NCB2YWwpCj4gIHsKPiAg
ICAgICAgIHN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2
Owo+ICAgICAgICAgdTMyIGNlaWxpbmc7Cj4gQEAgLTgzLDkgKzgzLDkgQEAgc3RhdGljIGludCBz
dG0zMl9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gICAgICAg
ICByZXR1cm4gcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcCwgVElNX0NOVCwgdmFsKTsKPiAgfQo+
Cj4gLXN0YXRpYyBpbnQgc3RtMzJfY291bnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc2l6ZV90ICpmdW5jdGlvbikKPiArc3RhdGljIGludCBzdG0zMl9jb3VudF9mdW5jdGlv
bl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1
bmN0aW9uKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIHUzMiBzbWNyOwo+IEBAIC0xMTAsOSArMTEwLDkg
QEAgc3RhdGljIGludCBzdG0zMl9jb3VudF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ICAgICAgICAgfQo+ICB9Cj4KPiAtc3RhdGljIGludCBzdG0zMl9jb3Vu
dF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgZnVuY3Rpb24pCj4g
K3N0YXRpYyBpbnQgc3RtMzJfY291bnRfZnVuY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uKQo+ICB7Cj4gICAgICAgICBz
dHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgICAg
ICAgIHUzMiBjcjEsIHNtczsKPiBAQCAtMTUwLDQ0ICsxNTAsMzcgQEAgc3RhdGljIGludCBzdG0z
Ml9jb3VudF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAg
ICAgICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9kaXJl
Y3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gK3N0YXRpYyBpbnQg
c3RtMzJfY291bnRfZGlyZWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9p
ZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlvbiAqZGlyZWN0aW9uKQo+ICB7Cj4gICAg
ICAgICBzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsK
PiAtICAgICAgIGNvbnN0IGNoYXIgKmRpcmVjdGlvbjsKPiAgICAgICAgIHUzMiBjcjE7Cj4KPiAg
ICAgICAgIHJlZ21hcF9yZWFkKHByaXYtPnJlZ21hcCwgVElNX0NSMSwgJmNyMSk7Cj4gLSAgICAg
ICBkaXJlY3Rpb24gPSAoY3IxICYgVElNX0NSMV9ESVIpID8gImJhY2t3YXJkIiA6ICJmb3J3YXJk
IjsKPiArICAgICAgICpkaXJlY3Rpb24gPSAoY3IxICYgVElNX0NSMV9ESVIpID8gQ09VTlRFUl9D
T1VOVF9ESVJFQ1RJT05fQkFDS1dBUkQgOgo+ICsgICAgICAgICAgICAgICBDT1VOVEVSX0NPVU5U
X0RJUkVDVElPTl9GT1JXQVJEOwo+Cj4gLSAgICAgICByZXR1cm4gc2NucHJpbnRmKGJ1ZiwgUEFH
RV9TSVpFLCAiJXNcbiIsIGRpcmVjdGlvbik7Cj4gKyAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4g
LXN0YXRpYyBzc2l6ZV90IHN0bTMyX2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHN0
bTMyX2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB1NjQgKmNlaWxpbmcpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBzdG0zMl90aW1lcl9j
bnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgdTMyIGFycjsKPgo+ICAg
ICAgICAgcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fQVJSLCAmYXJyKTsKPgo+IC0gICAg
ICAgcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIGFycik7Cj4gKyAgICAg
ICAqY2VpbGluZyA9IGFycjsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRp
YyBzc2l6ZV90IHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdm9pZCAqcHJpdmF0ZSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGljIGludCBz
dG0zMl9jb3VudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LCB1NjQgY2VpbGluZykKPiAgewo+ICAgICAgICAgc3RydWN0IHN0bTMyX3RpbWVy
X2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gLSAgICAgICB1bnNpZ25lZCBpbnQg
Y2VpbGluZzsKPiAtICAgICAgIGludCByZXQ7Cj4gLQo+IC0gICAgICAgcmV0ID0ga3N0cnRvdWlu
dChidWYsIDAsICZjZWlsaW5nKTsKPiAtICAgICAgIGlmIChyZXQpCj4gLSAgICAgICAgICAgICAg
IHJldHVybiByZXQ7Cj4KPiAgICAgICAgIGlmIChjZWlsaW5nID4gcHJpdi0+bWF4X2FycikKPiAg
ICAgICAgICAgICAgICAgcmV0dXJuIC1FUkFOR0U7Cj4gQEAgLTE5NiwzNCArMTg5LDI3IEBAIHN0
YXRpYyBzc2l6ZV90IHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ICAgICAgICAgcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwg
VElNX0NSMSwgVElNX0NSMV9BUlBFLCAwKTsKPiAgICAgICAgIHJlZ21hcF93cml0ZShwcml2LT5y
ZWdtYXAsIFRJTV9BUlIsIGNlaWxpbmcpOwo+Cj4gLSAgICAgICByZXR1cm4gbGVuOwo+ICsgICAg
ICAgcmV0dXJuIDA7Cj4gIH0KPgo+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9lbmFibGVf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1
ZikKPiArc3RhdGljIGludCBzdG0zMl9jb3VudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4ICplbmFibGUpCj4gIHsKPiAgICAgICAgIHN0cnVj
dCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAg
dTMyIGNyMTsKPgo+ICAgICAgICAgcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fQ1IxLCAm
Y3IxKTsKPgo+IC0gICAgICAgcmV0dXJuIHNjbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiVkXG4i
LCAoYm9vbCkoY3IxICYgVElNX0NSMV9DRU4pKTsKPiArICAgICAgICplbmFibGUgPSBjcjEgJiBU
SU1fQ1IxX0NFTjsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRpYyBzc2l6
ZV90IHN0bTMyX2NvdW50X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgdm9pZCAqcHJpdmF0ZSwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHN0bTMyX2NvdW50
X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1
OCBlbmFibGUpCj4gIHsKPiAgICAgICAgIHN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+IC0gICAgICAgaW50IGVycjsKPiAgICAgICAgIHUzMiBjcjE7
Cj4gLSAgICAgICBib29sIGVuYWJsZTsKPiAtCj4gLSAgICAgICBlcnIgPSBrc3RydG9ib29sKGJ1
ZiwgJmVuYWJsZSk7Cj4gLSAgICAgICBpZiAoZXJyKQo+IC0gICAgICAgICAgICAgICByZXR1cm4g
ZXJyOwo+Cj4gICAgICAgICBpZiAoZW5hYmxlKSB7Cj4gICAgICAgICAgICAgICAgIHJlZ21hcF9y
ZWFkKHByaXYtPnJlZ21hcCwgVElNX0NSMSwgJmNyMSk7Cj4gQEAgLTI0Miw3MCArMjI4LDU1IEBA
IHN0YXRpYyBzc2l6ZV90IHN0bTMyX2NvdW50X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gICAgICAgICAvKiBLZWVwIGVuYWJsZWQgc3RhdGUgdG8gcHJvcGVy
bHkgaGFuZGxlIGxvdyBwb3dlciBzdGF0ZXMgKi8KPiAgICAgICAgIHByaXYtPmVuYWJsZWQgPSBl
bmFibGU7Cj4KPiAtICAgICAgIHJldHVybiBsZW47Cj4gKyAgICAgICByZXR1cm4gMDsKPiAgfQo+
Cj4gLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgc3RtMzJfY291bnRfZXh0
W10gPSB7Cj4gLSAgICAgICB7Cj4gLSAgICAgICAgICAgICAgIC5uYW1lID0gImRpcmVjdGlvbiIs
Cj4gLSAgICAgICAgICAgICAgIC5yZWFkID0gc3RtMzJfY291bnRfZGlyZWN0aW9uX3JlYWQsCj4g
LSAgICAgICB9LAo+IC0gICAgICAgewo+IC0gICAgICAgICAgICAgICAubmFtZSA9ICJlbmFibGUi
LAo+IC0gICAgICAgICAgICAgICAucmVhZCA9IHN0bTMyX2NvdW50X2VuYWJsZV9yZWFkLAo+IC0g
ICAgICAgICAgICAgICAud3JpdGUgPSBzdG0zMl9jb3VudF9lbmFibGVfd3JpdGUKPiAtICAgICAg
IH0sCj4gLSAgICAgICB7Cj4gLSAgICAgICAgICAgICAgIC5uYW1lID0gImNlaWxpbmciLAo+IC0g
ICAgICAgICAgICAgICAucmVhZCA9IHN0bTMyX2NvdW50X2NlaWxpbmdfcmVhZCwKPiAtICAgICAg
ICAgICAgICAgLndyaXRlID0gc3RtMzJfY291bnRfY2VpbGluZ193cml0ZQo+IC0gICAgICAgfSwK
PiAtfTsKPiAtCj4gLWVudW0gc3RtMzJfc3luYXBzZV9hY3Rpb24gewo+IC0gICAgICAgU1RNMzJf
U1lOQVBTRV9BQ1RJT05fTk9ORSwKPiAtICAgICAgIFNUTTMyX1NZTkFQU0VfQUNUSU9OX0JPVEhf
RURHRVMKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgc3RtMzJfY291bnRfZXh0W10gPSB7
Cj4gKyAgICAgICBDT1VOVEVSX0NPTVBfRElSRUNUSU9OKHN0bTMyX2NvdW50X2RpcmVjdGlvbl9y
ZWFkKSwKPiArICAgICAgIENPVU5URVJfQ09NUF9FTkFCTEUoc3RtMzJfY291bnRfZW5hYmxlX3Jl
YWQsIHN0bTMyX2NvdW50X2VuYWJsZV93cml0ZSksCj4gKyAgICAgICBDT1VOVEVSX0NPTVBfQ0VJ
TElORyhzdG0zMl9jb3VudF9jZWlsaW5nX3JlYWQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdG0zMl9jb3VudF9jZWlsaW5nX3dyaXRlKSwKPiAgfTsKPgo+ICBzdGF0aWMgY29uc3Qg
ZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIHN0bTMyX3N5bmFwc2VfYWN0aW9uc1tdID0gewo+
IC0gICAgICAgW1NUTTMyX1NZTkFQU0VfQUNUSU9OX05PTkVdID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9OT05FLAo+IC0gICAgICAgW1NUTTMyX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVNdID0g
Q09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gKyAgICAgICBDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX05PTkUsCj4gKyAgICAgICBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVMKPiAgfTsKPgo+IC1zdGF0aWMgaW50IHN0bTMyX2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBj
b3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgIHNp
emVfdCAqYWN0aW9uKQo+ICtzdGF0aWMgaW50IHN0bTMyX2FjdGlvbl9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+IC0gICAgICAg
c2l6ZV90IGZ1bmN0aW9uOwo+ICsgICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9u
Owo+ICAgICAgICAgaW50IGVycjsKPgo+IC0gICAgICAgZXJyID0gc3RtMzJfY291bnRfZnVuY3Rp
b25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICsgICAgICAgZXJyID0gc3RtMzJf
Y291bnRfZnVuY3Rpb25fcmVhZChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiAgICAgICAg
IGlmIChlcnIpCj4gICAgICAgICAgICAgICAgIHJldHVybiBlcnI7Cj4KPiAgICAgICAgIHN3aXRj
aCAoZnVuY3Rpb24pIHsKPiAgICAgICAgIGNhc2UgU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNB
QkxFRDoKPiAgICAgICAgICAgICAgICAgLyogY291bnRzIG9uIGludGVybmFsIGNsb2NrIHdoZW4g
Q0VOPTEgKi8KPiAtICAgICAgICAgICAgICAgKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9O
X05PTkU7Cj4gKyAgICAgICAgICAgICAgICphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X05PTkU7Cj4gICAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICAgICAgICAgY2FzZSBTVE0zMl9D
T1VOVF9FTkNPREVSX01PREVfMToKPiAgICAgICAgICAgICAgICAgLyogY291bnRzIHVwL2Rvd24g
b24gVEkxRlAxIGVkZ2UgZGVwZW5kaW5nIG9uIFRJMkZQMiBsZXZlbCAqLwo+ICAgICAgICAgICAg
ICAgICBpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9PSBjb3VudC0+c3luYXBzZXNbMF0uc2lnbmFs
LT5pZCkKPiAtICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gU1RNMzJfU1lOQVBTRV9B
Q1RJT05fQk9USF9FREdFUzsKPiArICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gQ09V
TlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICAgICAgICAgICAgICAgICBlbHNlCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX05P
TkU7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9B
Q1RJT05fTk9ORTsKPiAgICAgICAgICAgICAgICAgcmV0dXJuIDA7Cj4gICAgICAgICBjYXNlIFNU
TTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yOgo+ICAgICAgICAgICAgICAgICAvKiBjb3VudHMgdXAv
ZG93biBvbiBUSTJGUDIgZWRnZSBkZXBlbmRpbmcgb24gVEkxRlAxIGxldmVsICovCj4gICAgICAg
ICAgICAgICAgIGlmIChzeW5hcHNlLT5zaWduYWwtPmlkID09IGNvdW50LT5zeW5hcHNlc1sxXS5z
aWduYWwtPmlkKQo+IC0gICAgICAgICAgICAgICAgICAgICAgICphY3Rpb24gPSBTVE0zMl9TWU5B
UFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICphY3Rpb24g
PSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gICAgICAgICAgICAgICAgIGVs
c2UKPiAtICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gU1RNMzJfU1lOQVBTRV9BQ1RJ
T05fTk9ORTsKPiArICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gQ09VTlRFUl9TWU5B
UFNFX0FDVElPTl9OT05FOwo+ICAgICAgICAgICAgICAgICByZXR1cm4gMDsKPiAgICAgICAgIGNh
c2UgU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzM6Cj4gICAgICAgICAgICAgICAgIC8qIGNvdW50
cyB1cC9kb3duIG9uIGJvdGggVEkxRlAxIGFuZCBUSTJGUDIgZWRnZXMgKi8KPiAtICAgICAgICAg
ICAgICAgKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gKyAgICAg
ICAgICAgICAgICphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4g
ICAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICAgICAgICAgZGVmYXVsdDoKPiAgICAgICAgICAg
ICAgICAgcmV0dXJuIC1FSU5WQUw7Cj4gQEAgLTMxNSw5ICsyODYsOSBAQCBzdGF0aWMgaW50IHN0
bTMyX2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICBzdGF0aWMg
Y29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIHN0bTMyX3RpbWVyX2NudF9vcHMgPSB7Cj4gICAgICAg
ICAuY291bnRfcmVhZCA9IHN0bTMyX2NvdW50X3JlYWQsCj4gICAgICAgICAuY291bnRfd3JpdGUg
PSBzdG0zMl9jb3VudF93cml0ZSwKPiAtICAgICAgIC5mdW5jdGlvbl9nZXQgPSBzdG0zMl9jb3Vu
dF9mdW5jdGlvbl9nZXQsCj4gLSAgICAgICAuZnVuY3Rpb25fc2V0ID0gc3RtMzJfY291bnRfZnVu
Y3Rpb25fc2V0LAo+IC0gICAgICAgLmFjdGlvbl9nZXQgPSBzdG0zMl9hY3Rpb25fZ2V0LAo+ICsg
ICAgICAgLmZ1bmN0aW9uX3JlYWQgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkLAo+ICsgICAg
ICAgLmZ1bmN0aW9uX3dyaXRlID0gc3RtMzJfY291bnRfZnVuY3Rpb25fd3JpdGUsCj4gKyAgICAg
ICAuYWN0aW9uX3JlYWQgPSBzdG0zMl9hY3Rpb25fcmVhZCwKPiAgfTsKPgo+ICBzdGF0aWMgc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsIHN0bTMyX3NpZ25hbHNbXSA9IHsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9jb3VudGVyL3RpLWVxZXAuYyBiL2RyaXZlcnMvY291bnRlci90aS1lcWVwLmMKPiBpbmRl
eCA5NGZlNThiYjNlYWIuLjA5ODE3Yzk1M2Y5YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50
ZXIvdGktZXFlcC5jCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL3RpLWVxZXAuYwo+IEBAIC0xMyw2
ICsxMyw3IEBACj4gICNpbmNsdWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KPiAgI2luY2x1
ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgo+ICsj
aW5jbHVkZSA8bGludXgvdHlwZXMuaD4KPgo+ICAvKiAzMi1iaXQgcmVnaXN0ZXJzICovCj4gICNk
ZWZpbmUgUVBPU0NOVCAgICAgICAgICAgICAgICAweDAKPiBAQCAtNzMsMTkgKzc0LDEzIEBAIGVu
dW0gewo+ICB9Owo+Cj4gIC8qIFBvc2l0aW9uIENvdW50ZXIgSW5wdXQgTW9kZXMgKi8KPiAtZW51
bSB7Cj4gK2VudW0gdGlfZXFlcF9jb3VudF9mdW5jIHsKPiAgICAgICAgIFRJX0VRRVBfQ09VTlRf
RlVOQ19RVUFEX0NPVU5ULAo+ICAgICAgICAgVElfRVFFUF9DT1VOVF9GVU5DX0RJUl9DT1VOVCwK
PiAgICAgICAgIFRJX0VRRVBfQ09VTlRfRlVOQ19VUF9DT1VOVCwKPiAgICAgICAgIFRJX0VRRVBf
Q09VTlRfRlVOQ19ET1dOX0NPVU5ULAo+ICB9Owo+Cj4gLWVudW0gewo+IC0gICAgICAgVElfRVFF
UF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+IC0gICAgICAgVElfRVFFUF9TWU5BUFNFX0FD
VElPTl9SSVNJTkdfRURHRSwKPiAtICAgICAgIFRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fTk9ORSwK
PiAtfTsKPiAtCj4gIHN0cnVjdCB0aV9lcWVwX2NudCB7Cj4gICAgICAgICBzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgY291bnRlcjsKPiAgICAgICAgIHN0cnVjdCByZWdtYXAgKnJlZ21hcDMyOwo+IEBA
IC05Myw3ICs4OCw3IEBAIHN0cnVjdCB0aV9lcWVwX2NudCB7Cj4gIH07Cj4KPiAgc3RhdGljIGlu
dCB0aV9lcWVwX2NvdW50X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwg
dW5zaWduZWQgbG9uZyAqdmFsKQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2YWwpCj4gIHsKPiAgICAgICAgIHN0cnVjdCB0
aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gICAgICAgICB1MzIgY250Owo+IEBA
IC0xMDUsNyArMTAwLDcgQEAgc3RhdGljIGludCB0aV9lcWVwX2NvdW50X3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4KPiAgc3RhdGljIGludCB0aV9lcWVwX2NvdW50
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25n
IHZhbCkKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LCB1NjQgdmFsKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgdGlfZXFlcF9jbnQgKnBy
aXYgPSBjb3VudGVyLT5wcml2Owo+ICAgICAgICAgdTMyIG1heDsKPiBAQCAtMTE3LDY0ICsxMTIs
MTAwIEBAIHN0YXRpYyBpbnQgdGlfZXFlcF9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gICAgICAgICByZXR1cm4gcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcDMy
LCBRUE9TQ05ULCB2YWwpOwo+ICB9Cj4KPiAtc3RhdGljIGludCB0aV9lcWVwX2Z1bmN0aW9uX2dl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCAqZnVuY3Rpb24p
Cj4gK3N0YXRpYyBpbnQgdGlfZXFlcF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51
bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKPiAgewo+ICAgICAgICAgc3RydWN0IHRpX2Vx
ZXBfY250ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiAgICAgICAgIHUzMiBxZGVjY3RsOwo+Cj4g
ICAgICAgICByZWdtYXBfcmVhZChwcml2LT5yZWdtYXAxNiwgUURFQ0NUTCwgJnFkZWNjdGwpOwo+
IC0gICAgICAgKmZ1bmN0aW9uID0gKHFkZWNjdGwgJiBRREVDQ1RMX1FTUkMpID4+IFFERUNDVExf
UVNSQ19TSElGVDsKPiArCj4gKyAgICAgICBzd2l0Y2ggKChxZGVjY3RsICYgUURFQ0NUTF9RU1JD
KSA+PiBRREVDQ1RMX1FTUkNfU0hJRlQpIHsKPiArICAgICAgIGNhc2UgVElfRVFFUF9DT1VOVF9G
VU5DX1FVQURfQ09VTlQ6Cj4gKyAgICAgICAgICAgICAgICpmdW5jdGlvbiA9IENPVU5URVJfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YNDsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBj
YXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19ESVJfQ09VTlQ6Cj4gKyAgICAgICAgICAgICAgICpmdW5j
dGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOwo+ICsgICAgICAgICAgICAg
ICBicmVhazsKPiArICAgICAgIGNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX1VQX0NPVU5UOgo+ICsg
ICAgICAgICAgICAgICAqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOwo+ICsg
ICAgICAgICAgICAgICBicmVhazsKPiArICAgICAgIGNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX0RP
V05fQ09VTlQ6Cj4gKyAgICAgICAgICAgICAgICpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05f
REVDUkVBU0U7Cj4gKyAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgfQo+Cj4gICAgICAg
ICByZXR1cm4gMDsKPiAgfQo+Cj4gLXN0YXRpYyBpbnQgdGlfZXFlcF9mdW5jdGlvbl9zZXQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgZnVuY3Rpb24pCj4gK3N0
YXRpYyBpbnQgdGlfZXFlcF9mdW5jdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBj
b3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uKQo+ICB7Cj4gICAgICAgICBzdHJ1Y3QgdGlfZXFlcF9j
bnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+ICsgICAgICAgZW51bSB0aV9lcWVwX2NvdW50X2Z1
bmMgcXNyYzsKPiArCj4gKyAgICAgICBzd2l0Y2ggKGZ1bmN0aW9uKSB7Cj4gKyAgICAgICBjYXNl
IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiArICAgICAgICAgICAgICAgcXNyYyA9
IFRJX0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UOwo+ICsgICAgICAgICAgICAgICBicmVhazsK
PiArICAgICAgIGNhc2UgQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT046Cj4gKyAgICAg
ICAgICAgICAgIHFzcmMgPSBUSV9FUUVQX0NPVU5UX0ZVTkNfRElSX0NPVU5UOwo+ICsgICAgICAg
ICAgICAgICBicmVhazsKPiArICAgICAgIGNhc2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToK
PiArICAgICAgICAgICAgICAgcXNyYyA9IFRJX0VRRVBfQ09VTlRfRlVOQ19VUF9DT1VOVDsKPiAr
ICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBjYXNlIENPVU5URVJfRlVOQ1RJT05fREVD
UkVBU0U6Cj4gKyAgICAgICAgICAgICAgIHFzcmMgPSBUSV9FUUVQX0NPVU5UX0ZVTkNfRE9XTl9D
T1VOVDsKPiArICAgICAgICAgICAgICAgYnJlYWs7Cj4gKyAgICAgICBkZWZhdWx0Ogo+ICsgICAg
ICAgICAgICAgICAvKiBzaG91bGQgbmV2ZXIgcmVhY2ggdGhpcyBwYXRoICovCj4gKyAgICAgICAg
ICAgICAgIHJldHVybiAtRUlOVkFMOwo+ICsgICAgICAgfQo+Cj4gICAgICAgICByZXR1cm4gcmVn
bWFwX3dyaXRlX2JpdHMocHJpdi0+cmVnbWFwMTYsIFFERUNDVEwsIFFERUNDVExfUVNSQywKPiAt
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiA8PCBRREVDQ1RMX1FTUkNf
U0hJRlQpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHFzcmMgPDwgUURFQ0NU
TF9RU1JDX1NISUZUKTsKPiAgfQo+Cj4gLXN0YXRpYyBpbnQgdGlfZXFlcF9hY3Rpb25fZ2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwgc2l6ZV90ICphY3Rpb24p
Cj4gK3N0YXRpYyBpbnQgdGlfZXFlcF9hY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IGNv
dW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb24pCj4gIHsKPiAgICAgICAgIHN0cnVj
dCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gLSAgICAgICBzaXplX3QgZnVu
Y3Rpb247Cj4gKyAgICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb247Cj4gICAgICAg
ICB1MzIgcWRlY2N0bDsKPiAgICAgICAgIGludCBlcnI7Cj4KPiAtICAgICAgIGVyciA9IHRpX2Vx
ZXBfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICsgICAgICAgZXJy
ID0gdGlfZXFlcF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICAg
ICAgICAgaWYgKGVycikKPiAgICAgICAgICAgICAgICAgcmV0dXJuIGVycjsKPgo+ICAgICAgICAg
c3dpdGNoIChmdW5jdGlvbikgewo+IC0gICAgICAgY2FzZSBUSV9FUUVQX0NPVU5UX0ZVTkNfUVVB
RF9DT1VOVDoKPiArICAgICAgIGNhc2UgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Ogo+
ICAgICAgICAgICAgICAgICAvKiBJbiBxdWFkcmF0dXJlIG1vZGUsIHRoZSByaXNpbmcgYW5kIGZh
bGxpbmcgZWRnZSBvZiBib3RoCj4gICAgICAgICAgICAgICAgICAqIFFFUEEgYW5kIFFFUEIgdHJp
Z2dlciBRQ0xLLgo+ICAgICAgICAgICAgICAgICAgKi8KPiAtICAgICAgICAgICAgICAgKmFjdGlv
biA9IFRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiArICAgICAgICAgICAgICAg
KmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiAgICAgICAgICAg
ICAgICAgcmV0dXJuIDA7Cj4gLSAgICAgICBjYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19ESVJfQ09V
TlQ6Cj4gKyAgICAgICBjYXNlIENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOgo+ICAg
ICAgICAgICAgICAgICAvKiBJbiBkaXJlY3Rpb24tY291bnQgbW9kZSBvbmx5IHJpc2luZyBlZGdl
IG9mIFFFUEEgaXMgY291bnRlZAo+ICAgICAgICAgICAgICAgICAgKiBhbmQgUUVQQiBnaXZlcyBk
aXJlY3Rpb24uCj4gICAgICAgICAgICAgICAgICAqLwo+ICAgICAgICAgICAgICAgICBzd2l0Y2gg
KHN5bmFwc2UtPnNpZ25hbC0+aWQpIHsKPiAgICAgICAgICAgICAgICAgY2FzZSBUSV9FUUVQX1NJ
R05BTF9RRVBBOgo+IC0gICAgICAgICAgICAgICAgICAgICAgICphY3Rpb24gPSBUSV9FUUVQX1NZ
TkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ICsgICAgICAgICAgICAgICAgICAgICAgICphY3Rp
b24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ICAgICAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiAwOwo+ICAgICAgICAgICAgICAgICBjYXNlIFRJX0VRRVBfU0lHTkFM
X1FFUEI6Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgKmFjdGlvbiA9IFRJX0VRRVBfU1lOQVBT
RV9BQ1RJT05fTk9ORTsKPiArICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gQ09VTlRF
Ul9TWU5BUFNFX0FDVElPTl9OT05FOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAw
Owo+ICAgICAgICAgICAgICAgICBkZWZhdWx0Ogo+ICAgICAgICAgICAgICAgICAgICAgICAgIC8q
IHNob3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGggKi8KPiAgICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVJTlZBTDsKPiAgICAgICAgICAgICAgICAgfQo+IC0gICAgICAgY2FzZSBUSV9F
UUVQX0NPVU5UX0ZVTkNfVVBfQ09VTlQ6Cj4gLSAgICAgICBjYXNlIFRJX0VRRVBfQ09VTlRfRlVO
Q19ET1dOX0NPVU5UOgo+ICsgICAgICAgY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOgo+
ICsgICAgICAgY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFOgo+ICAgICAgICAgICAgICAg
ICAvKiBJbiB1cC9kb3duLWNvdW50IG1vZGVzIG9ubHkgUUVQQSBpcyBjb3VudGVkIGFuZCBRRVBC
IGlzIG5vdAo+ICAgICAgICAgICAgICAgICAgKiB1c2VkLgo+ICAgICAgICAgICAgICAgICAgKi8K
PiBAQCAtMTg1LDEyICsyMTYsMTIgQEAgc3RhdGljIGludCB0aV9lcWVwX2FjdGlvbl9nZXQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgcmV0dXJuIGVycjsKPgo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChxZGVjY3Rs
ICYgUURFQ0NUTF9YQ1IpCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9u
ID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdF
UzsKPiAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCj4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAqYWN0aW9uID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICphY3Rpb24gPSBDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAw
Owo+ICAgICAgICAgICAgICAgICBjYXNlIFRJX0VRRVBfU0lHTkFMX1FFUEI6Cj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgKmFjdGlvbiA9IFRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiAr
ICAgICAgICAgICAgICAgICAgICAgICAqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9O
T05FOwo+ICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOwo+ICAgICAgICAgICAgICAg
ICBkZWZhdWx0Ogo+ICAgICAgICAgICAgICAgICAgICAgICAgIC8qIHNob3VsZCBuZXZlciByZWFj
aCB0aGlzIHBhdGggKi8KPiBAQCAtMjA1LDgyICsyMzYsNjcgQEAgc3RhdGljIGludCB0aV9lcWVw
X2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICBzdGF0aWMgY29u
c3Qgc3RydWN0IGNvdW50ZXJfb3BzIHRpX2VxZXBfY291bnRlcl9vcHMgPSB7Cj4gICAgICAgICAu
Y291bnRfcmVhZCAgICAgPSB0aV9lcWVwX2NvdW50X3JlYWQsCj4gICAgICAgICAuY291bnRfd3Jp
dGUgICAgPSB0aV9lcWVwX2NvdW50X3dyaXRlLAo+IC0gICAgICAgLmZ1bmN0aW9uX2dldCAgID0g
dGlfZXFlcF9mdW5jdGlvbl9nZXQsCj4gLSAgICAgICAuZnVuY3Rpb25fc2V0ICAgPSB0aV9lcWVw
X2Z1bmN0aW9uX3NldCwKPiAtICAgICAgIC5hY3Rpb25fZ2V0ICAgICA9IHRpX2VxZXBfYWN0aW9u
X2dldCwKPiArICAgICAgIC5mdW5jdGlvbl9yZWFkICA9IHRpX2VxZXBfZnVuY3Rpb25fcmVhZCwK
PiArICAgICAgIC5mdW5jdGlvbl93cml0ZSA9IHRpX2VxZXBfZnVuY3Rpb25fd3JpdGUsCj4gKyAg
ICAgICAuYWN0aW9uX3JlYWQgICAgPSB0aV9lcWVwX2FjdGlvbl9yZWFkLAo+ICB9Owo+Cj4gLXN0
YXRpYyBzc2l6ZV90IHRpX2VxZXBfcG9zaXRpb25fY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdm9pZCAqZXh0X3ByaXYsIGNoYXIgKmJ1ZikKPiAr
c3RhdGljIGludCB0aV9lcWVwX3Bvc2l0aW9uX2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB1NjQgKmNlaWxpbmcpCj4gIHsKPiAgICAgICAgIHN0cnVjdCB0aV9l
cWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gICAgICAgICB1MzIgcXBvc21heDsKPgo+
ICAgICAgICAgcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwMzIsIFFQT1NNQVgsICZxcG9zbWF4KTsK
Pgo+IC0gICAgICAgcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIHFwb3NtYXgpOwo+ICsgICAg
ICAgKmNlaWxpbmcgPSBxcG9zbWF4Owo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICB9Cj4KPiAt
c3RhdGljIHNzaXplX3QgdGlfZXFlcF9wb3NpdGlvbl9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpleHRfcHJpdiwgY29uc3QgY2hh
ciAqYnVmLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
aXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHRpX2VxZXBfcG9zaXRpb25fY2VpbGluZ193cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU2NCBjZWlsaW5nKQo+ICB7Cj4gICAg
ICAgICBzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+IC0gICAgICAg
aW50IGVycjsKPiAtICAgICAgIHUzMiByZXM7Cj4KPiAtICAgICAgIGVyciA9IGtzdHJ0b3VpbnQo
YnVmLCAwLCAmcmVzKTsKPiAtICAgICAgIGlmIChlcnIgPCAwKQo+IC0gICAgICAgICAgICAgICBy
ZXR1cm4gZXJyOwo+ICsgICAgICAgaWYgKGNlaWxpbmcgIT0gKHUzMiljZWlsaW5nKQo+ICsgICAg
ICAgICAgICAgICByZXR1cm4gLUVSQU5HRTsKPgo+IC0gICAgICAgcmVnbWFwX3dyaXRlKHByaXYt
PnJlZ21hcDMyLCBRUE9TTUFYLCByZXMpOwo+ICsgICAgICAgcmVnbWFwX3dyaXRlKHByaXYtPnJl
Z21hcDMyLCBRUE9TTUFYLCBjZWlsaW5nKTsKPgo+IC0gICAgICAgcmV0dXJuIGxlbjsKPiArICAg
ICAgIHJldHVybiAwOwo+ICB9Cj4KPiAtc3RhdGljIHNzaXplX3QgdGlfZXFlcF9wb3NpdGlvbl9l
bmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLSAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpl
eHRfcHJpdiwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHRpX2VxZXBfcG9zaXRpb25fZW5hYmxl
X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4ICpl
bmFibGUpCj4gIHsKPiAgICAgICAgIHN0cnVjdCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXIt
PnByaXY7Cj4gICAgICAgICB1MzIgcWVwY3RsOwo+Cj4gICAgICAgICByZWdtYXBfcmVhZChwcml2
LT5yZWdtYXAxNiwgUUVQQ1RMLCAmcWVwY3RsKTsKPgo+IC0gICAgICAgcmV0dXJuIHNwcmludGYo
YnVmLCAiJXVcbiIsICEhKHFlcGN0bCAmIFFFUENUTF9QSEVOKSk7Cj4gKyAgICAgICAqZW5hYmxl
ID0gISEocWVwY3RsICYgUUVQQ1RMX1BIRU4pOwo+ICsKPiArICAgICAgIHJldHVybiAwOwo+ICB9
Cj4KPiAtc3RhdGljIHNzaXplX3QgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfd3JpdGUoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkICpleHRfcHJpdiwgY29uc3Qg
Y2hhciAqYnVmLAo+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfd3JpdGUo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCBlbmFibGUp
Cj4gIHsKPiAgICAgICAgIHN0cnVjdCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7
Cj4gLSAgICAgICBpbnQgZXJyOwo+IC0gICAgICAgYm9vbCByZXM7Cj4gLQo+IC0gICAgICAgZXJy
ID0ga3N0cnRvYm9vbChidWYsICZyZXMpOwo+IC0gICAgICAgaWYgKGVyciA8IDApCj4gLSAgICAg
ICAgICAgICAgIHJldHVybiBlcnI7Cj4KPiAtICAgICAgIHJlZ21hcF93cml0ZV9iaXRzKHByaXYt
PnJlZ21hcDE2LCBRRVBDVEwsIFFFUENUTF9QSEVOLCByZXMgPyAtMSA6IDApOwo+ICsgICAgICAg
cmVnbWFwX3dyaXRlX2JpdHMocHJpdi0+cmVnbWFwMTYsIFFFUENUTCwgUUVQQ1RMX1BIRU4sIGVu
YWJsZSA/IC0xIDogMCk7Cj4KPiAtICAgICAgIHJldHVybiBsZW47Cj4gKyAgICAgICByZXR1cm4g
MDsKPiAgfQo+Cj4gLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgdGlfZXFlcF9wb3Np
dGlvbl9leHRbXSA9IHsKPiAtICAgICAgIHsKPiAtICAgICAgICAgICAgICAgLm5hbWUgICA9ICJj
ZWlsaW5nIiwKPiAtICAgICAgICAgICAgICAgLnJlYWQgICA9IHRpX2VxZXBfcG9zaXRpb25fY2Vp
bGluZ19yZWFkLAo+IC0gICAgICAgICAgICAgICAud3JpdGUgID0gdGlfZXFlcF9wb3NpdGlvbl9j
ZWlsaW5nX3dyaXRlLAo+IC0gICAgICAgfSwKPiAtICAgICAgIHsKPiAtICAgICAgICAgICAgICAg
Lm5hbWUgICA9ICJlbmFibGUiLAo+IC0gICAgICAgICAgICAgICAucmVhZCAgID0gdGlfZXFlcF9w
b3NpdGlvbl9lbmFibGVfcmVhZCwKPiAtICAgICAgICAgICAgICAgLndyaXRlICA9IHRpX2VxZXBf
cG9zaXRpb25fZW5hYmxlX3dyaXRlLAo+IC0gICAgICAgfSwKPiArc3RhdGljIHN0cnVjdCBjb3Vu
dGVyX2NvbXAgdGlfZXFlcF9wb3NpdGlvbl9leHRbXSA9IHsKPiArICAgICAgIENPVU5URVJfQ09N
UF9DRUlMSU5HKHRpX2VxZXBfcG9zaXRpb25fY2VpbGluZ19yZWFkLAo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdGlfZXFlcF9wb3NpdGlvbl9jZWlsaW5nX3dyaXRlKSwKPiArICAgICAg
IENPVU5URVJfQ09NUF9FTkFCTEUodGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfcmVhZCwKPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfd3JpdGUpLAo+
ICB9Owo+Cj4gIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWwgdGlfZXFlcF9zaWduYWxzW10g
PSB7Cj4gQEAgLTI5NSwxNiArMzExLDE2IEBAIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWwg
dGlfZXFlcF9zaWduYWxzW10gPSB7Cj4gIH07Cj4KPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRl
cl9mdW5jdGlvbiB0aV9lcWVwX3Bvc2l0aW9uX2Z1bmN0aW9uc1tdID0gewo+IC0gICAgICAgW1RJ
X0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVS
RV9YNCwKPiAtICAgICAgIFtUSV9FUUVQX0NPVU5UX0ZVTkNfRElSX0NPVU5UXSAgPSBDT1VOVEVS
X0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTiwKPiAtICAgICAgIFtUSV9FUUVQX0NPVU5UX0ZVTkNf
VVBfQ09VTlRdICAgPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0gICAgICAgW1RJX0VR
RVBfQ09VTlRfRlVOQ19ET1dOX0NPVU5UXSA9IENPVU5URVJfRlVOQ1RJT05fREVDUkVBU0UsCj4g
KyAgICAgICBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gKyAgICAgICBDT1VOVEVS
X0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTiwKPiArICAgICAgIENPVU5URVJfRlVOQ1RJT05fSU5D
UkVBU0UsCj4gKyAgICAgICBDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFLAo+ICB9Owo+Cj4gIHN0
YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gdGlfZXFlcF9wb3NpdGlvbl9z
eW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAtICAgICAgIFtUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVNdICAgICA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiAtICAg
ICAgIFtUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSAgICA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gLSAgICAgICBbVElfRVFFUF9TWU5BUFNFX0FDVElP
Tl9OT05FXSAgICAgICAgICAgPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gKyAgICAg
ICBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCj4gKyAgICAgICBDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ICsgICAgICAgQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9OT05FLAo+ICB9Owo+Cj4gIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlIHRpX2VxZXBf
cG9zaXRpb25fc3luYXBzZXNbXSA9IHsKPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9jb3Vu
dGVyLmggYi9pbmNsdWRlL2xpbnV4L2NvdW50ZXIuaAo+IGluZGV4IGQxNmNlMjgxOWI0OC4uYjY5
Mjc3ZjVjNGM1IDEwMDY0NAo+IC0tLSBhL2luY2x1ZGUvbGludXgvY291bnRlci5oCj4gKysrIGIv
aW5jbHVkZS9saW51eC9jb3VudGVyLmgKPiBAQCAtNiw0MiArNiwxODQgQEAKPiAgI2lmbmRlZiBf
Q09VTlRFUl9IXwo+ICAjZGVmaW5lIF9DT1VOVEVSX0hfCj4KPiAtI2luY2x1ZGUgPGxpbnV4L2Nv
dW50ZXJfZW51bS5oPgo+ICAjaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+Cj4gKyNpbmNsdWRlIDxs
aW51eC9rZXJuZWwuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4KPiArc3RydWN0IGNv
dW50ZXJfZGV2aWNlOwo+ICtzdHJ1Y3QgY291bnRlcl9jb3VudDsKPiArc3RydWN0IGNvdW50ZXJf
c3luYXBzZTsKPiArc3RydWN0IGNvdW50ZXJfc2lnbmFsOwo+ICsKPiArZW51bSBjb3VudGVyX2Nv
bXBfdHlwZSB7Cj4gKyAgICAgICBDT1VOVEVSX0NPTVBfVTgsCj4gKyAgICAgICBDT1VOVEVSX0NP
TVBfVTY0LAo+ICsgICAgICAgQ09VTlRFUl9DT01QX0JPT0wsCj4gKyAgICAgICBDT1VOVEVSX0NP
TVBfU0lHTkFMX0xFVkVMLAo+ICsgICAgICAgQ09VTlRFUl9DT01QX0ZVTkNUSU9OLAo+ICsgICAg
ICAgQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OLAo+ICsgICAgICAgQ09VTlRFUl9DT01QX0VO
VU0sCj4gKyAgICAgICBDT1VOVEVSX0NPTVBfQ09VTlRfRElSRUNUSU9OLAo+ICsgICAgICAgQ09V
TlRFUl9DT01QX0NPVU5UX01PREUsCj4gK307Cj4gKwo+ICtlbnVtIGNvdW50ZXJfc2NvcGUgewo+
ICsgICAgICAgQ09VTlRFUl9TQ09QRV9ERVZJQ0UsCj4gKyAgICAgICBDT1VOVEVSX1NDT1BFX1NJ
R05BTCwKPiArICAgICAgIENPVU5URVJfU0NPUEVfQ09VTlQsCj4gK307Cj4gKwo+ICBlbnVtIGNv
dW50ZXJfY291bnRfZGlyZWN0aW9uIHsKPiAtICAgICAgIENPVU5URVJfQ09VTlRfRElSRUNUSU9O
X0ZPUldBUkQgPSAwLAo+IC0gICAgICAgQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fQkFDS1dBUkQK
PiArICAgICAgIENPVU5URVJfQ09VTlRfRElSRUNUSU9OX0ZPUldBUkQsCj4gKyAgICAgICBDT1VO
VEVSX0NPVU5UX0RJUkVDVElPTl9CQUNLV0FSRCwKPiAgfTsKPiAtZXh0ZXJuIGNvbnN0IGNoYXIg
KmNvbnN0IGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0clsyXTsKPgo+ICBlbnVtIGNvdW50ZXJf
Y291bnRfbW9kZSB7Cj4gLSAgICAgICBDT1VOVEVSX0NPVU5UX01PREVfTk9STUFMID0gMCwKPiAr
ICAgICAgIENPVU5URVJfQ09VTlRfTU9ERV9OT1JNQUwsCj4gICAgICAgICBDT1VOVEVSX0NPVU5U
X01PREVfUkFOR0VfTElNSVQsCj4gICAgICAgICBDT1VOVEVSX0NPVU5UX01PREVfTk9OX1JFQ1lD
TEUsCj4gLSAgICAgICBDT1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX04KPiArICAgICAgIENPVU5U
RVJfQ09VTlRfTU9ERV9NT0RVTE9fTiwKPiAgfTsKPiAtZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbnN0
IGNvdW50ZXJfY291bnRfbW9kZV9zdHJbNF07Cj4KPiAtc3RydWN0IGNvdW50ZXJfZGV2aWNlOwo+
IC1zdHJ1Y3QgY291bnRlcl9zaWduYWw7Cj4gK2VudW0gY291bnRlcl9mdW5jdGlvbiB7Cj4gKyAg
ICAgICBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+ICsgICAgICAgQ09VTlRFUl9GVU5DVElP
Tl9ERUNSRUFTRSwKPiArICAgICAgIENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OLAo+
ICsgICAgICAgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0EsCj4gKyAgICAgICBDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQiwKPiArICAgICAgIENPVU5URVJfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YMl9BLAo+ICsgICAgICAgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gy
X0IsCj4gKyAgICAgICBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gK307Cj4gKwo+
ICtlbnVtIGNvdW50ZXJfc2lnbmFsX2xldmVsIHsKPiArICAgICAgIENPVU5URVJfU0lHTkFMX0xF
VkVMX0xPVywKPiArICAgICAgIENPVU5URVJfU0lHTkFMX0xFVkVMX0hJR0gsCj4gK307Cj4gKwo+
ICtlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gewo+ICsgICAgICAgQ09VTlRFUl9TWU5BUFNF
X0FDVElPTl9OT05FLAo+ICsgICAgICAgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURH
RSwKPiArICAgICAgIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+ICsgICAg
ICAgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+ICt9Owo+Cj4gIC8qKgo+IC0g
KiBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0IC0gQ291bnRlciBTaWduYWwgZXh0ZW5zaW9ucwo+
IC0gKiBAbmFtZTogICAgICBhdHRyaWJ1dGUgbmFtZQo+IC0gKiBAcmVhZDogICAgICByZWFkIGNh
bGxiYWNrIGZvciB0aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiAtICogQHdyaXRlOiAgICAg
d3JpdGUgY2FsbGJhY2sgZm9yIHRoaXMgYXR0cmlidXRlOyBtYXkgYmUgTlVMTAo+IC0gKiBAcHJp
djogICAgICBkYXRhIHByaXZhdGUgdG8gdGhlIGRyaXZlcgo+ICsgKiBzdHJ1Y3QgY291bnRlcl9j
b21wIC0gQ291bnRlciBjb21wb25lbnQgbm9kZQo+ICsgKiBAdHlwZTogICAgICAgICAgICAgIENv
dW50ZXIgY29tcG9uZW50IGRhdGEgdHlwZQo+ICsgKiBAbmFtZTogICAgICAgICAgICAgIGRldmlj
ZS1zcGVjaWZpYyBjb21wb25lbnQgbmFtZQo+ICsgKiBAcHJpdjogICAgICAgICAgICAgIGNvbXBv
bmVudC1yZWxldmFudCBkYXRhCj4gKyAqIEBhY3Rpb25fcmVhZCAgICAgICAgICAgICAgICBTeW5h
cHNlIGFjdGlvbiBtb2RlIHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mIHRoZQo+ICsg
KiAgICAgICAgICAgICAgICAgICAgIHJlc3BlY3RpdmUgU3luYXBzZSBhY3Rpb24gbW9kZSBzaG91
bGQgYmUgcGFzc2VkIGJhY2sgdmlhCj4gKyAqICAgICAgICAgICAgICAgICAgICAgdGhlIGFjdGlv
biBwYXJhbWV0ZXIuCj4gKyAqIEBkZXZpY2VfdThfcmVhZCAgICAgRGV2aWNlIHU4IGNvbXBvbmVu
dCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiArICogICAgICAgICAgICAg
ICAgICAgICByZXNwZWN0aXZlIERldmljZSB1OCBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZCBi
YWNrIHZpYQo+ICsgKiAgICAgICAgICAgICAgICAgICAgIHRoZSB2YWwgcGFyYW1ldGVyLgo+ICsg
KiBAY291bnRfdThfcmVhZCAgICAgIENvdW50IHU4IGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBU
aGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiArICogICAgICAgICAgICAgICAgICAgICByZXNwZWN0aXZl
IENvdW50IHU4IGNvbXBvbmVudCBzaG91bGQgYmUgcGFzc2VkIGJhY2sgdmlhCj4gKyAqICAgICAg
ICAgICAgICAgICAgICAgdGhlIHZhbCBwYXJhbWV0ZXIuCj4gKyAqIEBzaWduYWxfdThfcmVhZCAg
ICAgU2lnbmFsIHU4IGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0
aGUKPiArICogICAgICAgICAgICAgICAgICAgICByZXNwZWN0aXZlIFNpZ25hbCB1OCBjb21wb25l
bnQgc2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+ICsgKiAgICAgICAgICAgICAgICAgICAgIHRo
ZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAZGV2aWNlX3UzMl9yZWFkICAgIERldmljZSB1MzIgY29t
cG9uZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mCj4gKyAqICAgICAgICAgICAg
ICAgICAgICAgdGhlIHJlc3BlY3RpdmUgRGUKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KTGludXgtc3RtMzIgbWFpbGluZyBsaXN0CkxpbnV4LXN0bTMyQHN0
LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5jb20KaHR0cHM6Ly9zdC1tZC1tYWlsbWFuLnN0b3JtcmVw
bHkuY29tL21haWxtYW4vbGlzdGluZm8vbGludXgtc3RtMzIK
