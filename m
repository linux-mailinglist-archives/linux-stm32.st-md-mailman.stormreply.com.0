Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 3F78C6FA38F
	for <lists+linux-stm32@lfdr.de>; Mon,  8 May 2023 11:45:39 +0200 (CEST)
Received: from ip-172-31-3-47.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id B639AC6904E;
	Mon,  8 May 2023 09:45:38 +0000 (UTC)
Received: from mail-wm1-f45.google.com (mail-wm1-f45.google.com
 [209.85.128.45])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 63999C65E60
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Mon,  8 May 2023 09:45:37 +0000 (UTC)
Received: by mail-wm1-f45.google.com with SMTP id
 5b1f17b1804b1-3f415a90215so23707465e9.0
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Mon, 08 May 2023 02:45:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=linaro.org; s=google; t=1683539137; x=1686131137;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:from:to:cc:subject:date
 :message-id:reply-to;
 bh=4+OAgNHl5oz88x1GqYSlEP3JWEynLbUvUrM5snQi4Yo=;
 b=wFj7oN08nzloqG5CVDv8ToZH1C/sVD6sa3Sge7deKdqtGvlZ6TEuQVa0x0laOmYNxM
 WKWv8Zf4uJASoVw+w2cUe7pShEWYwbwFwTpAcqFGSqQNlXfzhy2/EcYJ2j6H69MxAUQX
 GrQ2wvE1B+3RBcZsOgSov/OgdE5kcm7cTJ4tKNhTioVcTsX00UhEDRd3d+SebZWLyiar
 uCSb9s+fvkJMXoEc++H1DZgEkoN7xiINFWNAM0GKyTLcK7vYxQim07rMHIz78k0Qpnwm
 zAcf/DtfpTfw4VOZOaXJ2Fi5IaCFAavylWOR1kLrntFCawPYD/G1uTedbFYRh0HGBBif
 QOvA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20221208; t=1683539137; x=1686131137;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=4+OAgNHl5oz88x1GqYSlEP3JWEynLbUvUrM5snQi4Yo=;
 b=MFLGxdStZnFVNsLmBP5UrgVLSSTIK9EJM2Ar/ddmwslqOVG+TE/ilvs44e3db2RoGm
 zH+Zp7lvua7F6jZgnOR2HA71QV/4XXhvrg/dtnhtX8bhFLAVinSg7Mrv9+qqlxyxb28B
 YSw+qzau1sJRHcfTuUOgsiLy0iXdoNyrqrWONZzsNVJj75XCrX0Ytx66Jc4WUDbquKeL
 DBGDqpqH+1ubOyFYBeC++MZ7oeReVoJo8RqvBdROBXn66cLIVNKIrd0bGOfTxPiUpthJ
 iY26bqCe5GUEiWtq9JsyEhM2sVh+w1rUdMLqvXnzu8AjyXIikBbC9vrwTw0TtmHIMAcz
 9fUg==
X-Gm-Message-State: AC+VfDxDXEkbhZSyVtAa799jn/MWoAHk9QH3kgfrMG8D5ZRhfumLTn2u
 QcZxaI8noytzeRQW7IFrF8ls+Q3FKWIRwAXM52E+BQ==
X-Google-Smtp-Source: ACHHUZ48df8ewHUJLzgbND6S8LJeBmdyANV2pnd8PQyZZywRGZy2oHy3QEOlbuQ2XZHE3e3sWwA4iYyRhJPgNhWt3aI=
X-Received: by 2002:a7b:c7c3:0:b0:3f3:195b:d18c with SMTP id
 z3-20020a7bc7c3000000b003f3195bd18cmr6014273wmk.30.1683539136555; Mon, 08 May
 2023 02:45:36 -0700 (PDT)
MIME-Version: 1.0
References: <20230222053825.992-1-masahisa.kojima@linaro.org>
 <20230222053825.992-4-masahisa.kojima@linaro.org>
In-Reply-To: <20230222053825.992-4-masahisa.kojima@linaro.org>
From: Jens Wiklander <jens.wiklander@linaro.org>
Date: Mon, 8 May 2023 11:45:25 +0200
Message-ID: <CAHUa44G_=BDd4AfsaqwYCSSCWLC89iBWmRGkzh6Pa3iOtOCTpQ@mail.gmail.com>
To: Masahisa Kojima <masahisa.kojima@linaro.org>
Cc: Sumit Garg <sumit.garg@linaro.org>, linux-efi@vger.kernel.org,
 Ilias Apalodimas <ilias.apalodimas@linaro.org>,
 linux-stm32@st-md-mailman.stormreply.com, linux-kernel@vger.kernel.org,
 op-tee@lists.trustedfirmware.org, linux-arm-kernel@lists.infradead.org,
 Maxime Coquelin <mcoquelin.stm32@gmail.com>, Ard Biesheuvel <ardb@kernel.org>,
 Johan Hovold <johan+linaro@kernel.org>
Subject: Re: [Linux-stm32] [PATCH v3 3/3] efi: Add tee-based EFI variable
	driver
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

SGksCgpPbiBXZWQsIEZlYiAyMiwgMjAyMyBhdCA2OjQw4oCvQU0gTWFzYWhpc2EgS29qaW1hCjxt
YXNhaGlzYS5rb2ppbWFAbGluYXJvLm9yZz4gd3JvdGU6Cj4KPiBXaGVuIHRoZSBmbGFzaCBpcyBu
b3Qgb3duZWQgYnkgdGhlIG5vbi1zZWN1cmUgd29ybGQsIGFjY2Vzc2luZyB0aGUgRUZJCj4gdmFy
aWFibGVzIGlzIHN0cmFpZ2h0Zm9yd2FyZCBhbmQgZG9uZSB2aWEgRUZJIFJ1bnRpbWUgVmFyaWFi
bGUgU2VydmljZXMuCj4gSW4gdGhpcyBjYXNlLCBjcml0aWNhbCB2YXJpYWJsZXMgZm9yIHN5c3Rl
bSBpbnRlZ3JpdHkgYW5kIHNlY3VyaXR5Cj4gYXJlIG5vcm1hbGx5IHN0b3JlZCBpbiB0aGUgZGVk
aWNhdGVkIHNlY3VyZSBzdG9yYWdlIGFuZCBvbmx5IGFjY2Vzc2libGUKPiBmcm9tIHRoZSBzZWN1
cmUgd29ybGQuCj4KPiBPbiB0aGUgb3RoZXIgaGFuZCwgdGhlIHNtYWxsIGVtYmVkZGVkIGRldmlj
ZXMgZG9uJ3QgaGF2ZSB0aGUgc3BlY2lhbAo+IGRlZGljYXRlZCBzZWN1cmUgc3RvcmFnZS4gVGhl
IGVNTUMgZGV2aWNlIHdpdGggYW4gUlBNQiBwYXJ0aXRpb24gaXMKPiBiZWNvbWluZyBtb3JlIGNv
bW1vbiwgd2UgY2FuIHVzZSBhbiBSUE1CIHBhcnRpdGlvbiB0byBzdG9yZSB0aGUKPiBFRkkgVmFy
aWFibGVzLgo+Cj4gVGhlIGVNTUMgZGV2aWNlIGlzIHR5cGljYWxseSBvd25lZCBieSB0aGUgbm9u
LXNlY3VyZSB3b3JsZChsaW51eCBpbgo+IHRoaXMgY2FzZSkuIFRoZXJlIGlzIGFuIGV4aXN0aW5n
IHNvbHV0aW9uIHV0aWxpemluZyBlTU1DIFJQTUIgcGFydGl0aW9uCj4gZm9yIEVGSSBWYXJpYWJs
ZXMsIGl0IGlzIGltcGxlbWVudGVkIGJ5IGludGVyYWN0aW5nIHdpdGgKPiBURUUoT1AtVEVFIGlu
IHRoaXMgY2FzZSksIFN0YW5kYWxvbmVNTShhcyBFRkkgVmFyaWFibGUgU2VydmljZSBQc2V1ZG8g
VEEpLAo+IGVNTUMgZHJpdmVyIGFuZCB0ZWUtc3VwcGxpY2FudC4gVGhlIGxhc3QgcGllY2UgaXMg
dGhlIHRlZS1iYXNlZAo+IHZhcmlhYmxlIGFjY2VzcyBkcml2ZXIgdG8gaW50ZXJhY3Qgd2l0aCBU
RUUgYW5kIFN0YW5kYWxvbmVNTS4KPgo+IFNvIGxldCdzIGFkZCB0aGUga2VybmVsIGZ1bmN0aW9u
cyBuZWVkZWQuCj4KPiBUaGlzIGZlYXR1cmUgaXMgaW1wbGVtZW50ZWQgYXMgYSBrZXJuZWwgbW9k
dWxlLgo+IFN0TU0gUFRBIGhhcyBUQV9GTEFHX0RFVklDRV9FTlVNX1NVUFAgZmxhZyB3aGVuIHJl
Z2lzdGVyZWQgdG8gT1AtVEVFCj4gc28gdGhhdCB0aGlzIHRlZV9zdG1tX2VmaSBtb2R1bGUgaXMg
cHJvYmVkIGFmdGVyIHRlZS1zdXBwbGljYW50IHN0YXJ0cywKPiBzaW5jZSAiU2V0VmFyaWFibGUi
IEVGSSBSdW50aW1lIFZhcmlhYmxlIFNlcnZpY2UgcmVxdWlyZXMgdG8KPiBpbnRlcmFjdCB3aXRo
IHRlZS1zdXBwbGljYW50Lgo+Cj4gQ28tZGV2ZWxvcGVkLWJ5OiBJbGlhcyBBcGFsb2RpbWFzIDxp
bGlhcy5hcGFsb2RpbWFzQGxpbmFyby5vcmc+Cj4gU2lnbmVkLW9mZi1ieTogSWxpYXMgQXBhbG9k
aW1hcyA8aWxpYXMuYXBhbG9kaW1hc0BsaW5hcm8ub3JnPgo+IFNpZ25lZC1vZmYtYnk6IE1hc2Fo
aXNhIEtvamltYSA8bWFzYWhpc2Eua29qaW1hQGxpbmFyby5vcmc+Cj4gLS0tCj4gIGRyaXZlcnMv
ZmlybXdhcmUvZWZpL0tjb25maWcgICAgICAgICAgICAgICAgIHwgIDE1ICsKPiAgZHJpdmVycy9m
aXJtd2FyZS9lZmkvTWFrZWZpbGUgICAgICAgICAgICAgICAgfCAgIDEgKwo+ICBkcml2ZXJzL2Zp
cm13YXJlL2VmaS9zdG1tL21tX2NvbW11bmljYXRpb24uaCB8IDI0OSArKysrKysrKwo+ICBkcml2
ZXJzL2Zpcm13YXJlL2VmaS9zdG1tL3RlZV9zdG1tX2VmaS5jICAgICB8IDYyNiArKysrKysrKysr
KysrKysrKysrCj4gIDQgZmlsZXMgY2hhbmdlZCwgODkxIGluc2VydGlvbnMoKykKPiAgY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZmlybXdhcmUvZWZpL3N0bW0vbW1fY29tbXVuaWNhdGlvbi5o
Cj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2Zpcm13YXJlL2VmaS9zdG1tL3RlZV9zdG1t
X2VmaS5jCj4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9maXJtd2FyZS9lZmkvS2NvbmZpZyBiL2Ry
aXZlcnMvZmlybXdhcmUvZWZpL0tjb25maWcKPiBpbmRleCAwNDNjYTMxYzExNGUuLmFhMzgwODlk
MWU0YSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Zpcm13YXJlL2VmaS9LY29uZmlnCj4gKysrIGIv
ZHJpdmVycy9maXJtd2FyZS9lZmkvS2NvbmZpZwo+IEBAIC0yODcsMyArMjg3LDE4IEBAIGNvbmZp
ZyBVRUZJX0NQRVJfWDg2Cj4gICAgICAgICBib29sCj4gICAgICAgICBkZXBlbmRzIG9uIFVFRklf
Q1BFUiAmJiBYODYKPiAgICAgICAgIGRlZmF1bHQgeQo+ICsKPiArY29uZmlnIFRFRV9TVE1NX0VG
SQo+ICsgICAgICAgdHJpc3RhdGUgIlRFRSBiYXNlZCBFRkkgcnVudGltZSB2YXJpYWJsZSBzZXJ2
aWNlIGRyaXZlciIKPiArICAgICAgIGRlcGVuZHMgb24gRUZJICYmIE9QVEVFICYmICFFRklfVkFS
U19QU1RPUkUKPiArICAgICAgIGhlbHAKPiArICAgICAgICAgU2VsZWN0IHRoaXMgY29uZmlnIG9w
dGlvbiBpZiBURUUgaXMgY29tcGlsZWQgdG8gaW5jbHVkZSBTdGFuZEFsb25lTU0KPiArICAgICAg
ICAgYXMgYSBzZXBhcmF0ZSBzZWN1cmUgcGFydGl0aW9uIGl0IGhhcyB0aGUgYWJpbGl0eSB0byBj
aGVjayBhbmQgc3RvcmUKPiArICAgICAgICAgRUZJIHZhcmlhYmxlcyBvbiBhbiBSUE1CIG9yIGFu
eSBvdGhlciBub24tdm9sYXRpbGUgbWVkaXVtIHVzZWQgYnkKPiArICAgICAgICAgU3RhbmRBbG9u
ZU1NLgo+ICsKPiArICAgICAgICAgRW5hYmxpbmcgdGhpcyB3aWxsIGNoYW5nZSB0aGUgRUZJIHJ1
bnRpbWUgc2VydmljZXMgZnJvbSB0aGUgZmlybXdhcmUKPiArICAgICAgICAgcHJvdmlkZWQgZnVu
Y3Rpb25zIHRvIFRFRSBjYWxscy4KPiArCj4gKyAgICAgICAgIFRvIGNvbXBpbGUgdGhpcyBkcml2
ZXIgYXMgYSBtb2R1bGUsIGNob29zZSBNIGhlcmU6IHRoZSBtb2R1bGUKPiArICAgICAgICAgd2ls
bCBiZSBjYWxsZWQgdGVlX3N0bW1fZWZpLgo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2Zpcm13YXJl
L2VmaS9NYWtlZmlsZSBiL2RyaXZlcnMvZmlybXdhcmUvZWZpL01ha2VmaWxlCj4gaW5kZXggYjUx
ZjJhNGM4MjFlLi4yY2E4ZWU2YWI0OTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9maXJtd2FyZS9l
ZmkvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL2Zpcm13YXJlL2VmaS9NYWtlZmlsZQo+IEBAIC00
MSwzICs0MSw0IEBAIG9iai0kKENPTkZJR19FRklfQ0FQU1VMRV9MT0FERVIpICAgICAgKz0gY2Fw
c3VsZS1sb2FkZXIubwo+ICBvYmotJChDT05GSUdfRUZJX0VBUkxZQ09OKSAgICAgICAgICAgICAr
PSBlYXJseWNvbi5vCj4gIG9iai0kKENPTkZJR19VRUZJX0NQRVJfQVJNKSAgICAgICAgICAgICs9
IGNwZXItYXJtLm8KPiAgb2JqLSQoQ09ORklHX1VFRklfQ1BFUl9YODYpICAgICAgICAgICAgKz0g
Y3Blci14ODYubwo+ICtvYmotJChDT05GSUdfVEVFX1NUTU1fRUZJKSAgICAgICAgICAgICArPSBz
dG1tL3RlZV9zdG1tX2VmaS5vCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZmlybXdhcmUvZWZpL3N0
bW0vbW1fY29tbXVuaWNhdGlvbi5oIGIvZHJpdmVycy9maXJtd2FyZS9lZmkvc3RtbS9tbV9jb21t
dW5pY2F0aW9uLmgKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAwMC4u
YTdmYTY3MjNkNTZlCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL2RyaXZlcnMvZmlybXdhcmUvZWZp
L3N0bW0vbW1fY29tbXVuaWNhdGlvbi5oCj4gQEAgLTAsMCArMSwyNDkgQEAKPiArLyogU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArICovCj4gKy8qCj4gKyAqICBIZWFkZXJzIGZvciBF
RkkgdmFyaWFibGUgc2VydmljZSB2aWEgU3RhbmRBbG9uZU1NLCBFREsyIGFwcGxpY2F0aW9uIHJ1
bm5pbmcKPiArICogIGluIE9QLVRFRQo+ICsgKgo+ICsgKiAgQ29weXJpZ2h0IChjKSAyMDE3LCBJ
bnRlbCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KPiArICogIENvcHlyaWdodCAo
QykgMjAyMCBMaW5hcm8gTHRkLgo+ICsgKi8KPiArCj4gKyNpZm5kZWYgX01NX0NPTU1VTklDQVRJ
T05fSF8KPiArI2RlZmluZSBfTU1fQ09NTVVOSUNBVElPTl9IXwo+ICsKPiArLyoKPiArICogSW50
ZXJmYWNlIHRvIHRoZSBwc2V1ZG8gVHJ1c3RlZCBBcHBsaWNhdGlvbiAoVEEpLCB3aGljaCBwcm92
aWRlcyBhCj4gKyAqIGNvbW11bmljYXRpb24gY2hhbm5lbCB3aXRoIHRoZSBTdGFuZGFsb25lIE1N
IChNYW5hZ2VtZW50IE1vZGUpCj4gKyAqIFNlY3VyZSBQYXJ0aXRpb24gcnVubmluZyBhdCBTZWN1
cmUtRUwwCj4gKyAqLwo+ICsKPiArI2RlZmluZSBQVEFfU1RNTV9DTURfQ09NTVVOSUNBVEUgMAo+
ICsKPiArLyogT1AtVEVFIGlzIHVzaW5nIGJpZyBlbmRpYW4gR1VJRHMgd2hpbGUgVUVGSSB1c2Vz
IGxpdHRsZSBlbmRpYW4gb25lcyAqLwo+ICsjZGVmaW5lIFBUQV9TVE1NX1VVSUQgXAo+ICsgICAg
ICAgVVVJRF9JTklUKDB4ZWQzMmQ1MzMsIDB4OTllNiwgMHg0MjA5LCBcCj4gKyAgICAgICAgICAg
ICAgICAgMHg5YywgMHhjMCwgMHgyZCwgMHg3MiwgMHhjZCwgMHhkOSwgMHg5OCwgMHhhNykKPiAr
Cj4gKyNkZWZpbmUgRUZJX01NX1ZBUklBQkxFX0dVSUQgXAo+ICsgICAgICAgRUZJX0dVSUQoMHhl
ZDMyZDUzMywgMHg5OWU2LCAweDQyMDksIFwKPiArICAgICAgICAgICAgICAgIDB4OWMsIDB4YzAs
IDB4MmQsIDB4NzIsIDB4Y2QsIDB4ZDksIDB4OTgsIDB4YTcpCj4gKwo+ICsvKiBEZWZpbmVkIGlu
IEVESzIgTWRlUGtnL0luY2x1ZGUvUHJvdG9jb2wvTW1Db21tdW5pY2F0aW9uLmggKi8KPiArCj4g
Ky8qKgo+ICsgKiBzdHJ1Y3QgZWZpX21tX2NvbW11bmljYXRlX2hlYWRlciAtIEhlYWRlciB1c2Vk
IGZvciBTTU0gdmFyaWFibGUgY29tbXVuaWNhdGlvbgo+ICsKPiArICogQGhlYWRlcl9ndWlkOiAg
aGVhZGVyIHVzZSBmb3IgZGlzYW1iaWd1YXRpb24gb2YgY29udGVudAo+ICsgKiBAbWVzc2FnZV9s
ZW46ICBsZW5ndGggb2YgdGhlIG1lc3NhZ2UuIERvZXMgbm90IGluY2x1ZGUgdGhlIHNpemUgb2Yg
dGhlCj4gKyAqICAgICAgICAgICAgICAgIGhlYWRlcgo+ICsgKiBAZGF0YTogICAgICAgICBwYXls
b2FkIG9mIHRoZSBtZXNzYWdlCj4gKyAqCj4gKyAqIERlZmluZWQgaW4gRURLMiBhcyBFRklfTU1f
Q09NTVVOSUNBVEVfSEVBREVSLgo+ICsgKiBUbyBhdm9pZCBjb25mdXNpb24gaW4gaW50ZXJwcmV0
aW5nIGZyYW1lcywgdGhlIGNvbW11bmljYXRpb24gYnVmZmVyIHNob3VsZAo+ICsgKiBhbHdheXMg
YmVnaW4gd2l0aCBlZmlfbW1fY29tbXVuaWNhdGVfaGVhZGVyLgo+ICsgKi8KPiArc3RydWN0IGVm
aV9tbV9jb21tdW5pY2F0ZV9oZWFkZXIgewo+ICsgICAgICAgZWZpX2d1aWRfdCBoZWFkZXJfZ3Vp
ZDsKPiArICAgICAgIHNpemVfdCAgICAgbWVzc2FnZV9sZW47Cj4gKyAgICAgICB1OCAgICAgICAg
IGRhdGFbXTsKPiArfSBfX3BhY2tlZDsKPiArCj4gKyNkZWZpbmUgTU1fQ09NTVVOSUNBVEVfSEVB
REVSX1NJWkUgXAo+ICsgICAgICAgKHNpemVvZihzdHJ1Y3QgZWZpX21tX2NvbW11bmljYXRlX2hl
YWRlcikpCj4gKwo+ICsvKiBEZWZpbmVkIGluIEVESzIgQXJtUGtnL0luY2x1ZGUvSW5kdXN0cnlT
dGFuZGFyZC9Bcm1NbVN2Yy5oICovCj4gKwo+ICsvKiBTUE0gcmV0dXJuIGVycm9yIGNvZGVzICov
Cj4gKyNkZWZpbmUgQVJNX1NWQ19TUE1fUkVUX1NVQ0NFU1MgICAgICAgICAgICAgICAwCj4gKyNk
ZWZpbmUgQVJNX1NWQ19TUE1fUkVUX05PVF9TVVBQT1JURUQgICAgICAgIC0xCj4gKyNkZWZpbmUg
QVJNX1NWQ19TUE1fUkVUX0lOVkFMSURfUEFSQU1TICAgICAgIC0yCj4gKyNkZWZpbmUgQVJNX1NW
Q19TUE1fUkVUX0RFTklFRCAgICAgICAgICAgICAgIC0zCj4gKyNkZWZpbmUgQVJNX1NWQ19TUE1f
UkVUX05PX01FTU9SWSAgICAgICAgICAgIC01Cj4gKwo+ICsvKiBEZWZpbmVkIGluIEVESzIgTWRl
TW9kdWxlUGtnL0luY2x1ZGUvR3VpZC9TbW1WYXJpYWJsZUNvbW1vbi5oICovCj4gKwo+ICsjZGVm
aW5lIFNNTV9WQVJJQUJMRV9GVU5DVElPTl9HRVRfVkFSSUFCTEUgIDEKPiArLyoKPiArICogVGhl
IHBheWxvYWQgZm9yIHRoaXMgZnVuY3Rpb24gaXMKPiArICogU01NX1ZBUklBQkxFX0NPTU1VTklD
QVRFX0dFVF9ORVhUX1ZBUklBQkxFX05BTUUuCj4gKyAqLwo+ICsjZGVmaW5lIFNNTV9WQVJJQUJM
RV9GVU5DVElPTl9HRVRfTkVYVF9WQVJJQUJMRV9OQU1FICAyCj4gKy8qCj4gKyAqIFRoZSBwYXls
b2FkIGZvciB0aGlzIGZ1bmN0aW9uIGlzIFNNTV9WQVJJQUJMRV9DT01NVU5JQ0FURV9BQ0NFU1Nf
VkFSSUFCTEUuCj4gKyAqLwo+ICsjZGVmaW5lIFNNTV9WQVJJQUJMRV9GVU5DVElPTl9TRVRfVkFS
SUFCTEUgIDMKPiArLyoKPiArICogVGhlIHBheWxvYWQgZm9yIHRoaXMgZnVuY3Rpb24gaXMKPiAr
ICogU01NX1ZBUklBQkxFX0NPTU1VTklDQVRFX1FVRVJZX1ZBUklBQkxFX0lORk8uCj4gKyAqLwo+
ICsjZGVmaW5lIFNNTV9WQVJJQUJMRV9GVU5DVElPTl9RVUVSWV9WQVJJQUJMRV9JTkZPICA0Cj4g
Ky8qCj4gKyAqIEl0IGlzIGEgbm90aWZ5IGV2ZW50LCBubyBleHRyYSBwYXlsb2FkIGZvciB0aGlz
IGZ1bmN0aW9uLgo+ICsgKi8KPiArI2RlZmluZSBTTU1fVkFSSUFCTEVfRlVOQ1RJT05fUkVBRFlf
VE9fQk9PVCAgNQo+ICsvKgo+ICsgKiBJdCBpcyBhIG5vdGlmeSBldmVudCwgbm8gZXh0cmEgcGF5
bG9hZCBmb3IgdGhpcyBmdW5jdGlvbi4KPiArICovCj4gKyNkZWZpbmUgU01NX1ZBUklBQkxFX0ZV
TkNUSU9OX0VYSVRfQk9PVF9TRVJWSUNFICA2Cj4gKy8qCj4gKyAqIFRoZSBwYXlsb2FkIGZvciB0
aGlzIGZ1bmN0aW9uIGlzIFZBUklBQkxFX0lORk9fRU5UUlkuCj4gKyAqIFRoZSBHVUlEIGluIEVG
SV9TTU1fQ09NTVVOSUNBVEVfSEVBREVSIGlzIGdFZmlTbW1WYXJpYWJsZVByb3RvY29sR3VpZC4K
PiArICovCj4gKyNkZWZpbmUgU01NX1ZBUklBQkxFX0ZVTkNUSU9OX0dFVF9TVEFUSVNUSUNTICA3
Cj4gKy8qCj4gKyAqIFRoZSBwYXlsb2FkIGZvciB0aGlzIGZ1bmN0aW9uIGlzIFNNTV9WQVJJQUJM
RV9DT01NVU5JQ0FURV9MT0NLX1ZBUklBQkxFCj4gKyAqLwo+ICsjZGVmaW5lIFNNTV9WQVJJQUJM
RV9GVU5DVElPTl9MT0NLX1ZBUklBQkxFICAgOAo+ICsKPiArI2RlZmluZSBTTU1fVkFSSUFCTEVf
RlVOQ1RJT05fVkFSX0NIRUNLX1ZBUklBQkxFX1BST1BFUlRZX1NFVCAgOQo+ICsKPiArI2RlZmlu
ZSBTTU1fVkFSSUFCTEVfRlVOQ1RJT05fVkFSX0NIRUNLX1ZBUklBQkxFX1BST1BFUlRZX0dFVCAg
MTAKPiArCj4gKyNkZWZpbmUgU01NX1ZBUklBQkxFX0ZVTkNUSU9OX0dFVF9QQVlMT0FEX1NJWkUg
IDExCj4gKy8qCj4gKyAqIFRoZSBwYXlsb2FkIGZvciB0aGlzIGZ1bmN0aW9uIGlzCj4gKyAqIFNN
TV9WQVJJQUJMRV9DT01NVU5JQ0FURV9SVU5USU1FX1ZBUklBQkxFX0NBQ0hFX0NPTlRFWFQKPiAr
ICovCj4gKyNkZWZpbmUgU01NX1ZBUklBQkxFX0ZVTkNUSU9OX0lOSVRfUlVOVElNRV9WQVJJQUJM
RV9DQUNIRV9DT05URVhUIDEyCj4gKwo+ICsjZGVmaW5lIFNNTV9WQVJJQUJMRV9GVU5DVElPTl9T
WU5DX1JVTlRJTUVfQ0FDSEUgIDEzCj4gKy8qCj4gKyAqIFRoZSBwYXlsb2FkIGZvciB0aGlzIGZ1
bmN0aW9uIGlzCj4gKyAqIFNNTV9WQVJJQUJMRV9DT01NVU5JQ0FURV9HRVRfUlVOVElNRV9DQUNI
RV9JTkZPCj4gKyAqLwo+ICsjZGVmaW5lIFNNTV9WQVJJQUJMRV9GVU5DVElPTl9HRVRfUlVOVElN
RV9DQUNIRV9JTkZPICAxNAo+ICsKPiArLyoqCj4gKyAqIHN0cnVjdCBzbW1fdmFyaWFibGVfY29t
bXVuaWNhdGVfaGVhZGVyIC0gVXNlZCBmb3IgU01NIHZhcmlhYmxlIGNvbW11bmljYXRpb24KPiAr
Cj4gKyAqIEBmdW5jdGlvbjogICAgIGZ1bmN0aW9uIHRvIGNhbGwgaW4gU21tLgo+ICsgKiBAcmV0
X3N0YXR1czogICByZXR1cm4gc3RhdHVzCj4gKyAqIEBkYXRhOiAgICAgICAgIHBheWxvYWQKPiAr
ICoKPiArICogRGVmaW5lZCBpbiBFREsyIGFzIFNNTV9WQVJJQUJMRV9DT01NVU5JQ0FURV9IRUFE
RVIuCj4gKyAqLwo+ICtzdHJ1Y3Qgc21tX3ZhcmlhYmxlX2NvbW11bmljYXRlX2hlYWRlciB7Cj4g
KyAgICAgICBzaXplX3QgIGZ1bmN0aW9uOwo+ICsgICAgICAgZWZpX3N0YXR1c190IHJldF9zdGF0
dXM7Cj4gKyAgICAgICB1OCBkYXRhW107Cj4gK307Cj4gKwo+ICsjZGVmaW5lIE1NX1ZBUklBQkxF
X0NPTU1VTklDQVRFX1NJWkUgXAo+ICsgICAgICAgKHNpemVvZihzdHJ1Y3Qgc21tX3ZhcmlhYmxl
X2NvbW11bmljYXRlX2hlYWRlcikpCj4gKwo+ICsvKioKPiArICogc3RydWN0IHNtbV92YXJpYWJs
ZV9hY2Nlc3MgLSBVc2VkIHRvIGNvbW11bmljYXRlIHdpdGggU3RNTSBieQo+ICsgKiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFNldFZhcmlhYmxlIGFuZCBHZXRWYXJpYWJsZS4KPiArCj4g
KyAqIEBndWlkOiAgICAgICAgIHZlbmRvciBHVUlECj4gKyAqIEBkYXRhX3NpemU6ICAgIHNpemUg
b2YgRUZJIHZhcmlhYmxlIGRhdGEKPiArICogQG5hbWVfc2l6ZTogICAgc2l6ZSBvZiBFRkkgbmFt
ZQo+ICsgKiBAYXR0cjogICAgICAgICBhdHRyaWJ1dGVzCj4gKyAqIEBuYW1lOiAgICAgICAgIHZh
cmlhYmxlIG5hbWUKPiArICoKPiArICogRGVmaW5lZCBpbiBFREsyIGFzIFNNTV9WQVJJQUJMRV9D
T01NVU5JQ0FURV9BQ0NFU1NfVkFSSUFCTEUuCj4gKyAqCj4gKyAqLwo+ICtzdHJ1Y3Qgc21tX3Zh
cmlhYmxlX2FjY2VzcyB7Cj4gKyAgICAgICBlZmlfZ3VpZF90ICBndWlkOwo+ICsgICAgICAgc2l6
ZV90IGRhdGFfc2l6ZTsKPiArICAgICAgIHNpemVfdCBuYW1lX3NpemU7Cj4gKyAgICAgICB1MzIg
YXR0cjsKPiArICAgICAgIHUxNiBuYW1lW107Cj4gK307Cj4gKwo+ICsjZGVmaW5lIE1NX1ZBUklB
QkxFX0FDQ0VTU19IRUFERVJfU0laRSBcCj4gKyAgICAgICAoc2l6ZW9mKHN0cnVjdCBzbW1fdmFy
aWFibGVfYWNjZXNzKSkKPiArLyoqCj4gKyAqIHN0cnVjdCBzbW1fdmFyaWFibGVfcGF5bG9hZF9z
aXplIC0gVXNlZCB0byBnZXQgdGhlIG1heCBhbGxvd2VkCj4gKyAqICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgcGF5bG9hZCB1c2VkIGluIFN0TU0uCj4gKyAqCj4gKyAqIEBzaXpl
OiAgc2l6ZSB0byBmaWxsIGluCj4gKyAqCj4gKyAqIERlZmluZWQgaW4gRURLMiBhcyBTTU1fVkFS
SUFCTEVfQ09NTVVOSUNBVEVfR0VUX1BBWUxPQURfU0laRS4KPiArICoKPiArICovCj4gK3N0cnVj
dCBzbW1fdmFyaWFibGVfcGF5bG9hZF9zaXplIHsKPiArICAgICAgIHNpemVfdCBzaXplOwo+ICt9
Owo+ICsKPiArLyoqCj4gKyAqIHN0cnVjdCBzbW1fdmFyaWFibGVfZ2V0bmV4dCAtIFVzZWQgdG8g
Y29tbXVuaWNhdGUgd2l0aCBTdE1NIGZvcgo+ICsgKiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBHZXROZXh0VmFyaWFibGVOYW1lLgo+ICsgKgo+ICsgKiBAZ3VpZDogICAgICAgdmVuZG9y
IEdVSUQKPiArICogQG5hbWVfc2l6ZTogIHNpemUgb2YgdGhlIG5hbWUgb2YgdGhlIHZhcmlhYmxl
Cj4gKyAqIEBuYW1lOiAgICAgICB2YXJpYWJsZSBuYW1lCj4gKyAqCj4gKyAqIERlZmluZWQgaW4g
RURLMiBhcyBTTU1fVkFSSUFCTEVfQ09NTVVOSUNBVEVfR0VUX05FWFRfVkFSSUFCTEVfTkFNRS4K
PiArICovCj4gK3N0cnVjdCBzbW1fdmFyaWFibGVfZ2V0bmV4dCB7Cj4gKyAgICAgICBlZmlfZ3Vp
ZF90ICBndWlkOwo+ICsgICAgICAgc2l6ZV90IG5hbWVfc2l6ZTsKPiArICAgICAgIHUxNiAgICAg
ICAgIG5hbWVbXTsKPiArfTsKPiArCj4gKyNkZWZpbmUgTU1fVkFSSUFCTEVfR0VUX05FWFRfSEVB
REVSX1NJWkUgXAo+ICsgICAgICAgKHNpemVvZihzdHJ1Y3Qgc21tX3ZhcmlhYmxlX2dldG5leHQp
KQo+ICsKPiArLyoqCj4gKyAqIHN0cnVjdCBzbW1fdmFyaWFibGVfcXVlcnlfaW5mbyAtIFVzZWQg
dG8gY29tbXVuaWNhdGUgd2l0aCBTdE1NIGZvcgo+ICsgKiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBRdWVyeVZhcmlhYmxlSW5mby4KPiArICoKPiArICogQG1heF92YXJpYWJsZV9z
dG9yYWdlOiAgICAgICAgbWF4IGF2YWlsYWJsZSBzdG9yYWdlCj4gKyAqIEByZW1haW5pbmdfdmFy
aWFibGVfc3RvcmFnZTogIHJlbWFpbmluZyBhdmFpbGFibGUgc3RvcmFnZQo+ICsgKiBAbWF4X3Zh
cmlhYmxlX3NpemU6ICAgICAgICAgICBtYXggdmFyaWFibGUgc3VwcG9ydGVkIHNpemUKPiArICog
QGF0dHI6ICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcyB0byBxdWVyeSBzdG9yYWdl
IGZvcgo+ICsgKgo+ICsgKiBEZWZpbmVkIGluIEVESzIgYXMgU01NX1ZBUklBQkxFX0NPTU1VTklD
QVRFX1FVRVJZX1ZBUklBQkxFX0lORk8uCj4gKyAqLwo+ICtzdHJ1Y3Qgc21tX3ZhcmlhYmxlX3F1
ZXJ5X2luZm8gewo+ICsgICAgICAgdTY0IG1heF92YXJpYWJsZV9zdG9yYWdlOwo+ICsgICAgICAg
dTY0IHJlbWFpbmluZ192YXJpYWJsZV9zdG9yYWdlOwo+ICsgICAgICAgdTY0IG1heF92YXJpYWJs
ZV9zaXplOwo+ICsgICAgICAgdTMyIGF0dHI7Cj4gK307Cj4gKwo+ICsjZGVmaW5lIFZBUl9DSEVD
S19WQVJJQUJMRV9QUk9QRVJUWV9SRVZJU0lPTiAweDAwMDEKPiArI2RlZmluZSBWQVJfQ0hFQ0tf
VkFSSUFCTEVfUFJPUEVSVFlfUkVBRF9PTkxZIEJJVCgwKQo+ICsvKioKPiArICogc3RydWN0IHZh
cl9jaGVja19wcm9wZXJ0eSAtIFVzZWQgdG8gc3RvcmUgdmFyaWFibGUgcHJvcGVydGllcyBpbiBT
dE1NCj4gKyAqCj4gKyAqIEByZXZpc2lvbjogICBtYWdpYyByZXZpc2lvbiBudW1iZXIgZm9yIHZh
cmlhYmxlIHByb3BlcnR5IGNoZWNraW5nCj4gKyAqIEBwcm9wZXJ0eTogICBwcm9wZXJ0aWVzIG1h
c2sgZm9yIHRoZSB2YXJpYWJsZSB1c2VkIGluIFN0TU0uCj4gKyAqICAgICAgICAgICAgICBDdXJy
ZW50bHkgUk8gZmxhZyBpcyBzdXBwb3J0ZWQKPiArICogQGF0dHJpYnV0ZXM6IHZhcmlhYmxlIGF0
dHJpYnV0ZXMgdXNlZCBpbiBTdE1NIGNoZWNraW5nIHdoZW4gcHJvcGVydGllcwo+ICsgKiAgICAg
ICAgICAgICAgZm9yIGEgdmFyaWFibGUgYXJlIGVuYWJsZWQKPiArICogQG1pbnNpemU6ICAgIG1p
bmltdW0gYWxsb3dlZCBzaXplIGZvciB2YXJpYWJsZSBwYXlsb2FkIGNoZWNrZWQgYWdhaW5zdAo+
ICsgKiAgICAgICAgICAgICAgc21tX3ZhcmlhYmxlX2FjY2Vzcy0+ZGF0YXNpemUgaW4gU3RNTQo+
ICsgKiBAbWF4c2l6ZTogICAgbWF4aW11bSBhbGxvd2VkIHNpemUgZm9yIHZhcmlhYmxlIHBheWxv
YWQgY2hlY2tlZCBhZ2FpbnN0Cj4gKyAqICAgICAgICAgICAgICBzbW1fdmFyaWFibGVfYWNjZXNz
LT5kYXRhc2l6ZSBpbiBTdE1NCj4gKyAqCj4gKyAqIERlZmluZWQgaW4gRURLMiBhcyBWQVJfQ0hF
Q0tfVkFSSUFCTEVfUFJPUEVSVFkuCj4gKyAqLwo+ICtzdHJ1Y3QgdmFyX2NoZWNrX3Byb3BlcnR5
IHsKPiArICAgICAgIHUxNiByZXZpc2lvbjsKPiArICAgICAgIHUxNiBwcm9wZXJ0eTsKPiArICAg
ICAgIHUzMiBhdHRyaWJ1dGVzOwo+ICsgICAgICAgc2l6ZV90IG1pbnNpemU7Cj4gKyAgICAgICBz
aXplX3QgbWF4c2l6ZTsKPiArfTsKPiArCj4gKy8qKgo+ICsgKiBzdHJ1Y3Qgc21tX3ZhcmlhYmxl
X3Zhcl9jaGVja19wcm9wZXJ0eSAtIFVzZWQgdG8gY29tbXVuaWNhdGUgdmFyaWFibGUKPiArICog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzIHdpdGgg
U3RNTQo+ICsgKgo+ICsgKiBAZ3VpZDogICAgICAgdmVuZG9yIEdVSUQKPiArICogQG5hbWVfc2l6
ZTogIHNpemUgb2YgRUZJIG5hbWUKPiArICogQHByb3BlcnR5OiAgIHZhcmlhYmxlIHByb3BlcnRp
ZXMgc3RydWN0Cj4gKyAqIEBuYW1lOiAgICAgICB2YXJpYWJsZSBuYW1lCj4gKyAqCj4gKyAqIERl
ZmluZWQgaW4gRURLMiBhcyBTTU1fVkFSSUFCTEVfQ09NTVVOSUNBVEVfVkFSX0NIRUNLX1ZBUklB
QkxFX1BST1BFUlRZLgo+ICsgKi8KPiArc3RydWN0IHNtbV92YXJpYWJsZV92YXJfY2hlY2tfcHJv
cGVydHkgewo+ICsgICAgICAgZWZpX2d1aWRfdCBndWlkOwo+ICsgICAgICAgc2l6ZV90IG5hbWVf
c2l6ZTsKPiArICAgICAgIHN0cnVjdCB2YXJfY2hlY2tfcHJvcGVydHkgcHJvcGVydHk7Cj4gKyAg
ICAgICB1MTYgbmFtZVtdOwo+ICt9Owo+ICsKPiArI2VuZGlmIC8qIF9NTV9DT01NVU5JQ0FUSU9O
X0hfICovCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZmlybXdhcmUvZWZpL3N0bW0vdGVlX3N0bW1f
ZWZpLmMgYi9kcml2ZXJzL2Zpcm13YXJlL2VmaS9zdG1tL3RlZV9zdG1tX2VmaS5jCj4gbmV3IGZp
bGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAwMDAuLmRhNGJjNDQ3ZjUxNQo+IC0tLSAv
ZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2Zpcm13YXJlL2VmaS9zdG1tL3RlZV9zdG1tX2VmaS5j
Cj4gQEAgLTAsMCArMSw2MjYgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjArCj4gKy8qCj4gKyAqICBFRkkgdmFyaWFibGUgc2VydmljZSB2aWEgVEVFCj4gKyAqCj4gKyAq
ICBDb3B5cmlnaHQgKEMpIDIwMjIgTGluYXJvCj4gKyAqLwo+ICsKPiArI2luY2x1ZGUgPGxpbnV4
L2VmaS5oPgo+ICsjaW5jbHVkZSA8bGludXgva2VybmVsLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9z
bGFiLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC90ZWUuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3RlZV9k
cnYuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3VjczJfc3RyaW5nLmg+Cj4gKyNpbmNsdWRlICJtbV9j
b21tdW5pY2F0aW9uLmgiCj4gKwo+ICtzdGF0aWMgc3RydWN0IGVmaXZhcnMgdGVlX2VmaXZhcnM7
Cj4gK3N0YXRpYyBzdHJ1Y3QgZWZpdmFyX29wZXJhdGlvbnMgdGVlX2VmaXZhcl9vcHM7Cj4gKwo+
ICtzdGF0aWMgc2l6ZV90IG1heF9idWZmZXJfc2l6ZTsgLyogY29tbSArIHZhciArIGZ1bmMgKyBk
YXRhICovCj4gK3N0YXRpYyBzaXplX3QgbWF4X3BheWxvYWRfc2l6ZTsgLyogZnVuYyArIGRhdGEg
Ki8KPiArCj4gK3N0cnVjdCB0ZWVfc3RtbV9lZmlfcHJpdmF0ZSB7Cj4gKyAgICAgICBzdHJ1Y3Qg
dGVlX2NvbnRleHQgKmN0eDsKPiArICAgICAgIHUzMiBzZXNzaW9uOwo+ICsgICAgICAgc3RydWN0
IGRldmljZSAqZGV2Owo+ICt9Owo+ICsKPiArc3RhdGljIHN0cnVjdCB0ZWVfc3RtbV9lZmlfcHJp
dmF0ZSBwdnRfZGF0YTsKPiArCj4gKy8qIFVVSUQgb2YgdGhlIHN0bW0gUFRBICovCj4gK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgdGVlX2NsaWVudF9kZXZpY2VfaWQgdGVlX3N0bW1fZWZpX2lkX3RhYmxl
W10gPSB7Cj4gKyAgICAgICB7UFRBX1NUTU1fVVVJRH0sCj4gKyAgICAgICB7fQo+ICt9Owo+ICsK
PiArc3RhdGljIGludCB0ZWVfY3R4X21hdGNoKHN0cnVjdCB0ZWVfaW9jdGxfdmVyc2lvbl9kYXRh
ICp2ZXIsIGNvbnN0IHZvaWQgKmRhdGEpCj4gK3sKPiArICAgICAgIC8qIGN1cnJlbnRseSBvbmx5
IE9QLVRFRSBpcyBzdXBwb3J0ZWQgYXMgYSBjb21tdW5pY2F0aW9uIHBhdGggKi8KPiArICAgICAg
IGlmICh2ZXItPmltcGxfaWQgPT0gVEVFX0lNUExfSURfT1BURUUpCj4gKyAgICAgICAgICAgICAg
IHJldHVybiAxOwo+ICsgICAgICAgZWxzZQo+ICsgICAgICAgICAgICAgICByZXR1cm4gMDsKPiAr
fQo+ICsKPiArLyoqCj4gKyAqIHRlZV9tbV9jb21tdW5pY2F0ZSgpIC0gUGFzcyBhIGJ1ZmZlciB0
byBTdGFuZGFsb25lTU0gcnVubmluZyBpbiBURUUKPiArICoKPiArICogQGNvbW1fYnVmOiAgICAg
ICAgICBsb2NhbGx5IGFsbG9jYXRlZCBjb21tdW5pY2F0aW9uIGJ1ZmZlcgo+ICsgKiBAZHNpemU6
ICAgICAgICAgICAgIGJ1ZmZlciBzaXplCj4gKyAqIFJldHVybjogICAgICAgICAgICAgc3RhdHVz
IGNvZGUKPiArICovCj4gK3N0YXRpYyBlZmlfc3RhdHVzX3QgdGVlX21tX2NvbW11bmljYXRlKHZv
aWQgKmNvbW1fYnVmLCBzaXplX3QgZHNpemUpCj4gK3sKPiArICAgICAgIHNpemVfdCBidWZfc2l6
ZTsKPiArICAgICAgIGVmaV9zdGF0dXNfdCByZXQ7Cj4gKyAgICAgICBzdHJ1Y3QgZWZpX21tX2Nv
bW11bmljYXRlX2hlYWRlciAqbW1faGRyOwo+ICsgICAgICAgc3RydWN0IHRlZV9pb2N0bF9pbnZv
a2VfYXJnIGFyZzsKPiArICAgICAgIHN0cnVjdCB0ZWVfcGFyYW0gcGFyYW1bNF07Cj4gKyAgICAg
ICBzdHJ1Y3QgdGVlX3NobSAqc2htID0gTlVMTDsKPiArICAgICAgIGludCByYzsKPiArCj4gKyAg
ICAgICBpZiAoIWNvbW1fYnVmKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gRUZJX0lOVkFMSURf
UEFSQU1FVEVSOwo+ICsKPiArICAgICAgIG1tX2hkciA9IChzdHJ1Y3QgZWZpX21tX2NvbW11bmlj
YXRlX2hlYWRlciAqKWNvbW1fYnVmOwo+ICsgICAgICAgYnVmX3NpemUgPSBtbV9oZHItPm1lc3Nh
Z2VfbGVuICsgc2l6ZW9mKGVmaV9ndWlkX3QpICsgc2l6ZW9mKHNpemVfdCk7Cj4gKwo+ICsgICAg
ICAgaWYgKGRzaXplICE9IGJ1Zl9zaXplKQo+ICsgICAgICAgICAgICAgICByZXR1cm4gRUZJX0lO
VkFMSURfUEFSQU1FVEVSOwoKSSBkb24ndCBzZWUgd2h5IHRlZV9tbV9jb21tdW5pY2F0ZSgpIHNo
b3VsZCBuZWVkIHRvIGxvb2sgaW5zaWRlIHRoZQpjb21tdW5pY2F0aW9uIGJ1ZmZlci4gSWYgd2Ug
bmVlZCB0aGlzIHNhbml0eSBjaGVjayBpdCdzIGJldHRlciBkb25lIGluCm1tX2NvbW11bmljYXRl
KCkgYmVsb3cuCgo+ICsKPiArICAgICAgIHNobSA9IHRlZV9zaG1fcmVnaXN0ZXJfa2VybmVsX2J1
ZihwdnRfZGF0YS5jdHgsIGNvbW1fYnVmLCBidWZfc2l6ZSk7Cj4gKyAgICAgICBpZiAoSVNfRVJS
KHNobSkpIHsKPiArICAgICAgICAgICAgICAgZGV2X2VycihwdnRfZGF0YS5kZXYsICJVbmFibGUg
dG8gcmVnaXN0ZXIgc2hhcmVkIG1lbW9yeVxuIik7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBF
RklfVU5TVVBQT1JURUQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgbWVtc2V0KCZhcmcsIDAs
IHNpemVvZihhcmcpKTsKPiArICAgICAgIGFyZy5mdW5jID0gUFRBX1NUTU1fQ01EX0NPTU1VTklD
QVRFOwo+ICsgICAgICAgYXJnLnNlc3Npb24gPSBwdnRfZGF0YS5zZXNzaW9uOwo+ICsgICAgICAg
YXJnLm51bV9wYXJhbXMgPSA0Owo+ICsKPiArICAgICAgIG1lbXNldChwYXJhbSwgMCwgc2l6ZW9m
KHBhcmFtKSk7Cj4gKyAgICAgICBwYXJhbVswXS5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJf
VFlQRV9NRU1SRUZfSU5PVVQ7Cj4gKyAgICAgICBwYXJhbVswXS51Lm1lbXJlZi5zaXplID0gYnVm
X3NpemU7Cj4gKyAgICAgICBwYXJhbVswXS51Lm1lbXJlZi5zaG0gPSBzaG07Cj4gKyAgICAgICBw
YXJhbVsxXS5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9PVVRQVVQ7Cj4g
KyAgICAgICBwYXJhbVsyXS5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9OT05FOwo+
ICsgICAgICAgcGFyYW1bM10uYXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTk9ORTsK
PiArCj4gKyAgICAgICByYyA9IHRlZV9jbGllbnRfaW52b2tlX2Z1bmMocHZ0X2RhdGEuY3R4LCAm
YXJnLCBwYXJhbSk7Cj4gKyAgICAgICB0ZWVfc2htX2ZyZWUoc2htKTsKPiArCj4gKyAgICAgICBp
ZiAocmMgPCAwIHx8IGFyZy5yZXQgIT0gMCkgewo+ICsgICAgICAgICAgICAgICBkZXZfZXJyKHB2
dF9kYXRhLmRldiwKPiArICAgICAgICAgICAgICAgICAgICAgICAiUFRBX1NUTU1fQ01EX0NPTU1V
TklDQVRFIGludm9rZSBlcnJvcjogMHgleFxuIiwgYXJnLnJldCk7Cj4gKyAgICAgICAgICAgICAg
IHJldHVybiBFRklfREVWSUNFX0VSUk9SOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIHN3aXRj
aCAocGFyYW1bMV0udS52YWx1ZS5hKSB7Cj4gKyAgICAgICBjYXNlIEFSTV9TVkNfU1BNX1JFVF9T
VUNDRVNTOgo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklfU1VDQ0VTUzsKPiArICAgICAgICAg
ICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgY2FzZSBBUk1fU1ZDX1NQTV9SRVRfSU5WQUxJRF9Q
QVJBTVM6Cj4gKyAgICAgICAgICAgICAgIHJldCA9IEVGSV9JTlZBTElEX1BBUkFNRVRFUjsKPiAr
ICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgY2FzZSBBUk1fU1ZDX1NQTV9SRVRf
REVOSUVEOgo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklfQUNDRVNTX0RFTklFRDsKPiArICAg
ICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgY2FzZSBBUk1fU1ZDX1NQTV9SRVRfTk9f
TUVNT1JZOgo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklfT1VUX09GX1JFU09VUkNFUzsKPiAr
ICAgICAgICAgICAgICAgYnJlYWs7Cj4gKwo+ICsgICAgICAgZGVmYXVsdDoKPiArICAgICAgICAg
ICAgICAgcmV0ID0gRUZJX0FDQ0VTU19ERU5JRUQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAg
cmV0dXJuIHJldDsKPiArfQo+ICsKPiArLyoqCj4gKyAqIG1tX2NvbW11bmljYXRlKCkgLSBBZGp1
c3QgdGhlIGNvbW11bmljYXRpb24gYnVmZmVyIHRvIFN0YW5kQWxvbm5lTU0gYW5kIHNlbmQKPiAr
ICogaXQgdG8gVEVFCj4gKyAqCj4gKyAqIEBjb21tX2J1ZjogICAgICAgICAgbG9jYWxseSBhbGxv
Y2F0ZWQgY29tbXVuaWNhdGlvbiBidWZmZXIKPiArICogQGRzaXplOiAgICAgICAgICAgICBidWZm
ZXIgc2l6ZQoKVGhpcyBpcyBjb25mdXNpbmcsIGNvbW1fYnVmIHBvaW50cyB0byB0aGUgbW0gaGVh
ZGVyLCB3aGlsZSBkc2l6ZSB0ZWxscwp0aGUgcGF5bG9hZCBzaXplLiBTbyB0aGUgYXJndW1lbnRz
IHRvIHRoaXMgZnVuY3Rpb24gYXJlbid0IHRoZSBub3JtYWwKYnVmZmVyIHBvaW50ZXIgYW5kIGxl
bmd0aCB0dXBsZS4gV2hlbiBsb29raW5nIGF0IGhvdyB0aGlzIGZ1bmN0aW9uIGlzCmNhbGxlZCBp
dCBtYWtlcyBzZW5zZSwgYnV0IHdlIHNob3VsZCBjbGFyaWZ5IHRoZSByZWxhdGlvbnNoaXAgaGVy
ZS4KCj4gKyAqIFJldHVybjogICAgICAgICAgICAgc3RhdHVzIGNvZGUKPiArICovCj4gK3N0YXRp
YyBlZmlfc3RhdHVzX3QgbW1fY29tbXVuaWNhdGUodTggKmNvbW1fYnVmLCBzaXplX3QgZHNpemUp
Cj4gK3sKPiArICAgICAgIGVmaV9zdGF0dXNfdCByZXQ7Cj4gKyAgICAgICBzdHJ1Y3QgZWZpX21t
X2NvbW11bmljYXRlX2hlYWRlciAqbW1faGRyOwo+ICsgICAgICAgc3RydWN0IHNtbV92YXJpYWJs
ZV9jb21tdW5pY2F0ZV9oZWFkZXIgKnZhcl9oZHI7Cj4gKwo+ICsgICAgICAgZHNpemUgKz0gTU1f
Q09NTVVOSUNBVEVfSEVBREVSX1NJWkUgKyBNTV9WQVJJQUJMRV9DT01NVU5JQ0FURV9TSVpFOwo+
ICsgICAgICAgbW1faGRyID0gKHN0cnVjdCBlZmlfbW1fY29tbXVuaWNhdGVfaGVhZGVyICopY29t
bV9idWY7Cj4gKyAgICAgICB2YXJfaGRyID0gKHN0cnVjdCBzbW1fdmFyaWFibGVfY29tbXVuaWNh
dGVfaGVhZGVyICopbW1faGRyLT5kYXRhOwo+ICsKPiArICAgICAgIHJldCA9IHRlZV9tbV9jb21t
dW5pY2F0ZShjb21tX2J1ZiwgZHNpemUpOwo+ICsgICAgICAgaWYgKHJldCAhPSBFRklfU1VDQ0VT
Uykgewo+ICsgICAgICAgICAgICAgICBkZXZfZXJyKHB2dF9kYXRhLmRldiwgIiVzIGZhaWxlZCFc
biIsIF9fZnVuY19fKTsKPiArICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiArICAgICAgIH0K
PiArCj4gKyAgICAgICByZXR1cm4gdmFyX2hkci0+cmV0X3N0YXR1czsKPiArfQo+ICsKPiArLyoq
Cj4gKyAqIHNldHVwX21tX2hkcigpIC0gICAgQWxsb2NhdGUgYSBidWZmZXIgZm9yIFN0YW5kQWxv
bmVNTSBhbmQgaW5pdGlhbGl6ZSB0aGUKPiArICogICAgICAgICAgICAgICAgICAgICBoZWFkZXIg
ZGF0YS4KPiArICoKPiArICogQGRwdHI6ICAgICAgICAgICAgICBwb2ludGVyIGFkZHJlc3Mgb2Yg
dGhlIGNvcnJlc3BvbmRpbmcgU3RhbmRBbG9uZU1NCj4gKyAqICAgICAgICAgICAgICAgICAgICAg
ZnVuY3Rpb24KPiArICogQHBheWxvYWRfc2l6ZTogICAgICBidWZmZXIgc2l6ZQo+ICsgKiBAZnVu
YzogICAgICAgICAgICAgIHN0YW5kQWxvbmVNTSBmdW5jdGlvbiBudW1iZXIKPiArICogQHJldDog
ICAgICAgICAgICAgICBFRkkgcmV0dXJuIGNvZGUKPiArICogUmV0dXJuOiAgICAgICAgICAgICBi
dWZmZXIgb3IgTlVMTAo+ICsgKi8KPiArc3RhdGljIHU4ICpzZXR1cF9tbV9oZHIodm9pZCAqKmRw
dHIsIHNpemVfdCBwYXlsb2FkX3NpemUsIHNpemVfdCBmdW5jLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGVmaV9zdGF0dXNfdCAqcmV0KQo+ICt7Cj4gKyAgICAgICBjb25zdCBlZmlfZ3VpZF90
IG1tX3Zhcl9ndWlkID0gRUZJX01NX1ZBUklBQkxFX0dVSUQ7Cj4gKyAgICAgICBzdHJ1Y3QgZWZp
X21tX2NvbW11bmljYXRlX2hlYWRlciAqbW1faGRyOwo+ICsgICAgICAgc3RydWN0IHNtbV92YXJp
YWJsZV9jb21tdW5pY2F0ZV9oZWFkZXIgKnZhcl9oZHI7Cj4gKyAgICAgICB1OCAqY29tbV9idWY7
Cj4gKwo+ICsgICAgICAgLyogSW4gdGhlIGluaXQgZnVuY3Rpb24gd2UgaW5pdGlhbGl6ZSBtYXhf
YnVmZmVyX3NpemUgd2l0aAo+ICsgICAgICAgICogZ2V0X21heF9wYXlsb2FkKCkuIFNvIHNraXAg
dGhlIHRlc3QgaWYgbWF4X2J1ZmZlcl9zaXplIGlzIGluaXRpYWxpemVkCj4gKyAgICAgICAgKiBT
dGFuZEFsb25lTU0gd2lsbCBwZXJmb3JtIHNpbWlsYXIgY2hlY2tzIGFuZCBkcm9wIHRoZSBidWZm
ZXIgaWYgaXQncwo+ICsgICAgICAgICogdG9vIGxvbmcKPiArICAgICAgICAqLwo+ICsgICAgICAg
aWYgKG1heF9idWZmZXJfc2l6ZSAmJgo+ICsgICAgICAgICAgIG1heF9idWZmZXJfc2l6ZSA8IChN
TV9DT01NVU5JQ0FURV9IRUFERVJfU0laRSArCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIE1NX1ZBUklBQkxFX0NPTU1VTklDQVRFX1NJWkUgKyBwYXlsb2FkX3NpemUpKSB7Cj4gKyAg
ICAgICAgICAgICAgICpyZXQgPSBFRklfSU5WQUxJRF9QQVJBTUVURVI7Cj4gKyAgICAgICAgICAg
ICAgIHJldHVybiBOVUxMOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGNvbW1fYnVmID0ga3ph
bGxvYyhNTV9DT01NVU5JQ0FURV9IRUFERVJfU0laRSArCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBNTV9WQVJJQUJMRV9DT01NVU5JQ0FURV9TSVpFICsgcGF5bG9hZF9zaXpl
LAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgIEdGUF9LRVJORUwpOwo+ICsgICAgICAgaWYg
KCFjb21tX2J1Zikgewo+ICsgICAgICAgICAgICAgICAqcmV0ID0gRUZJX09VVF9PRl9SRVNPVVJD
RVM7Cj4gKyAgICAgICAgICAgICAgIHJldHVybiBOVUxMOwo+ICsgICAgICAgfQo+ICsKPiArICAg
ICAgIG1tX2hkciA9IChzdHJ1Y3QgZWZpX21tX2NvbW11bmljYXRlX2hlYWRlciAqKWNvbW1fYnVm
Owo+ICsgICAgICAgbWVtY3B5KCZtbV9oZHItPmhlYWRlcl9ndWlkLCAmbW1fdmFyX2d1aWQsIHNp
emVvZihtbV9oZHItPmhlYWRlcl9ndWlkKSk7Cj4gKyAgICAgICBtbV9oZHItPm1lc3NhZ2VfbGVu
ID0gTU1fVkFSSUFCTEVfQ09NTVVOSUNBVEVfU0laRSArIHBheWxvYWRfc2l6ZTsKPiArCj4gKyAg
ICAgICB2YXJfaGRyID0gKHN0cnVjdCBzbW1fdmFyaWFibGVfY29tbXVuaWNhdGVfaGVhZGVyICop
bW1faGRyLT5kYXRhOwo+ICsgICAgICAgdmFyX2hkci0+ZnVuY3Rpb24gPSBmdW5jOwo+ICsgICAg
ICAgaWYgKGRwdHIpCj4gKyAgICAgICAgICAgICAgICpkcHRyID0gdmFyX2hkci0+ZGF0YTsKPiAr
ICAgICAgICpyZXQgPSBFRklfU1VDQ0VTUzsKPiArCj4gKyAgICAgICByZXR1cm4gY29tbV9idWY7
Cj4gK30KPiArCj4gKy8qKgo+ICsgKiBnZXRfbWF4X3BheWxvYWQoKSAtIEdldCB2YXJpYWJsZSBw
YXlsb2FkIHNpemUgZnJvbSBTdGFuZEFsb25lTU0uCj4gKyAqCj4gKyAqIEBzaXplOiAgICBzaXpl
IG9mIHRoZSB2YXJpYWJsZSBpbiBzdG9yYWdlCj4gKyAqIFJldHVybjogICBzdGF0dXMgY29kZQo+
ICsgKi8KPiArc3RhdGljIGVmaV9zdGF0dXNfdCBnZXRfbWF4X3BheWxvYWQoc2l6ZV90ICpzaXpl
KQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3Qgc21tX3ZhcmlhYmxlX3BheWxvYWRfc2l6ZSAqdmFyX3Bh
eWxvYWQgPSBOVUxMOwo+ICsgICAgICAgc2l6ZV90IHBheWxvYWRfc2l6ZTsKPiArICAgICAgIHU4
ICpjb21tX2J1ZiA9IE5VTEw7Cj4gKyAgICAgICBlZmlfc3RhdHVzX3QgcmV0Owo+ICsKPiArICAg
ICAgIGlmICghc2l6ZSkgewo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklfSU5WQUxJRF9QQVJB
TUVURVI7Cj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsgICAgICAgfQo+ICsKPiArICAg
ICAgIHBheWxvYWRfc2l6ZSA9IHNpemVvZigqdmFyX3BheWxvYWQpOwo+ICsgICAgICAgY29tbV9i
dWYgPSBzZXR1cF9tbV9oZHIoKHZvaWQgKiopJnZhcl9wYXlsb2FkLCBwYXlsb2FkX3NpemUsCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTTU1fVkFSSUFCTEVfRlVOQ1RJT05fR0VU
X1BBWUxPQURfU0laRSwgJnJldCk7CgpUaGUgKHZvaWQgKiopIGNhc3QgaXMgYSBiaXQgdWdseS4g
SWYgaW5zdGVhZCB0aGUgcGF5bG9hZCBidWZmZXIgd2FzCnJldHVybmVkIGluIHRoZSByZXR1cm4g
dmFsdWUgYW5kICZjb21tX2J1ZiB3YXMgdGhlIGZpcnN0IGFyZ3VtZW50IHdlCndvdWxkbid0IG5l
ZWQgdG8gY2FzdCBhdCBhbGwuCgo+ICsgICAgICAgaWYgKCFjb21tX2J1ZikKPiArICAgICAgICAg
ICAgICAgZ290byBvdXQ7Cj4gKwo+ICsgICAgICAgcmV0ID0gbW1fY29tbXVuaWNhdGUoY29tbV9i
dWYsIHBheWxvYWRfc2l6ZSk7Cj4gKyAgICAgICBpZiAocmV0ICE9IEVGSV9TVUNDRVNTKQo+ICsg
ICAgICAgICAgICAgICBnb3RvIG91dDsKPiArCj4gKyAgICAgICAvKiBNYWtlIHN1cmUgdGhlIGJ1
ZmZlciBpcyBiaWcgZW5vdWdoIGZvciBzdG9yaW5nIHZhcmlhYmxlcyAqLwo+ICsgICAgICAgaWYg
KHZhcl9wYXlsb2FkLT5zaXplIDwgTU1fVkFSSUFCTEVfQUNDRVNTX0hFQURFUl9TSVpFICsgMHgy
MCkgewo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklfREVWSUNFX0VSUk9SOwo+ICsgICAgICAg
ICAgICAgICBnb3RvIG91dDsKPiArICAgICAgIH0KPiArICAgICAgICpzaXplID0gdmFyX3BheWxv
YWQtPnNpemU7Cj4gKyAgICAgICAvKgo+ICsgICAgICAgICogVGhlcmUgc2VlbXMgdG8gYmUgYSBi
dWcgaW4gRURLMiBtaXNjYWxjdWxhdGluZyB0aGUgYm91bmRhcmllcyBhbmQKPiArICAgICAgICAq
IHNpemUgY2hlY2tzLCBzbyBkZWR1Y3QgMiBtb3JlIGJ5dGVzIHRvIGZ1bGZpbGwgdGhpcyByZXF1
aXJlbWVudC4gRml4Cj4gKyAgICAgICAgKiBpdCB1cCBoZXJlIHRvIGVuc3VyZSBiYWNrd2FyZHMg
Y29tcGF0aWJpbGl0eSB3aXRoIG9sZGVyIHZlcnNpb25zCj4gKyAgICAgICAgKiAoY2YuIFN0YW5k
YWxvbmVNbVBrZy9Ecml2ZXJzL1N0YW5kYWxvbmVNbUNwdS9BQXJjaDY0L0V2ZW50SGFuZGxlLmMu
Cj4gKyAgICAgICAgKiBzaXplb2YgKEVGSV9NTV9DT01NVU5JQ0FURV9IRUFERVIpIGluc3RlYWQg
dGhlIHNpemUgbWludXMgdGhlCj4gKyAgICAgICAgKiBmbGV4aWJsZSBhcnJheSBtZW1iZXIpLgo+
ICsgICAgICAgICoKPiArICAgICAgICAqIHNpemUgaXMgZ3VhcmFudGVlZCB0byBiZSA+IDIgZHVl
IHRvIGNoZWNrcyBvbiB0aGUgYmVnaW5uaW5nLgo+ICsgICAgICAgICovCj4gKyAgICAgICAqc2l6
ZSAtPSAyOwo+ICtvdXQ6Cj4gKyAgICAgICBrZnJlZShjb21tX2J1Zik7Cj4gKyAgICAgICByZXR1
cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgZWZpX3N0YXR1c190IGdldF9wcm9wZXJ0eV9pbnQo
dTE2ICpuYW1lLCBzaXplX3QgbmFtZV9zaXplLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBlZmlfZ3VpZF90ICp2ZW5kb3IsCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCB2YXJfY2hlY2tfcHJvcGVydHkgKnZhcl9wcm9wZXJ0
eSkKPiArewo+ICsgICAgICAgc3RydWN0IHNtbV92YXJpYWJsZV92YXJfY2hlY2tfcHJvcGVydHkg
KnNtbV9wcm9wZXJ0eTsKPiArICAgICAgIHNpemVfdCBwYXlsb2FkX3NpemU7Cj4gKyAgICAgICB1
OCAqY29tbV9idWYgPSBOVUxMOwo+ICsgICAgICAgZWZpX3N0YXR1c190IHJldDsKPiArCj4gKyAg
ICAgICBtZW1zZXQodmFyX3Byb3BlcnR5LCAwLCBzaXplb2YoKnZhcl9wcm9wZXJ0eSkpOwo+ICsg
ICAgICAgcGF5bG9hZF9zaXplID0gc2l6ZW9mKCpzbW1fcHJvcGVydHkpICsgbmFtZV9zaXplOwo+
ICsgICAgICAgaWYgKHBheWxvYWRfc2l6ZSA+IG1heF9wYXlsb2FkX3NpemUpIHsKPiArICAgICAg
ICAgICAgICAgcmV0ID0gRUZJX0lOVkFMSURfUEFSQU1FVEVSOwo+ICsgICAgICAgICAgICAgICBn
b3RvIG91dDsKPiArICAgICAgIH0KPiArICAgICAgIGNvbW1fYnVmID0gc2V0dXBfbW1faGRyKAo+
ICsgICAgICAgICAgICAgICAodm9pZCAqKikmc21tX3Byb3BlcnR5LCBwYXlsb2FkX3NpemUsCj4g
KyAgICAgICAgICAgICAgIFNNTV9WQVJJQUJMRV9GVU5DVElPTl9WQVJfQ0hFQ0tfVkFSSUFCTEVf
UFJPUEVSVFlfR0VULCAmcmV0KTsKPiArICAgICAgIGlmICghY29tbV9idWYpCj4gKyAgICAgICAg
ICAgICAgIGdvdG8gb3V0Owo+ICsKPiArICAgICAgIG1lbWNweSgmc21tX3Byb3BlcnR5LT5ndWlk
LCB2ZW5kb3IsIHNpemVvZihzbW1fcHJvcGVydHktPmd1aWQpKTsKPiArICAgICAgIHNtbV9wcm9w
ZXJ0eS0+bmFtZV9zaXplID0gbmFtZV9zaXplOwo+ICsgICAgICAgbWVtY3B5KHNtbV9wcm9wZXJ0
eS0+bmFtZSwgbmFtZSwgbmFtZV9zaXplKTsKPiArCj4gKyAgICAgICByZXQgPSBtbV9jb21tdW5p
Y2F0ZShjb21tX2J1ZiwgcGF5bG9hZF9zaXplKTsKPiArICAgICAgIC8qCj4gKyAgICAgICAgKiBD
dXJyZW50bHkgb25seSBSL08gcHJvcGVydHkgaXMgc3VwcG9ydGVkIGluIFN0TU0uCj4gKyAgICAg
ICAgKiBWYXJpYWJsZXMgdGhhdCBhcmUgbm90IHNldCB0byBSL08gd2lsbCBub3Qgc2V0IHRoZSBw
cm9wZXJ0eSBpbiBTdE1NCj4gKyAgICAgICAgKiBhbmQgdGhlIGNhbGwgd2lsbCByZXR1cm4gRUZJ
X05PVF9GT1VORC4gV2UgYXJlIHNldHRpbmcgdGhlCj4gKyAgICAgICAgKiBwcm9wZXJ0aWVzIHRv
IDB4MCBzbyBjaGVja2luZyBhZ2FpbnN0IHRoYXQgaXMgZW5vdWdoIGZvciB0aGUKPiArICAgICAg
ICAqIEVGSV9OT1RfRk9VTkQgY2FzZS4KPiArICAgICAgICAqLwo+ICsgICAgICAgaWYgKHJldCA9
PSBFRklfTk9UX0ZPVU5EKQo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklfU1VDQ0VTUzsKPiAr
ICAgICAgIGlmIChyZXQgIT0gRUZJX1NVQ0NFU1MpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0
Owo+ICsgICAgICAgbWVtY3B5KHZhcl9wcm9wZXJ0eSwgJnNtbV9wcm9wZXJ0eS0+cHJvcGVydHks
IHNpemVvZigqdmFyX3Byb3BlcnR5KSk7Cj4gKwo+ICtvdXQ6Cj4gKyAgICAgICBrZnJlZShjb21t
X2J1Zik7Cj4gKyAgICAgICByZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgZWZpX3N0YXR1
c190IHRlZV9nZXRfdmFyaWFibGUodTE2ICpuYW1lLCBlZmlfZ3VpZF90ICp2ZW5kb3IsCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiAqYXR0cmlidXRlcywgdW5zaWdu
ZWQgbG9uZyAqZGF0YV9zaXplLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB2b2lkICpkYXRhKQo+ICt7Cj4gKyAgICAgICBzdHJ1Y3QgdmFyX2NoZWNrX3Byb3BlcnR5IHZh
cl9wcm9wZXJ0eTsKPiArICAgICAgIHN0cnVjdCBzbW1fdmFyaWFibGVfYWNjZXNzICp2YXJfYWNj
Owo+ICsgICAgICAgc2l6ZV90IHBheWxvYWRfc2l6ZTsKPiArICAgICAgIHNpemVfdCBuYW1lX3Np
emU7Cj4gKyAgICAgICBzaXplX3QgdG1wX2RzaXplOwo+ICsgICAgICAgdTggKmNvbW1fYnVmID0g
TlVMTDsKPiArICAgICAgIGVmaV9zdGF0dXNfdCByZXQ7Cj4gKwo+ICsgICAgICAgaWYgKCFuYW1l
IHx8ICF2ZW5kb3IgfHwgIWRhdGFfc2l6ZSkgewo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklf
SU5WQUxJRF9QQVJBTUVURVI7Cj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsgICAgICAg
fQo+ICsKPiArICAgICAgIG5hbWVfc2l6ZSA9ICh1Y3MyX3N0cm5sZW4obmFtZSwgRUZJX1ZBUl9O
QU1FX0xFTikgKyAxKSAqIHNpemVvZih1MTYpOwo+ICsgICAgICAgaWYgKG5hbWVfc2l6ZSA+IG1h
eF9wYXlsb2FkX3NpemUgLSBNTV9WQVJJQUJMRV9BQ0NFU1NfSEVBREVSX1NJWkUpIHsKPiArICAg
ICAgICAgICAgICAgcmV0ID0gRUZJX0lOVkFMSURfUEFSQU1FVEVSOwo+ICsgICAgICAgICAgICAg
ICBnb3RvIG91dDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICAvKiBUcmltIG91dHB1dCBidWZm
ZXIgc2l6ZSAqLwo+ICsgICAgICAgdG1wX2RzaXplID0gKmRhdGFfc2l6ZTsKPiArICAgICAgIGlm
IChuYW1lX3NpemUgKyB0bXBfZHNpemUgPgo+ICsgICAgICAgICAgIG1heF9wYXlsb2FkX3NpemUg
LSBNTV9WQVJJQUJMRV9BQ0NFU1NfSEVBREVSX1NJWkUpIHsKPiArICAgICAgICAgICAgICAgdG1w
X2RzaXplID0gbWF4X3BheWxvYWRfc2l6ZSAtIE1NX1ZBUklBQkxFX0FDQ0VTU19IRUFERVJfU0la
RSAtCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVfc2l6ZTsKPiArICAgICAgIH0K
PiArCj4gKyAgICAgICAvKiBHZXQgY29tbXVuaWNhdGlvbiBidWZmZXIgYW5kIGluaXRpYWxpemUg
aGVhZGVyICovCj4gKyAgICAgICBwYXlsb2FkX3NpemUgPSBNTV9WQVJJQUJMRV9BQ0NFU1NfSEVB
REVSX1NJWkUgKyBuYW1lX3NpemUgKyB0bXBfZHNpemU7Cj4gKyAgICAgICBjb21tX2J1ZiA9IHNl
dHVwX21tX2hkcigodm9pZCAqKikmdmFyX2FjYywgcGF5bG9hZF9zaXplLAo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgU01NX1ZBUklBQkxFX0ZVTkNUSU9OX0dFVF9WQVJJQUJMRSwg
JnJldCk7Cj4gKyAgICAgICBpZiAoIWNvbW1fYnVmKQo+ICsgICAgICAgICAgICAgICBnb3RvIG91
dDsKPiArCj4gKyAgICAgICAvKiBGaWxsIGluIGNvbnRlbnRzICovCj4gKyAgICAgICBtZW1jcHko
JnZhcl9hY2MtPmd1aWQsIHZlbmRvciwgc2l6ZW9mKHZhcl9hY2MtPmd1aWQpKTsKPiArICAgICAg
IHZhcl9hY2MtPmRhdGFfc2l6ZSA9IHRtcF9kc2l6ZTsKPiArICAgICAgIHZhcl9hY2MtPm5hbWVf
c2l6ZSA9IG5hbWVfc2l6ZTsKPiArICAgICAgIHZhcl9hY2MtPmF0dHIgPSBhdHRyaWJ1dGVzID8g
KmF0dHJpYnV0ZXMgOiAwOwo+ICsgICAgICAgbWVtY3B5KHZhcl9hY2MtPm5hbWUsIG5hbWUsIG5h
bWVfc2l6ZSk7Cj4gKwo+ICsgICAgICAgLyogQ29tbXVuaWNhdGUgKi8KPiArICAgICAgIHJldCA9
IG1tX2NvbW11bmljYXRlKGNvbW1fYnVmLCBwYXlsb2FkX3NpemUpOwo+ICsgICAgICAgaWYgKHJl
dCA9PSBFRklfU1VDQ0VTUyB8fCByZXQgPT0gRUZJX0JVRkZFUl9UT09fU01BTEwpCj4gKyAgICAg
ICAgICAgICAgIC8qIFVwZGF0ZSB3aXRoIHJlcG9ydGVkIGRhdGEgc2l6ZSBmb3IgdHJpbW1lZCBj
YXNlICovCj4gKyAgICAgICAgICAgICAgICpkYXRhX3NpemUgPSB2YXJfYWNjLT5kYXRhX3NpemU7
Cj4gKyAgICAgICBpZiAocmV0ICE9IEVGSV9TVUNDRVNTKQo+ICsgICAgICAgICAgICAgICBnb3Rv
IG91dDsKPiArCj4gKyAgICAgICByZXQgPSBnZXRfcHJvcGVydHlfaW50KG5hbWUsIG5hbWVfc2l6
ZSwgdmVuZG9yLCAmdmFyX3Byb3BlcnR5KTsKPiArICAgICAgIGlmIChyZXQgIT0gRUZJX1NVQ0NF
U1MpCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsKPiArICAgICAgIGlmIChhdHRyaWJ1
dGVzKQo+ICsgICAgICAgICAgICAgICAqYXR0cmlidXRlcyA9IHZhcl9hY2MtPmF0dHI7Cj4gKwo+
ICsgICAgICAgaWYgKGRhdGEpCj4gKyAgICAgICAgICAgICAgIG1lbWNweShkYXRhLCAodTggKil2
YXJfYWNjLT5uYW1lICsgdmFyX2FjYy0+bmFtZV9zaXplLAo+ICsgICAgICAgICAgICAgICAgICAg
ICAgdmFyX2FjYy0+ZGF0YV9zaXplKTsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAg
cmV0ID0gRUZJX0lOVkFMSURfUEFSQU1FVEVSOwo+ICsKPiArb3V0Ogo+ICsgICAgICAga2ZyZWUo
Y29tbV9idWYpOwo+ICsgICAgICAgcmV0dXJuIHJldDsKPiArfQo+ICsKPiArc3RhdGljIGVmaV9z
dGF0dXNfdCB0ZWVfZ2V0X25leHRfdmFyaWFibGUodW5zaWduZWQgbG9uZyAqbmFtZV9zaXplLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVmaV9jaGFyMTZfdCAq
bmFtZSwgZWZpX2d1aWRfdCAqZ3VpZCkKPiArewo+ICsgICAgICAgc3RydWN0IHNtbV92YXJpYWJs
ZV9nZXRuZXh0ICp2YXJfZ2V0bmV4dDsKPiArICAgICAgIHNpemVfdCBwYXlsb2FkX3NpemU7Cj4g
KyAgICAgICBzaXplX3Qgb3V0X25hbWVfc2l6ZTsKPiArICAgICAgIHNpemVfdCBpbl9uYW1lX3Np
emU7Cj4gKyAgICAgICB1OCAqY29tbV9idWYgPSBOVUxMOwo+ICsgICAgICAgZWZpX3N0YXR1c190
IHJldDsKPiArCj4gKyAgICAgICBpZiAoIW5hbWVfc2l6ZSB8fCAhbmFtZSB8fCAhZ3VpZCkgewo+
ICsgICAgICAgICAgICAgICByZXQgPSBFRklfSU5WQUxJRF9QQVJBTUVURVI7Cj4gKyAgICAgICAg
ICAgICAgIGdvdG8gb3V0Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIG91dF9uYW1lX3NpemUg
PSAqbmFtZV9zaXplOwo+ICsgICAgICAgaW5fbmFtZV9zaXplID0gKHVjczJfc3RybmxlbihuYW1l
LCBFRklfVkFSX05BTUVfTEVOKSArIDEpICogc2l6ZW9mKHUxNik7Cj4gKwo+ICsgICAgICAgaWYg
KG91dF9uYW1lX3NpemUgPCBpbl9uYW1lX3NpemUpIHsKPiArICAgICAgICAgICAgICAgcmV0ID0g
RUZJX0lOVkFMSURfUEFSQU1FVEVSOwo+ICsgICAgICAgICAgICAgICBnb3RvIG91dDsKPiArICAg
ICAgIH0KPiArCj4gKyAgICAgICBpZiAoaW5fbmFtZV9zaXplID4KPiArICAgICAgICAgICBtYXhf
cGF5bG9hZF9zaXplIC0gTU1fVkFSSUFCTEVfR0VUX05FWFRfSEVBREVSX1NJWkUpIHsKPiArICAg
ICAgICAgICAgICAgcmV0ID0gRUZJX0lOVkFMSURfUEFSQU1FVEVSOwo+ICsgICAgICAgICAgICAg
ICBnb3RvIG91dDsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICAvKiBUcmltIG91dHB1dCBidWZm
ZXIgc2l6ZSAqLwo+ICsgICAgICAgaWYgKG91dF9uYW1lX3NpemUgPiBtYXhfcGF5bG9hZF9zaXpl
IC0gTU1fVkFSSUFCTEVfR0VUX05FWFRfSEVBREVSX1NJWkUpCj4gKyAgICAgICAgICAgICAgIG91
dF9uYW1lX3NpemUgPQo+ICsgICAgICAgICAgICAgICAgICAgICAgIG1heF9wYXlsb2FkX3NpemUg
LSBNTV9WQVJJQUJMRV9HRVRfTkVYVF9IRUFERVJfU0laRTsKPiArCj4gKyAgICAgICBwYXlsb2Fk
X3NpemUgPSBNTV9WQVJJQUJMRV9HRVRfTkVYVF9IRUFERVJfU0laRSArIG91dF9uYW1lX3NpemU7
Cj4gKyAgICAgICBjb21tX2J1ZiA9IHNldHVwX21tX2hkcigodm9pZCAqKikmdmFyX2dldG5leHQs
IHBheWxvYWRfc2l6ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNNTV9WQVJJ
QUJMRV9GVU5DVElPTl9HRVRfTkVYVF9WQVJJQUJMRV9OQU1FLAo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgJnJldCk7Cj4gKyAgICAgICBpZiAoIWNvbW1fYnVmKQo+ICsgICAgICAg
ICAgICAgICBnb3RvIG91dDsKPiArCj4gKyAgICAgICAvKiBGaWxsIGluIGNvbnRlbnRzICovCj4g
KyAgICAgICBtZW1jcHkoJnZhcl9nZXRuZXh0LT5ndWlkLCBndWlkLCBzaXplb2YodmFyX2dldG5l
eHQtPmd1aWQpKTsKPiArICAgICAgIHZhcl9nZXRuZXh0LT5uYW1lX3NpemUgPSBvdXRfbmFtZV9z
aXplOwo+ICsgICAgICAgbWVtY3B5KHZhcl9nZXRuZXh0LT5uYW1lLCBuYW1lLCBpbl9uYW1lX3Np
emUpOwo+ICsgICAgICAgbWVtc2V0KCh1OCAqKXZhcl9nZXRuZXh0LT5uYW1lICsgaW5fbmFtZV9z
aXplLCAweDAsCj4gKyAgICAgICAgICAgICAgb3V0X25hbWVfc2l6ZSAtIGluX25hbWVfc2l6ZSk7
Cj4gKwo+ICsgICAgICAgLyogQ29tbXVuaWNhdGUgKi8KPiArICAgICAgIHJldCA9IG1tX2NvbW11
bmljYXRlKGNvbW1fYnVmLCBwYXlsb2FkX3NpemUpOwo+ICsgICAgICAgaWYgKHJldCA9PSBFRklf
U1VDQ0VTUyB8fCByZXQgPT0gRUZJX0JVRkZFUl9UT09fU01BTEwpIHsKPiArICAgICAgICAgICAg
ICAgLyogVXBkYXRlIHdpdGggcmVwb3J0ZWQgZGF0YSBzaXplIGZvciB0cmltbWVkIGNhc2UgKi8K
PiArICAgICAgICAgICAgICAgKm5hbWVfc2l6ZSA9IHZhcl9nZXRuZXh0LT5uYW1lX3NpemU7Cj4g
KyAgICAgICB9Cj4gKyAgICAgICBpZiAocmV0ICE9IEVGSV9TVUNDRVNTKQo+ICsgICAgICAgICAg
ICAgICBnb3RvIG91dDsKPiArCj4gKyAgICAgICBtZW1jcHkoZ3VpZCwgJnZhcl9nZXRuZXh0LT5n
dWlkLCBzaXplb2YoKmd1aWQpKTsKPiArICAgICAgIG1lbWNweShuYW1lLCB2YXJfZ2V0bmV4dC0+
bmFtZSwgdmFyX2dldG5leHQtPm5hbWVfc2l6ZSk7Cj4gKwo+ICtvdXQ6Cj4gKyAgICAgICBrZnJl
ZShjb21tX2J1Zik7Cj4gKyAgICAgICByZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgZWZp
X3N0YXR1c190IHRlZV9zZXRfdmFyaWFibGUoZWZpX2NoYXIxNl90ICpuYW1lLCBlZmlfZ3VpZF90
ICp2ZW5kb3IsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBhdHRy
aWJ1dGVzLCB1bnNpZ25lZCBsb25nIGRhdGFfc2l6ZSwKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgdm9pZCAqZGF0YSkKPiArewo+ICsgICAgICAgZWZpX3N0YXR1c190IHJl
dDsKPiArICAgICAgIHN0cnVjdCB2YXJfY2hlY2tfcHJvcGVydHkgdmFyX3Byb3BlcnR5Owo+ICsg
ICAgICAgc3RydWN0IHNtbV92YXJpYWJsZV9hY2Nlc3MgKnZhcl9hY2M7Cj4gKyAgICAgICBzaXpl
X3QgcGF5bG9hZF9zaXplOwo+ICsgICAgICAgc2l6ZV90IG5hbWVfc2l6ZTsKPiArICAgICAgIHU4
ICpjb21tX2J1ZiA9IE5VTEw7Cj4gKwo+ICsgICAgICAgaWYgKCFuYW1lIHx8IG5hbWVbMF0gPT0g
MCB8fCAhdmVuZG9yKSB7Cj4gKyAgICAgICAgICAgICAgIHJldCA9IEVGSV9JTlZBTElEX1BBUkFN
RVRFUjsKPiArICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gKyAgICAgICB9Cj4gKyAgICAgICBp
ZiAoZGF0YV9zaXplID4gMCAmJiAhZGF0YSkgewo+ICsgICAgICAgICAgICAgICByZXQgPSBFRklf
SU5WQUxJRF9QQVJBTUVURVI7Cj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsgICAgICAg
fQo+ICsgICAgICAgLyogQ2hlY2sgcGF5bG9hZCBzaXplICovCj4gKyAgICAgICBuYW1lX3NpemUg
PSAodWNzMl9zdHJubGVuKG5hbWUsIEVGSV9WQVJfTkFNRV9MRU4pICsgMSkgKiBzaXplb2YodTE2
KTsKPiArICAgICAgIHBheWxvYWRfc2l6ZSA9IE1NX1ZBUklBQkxFX0FDQ0VTU19IRUFERVJfU0la
RSArIG5hbWVfc2l6ZSArIGRhdGFfc2l6ZTsKPiArICAgICAgIGlmIChwYXlsb2FkX3NpemUgPiBt
YXhfcGF5bG9hZF9zaXplKSB7Cj4gKyAgICAgICAgICAgICAgIHJldCA9IEVGSV9JTlZBTElEX1BB
UkFNRVRFUjsKPiArICAgICAgICAgICAgICAgZ290byBvdXQ7Cj4gKyAgICAgICB9Cj4gKwo+ICsg
ICAgICAgLyoKPiArICAgICAgICAqIEFsbG9jYXRlIHRoZSBidWZmZXIgZWFybHksIGJlZm9yZSBz
d2l0Y2hpbmcgdG8gUlcgKGlmIG5lZWRlZCkKPiArICAgICAgICAqIHNvIHdlIHdvbid0IG5lZWQg
dG8gYWNjb3VudCBmb3IgYW55IGZhaWx1cmVzIGluIHJlYWRpbmcvc2V0dGluZwo+ICsgICAgICAg
ICogdGhlIHByb3BlcnRpZXMsIGlmIHRoZSBhbGxvY2F0aW9uIGZhaWxzCj4gKyAgICAgICAgKi8K
PiArICAgICAgIGNvbW1fYnVmID0gc2V0dXBfbW1faGRyKCh2b2lkICoqKSZ2YXJfYWNjLCBwYXls
b2FkX3NpemUsCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTTU1fVkFSSUFCTEVf
RlVOQ1RJT05fU0VUX1ZBUklBQkxFLCAmcmV0KTsKPiArICAgICAgIGlmICghY29tbV9idWYpCj4g
KyAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsKPiArICAgICAgIC8qCj4gKyAgICAgICAgKiBU
aGUgQVBJIGhhcyB0aGUgYWJpbGl0eSB0byBvdmVycmlkZSBSTyBmbGFncy4gSWYgbm8gUk8gY2hl
Y2sgd2FzCj4gKyAgICAgICAgKiByZXF1ZXN0ZWQgc3dpdGNoIHRoZSB2YXJpYWJsZSB0byBSVyBm
b3IgdGhlIGR1cmF0aW9uIG9mIHRoaXMgY2FsbAo+ICsgICAgICAgICovCj4gKyAgICAgICByZXQg
PSBnZXRfcHJvcGVydHlfaW50KG5hbWUsIG5hbWVfc2l6ZSwgdmVuZG9yLCAmdmFyX3Byb3BlcnR5
KTsKPiArICAgICAgIGlmIChyZXQgIT0gRUZJX1NVQ0NFU1MpIHsKPiArICAgICAgICAgICAgICAg
ZGV2X2VycihwdnRfZGF0YS5kZXYsICJHZXR0aW5nIHZhcmlhYmxlIHByb3BlcnR5IGZhaWxlZFxu
Iik7Cj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAg
IGlmICh2YXJfcHJvcGVydHkucHJvcGVydHkgJiBWQVJfQ0hFQ0tfVkFSSUFCTEVfUFJPUEVSVFlf
UkVBRF9PTkxZKSB7Cj4gKyAgICAgICAgICAgICAgIHJldCA9IEVGSV9XUklURV9QUk9URUNURUQ7
Cj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Owo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIC8q
IEZpbGwgaW4gY29udGVudHMgKi8KPiArICAgICAgIG1lbWNweSgmdmFyX2FjYy0+Z3VpZCwgdmVu
ZG9yLCBzaXplb2YodmFyX2FjYy0+Z3VpZCkpOwo+ICsgICAgICAgdmFyX2FjYy0+ZGF0YV9zaXpl
ID0gZGF0YV9zaXplOwo+ICsgICAgICAgdmFyX2FjYy0+bmFtZV9zaXplID0gbmFtZV9zaXplOwo+
ICsgICAgICAgdmFyX2FjYy0+YXR0ciA9IGF0dHJpYnV0ZXM7Cj4gKyAgICAgICBtZW1jcHkodmFy
X2FjYy0+bmFtZSwgbmFtZSwgbmFtZV9zaXplKTsKPiArICAgICAgIG1lbWNweSgodTggKil2YXJf
YWNjLT5uYW1lICsgbmFtZV9zaXplLCBkYXRhLCBkYXRhX3NpemUpOwo+ICsKPiArCj4gKyAgICAg
ICAvKiBDb21tdW5pY2F0ZSAqLwo+ICsgICAgICAgcmV0ID0gbW1fY29tbXVuaWNhdGUoY29tbV9i
dWYsIHBheWxvYWRfc2l6ZSk7Cj4gKyAgICAgICBkZXZfZGJnKHB2dF9kYXRhLmRldiwgIlNldCBW
YXJpYWJsZSAlcyAlZCAlbHhcbiIsIF9fRklMRV9fLCBfX0xJTkVfXywgcmV0KTsKPiArb3V0Ogo+
ICsgICAgICAga2ZyZWUoY29tbV9idWYpOwo+ICsgICAgICAgcmV0dXJuIHJldDsKPiArfQo+ICsK
PiArc3RhdGljIGVmaV9zdGF0dXNfdCBfX21heWJlX3VudXNlZCB0ZWVfcXVlcnlfdmFyaWFibGVf
aW5mbyh1MzIgYXR0cmlidXRlcywKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHU2NCAqbWF4X3ZhcmlhYmxlX3N0b3JhZ2Vfc2l6ZSwKPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU2NCAqcmVtYWluX3ZhcmlhYmxlX3N0b3Jh
Z2Vfc2l6ZSwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHU2
NCAqbWF4X3ZhcmlhYmxlX3NpemUpCj4gK3sKPiArICAgICAgIHN0cnVjdCBzbW1fdmFyaWFibGVf
cXVlcnlfaW5mbyAqbW1fcXVlcnlfaW5mbzsKPiArICAgICAgIHNpemVfdCBwYXlsb2FkX3NpemU7
Cj4gKyAgICAgICBlZmlfc3RhdHVzX3QgcmV0Owo+ICsgICAgICAgdTggKmNvbW1fYnVmOwo+ICsK
PiArICAgICAgIHBheWxvYWRfc2l6ZSA9IHNpemVvZigqbW1fcXVlcnlfaW5mbyk7Cj4gKyAgICAg
ICBjb21tX2J1ZiA9IHNldHVwX21tX2hkcigodm9pZCAqKikmbW1fcXVlcnlfaW5mbywgcGF5bG9h
ZF9zaXplLAo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU01NX1ZBUklBQkxFX0ZV
TkNUSU9OX1FVRVJZX1ZBUklBQkxFX0lORk8sCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAmcmV0KTsKPiArICAgICAgIGlmICghY29tbV9idWYpCj4gKyAgICAgICAgICAgICAgIGdv
dG8gb3V0Owo+ICsKPiArICAgICAgIG1tX3F1ZXJ5X2luZm8tPmF0dHIgPSBhdHRyaWJ1dGVzOwo+
ICsgICAgICAgcmV0ID0gbW1fY29tbXVuaWNhdGUoY29tbV9idWYsIHBheWxvYWRfc2l6ZSk7Cj4g
KyAgICAgICBpZiAocmV0ICE9IEVGSV9TVUNDRVNTKQo+ICsgICAgICAgICAgICAgICBnb3RvIG91
dDsKPiArICAgICAgICptYXhfdmFyaWFibGVfc3RvcmFnZV9zaXplID0gbW1fcXVlcnlfaW5mby0+
bWF4X3ZhcmlhYmxlX3N0b3JhZ2U7Cj4gKyAgICAgICAqcmVtYWluX3ZhcmlhYmxlX3N0b3JhZ2Vf
c2l6ZSA9Cj4gKyAgICAgICAgICAgICAgIG1tX3F1ZXJ5X2luZm8tPnJlbWFpbmluZ192YXJpYWJs
ZV9zdG9yYWdlOwo+ICsgICAgICAgKm1heF92YXJpYWJsZV9zaXplID0gbW1fcXVlcnlfaW5mby0+
bWF4X3ZhcmlhYmxlX3NpemU7Cj4gKwo+ICtvdXQ6Cj4gKyAgICAgICBrZnJlZShjb21tX2J1Zik7
Cj4gKyAgICAgICByZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IHRlZV9zdG1tX2Vm
aV9wcm9iZShzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sKPiArICAgICAgIHN0cnVjdCB0ZWVfaW9j
dGxfb3Blbl9zZXNzaW9uX2FyZyBzZXNzX2FyZzsKPiArICAgICAgIGVmaV9zdGF0dXNfdCByZXQ7
Cj4gKyAgICAgICBpbnQgcmM7Cj4gKwo+ICsgICAgICAgLyogT3BlbiBjb250ZXh0IHdpdGggVEVF
IGRyaXZlciAqLwo+ICsgICAgICAgcHZ0X2RhdGEuY3R4ID0gdGVlX2NsaWVudF9vcGVuX2NvbnRl
eHQoTlVMTCwgdGVlX2N0eF9tYXRjaCwgTlVMTCwgTlVMTCk7Cj4gKyAgICAgICBpZiAoSVNfRVJS
KHB2dF9kYXRhLmN0eCkpCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PREVWOwo+ICsKPiAr
ICAgICAgIC8qIE9wZW4gc2Vzc2lvbiB3aXRoIFN0TU0gUFRBICovCj4gKyAgICAgICBtZW1zZXQo
JnNlc3NfYXJnLCAwLCBzaXplb2Yoc2Vzc19hcmcpKTsKPiArICAgICAgIGV4cG9ydF91dWlkKHNl
c3NfYXJnLnV1aWQsICZ0ZWVfc3RtbV9lZmlfaWRfdGFibGVbMF0udXVpZCk7Cj4gKyAgICAgICBy
YyA9IHRlZV9jbGllbnRfb3Blbl9zZXNzaW9uKHB2dF9kYXRhLmN0eCwgJnNlc3NfYXJnLCBOVUxM
KTsKPiArICAgICAgIGlmICgocmMgPCAwKSB8fCAoc2Vzc19hcmcucmV0ICE9IDApKSB7Cj4gKyAg
ICAgICAgICAgICAgIGRldl9lcnIoZGV2LCAidGVlX2NsaWVudF9vcGVuX3Nlc3Npb24gZmFpbGVk
LCBlcnI6ICV4XG4iLAo+ICsgICAgICAgICAgICAgICAgICAgICAgIHNlc3NfYXJnLnJldCk7Cj4g
KyAgICAgICAgICAgICAgIHJjID0gLUVJTlZBTDsKPiArICAgICAgICAgICAgICAgZ290byBvdXRf
Y3R4Owo+ICsgICAgICAgfQo+ICsgICAgICAgcHZ0X2RhdGEuc2Vzc2lvbiA9IHNlc3NfYXJnLnNl
c3Npb247Cj4gKyAgICAgICBwdnRfZGF0YS5kZXYgPSBkZXY7Cj4gKwo+ICsgICAgICAgcmV0ID0g
Z2V0X21heF9wYXlsb2FkKCZtYXhfcGF5bG9hZF9zaXplKTsKPiArICAgICAgIGlmIChyZXQgIT0g
RUZJX1NVQ0NFU1MpIHsKPiArICAgICAgICAgICAgICAgcmMgPSAtRUlPOwo+ICsgICAgICAgICAg
ICAgICBnb3RvIG91dF9zZXNzOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIG1heF9idWZmZXJf
c2l6ZSA9IE1NX0NPTU1VTklDQVRFX0hFQURFUl9TSVpFICsKPiArICAgICAgICAgICAgICAgICAg
ICAgICAgIE1NX1ZBUklBQkxFX0NPTU1VTklDQVRFX1NJWkUgKwo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgbWF4X3BheWxvYWRfc2l6ZTsKPiArCj4gKyAgICAgICB0ZWVfZWZpdmFyX29wcy5n
ZXRfdmFyaWFibGUgPSB0ZWVfZ2V0X3ZhcmlhYmxlOwo+ICsgICAgICAgdGVlX2VmaXZhcl9vcHMu
Z2V0X25leHRfdmFyaWFibGUgPSB0ZWVfZ2V0X25leHRfdmFyaWFibGU7Cj4gKyAgICAgICB0ZWVf
ZWZpdmFyX29wcy5zZXRfdmFyaWFibGUgPSB0ZWVfc2V0X3ZhcmlhYmxlOwo+ICsgICAgICAgLyog
VE9ETzogc3VwcG9ydCBub24tYmxvY2tpbmcgdmFyaWFudCAqLwo+ICsgICAgICAgdGVlX2VmaXZh
cl9vcHMuc2V0X3ZhcmlhYmxlX25vbmJsb2NraW5nID0gTlVMTDsKPiArICAgICAgIHRlZV9lZml2
YXJfb3BzLnF1ZXJ5X3ZhcmlhYmxlX3N0b3JlID0gZWZpX3F1ZXJ5X3ZhcmlhYmxlX3N0b3JlOwo+
ICsKPiArICAgICAgIGVmaXZhcnNfZ2VuZXJpY19vcHNfdW5yZWdpc3RlcigpOwo+ICsgICAgICAg
cHJfaW5mbygiVXNlIHRlZS1iYXNlZCBFRkkgcnVudGltZSB2YXJpYWJsZSBzZXJ2aWNlc1xuIik7
Cj4gKyAgICAgICBlZml2YXJzX3JlZ2lzdGVyKCZ0ZWVfZWZpdmFycywgJnRlZV9lZml2YXJfb3Bz
KTsKPiArCj4gKyAgICAgICByZXR1cm4gMDsKPiArCj4gK291dF9zZXNzOgo+ICsgICAgICAgdGVl
X2NsaWVudF9jbG9zZV9zZXNzaW9uKHB2dF9kYXRhLmN0eCwgcHZ0X2RhdGEuc2Vzc2lvbik7Cj4g
K291dF9jdHg6Cj4gKyAgICAgICB0ZWVfY2xpZW50X2Nsb3NlX2NvbnRleHQocHZ0X2RhdGEuY3R4
KTsKPiArCj4gKyAgICAgICByZXR1cm4gcmM7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgdGVlX3N0
bW1fZWZpX3JlbW92ZShzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sKPiArICAgICAgIGVmaXZhcnNf
dW5yZWdpc3RlcigmdGVlX2VmaXZhcnMpOwo+ICsgICAgICAgZWZpdmFyc19nZW5lcmljX29wc19y
ZWdpc3RlcigpOwo+ICsKPiArICAgICAgIHRlZV9jbGllbnRfY2xvc2Vfc2Vzc2lvbihwdnRfZGF0
YS5jdHgsIHB2dF9kYXRhLnNlc3Npb24pOwo+ICsgICAgICAgdGVlX2NsaWVudF9jbG9zZV9jb250
ZXh0KHB2dF9kYXRhLmN0eCk7Cj4gKwo+ICsgICAgICAgcmV0dXJuIDA7Cj4gK30KPiArCj4gK01P
RFVMRV9ERVZJQ0VfVEFCTEUodGVlLCB0ZWVfc3RtbV9lZmlfaWRfdGFibGUpOwo+ICsKPiArc3Rh
dGljIHN0cnVjdCB0ZWVfY2xpZW50X2RyaXZlciB0ZWVfc3RtbV9lZmlfZHJpdmVyID0gewo+ICsg
ICAgICAgLmlkX3RhYmxlICAgICAgID0gdGVlX3N0bW1fZWZpX2lkX3RhYmxlLAo+ICsgICAgICAg
LmRyaXZlciAgICAgICAgID0gewo+ICsgICAgICAgICAgICAgICAubmFtZSAgICAgICAgICAgPSAi
dGVlLXN0bW0tZWZpIiwKPiArICAgICAgICAgICAgICAgLmJ1cyAgICAgICAgICAgID0gJnRlZV9i
dXNfdHlwZSwKPiArICAgICAgICAgICAgICAgLnByb2JlICAgICAgICAgID0gdGVlX3N0bW1fZWZp
X3Byb2JlLAo+ICsgICAgICAgICAgICAgICAucmVtb3ZlICAgICAgICAgPSB0ZWVfc3RtbV9lZmlf
cmVtb3ZlLAo+ICsgICAgICAgfSwKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQgX19pbml0IHRlZV9z
dG1tX2VmaV9tb2RfaW5pdCh2b2lkKQo+ICt7Cj4gKyAgICAgICByZXR1cm4gZHJpdmVyX3JlZ2lz
dGVyKCZ0ZWVfc3RtbV9lZmlfZHJpdmVyLmRyaXZlcik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lk
IF9fZXhpdCB0ZWVfc3RtbV9lZmlfbW9kX2V4aXQodm9pZCkKPiArewo+ICsgICAgICAgZHJpdmVy
X3VucmVnaXN0ZXIoJnRlZV9zdG1tX2VmaV9kcml2ZXIuZHJpdmVyKTsKPiArfQo+ICsKPiArbW9k
dWxlX2luaXQodGVlX3N0bW1fZWZpX21vZF9pbml0KTsKPiArbW9kdWxlX2V4aXQodGVlX3N0bW1f
ZWZpX21vZF9leGl0KTsKPiArCj4gK01PRFVMRV9MSUNFTlNFKCJHUEwiKTsKPiArTU9EVUxFX0FV
VEhPUigiSWxpYXMgQXBhbG9kaW1hcyA8aWxpYXMuYXBhbG9kaW1hc0BsaW5hcm8ub3JnPiIpOwo+
ICtNT0RVTEVfQVVUSE9SKCJNYXNhaGlzYSBLb2ppbWEgPG1hc2FoaXNhLmtvamltYUBsaW5hcm8u
b3JnPiIpOwo+ICtNT0RVTEVfREVTQ1JJUFRJT04oIlRFRSBiYXNlZCBFRkkgcnVudGltZSB2YXJp
YWJsZSBzZXJ2aWNlIGRyaXZlciIpOwo+IC0tCj4gMi4zMC4yCj4KClRoZSBURUUgQVBJIHVzYWdl
IGxvb2tzIE9LIGluIHRoaXMgcGF0Y2guCgpDaGVlcnMsCkplbnMKX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGludXgtc3RtMzIgbWFpbGluZyBsaXN0Ckxp
bnV4LXN0bTMyQHN0LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5jb20KaHR0cHM6Ly9zdC1tZC1tYWls
bWFuLnN0b3JtcmVwbHkuY29tL21haWxtYW4vbGlzdGluZm8vbGludXgtc3RtMzIK
