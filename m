Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 4AD233E4050
	for <lists+linux-stm32@lfdr.de>; Mon,  9 Aug 2021 08:42:29 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id E6BC6C5A4D4;
	Mon,  9 Aug 2021 06:42:28 +0000 (UTC)
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 08869C57182
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Sun,  8 Aug 2021 17:20:42 +0000 (UTC)
Received: from jic23-huawei (cpc108967-cmbg20-2-0-cust86.5-4.cable.virginm.net
 [81.101.6.87])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id A12E460F0F;
 Sun,  8 Aug 2021 17:20:35 +0000 (UTC)
Date: Sun, 8 Aug 2021 18:23:25 +0100
From: Jonathan Cameron <jic23@kernel.org>
To: William Breathitt Gray <vilhelm.gray@gmail.com>
Message-ID: <20210808182325.2620de00@jic23-huawei>
In-Reply-To: <2df092636a9eea5a3ddae1e9a6429e32b51284f7.1627990337.git.vilhelm.gray@gmail.com>
References: <cover.1627990337.git.vilhelm.gray@gmail.com>
 <2df092636a9eea5a3ddae1e9a6429e32b51284f7.1627990337.git.vilhelm.gray@gmail.com>
X-Mailer: Claws Mail 4.0.0 (GTK+ 3.24.30; x86_64-pc-linux-gnu)
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 09 Aug 2021 06:42:28 +0000
Cc: kamel.bouhara@bootlin.com, gwendal@chromium.org, david@lechnology.com,
 linux-iio@vger.kernel.org, patrick.havelange@essensium.com,
 alexandre.belloni@bootlin.com, mcoquelin.stm32@gmail.com,
 linux-kernel@vger.kernel.org, o.rempel@pengutronix.de,
 jarkko.nikula@linux.intel.com, Dan Carpenter <dan.carpenter@oracle.com>,
 kernel@pengutronix.de, fabrice.gasnier@st.com, syednwaris@gmail.com,
 linux-stm32@st-md-mailman.stormreply.com, linux-arm-kernel@lists.infradead.org,
 alexandre.torgue@st.com
Subject: Re: [Linux-stm32] [PATCH v14 06/17] counter: Internalize sysfs
	interface code
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

T24gVHVlLCAgMyBBdWcgMjAyMSAyMTowNjoxNiArMDkwMApXaWxsaWFtIEJyZWF0aGl0dCBHcmF5
IDx2aWxoZWxtLmdyYXlAZ21haWwuY29tPiB3cm90ZToKCj4gVGhpcyBpcyBhIHJlaW1wbGVtZW50
YXRpb24gb2YgdGhlIEdlbmVyaWMgQ291bnRlciBkcml2ZXIgaW50ZXJmYWNlLgo+IFRoZXJlIGFy
ZSBubyBtb2RpZmljYXRpb25zIHRvIHRoZSBDb3VudGVyIHN1YnN5c3RlbSB1c2Vyc3BhY2UgaW50
ZXJmYWNlLAo+IHNvIGV4aXN0aW5nIHVzZXJzcGFjZSBhcHBsaWNhdGlvbnMgc2hvdWxkIGNvbnRp
bnVlIHRvIHJ1biBzZWFtbGVzc2x5Lgo+IAo+IFRoZSBwdXJwb3NlIG9mIHRoaXMgcGF0Y2ggaXMg
dG8gaW50ZXJuYWxpemUgdGhlIHN5c2ZzIGludGVyZmFjZSBjb2RlCj4gYW1vbmcgdGhlIHZhcmlv
dXMgY291bnRlciBkcml2ZXJzIGludG8gYSBzaGFyZWQgbW9kdWxlLiBDb3VudGVyIGRyaXZlcnMK
PiBwYXNzIGFuZCB0YWtlIGRhdGEgbmF0aXZlbHkgKGkuZS4gdTgsIHU2NCwgZXRjLikgYW5kIHRo
ZSBzaGFyZWQgY291bnRlcgo+IG1vZHVsZSBoYW5kbGVzIHRoZSB0cmFuc2xhdGlvbiBiZXR3ZWVu
IHRoZSBzeXNmcyBpbnRlcmZhY2UgYW5kIHRoZQo+IGRldmljZSBkcml2ZXJzLiBUaGlzIGd1YXJh
bnRlZXMgYSBzdGFuZGFyZCB1c2Vyc3BhY2UgaW50ZXJmYWNlIGZvciBhbGwKPiBjb3VudGVyIGRy
aXZlcnMsIGFuZCBoZWxwcyBnZW5lcmFsaXplIHRoZSBHZW5lcmljIENvdW50ZXIgZHJpdmVyIEFC
SSBpbgo+IG9yZGVyIHRvIHN1cHBvcnQgdGhlIEdlbmVyaWMgQ291bnRlciBjaHJkZXYgaW50ZXJm
YWNlIChpbnRyb2R1Y2VkIGluIGEKPiBzdWJzZXF1ZW50IHBhdGNoKSB3aXRob3V0IHNpZ25pZmlj
YW50IGNoYW5nZXMgdG8gdGhlIGV4aXN0aW5nIGNvdW50ZXIKPiBkcml2ZXJzLgo+IAo+IE5vdGUs
IENvdW50ZXIgZGV2aWNlIHJlZ2lzdHJhdGlvbiBpcyB0aGUgc2FtZSBhcyBiZWZvcmU6IGRyaXZl
cnMKPiBwb3B1bGF0ZSBhIHN0cnVjdCBjb3VudGVyX2RldmljZSB3aXRoIGNvbXBvbmVudHMgYW5k
IGNhbGxiYWNrcywgdGhlbgo+IHBhc3MgdGhlIHN0cnVjdHVyZSB0byB0aGUgZGV2bV9jb3VudGVy
X3JlZ2lzdGVyIGZ1bmN0aW9uLiBIb3dldmVyLAo+IHdoYXQncyBkaWZmZXJlbnQgbm93IGlzIGhv
dyB0aGUgQ291bnRlciBzdWJzeXN0ZW0gY29kZSBoYW5kbGVzIHRoaXMKPiByZWdpc3RyYXRpb24g
aW50ZXJuYWxseS4KPiAKPiBXaGVyZWFzIGJlZm9yZSBjYWxsYmFja3Mgd291bGQgaW50ZXJhY3Qg
ZGlyZWN0bHkgd2l0aCBzeXNmcyBkYXRhLCB0aGlzCj4gaW50ZXJhY3Rpb24gaXMgbm93IGFic3Ry
YWN0ZWQgYW5kIGluc3RlYWQgY2FsbGJhY2tzIGludGVyYWN0IHdpdGggbmF0aXZlCj4gQyBkYXRh
IHR5cGVzLiBUaGUgY291bnRlcl9jb21wIHN0cnVjdHVyZSBmb3JtcyB0aGUgYmFzaXMgZm9yIENv
dW50ZXIKPiBleHRlbnNpb25zLgo+IAo+IFRoZSBjb3VudGVyLXN5c2ZzLmMgZmlsZSBjb250YWlu
cyB0aGUgY29kZSB0byBwYXJzZSB0aHJvdWdoIHRoZQo+IGNvdW50ZXJfZGV2aWNlIHN0cnVjdHVy
ZSBhbmQgcmVnaXN0ZXIgdGhlIHJlcXVlc3RlZCBjb21wb25lbnRzIGFuZAo+IGV4dGVuc2lvbnMu
IEF0dHJpYnV0ZXMgYXJlIGNyZWF0ZWQgYW5kIHBvcHVsYXRlZCBiYXNlZCBvbiB0eXBlLCB3aXRo
Cj4gcmVzcGVjdGl2ZSB0cmFuc2xhdGlvbiBmdW5jdGlvbnMgdG8gaGFuZGxlIHRoZSBtYXBwaW5n
IGJldHdlZW4gc3lzZnMgYW5kCj4gdGhlIGNvdW50ZXIgZHJpdmVyIGNhbGxiYWNrcy4KPiAKPiBU
aGUgdHJhbnNsYXRpb24gcGVyZm9ybWVkIGZvciBlYWNoIGF0dHJpYnV0ZSBpcyBzdHJhaWdodGZv
cndhcmQ6IHRoZQo+IGF0dHJpYnV0ZSB0eXBlIGFuZCBkYXRhIGlzIHBhcnNlZCBmcm9tIHRoZSBj
b3VudGVyX2F0dHJpYnV0ZSBzdHJ1Y3R1cmUsCj4gdGhlIHJlc3BlY3RpdmUgY291bnRlciBkcml2
ZXIgcmVhZC93cml0ZSBjYWxsYmFjayBpcyBjYWxsZWQsIGFuZCBzeXNmcwo+IEkvTyBpcyBoYW5k
bGVkIGJlZm9yZSBvciBhZnRlciB0aGUgZHJpdmVyIHJlYWQvd3JpdGUgZnVuY3Rpb24gaXMgY2Fs
bGVkLgoKSGkgV2lsbGlhbSwKClRoZXJlIGFyZSBzb21lIGlzc3VlcyB3aXRoIHRoaXMgZXZlbiBh
ZnRlciBJJ3ZlIGZpeGVkIHRoZSBtZXJnZSBjb25mbGljdApiZWNhdXNlIG9mIHRoZSBlYXJsaWVy
IGNoYW5nZS4uCgogREVTQ0VORCBvYmp0b29sCiAgQ0FMTCAgICBzY3JpcHRzL2F0b21pYy9jaGVj
ay1hdG9taWNzLnNoCiAgQ0FMTCAgICBzY3JpcHRzL2NoZWNrc3lzY2FsbHMuc2gKICBDSEsgICAg
IGluY2x1ZGUvZ2VuZXJhdGVkL2NvbXBpbGUuaAogIENDIFtNXSAgZHJpdmVycy9jb3VudGVyL2Nv
dW50ZXItY29yZS5vCiAgQ0MgW01dICBkcml2ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5vCiAg
Q0MgW01dICBkcml2ZXJzL2NvdW50ZXIvMTA0LXF1YWQtOC5vCiAgQ0MgW01dICBkcml2ZXJzL2Nv
dW50ZXIvaW50ZXJydXB0LWNudC5vCiAgQ0MgW01dICBkcml2ZXJzL2NvdW50ZXIvc3RtMzItdGlt
ZXItY250Lm8KICBDQyBbTV0gIGRyaXZlcnMvY291bnRlci9zdG0zMi1scHRpbWVyLWNudC5vCmRy
aXZlcnMvY291bnRlci9jb3VudGVyLWNvcmUuYzogSW4gZnVuY3Rpb24g4oCYY291bnRlcl9kZXZp
Y2VfcmVsZWFzZeKAmToKZHJpdmVycy9jb3VudGVyL2NvdW50ZXItY29yZS5jOjIzOjk6IGVycm9y
OiBpbXBsaWNpdCBkZWNsYXJhdGlvbiBvZiBmdW5jdGlvbiDigJhjb3VudGVyX2NocmRldl9yZW1v
dmXigJkgWy1XZXJyb3I9aW1wbGljaXQtZnVuY3Rpb24tZGVjbGFyYXRpb25dCiAgIDIzIHwgICAg
ICAgICBjb3VudGVyX2NocmRldl9yZW1vdmUoY291bnRlcik7CiAgICAgIHwgICAgICAgICBefn5+
fn5+fn5+fn5+fn5+fn5+fn4KY2MxOiBzb21lIHdhcm5pbmdzIGJlaW5nIHRyZWF0ZWQgYXMgZXJy
b3JzCm1ha2VbMl06ICoqKiBbc2NyaXB0cy9NYWtlZmlsZS5idWlsZDoyNzE6IGRyaXZlcnMvY291
bnRlci9jb3VudGVyLWNvcmUub10gRXJyb3IgMQptYWtlWzJdOiAqKiogV2FpdGluZyBmb3IgdW5m
aW5pc2hlZCBqb2JzLi4uLgogIENIRUNLICAgZHJpdmVycy9jb3VudGVyL2ludGVycnVwdC1jbnQu
YwogIENIRUNLICAgZHJpdmVycy9jb3VudGVyLzEwNC1xdWFkLTguYwogIENIRUNLICAgZHJpdmVy
cy9jb3VudGVyL2NvdW50ZXItc3lzZnMuYwpkcml2ZXJzL2NvdW50ZXIvc3RtMzItdGltZXItY250
LmM6NTU6OTogd2FybmluZzogaW1wbGljaXQgY29udmVyc2lvbiBmcm9tIOKAmGVudW0gc3RtMzJf
Y291bnRfZnVuY3Rpb27igJkgdG8g4oCYZW51bSBjb3VudGVyX2Z1bmN0aW9u4oCZIFstV2VudW0t
Y29udmVyc2lvbl0KICAgNTUgfCAgICAgICAgIFNUTTMyX0NPVU5UX1NMQVZFX01PREVfRElTQUJM
RUQsCiAgICAgIHwgICAgICAgICBefn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+CmRyaXZl
cnMvY291bnRlci9zdG0zMi10aW1lci1jbnQuYzo1Njo5OiB3YXJuaW5nOiBpbXBsaWNpdCBjb252
ZXJzaW9uIGZyb20g4oCYZW51bSBzdG0zMl9jb3VudF9mdW5jdGlvbuKAmSB0byDigJhlbnVtIGNv
dW50ZXJfZnVuY3Rpb27igJkgWy1XZW51bS1jb252ZXJzaW9uXQogICA1NiB8ICAgICAgICAgU1RN
MzJfQ09VTlRfRU5DT0RFUl9NT0RFXzEsCiAgICAgIHwgICAgICAgICBefn5+fn5+fn5+fn5+fn5+
fn5+fn5+fn5+fgpkcml2ZXJzL2NvdW50ZXIvc3RtMzItdGltZXItY250LmM6NTc6OTogd2Fybmlu
ZzogaW1wbGljaXQgY29udmVyc2lvbiBmcm9tIOKAmGVudW0gc3RtMzJfY291bnRfZnVuY3Rpb27i
gJkgdG8g4oCYZW51bSBjb3VudGVyX2Z1bmN0aW9u4oCZIFstV2VudW0tY29udmVyc2lvbl0KICAg
NTcgfCAgICAgICAgIFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yLAogICAgICB8ICAgICAgICAg
Xn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4KZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNu
dC5jOjU4Ojk6IHdhcm5pbmc6IGltcGxpY2l0IGNvbnZlcnNpb24gZnJvbSDigJhlbnVtIHN0bTMy
X2NvdW50X2Z1bmN0aW9u4oCZIHRvIOKAmGVudW0gY291bnRlcl9mdW5jdGlvbuKAmSBbLVdlbnVt
LWNvbnZlcnNpb25dCiAgIDU4IHwgICAgICAgICBTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMywK
ICAgICAgfCAgICAgICAgIF5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+CmRyaXZlcnMvY291bnRl
ci9zdG0zMi10aW1lci1jbnQuYzogSW4gZnVuY3Rpb24g4oCYc3RtMzJfY291bnRfZnVuY3Rpb25f
cmVhZOKAmToKZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jOjk3OjI3OiB3YXJuaW5n
OiBpbXBsaWNpdCBjb252ZXJzaW9uIGZyb20g4oCYZW51bSBzdG0zMl9jb3VudF9mdW5jdGlvbuKA
mSB0byDigJhlbnVtIGNvdW50ZXJfZnVuY3Rpb27igJkgWy1XZW51bS1jb252ZXJzaW9uXQogICA5
NyB8ICAgICAgICAgICAgICAgICAqZnVuY3Rpb24gPSBTVE0zMl9DT1VOVF9TTEFWRV9NT0RFX0RJ
U0FCTEVEOwogICAgICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgXgpkcml2ZXJzL2NvdW50
ZXIvc3RtMzItdGltZXItY250LmM6MTAwOjI3OiB3YXJuaW5nOiBpbXBsaWNpdCBjb252ZXJzaW9u
IGZyb20g4oCYZW51bSBzdG0zMl9jb3VudF9mdW5jdGlvbuKAmSB0byDigJhlbnVtIGNvdW50ZXJf
ZnVuY3Rpb27igJkgWy1XZW51bS1jb252ZXJzaW9uXQogIDEwMCB8ICAgICAgICAgICAgICAgICAq
ZnVuY3Rpb24gPSBTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMTsKICAgICAgfCAgICAgICAgICAg
ICAgICAgICAgICAgICAgIF4KZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jOjEwMzoy
Nzogd2FybmluZzogaW1wbGljaXQgY29udmVyc2lvbiBmcm9tIOKAmGVudW0gc3RtMzJfY291bnRf
ZnVuY3Rpb27igJkgdG8g4oCYZW51bSBjb3VudGVyX2Z1bmN0aW9u4oCZIFstV2VudW0tY29udmVy
c2lvbl0KICAxMDMgfCAgICAgICAgICAgICAgICAgKmZ1bmN0aW9uID0gU1RNMzJfQ09VTlRfRU5D
T0RFUl9NT0RFXzI7CiAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICBeCmRyaXZlcnMv
Y291bnRlci9zdG0zMi10aW1lci1jbnQuYzoxMDY6Mjc6IHdhcm5pbmc6IGltcGxpY2l0IGNvbnZl
cnNpb24gZnJvbSDigJhlbnVtIHN0bTMyX2NvdW50X2Z1bmN0aW9u4oCZIHRvIOKAmGVudW0gY291
bnRlcl9mdW5jdGlvbuKAmSBbLVdlbnVtLWNvbnZlcnNpb25dCiAgMTA2IHwgICAgICAgICAgICAg
ICAgICpmdW5jdGlvbiA9IFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zOwogICAgICB8ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgXgpkcml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQu
YzoxMzk6OTogd2FybmluZzogaW1wbGljaXQgY29udmVyc2lvbiBmcm9tIOKAmGVudW0gc3RtMzJf
bHB0aW1fY250X2Z1bmN0aW9u4oCZIHRvIOKAmGVudW0gY291bnRlcl9mdW5jdGlvbuKAmSBbLVdl
bnVtLWNvbnZlcnNpb25dCiAgMTM5IHwgICAgICAgICBTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JF
QVNFLAogICAgICB8ICAgICAgICAgXn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fgpkcml2ZXJz
L2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYzoxNDA6OTogd2FybmluZzogaW1wbGljaXQgY29u
dmVyc2lvbiBmcm9tIOKAmGVudW0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9u4oCZIHRvIOKAmGVu
dW0gY291bnRlcl9mdW5jdGlvbuKAmSBbLVdlbnVtLWNvbnZlcnNpb25dCiAgMTQwIHwgICAgICAg
ICBTVE0zMl9MUFRJTV9FTkNPREVSX0JPVEhfRURHRSwKICAgICAgfCAgICAgICAgIF5+fn5+fn5+
fn5+fn5+fn5+fn5+fn5+fn5+fn5+CmRyaXZlcnMvY291bnRlci9zdG0zMi1scHRpbWVyLWNudC5j
OiBJbiBmdW5jdGlvbiDigJhzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fcmVhZOKAmToKZHJpdmVy
cy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmM6MTk1OjI3OiB3YXJuaW5nOiBpbXBsaWNpdCBj
b252ZXJzaW9uIGZyb20g4oCYZW51bSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb27igJkgdG8g4oCY
ZW51bSBjb3VudGVyX2Z1bmN0aW9u4oCZIFstV2VudW0tY29udmVyc2lvbl0KICAxOTUgfCAgICAg
ICAgICAgICAgICAgKmZ1bmN0aW9uID0gU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRTsKICAg
ICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgIF4KZHJpdmVycy9jb3VudGVyL3N0bTMyLWxw
dGltZXItY250LmM6MjAwOjI3OiB3YXJuaW5nOiBpbXBsaWNpdCBjb252ZXJzaW9uIGZyb20g4oCY
ZW51bSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb27igJkgdG8g4oCYZW51bSBjb3VudGVyX2Z1bmN0
aW9u4oCZIFstV2VudW0tY29udmVyc2lvbl0KICAyMDAgfCAgICAgICAgICAgICAgICAgKmZ1bmN0
aW9uID0gU1RNMzJfTFBUSU1fRU5DT0RFUl9CT1RIX0VER0U7CiAgICAgIHwgICAgICAgICAgICAg
ICAgICAgICAgICAgICBeCmRyaXZlcnMvY291bnRlci8xMDQtcXVhZC04LmM6NTg6IHdhcm5pbmc6
IEZ1bmN0aW9uIHBhcmFtZXRlciBvciBtZW1iZXIgJ2xvY2snIG5vdCBkZXNjcmliZWQgaW4gJ3F1
YWQ4JwogIENIRUNLICAgZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jCiAgQ0hFQ0sg
ICBkcml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYwptYWtlWzFdOiAqKiogW3Njcmlw
dHMvTWFrZWZpbGUuYnVpbGQ6NTE0OiBkcml2ZXJzL2NvdW50ZXJdIEVycm9yIDIKbWFrZTogKioq
IFtNYWtlZmlsZToxODQxOiBkcml2ZXJzXSBFcnJvciAyCgpJIGNvdWxkIHdhaXQgdGhyb3VnaCB0
aGVzZSBidXQgaXQgZmVlbHMgYSBsaXR0bGUgdG8gbGlrZWx5IEknbGwgbWVzcyBzb21ldGhpbmcg
dXAgZml4aW5nIHRoaW5ncwpzbyBwbGVhc2UgZml4IHRoZSBlcnJvcnMgYW5kIHdhcm5pbmdzIHRo
aXMgcGF0Y2ggaW50cm9kdWNlcwp3aXRoIGEgVz0xIEM9MSBidWlsZC4KCkFsc28sIGRvIGEgcGF0
Y2ggYnkgcGF0Y2ggYnVpbGQgb2YgdGhlIHJlc3Qgb2YgdGhlIHNldCBpbiBjYXNlIHRoZXJlIGFy
ZSBhbnkgb3RoZXIgY2FzZXMKbGlrZSB0aGlzIGhpZGluZy4gIEl0J3MgdmVyeSBlYXN5IGZvciB0
aGVzZSB0byBidWlsZCB1cCB3aGVuIHlvdSBoYXZlIGEgbG90IG9mCnZlcnNpb25zIG9mIGEgcGF0
Y2ggc2VyaWVzLiAgSSd2ZSBiZWVuIGNhdWdodCBvdXQgYSBmZXcgdGltZXMgbXlzZWxmIQoKSW4g
dGhlIG1lYW50aW1lLCBJJ2xsIGtlZXAgdGhlIGZpcnN0IDUgcGF0Y2hlcyBvbiBteSB0cmVlIHVu
bGVzcyB5b3Ugc2hvdXQgb3RoZXJ3aXNlLgoKVGhhbmtzLAoKSm9uYXRoYW4KPiAKPiBDYzogSmFy
a2tvIE5pa3VsYSA8amFya2tvLm5pa3VsYUBsaW51eC5pbnRlbC5jb20+Cj4gQ2M6IFBhdHJpY2sg
SGF2ZWxhbmdlIDxwYXRyaWNrLmhhdmVsYW5nZUBlc3NlbnNpdW0uY29tPgo+IENjOiBLYW1lbCBC
b3VoYXJhIDxrYW1lbC5ib3VoYXJhQGJvb3RsaW4uY29tPgo+IENjOiBGYWJyaWNlIEdhc25pZXIg
PGZhYnJpY2UuZ2FzbmllckBzdC5jb20+Cj4gQ2M6IE1heGltZSBDb3F1ZWxpbiA8bWNvcXVlbGlu
LnN0bTMyQGdtYWlsLmNvbT4KPiBDYzogQWxleGFuZHJlIFRvcmd1ZSA8YWxleGFuZHJlLnRvcmd1
ZUBzdC5jb20+Cj4gQ2M6IERhbiBDYXJwZW50ZXIgPGRhbi5jYXJwZW50ZXJAb3JhY2xlLmNvbT4K
PiBBY2tlZC1ieTogU3llZCBOYXl5YXIgV2FyaXMgPHN5ZWRud2FyaXNAZ21haWwuY29tPgo+IFJl
dmlld2VkLWJ5OiBEYXZpZCBMZWNobmVyIDxkYXZpZEBsZWNobm9sb2d5LmNvbT4KPiBUZXN0ZWQt
Ynk6IERhdmlkIExlY2huZXIgPGRhdmlkQGxlY2hub2xvZ3kuY29tPgo+IFNpZ25lZC1vZmYtYnk6
IFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkgPHZpbGhlbG0uZ3JheUBnbWFpbC5jb20+Cj4gLS0tCj4g
IE1BSU5UQUlORVJTICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgIDEgLQo+ICBkcml2
ZXJzL2NvdW50ZXIvMTA0LXF1YWQtOC5jICAgICAgICAgICAgfCAgNDQ5ICsrKy0tLS0KPiAgZHJp
dmVycy9jb3VudGVyL01ha2VmaWxlICAgICAgICAgICAgICAgIHwgICAgMSArCj4gIGRyaXZlcnMv
Y291bnRlci9jb3VudGVyLWNvcmUuYyAgICAgICAgICB8ICAxNDUgKysrCj4gIGRyaXZlcnMvY291
bnRlci9jb3VudGVyLXN5c2ZzLmMgICAgICAgICB8ICA4NTIgKysrKysrKysrKysrKwo+ICBkcml2
ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5oICAgICAgICAgfCAgIDEzICsKPiAgZHJpdmVycy9j
b3VudGVyL2NvdW50ZXIuYyAgICAgICAgICAgICAgIHwgMTQ5NiAtLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQo+ICBkcml2ZXJzL2NvdW50ZXIvZnRtLXF1YWRkZWMuYyAgICAgICAgICAgfCAgIDU2ICst
Cj4gIGRyaXZlcnMvY291bnRlci9pbnRlbC1xZXAuYyAgICAgICAgICAgICB8ICAxNDQgKy0tCj4g
IGRyaXZlcnMvY291bnRlci9pbnRlcnJ1cHQtY250LmMgICAgICAgICB8ICAgNjIgKy0KPiAgZHJp
dmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2FwdHVyZS5jIHwgICA5MyArLQo+ICBkcml2ZXJz
L2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYyAgICAgfCAgMTk3ICstLQo+ICBkcml2ZXJzL2Nv
dW50ZXIvc3RtMzItdGltZXItY250LmMgICAgICAgfCAgMTQ3ICstLQo+ICBkcml2ZXJzL2NvdW50
ZXIvdGktZXFlcC5jICAgICAgICAgICAgICAgfCAgMTgwICstLQo+ICBpbmNsdWRlL2xpbnV4L2Nv
dW50ZXIuaCAgICAgICAgICAgICAgICAgfCAgNjU4ICsrKysrLS0tLS0KPiAgaW5jbHVkZS9saW51
eC9jb3VudGVyX2VudW0uaCAgICAgICAgICAgIHwgICA0NSAtCj4gIDE2IGZpbGVzIGNoYW5nZWQs
IDE5NTkgaW5zZXJ0aW9ucygrKSwgMjU4MCBkZWxldGlvbnMoLSkKPiAgY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLWNvcmUuYwo+ICBjcmVhdGUgbW9kZSAxMDA2NDQg
ZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuYwo+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuaAo+ICBkZWxldGUgbW9kZSAxMDA2NDQgZHJpdmVy
cy9jb3VudGVyL2NvdW50ZXIuYwo+ICBkZWxldGUgbW9kZSAxMDA2NDQgaW5jbHVkZS9saW51eC9j
b3VudGVyX2VudW0uaAo+IAo+IGRpZmYgLS1naXQgYS9NQUlOVEFJTkVSUyBiL01BSU5UQUlORVJT
Cj4gaW5kZXggYTYxZjRmM2I3OGE5Li42ODQ3MmFkNDdkY2YgMTAwNjQ0Cj4gLS0tIGEvTUFJTlRB
SU5FUlMKPiArKysgYi9NQUlOVEFJTkVSUwo+IEBAIC00NzY0LDcgKzQ3NjQsNiBAQCBGOglEb2N1
bWVudGF0aW9uL0FCSS90ZXN0aW5nL3N5c2ZzLWJ1cy1jb3VudGVyCj4gIEY6CURvY3VtZW50YXRp
b24vZHJpdmVyLWFwaS9nZW5lcmljLWNvdW50ZXIucnN0Cj4gIEY6CWRyaXZlcnMvY291bnRlci8K
PiAgRjoJaW5jbHVkZS9saW51eC9jb3VudGVyLmgKPiAtRjoJaW5jbHVkZS9saW51eC9jb3VudGVy
X2VudW0uaAo+ICAKPiAgQ1AyNjE1IEkyQyBEUklWRVIKPiAgTToJQmVuY2UgQ3PDs2vDoXMgPGJl
bmNlOThAc2NoLmJtZS5odT4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyLzEwNC1xdWFk
LTguYyBiL2RyaXZlcnMvY291bnRlci8xMDQtcXVhZC04LmMKPiBpbmRleCA1MjgzZmYxMjhjMTcu
LmQxMTYxYzI3YzQ4OCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvMTA0LXF1YWQtOC5j
Cj4gKysrIGIvZHJpdmVycy9jb3VudGVyLzEwNC1xdWFkLTguYwo+IEBAIC0xMTYsNyArMTE2LDcg
QEAgc3RhdGljIGludCBxdWFkOF9zaWduYWxfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQgcXVhZDhfY291bnRfcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHVu
c2lnbmVkIGxvbmcgKnZhbCkKPiArCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwg
dTY0ICp2YWwpCj4gIHsKPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnBy
aXY7Cj4gIAljb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsgMiAqIGNvdW50LT5p
ZDsKPiBAQCAtMTQ3LDcgKzE0Nyw3IEBAIHN0YXRpYyBpbnQgcXVhZDhfY291bnRfcmVhZChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQgcXVhZDhf
Y291bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nIHZhbCkKPiArCQkJICAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsIHU2NCB2YWwpCj4gIHsKPiAgCXN0cnVjdCBxdWFkOCAqY29u
c3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAljb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2
LT5iYXNlICsgMiAqIGNvdW50LT5pZDsKPiBAQCAtMTg3LDIyICsxODcsMTYgQEAgc3RhdGljIGlu
dCBxdWFkOF9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAly
ZXR1cm4gMDsKPiAgfQo+ICAKPiAtZW51bSBxdWFkOF9jb3VudF9mdW5jdGlvbiB7Cj4gLQlRVUFE
OF9DT1VOVF9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04gPSAwLAo+IC0JUVVBRDhfQ09VTlRfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YMSwKPiAtCVFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDIsCj4gLQlRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Cj4gLX07Cj4gLQo+ICBz
dGF0aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uIHF1YWQ4X2NvdW50X2Z1bmN0aW9uc19s
aXN0W10gPSB7Cj4gLQlbUVVBRDhfQ09VTlRfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OXSA9IENP
VU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OLAo+IC0JW1FVQUQ4X0NPVU5UX0ZVTkNUSU9O
X1FVQURSQVRVUkVfWDFdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0EsCj4gLQlb
UVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl0gPSBDT1VOVEVSX0ZVTkNUSU9OX1FV
QURSQVRVUkVfWDJfQSwKPiAtCVtRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1g0XSA9
IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNAo+ICsJQ09VTlRFUl9GVU5DVElPTl9QVUxT
RV9ESVJFQ1RJT04sCj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQSwKPiArCUNP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0LAo+ICB9Owo+ICAKPiAtc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl9nZXQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50LCBzaXplX3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IHF1YWQ4X2Z1bmN0aW9uX3JlYWQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkgICAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAo+ICsJCQkgICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5j
dGlvbikKPiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsK
PiAgCWNvbnN0IGludCBpZCA9IGNvdW50LT5pZDsKPiBAQCAtMjEyLDI1ICsyMDYsMjYgQEAgc3Rh
dGljIGludCBxdWFkOF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICAJaWYgKHByaXYtPnF1YWRyYXR1cmVfbW9kZVtpZF0pCj4gIAkJc3dpdGNoIChwcml2LT5x
dWFkcmF0dXJlX3NjYWxlW2lkXSkgewo+ICAJCWNhc2UgMDoKPiAtCQkJKmZ1bmN0aW9uID0gUVVB
RDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMTsKPiArCQkJKmZ1bmN0aW9uID0gQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0E7Cj4gIAkJCWJyZWFrOwo+ICAJCWNhc2UgMToKPiAt
CQkJKmZ1bmN0aW9uID0gUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMjsKPiArCQkJ
KmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0E7Cj4gIAkJCWJyZWFr
Owo+ICAJCWNhc2UgMjoKPiAtCQkJKmZ1bmN0aW9uID0gUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YNDsKPiArCQkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJF
X1g0Owo+ICAJCQlicmVhazsKPiAgCQl9Cj4gIAllbHNlCj4gLQkJKmZ1bmN0aW9uID0gUVVBRDhf
Q09VTlRfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOwo+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJf
RlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOwo+ICAKPiAgCW11dGV4X3VubG9jaygmcHJpdi0+bG9j
ayk7Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgcXVhZDhfZnVuY3Rp
b25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwgc2l6ZV90IGZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IHF1YWQ4X2Z1bmN0
aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCXN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlv
bikKPiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAg
CWNvbnN0IGludCBpZCA9IGNvdW50LT5pZDsKPiBAQCAtMjQ2LDcgKzI0MSw3IEBAIHN0YXRpYyBp
bnQgcXVhZDhfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAg
CW1vZGVfY2ZnID0gcHJpdi0+Y291bnRfbW9kZVtpZF0gPDwgMTsKPiAgCWlkcl9jZmcgPSBwcml2
LT5pbmRleF9wb2xhcml0eVtpZF0gPDwgMTsKPiAgCj4gLQlpZiAoZnVuY3Rpb24gPT0gUVVBRDhf
Q09VTlRfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OKSB7Cj4gKwlpZiAoZnVuY3Rpb24gPT0gQ09V
TlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04pIHsKPiAgCQkqcXVhZHJhdHVyZV9tb2RlID0g
MDsKPiAgCj4gIAkJLyogUXVhZHJhdHVyZSBzY2FsaW5nIG9ubHkgYXZhaWxhYmxlIGluIHF1YWRy
YXR1cmUgbW9kZSAqLwo+IEBAIC0yNjIsMTUgKzI1NywxNSBAQCBzdGF0aWMgaW50IHF1YWQ4X2Z1
bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAkJKnF1YWRyYXR1
cmVfbW9kZSA9IDE7Cj4gIAo+ICAJCXN3aXRjaCAoZnVuY3Rpb24pIHsKPiAtCQljYXNlIFFVQUQ4
X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDE6Cj4gKwkJY2FzZSBDT1VOVEVSX0ZVTkNUSU9O
X1FVQURSQVRVUkVfWDFfQToKPiAgCQkJKnNjYWxlID0gMDsKPiAgCQkJbW9kZV9jZmcgfD0gUVVB
RDhfQ01SX1FVQURSQVRVUkVfWDE7Cj4gIAkJCWJyZWFrOwo+IC0JCWNhc2UgUVVBRDhfQ09VTlRf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YMjoKPiArCQljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJB
VFVSRV9YMl9BOgo+ICAJCQkqc2NhbGUgPSAxOwo+ICAJCQltb2RlX2NmZyB8PSBRVUFEOF9DTVJf
UVVBRFJBVFVSRV9YMjsKPiAgCQkJYnJlYWs7Cj4gLQkJY2FzZSBRVUFEOF9DT1VOVF9GVU5DVElP
Tl9RVUFEUkFUVVJFX1g0Ogo+ICsJCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0
Ogo+ICAJCQkqc2NhbGUgPSAyOwo+ICAJCQltb2RlX2NmZyB8PSBRVUFEOF9DTVJfUVVBRFJBVFVS
RV9YNDsKPiAgCQkJYnJlYWs7Cj4gQEAgLTI4OSw4ICsyODQsOSBAQCBzdGF0aWMgaW50IHF1YWQ4
X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1cm4g
MDsKPiAgfQo+ICAKPiAtc3RhdGljIHZvaWQgcXVhZDhfZGlyZWN0aW9uX2dldChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIGVu
dW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gKmRpcmVjdGlvbikKPiArc3RhdGljIGludCBxdWFk
OF9kaXJlY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQlz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQllbnVtIGNvdW50ZXJfY291bnRfZGly
ZWN0aW9uICpkaXJlY3Rpb24pCj4gIHsKPiAgCWNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJp
diA9IGNvdW50ZXItPnByaXY7Cj4gIAl1bnNpZ25lZCBpbnQgdWRfZmxhZzsKPiBAQCAtMzAxLDc2
ICsyOTcsNzQgQEAgc3RhdGljIHZvaWQgcXVhZDhfZGlyZWN0aW9uX2dldChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gIAo+ICAJKmRpcmVjdGlvbiA9ICh1ZF9mbGFnKSA/IENPVU5U
RVJfQ09VTlRfRElSRUNUSU9OX0ZPUldBUkQgOgo+ICAJCUNPVU5URVJfQ09VTlRfRElSRUNUSU9O
X0JBQ0tXQVJEOwo+IC19Cj4gIAo+IC1lbnVtIHF1YWQ4X3N5bmFwc2VfYWN0aW9uIHsKPiAtCVFV
QUQ4X1NZTkFQU0VfQUNUSU9OX05PTkUgPSAwLAo+IC0JUVVBRDhfU1lOQVBTRV9BQ1RJT05fUklT
SU5HX0VER0UsCj4gLQlRVUFEOF9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gLQlRVUFE
OF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gLX07Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICAK
PiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBxdWFkOF9pbmRleF9h
Y3Rpb25zX2xpc3RbXSA9IHsKPiAtCVtRVUFEOF9TWU5BUFNFX0FDVElPTl9OT05FXSA9IENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiAtCVtRVUFEOF9TWU5BUFNFX0FDVElPTl9SSVNJTkdf
RURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFCj4gKwlDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX05PTkUsCj4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdF
LAo+ICB9Owo+ICAKPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBx
dWFkOF9zeW5hcHNlX2FjdGlvbnNfbGlzdFtdID0gewo+IC0JW1FVQUQ4X1NZTkFQU0VfQUNUSU9O
X05PTkVdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+IC0JW1FVQUQ4X1NZTkFQU0Vf
QUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0Us
Cj4gLQlbUVVBRDhfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFXSA9IENPVU5URVJfU1lOQVBT
RV9BQ1RJT05fRkFMTElOR19FREdFLAo+IC0JW1FVQUQ4X1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVNdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gKwlDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX05PTkUsCj4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+
ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gKwlDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX0JPVEhfRURHRVMsCj4gIH07Cj4gIAo+IC1zdGF0aWMgaW50IHF1YWQ4X2FjdGlv
bl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LCBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+IC0Jc2l6ZV90
ICphY3Rpb24pCj4gK3N0YXRpYyBpbnQgcXVhZDhfYWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICsJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiArCQkJICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ICsJCQkgICAgIGVu
dW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDgg
KmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJaW50IGVycjsKPiAtCXNpemVfdCBmdW5j
dGlvbiA9IDA7Cj4gKwllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb247Cj4gIAljb25zdCBz
aXplX3Qgc2lnbmFsX2FfaWQgPSBjb3VudC0+c3luYXBzZXNbMF0uc2lnbmFsLT5pZDsKPiAgCWVu
dW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gZGlyZWN0aW9uOwo+ICAKPiAgCS8qIEhhbmRsZSBJ
bmRleCBzaWduYWxzICovCj4gIAlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA+PSAxNikgewo+ICAJ
CWlmIChwcml2LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF0pCj4gLQkJCSphY3Rpb24gPSBRVUFE
OF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gIAkJZWxzZQo+IC0JCQkqYWN0aW9uID0gUVVBRDhf
U1lOQVBTRV9BQ1RJT05fTk9ORTsKPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJ
T05fTk9ORTsKPiAgCj4gIAkJcmV0dXJuIDA7Cj4gIAl9Cj4gIAo+IC0JZXJyID0gcXVhZDhfZnVu
Y3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICsJZXJyID0gcXVhZDhfZnVu
Y3Rpb25fcmVhZChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiAgCWlmIChlcnIpCj4gIAkJ
cmV0dXJuIGVycjsKPiAgCj4gIAkvKiBEZWZhdWx0IGFjdGlvbiBtb2RlICovCj4gLQkqYWN0aW9u
ID0gUVVBRDhfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiArCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX05PTkU7Cj4gIAo+ICAJLyogRGV0ZXJtaW5lIGFjdGlvbiBtb2RlIGJhc2VkIG9u
IGN1cnJlbnQgY291bnQgZnVuY3Rpb24gbW9kZSAqLwo+ICAJc3dpdGNoIChmdW5jdGlvbikgewo+
IC0JY2FzZSBRVUFEOF9DT1VOVF9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT046Cj4gKwljYXNlIENP
VU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOgo+ICAJCWlmIChzeW5hcHNlLT5zaWduYWwt
PmlkID09IHNpZ25hbF9hX2lkKQo+IC0JCQkqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9BQ1RJT05f
UklTSU5HX0VER0U7Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lO
R19FREdFOwo+ICAJCXJldHVybiAwOwo+IC0JY2FzZSBRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFE
UkFUVVJFX1gxOgo+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQToKPiAg
CQlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9PSBzaWduYWxfYV9pZCkgewo+IC0JCQlxdWFkOF9k
aXJlY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZGlyZWN0aW9uKTsKPiArCQkJZXJyID0gcXVh
ZDhfZGlyZWN0aW9uX3JlYWQoY291bnRlciwgY291bnQsICZkaXJlY3Rpb24pOwo+ICsJCQlpZiAo
ZXJyKQo+ICsJCQkJcmV0dXJuIGVycjsKPiAgCj4gIAkJCWlmIChkaXJlY3Rpb24gPT0gQ09VTlRF
Ul9DT1VOVF9ESVJFQ1RJT05fRk9SV0FSRCkKPiAtCQkJCSphY3Rpb24gPSBRVUFEOF9TWU5BUFNF
X0FDVElPTl9SSVNJTkdfRURHRTsKPiArCQkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNU
SU9OX1JJU0lOR19FREdFOwo+ICAJCQllbHNlCj4gLQkJCQkqYWN0aW9uID0gUVVBRDhfU1lOQVBT
RV9BQ1RJT05fRkFMTElOR19FREdFOwo+ICsJCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9B
Q1RJT05fRkFMTElOR19FREdFOwo+ICAJCX0KPiAgCQlyZXR1cm4gMDsKPiAtCWNhc2UgUVVBRDhf
Q09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMjoKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9R
VUFEUkFUVVJFX1gyX0E6Cj4gIAkJaWYgKHN5bmFwc2UtPnNpZ25hbC0+aWQgPT0gc2lnbmFsX2Ff
aWQpCj4gLQkJCSphY3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsJ
CQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICAJCXJldHVy
biAwOwo+IC0JY2FzZSBRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Ogo+IC0JCSph
Y3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsJY2FzZSBDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9B
Q1RJT05fQk9USF9FREdFUzsKPiAgCQlyZXR1cm4gMDsKPiAgCWRlZmF1bHQ6Cj4gIAkJLyogc2hv
dWxkIG5ldmVyIHJlYWNoIHRoaXMgcGF0aCAqLwo+IEBAIC0zODIsOSArMzc2LDkgQEAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyBxdWFkOF9vcHMgPSB7Cj4gIAkuc2lnbmFsX3JlYWQg
PSBxdWFkOF9zaWduYWxfcmVhZCwKPiAgCS5jb3VudF9yZWFkID0gcXVhZDhfY291bnRfcmVhZCwK
PiAgCS5jb3VudF93cml0ZSA9IHF1YWQ4X2NvdW50X3dyaXRlLAo+IC0JLmZ1bmN0aW9uX2dldCA9
IHF1YWQ4X2Z1bmN0aW9uX2dldCwKPiAtCS5mdW5jdGlvbl9zZXQgPSBxdWFkOF9mdW5jdGlvbl9z
ZXQsCj4gLQkuYWN0aW9uX2dldCA9IHF1YWQ4X2FjdGlvbl9nZXQKPiArCS5mdW5jdGlvbl9yZWFk
ID0gcXVhZDhfZnVuY3Rpb25fcmVhZCwKPiArCS5mdW5jdGlvbl93cml0ZSA9IHF1YWQ4X2Z1bmN0
aW9uX3dyaXRlLAo+ICsJLmFjdGlvbl9yZWFkID0gcXVhZDhfYWN0aW9uX3JlYWQKPiAgfTsKPiAg
Cj4gIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9pbmRleF9wb2xhcml0eV9tb2Rlc1td
ID0gewo+IEBAIC0zOTMsNyArMzg3LDggQEAgc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IHF1YWQ4
X2luZGV4X3BvbGFyaXR5X21vZGVzW10gPSB7Cj4gIH07Cj4gIAo+ICBzdGF0aWMgaW50IHF1YWQ4
X2luZGV4X3BvbGFyaXR5X2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlz
dHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90ICppbmRleF9wb2xhcml0eSkKPiAr
CQkJCSAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiArCQkJCSAgICB1MzIgKmlu
ZGV4X3BvbGFyaXR5KQo+ICB7Cj4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBj
b3VudGVyLT5wcml2Owo+ICAJY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC0g
MTY7Cj4gQEAgLTQwNCw3ICszOTksOCBAQCBzdGF0aWMgaW50IHF1YWQ4X2luZGV4X3BvbGFyaXR5
X2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBp
bnQgcXVhZDhfaW5kZXhfcG9sYXJpdHlfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCBzaXplX3QgaW5kZXhfcG9sYXJp
dHkpCj4gKwkJCQkgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gKwkJCQkgICAg
dTMyIGluZGV4X3BvbGFyaXR5KQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBj
b3VudGVyLT5wcml2Owo+ICAJY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC0g
MTY7Cj4gQEAgLTQyNSwyMCArNDIxLDE0IEBAIHN0YXRpYyBpbnQgcXVhZDhfaW5kZXhfcG9sYXJp
dHlfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCXJldHVybiAwOwo+ICB9
Cj4gIAo+IC1zdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0IHF1YWQ4X2luZGV4
X3BvbF9lbnVtID0gewo+IC0JLml0ZW1zID0gcXVhZDhfaW5kZXhfcG9sYXJpdHlfbW9kZXMsCj4g
LQkubnVtX2l0ZW1zID0gQVJSQVlfU0laRShxdWFkOF9pbmRleF9wb2xhcml0eV9tb2RlcyksCj4g
LQkuZ2V0ID0gcXVhZDhfaW5kZXhfcG9sYXJpdHlfZ2V0LAo+IC0JLnNldCA9IHF1YWQ4X2luZGV4
X3BvbGFyaXR5X3NldAo+IC19Owo+IC0KPiAgc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IHF1YWQ4
X3N5bmNocm9ub3VzX21vZGVzW10gPSB7Cj4gIAkibm9uLXN5bmNocm9ub3VzIiwKPiAgCSJzeW5j
aHJvbm91cyIKPiAgfTsKPiAgCj4gIHN0YXRpYyBpbnQgcXVhZDhfc3luY2hyb25vdXNfbW9kZV9n
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfc2ln
bmFsICpzaWduYWwsIHNpemVfdCAqc3luY2hyb25vdXNfbW9kZSkKPiArCQkJCSAgICAgIHN0cnVj
dCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ICsJCQkJICAgICAgdTMyICpzeW5jaHJvbm91c19t
b2RlKQo+ICB7Cj4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5w
cml2Owo+ICAJY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC0gMTY7Cj4gQEAg
LTQ0OSw3ICs0MzksOCBAQCBzdGF0aWMgaW50IHF1YWQ4X3N5bmNocm9ub3VzX21vZGVfZ2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgfQo+ICAKPiAgc3RhdGljIGludCBxdWFk
OF9zeW5jaHJvbm91c19tb2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
LQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90IHN5bmNocm9ub3VzX21vZGUp
Cj4gKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiArCQkJCSAgICAg
IHUzMiBzeW5jaHJvbm91c19tb2RlKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYg
PSBjb3VudGVyLT5wcml2Owo+ICAJY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlk
IC0gMTY7Cj4gQEAgLTQ3NiwyMiArNDY3LDE4IEBAIHN0YXRpYyBpbnQgcXVhZDhfc3luY2hyb25v
dXNfbW9kZV9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJuIDA7
Cj4gIH0KPiAgCj4gLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51bV9leHQgcXVhZDhf
c3luX21vZGVfZW51bSA9IHsKPiAtCS5pdGVtcyA9IHF1YWQ4X3N5bmNocm9ub3VzX21vZGVzLAo+
IC0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUocXVhZDhfc3luY2hyb25vdXNfbW9kZXMpLAo+IC0J
LmdldCA9IHF1YWQ4X3N5bmNocm9ub3VzX21vZGVfZ2V0LAo+IC0JLnNldCA9IHF1YWQ4X3N5bmNo
cm9ub3VzX21vZGVfc2V0Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9m
bG9vcl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50
IHF1YWQ4X2NvdW50X2Zsb29yX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICsJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqZmxvb3IpCj4gIHsKPiAg
CS8qIE9ubHkgYSBmbG9vciBvZiAwIGlzIHN1cHBvcnRlZCAqLwo+IC0JcmV0dXJuIHNwcmludGYo
YnVmLCAiMFxuIik7Cj4gKwkqZmxvb3IgPSAwOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+
IC1zdGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90ICpjbnRfbW9k
ZSkKPiArc3RhdGljIGludCBxdWFkOF9jb3VudF9tb2RlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ICsJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJ
CSBlbnVtIGNvdW50ZXJfY291bnRfbW9kZSAqY250X21vZGUpCj4gIHsKPiAgCWNvbnN0IHN0cnVj
dCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAo+IEBAIC01MTQsMjYgKzUw
MSwyOCBAQCBzdGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfZ2V0KHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IHF1YWQ4
X2NvdW50X21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90IGNudF9tb2RlKQo+ICtzdGF0aWMgaW50IHF1
YWQ4X2NvdW50X21vZGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJ
CQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkgIGVudW0gY291bnRlcl9j
b3VudF9tb2RlIGNudF9tb2RlKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBj
b3VudGVyLT5wcml2Owo+ICsJdW5zaWduZWQgaW50IGNvdW50X21vZGU7Cj4gIAl1bnNpZ25lZCBp
bnQgbW9kZV9jZmc7Cj4gIAljb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsgMiAq
IGNvdW50LT5pZCArIDE7Cj4gIAo+ICAJLyogTWFwIEdlbmVyaWMgQ291bnRlciBjb3VudCBtb2Rl
IHRvIDEwNC1RVUFELTggY291bnQgbW9kZSAqLwo+ICAJc3dpdGNoIChjbnRfbW9kZSkgewo+ICAJ
Y2FzZSBDT1VOVEVSX0NPVU5UX01PREVfTk9STUFMOgo+IC0JCWNudF9tb2RlID0gMDsKPiArCQlj
b3VudF9tb2RlID0gMDsKPiAgCQlicmVhazsKPiAgCWNhc2UgQ09VTlRFUl9DT1VOVF9NT0RFX1JB
TkdFX0xJTUlUOgo+IC0JCWNudF9tb2RlID0gMTsKPiArCQljb3VudF9tb2RlID0gMTsKPiAgCQli
cmVhazsKPiAgCWNhc2UgQ09VTlRFUl9DT1VOVF9NT0RFX05PTl9SRUNZQ0xFOgo+IC0JCWNudF9t
b2RlID0gMjsKPiArCQljb3VudF9tb2RlID0gMjsKPiAgCQlicmVhazsKPiAgCWNhc2UgQ09VTlRF
Ul9DT1VOVF9NT0RFX01PRFVMT19OOgo+IC0JCWNudF9tb2RlID0gMzsKPiArCQljb3VudF9tb2Rl
ID0gMzsKPiAgCQlicmVhazsKPiAgCWRlZmF1bHQ6Cj4gIAkJLyogc2hvdWxkIG5ldmVyIHJlYWNo
IHRoaXMgcGF0aCAqLwo+IEBAIC01NDIsMTAgKzUzMSwxMCBAQCBzdGF0aWMgaW50IHF1YWQ4X2Nv
dW50X21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCj4gIAltdXRl
eF9sb2NrKCZwcml2LT5sb2NrKTsKPiAgCj4gLQlwcml2LT5jb3VudF9tb2RlW2NvdW50LT5pZF0g
PSBjbnRfbW9kZTsKPiArCXByaXYtPmNvdW50X21vZGVbY291bnQtPmlkXSA9IGNvdW50X21vZGU7
Cj4gIAo+ICAJLyogU2V0IGNvdW50IG1vZGUgY29uZmlndXJhdGlvbiB2YWx1ZSAqLwo+IC0JbW9k
ZV9jZmcgPSBjbnRfbW9kZSA8PCAxOwo+ICsJbW9kZV9jZmcgPSBjb3VudF9tb2RlIDw8IDE7Cj4g
IAo+ICAJLyogQWRkIHF1YWRyYXR1cmUgbW9kZSBjb25maWd1cmF0aW9uICovCj4gIAlpZiAocHJp
di0+cXVhZHJhdHVyZV9tb2RlW2NvdW50LT5pZF0pCj4gQEAgLTU1OSw1NiArNTQ4LDM1IEBAIHN0
YXRpYyBpbnQgcXVhZDhfY291bnRfbW9kZV9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb3Vu
dF9lbnVtX2V4dCBxdWFkOF9jbnRfbW9kZV9lbnVtID0gewo+IC0JLml0ZW1zID0gY291bnRlcl9j
b3VudF9tb2RlX3N0ciwKPiAtCS5udW1faXRlbXMgPSBBUlJBWV9TSVpFKGNvdW50ZXJfY291bnRf
bW9kZV9zdHIpLAo+IC0JLmdldCA9IHF1YWQ4X2NvdW50X21vZGVfZ2V0LAo+IC0JLnNldCA9IHF1
YWQ4X2NvdW50X21vZGVfc2V0Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3Vu
dF9kaXJlY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXYsIGNoYXIgKmJ1ZikKPiAtewo+IC0J
ZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlvbiBkaXI7Cj4gLQo+IC0JcXVhZDhfZGlyZWN0aW9u
X2dldChjb3VudGVyLCBjb3VudCwgJmRpcik7Cj4gLQo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAi
JXNcbiIsIGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0cltkaXJdKTsKPiAtfQo+IC0KPiAtc3Rh
dGljIHNzaXplX3QgcXVhZDhfY291bnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2YXRl
LCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfZW5hYmxlX3JlYWQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB1OCAqZW5hYmxlKQo+ICB7Cj4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+ICAKPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBw
cml2LT5hYl9lbmFibGVbY291bnQtPmlkXSk7Cj4gKwkqZW5hYmxlID0gcHJpdi0+YWJfZW5hYmxl
W2NvdW50LT5pZF07Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90
IHF1YWQ4X2NvdW50X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNo
YXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGljIGludCBxdWFkOF9jb3VudF9lbmFibGVfd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdTggZW5hYmxlKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0
IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+
YmFzZSArIDIgKiBjb3VudC0+aWQ7Cj4gLQlpbnQgZXJyOwo+IC0JYm9vbCBhYl9lbmFibGU7Cj4g
IAl1bnNpZ25lZCBpbnQgaW9yX2NmZzsKPiAgCj4gLQllcnIgPSBrc3RydG9ib29sKGJ1ZiwgJmFi
X2VuYWJsZSk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBlcnI7Cj4gLQo+ICAJbXV0ZXhfbG9j
aygmcHJpdi0+bG9jayk7Cj4gIAo+IC0JcHJpdi0+YWJfZW5hYmxlW2NvdW50LT5pZF0gPSBhYl9l
bmFibGU7Cj4gKwlwcml2LT5hYl9lbmFibGVbY291bnQtPmlkXSA9IGVuYWJsZTsKPiAgCj4gLQlp
b3JfY2ZnID0gYWJfZW5hYmxlIHwgcHJpdi0+cHJlc2V0X2VuYWJsZVtjb3VudC0+aWRdIDw8IDE7
Cj4gKwlpb3JfY2ZnID0gZW5hYmxlIHwgcHJpdi0+cHJlc2V0X2VuYWJsZVtjb3VudC0+aWRdIDw8
IDE7Cj4gIAo+ICAJLyogTG9hZCBJL08gY29udHJvbCBjb25maWd1cmF0aW9uICovCj4gIAlvdXRi
KFFVQUQ4X0NUUl9JT1IgfCBpb3JfY2ZnLCBiYXNlX29mZnNldCArIDEpOwo+ICAKPiAgCW11dGV4
X3VubG9jaygmcHJpdi0+bG9jayk7Cj4gIAo+IC0JcmV0dXJuIGxlbjsKPiArCXJldHVybiAwOwo+
ICB9Cj4gIAo+ICBzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgcXVhZDhfbm9pc2VfZXJyb3Jfc3Rh
dGVzW10gPSB7Cj4gQEAgLTYxNyw3ICs1ODUsNyBAQCBzdGF0aWMgY29uc3QgY2hhciAqY29uc3Qg
cXVhZDhfbm9pc2VfZXJyb3Jfc3RhdGVzW10gPSB7Cj4gIH07Cj4gIAo+ICBzdGF0aWMgaW50IHF1
YWQ4X2Vycm9yX25vaXNlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCAqbm9pc2VfZXJyb3IpCj4gKwkJCQkg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1MzIgKm5vaXNlX2Vycm9yKQo+ICB7Cj4gIAlj
b25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJY29uc3Qg
aW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFzZSArIDIgKiBjb3VudC0+aWQgKyAxOwo+IEBAIC02
MjcsMTggKzU5NSwxNCBAQCBzdGF0aWMgaW50IHF1YWQ4X2Vycm9yX25vaXNlX2dldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGlj
IHN0cnVjdCBjb3VudGVyX2NvdW50X2VudW1fZXh0IHF1YWQ4X2Vycm9yX25vaXNlX2VudW0gPSB7
Cj4gLQkuaXRlbXMgPSBxdWFkOF9ub2lzZV9lcnJvcl9zdGF0ZXMsCj4gLQkubnVtX2l0ZW1zID0g
QVJSQVlfU0laRShxdWFkOF9ub2lzZV9lcnJvcl9zdGF0ZXMpLAo+IC0JLmdldCA9IHF1YWQ4X2Vy
cm9yX25vaXNlX2dldAo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfcHJl
c2V0X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQg
cXVhZDhfY291bnRfcHJlc2V0X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICsJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnByZXNldCkKPiAgewo+
ICAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCj4g
LQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+cHJlc2V0W2NvdW50LT5pZF0pOwo+
ICsJKnByZXNldCA9IHByaXYtPnByZXNldFtjb3VudC0+aWRdOwo+ICsKPiArCXJldHVybiAwOwo+
ICB9Cj4gIAo+ICBzdGF0aWMgdm9pZCBxdWFkOF9wcmVzZXRfcmVnaXN0ZXJfc2V0KHN0cnVjdCBx
dWFkOCAqY29uc3QgcHJpdiwgY29uc3QgaW50IGlkLAo+IEBAIC02NTcsMTYgKzYyMSwxMCBAQCBz
dGF0aWMgdm9pZCBxdWFkOF9wcmVzZXRfcmVnaXN0ZXJfc2V0KHN0cnVjdCBxdWFkOCAqY29uc3Qg
cHJpdiwgY29uc3QgaW50IGlkLAo+ICAJCW91dGIocHJlc2V0ID4+ICg4ICogaSksIGJhc2Vfb2Zm
c2V0KTsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfcHJlc2V0X3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtz
dGF0aWMgaW50IHF1YWQ4X2NvdW50X3ByZXNldF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gKwkJCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgcHJl
c2V0KQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+
IC0JdW5zaWduZWQgaW50IHByZXNldDsKPiAtCWludCByZXQ7Cj4gLQo+IC0JcmV0ID0ga3N0cnRv
dWludChidWYsIDAsICZwcmVzZXQpOwo+IC0JaWYgKHJldCkKPiAtCQlyZXR1cm4gcmV0Owo+ICAK
PiAgCS8qIE9ubHkgMjQtYml0IHZhbHVlcyBhcmUgc3VwcG9ydGVkICovCj4gIAlpZiAocHJlc2V0
ID4gMHhGRkZGRkYpCj4gQEAgLTY3OCwxMSArNjM2LDExIEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4
X2NvdW50X3ByZXNldF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAo+
ICAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPiAgCj4gLQlyZXR1cm4gbGVuOwo+ICsJcmV0
dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2NlaWxpbmdfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBxdWFkOF9j
b3VudF9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJ
ICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICpjZWlsaW5nKQo+ICB7Cj4gIAlz
dHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAKPiBAQCAtNjkyLDI2
ICs2NTAsMjMgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfY2VpbGluZ19yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCXN3aXRjaCAocHJpdi0+Y291bnRfbW9kZVtj
b3VudC0+aWRdKSB7Cj4gIAljYXNlIDE6Cj4gIAljYXNlIDM6Cj4gLQkJbXV0ZXhfdW5sb2NrKCZw
cml2LT5sb2NrKTsKPiAtCQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+cHJlc2V0
W2NvdW50LT5pZF0pOwo+ICsJCSpjZWlsaW5nID0gcHJpdi0+cHJlc2V0W2NvdW50LT5pZF07Cj4g
KwkJYnJlYWs7Cj4gKwlkZWZhdWx0Ogo+ICsJCS8qIEJ5IGRlZmF1bHQgMHgxRkZGRkZGICgyNSBi
aXRzIHVuc2lnbmVkKSBpcyBtYXhpbXVtIGNvdW50ICovCj4gKwkJKmNlaWxpbmcgPSAweDFGRkZG
RkY7Cj4gKwkJYnJlYWs7Cj4gIAl9Cj4gIAo+ICAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsK
PiAgCj4gLQkvKiBCeSBkZWZhdWx0IDB4MUZGRkZGRiAoMjUgYml0cyB1bnNpZ25lZCkgaXMgbWF4
aW11bSBjb3VudCAqLwo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiMzM1NTQ0MzFcbiIpOwo+ICsJ
cmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2NlaWxpbmdf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LCB2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4p
Cj4gK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwg
dTY0IGNlaWxpbmcpCj4gIHsKPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXIt
PnByaXY7Cj4gLQl1bnNpZ25lZCBpbnQgY2VpbGluZzsKPiAtCWludCByZXQ7Cj4gLQo+IC0JcmV0
ID0ga3N0cnRvdWludChidWYsIDAsICZjZWlsaW5nKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJu
IHJldDsKPiAgCj4gIAkvKiBPbmx5IDI0LWJpdCB2YWx1ZXMgYXJlIHN1cHBvcnRlZCAqLwo+ICAJ
aWYgKGNlaWxpbmcgPiAweEZGRkZGRikKPiBAQCAtNzI1LDcgKzY4MCw3IEBAIHN0YXRpYyBzc2l6
ZV90IHF1YWQ4X2NvdW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICAJY2FzZSAzOgo+ICAJCXF1YWQ4X3ByZXNldF9yZWdpc3Rlcl9zZXQocHJpdiwgY291
bnQtPmlkLCBjZWlsaW5nKTsKPiAgCQltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+IC0JCXJl
dHVybiBsZW47Cj4gKwkJcmV0dXJuIDA7Cj4gIAl9Cj4gIAo+ICAJbXV0ZXhfdW5sb2NrKCZwcml2
LT5sb2NrKTsKPiBAQCAtNzMzLDI3ICs2ODgsMjUgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfY291
bnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1
cm4gLUVJTlZBTDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfcHJlc2V0
X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMg
aW50IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gKwkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJ
ICB1OCAqcHJlc2V0X2VuYWJsZSkKPiAgewo+ICAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBw
cml2ID0gY291bnRlci0+cHJpdjsKPiAgCj4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwg
IXByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlkXSk7Cj4gKwkqcHJlc2V0X2VuYWJsZSA9ICFw
cml2LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF07Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAg
Cj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBp
bnQgcXVhZDhfY291bnRfcHJlc2V0X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gKwkJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJ
CSAgIHU4IHByZXNldF9lbmFibGUpCj4gIHsKPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9
IGNvdW50ZXItPnByaXY7Cj4gIAljb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsg
MiAqIGNvdW50LT5pZCArIDE7Cj4gLQlib29sIHByZXNldF9lbmFibGU7Cj4gLQlpbnQgcmV0Owo+
ICAJdW5zaWduZWQgaW50IGlvcl9jZmc7Cj4gIAo+IC0JcmV0ID0ga3N0cnRvYm9vbChidWYsICZw
cmVzZXRfZW5hYmxlKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJuIHJldDsKPiAtCj4gIAkvKiBQ
cmVzZXQgZW5hYmxlIGlzIGFjdGl2ZSBsb3cgaW4gSW5wdXQvT3V0cHV0IENvbnRyb2wgcmVnaXN0
ZXIgKi8KPiAgCXByZXNldF9lbmFibGUgPSAhcHJlc2V0X2VuYWJsZTsKPiAgCj4gQEAgLTc2MSwy
NSArNzE0LDI0IEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAKPiAgCXByaXYtPnByZXNldF9l
bmFibGVbY291bnQtPmlkXSA9IHByZXNldF9lbmFibGU7Cj4gIAo+IC0JaW9yX2NmZyA9IHByaXYt
PmFiX2VuYWJsZVtjb3VudC0+aWRdIHwgKHVuc2lnbmVkIGludClwcmVzZXRfZW5hYmxlIDw8IDE7
Cj4gKwlpb3JfY2ZnID0gcHJpdi0+YWJfZW5hYmxlW2NvdW50LT5pZF0gfCBwcmVzZXRfZW5hYmxl
IDw8IDE7Cj4gIAo+ICAJLyogTG9hZCBJL08gY29udHJvbCBjb25maWd1cmF0aW9uIHRvIElucHV0
IC8gT3V0cHV0IENvbnRyb2wgUmVnaXN0ZXIgKi8KPiAgCW91dGIoUVVBRDhfQ1RSX0lPUiB8IGlv
cl9jZmcsIGJhc2Vfb2Zmc2V0KTsKPiAgCj4gIAltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+
ICAKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXpl
X3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+IC0JCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gLQkJ
CQkJICAgICB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgcXVhZDhfc2ln
bmFsX2NhYmxlX2ZhdWx0X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJ
CQkJCSBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiArCQkJCQkgdTggKmNhYmxlX2Zh
dWx0KQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+
ICAJY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC8gMjsKPiAgCWJvb2wgZGlz
YWJsZWQ7Cj4gIAl1bnNpZ25lZCBpbnQgc3RhdHVzOwo+IC0JdW5zaWduZWQgaW50IGZhdWx0Owo+
ICAKPiAgCW11dGV4X2xvY2soJnByaXYtPmxvY2spOwo+ICAKPiBAQCAtNzk2LDM2ICs3NDgsMzEg
QEAgc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPiAg
Cj4gIAkvKiBNYXNrIHJlc3BlY3RpdmUgY2hhbm5lbCBhbmQgaW52ZXJ0IGxvZ2ljICovCj4gLQlm
YXVsdCA9ICEoc3RhdHVzICYgQklUKGNoYW5uZWxfaWQpKTsKPiArCSpjYWJsZV9mYXVsdCA9ICEo
c3RhdHVzICYgQklUKGNoYW5uZWxfaWQpKTsKPiAgCj4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIl
dVxuIiwgZmF1bHQpOwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHF1
YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFibGVfcmVhZCgKPiAtCXN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gLQl2b2lkICpw
cml2YXRlLCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0
X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQkJc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gKwkJCQkJCXU4ICplbmFibGUpCj4gIHsKPiAg
CWNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAljb25z
dCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+IC0JY29uc3QgdW5zaWduZWQg
aW50IGVuYiA9ICEhKHByaXYtPmNhYmxlX2ZhdWx0X2VuYWJsZSAmIEJJVChjaGFubmVsX2lkKSk7
Cj4gIAo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIGVuYik7Cj4gKwkqZW5hYmxlID0g
ISEocHJpdi0+Y2FibGVfZmF1bHRfZW5hYmxlICYgQklUKGNoYW5uZWxfaWQpKTsKPiArCj4gKwly
ZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2Zh
dWx0X2VuYWJsZV93cml0ZSgKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gLQl2b2lkICpwcml2YXRlLCBjb25zdCBjaGFy
ICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0
X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkJCSBz
dHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiArCQkJCQkJIHU4IGVuYWJsZSkKPiAgewo+
ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCWNvbnN0IHNp
emVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAvIDI7Cj4gLQlib29sIGVuYWJsZTsKPiAtCWlu
dCByZXQ7Cj4gIAl1bnNpZ25lZCBpbnQgY2FibGVfZmF1bHRfZW5hYmxlOwo+ICAKPiAtCXJldCA9
IGtzdHJ0b2Jvb2woYnVmLCAmZW5hYmxlKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJuIHJldDsK
PiAtCj4gIAltdXRleF9sb2NrKCZwcml2LT5sb2NrKTsKPiAgCj4gIAlpZiAoZW5hYmxlKQo+IEBA
IC04NDAsMzEgKzc4NywyNyBAQCBzdGF0aWMgc3NpemVfdCBxdWFkOF9zaWduYWxfY2FibGVfZmF1
bHRfZW5hYmxlX3dyaXRlKAo+ICAKPiAgCW11dGV4X3VubG9jaygmcHJpdi0+bG9jayk7Cj4gIAo+
IC0JcmV0dXJuIGxlbjsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBx
dWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2YXRlLCBj
aGFyICpidWYpCj4gK3N0YXRpYyBpbnQgcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkJICAgc3RydWN0IGNvdW50ZXJf
c2lnbmFsICpzaWduYWwsCj4gKwkJCQkJICAgdTggKnByZXNjYWxlcikKPiAgewo+ICAJY29uc3Qg
c3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAtCWNvbnN0IHNpemVf
dCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAvIDI7Cj4gIAo+IC0JcmV0dXJuIHNwcmludGYoYnVm
LCAiJXVcbiIsIHByaXYtPmZja19wcmVzY2FsZXJbY2hhbm5lbF9pZF0pOwo+ICsJKnByZXNjYWxl
ciA9IHByaXYtPmZja19wcmVzY2FsZXJbc2lnbmFsLT5pZCAvIDJdOwo+ICsKPiArCXJldHVybiAw
Owo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl93
cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9z
aWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAqYnVmLAo+IC0Jc2l6ZV90
IGxlbikKPiArc3RhdGljIGludCBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl93cml0ZShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkJICAgIHN0cnVjdCBjb3VudGVyX3Np
Z25hbCAqc2lnbmFsLAo+ICsJCQkJCSAgICB1OCBwcmVzY2FsZXIpCj4gIHsKPiAgCXN0cnVjdCBx
dWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAljb25zdCBzaXplX3QgY2hhbm5l
bF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+ICAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+
YmFzZSArIDIgKiBjaGFubmVsX2lkOwo+IC0JdTggcHJlc2NhbGVyOwo+IC0JaW50IHJldDsKPiAt
Cj4gLQlyZXQgPSBrc3RydG91OChidWYsIDAsICZwcmVzY2FsZXIpOwo+IC0JaWYgKHJldCkKPiAt
CQlyZXR1cm4gcmV0Owo+ICAKPiAgCW11dGV4X2xvY2soJnByaXYtPmxvY2spOwo+ICAKPiBAQCAt
ODgwLDMxICs4MjMsMzAgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2Zja19wcmVzY2Fs
ZXJfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAKPiAgCW11dGV4X3Vu
bG9jaygmcHJpdi0+bG9jayk7Cj4gIAo+IC0JcmV0dXJuIGxlbjsKPiArCXJldHVybiAwOwo+ICB9
Cj4gIAo+IC1zdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCBxdWFkOF9zaWdu
YWxfZXh0W10gPSB7Cj4gLQl7Cj4gLQkJLm5hbWUgPSAiY2FibGVfZmF1bHQiLAo+IC0JCS5yZWFk
ID0gcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQKPiAtCX0sCj4gLQl7Cj4gLQkJLm5hbWUg
PSAiY2FibGVfZmF1bHRfZW5hYmxlIiwKPiAtCQkucmVhZCA9IHF1YWQ4X3NpZ25hbF9jYWJsZV9m
YXVsdF9lbmFibGVfcmVhZCwKPiAtCQkud3JpdGUgPSBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRf
ZW5hYmxlX3dyaXRlCj4gLQl9LAo+IC0Jewo+IC0JCS5uYW1lID0gImZpbHRlcl9jbG9ja19wcmVz
Y2FsZXIiLAo+IC0JCS5yZWFkID0gcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfcmVhZCwKPiAt
CQkud3JpdGUgPSBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl93cml0ZQo+IC0JfQo+ICtzdGF0
aWMgc3RydWN0IGNvdW50ZXJfY29tcCBxdWFkOF9zaWduYWxfZXh0W10gPSB7Cj4gKwlDT1VOVEVS
X0NPTVBfU0lHTkFMX0JPT0woImNhYmxlX2ZhdWx0IiwgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0
X3JlYWQsCj4gKwkJCQkgTlVMTCksCj4gKwlDT1VOVEVSX0NPTVBfU0lHTkFMX0JPT0woImNhYmxl
X2ZhdWx0X2VuYWJsZSIsCj4gKwkJCQkgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV9y
ZWFkLAo+ICsJCQkJIHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFibGVfd3JpdGUpLAo+ICsJ
Q09VTlRFUl9DT01QX1NJR05BTF9VOCgiZmlsdGVyX2Nsb2NrX3ByZXNjYWxlciIsCj4gKwkJCSAg
ICAgICBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl9yZWFkLAo+ICsJCQkgICAgICAgcXVhZDhf
c2lnbmFsX2Zja19wcmVzY2FsZXJfd3JpdGUpCj4gIH07Cj4gIAo+IC1zdGF0aWMgY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsX2V4dCBxdWFkOF9pbmRleF9leHRbXSA9IHsKPiAtCUNPVU5URVJf
U0lHTkFMX0VOVU0oImluZGV4X3BvbGFyaXR5IiwgJnF1YWQ4X2luZGV4X3BvbF9lbnVtKSwKPiAt
CUNPVU5URVJfU0lHTkFMX0VOVU1fQVZBSUxBQkxFKCJpbmRleF9wb2xhcml0eSIsCSZxdWFkOF9p
bmRleF9wb2xfZW51bSksCj4gLQlDT1VOVEVSX1NJR05BTF9FTlVNKCJzeW5jaHJvbm91c19tb2Rl
IiwgJnF1YWQ4X3N5bl9tb2RlX2VudW0pLAo+IC0JQ09VTlRFUl9TSUdOQUxfRU5VTV9BVkFJTEFC
TEUoInN5bmNocm9ub3VzX21vZGUiLCAmcXVhZDhfc3luX21vZGVfZW51bSkKPiArc3RhdGljIERF
RklORV9DT1VOVEVSX0VOVU0ocXVhZDhfaW5kZXhfcG9sX2VudW0sIHF1YWQ4X2luZGV4X3BvbGFy
aXR5X21vZGVzKTsKPiArc3RhdGljIERFRklORV9DT1VOVEVSX0VOVU0ocXVhZDhfc3luY2hfbW9k
ZV9lbnVtLCBxdWFkOF9zeW5jaHJvbm91c19tb2Rlcyk7Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGNv
dW50ZXJfY29tcCBxdWFkOF9pbmRleF9leHRbXSA9IHsKPiArCUNPVU5URVJfQ09NUF9TSUdOQUxf
RU5VTSgiaW5kZXhfcG9sYXJpdHkiLCBxdWFkOF9pbmRleF9wb2xhcml0eV9nZXQsCj4gKwkJCQkg
cXVhZDhfaW5kZXhfcG9sYXJpdHlfc2V0LAo+ICsJCQkJIHF1YWQ4X2luZGV4X3BvbF9lbnVtKSwK
PiArCUNPVU5URVJfQ09NUF9TSUdOQUxfRU5VTSgic3luY2hyb25vdXNfbW9kZSIsIHF1YWQ4X3N5
bmNocm9ub3VzX21vZGVfZ2V0LAo+ICsJCQkJIHF1YWQ4X3N5bmNocm9ub3VzX21vZGVfc2V0LAo+
ICsJCQkJIHF1YWQ4X3N5bmNoX21vZGVfZW51bSksCj4gIH07Cj4gIAo+ICAjZGVmaW5lIFFVQUQ4
X1FVQURfU0lHTkFMKF9pZCwgX25hbWUpIHsJCVwKPiBAQCAtOTczLDM5ICs5MTUsMzAgQEAgc3Rh
dGljIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgcXVhZDhfY291bnRfc3luYXBzZXNbXVszXSA9IHsK
PiAgCVFVQUQ4X0NPVU5UX1NZTkFQU0VTKDYpLCBRVUFEOF9DT1VOVF9TWU5BUFNFUyg3KQo+ICB9
Owo+ICAKPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCBxdWFkOF9jb3Vu
dF9leHRbXSA9IHsKPiAtCXsKPiAtCQkubmFtZSA9ICJjZWlsaW5nIiwKPiAtCQkucmVhZCA9IHF1
YWQ4X2NvdW50X2NlaWxpbmdfcmVhZCwKPiAtCQkud3JpdGUgPSBxdWFkOF9jb3VudF9jZWlsaW5n
X3dyaXRlCj4gLQl9LAo+IC0Jewo+IC0JCS5uYW1lID0gImZsb29yIiwKPiAtCQkucmVhZCA9IHF1
YWQ4X2NvdW50X2Zsb29yX3JlYWQKPiAtCX0sCj4gLQlDT1VOVEVSX0NPVU5UX0VOVU0oImNvdW50
X21vZGUiLCAmcXVhZDhfY250X21vZGVfZW51bSksCj4gLQlDT1VOVEVSX0NPVU5UX0VOVU1fQVZB
SUxBQkxFKCJjb3VudF9tb2RlIiwgJnF1YWQ4X2NudF9tb2RlX2VudW0pLAo+IC0Jewo+IC0JCS5u
YW1lID0gImRpcmVjdGlvbiIsCj4gLQkJLnJlYWQgPSBxdWFkOF9jb3VudF9kaXJlY3Rpb25fcmVh
ZAo+IC0JfSwKPiAtCXsKPiAtCQkubmFtZSA9ICJlbmFibGUiLAo+IC0JCS5yZWFkID0gcXVhZDhf
Y291bnRfZW5hYmxlX3JlYWQsCj4gLQkJLndyaXRlID0gcXVhZDhfY291bnRfZW5hYmxlX3dyaXRl
Cj4gLQl9LAo+IC0JQ09VTlRFUl9DT1VOVF9FTlVNKCJlcnJvcl9ub2lzZSIsICZxdWFkOF9lcnJv
cl9ub2lzZV9lbnVtKSwKPiAtCUNPVU5URVJfQ09VTlRfRU5VTV9BVkFJTEFCTEUoImVycm9yX25v
aXNlIiwgJnF1YWQ4X2Vycm9yX25vaXNlX2VudW0pLAo+IC0Jewo+IC0JCS5uYW1lID0gInByZXNl
dCIsCj4gLQkJLnJlYWQgPSBxdWFkOF9jb3VudF9wcmVzZXRfcmVhZCwKPiAtCQkud3JpdGUgPSBx
dWFkOF9jb3VudF9wcmVzZXRfd3JpdGUKPiAtCX0sCj4gLQl7Cj4gLQkJLm5hbWUgPSAicHJlc2V0
X2VuYWJsZSIsCj4gLQkJLnJlYWQgPSBxdWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3JlYWQsCj4g
LQkJLndyaXRlID0gcXVhZDhfY291bnRfcHJlc2V0X2VuYWJsZV93cml0ZQo+IC0JfQo+ICtzdGF0
aWMgY29uc3QgZW51bSBjb3VudGVyX2NvdW50X21vZGUgcXVhZDhfY250X21vZGVzW10gPSB7Cj4g
KwlDT1VOVEVSX0NPVU5UX01PREVfTk9STUFMLAo+ICsJQ09VTlRFUl9DT1VOVF9NT0RFX1JBTkdF
X0xJTUlULAo+ICsJQ09VTlRFUl9DT1VOVF9NT0RFX05PTl9SRUNZQ0xFLAo+ICsJQ09VTlRFUl9D
T1VOVF9NT0RFX01PRFVMT19OLAo+ICt9Owo+ICsKPiArc3RhdGljIERFRklORV9DT1VOVEVSX0FW
QUlMQUJMRShxdWFkOF9jb3VudF9tb2RlX2F2YWlsYWJsZSwgcXVhZDhfY250X21vZGVzKTsKPiAr
Cj4gK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9FTlVNKHF1YWQ4X2Vycm9yX25vaXNlX2VudW0sIHF1
YWQ4X25vaXNlX2Vycm9yX3N0YXRlcyk7Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29t
cCBxdWFkOF9jb3VudF9leHRbXSA9IHsKPiArCUNPVU5URVJfQ09NUF9DRUlMSU5HKHF1YWQ4X2Nv
dW50X2NlaWxpbmdfcmVhZCwKPiArCQkJICAgICBxdWFkOF9jb3VudF9jZWlsaW5nX3dyaXRlKSwK
PiArCUNPVU5URVJfQ09NUF9GTE9PUihxdWFkOF9jb3VudF9mbG9vcl9yZWFkLCBOVUxMKSwKPiAr
CUNPVU5URVJfQ09NUF9DT1VOVF9NT0RFKHF1YWQ4X2NvdW50X21vZGVfcmVhZCwgcXVhZDhfY291
bnRfbW9kZV93cml0ZSwKPiArCQkJCXF1YWQ4X2NvdW50X21vZGVfYXZhaWxhYmxlKSwKPiArCUNP
VU5URVJfQ09NUF9ESVJFQ1RJT04ocXVhZDhfZGlyZWN0aW9uX3JlYWQpLAo+ICsJQ09VTlRFUl9D
T01QX0VOQUJMRShxdWFkOF9jb3VudF9lbmFibGVfcmVhZCwgcXVhZDhfY291bnRfZW5hYmxlX3dy
aXRlKSwKPiArCUNPVU5URVJfQ09NUF9DT1VOVF9FTlVNKCJlcnJvcl9ub2lzZSIsIHF1YWQ4X2Vy
cm9yX25vaXNlX2dldCwgTlVMTCwKPiArCQkJCXF1YWQ4X2Vycm9yX25vaXNlX2VudW0pLAo+ICsJ
Q09VTlRFUl9DT01QX1BSRVNFVChxdWFkOF9jb3VudF9wcmVzZXRfcmVhZCwgcXVhZDhfY291bnRf
cHJlc2V0X3dyaXRlKSwKPiArCUNPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKHF1YWQ4X2NvdW50
X3ByZXNldF9lbmFibGVfcmVhZCwKPiArCQkJCSAgIHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVf
d3JpdGUpLAo+ICB9Owo+ICAKPiAgI2RlZmluZSBRVUFEOF9DT1VOVChfaWQsIF9jbnRuYW1lKSB7
CQkJCQlcCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci9NYWtlZmlsZSBiL2RyaXZlcnMv
Y291bnRlci9NYWtlZmlsZQo+IGluZGV4IDE5NzQyZTZmNWUzZS4uMWFiN2UwODdmZGMyIDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvY291bnRlci9NYWtlZmlsZQo+ICsrKyBiL2RyaXZlcnMvY291bnRl
ci9NYWtlZmlsZQo+IEBAIC00LDYgKzQsNyBAQAo+ICAjCj4gIAo+ICBvYmotJChDT05GSUdfQ09V
TlRFUikgKz0gY291bnRlci5vCj4gK2NvdW50ZXIteSA6PSBjb3VudGVyLWNvcmUubyBjb3VudGVy
LXN5c2ZzLm8KPiAgCj4gIG9iai0kKENPTkZJR18xMDRfUVVBRF84KQkrPSAxMDQtcXVhZC04Lm8K
PiAgb2JqLSQoQ09ORklHX0lOVEVSUlVQVF9DTlQpCQkrPSBpbnRlcnJ1cHQtY250Lm8KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL2NvdW50ZXItY29yZS5jIGIvZHJpdmVycy9jb3VudGVy
L2NvdW50ZXItY29yZS5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAw
MDAuLjE1ZjczNWVmMjk2ZQo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2ZXJzL2NvdW50ZXIv
Y291bnRlci1jb3JlLmMKPiBAQCAtMCwwICsxLDE0NSBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMAo+ICsvKgo+ICsgKiBHZW5lcmljIENvdW50ZXIgaW50ZXJmYWNlCj4g
KyAqIENvcHlyaWdodCAoQykgMjAyMCBXaWxsaWFtIEJyZWF0aGl0dCBHcmF5Cj4gKyAqLwo+ICsj
aW5jbHVkZSA8bGludXgvY291bnRlci5oPgo+ICsjaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+Cj4g
KyNpbmNsdWRlIDxsaW51eC9leHBvcnQuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2dmcC5oPgo+ICsj
aW5jbHVkZSA8bGludXgvaWRyLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9pbml0Lmg+Cj4gKyNpbmNs
dWRlIDxsaW51eC9tb2R1bGUuaD4KPiArCj4gKyNpbmNsdWRlICJjb3VudGVyLXN5c2ZzLmgiCj4g
Kwo+ICsvKiBQcm92aWRlcyBhIHVuaXF1ZSBJRCBmb3IgZWFjaCBjb3VudGVyIGRldmljZSAqLwo+
ICtzdGF0aWMgREVGSU5FX0lEQShjb3VudGVyX2lkYSk7Cj4gKwo+ICtzdGF0aWMgdm9pZCBjb3Vu
dGVyX2RldmljZV9yZWxlYXNlKHN0cnVjdCBkZXZpY2UgKmRldikKPiArewo+ICsJc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKwo+
ICsJY291bnRlcl9jaHJkZXZfcmVtb3ZlKGNvdW50ZXIpOwo+ICsJaWRhX2ZyZWUoJmNvdW50ZXJf
aWRhLCBkZXYtPmlkKTsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBkZXZpY2VfdHlwZSBjb3Vu
dGVyX2RldmljZV90eXBlID0gewo+ICsJLm5hbWUgPSAiY291bnRlcl9kZXZpY2UiLAo+ICsJLnJl
bGVhc2UgPSBjb3VudGVyX2RldmljZV9yZWxlYXNlLAo+ICt9Owo+ICsKPiArc3RhdGljIHN0cnVj
dCBidXNfdHlwZSBjb3VudGVyX2J1c190eXBlID0gewo+ICsJLm5hbWUgPSAiY291bnRlciIsCj4g
KwkuZGV2X25hbWUgPSAiY291bnRlciIsCj4gK307Cj4gKwo+ICsvKioKPiArICogY291bnRlcl9y
ZWdpc3RlciAtIHJlZ2lzdGVyIENvdW50ZXIgdG8gdGhlIHN5c3RlbQo+ICsgKiBAY291bnRlcjoJ
cG9pbnRlciB0byBDb3VudGVyIHRvIHJlZ2lzdGVyCj4gKyAqCj4gKyAqIFRoaXMgZnVuY3Rpb24g
cmVnaXN0ZXJzIGEgQ291bnRlciB0byB0aGUgc3lzdGVtLiBBIHN5c2ZzICJjb3VudGVyIiBkaXJl
Y3RvcnkKPiArICogd2lsbCBiZSBjcmVhdGVkIGFuZCBwb3B1bGF0ZWQgd2l0aCBzeXNmcyBhdHRy
aWJ1dGVzIGNvcnJlbGF0aW5nIHdpdGggdGhlCj4gKyAqIENvdW50ZXIgU2lnbmFscywgU3luYXBz
ZXMsIGFuZCBDb3VudHMgcmVzcGVjdGl2ZWx5Lgo+ICsgKi8KPiAraW50IGNvdW50ZXJfcmVnaXN0
ZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+ICt7Cj4gKwlzdHJ1Y3Qg
ZGV2aWNlICpjb25zdCBkZXYgPSAmY291bnRlci0+ZGV2Owo+ICsJaW50IGlkOwo+ICsJaW50IGVy
cjsKPiArCj4gKwkvKiBBY3F1aXJlIHVuaXF1ZSBJRCAqLwo+ICsJaWQgPSBpZGFfYWxsb2MoJmNv
dW50ZXJfaWRhLCBHRlBfS0VSTkVMKTsKPiArCWlmIChpZCA8IDApCj4gKwkJcmV0dXJuIGlkOwo+
ICsKPiArCS8qIENvbmZpZ3VyZSBkZXZpY2Ugc3RydWN0dXJlIGZvciBDb3VudGVyICovCj4gKwlk
ZXYtPmlkID0gaWQ7Cj4gKwlkZXYtPnR5cGUgPSAmY291bnRlcl9kZXZpY2VfdHlwZTsKPiArCWRl
di0+YnVzID0gJmNvdW50ZXJfYnVzX3R5cGU7Cj4gKwlpZiAoY291bnRlci0+cGFyZW50KSB7Cj4g
KwkJZGV2LT5wYXJlbnQgPSBjb3VudGVyLT5wYXJlbnQ7Cj4gKwkJZGV2LT5vZl9ub2RlID0gY291
bnRlci0+cGFyZW50LT5vZl9ub2RlOwo+ICsJfQo+ICsJZGV2aWNlX2luaXRpYWxpemUoZGV2KTsK
PiArCWRldl9zZXRfZHJ2ZGF0YShkZXYsIGNvdW50ZXIpOwo+ICsKPiArCS8qIEFkZCBDb3VudGVy
IHN5c2ZzIGF0dHJpYnV0ZXMgKi8KPiArCWVyciA9IGNvdW50ZXJfc3lzZnNfYWRkKGNvdW50ZXIp
Owo+ICsJaWYgKGVyciA8IDApCj4gKwkJZ290byBlcnJfZnJlZV9pZDsKPiArCj4gKwkvKiBBZGQg
ZGV2aWNlIHRvIHN5c3RlbSAqLwo+ICsJZXJyID0gZGV2aWNlX2FkZChkZXYpOwo+ICsJaWYgKGVy
ciA8IDApCj4gKwkJZ290byBlcnJfZnJlZV9pZDsKPiArCj4gKwlyZXR1cm4gMDsKPiArCj4gK2Vy
cl9mcmVlX2lkOgo+ICsJcHV0X2RldmljZShkZXYpOwo+ICsJcmV0dXJuIGVycjsKPiArfQo+ICtF
WFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3JlZ2lzdGVyKTsKPiArCj4gKy8qKgo+ICsgKiBjb3Vu
dGVyX3VucmVnaXN0ZXIgLSB1bnJlZ2lzdGVyIENvdW50ZXIgZnJvbSB0aGUgc3lzdGVtCj4gKyAq
IEBjb3VudGVyOglwb2ludGVyIHRvIENvdW50ZXIgdG8gdW5yZWdpc3Rlcgo+ICsgKgo+ICsgKiBU
aGUgQ291bnRlciBpcyB1bnJlZ2lzdGVyZWQgZnJvbSB0aGUgc3lzdGVtLgo+ICsgKi8KPiArdm9p
ZCBjb3VudGVyX3VucmVnaXN0ZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVy
KQo+ICt7Cj4gKwlpZiAoIWNvdW50ZXIpCj4gKwkJcmV0dXJuOwo+ICsKPiArCWRldmljZV91bnJl
Z2lzdGVyKCZjb3VudGVyLT5kZXYpOwo+ICt9Cj4gK0VYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJf
dW5yZWdpc3Rlcik7Cj4gKwo+ICtzdGF0aWMgdm9pZCBkZXZtX2NvdW50ZXJfcmVsZWFzZSh2b2lk
ICpjb3VudGVyKQo+ICt7Cj4gKwljb3VudGVyX3VucmVnaXN0ZXIoY291bnRlcik7Cj4gK30KPiAr
Cj4gKy8qKgo+ICsgKiBkZXZtX2NvdW50ZXJfcmVnaXN0ZXIgLSBSZXNvdXJjZS1tYW5hZ2VkIGNv
dW50ZXJfcmVnaXN0ZXIKPiArICogQGRldjoJZGV2aWNlIHRvIGFsbG9jYXRlIGNvdW50ZXJfZGV2
aWNlIGZvcgo+ICsgKiBAY291bnRlcjoJcG9pbnRlciB0byBDb3VudGVyIHRvIHJlZ2lzdGVyCj4g
KyAqCj4gKyAqIE1hbmFnZWQgY291bnRlcl9yZWdpc3Rlci4gVGhlIENvdW50ZXIgcmVnaXN0ZXJl
ZCB3aXRoIHRoaXMgZnVuY3Rpb24gaXMKPiArICogYXV0b21hdGljYWxseSB1bnJlZ2lzdGVyZWQg
b24gZHJpdmVyIGRldGFjaC4gVGhpcyBmdW5jdGlvbiBjYWxscwo+ICsgKiBjb3VudGVyX3JlZ2lz
dGVyIGludGVybmFsbHkuIFJlZmVyIHRvIHRoYXQgZnVuY3Rpb24gZm9yIG1vcmUgaW5mb3JtYXRp
b24uCj4gKyAqCj4gKyAqIFJFVFVSTlM6Cj4gKyAqIDAgb24gc3VjY2VzcywgbmVnYXRpdmUgZXJy
b3IgbnVtYmVyIG9uIGZhaWx1cmUuCj4gKyAqLwo+ICtpbnQgZGV2bV9jb3VudGVyX3JlZ2lzdGVy
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiArCQkJICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0
IGNvdW50ZXIpCj4gK3sKPiArCWludCBlcnI7Cj4gKwo+ICsJZXJyID0gY291bnRlcl9yZWdpc3Rl
cihjb3VudGVyKTsKPiArCWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJcmV0
dXJuIGRldm1fYWRkX2FjdGlvbl9vcl9yZXNldChkZXYsIGRldm1fY291bnRlcl9yZWxlYXNlLCBj
b3VudGVyKTsKPiArfQo+ICtFWFBPUlRfU1lNQk9MX0dQTChkZXZtX2NvdW50ZXJfcmVnaXN0ZXIp
Owo+ICsKPiArc3RhdGljIGludCBfX2luaXQgY291bnRlcl9pbml0KHZvaWQpCj4gK3sKPiArCXJl
dHVybiBidXNfcmVnaXN0ZXIoJmNvdW50ZXJfYnVzX3R5cGUpOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
dm9pZCBfX2V4aXQgY291bnRlcl9leGl0KHZvaWQpCj4gK3sKPiArCWJ1c191bnJlZ2lzdGVyKCZj
b3VudGVyX2J1c190eXBlKTsKPiArfQo+ICsKPiArc3Vic3lzX2luaXRjYWxsKGNvdW50ZXJfaW5p
dCk7Cj4gK21vZHVsZV9leGl0KGNvdW50ZXJfZXhpdCk7Cj4gKwo+ICtNT0RVTEVfQVVUSE9SKCJX
aWxsaWFtIEJyZWF0aGl0dCBHcmF5IDx2aWxoZWxtLmdyYXlAZ21haWwuY29tPiIpOwo+ICtNT0RV
TEVfREVTQ1JJUFRJT04oIkdlbmVyaWMgQ291bnRlciBpbnRlcmZhY2UiKTsKPiArTU9EVUxFX0xJ
Q0VOU0UoIkdQTCB2MiIpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci1z
eXNmcy5jIGIvZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuYwo+IG5ldyBmaWxlIG1vZGUg
MTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi5kYmI1MDdjOWRhMTEKPiAtLS0gL2Rldi9udWxs
Cj4gKysrIGIvZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuYwo+IEBAIC0wLDAgKzEsODUy
IEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gKy8qCj4gKyAqIEdl
bmVyaWMgQ291bnRlciBzeXNmcyBpbnRlcmZhY2UKPiArICogQ29weXJpZ2h0IChDKSAyMDIwIFdp
bGxpYW0gQnJlYXRoaXR0IEdyYXkKPiArICovCj4gKyNpbmNsdWRlIDxsaW51eC9jb3VudGVyLmg+
Cj4gKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgo+
ICsjaW5jbHVkZSA8bGludXgvZ2ZwLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KPiAr
I2luY2x1ZGUgPGxpbnV4L2tzdHJ0b3guaD4KPiArI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KPiAr
I2luY2x1ZGUgPGxpbnV4L3N0cmluZy5oPgo+ICsjaW5jbHVkZSA8bGludXgvc3lzZnMuaD4KPiAr
I2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4gKwo+ICsjaW5jbHVkZSAiY291bnRlci1zeXNmcy5o
Igo+ICsKPiArLyoqCj4gKyAqIHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAtIENvdW50ZXIgc3lz
ZnMgYXR0cmlidXRlCj4gKyAqIEBkZXZfYXR0cjoJZGV2aWNlIGF0dHJpYnV0ZSBmb3Igc3lzZnMK
PiArICogQGw6CQlub2RlIHRvIGFkZCBDb3VudGVyIGF0dHJpYnV0ZSB0byBhdHRyaWJ1dGUgZ3Jv
dXAgbGlzdAo+ICsgKiBAY29tcDoJQ291bnRlciBjb21wb25lbnQgY2FsbGJhY2tzIGFuZCBkYXRh
Cj4gKyAqIEBzY29wZToJQ291bnRlciBzY29wZSBvZiB0aGUgYXR0cmlidXRlCj4gKyAqIEBwYXJl
bnQ6CXBvaW50ZXIgdG8gdGhlIHBhcmVudCBjb21wb25lbnQKPiArICovCj4gK3N0cnVjdCBjb3Vu
dGVyX2F0dHJpYnV0ZSB7Cj4gKwlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSBkZXZfYXR0cjsKPiAr
CXN0cnVjdCBsaXN0X2hlYWQgbDsKPiArCj4gKwlzdHJ1Y3QgY291bnRlcl9jb21wIGNvbXA7Cj4g
KwllbnVtIGNvdW50ZXJfc2NvcGUgc2NvcGU7Cj4gKwl2b2lkICpwYXJlbnQ7Cj4gK307Cj4gKwo+
ICsjZGVmaW5lIHRvX2NvdW50ZXJfYXR0cmlidXRlKF9kZXZfYXR0cikgXAo+ICsJY29udGFpbmVy
X29mKF9kZXZfYXR0ciwgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlLCBkZXZfYXR0cikKPiArCj4g
Ky8qKgo+ICsgKiBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgLSBjb250YWluZXIgZm9y
IGF0dHJpYnV0ZSBncm91cAo+ICsgKiBAbmFtZToJbmFtZSBvZiB0aGUgYXR0cmlidXRlIGdyb3Vw
Cj4gKyAqIEBhdHRyX2xpc3Q6CWxpc3QgdG8ga2VlcCB0cmFjayBvZiBjcmVhdGVkIGF0dHJpYnV0
ZXMKPiArICogQG51bV9hdHRyOgludW1iZXIgb2YgYXR0cmlidXRlcwo+ICsgKi8KPiArc3RydWN0
IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwIHsKPiArCWNvbnN0IGNoYXIgKm5hbWU7Cj4gKwlzdHJ1
Y3QgbGlzdF9oZWFkIGF0dHJfbGlzdDsKPiArCXNpemVfdCBudW1fYXR0cjsKPiArfTsKPiArCj4g
K3N0YXRpYyBjb25zdCBjaGFyICpjb25zdCBjb3VudGVyX2Z1bmN0aW9uX3N0cltdID0gewo+ICsJ
W0NPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0VdID0gImluY3JlYXNlIiwKPiArCVtDT1VOVEVSX0ZV
TkNUSU9OX0RFQ1JFQVNFXSA9ICJkZWNyZWFzZSIsCj4gKwlbQ09VTlRFUl9GVU5DVElPTl9QVUxT
RV9ESVJFQ1RJT05dID0gInB1bHNlLWRpcmVjdGlvbiIsCj4gKwlbQ09VTlRFUl9GVU5DVElPTl9R
VUFEUkFUVVJFX1gxX0FdID0gInF1YWRyYXR1cmUgeDEgYSIsCj4gKwlbQ09VTlRFUl9GVU5DVElP
Tl9RVUFEUkFUVVJFX1gxX0JdID0gInF1YWRyYXR1cmUgeDEgYiIsCj4gKwlbQ09VTlRFUl9GVU5D
VElPTl9RVUFEUkFUVVJFX1gyX0FdID0gInF1YWRyYXR1cmUgeDIgYSIsCj4gKwlbQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1gyX0JdID0gInF1YWRyYXR1cmUgeDIgYiIsCj4gKwlbQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1g0XSA9ICJxdWFkcmF0dXJlIHg0Igo+ICt9Owo+ICsKPiAr
c3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfc2lnbmFsX3ZhbHVlX3N0cltdID0gewo+
ICsJW0NPVU5URVJfU0lHTkFMX0xFVkVMX0xPV10gPSAibG93IiwKPiArCVtDT1VOVEVSX1NJR05B
TF9MRVZFTF9ISUdIXSA9ICJoaWdoIgo+ICt9Owo+ICsKPiArc3RhdGljIGNvbnN0IGNoYXIgKmNv
bnN0IGNvdW50ZXJfc3luYXBzZV9hY3Rpb25fc3RyW10gPSB7Cj4gKwlbQ09VTlRFUl9TWU5BUFNF
X0FDVElPTl9OT05FXSA9ICJub25lIiwKPiArCVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lO
R19FREdFXSA9ICJyaXNpbmcgZWRnZSIsCj4gKwlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxM
SU5HX0VER0VdID0gImZhbGxpbmcgZWRnZSIsCj4gKwlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9C
T1RIX0VER0VTXSA9ICJib3RoIGVkZ2VzIgo+ICt9Owo+ICsKPiArc3RhdGljIGNvbnN0IGNoYXIg
KmNvbnN0IGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0cltdID0gewo+ICsJW0NPVU5URVJfQ09V
TlRfRElSRUNUSU9OX0ZPUldBUkRdID0gImZvcndhcmQiLAo+ICsJW0NPVU5URVJfQ09VTlRfRElS
RUNUSU9OX0JBQ0tXQVJEXSA9ICJiYWNrd2FyZCIKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCBj
aGFyICpjb25zdCBjb3VudGVyX2NvdW50X21vZGVfc3RyW10gPSB7Cj4gKwlbQ09VTlRFUl9DT1VO
VF9NT0RFX05PUk1BTF0gPSAibm9ybWFsIiwKPiArCVtDT1VOVEVSX0NPVU5UX01PREVfUkFOR0Vf
TElNSVRdID0gInJhbmdlIGxpbWl0IiwKPiArCVtDT1VOVEVSX0NPVU5UX01PREVfTk9OX1JFQ1lD
TEVdID0gIm5vbi1yZWN5Y2xlIiwKPiArCVtDT1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX05dID0g
Im1vZHVsby1uIgo+ICt9Owo+ICsKPiArc3RhdGljIHNzaXplX3QgY291bnRlcl9jb21wX3U4X3No
b3coc3RydWN0IGRldmljZSAqZGV2LAo+ICsJCQkJICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLCBjaGFyICpidWYpCj4gK3sKPiArCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0
ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsJc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKwlpbnQg
ZXJyOwo+ICsJdTggZGF0YSA9IDA7Cj4gKwo+ICsJc3dpdGNoIChhLT5zY29wZSkgewo+ICsJY2Fz
ZSBDT1VOVEVSX1NDT1BFX0RFVklDRToKPiArCQllcnIgPSBhLT5jb21wLmRldmljZV91OF9yZWFk
KGNvdW50ZXIsICZkYXRhKTsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9TSUdO
QUw6Cj4gKwkJZXJyID0gYS0+Y29tcC5zaWduYWxfdThfcmVhZChjb3VudGVyLCBhLT5wYXJlbnQs
ICZkYXRhKTsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9DT1VOVDoKPiArCQll
cnIgPSBhLT5jb21wLmNvdW50X3U4X3JlYWQoY291bnRlciwgYS0+cGFyZW50LCAmZGF0YSk7Cj4g
KwkJYnJlYWs7Cj4gKwlkZWZhdWx0Ogo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsJfQo+ICsJaWYg
KGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwlpZiAoYS0+Y29tcC50eXBlID09IENP
VU5URVJfQ09NUF9CT09MKQo+ICsJCS8qIGRhdGEgc2hvdWxkIGFscmVhZHkgYmUgYm9vbGVhbiBi
dXQgZW5zdXJlIGp1c3QgdG8gYmUgc2FmZSAqLwo+ICsJCWRhdGEgPSAhIWRhdGE7Cj4gKwo+ICsJ
cmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsICh1bnNpZ25lZCBpbnQpZGF0YSk7Cj4gK30KPiAr
Cj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91OF9zdG9yZShzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4gKwkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ICsJCQkJICAg
ICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3sKPiArCWNvbnN0IHN0cnVjdCBjb3Vu
dGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsJ
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRl
dik7Cj4gKwlpbnQgZXJyOwo+ICsJYm9vbCBib29sX2RhdGEgPSAwOwo+ICsJdTggZGF0YSA9IDA7
Cj4gKwo+ICsJaWYgKGEtPmNvbXAudHlwZSA9PSBDT1VOVEVSX0NPTVBfQk9PTCkgewo+ICsJCWVy
ciA9IGtzdHJ0b2Jvb2woYnVmLCAmYm9vbF9kYXRhKTsKPiArCQlkYXRhID0gYm9vbF9kYXRhOwo+
ICsJfSBlbHNlCj4gKwkJZXJyID0ga3N0cnRvdTgoYnVmLCAwLCAmZGF0YSk7Cj4gKwlpZiAoZXJy
IDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCXN3aXRjaCAoYS0+c2NvcGUpIHsKPiArCWNh
c2UgQ09VTlRFUl9TQ09QRV9ERVZJQ0U6Cj4gKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdThfd3Jp
dGUoY291bnRlciwgZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENPVU5URVJfU0NPUEVfU0lH
TkFMOgo+ICsJCWVyciA9IGEtPmNvbXAuc2lnbmFsX3U4X3dyaXRlKGNvdW50ZXIsIGEtPnBhcmVu
dCwgZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4gKwkJ
ZXJyID0gYS0+Y29tcC5jb3VudF91OF93cml0ZShjb3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+
ICsJCWJyZWFrOwo+ICsJZGVmYXVsdDoKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArCWlm
IChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJcmV0dXJuIGxlbjsKPiArfQo+ICsK
PiArc3RhdGljIHNzaXplX3QgY291bnRlcl9jb21wX3UzMl9zaG93KHN0cnVjdCBkZXZpY2UgKmRl
diwKPiArCQkJCSAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikK
PiArewo+ICsJY29uc3Qgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlICpjb25zdCBhID0gdG9fY291
bnRlcl9hdHRyaWJ1dGUoYXR0cik7Cj4gKwlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNv
dW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiArCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F2
YWlsYWJsZSAqY29uc3QgYXZhaWwgPSBhLT5jb21wLnByaXY7Cj4gKwlpbnQgZXJyOwo+ICsJdTMy
IGRhdGEgPSAwOwo+ICsKPiArCXN3aXRjaCAoYS0+c2NvcGUpIHsKPiArCWNhc2UgQ09VTlRFUl9T
Q09QRV9ERVZJQ0U6Cj4gKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdTMyX3JlYWQoY291bnRlciwg
JmRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX1NDT1BFX1NJR05BTDoKPiArCQll
cnIgPSBhLT5jb21wLnNpZ25hbF91MzJfcmVhZChjb3VudGVyLCBhLT5wYXJlbnQsICZkYXRhKTsK
PiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9DT1VOVDoKPiArCQlpZiAoYS0+Y29t
cC50eXBlID09IENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTikKPiArCQkJZXJyID0gYS0+Y29t
cC5hY3Rpb25fcmVhZChjb3VudGVyLCBhLT5wYXJlbnQsCj4gKwkJCQkJCSAgYS0+Y29tcC5wcml2
LCAmZGF0YSk7Cj4gKwkJZWxzZQo+ICsJCQllcnIgPSBhLT5jb21wLmNvdW50X3UzMl9yZWFkKGNv
dW50ZXIsIGEtPnBhcmVudCwgJmRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJZGVmYXVsdDoKPiArCQly
ZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArCWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4g
Kwo+ICsJc3dpdGNoIChhLT5jb21wLnR5cGUpIHsKPiArCWNhc2UgQ09VTlRFUl9DT01QX0ZVTkNU
SU9OOgo+ICsJCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBjb3VudGVyX2Z1bmN0aW9u
X3N0cltkYXRhXSk7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9TSUdOQUxfTEVWRUw6Cj4gKwkJcmV0
dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJXNcbiIsIGNvdW50ZXJfc2lnbmFsX3ZhbHVlX3N0cltkYXRh
XSk7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjoKPiArCQlyZXR1cm4gc3lz
ZnNfZW1pdChidWYsICIlc1xuIiwgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHJbZGF0YV0pOwo+
ICsJY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKPiArCQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIl
c1xuIiwgYXZhaWwtPnN0cnNbZGF0YV0pOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfQ09VTlRfRElS
RUNUSU9OOgo+ICsJCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBjb3VudGVyX2NvdW50
X2RpcmVjdGlvbl9zdHJbZGF0YV0pOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERToK
PiArCQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwgY291bnRlcl9jb3VudF9tb2RlX3N0
cltkYXRhXSk7Cj4gKwlkZWZhdWx0Ogo+ICsJCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAo
dW5zaWduZWQgaW50KWRhdGEpOwo+ICsJfQo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJf
ZmluZF9lbnVtKHUzMiAqY29uc3QgZW51bV9pdGVtLCBjb25zdCB1MzIgKmNvbnN0IGVudW1zLAo+
ICsJCQkgICAgIGNvbnN0IHNpemVfdCBudW1fZW51bXMsIGNvbnN0IGNoYXIgKmNvbnN0IGJ1ZiwK
PiArCQkJICAgICBjb25zdCBjaGFyICpjb25zdCBzdHJpbmdfYXJyYXlbXSkKPiArewo+ICsJc2l6
ZV90IGluZGV4Owo+ICsKPiArCWZvciAoaW5kZXggPSAwOyBpbmRleCA8IG51bV9lbnVtczsgaW5k
ZXgrKykgewo+ICsJCSplbnVtX2l0ZW0gPSBlbnVtc1tpbmRleF07Cj4gKwkJaWYgKHN5c2ZzX3N0
cmVxKGJ1Ziwgc3RyaW5nX2FycmF5WyplbnVtX2l0ZW1dKSkKPiArCQkJcmV0dXJuIDA7Cj4gKwl9
Cj4gKwo+ICsJcmV0dXJuIC1FSU5WQUw7Cj4gK30KPiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50
ZXJfY29tcF91MzJfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+ICsJCQkJICAgICAgc3RydWN0
IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gKwkJCQkgICAgICBjb25zdCBjaGFyICpidWYsIHNp
emVfdCBsZW4pCj4gK3sKPiArCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3Qg
YSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsJc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKwlzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY29uc3QgY291bnQgPSBhLT5wYXJlbnQ7Cj4gKwlzdHJ1Y3QgY291bnRlcl9zeW5h
cHNlICpjb25zdCBzeW5hcHNlID0gYS0+Y29tcC5wcml2Owo+ICsJY29uc3Qgc3RydWN0IGNvdW50
ZXJfYXZhaWxhYmxlICpjb25zdCBhdmFpbCA9IGEtPmNvbXAucHJpdjsKPiArCWludCBlcnI7Cj4g
Kwl1MzIgZGF0YSA9IDA7Cj4gKwo+ICsJc3dpdGNoIChhLT5jb21wLnR5cGUpIHsKPiArCWNhc2Ug
Q09VTlRFUl9DT01QX0ZVTkNUSU9OOgo+ICsJCWVyciA9IGNvdW50ZXJfZmluZF9lbnVtKCZkYXRh
LCBjb3VudC0+ZnVuY3Rpb25zX2xpc3QsCj4gKwkJCQkJY291bnQtPm51bV9mdW5jdGlvbnMsIGJ1
ZiwKPiArCQkJCQljb3VudGVyX2Z1bmN0aW9uX3N0cik7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENP
VU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjoKPiArCQllcnIgPSBjb3VudGVyX2ZpbmRfZW51bSgm
ZGF0YSwgc3luYXBzZS0+YWN0aW9uc19saXN0LAo+ICsJCQkJCXN5bmFwc2UtPm51bV9hY3Rpb25z
LCBidWYsCj4gKwkJCQkJY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHIpOwo+ICsJCWJyZWFrOwo+
ICsJY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKPiArCQllcnIgPSBfX3N5c2ZzX21hdGNoX3N0cmlu
ZyhhdmFpbC0+c3RycywgYXZhaWwtPm51bV9pdGVtcywgYnVmKTsKPiArCQlkYXRhID0gZXJyOwo+
ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERToKPiArCQllcnIgPSBj
b3VudGVyX2ZpbmRfZW51bSgmZGF0YSwgYXZhaWwtPmVudW1zLCBhdmFpbC0+bnVtX2l0ZW1zLAo+
ICsJCQkJCWJ1ZiwgY291bnRlcl9jb3VudF9tb2RlX3N0cik7Cj4gKwkJYnJlYWs7Cj4gKwlkZWZh
dWx0Ogo+ICsJCWVyciA9IGtzdHJ0b3UzMihidWYsIDAsICZkYXRhKTsKPiArCQlicmVhazsKPiAr
CX0KPiArCWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJc3dpdGNoIChhLT5z
Y29wZSkgewo+ICsJY2FzZSBDT1VOVEVSX1NDT1BFX0RFVklDRToKPiArCQllcnIgPSBhLT5jb21w
LmRldmljZV91MzJfd3JpdGUoY291bnRlciwgZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENP
VU5URVJfU0NPUEVfU0lHTkFMOgo+ICsJCWVyciA9IGEtPmNvbXAuc2lnbmFsX3UzMl93cml0ZShj
b3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX1ND
T1BFX0NPVU5UOgo+ICsJCWlmIChhLT5jb21wLnR5cGUgPT0gQ09VTlRFUl9DT01QX1NZTkFQU0Vf
QUNUSU9OKQo+ICsJCQllcnIgPSBhLT5jb21wLmFjdGlvbl93cml0ZShjb3VudGVyLCBjb3VudCwg
c3luYXBzZSwKPiArCQkJCQkJICAgZGF0YSk7Cj4gKwkJZWxzZQo+ICsJCQllcnIgPSBhLT5jb21w
LmNvdW50X3UzMl93cml0ZShjb3VudGVyLCBjb3VudCwgZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwlk
ZWZhdWx0Ogo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsJfQo+ICsJaWYgKGVyciA8IDApCj4gKwkJ
cmV0dXJuIGVycjsKPiArCj4gKwlyZXR1cm4gbGVuOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVf
dCBjb3VudGVyX2NvbXBfdTY0X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+ICsJCQkJICAgICBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICt7Cj4gKwljb25zdCBz
dHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShh
dHRyKTsKPiArCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRf
ZHJ2ZGF0YShkZXYpOwo+ICsJaW50IGVycjsKPiArCXU2NCBkYXRhID0gMDsKPiArCj4gKwlzd2l0
Y2ggKGEtPnNjb3BlKSB7Cj4gKwljYXNlIENPVU5URVJfU0NPUEVfREVWSUNFOgo+ICsJCWVyciA9
IGEtPmNvbXAuZGV2aWNlX3U2NF9yZWFkKGNvdW50ZXIsICZkYXRhKTsKPiArCQlicmVhazsKPiAr
CWNhc2UgQ09VTlRFUl9TQ09QRV9TSUdOQUw6Cj4gKwkJZXJyID0gYS0+Y29tcC5zaWduYWxfdTY0
X3JlYWQoY291bnRlciwgYS0+cGFyZW50LCAmZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENP
VU5URVJfU0NPUEVfQ09VTlQ6Cj4gKwkJZXJyID0gYS0+Y29tcC5jb3VudF91NjRfcmVhZChjb3Vu
dGVyLCBhLT5wYXJlbnQsICZkYXRhKTsKPiArCQlicmVhazsKPiArCWRlZmF1bHQ6Cj4gKwkJcmV0
dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsK
PiArCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVsbHVcbiIsICh1bnNpZ25lZCBsb25nIGxvbmcpZGF0
YSk7Cj4gK30KPiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91NjRfc3RvcmUoc3Ry
dWN0IGRldmljZSAqZGV2LAo+ICsJCQkJICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0
dHIsCj4gKwkJCQkgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3sKPiArCWNv
bnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmli
dXRlKGF0dHIpOwo+ICsJc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2
X2dldF9kcnZkYXRhKGRldik7Cj4gKwlpbnQgZXJyOwo+ICsJdTY0IGRhdGEgPSAwOwo+ICsKPiAr
CWVyciA9IGtzdHJ0b3U2NChidWYsIDAsICZkYXRhKTsKPiArCWlmIChlcnIgPCAwKQo+ICsJCXJl
dHVybiBlcnI7Cj4gKwo+ICsJc3dpdGNoIChhLT5zY29wZSkgewo+ICsJY2FzZSBDT1VOVEVSX1ND
T1BFX0RFVklDRToKPiArCQllcnIgPSBhLT5jb21wLmRldmljZV91NjRfd3JpdGUoY291bnRlciwg
ZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENPVU5URVJfU0NPUEVfU0lHTkFMOgo+ICsJCWVy
ciA9IGEtPmNvbXAuc2lnbmFsX3U2NF93cml0ZShjb3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+
ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX1NDT1BFX0NPVU5UOgo+ICsJCWVyciA9IGEtPmNv
bXAuY291bnRfdTY0X3dyaXRlKGNvdW50ZXIsIGEtPnBhcmVudCwgZGF0YSk7Cj4gKwkJYnJlYWs7
Cj4gKwlkZWZhdWx0Ogo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsJfQo+ICsJaWYgKGVyciA8IDAp
Cj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwlyZXR1cm4gbGVuOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
c3NpemVfdCBlbnVtc19hdmFpbGFibGVfc2hvdyhjb25zdCB1MzIgKmNvbnN0IGVudW1zLAo+ICsJ
CQkJICAgIGNvbnN0IHNpemVfdCBudW1fZW51bXMsCj4gKwkJCQkgICAgY29uc3QgY2hhciAqY29u
c3Qgc3Ryc1tdLCBjaGFyICpidWYpCj4gK3sKPiArCXNpemVfdCBsZW4gPSAwOwo+ICsJc2l6ZV90
IGluZGV4Owo+ICsKPiArCWZvciAoaW5kZXggPSAwOyBpbmRleCA8IG51bV9lbnVtczsgaW5kZXgr
KykKPiArCQlsZW4gKz0gc3lzZnNfZW1pdF9hdChidWYsIGxlbiwgIiVzXG4iLCBzdHJzW2VudW1z
W2luZGV4XV0pOwo+ICsKPiArCXJldHVybiBsZW47Cj4gK30KPiArCj4gK3N0YXRpYyBzc2l6ZV90
IHN0cnNfYXZhaWxhYmxlX3Nob3coY29uc3Qgc3RydWN0IGNvdW50ZXJfYXZhaWxhYmxlICpjb25z
dCBhdmFpbCwKPiArCQkJCSAgIGNoYXIgKmJ1ZikKPiArewo+ICsJc2l6ZV90IGxlbiA9IDA7Cj4g
KwlzaXplX3QgaW5kZXg7Cj4gKwo+ICsJZm9yIChpbmRleCA9IDA7IGluZGV4IDwgYXZhaWwtPm51
bV9pdGVtczsgaW5kZXgrKykKPiArCQlsZW4gKz0gc3lzZnNfZW1pdF9hdChidWYsIGxlbiwgIiVz
XG4iLCBhdmFpbC0+c3Ryc1tpbmRleF0pOwo+ICsKPiArCXJldHVybiBsZW47Cj4gK30KPiArCj4g
K3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF9hdmFpbGFibGVfc2hvdyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4gKwkJCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gKwkJCQkJ
ICAgY2hhciAqYnVmKQo+ICt7Cj4gKwljb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNv
bnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKPiArCWNvbnN0IHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGEtPnBhcmVudDsKPiArCWNvbnN0IHN0cnVjdCBjb3Vu
dGVyX3N5bmFwc2UgKmNvbnN0IHN5bmFwc2UgPSBhLT5jb21wLnByaXY7Cj4gKwljb25zdCBzdHJ1
Y3QgY291bnRlcl9hdmFpbGFibGUgKmNvbnN0IGF2YWlsID0gYS0+Y29tcC5wcml2Owo+ICsKPiAr
CXN3aXRjaCAoYS0+Y29tcC50eXBlKSB7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9GVU5DVElPTjoK
PiArCQlyZXR1cm4gZW51bXNfYXZhaWxhYmxlX3Nob3coY291bnQtPmZ1bmN0aW9uc19saXN0LAo+
ICsJCQkJCSAgICBjb3VudC0+bnVtX2Z1bmN0aW9ucywKPiArCQkJCQkgICAgY291bnRlcl9mdW5j
dGlvbl9zdHIsIGJ1Zik7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjoKPiAr
CQlyZXR1cm4gZW51bXNfYXZhaWxhYmxlX3Nob3coc3luYXBzZS0+YWN0aW9uc19saXN0LAo+ICsJ
CQkJCSAgICBzeW5hcHNlLT5udW1fYWN0aW9ucywKPiArCQkJCQkgICAgY291bnRlcl9zeW5hcHNl
X2FjdGlvbl9zdHIsIGJ1Zik7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9FTlVNOgo+ICsJCXJldHVy
biBzdHJzX2F2YWlsYWJsZV9zaG93KGF2YWlsLCBidWYpOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBf
Q09VTlRfTU9ERToKPiArCQlyZXR1cm4gZW51bXNfYXZhaWxhYmxlX3Nob3coYXZhaWwtPmVudW1z
LCBhdmFpbC0+bnVtX2l0ZW1zLAo+ICsJCQkJCSAgICBjb3VudGVyX2NvdW50X21vZGVfc3RyLCBi
dWYpOwo+ICsJZGVmYXVsdDoKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArfQo+ICsKPiAr
c3RhdGljIGludCBjb3VudGVyX2F2YWlsX2F0dHJfY3JlYXRlKHN0cnVjdCBkZXZpY2UgKmNvbnN0
IGRldiwKPiArCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqY29uc3QgZ3JvdXAsCj4g
Kwljb25zdCBzdHJ1Y3QgY291bnRlcl9jb21wICpjb25zdCBjb21wLCB2b2lkICpjb25zdCBwYXJl
bnQpCj4gK3sKPiArCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY291bnRlcl9hdHRyOwo+ICsJ
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmRldl9hdHRyOwo+ICsKPiArCS8qIEFsbG9jYXRlIENv
dW50ZXIgYXR0cmlidXRlICovCj4gKwljb3VudGVyX2F0dHIgPSBkZXZtX2t6YWxsb2MoZGV2LCBz
aXplb2YoKmNvdW50ZXJfYXR0ciksIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFjb3VudGVyX2F0dHIp
Cj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJLyogQ29uZmlndXJlIENvdW50ZXIgYXR0cmli
dXRlICovCj4gKwljb3VudGVyX2F0dHItPmNvbXAudHlwZSA9IGNvbXAtPnR5cGU7Cj4gKwljb3Vu
dGVyX2F0dHItPmNvbXAucHJpdiA9IGNvbXAtPnByaXY7Cj4gKwljb3VudGVyX2F0dHItPnBhcmVu
dCA9IHBhcmVudDsKPiArCj4gKwkvKiBJbml0aWFsaXplIHN5c2ZzIGF0dHJpYnV0ZSAqLwo+ICsJ
ZGV2X2F0dHIgPSAmY291bnRlcl9hdHRyLT5kZXZfYXR0cjsKPiArCXN5c2ZzX2F0dHJfaW5pdCgm
ZGV2X2F0dHItPmF0dHIpOwo+ICsKPiArCS8qIENvbmZpZ3VyZSBkZXZpY2UgYXR0cmlidXRlICov
Cj4gKwlkZXZfYXR0ci0+YXR0ci5uYW1lID0gZGV2bV9rYXNwcmludGYoZGV2LCBHRlBfS0VSTkVM
LCAiJXNfYXZhaWxhYmxlIiwKPiArCQkJCQkgICAgIGNvbXAtPm5hbWUpOwo+ICsJaWYgKCFkZXZf
YXR0ci0+YXR0ci5uYW1lKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsJZGV2X2F0dHItPmF0dHIu
bW9kZSA9IDA0NDQ7Cj4gKwlkZXZfYXR0ci0+c2hvdyA9IGNvdW50ZXJfY29tcF9hdmFpbGFibGVf
c2hvdzsKPiArCj4gKwkvKiBTdG9yZSBsaXN0IG5vZGUgKi8KPiArCWxpc3RfYWRkKCZjb3VudGVy
X2F0dHItPmwsICZncm91cC0+YXR0cl9saXN0KTsKPiArCWdyb3VwLT5udW1fYXR0cisrOwo+ICsK
PiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJfYXR0cl9jcmVhdGUo
c3RydWN0IGRldmljZSAqY29uc3QgZGV2LAo+ICsJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfYXR0
cmlidXRlX2dyb3VwICpjb25zdCBncm91cCwKPiArCQkJICAgICAgIGNvbnN0IHN0cnVjdCBjb3Vu
dGVyX2NvbXAgKmNvbnN0IGNvbXAsCj4gKwkJCSAgICAgICBjb25zdCBlbnVtIGNvdW50ZXJfc2Nv
cGUgc2NvcGUsCj4gKwkJCSAgICAgICB2b2lkICpjb25zdCBwYXJlbnQpCj4gK3sKPiArCXN0cnVj
dCBjb3VudGVyX2F0dHJpYnV0ZSAqY291bnRlcl9hdHRyOwo+ICsJc3RydWN0IGRldmljZV9hdHRy
aWJ1dGUgKmRldl9hdHRyOwo+ICsKPiArCS8qIEFsbG9jYXRlIENvdW50ZXIgYXR0cmlidXRlICov
Cj4gKwljb3VudGVyX2F0dHIgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmNvdW50ZXJfYXR0
ciksIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFjb3VudGVyX2F0dHIpCj4gKwkJcmV0dXJuIC1FTk9N
RU07Cj4gKwo+ICsJLyogQ29uZmlndXJlIENvdW50ZXIgYXR0cmlidXRlICovCj4gKwljb3VudGVy
X2F0dHItPmNvbXAgPSAqY29tcDsKPiArCWNvdW50ZXJfYXR0ci0+c2NvcGUgPSBzY29wZTsKPiAr
CWNvdW50ZXJfYXR0ci0+cGFyZW50ID0gcGFyZW50Owo+ICsKPiArCS8qIENvbmZpZ3VyZSBkZXZp
Y2UgYXR0cmlidXRlICovCj4gKwlkZXZfYXR0ciA9ICZjb3VudGVyX2F0dHItPmRldl9hdHRyOwo+
ICsJc3lzZnNfYXR0cl9pbml0KCZkZXZfYXR0ci0+YXR0cik7Cj4gKwlkZXZfYXR0ci0+YXR0ci5u
YW1lID0gY29tcC0+bmFtZTsKPiArCXN3aXRjaCAoY29tcC0+dHlwZSkgewo+ICsJY2FzZSBDT1VO
VEVSX0NPTVBfVTg6Cj4gKwljYXNlIENPVU5URVJfQ09NUF9CT09MOgo+ICsJCWlmIChjb21wLT5k
ZXZpY2VfdThfcmVhZCkgewo+ICsJCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDA0NDQ7Cj4gKwkJ
CWRldl9hdHRyLT5zaG93ID0gY291bnRlcl9jb21wX3U4X3Nob3c7Cj4gKwkJfQo+ICsJCWlmIChj
b21wLT5kZXZpY2VfdThfd3JpdGUpIHsKPiArCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAw
Owo+ICsJCQlkZXZfYXR0ci0+c3RvcmUgPSBjb3VudGVyX2NvbXBfdThfc3RvcmU7Cj4gKwkJfQo+
ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfU0lHTkFMX0xFVkVMOgo+ICsJY2FzZSBD
T1VOVEVSX0NPTVBfRlVOQ1RJT046Cj4gKwljYXNlIENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElP
TjoKPiArCWNhc2UgQ09VTlRFUl9DT01QX0VOVU06Cj4gKwljYXNlIENPVU5URVJfQ09NUF9DT1VO
VF9ESVJFQ1RJT046Cj4gKwljYXNlIENPVU5URVJfQ09NUF9DT1VOVF9NT0RFOgo+ICsJCWlmIChj
b21wLT5kZXZpY2VfdTMyX3JlYWQpIHsKPiArCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwNDQ0
Owo+ICsJCQlkZXZfYXR0ci0+c2hvdyA9IGNvdW50ZXJfY29tcF91MzJfc2hvdzsKPiArCQl9Cj4g
KwkJaWYgKGNvbXAtPmRldmljZV91MzJfd3JpdGUpIHsKPiArCQkJZGV2X2F0dHItPmF0dHIubW9k
ZSB8PSAwMjAwOwo+ICsJCQlkZXZfYXR0ci0+c3RvcmUgPSBjb3VudGVyX2NvbXBfdTMyX3N0b3Jl
Owo+ICsJCX0KPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9DT01QX1U2NDoKPiArCQlpZiAo
Y29tcC0+ZGV2aWNlX3U2NF9yZWFkKSB7Cj4gKwkJCWRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDQ0
NDsKPiArCQkJZGV2X2F0dHItPnNob3cgPSBjb3VudGVyX2NvbXBfdTY0X3Nob3c7Cj4gKwkJfQo+
ICsJCWlmIChjb21wLT5kZXZpY2VfdTY0X3dyaXRlKSB7Cj4gKwkJCWRldl9hdHRyLT5hdHRyLm1v
ZGUgfD0gMDIwMDsKPiArCQkJZGV2X2F0dHItPnN0b3JlID0gY291bnRlcl9jb21wX3U2NF9zdG9y
ZTsKPiArCQl9Cj4gKwkJYnJlYWs7Cj4gKwlkZWZhdWx0Ogo+ICsJCXJldHVybiAtRUlOVkFMOwo+
ICsJfQo+ICsKPiArCS8qIFN0b3JlIGxpc3Qgbm9kZSAqLwo+ICsJbGlzdF9hZGQoJmNvdW50ZXJf
YXR0ci0+bCwgJmdyb3VwLT5hdHRyX2xpc3QpOwo+ICsJZ3JvdXAtPm51bV9hdHRyKys7Cj4gKwo+
ICsJLyogQ3JlYXRlICIqX2F2YWlsYWJsZSIgYXR0cmlidXRlIGlmIG5lZWRlZCAqLwo+ICsJc3dp
dGNoIChjb21wLT50eXBlKSB7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9GVU5DVElPTjoKPiArCWNh
c2UgQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OOgo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfRU5V
TToKPiArCWNhc2UgQ09VTlRFUl9DT01QX0NPVU5UX01PREU6Cj4gKwkJcmV0dXJuIGNvdW50ZXJf
YXZhaWxfYXR0cl9jcmVhdGUoZGV2LCBncm91cCwgY29tcCwgcGFyZW50KTsKPiArCWRlZmF1bHQ6
Cj4gKwkJcmV0dXJuIDA7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJf
Y29tcF9uYW1lX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+ICsJCQkJICAgICAgc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiArewo+ICsJcmV0dXJuIHN5c2ZzX2Vt
aXQoYnVmLCAiJXNcbiIsIHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpLT5jb21wLm5hbWUpOwo+
ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJfbmFtZV9hdHRyX2NyZWF0ZShzdHJ1Y3QgZGV2
aWNlICpjb25zdCBkZXYsCj4gKwkJCQkgICAgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3Vw
ICpjb25zdCBncm91cCwKPiArCQkJCSAgICBjb25zdCBjaGFyICpjb25zdCBuYW1lKQo+ICt7Cj4g
KwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNvdW50ZXJfYXR0cjsKPiArCj4gKwkvKiBBbGxv
Y2F0ZSBDb3VudGVyIGF0dHJpYnV0ZSAqLwo+ICsJY291bnRlcl9hdHRyID0gZGV2bV9remFsbG9j
KGRldiwgc2l6ZW9mKCpjb3VudGVyX2F0dHIpLCBHRlBfS0VSTkVMKTsKPiArCWlmICghY291bnRl
cl9hdHRyKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCS8qIENvbmZpZ3VyZSBDb3VudGVy
IGF0dHJpYnV0ZSAqLwo+ICsJY291bnRlcl9hdHRyLT5jb21wLm5hbWUgPSBuYW1lOwo+ICsKPiAr
CS8qIENvbmZpZ3VyZSBkZXZpY2UgYXR0cmlidXRlICovCj4gKwlzeXNmc19hdHRyX2luaXQoJmNv
dW50ZXJfYXR0ci0+ZGV2X2F0dHIuYXR0cik7Cj4gKwljb3VudGVyX2F0dHItPmRldl9hdHRyLmF0
dHIubmFtZSA9ICJuYW1lIjsKPiArCWNvdW50ZXJfYXR0ci0+ZGV2X2F0dHIuYXR0ci5tb2RlID0g
MDQ0NDsKPiArCWNvdW50ZXJfYXR0ci0+ZGV2X2F0dHIuc2hvdyA9IGNvdW50ZXJfY29tcF9uYW1l
X3Nob3c7Cj4gKwo+ICsJLyogU3RvcmUgbGlzdCBub2RlICovCj4gKwlsaXN0X2FkZCgmY291bnRl
cl9hdHRyLT5sLCAmZ3JvdXAtPmF0dHJfbGlzdCk7Cj4gKwlncm91cC0+bnVtX2F0dHIrKzsKPiAr
Cj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgY291
bnRlcl9zaWduYWxfY29tcCA9IHsKPiArCS50eXBlID0gQ09VTlRFUl9DT01QX1NJR05BTF9MRVZF
TCwKPiArCS5uYW1lID0gInNpZ25hbCIsCj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJf
c2lnbmFsX2F0dHJzX2NyZWF0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIs
Cj4gKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGNhdHRyX2dyb3VwLAo+
ICsJc3RydWN0IGNvdW50ZXJfc2lnbmFsICpjb25zdCBzaWduYWwpCj4gK3sKPiArCWNvbnN0IGVu
dW0gY291bnRlcl9zY29wZSBzY29wZSA9IENPVU5URVJfU0NPUEVfU0lHTkFMOwo+ICsJc3RydWN0
IGRldmljZSAqY29uc3QgZGV2ID0gJmNvdW50ZXItPmRldjsKPiArCWludCBlcnI7Cj4gKwlzdHJ1
Y3QgY291bnRlcl9jb21wIGNvbXA7Cj4gKwlzaXplX3QgaTsKPiArCj4gKwkvKiBDcmVhdGUgbWFp
biBTaWduYWwgYXR0cmlidXRlICovCj4gKwljb21wID0gY291bnRlcl9zaWduYWxfY29tcDsKPiAr
CWNvbXAuc2lnbmFsX3UzMl9yZWFkID0gY291bnRlci0+b3BzLT5zaWduYWxfcmVhZDsKPiArCWVy
ciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91cCwgJmNvbXAsIHNjb3BlLCBz
aWduYWwpOwo+ICsJaWYgKGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwkvKiBDcmVh
dGUgU2lnbmFsIG5hbWUgYXR0cmlidXRlICovCj4gKwllcnIgPSBjb3VudGVyX25hbWVfYXR0cl9j
cmVhdGUoZGV2LCBjYXR0cl9ncm91cCwgc2lnbmFsLT5uYW1lKTsKPiArCWlmIChlcnIgPCAwKQo+
ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJLyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBl
eHRlbnNpb24gKi8KPiArCWZvciAoaSA9IDA7IGkgPCBzaWduYWwtPm51bV9leHQ7IGkrKykgewo+
ICsJCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91cCwgc2lnbmFsLT5l
eHQgKyBpLAo+ICsJCQkJCSAgc2NvcGUsIHNpZ25hbCk7Cj4gKwkJaWYgKGVyciA8IDApCj4gKwkJ
CXJldHVybiBlcnI7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBp
bnQgY291bnRlcl9zeXNmc19zaWduYWxzX2FkZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0
IGNvdW50ZXIsCj4gKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGdyb3Vw
cykKPiArewo+ICsJc2l6ZV90IGk7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCS8qIEFkZCBlYWNoIFNp
Z25hbCAqLwo+ICsJZm9yIChpID0gMDsgaSA8IGNvdW50ZXItPm51bV9zaWduYWxzOyBpKyspIHsK
PiArCQkvKiBHZW5lcmF0ZSBTaWduYWwgYXR0cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCj4gKwkJ
Z3JvdXBzW2ldLm5hbWUgPSBkZXZtX2thc3ByaW50ZigmY291bnRlci0+ZGV2LCBHRlBfS0VSTkVM
LAo+ICsJCQkJCQkic2lnbmFsJXp1IiwgaSk7Cj4gKwkJaWYgKCFncm91cHNbaV0ubmFtZSkKPiAr
CQkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJCS8qIENyZWF0ZSBhbGwgYXR0cmlidXRlcyBhc3Nv
Y2lhdGVkIHdpdGggU2lnbmFsICovCj4gKwkJZXJyID0gY291bnRlcl9zaWduYWxfYXR0cnNfY3Jl
YXRlKGNvdW50ZXIsIGdyb3VwcyArIGksCj4gKwkJCQkJCSAgY291bnRlci0+c2lnbmFscyArIGkp
Owo+ICsJCWlmIChlcnIgPCAwKQo+ICsJCQlyZXR1cm4gZXJyOwo+ICsJfQo+ICsKPiArCXJldHVy
biAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJfc3lzZnNfc3luYXBzZXNfYWRkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciwKPiArCXN0cnVjdCBjb3VudGVyX2F0
dHJpYnV0ZV9ncm91cCAqY29uc3QgZ3JvdXAsCj4gKwlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29u
c3QgY291bnQpCj4gK3sKPiArCXNpemVfdCBpOwo+ICsKPiArCS8qIEFkZCBlYWNoIFN5bmFwc2Ug
Ki8KPiArCWZvciAoaSA9IDA7IGkgPCBjb3VudC0+bnVtX3N5bmFwc2VzOyBpKyspIHsKPiArCQlz
dHJ1Y3QgZGV2aWNlICpjb25zdCBkZXYgPSAmY291bnRlci0+ZGV2Owo+ICsJCXN0cnVjdCBjb3Vu
dGVyX3N5bmFwc2UgKnN5bmFwc2U7Cj4gKwkJc2l6ZV90IGlkOwo+ICsJCXN0cnVjdCBjb3VudGVy
X2NvbXAgY29tcDsKPiArCQlpbnQgZXJyOwo+ICsKPiArCQlzeW5hcHNlID0gY291bnQtPnN5bmFw
c2VzICsgaTsKPiArCj4gKwkJLyogR2VuZXJhdGUgU3luYXBzZSBhY3Rpb24gbmFtZSAqLwo+ICsJ
CWlkID0gc3luYXBzZS0+c2lnbmFsIC0gY291bnRlci0+c2lnbmFsczsKPiArCQljb21wLm5hbWUg
PSBkZXZtX2thc3ByaW50ZihkZXYsIEdGUF9LRVJORUwsICJzaWduYWwlenVfYWN0aW9uIiwKPiAr
CQkJCQkgICBpZCk7Cj4gKwkJaWYgKCFjb21wLm5hbWUpCj4gKwkJCXJldHVybiAtRU5PTUVNOwo+
ICsKPiArCQkvKiBDcmVhdGUgYWN0aW9uIGF0dHJpYnV0ZSAqLwo+ICsJCWNvbXAudHlwZSA9IENP
VU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjsKPiArCQljb21wLmFjdGlvbl9yZWFkID0gY291bnRl
ci0+b3BzLT5hY3Rpb25fcmVhZDsKPiArCQljb21wLmFjdGlvbl93cml0ZSA9IGNvdW50ZXItPm9w
cy0+YWN0aW9uX3dyaXRlOwo+ICsJCWNvbXAucHJpdiA9IHN5bmFwc2U7Cj4gKwkJZXJyID0gY291
bnRlcl9hdHRyX2NyZWF0ZShkZXYsIGdyb3VwLCAmY29tcCwKPiArCQkJCQkgIENPVU5URVJfU0NP
UEVfQ09VTlQsIGNvdW50KTsKPiArCQlpZiAoZXJyIDwgMCkKPiArCQkJcmV0dXJuIGVycjsKPiAr
CX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2Nv
bXAgY291bnRlcl9jb3VudF9jb21wID0KPiArCUNPVU5URVJfQ09NUF9DT1VOVF9VNjQoImNvdW50
IiwgTlVMTCwgTlVMTCk7Cj4gKwo+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBjb3VudGVy
X2Z1bmN0aW9uX2NvbXAgPSB7Cj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9GVU5DVElPTiwKPiAr
CS5uYW1lID0gImZ1bmN0aW9uIiwKPiArfTsKPiArCj4gK3N0YXRpYyBpbnQgY291bnRlcl9jb3Vu
dF9hdHRyc19jcmVhdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyLAo+ICsJ
c3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBjYXR0cl9ncm91cCwKPiArCXN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCkKPiArewo+ICsJY29uc3QgZW51bSBjb3Vu
dGVyX3Njb3BlIHNjb3BlID0gQ09VTlRFUl9TQ09QRV9DT1VOVDsKPiArCXN0cnVjdCBkZXZpY2Ug
KmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7Cj4gKwlpbnQgZXJyOwo+ICsJc3RydWN0IGNvdW50
ZXJfY29tcCBjb21wOwo+ICsJc2l6ZV90IGk7Cj4gKwo+ICsJLyogQ3JlYXRlIG1haW4gQ291bnQg
YXR0cmlidXRlICovCj4gKwljb21wID0gY291bnRlcl9jb3VudF9jb21wOwo+ICsJY29tcC5jb3Vu
dF91NjRfcmVhZCA9IGNvdW50ZXItPm9wcy0+Y291bnRfcmVhZDsKPiArCWNvbXAuY291bnRfdTY0
X3dyaXRlID0gY291bnRlci0+b3BzLT5jb3VudF93cml0ZTsKPiArCWVyciA9IGNvdW50ZXJfYXR0
cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91cCwgJmNvbXAsIHNjb3BlLCBjb3VudCk7Cj4gKwlpZiAo
ZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCS8qIENyZWF0ZSBDb3VudCBuYW1lIGF0
dHJpYnV0ZSAqLwo+ICsJZXJyID0gY291bnRlcl9uYW1lX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJf
Z3JvdXAsIGNvdW50LT5uYW1lKTsKPiArCWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4g
Kwo+ICsJLyogQ3JlYXRlIENvdW50IGZ1bmN0aW9uIGF0dHJpYnV0ZSAqLwo+ICsJY29tcCA9IGNv
dW50ZXJfZnVuY3Rpb25fY29tcDsKPiArCWNvbXAuY291bnRfdTMyX3JlYWQgPSBjb3VudGVyLT5v
cHMtPmZ1bmN0aW9uX3JlYWQ7Cj4gKwljb21wLmNvdW50X3UzMl93cml0ZSA9IGNvdW50ZXItPm9w
cy0+ZnVuY3Rpb25fd3JpdGU7Cj4gKwllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0
dHJfZ3JvdXAsICZjb21wLCBzY29wZSwgY291bnQpOwo+ICsJaWYgKGVyciA8IDApCj4gKwkJcmV0
dXJuIGVycjsKPiArCj4gKwkvKiBDcmVhdGUgYW4gYXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lv
biAqLwo+ICsJZm9yIChpID0gMDsgaSA8IGNvdW50LT5udW1fZXh0OyBpKyspIHsKPiArCQllcnIg
PSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsIGNvdW50LT5leHQgKyBpLAo+
ICsJCQkJCSAgc2NvcGUsIGNvdW50KTsKPiArCQlpZiAoZXJyIDwgMCkKPiArCQkJcmV0dXJuIGVy
cjsKPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBjb3VudGVy
X3N5c2ZzX2NvdW50c19hZGQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyLAo+
ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBncm91cHMpCj4gK3sKPiAr
CXNpemVfdCBpOwo+ICsJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50Owo+ICsJaW50IGVycjsK
PiArCj4gKwkvKiBBZGQgZWFjaCBDb3VudCAqLwo+ICsJZm9yIChpID0gMDsgaSA8IGNvdW50ZXIt
Pm51bV9jb3VudHM7IGkrKykgewo+ICsJCWNvdW50ID0gY291bnRlci0+Y291bnRzICsgaTsKPiAr
Cj4gKwkJLyogR2VuZXJhdGUgQ291bnQgYXR0cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCj4gKwkJ
Z3JvdXBzW2ldLm5hbWUgPSBkZXZtX2thc3ByaW50ZigmY291bnRlci0+ZGV2LCBHRlBfS0VSTkVM
LAo+ICsJCQkJCQkiY291bnQlenUiLCBpKTsKPiArCQlpZiAoIWdyb3Vwc1tpXS5uYW1lKQo+ICsJ
CQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwkJLyogQWRkIHN5c2ZzIGF0dHJpYnV0ZXMgb2YgdGhl
IFN5bmFwc2VzICovCj4gKwkJZXJyID0gY291bnRlcl9zeXNmc19zeW5hcHNlc19hZGQoY291bnRl
ciwgZ3JvdXBzICsgaSwgY291bnQpOwo+ICsJCWlmIChlcnIgPCAwKQo+ICsJCQlyZXR1cm4gZXJy
Owo+ICsKPiArCQkvKiBDcmVhdGUgYWxsIGF0dHJpYnV0ZXMgYXNzb2NpYXRlZCB3aXRoIENvdW50
ICovCj4gKwkJZXJyID0gY291bnRlcl9jb3VudF9hdHRyc19jcmVhdGUoY291bnRlciwgZ3JvdXBz
ICsgaSwgY291bnQpOwo+ICsJCWlmIChlcnIgPCAwKQo+ICsJCQlyZXR1cm4gZXJyOwo+ICsJfQo+
ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJfbnVtX3NpZ25h
bHNfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHU4ICp2YWwpCj4gK3sKPiAr
CSp2YWwgPSBjb3VudGVyLT5udW1fc2lnbmFsczsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgaW50IGNvdW50ZXJfbnVtX2NvdW50c19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwgdTggKnZhbCkKPiArewo+ICsJKnZhbCA9IGNvdW50ZXItPm51bV9jb3VudHM7Cj4g
KwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgY291bnRl
cl9udW1fc2lnbmFsc19jb21wID0KPiArCUNPVU5URVJfQ09NUF9ERVZJQ0VfVTgoIm51bV9zaWdu
YWxzIiwgY291bnRlcl9udW1fc2lnbmFsc19yZWFkLCBOVUxMKTsKPiArCj4gK3N0YXRpYyBzdHJ1
Y3QgY291bnRlcl9jb21wIGNvdW50ZXJfbnVtX2NvdW50c19jb21wID0KPiArCUNPVU5URVJfQ09N
UF9ERVZJQ0VfVTgoIm51bV9jb3VudHMiLCBjb3VudGVyX251bV9jb3VudHNfcmVhZCwgTlVMTCk7
Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50ZXJfc3lzZnNfYXR0cl9hZGQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb25zdCBjb3VudGVyLAo+ICsJCQkJICBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVf
Z3JvdXAgKmNhdHRyX2dyb3VwKQo+ICt7Cj4gKwljb25zdCBlbnVtIGNvdW50ZXJfc2NvcGUgc2Nv
cGUgPSBDT1VOVEVSX1NDT1BFX0RFVklDRTsKPiArCXN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9
ICZjb3VudGVyLT5kZXY7Cj4gKwlpbnQgZXJyOwo+ICsJc2l6ZV90IGk7Cj4gKwo+ICsJLyogQWRk
IFNpZ25hbHMgc3lzZnMgYXR0cmlidXRlcyAqLwo+ICsJZXJyID0gY291bnRlcl9zeXNmc19zaWdu
YWxzX2FkZChjb3VudGVyLCBjYXR0cl9ncm91cCk7Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1
cm4gZXJyOwo+ICsJY2F0dHJfZ3JvdXAgKz0gY291bnRlci0+bnVtX3NpZ25hbHM7Cj4gKwo+ICsJ
LyogQWRkIENvdW50cyBzeXNmcyBhdHRyaWJ1dGVzICovCj4gKwllcnIgPSBjb3VudGVyX3N5c2Zz
X2NvdW50c19hZGQoY291bnRlciwgY2F0dHJfZ3JvdXApOwo+ICsJaWYgKGVyciA8IDApCj4gKwkJ
cmV0dXJuIGVycjsKPiArCWNhdHRyX2dyb3VwICs9IGNvdW50ZXItPm51bV9jb3VudHM7Cj4gKwo+
ICsJLyogQ3JlYXRlIG5hbWUgYXR0cmlidXRlICovCj4gKwllcnIgPSBjb3VudGVyX25hbWVfYXR0
cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91cCwgY291bnRlci0+bmFtZSk7Cj4gKwlpZiAoZXJyIDwg
MCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCS8qIENyZWF0ZSBudW1fc2lnbmFscyBhdHRyaWJ1
dGUgKi8KPiArCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91cCwgJmNv
dW50ZXJfbnVtX3NpZ25hbHNfY29tcCwKPiArCQkJCSAgc2NvcGUsIE5VTEwpOwo+ICsJaWYgKGVy
ciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwkvKiBDcmVhdGUgbnVtX2NvdW50cyBhdHRy
aWJ1dGUgKi8KPiArCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91cCwg
JmNvdW50ZXJfbnVtX2NvdW50c19jb21wLAo+ICsJCQkJICBzY29wZSwgTlVMTCk7Cj4gKwlpZiAo
ZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCS8qIENyZWF0ZSBhbiBhdHRyaWJ1dGUg
Zm9yIGVhY2ggZXh0ZW5zaW9uICovCj4gKwlmb3IgKGkgPSAwOyBpIDwgY291bnRlci0+bnVtX2V4
dDsgaSsrKSB7Cj4gKwkJZXJyID0gY291bnRlcl9hdHRyX2NyZWF0ZShkZXYsIGNhdHRyX2dyb3Vw
LCBjb3VudGVyLT5leHQgKyBpLAo+ICsJCQkJCSAgc2NvcGUsIE5VTEwpOwo+ICsJCWlmIChlcnIg
PCAwKQo+ICsJCQlyZXR1cm4gZXJyOwo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+
ICsvKioKPiArICogY291bnRlcl9zeXNmc19hZGQgLSBBZGRzIENvdW50ZXIgc3lzZnMgYXR0cmli
dXRlcyB0byB0aGUgZGV2aWNlIHN0cnVjdHVyZQo+ICsgKiBAY291bnRlcjoJUG9pbnRlciB0byB0
aGUgQ291bnRlciBkZXZpY2Ugc3RydWN0dXJlCj4gKyAqCj4gKyAqIENvdW50ZXIgc3lzZnMgYXR0
cmlidXRlcyBhcmUgY3JlYXRlZCBhbmQgYWRkZWQgdG8gdGhlIHJlc3BlY3RpdmUgZGV2aWNlCj4g
KyAqIHN0cnVjdHVyZSBmb3IgbGF0ZXIgcmVnaXN0cmF0aW9uIHRvIHRoZSBzeXN0ZW0uIFJlc291
cmNlLW1hbmFnZWQgbWVtb3J5Cj4gKyAqIGFsbG9jYXRpb24gaXMgcGVyZm9ybWVkIGJ5IHRoaXMg
ZnVuY3Rpb24sIGFuZCB0aGlzIG1lbW9yeSBzaG91bGQgYmUgZnJlZWQKPiArICogd2hlbiBubyBs
b25nZXIgbmVlZGVkIChhdXRvbWF0aWNhbGx5IGJ5IGEgZGV2aWNlX3VucmVnaXN0ZXIgY2FsbCwg
b3IKPiArICogbWFudWFsbHkgYnkgYSBkZXZyZXNfcmVsZWFzZV9hbGwgY2FsbCkuCj4gKyAqLwo+
ICtpbnQgY291bnRlcl9zeXNmc19hZGQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3Vu
dGVyKQo+ICt7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpjb25zdCBkZXYgPSAmY291bnRlci0+ZGV2Owo+
ICsJY29uc3Qgc2l6ZV90IG51bV9ncm91cHMgPSBjb3VudGVyLT5udW1fc2lnbmFscyArIGNvdW50
ZXItPm51bV9jb3VudHMgKyAxOwo+ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpj
YXR0cl9ncm91cHM7Cj4gKwlzaXplX3QgaSwgajsKPiArCWludCBlcnI7Cj4gKwlzdHJ1Y3QgYXR0
cmlidXRlX2dyb3VwICpncm91cHM7Cj4gKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKnA7Cj4g
Kwo+ICsJLyogQWxsb2NhdGUgc3BhY2UgZm9yIGF0dHJpYnV0ZSBncm91cHMgKHNpZ25hbHMsIGNv
dW50cywgYW5kIGV4dCkgKi8KPiArCWNhdHRyX2dyb3VwcyA9IGRldm1fa2NhbGxvYyhkZXYsIG51
bV9ncm91cHMsIHNpemVvZigqY2F0dHJfZ3JvdXBzKSwKPiArCQkJCSAgICBHRlBfS0VSTkVMKTsK
PiArCWlmICghY2F0dHJfZ3JvdXBzKQo+ICsJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCS8qIElu
aXRpYWxpemUgYXR0cmlidXRlIGxpc3RzICovCj4gKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2dyb3Vw
czsgaSsrKQo+ICsJCUlOSVRfTElTVF9IRUFEKCZjYXR0cl9ncm91cHNbaV0uYXR0cl9saXN0KTsK
PiArCj4gKwkvKiBBZGQgQ291bnRlciBkZXZpY2Ugc3lzZnMgYXR0cmlidXRlcyAqLwo+ICsJZXJy
ID0gY291bnRlcl9zeXNmc19hdHRyX2FkZChjb3VudGVyLCBjYXR0cl9ncm91cHMpOwo+ICsJaWYg
KGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwkvKiBBbGxvY2F0ZSBhdHRyaWJ1dGUg
Z3JvdXAgcG9pbnRlcnMgZm9yIGFzc29jaWF0aW9uIHdpdGggZGV2aWNlICovCj4gKwlkZXYtPmdy
b3VwcyA9IGRldm1fa2NhbGxvYyhkZXYsIG51bV9ncm91cHMgKyAxLCBzaXplb2YoKmRldi0+Z3Jv
dXBzKSwKPiArCQkJCSAgIEdGUF9LRVJORUwpOwo+ICsJaWYgKCFkZXYtPmdyb3VwcykKPiArCQly
ZXR1cm4gLUVOT01FTTsKPiArCj4gKwkvKiBBbGxvY2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIGdy
b3VwcyAqLwo+ICsJZ3JvdXBzID0gZGV2bV9rY2FsbG9jKGRldiwgbnVtX2dyb3Vwcywgc2l6ZW9m
KCpncm91cHMpLCBHRlBfS0VSTkVMKTsKPiArCWlmICghZ3JvdXBzKQo+ICsJCXJldHVybiAtRU5P
TUVNOwo+ICsKPiArCS8qIFByZXBhcmUgZWFjaCBncm91cCBvZiBhdHRyaWJ1dGVzIGZvciBhc3Nv
Y2lhdGlvbiAqLwo+ICsJZm9yIChpID0gMDsgaSA8IG51bV9ncm91cHM7IGkrKykgewo+ICsJCWdy
b3Vwc1tpXS5uYW1lID0gY2F0dHJfZ3JvdXBzW2ldLm5hbWU7Cj4gKwo+ICsJCS8qIEFsbG9jYXRl
IHNwYWNlIGZvciBhdHRyaWJ1dGUgcG9pbnRlcnMgKi8KPiArCQlncm91cHNbaV0uYXR0cnMgPSBk
ZXZtX2tjYWxsb2MoZGV2LAo+ICsJCQkJCSAgICAgICBjYXR0cl9ncm91cHNbaV0ubnVtX2F0dHIg
KyAxLAo+ICsJCQkJCSAgICAgICBzaXplb2YoKmdyb3Vwc1tpXS5hdHRycyksCj4gKwkJCQkJICAg
ICAgIEdGUF9LRVJORUwpOwo+ICsJCWlmICghZ3JvdXBzW2ldLmF0dHJzKQo+ICsJCQlyZXR1cm4g
LUVOT01FTTsKPiArCj4gKwkJLyogQWRkIGF0dHJpYnV0ZSBwb2ludGVycyB0byBhdHRyaWJ1dGUg
Z3JvdXAgKi8KPiArCQlqID0gMDsKPiArCQlsaXN0X2Zvcl9lYWNoX2VudHJ5KHAsICZjYXR0cl9n
cm91cHNbaV0uYXR0cl9saXN0LCBsKQo+ICsJCQlncm91cHNbaV0uYXR0cnNbaisrXSA9ICZwLT5k
ZXZfYXR0ci5hdHRyOwo+ICsKPiArCQkvKiBBc3NvY2lhdGUgYXR0cmlidXRlIGdyb3VwICovCj4g
KwkJZGV2LT5ncm91cHNbaV0gPSAmZ3JvdXBzW2ldOwo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+
ICt9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmggYi9kcml2
ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5oCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRl
eCAwMDAwMDAwMDAwMDAuLjE0ZmU1NjZhY2EwZQo+IC0tLSAvZGV2L251bGwKPiArKysgYi9kcml2
ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5oCj4gQEAgLTAsMCArMSwxMyBAQAo+ICsvKiBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwo+ICsvKgo+ICsgKiBDb3VudGVyIHN5c2Zz
IGludGVyZmFjZQo+ICsgKiBDb3B5cmlnaHQgKEMpIDIwMjAgV2lsbGlhbSBCcmVhdGhpdHQgR3Jh
eQo+ICsgKi8KPiArI2lmbmRlZiBfQ09VTlRFUl9TWVNGU19IXwo+ICsjZGVmaW5lIF9DT1VOVEVS
X1NZU0ZTX0hfCj4gKwo+ICsjaW5jbHVkZSA8bGludXgvY291bnRlci5oPgo+ICsKPiAraW50IGNv
dW50ZXJfc3lzZnNfYWRkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcik7Cj4g
Kwo+ICsjZW5kaWYgLyogX0NPVU5URVJfU1lTRlNfSF8gKi8KPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9jb3VudGVyL2NvdW50ZXIuYyBiL2RyaXZlcnMvY291bnRlci9jb3VudGVyLmMKPiBkZWxldGVk
IGZpbGUgbW9kZSAxMDA2NDQKPiBpbmRleCBkZTkyMWU4YTNmNzIuLjAwMDAwMDAwMDAwMAo+IC0t
LSBhL2RyaXZlcnMvY291bnRlci9jb3VudGVyLmMKPiArKysgL2Rldi9udWxsCj4gQEAgLTEsMTQ5
NiArMCwwIEBACj4gLS8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gLS8qCj4g
LSAqIEdlbmVyaWMgQ291bnRlciBpbnRlcmZhY2UKPiAtICogQ29weXJpZ2h0IChDKSAyMDE4IFdp
bGxpYW0gQnJlYXRoaXR0IEdyYXkKPiAtICovCj4gLSNpbmNsdWRlIDxsaW51eC9jb3VudGVyLmg+
Cj4gLSNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgo+
IC0jaW5jbHVkZSA8bGludXgvZXhwb3J0Lmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9mcy5oPgo+IC0j
aW5jbHVkZSA8bGludXgvZ2ZwLmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9pZHIuaD4KPiAtI2luY2x1
ZGUgPGxpbnV4L2luaXQuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgo+IC0jaW5jbHVk
ZSA8bGludXgvbGlzdC5oPgo+IC0jaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Cj4gLSNpbmNsdWRl
IDxsaW51eC9wcmludGsuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4KPiAtI2luY2x1ZGUg
PGxpbnV4L3N0cmluZy5oPgo+IC0jaW5jbHVkZSA8bGludXgvc3lzZnMuaD4KPiAtI2luY2x1ZGUg
PGxpbnV4L3R5cGVzLmg+Cj4gLQo+IC1jb25zdCBjaGFyICpjb25zdCBjb3VudGVyX2NvdW50X2Rp
cmVjdGlvbl9zdHJbMl0gPSB7Cj4gLQlbQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fRk9SV0FSRF0g
PSAiZm9yd2FyZCIsCj4gLQlbQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fQkFDS1dBUkRdID0gImJh
Y2t3YXJkIgo+IC19Owo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX2NvdW50X2RpcmVjdGlv
bl9zdHIpOwo+IC0KPiAtY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9jb3VudF9tb2RlX3N0cls0
XSA9IHsKPiAtCVtDT1VOVEVSX0NPVU5UX01PREVfTk9STUFMXSA9ICJub3JtYWwiLAo+IC0JW0NP
VU5URVJfQ09VTlRfTU9ERV9SQU5HRV9MSU1JVF0gPSAicmFuZ2UgbGltaXQiLAo+IC0JW0NPVU5U
RVJfQ09VTlRfTU9ERV9OT05fUkVDWUNMRV0gPSAibm9uLXJlY3ljbGUiLAo+IC0JW0NPVU5URVJf
Q09VTlRfTU9ERV9NT0RVTE9fTl0gPSAibW9kdWxvLW4iCj4gLX07Cj4gLUVYUE9SVF9TWU1CT0xf
R1BMKGNvdW50ZXJfY291bnRfbW9kZV9zdHIpOwo+IC0KPiAtc3NpemVfdCBjb3VudGVyX3NpZ25h
bF9lbnVtX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJIHN0cnVj
dCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2LAo+IC0JCQkJIGNoYXIgKmJ1ZikK
PiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0ICpjb25zdCBlID0g
cHJpdjsKPiAtCWludCBlcnI7Cj4gLQlzaXplX3QgaW5kZXg7Cj4gLQo+IC0JaWYgKCFlLT5nZXQp
Cj4gLQkJcmV0dXJuIC1FSU5WQUw7Cj4gLQo+IC0JZXJyID0gZS0+Z2V0KGNvdW50ZXIsIHNpZ25h
bCwgJmluZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVycjsKPiAtCj4gLQlpZiAoaW5k
ZXggPj0gZS0+bnVtX2l0ZW1zKQo+IC0JCXJldHVybiAtRUlOVkFMOwo+IC0KPiAtCXJldHVybiBz
cHJpbnRmKGJ1ZiwgIiVzXG4iLCBlLT5pdGVtc1tpbmRleF0pOwo+IC19Cj4gLUVYUE9SVF9TWU1C
T0xfR1BMKGNvdW50ZXJfc2lnbmFsX2VudW1fcmVhZCk7Cj4gLQo+IC1zc2l6ZV90IGNvdW50ZXJf
c2lnbmFsX2VudW1fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJ
ICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdiwKPiAtCQkJCSAgY29u
c3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9z
aWduYWxfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+IC0Jc3NpemVfdCBpbmRleDsKPiAtCWlu
dCBlcnI7Cj4gLQo+IC0JaWYgKCFlLT5zZXQpCj4gLQkJcmV0dXJuIC1FSU5WQUw7Cj4gLQo+IC0J
aW5kZXggPSBfX3N5c2ZzX21hdGNoX3N0cmluZyhlLT5pdGVtcywgZS0+bnVtX2l0ZW1zLCBidWYp
Owo+IC0JaWYgKGluZGV4IDwgMCkKPiAtCQlyZXR1cm4gaW5kZXg7Cj4gLQo+IC0JZXJyID0gZS0+
c2V0KGNvdW50ZXIsIHNpZ25hbCwgaW5kZXgpOwo+IC0JaWYgKGVycikKPiAtCQlyZXR1cm4gZXJy
Owo+IC0KPiAtCXJldHVybiBsZW47Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9z
aWduYWxfZW51bV93cml0ZSk7Cj4gLQo+IC1zc2l6ZV90IGNvdW50ZXJfc2lnbmFsX2VudW1fYXZh
aWxhYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgIHN0
cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+IC0JCQkJCSAgIHZvaWQgKnByaXYsIGNoYXIg
KmJ1ZikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0ICpjb25z
dCBlID0gcHJpdjsKPiAtCXNpemVfdCBpOwo+IC0Jc2l6ZV90IGxlbiA9IDA7Cj4gLQo+IC0JaWYg
KCFlLT5udW1faXRlbXMpCj4gLQkJcmV0dXJuIDA7Cj4gLQo+IC0JZm9yIChpID0gMDsgaSA8IGUt
Pm51bV9pdGVtczsgaSsrKQo+IC0JCWxlbiArPSBzcHJpbnRmKGJ1ZiArIGxlbiwgIiVzXG4iLCBl
LT5pdGVtc1tpXSk7Cj4gLQo+IC0JcmV0dXJuIGxlbjsKPiAtfQo+IC1FWFBPUlRfU1lNQk9MX0dQ
TChjb3VudGVyX3NpZ25hbF9lbnVtX2F2YWlsYWJsZV9yZWFkKTsKPiAtCj4gLXNzaXplX3QgY291
bnRlcl9jb3VudF9lbnVtX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0J
CQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2LAo+IC0JCQkJY2hhciAq
YnVmKQo+IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4dCAqY29uc3Qg
ZSA9IHByaXY7Cj4gLQlpbnQgZXJyOwo+IC0Jc2l6ZV90IGluZGV4Owo+IC0KPiAtCWlmICghZS0+
Z2V0KQo+IC0JCXJldHVybiAtRUlOVkFMOwo+IC0KPiAtCWVyciA9IGUtPmdldChjb3VudGVyLCBj
b3VudCwgJmluZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVycjsKPiAtCj4gLQlpZiAo
aW5kZXggPj0gZS0+bnVtX2l0ZW1zKQo+IC0JCXJldHVybiAtRUlOVkFMOwo+IC0KPiAtCXJldHVy
biBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBlLT5pdGVtc1tpbmRleF0pOwo+IC19Cj4gLUVYUE9SVF9T
WU1CT0xfR1BMKGNvdW50ZXJfY291bnRfZW51bV9yZWFkKTsKPiAtCj4gLXNzaXplX3QgY291bnRl
cl9jb3VudF9lbnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJ
CSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXYsCj4gLQkJCQkgY29uc3Qg
Y2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3Vu
dF9lbnVtX2V4dCAqY29uc3QgZSA9IHByaXY7Cj4gLQlzc2l6ZV90IGluZGV4Owo+IC0JaW50IGVy
cjsKPiAtCj4gLQlpZiAoIWUtPnNldCkKPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4gLQlpbmRl
eCA9IF9fc3lzZnNfbWF0Y2hfc3RyaW5nKGUtPml0ZW1zLCBlLT5udW1faXRlbXMsIGJ1Zik7Cj4g
LQlpZiAoaW5kZXggPCAwKQo+IC0JCXJldHVybiBpbmRleDsKPiAtCj4gLQllcnIgPSBlLT5zZXQo
Y291bnRlciwgY291bnQsIGluZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVycjsKPiAt
Cj4gLQlyZXR1cm4gbGVuOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfY291bnRf
ZW51bV93cml0ZSk7Cj4gLQo+IC1zc2l6ZV90IGNvdW50ZXJfY291bnRfZW51bV9hdmFpbGFibGVf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkJICB2b2lkICpwcml2LCBjaGFyICpidWYpCj4gLXsK
PiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2VudW1fZXh0ICpjb25zdCBlID0gcHJpdjsK
PiAtCXNpemVfdCBpOwo+IC0Jc2l6ZV90IGxlbiA9IDA7Cj4gLQo+IC0JaWYgKCFlLT5udW1faXRl
bXMpCj4gLQkJcmV0dXJuIDA7Cj4gLQo+IC0JZm9yIChpID0gMDsgaSA8IGUtPm51bV9pdGVtczsg
aSsrKQo+IC0JCWxlbiArPSBzcHJpbnRmKGJ1ZiArIGxlbiwgIiVzXG4iLCBlLT5pdGVtc1tpXSk7
Cj4gLQo+IC0JcmV0dXJuIGxlbjsKPiAtfQo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX2Nv
dW50X2VudW1fYXZhaWxhYmxlX3JlYWQpOwo+IC0KPiAtc3NpemVfdCBjb3VudGVyX2RldmljZV9l
bnVtX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LAo+IC0J
CQkJIGNoYXIgKmJ1ZikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2VudW1f
ZXh0ICpjb25zdCBlID0gcHJpdjsKPiAtCWludCBlcnI7Cj4gLQlzaXplX3QgaW5kZXg7Cj4gLQo+
IC0JaWYgKCFlLT5nZXQpCj4gLQkJcmV0dXJuIC1FSU5WQUw7Cj4gLQo+IC0JZXJyID0gZS0+Z2V0
KGNvdW50ZXIsICZpbmRleCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBlcnI7Cj4gLQo+IC0J
aWYgKGluZGV4ID49IGUtPm51bV9pdGVtcykKPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4gLQly
ZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgZS0+aXRlbXNbaW5kZXhdKTsKPiAtfQo+IC1FWFBP
UlRfU1lNQk9MX0dQTChjb3VudGVyX2RldmljZV9lbnVtX3JlYWQpOwo+IC0KPiAtc3NpemVfdCBj
b3VudGVyX2RldmljZV9lbnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwg
dm9pZCAqcHJpdiwKPiAtCQkJCSAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17Cj4g
LQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+
IC0Jc3NpemVfdCBpbmRleDsKPiAtCWludCBlcnI7Cj4gLQo+IC0JaWYgKCFlLT5zZXQpCj4gLQkJ
cmV0dXJuIC1FSU5WQUw7Cj4gLQo+IC0JaW5kZXggPSBfX3N5c2ZzX21hdGNoX3N0cmluZyhlLT5p
dGVtcywgZS0+bnVtX2l0ZW1zLCBidWYpOwo+IC0JaWYgKGluZGV4IDwgMCkKPiAtCQlyZXR1cm4g
aW5kZXg7Cj4gLQo+IC0JZXJyID0gZS0+c2V0KGNvdW50ZXIsIGluZGV4KTsKPiAtCWlmIChlcnIp
Cj4gLQkJcmV0dXJuIGVycjsKPiAtCj4gLQlyZXR1cm4gbGVuOwo+IC19Cj4gLUVYUE9SVF9TWU1C
T0xfR1BMKGNvdW50ZXJfZGV2aWNlX2VudW1fd3JpdGUpOwo+IC0KPiAtc3NpemVfdCBjb3VudGVy
X2RldmljZV9lbnVtX2F2YWlsYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtCQkJCQkgICB2b2lkICpwcml2LCBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVj
dCBjb3VudGVyX2RldmljZV9lbnVtX2V4dCAqY29uc3QgZSA9IHByaXY7Cj4gLQlzaXplX3QgaTsK
PiAtCXNpemVfdCBsZW4gPSAwOwo+IC0KPiAtCWlmICghZS0+bnVtX2l0ZW1zKQo+IC0JCXJldHVy
biAwOwo+IC0KPiAtCWZvciAoaSA9IDA7IGkgPCBlLT5udW1faXRlbXM7IGkrKykKPiAtCQlsZW4g
Kz0gc3ByaW50ZihidWYgKyBsZW4sICIlc1xuIiwgZS0+aXRlbXNbaV0pOwo+IC0KPiAtCXJldHVy
biBsZW47Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9kZXZpY2VfZW51bV9hdmFp
bGFibGVfcmVhZCk7Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gewo+IC0Jc3RydWN0
IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmdyb3VwOwo+IC0JY29uc3QgY2hhciAqcHJlZml4
Owo+IC0JY29uc3QgY2hhciAqbmFtZTsKPiAtCXNzaXplX3QgKCpzaG93KShzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+IC0JCQljaGFyICpidWYpOwo+
IC0Jc3NpemVfdCAoKnN0b3JlKShzdHJ1Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCBkZXZpY2VfYXR0
cmlidXRlICphdHRyLAo+IC0JCQkgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKTsKPiAtCXZv
aWQgKmNvbXBvbmVudDsKPiAtfTsKPiAtCj4gLXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyIHsK
PiAtCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlIGRldl9hdHRyOwo+IC0Jc3RydWN0IGxpc3RfaGVh
ZCBsOwo+IC0Jdm9pZCAqY29tcG9uZW50Owo+IC19Owo+IC0KPiAtc3RhdGljIGludCBjb3VudGVy
X2F0dHJpYnV0ZV9jcmVhdGUoY29uc3Qgc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtICpjb25zdCBw
YXJtKQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY291bnRlcl9hdHRyOwo+
IC0Jc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmRldl9hdHRyOwo+IC0JaW50IGVycjsKPiAtCXN0
cnVjdCBsaXN0X2hlYWQgKmNvbnN0IGF0dHJfbGlzdCA9ICZwYXJtLT5ncm91cC0+YXR0cl9saXN0
Owo+IC0KPiAtCS8qIEFsbG9jYXRlIGEgQ291bnRlciBkZXZpY2UgYXR0cmlidXRlICovCj4gLQlj
b3VudGVyX2F0dHIgPSBremFsbG9jKHNpemVvZigqY291bnRlcl9hdHRyKSwgR0ZQX0tFUk5FTCk7
Cj4gLQlpZiAoIWNvdW50ZXJfYXR0cikKPiAtCQlyZXR1cm4gLUVOT01FTTsKPiAtCWRldl9hdHRy
ID0gJmNvdW50ZXJfYXR0ci0+ZGV2X2F0dHI7Cj4gLQo+IC0Jc3lzZnNfYXR0cl9pbml0KCZkZXZf
YXR0ci0+YXR0cik7Cj4gLQo+IC0JLyogQ29uZmlndXJlIGRldmljZSBhdHRyaWJ1dGUgKi8KPiAt
CWRldl9hdHRyLT5hdHRyLm5hbWUgPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgIiVzJXMiLCBwYXJt
LT5wcmVmaXgsCj4gLQkJCQkJcGFybS0+bmFtZSk7Cj4gLQlpZiAoIWRldl9hdHRyLT5hdHRyLm5h
bWUpIHsKPiAtCQllcnIgPSAtRU5PTUVNOwo+IC0JCWdvdG8gZXJyX2ZyZWVfY291bnRlcl9hdHRy
Owo+IC0JfQo+IC0JaWYgKHBhcm0tPnNob3cpIHsKPiAtCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9
IDA0NDQ7Cj4gLQkJZGV2X2F0dHItPnNob3cgPSBwYXJtLT5zaG93Owo+IC0JfQo+IC0JaWYgKHBh
cm0tPnN0b3JlKSB7Cj4gLQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAwOwo+IC0JCWRldl9h
dHRyLT5zdG9yZSA9IHBhcm0tPnN0b3JlOwo+IC0JfQo+IC0KPiAtCS8qIFN0b3JlIGFzc29jaWF0
ZWQgQ291bnRlciBjb21wb25lbnQgd2l0aCBhdHRyaWJ1dGUgKi8KPiAtCWNvdW50ZXJfYXR0ci0+
Y29tcG9uZW50ID0gcGFybS0+Y29tcG9uZW50Owo+IC0KPiAtCS8qIEtlZXAgdHJhY2sgb2YgdGhl
IGF0dHJpYnV0ZSBmb3IgbGF0ZXIgY2xlYW51cCAqLwo+IC0JbGlzdF9hZGQoJmNvdW50ZXJfYXR0
ci0+bCwgYXR0cl9saXN0KTsKPiAtCXBhcm0tPmdyb3VwLT5udW1fYXR0cisrOwo+IC0KPiAtCXJl
dHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfY291bnRlcl9hdHRyOgo+IC0Ja2ZyZWUoY291bnRlcl9h
dHRyKTsKPiAtCXJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLSNkZWZpbmUgdG9fY291bnRlcl9hdHRy
KF9kZXZfYXR0cikgXAo+IC0JY29udGFpbmVyX29mKF9kZXZfYXR0ciwgc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2F0dHIsIGRldl9hdHRyKQo+IC0KPiAtc3RydWN0IGNvdW50ZXJfc2lnbmFsX3VuaXQg
ewo+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWw7Cj4gLX07Cj4gLQo+IC1zdGF0aWMg
Y29uc3QgY2hhciAqY29uc3QgY291bnRlcl9zaWduYWxfbGV2ZWxfc3RyW10gPSB7Cj4gLQlbQ09V
TlRFUl9TSUdOQUxfTEVWRUxfTE9XXSA9ICJsb3ciLAo+IC0JW0NPVU5URVJfU0lHTkFMX0xFVkVM
X0hJR0hdID0gImhpZ2giCj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX3NpZ25h
bF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCQkJCSAgIHN0cnVjdCBkZXZpY2VfYXR0cmli
dXRlICphdHRyLCBjaGFyICpidWYpCj4gLXsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29u
c3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50
ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4g
LQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2
YXR0ci0+Y29tcG9uZW50Owo+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpjb25zdCBzaWduYWwg
PSBjb21wb25lbnQtPnNpZ25hbDsKPiAtCWludCBlcnI7Cj4gLQllbnVtIGNvdW50ZXJfc2lnbmFs
X2xldmVsIGxldmVsOwo+IC0KPiAtCWVyciA9IGNvdW50ZXItPm9wcy0+c2lnbmFsX3JlYWQoY291
bnRlciwgc2lnbmFsLCAmbGV2ZWwpOwo+IC0JaWYgKGVycikKPiAtCQlyZXR1cm4gZXJyOwo+IC0K
PiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb3VudGVyX3NpZ25hbF9sZXZlbF9zdHJb
bGV2ZWxdKTsKPiAtfQo+IC0KPiAtc3RydWN0IGNvdW50ZXJfbmFtZV91bml0IHsKPiAtCWNvbnN0
IGNoYXIgKm5hbWU7Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2RldmljZV9h
dHRyX25hbWVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLQkJCQkJICAgICBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtCQkJCQkgICAgIGNoYXIgKmJ1ZikKPiAtewo+IC0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfbmFtZV91bml0ICpjb25zdCBjb21wID0gdG9fY291bnRlcl9hdHRy
KGF0dHIpLT5jb21wb25lbnQ7Cj4gLQo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGNv
bXAtPm5hbWUpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJfbmFtZV9hdHRyaWJ1dGVf
Y3JlYXRlKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3Vw
LAo+IC0JY29uc3QgY2hhciAqY29uc3QgbmFtZSkKPiAtewo+IC0Jc3RydWN0IGNvdW50ZXJfbmFt
ZV91bml0ICpuYW1lX2NvbXA7Cj4gLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiAt
CWludCBlcnI7Cj4gLQo+IC0JLyogU2tpcCBpZiBubyBuYW1lICovCj4gLQlpZiAoIW5hbWUpCj4g
LQkJcmV0dXJuIDA7Cj4gLQo+IC0JLyogQWxsb2NhdGUgbmFtZSBhdHRyaWJ1dGUgY29tcG9uZW50
ICovCj4gLQluYW1lX2NvbXAgPSBrbWFsbG9jKHNpemVvZigqbmFtZV9jb21wKSwgR0ZQX0tFUk5F
TCk7Cj4gLQlpZiAoIW5hbWVfY29tcCkKPiAtCQlyZXR1cm4gLUVOT01FTTsKPiAtCW5hbWVfY29t
cC0+bmFtZSA9IG5hbWU7Cj4gLQo+IC0JLyogQWxsb2NhdGUgU2lnbmFsIG5hbWUgYXR0cmlidXRl
ICovCj4gLQlwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gLQlwYXJtLnByZWZpeCA9ICIiOwo+IC0JcGFy
bS5uYW1lID0gIm5hbWUiOwo+IC0JcGFybS5zaG93ID0gY291bnRlcl9kZXZpY2VfYXR0cl9uYW1l
X3Nob3c7Cj4gLQlwYXJtLnN0b3JlID0gTlVMTDsKPiAtCXBhcm0uY29tcG9uZW50ID0gbmFtZV9j
b21wOwo+IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAtCWlmIChl
cnIpCj4gLQkJZ290byBlcnJfZnJlZV9uYW1lX2NvbXA7Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+
IC1lcnJfZnJlZV9uYW1lX2NvbXA6Cj4gLQlrZnJlZShuYW1lX2NvbXApOwo+IC0JcmV0dXJuIGVy
cjsKPiAtfQo+IC0KPiAtc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dF91bml0IHsKPiAtCXN0cnVj
dCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFs
X2V4dCAqZXh0Owo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9zaWduYWxfZXh0
X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0
cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rl
dmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+IC0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dF91bml0ICpjb25zdCBjb21wID0gZGV2YXR0ci0+
Y29tcG9uZW50Owo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCAqY29uc3QgZXh0
ID0gY29tcC0+ZXh0Owo+IC0KPiAtCXJldHVybiBleHQtPnJlYWQoZGV2X2dldF9kcnZkYXRhKGRl
diksIGNvbXAtPnNpZ25hbCwgZXh0LT5wcml2LCBidWYpOwo+IC19Cj4gLQo+IC1zdGF0aWMgc3Np
emVfdCBjb3VudGVyX3NpZ25hbF9leHRfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJ
CXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+IC0JCQkJCWNvbnN0IGNoYXIgKmJ1Ziwg
c2l6ZV90IGxlbikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNv
bnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLQljb25zdCBzdHJ1Y3QgY291
bnRlcl9zaWduYWxfZXh0X3VuaXQgKmNvbnN0IGNvbXAgPSBkZXZhdHRyLT5jb21wb25lbnQ7Cj4g
LQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0ICpjb25zdCBleHQgPSBjb21wLT5leHQ7
Cj4gLQo+IC0JcmV0dXJuIGV4dC0+d3JpdGUoZGV2X2dldF9kcnZkYXRhKGRldiksIGNvbXAtPnNp
Z25hbCwgZXh0LT5wcml2LCBidWYsCj4gLQkJbGVuKTsKPiAtfQo+IC0KPiAtc3RhdGljIHZvaWQg
Y291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoc3RydWN0IGxpc3RfaGVhZCAqYXR0cl9saXN0
KQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqcCwgKm47Cj4gLQo+IC0JbGlz
dF9mb3JfZWFjaF9lbnRyeV9zYWZlKHAsIG4sIGF0dHJfbGlzdCwgbCkgewo+IC0JCS8qIGZyZWUg
YXR0cmlidXRlIG5hbWUgYW5kIGFzc29jaWF0ZWQgY29tcG9uZW50IG1lbW9yeSAqLwo+IC0JCWtm
cmVlKHAtPmRldl9hdHRyLmF0dHIubmFtZSk7Cj4gLQkJa2ZyZWUocC0+Y29tcG9uZW50KTsKPiAt
CQlsaXN0X2RlbCgmcC0+bCk7Cj4gLQkJa2ZyZWUocCk7Cj4gLQl9Cj4gLX0KPiAtCj4gLXN0YXRp
YyBpbnQgY291bnRlcl9zaWduYWxfZXh0X3JlZ2lzdGVyKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2
aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3VwLAo+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpj
b25zdCBzaWduYWwpCj4gLXsKPiAtCWNvbnN0IHNpemVfdCBudW1fZXh0ID0gc2lnbmFsLT5udW1f
ZXh0Owo+IC0Jc2l6ZV90IGk7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0ICpl
eHQ7Cj4gLQlzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0X3VuaXQgKnNpZ25hbF9leHRfY29tcDsK
PiAtCXN0cnVjdCBjb3VudGVyX2F0dHJfcGFybSBwYXJtOwo+IC0JaW50IGVycjsKPiAtCj4gLQkv
KiBDcmVhdGUgYW4gYXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwo+IC0JZm9yIChpID0g
MCA7IGkgPCBudW1fZXh0OyBpKyspIHsKPiAtCQlleHQgPSBzaWduYWwtPmV4dCArIGk7Cj4gLQo+
IC0JCS8qIEFsbG9jYXRlIHNpZ25hbF9leHQgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+IC0JCXNp
Z25hbF9leHRfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpzaWduYWxfZXh0X2NvbXApLCBHRlBfS0VS
TkVMKTsKPiAtCQlpZiAoIXNpZ25hbF9leHRfY29tcCkgewo+IC0JCQllcnIgPSAtRU5PTUVNOwo+
IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCQl9Cj4gLQkJc2lnbmFsX2V4dF9jb21w
LT5zaWduYWwgPSBzaWduYWw7Cj4gLQkJc2lnbmFsX2V4dF9jb21wLT5leHQgPSBleHQ7Cj4gLQo+
IC0JCS8qIEFsbG9jYXRlIGEgQ291bnRlciBkZXZpY2UgYXR0cmlidXRlICovCj4gLQkJcGFybS5n
cm91cCA9IGdyb3VwOwo+IC0JCXBhcm0ucHJlZml4ID0gIiI7Cj4gLQkJcGFybS5uYW1lID0gZXh0
LT5uYW1lOwo+IC0JCXBhcm0uc2hvdyA9IChleHQtPnJlYWQpID8gY291bnRlcl9zaWduYWxfZXh0
X3Nob3cgOiBOVUxMOwo+IC0JCXBhcm0uc3RvcmUgPSAoZXh0LT53cml0ZSkgPyBjb3VudGVyX3Np
Z25hbF9leHRfc3RvcmUgOiBOVUxMOwo+IC0JCXBhcm0uY29tcG9uZW50ID0gc2lnbmFsX2V4dF9j
b21wOwo+IC0JCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLQkJaWYg
KGVycikgewo+IC0JCQlrZnJlZShzaWduYWxfZXh0X2NvbXApOwo+IC0JCQlnb3RvIGVycl9mcmVl
X2F0dHJfbGlzdDsKPiAtCQl9Cj4gLQl9Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJl
ZV9hdHRyX2xpc3Q6Cj4gLQljb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0
dHJfbGlzdCk7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJf
c2lnbmFsX2F0dHJpYnV0ZXNfY3JlYXRlKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJf
Z3JvdXAgKmNvbnN0IGdyb3VwLAo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25z
dCBjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpjb25zdCBzaWduYWwpCj4gLXsK
PiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbF91bml0ICpzaWduYWxfY29tcDsKPiAtCXN0cnVjdCBj
b3VudGVyX2F0dHJfcGFybSBwYXJtOwo+IC0JaW50IGVycjsKPiAtCj4gLQkvKiBBbGxvY2F0ZSBT
aWduYWwgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+IC0Jc2lnbmFsX2NvbXAgPSBrbWFsbG9jKHNp
emVvZigqc2lnbmFsX2NvbXApLCBHRlBfS0VSTkVMKTsKPiAtCWlmICghc2lnbmFsX2NvbXApCj4g
LQkJcmV0dXJuIC1FTk9NRU07Cj4gLQlzaWduYWxfY29tcC0+c2lnbmFsID0gc2lnbmFsOwo+IC0K
PiAtCS8qIENyZWF0ZSBtYWluIFNpZ25hbCBhdHRyaWJ1dGUgKi8KPiAtCXBhcm0uZ3JvdXAgPSBn
cm91cDsKPiAtCXBhcm0ucHJlZml4ID0gIiI7Cj4gLQlwYXJtLm5hbWUgPSAic2lnbmFsIjsKPiAt
CXBhcm0uc2hvdyA9IChjb3VudGVyLT5vcHMtPnNpZ25hbF9yZWFkKSA/IGNvdW50ZXJfc2lnbmFs
X3Nob3cgOiBOVUxMOwo+IC0JcGFybS5zdG9yZSA9IE5VTEw7Cj4gLQlwYXJtLmNvbXBvbmVudCA9
IHNpZ25hbF9jb21wOwo+IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsK
PiAtCWlmIChlcnIpIHsKPiAtCQlrZnJlZShzaWduYWxfY29tcCk7Cj4gLQkJcmV0dXJuIGVycjsK
PiAtCX0KPiAtCj4gLQkvKiBDcmVhdGUgU2lnbmFsIG5hbWUgYXR0cmlidXRlICovCj4gLQllcnIg
PSBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0ZShncm91cCwgc2lnbmFsLT5uYW1lKTsKPiAt
CWlmIChlcnIpCj4gLQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQo+IC0JLyogUmVnaXN0
ZXIgU2lnbmFsIGV4dGVuc2lvbiBhdHRyaWJ1dGVzICovCj4gLQllcnIgPSBjb3VudGVyX3NpZ25h
bF9leHRfcmVnaXN0ZXIoZ3JvdXAsIHNpZ25hbCk7Cj4gLQlpZiAoZXJyKQo+IC0JCWdvdG8gZXJy
X2ZyZWVfYXR0cl9saXN0Owo+IC0KPiAtCXJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfYXR0cl9s
aXN0Ogo+IC0JY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3Qp
Owo+IC0JcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBjb3VudGVyX3NpZ25hbHNf
cmVnaXN0ZXIoCj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3Jv
dXBzX2xpc3QsCj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIp
Cj4gLXsKPiAtCWNvbnN0IHNpemVfdCBudW1fc2lnbmFscyA9IGNvdW50ZXItPm51bV9zaWduYWxz
Owo+IC0Jc2l6ZV90IGk7Cj4gLQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbDsKPiAtCWNv
bnN0IGNoYXIgKm5hbWU7Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCS8qIFJlZ2lzdGVyIGVhY2ggU2ln
bmFsICovCj4gLQlmb3IgKGkgPSAwOyBpIDwgbnVtX3NpZ25hbHM7IGkrKykgewo+IC0JCXNpZ25h
bCA9IGNvdW50ZXItPnNpZ25hbHMgKyBpOwo+IC0KPiAtCQkvKiBHZW5lcmF0ZSBTaWduYWwgYXR0
cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCj4gLQkJbmFtZSA9IGthc3ByaW50ZihHRlBfS0VSTkVM
LCAic2lnbmFsJWQiLCBzaWduYWwtPmlkKTsKPiAtCQlpZiAoIW5hbWUpIHsKPiAtCQkJZXJyID0g
LUVOT01FTTsKPiAtCQkJZ290byBlcnJfZnJlZV9hdHRyX2dyb3VwczsKPiAtCQl9Cj4gLQkJZ3Jv
dXBzX2xpc3RbaV0uYXR0cl9ncm91cC5uYW1lID0gbmFtZTsKPiAtCj4gLQkJLyogQ3JlYXRlIGFs
bCBhdHRyaWJ1dGVzIGFzc29jaWF0ZWQgd2l0aCBTaWduYWwgKi8KPiAtCQllcnIgPSBjb3VudGVy
X3NpZ25hbF9hdHRyaWJ1dGVzX2NyZWF0ZShncm91cHNfbGlzdCArIGksIGNvdW50ZXIsCj4gLQkJ
CQkJCSAgICAgICBzaWduYWwpOwo+IC0JCWlmIChlcnIpCj4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0
cl9ncm91cHM7Cj4gLQl9Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRyX2dy
b3VwczoKPiAtCWRvIHsKPiAtCQlrZnJlZShncm91cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUp
Owo+IC0JCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cHNfbGlzdFtpXS5hdHRy
X2xpc3QpOwo+IC0JfSB3aGlsZSAoaS0tKTsKPiAtCXJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0
YXRpYyBjb25zdCBjaGFyICpjb25zdCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0cltdID0gewo+
IC0JW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSAibm9uZSIsCj4gLQlbQ09VTlRFUl9T
WU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRV0gPSAicmlzaW5nIGVkZ2UiLAo+IC0JW0NPVU5URVJf
U1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFXSA9ICJmYWxsaW5nIGVkZ2UiLAo+IC0JW0NPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFU10gPSAiYm90aCBlZGdlcyIKPiAtfTsKPiAtCj4g
LXN0cnVjdCBjb3VudGVyX2FjdGlvbl91bml0IHsKPiAtCXN0cnVjdCBjb3VudGVyX3N5bmFwc2Ug
KnN5bmFwc2U7Cj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQ7Cj4gLX07Cj4gLQo+IC1z
dGF0aWMgc3NpemVfdCBjb3VudGVyX2FjdGlvbl9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAt
CQkJCSAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gLXsKPiAt
CWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291
bnRlcl9hdHRyKGF0dHIpOwo+IC0JaW50IGVycjsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+IC0JY29uc3Qgc3RydWN0IGNv
dW50ZXJfYWN0aW9uX3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsK
PiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGNvbXBvbmVudC0+Y291bnQ7
Cj4gLQlzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpjb25zdCBzeW5hcHNlID0gY29tcG9uZW50LT5z
eW5hcHNlOwo+IC0Jc2l6ZV90IGFjdGlvbl9pbmRleDsKPiAtCWVudW0gY291bnRlcl9zeW5hcHNl
X2FjdGlvbiBhY3Rpb247Cj4gLQo+IC0JZXJyID0gY291bnRlci0+b3BzLT5hY3Rpb25fZ2V0KGNv
dW50ZXIsIGNvdW50LCBzeW5hcHNlLCAmYWN0aW9uX2luZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJ
cmV0dXJuIGVycjsKPiAtCj4gLQlzeW5hcHNlLT5hY3Rpb24gPSBhY3Rpb25faW5kZXg7Cj4gLQo+
IC0JYWN0aW9uID0gc3luYXBzZS0+YWN0aW9uc19saXN0W2FjdGlvbl9pbmRleF07Cj4gLQlyZXR1
cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHJbYWN0aW9u
XSk7Cj4gLX0KPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfYWN0aW9uX3N0b3JlKHN0cnVj
dCBkZXZpY2UgKmRldiwKPiAtCQkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwK
PiAtCQkJCSAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gLXsKPiAtCWNvbnN0IHN0
cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRy
KGF0dHIpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfYWN0aW9uX3VuaXQgKmNvbnN0IGNvbXBv
bmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtCXN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKmNv
bnN0IHN5bmFwc2UgPSBjb21wb25lbnQtPnN5bmFwc2U7Cj4gLQlzaXplX3QgYWN0aW9uX2luZGV4
Owo+IC0JY29uc3Qgc2l6ZV90IG51bV9hY3Rpb25zID0gc3luYXBzZS0+bnVtX2FjdGlvbnM7Cj4g
LQllbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uOwo+IC0JaW50IGVycjsKPiAtCXN0
cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYp
Owo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gY29tcG9uZW50LT5jb3Vu
dDsKPiAtCj4gLQkvKiBGaW5kIHJlcXVlc3RlZCBhY3Rpb24gbW9kZSAqLwo+IC0JZm9yIChhY3Rp
b25faW5kZXggPSAwOyBhY3Rpb25faW5kZXggPCBudW1fYWN0aW9uczsgYWN0aW9uX2luZGV4Kysp
IHsKPiAtCQlhY3Rpb24gPSBzeW5hcHNlLT5hY3Rpb25zX2xpc3RbYWN0aW9uX2luZGV4XTsKPiAt
CQlpZiAoc3lzZnNfc3RyZXEoYnVmLCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0clthY3Rpb25d
KSkKPiAtCQkJYnJlYWs7Cj4gLQl9Cj4gLQkvKiBJZiByZXF1ZXN0ZWQgYWN0aW9uIG1vZGUgbm90
IGZvdW5kICovCj4gLQlpZiAoYWN0aW9uX2luZGV4ID49IG51bV9hY3Rpb25zKQo+IC0JCXJldHVy
biAtRUlOVkFMOwo+IC0KPiAtCWVyciA9IGNvdW50ZXItPm9wcy0+YWN0aW9uX3NldChjb3VudGVy
LCBjb3VudCwgc3luYXBzZSwgYWN0aW9uX2luZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJu
IGVycjsKPiAtCj4gLQlzeW5hcHNlLT5hY3Rpb24gPSBhY3Rpb25faW5kZXg7Cj4gLQo+IC0JcmV0
dXJuIGxlbjsKPiAtfQo+IC0KPiAtc3RydWN0IGNvdW50ZXJfYWN0aW9uX2F2YWlsX3VuaXQgewo+
IC0JY29uc3QgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb25zX2xpc3Q7Cj4gLQlz
aXplX3QgbnVtX2FjdGlvbnM7Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX3N5
bmFwc2VfYWN0aW9uX2F2YWlsYWJsZV9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCXN0cnVj
dCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVj
dCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0
dHIpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfYWN0aW9uX2F2YWlsX3VuaXQgKmNvbnN0IGNv
bXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtCXNpemVfdCBpOwo+IC0JZW51bSBjb3Vu
dGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlvbjsKPiAtCXNzaXplX3QgbGVuID0gMDsKPiAtCj4gLQlm
b3IgKGkgPSAwOyBpIDwgY29tcG9uZW50LT5udW1fYWN0aW9uczsgaSsrKSB7Cj4gLQkJYWN0aW9u
ID0gY29tcG9uZW50LT5hY3Rpb25zX2xpc3RbaV07Cj4gLQkJbGVuICs9IHNwcmludGYoYnVmICsg
bGVuLCAiJXNcbiIsCj4gLQkJCSAgICAgICBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0clthY3Rp
b25dKTsKPiAtCX0KPiAtCj4gLQlyZXR1cm4gbGVuOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNv
dW50ZXJfc3luYXBzZXNfcmVnaXN0ZXIoCj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9n
cm91cCAqY29uc3QgZ3JvdXAsCj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0
IGNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQsIGNvbnN0IGNo
YXIgKmNvbnN0IGNvdW50X2F0dHJfbmFtZSkKPiAtewo+IC0Jc2l6ZV90IGk7Cj4gLQlzdHJ1Y3Qg
Y291bnRlcl9zeW5hcHNlICpzeW5hcHNlOwo+IC0JY29uc3QgY2hhciAqcHJlZml4Owo+IC0Jc3Ry
dWN0IGNvdW50ZXJfYWN0aW9uX3VuaXQgKmFjdGlvbl9jb21wOwo+IC0Jc3RydWN0IGNvdW50ZXJf
YXR0cl9wYXJtIHBhcm07Cj4gLQlpbnQgZXJyOwo+IC0Jc3RydWN0IGNvdW50ZXJfYWN0aW9uX2F2
YWlsX3VuaXQgKmF2YWlsX2NvbXA7Cj4gLQo+IC0JLyogUmVnaXN0ZXIgZWFjaCBTeW5hcHNlICov
Cj4gLQlmb3IgKGkgPSAwOyBpIDwgY291bnQtPm51bV9zeW5hcHNlczsgaSsrKSB7Cj4gLQkJc3lu
YXBzZSA9IGNvdW50LT5zeW5hcHNlcyArIGk7Cj4gLQo+IC0JCS8qIEdlbmVyYXRlIGF0dHJpYnV0
ZSBwcmVmaXggKi8KPiAtCQlwcmVmaXggPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgInNpZ25hbCVk
XyIsCj4gLQkJCQkgICBzeW5hcHNlLT5zaWduYWwtPmlkKTsKPiAtCQlpZiAoIXByZWZpeCkgewo+
IC0JCQllcnIgPSAtRU5PTUVNOwo+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCQl9
Cj4gLQo+IC0JCS8qIEFsbG9jYXRlIGFjdGlvbiBhdHRyaWJ1dGUgY29tcG9uZW50ICovCj4gLQkJ
YWN0aW9uX2NvbXAgPSBrbWFsbG9jKHNpemVvZigqYWN0aW9uX2NvbXApLCBHRlBfS0VSTkVMKTsK
PiAtCQlpZiAoIWFjdGlvbl9jb21wKSB7Cj4gLQkJCWVyciA9IC1FTk9NRU07Cj4gLQkJCWdvdG8g
ZXJyX2ZyZWVfcHJlZml4Owo+IC0JCX0KPiAtCQlhY3Rpb25fY29tcC0+c3luYXBzZSA9IHN5bmFw
c2U7Cj4gLQkJYWN0aW9uX2NvbXAtPmNvdW50ID0gY291bnQ7Cj4gLQo+IC0JCS8qIENyZWF0ZSBh
Y3Rpb24gYXR0cmlidXRlICovCj4gLQkJcGFybS5ncm91cCA9IGdyb3VwOwo+IC0JCXBhcm0ucHJl
Zml4ID0gcHJlZml4Owo+IC0JCXBhcm0ubmFtZSA9ICJhY3Rpb24iOwo+IC0JCXBhcm0uc2hvdyA9
IChjb3VudGVyLT5vcHMtPmFjdGlvbl9nZXQpID8gY291bnRlcl9hY3Rpb25fc2hvdyA6IE5VTEw7
Cj4gLQkJcGFybS5zdG9yZSA9IChjb3VudGVyLT5vcHMtPmFjdGlvbl9zZXQpID8gY291bnRlcl9h
Y3Rpb25fc3RvcmUgOiBOVUxMOwo+IC0JCXBhcm0uY29tcG9uZW50ID0gYWN0aW9uX2NvbXA7Cj4g
LQkJZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAtCQlpZiAoZXJyKSB7
Cj4gLQkJCWtmcmVlKGFjdGlvbl9jb21wKTsKPiAtCQkJZ290byBlcnJfZnJlZV9wcmVmaXg7Cj4g
LQkJfQo+IC0KPiAtCQkvKiBBbGxvY2F0ZSBhY3Rpb24gYXZhaWxhYmxlIGF0dHJpYnV0ZSBjb21w
b25lbnQgKi8KPiAtCQlhdmFpbF9jb21wID0ga21hbGxvYyhzaXplb2YoKmF2YWlsX2NvbXApLCBH
RlBfS0VSTkVMKTsKPiAtCQlpZiAoIWF2YWlsX2NvbXApIHsKPiAtCQkJZXJyID0gLUVOT01FTTsK
PiAtCQkJZ290byBlcnJfZnJlZV9wcmVmaXg7Cj4gLQkJfQo+IC0JCWF2YWlsX2NvbXAtPmFjdGlv
bnNfbGlzdCA9IHN5bmFwc2UtPmFjdGlvbnNfbGlzdDsKPiAtCQlhdmFpbF9jb21wLT5udW1fYWN0
aW9ucyA9IHN5bmFwc2UtPm51bV9hY3Rpb25zOwo+IC0KPiAtCQkvKiBDcmVhdGUgYWN0aW9uX2F2
YWlsYWJsZSBhdHRyaWJ1dGUgKi8KPiAtCQlwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gLQkJcGFybS5w
cmVmaXggPSBwcmVmaXg7Cj4gLQkJcGFybS5uYW1lID0gImFjdGlvbl9hdmFpbGFibGUiOwo+IC0J
CXBhcm0uc2hvdyA9IGNvdW50ZXJfc3luYXBzZV9hY3Rpb25fYXZhaWxhYmxlX3Nob3c7Cj4gLQkJ
cGFybS5zdG9yZSA9IE5VTEw7Cj4gLQkJcGFybS5jb21wb25lbnQgPSBhdmFpbF9jb21wOwo+IC0J
CWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLQkJaWYgKGVycikgewo+
IC0JCQlrZnJlZShhdmFpbF9jb21wKTsKPiAtCQkJZ290byBlcnJfZnJlZV9wcmVmaXg7Cj4gLQkJ
fQo+IC0KPiAtCQlrZnJlZShwcmVmaXgpOwo+IC0JfQo+IC0KPiAtCXJldHVybiAwOwo+IC0KPiAt
ZXJyX2ZyZWVfcHJlZml4Ogo+IC0Ja2ZyZWUocHJlZml4KTsKPiAtZXJyX2ZyZWVfYXR0cl9saXN0
Ogo+IC0JY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwo+
IC0JcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCB7Cj4g
LQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQ7Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVf
dCBjb3VudGVyX2NvdW50X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJICBzdHJ1Y3Qg
ZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtCQkJCSAgY2hhciAqYnVmKQo+IC17Cj4gLQlzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsK
PiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9f
Y291bnRlcl9hdHRyKGF0dHIpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAq
Y29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0Jc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvbnN0IGNvdW50ID0gY29tcG9uZW50LT5jb3VudDsKPiAtCWludCBlcnI7Cj4gLQl1
bnNpZ25lZCBsb25nIHZhbDsKPiAtCj4gLQllcnIgPSBjb3VudGVyLT5vcHMtPmNvdW50X3JlYWQo
Y291bnRlciwgY291bnQsICZ2YWwpOwo+IC0JaWYgKGVycikKPiAtCQlyZXR1cm4gZXJyOwo+IC0K
PiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVsdVxuIiwgdmFsKTsKPiAtfQo+IC0KPiAtc3RhdGlj
IHNzaXplX3QgY291bnRlcl9jb3VudF9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLQkJCQkg
ICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtCQkJCSAgIGNvbnN0IGNoYXIgKmJ1
Ziwgc2l6ZV90IGxlbikKPiAtewo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3Vu
dGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZp
Y2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiAtCWNvbnN0
IHN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNv
bXBvbmVudDsKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGNvbXBvbmVu
dC0+Y291bnQ7Cj4gLQlpbnQgZXJyOwo+IC0JdW5zaWduZWQgbG9uZyB2YWw7Cj4gLQo+IC0JZXJy
ID0ga3N0cnRvdWwoYnVmLCAwLCAmdmFsKTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVycjsK
PiAtCj4gLQllcnIgPSBjb3VudGVyLT5vcHMtPmNvdW50X3dyaXRlKGNvdW50ZXIsIGNvdW50LCB2
YWwpOwo+IC0JaWYgKGVycikKPiAtCQlyZXR1cm4gZXJyOwo+IC0KPiAtCXJldHVybiBsZW47Cj4g
LX0KPiAtCj4gLXN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBjb3VudGVyX2Z1bmN0aW9uX3N0cltd
ID0gewo+IC0JW0NPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0VdID0gImluY3JlYXNlIiwKPiAtCVtD
T1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFXSA9ICJkZWNyZWFzZSIsCj4gLQlbQ09VTlRFUl9GVU5D
VElPTl9QVUxTRV9ESVJFQ1RJT05dID0gInB1bHNlLWRpcmVjdGlvbiIsCj4gLQlbQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1gxX0FdID0gInF1YWRyYXR1cmUgeDEgYSIsCj4gLQlbQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0JdID0gInF1YWRyYXR1cmUgeDEgYiIsCj4gLQlbQ09V
TlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0FdID0gInF1YWRyYXR1cmUgeDIgYSIsCj4gLQlb
Q09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0JdID0gInF1YWRyYXR1cmUgeDIgYiIsCj4g
LQlbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0XSA9ICJxdWFkcmF0dXJlIHg0Igo+IC19
Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9mdW5jdGlvbl9zaG93KHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAtCQkJCSAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIg
KmJ1ZikKPiAtewo+IC0JaW50IGVycjsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3Qg
Y291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLQlj
b25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZhdHRy
LT5jb21wb25lbnQ7Cj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBjb21w
b25lbnQtPmNvdW50Owo+IC0Jc2l6ZV90IGZ1bmNfaW5kZXg7Cj4gLQllbnVtIGNvdW50ZXJfZnVu
Y3Rpb24gZnVuY3Rpb247Cj4gLQo+IC0JZXJyID0gY291bnRlci0+b3BzLT5mdW5jdGlvbl9nZXQo
Y291bnRlciwgY291bnQsICZmdW5jX2luZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVy
cjsKPiAtCj4gLQljb3VudC0+ZnVuY3Rpb24gPSBmdW5jX2luZGV4Owo+IC0KPiAtCWZ1bmN0aW9u
ID0gY291bnQtPmZ1bmN0aW9uc19saXN0W2Z1bmNfaW5kZXhdOwo+IC0JcmV0dXJuIHNwcmludGYo
YnVmLCAiJXNcbiIsIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSk7Cj4gLX0KPiAtCj4g
LXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfZnVuY3Rpb25fc3RvcmUoc3RydWN0IGRldmljZSAqZGV2
LAo+IC0JCQkJICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gLQkJCQkgICAg
ICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3Vu
dGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+
IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2
YXR0ci0+Y29tcG9uZW50Owo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50ID0g
Y29tcG9uZW50LT5jb3VudDsKPiAtCWNvbnN0IHNpemVfdCBudW1fZnVuY3Rpb25zID0gY291bnQt
Pm51bV9mdW5jdGlvbnM7Cj4gLQlzaXplX3QgZnVuY19pbmRleDsKPiAtCWVudW0gY291bnRlcl9m
dW5jdGlvbiBmdW5jdGlvbjsKPiAtCWludCBlcnI7Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtCj4gLQkvKiBGaW5kIHJl
cXVlc3RlZCBDb3VudCBmdW5jdGlvbiBtb2RlICovCj4gLQlmb3IgKGZ1bmNfaW5kZXggPSAwOyBm
dW5jX2luZGV4IDwgbnVtX2Z1bmN0aW9uczsgZnVuY19pbmRleCsrKSB7Cj4gLQkJZnVuY3Rpb24g
PSBjb3VudC0+ZnVuY3Rpb25zX2xpc3RbZnVuY19pbmRleF07Cj4gLQkJaWYgKHN5c2ZzX3N0cmVx
KGJ1ZiwgY291bnRlcl9mdW5jdGlvbl9zdHJbZnVuY3Rpb25dKSkKPiAtCQkJYnJlYWs7Cj4gLQl9
Cj4gLQkvKiBSZXR1cm4gZXJyb3IgaWYgcmVxdWVzdGVkIENvdW50IGZ1bmN0aW9uIG1vZGUgbm90
IGZvdW5kICovCj4gLQlpZiAoZnVuY19pbmRleCA+PSBudW1fZnVuY3Rpb25zKQo+IC0JCXJldHVy
biAtRUlOVkFMOwo+IC0KPiAtCWVyciA9IGNvdW50ZXItPm9wcy0+ZnVuY3Rpb25fc2V0KGNvdW50
ZXIsIGNvdW50LCBmdW5jX2luZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVycjsKPiAt
Cj4gLQljb3VudC0+ZnVuY3Rpb24gPSBmdW5jX2luZGV4Owo+IC0KPiAtCXJldHVybiBsZW47Cj4g
LX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX2NvdW50X2V4dF91bml0IHsKPiAtCXN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudDsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCAqZXh0
Owo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9jb3VudF9leHRfc2hvdyhzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gLQkJCQkgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQo+IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAq
Y29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiAtCWNvbnN0IHN0cnVjdCBj
b3VudGVyX2NvdW50X2V4dF91bml0ICpjb25zdCBjb21wID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+
IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0ICpjb25zdCBleHQgPSBjb21wLT5leHQ7
Cj4gLQo+IC0JcmV0dXJuIGV4dC0+cmVhZChkZXZfZ2V0X2RydmRhdGEoZGV2KSwgY29tcC0+Y291
bnQsIGV4dC0+cHJpdiwgYnVmKTsKPiAtfQo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9j
b3VudF9leHRfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJICAgICAgIHN0cnVjdCBk
ZXZpY2VfYXR0cmlidXRlICphdHRyLAo+IC0JCQkJICAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGxlbikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0
IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRl
cl9jb3VudF9leHRfdW5pdCAqY29uc3QgY29tcCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtCWNv
bnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCAqY29uc3QgZXh0ID0gY29tcC0+ZXh0Owo+IC0K
PiAtCXJldHVybiBleHQtPndyaXRlKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBjb21wLT5jb3VudCwg
ZXh0LT5wcml2LCBidWYsCj4gLQkJbGVuKTsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBjb3VudGVy
X2NvdW50X2V4dF9yZWdpc3RlcigKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3Vw
ICpjb25zdCBncm91cCwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCkKPiAt
ewo+IC0Jc2l6ZV90IGk7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgKmV4dDsK
PiAtCXN0cnVjdCBjb3VudGVyX2NvdW50X2V4dF91bml0ICpjb3VudF9leHRfY29tcDsKPiAtCXN0
cnVjdCBjb3VudGVyX2F0dHJfcGFybSBwYXJtOwo+IC0JaW50IGVycjsKPiAtCj4gLQkvKiBDcmVh
dGUgYW4gYXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwo+IC0JZm9yIChpID0gMCA7IGkg
PCBjb3VudC0+bnVtX2V4dDsgaSsrKSB7Cj4gLQkJZXh0ID0gY291bnQtPmV4dCArIGk7Cj4gLQo+
IC0JCS8qIEFsbG9jYXRlIGNvdW50X2V4dCBhdHRyaWJ1dGUgY29tcG9uZW50ICovCj4gLQkJY291
bnRfZXh0X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqY291bnRfZXh0X2NvbXApLCBHRlBfS0VSTkVM
KTsKPiAtCQlpZiAoIWNvdW50X2V4dF9jb21wKSB7Cj4gLQkJCWVyciA9IC1FTk9NRU07Cj4gLQkJ
CWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0JCX0KPiAtCQljb3VudF9leHRfY29tcC0+Y291
bnQgPSBjb3VudDsKPiAtCQljb3VudF9leHRfY29tcC0+ZXh0ID0gZXh0Owo+IC0KPiAtCQkvKiBB
bGxvY2F0ZSBjb3VudF9leHQgYXR0cmlidXRlICovCj4gLQkJcGFybS5ncm91cCA9IGdyb3VwOwo+
IC0JCXBhcm0ucHJlZml4ID0gIiI7Cj4gLQkJcGFybS5uYW1lID0gZXh0LT5uYW1lOwo+IC0JCXBh
cm0uc2hvdyA9IChleHQtPnJlYWQpID8gY291bnRlcl9jb3VudF9leHRfc2hvdyA6IE5VTEw7Cj4g
LQkJcGFybS5zdG9yZSA9IChleHQtPndyaXRlKSA/IGNvdW50ZXJfY291bnRfZXh0X3N0b3JlIDog
TlVMTDsKPiAtCQlwYXJtLmNvbXBvbmVudCA9IGNvdW50X2V4dF9jb21wOwo+IC0JCWVyciA9IGNv
dW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLQkJaWYgKGVycikgewo+IC0JCQlrZnJl
ZShjb3VudF9leHRfY29tcCk7Cj4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0JCX0K
PiAtCX0KPiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2F0dHJfbGlzdDoKPiAtCWNv
dW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsKPiAtCXJldHVy
biBlcnI7Cj4gLX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX2Z1bmNfYXZhaWxfdW5pdCB7Cj4gLQlj
b25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uc19saXN0Owo+IC0Jc2l6ZV90IG51
bV9mdW5jdGlvbnM7Cj4gLX07Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2Z1bmN0aW9u
X2F2YWlsYWJsZV9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCXN0cnVjdCBkZXZpY2VfYXR0
cmlidXRlICphdHRyLCBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rl
dmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+IC0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfZnVuY19hdmFpbF91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZh
dHRyLT5jb21wb25lbnQ7Cj4gLQljb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmNvbnN0IGZ1
bmNfbGlzdCA9IGNvbXBvbmVudC0+ZnVuY3Rpb25zX2xpc3Q7Cj4gLQljb25zdCBzaXplX3QgbnVt
X2Z1bmN0aW9ucyA9IGNvbXBvbmVudC0+bnVtX2Z1bmN0aW9uczsKPiAtCXNpemVfdCBpOwo+IC0J
ZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uOwo+IC0Jc3NpemVfdCBsZW4gPSAwOwo+IC0K
PiAtCWZvciAoaSA9IDA7IGkgPCBudW1fZnVuY3Rpb25zOyBpKyspIHsKPiAtCQlmdW5jdGlvbiA9
IGZ1bmNfbGlzdFtpXTsKPiAtCQlsZW4gKz0gc3ByaW50ZihidWYgKyBsZW4sICIlc1xuIiwKPiAt
CQkJICAgICAgIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSk7Cj4gLQl9Cj4gLQo+IC0J
cmV0dXJuIGxlbjsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBjb3VudGVyX2NvdW50X2F0dHJpYnV0
ZXNfY3JlYXRlKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdy
b3VwLAo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyLAo+IC0J
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50KQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRl
cl9jb3VudF91bml0ICpjb3VudF9jb21wOwo+IC0Jc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBh
cm07Cj4gLQlpbnQgZXJyOwo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqZnVuY19jb21w
Owo+IC0Jc3RydWN0IGNvdW50ZXJfZnVuY19hdmFpbF91bml0ICphdmFpbF9jb21wOwo+IC0KPiAt
CS8qIEFsbG9jYXRlIGNvdW50IGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiAtCWNvdW50X2NvbXAg
PSBrbWFsbG9jKHNpemVvZigqY291bnRfY29tcCksIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFjb3Vu
dF9jb21wKQo+IC0JCXJldHVybiAtRU5PTUVNOwo+IC0JY291bnRfY29tcC0+Y291bnQgPSBjb3Vu
dDsKPiAtCj4gLQkvKiBDcmVhdGUgbWFpbiBDb3VudCBhdHRyaWJ1dGUgKi8KPiAtCXBhcm0uZ3Jv
dXAgPSBncm91cDsKPiAtCXBhcm0ucHJlZml4ID0gIiI7Cj4gLQlwYXJtLm5hbWUgPSAiY291bnQi
Owo+IC0JcGFybS5zaG93ID0gKGNvdW50ZXItPm9wcy0+Y291bnRfcmVhZCkgPyBjb3VudGVyX2Nv
dW50X3Nob3cgOiBOVUxMOwo+IC0JcGFybS5zdG9yZSA9IChjb3VudGVyLT5vcHMtPmNvdW50X3dy
aXRlKSA/IGNvdW50ZXJfY291bnRfc3RvcmUgOiBOVUxMOwo+IC0JcGFybS5jb21wb25lbnQgPSBj
b3VudF9jb21wOwo+IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAt
CWlmIChlcnIpIHsKPiAtCQlrZnJlZShjb3VudF9jb21wKTsKPiAtCQlyZXR1cm4gZXJyOwo+IC0J
fQo+IC0KPiAtCS8qIEFsbG9jYXRlIGZ1bmN0aW9uIGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiAt
CWZ1bmNfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpmdW5jX2NvbXApLCBHRlBfS0VSTkVMKTsKPiAt
CWlmICghZnVuY19jb21wKSB7Cj4gLQkJZXJyID0gLUVOT01FTTsKPiAtCQlnb3RvIGVycl9mcmVl
X2F0dHJfbGlzdDsKPiAtCX0KPiAtCWZ1bmNfY29tcC0+Y291bnQgPSBjb3VudDsKPiAtCj4gLQkv
KiBDcmVhdGUgQ291bnQgZnVuY3Rpb24gYXR0cmlidXRlICovCj4gLQlwYXJtLmdyb3VwID0gZ3Jv
dXA7Cj4gLQlwYXJtLnByZWZpeCA9ICIiOwo+IC0JcGFybS5uYW1lID0gImZ1bmN0aW9uIjsKPiAt
CXBhcm0uc2hvdyA9IChjb3VudGVyLT5vcHMtPmZ1bmN0aW9uX2dldCkgPyBjb3VudGVyX2Z1bmN0
aW9uX3Nob3cgOiBOVUxMOwo+IC0JcGFybS5zdG9yZSA9IChjb3VudGVyLT5vcHMtPmZ1bmN0aW9u
X3NldCkgPyBjb3VudGVyX2Z1bmN0aW9uX3N0b3JlIDogTlVMTDsKPiAtCXBhcm0uY29tcG9uZW50
ID0gZnVuY19jb21wOwo+IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsK
PiAtCWlmIChlcnIpIHsKPiAtCQlrZnJlZShmdW5jX2NvbXApOwo+IC0JCWdvdG8gZXJyX2ZyZWVf
YXR0cl9saXN0Owo+IC0JfQo+IC0KPiAtCS8qIEFsbG9jYXRlIGZ1bmN0aW9uIGF2YWlsYWJsZSBh
dHRyaWJ1dGUgY29tcG9uZW50ICovCj4gLQlhdmFpbF9jb21wID0ga21hbGxvYyhzaXplb2YoKmF2
YWlsX2NvbXApLCBHRlBfS0VSTkVMKTsKPiAtCWlmICghYXZhaWxfY29tcCkgewo+IC0JCWVyciA9
IC1FTk9NRU07Cj4gLQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQl9Cj4gLQlhdmFpbF9j
b21wLT5mdW5jdGlvbnNfbGlzdCA9IGNvdW50LT5mdW5jdGlvbnNfbGlzdDsKPiAtCWF2YWlsX2Nv
bXAtPm51bV9mdW5jdGlvbnMgPSBjb3VudC0+bnVtX2Z1bmN0aW9uczsKPiAtCj4gLQkvKiBDcmVh
dGUgQ291bnQgZnVuY3Rpb25fYXZhaWxhYmxlIGF0dHJpYnV0ZSAqLwo+IC0JcGFybS5ncm91cCA9
IGdyb3VwOwo+IC0JcGFybS5wcmVmaXggPSAiIjsKPiAtCXBhcm0ubmFtZSA9ICJmdW5jdGlvbl9h
dmFpbGFibGUiOwo+IC0JcGFybS5zaG93ID0gY291bnRlcl9mdW5jdGlvbl9hdmFpbGFibGVfc2hv
dzsKPiAtCXBhcm0uc3RvcmUgPSBOVUxMOwo+IC0JcGFybS5jb21wb25lbnQgPSBhdmFpbF9jb21w
Owo+IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAtCWlmIChlcnIp
IHsKPiAtCQlrZnJlZShhdmFpbF9jb21wKTsKPiAtCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsK
PiAtCX0KPiAtCj4gLQkvKiBDcmVhdGUgQ291bnQgbmFtZSBhdHRyaWJ1dGUgKi8KPiAtCWVyciA9
IGNvdW50ZXJfbmFtZV9hdHRyaWJ1dGVfY3JlYXRlKGdyb3VwLCBjb3VudC0+bmFtZSk7Cj4gLQlp
ZiAoZXJyKQo+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0KPiAtCS8qIFJlZ2lzdGVy
IENvdW50IGV4dGVuc2lvbiBhdHRyaWJ1dGVzICovCj4gLQllcnIgPSBjb3VudGVyX2NvdW50X2V4
dF9yZWdpc3Rlcihncm91cCwgY291bnQpOwo+IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9mcmVl
X2F0dHJfbGlzdDsKPiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2F0dHJfbGlzdDoK
PiAtCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsKPiAt
CXJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0YXRpYyBpbnQgY291bnRlcl9jb3VudHNfcmVnaXN0
ZXIoCj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXBzX2xp
c3QsCj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gLXsK
PiAtCXNpemVfdCBpOwo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50Owo+IC0JY29uc3Qg
Y2hhciAqbmFtZTsKPiAtCWludCBlcnI7Cj4gLQo+IC0JLyogUmVnaXN0ZXIgZWFjaCBDb3VudCAq
Lwo+IC0JZm9yIChpID0gMDsgaSA8IGNvdW50ZXItPm51bV9jb3VudHM7IGkrKykgewo+IC0JCWNv
dW50ID0gY291bnRlci0+Y291bnRzICsgaTsKPiAtCj4gLQkJLyogR2VuZXJhdGUgQ291bnQgYXR0
cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCj4gLQkJbmFtZSA9IGthc3ByaW50ZihHRlBfS0VSTkVM
LCAiY291bnQlZCIsIGNvdW50LT5pZCk7Cj4gLQkJaWYgKCFuYW1lKSB7Cj4gLQkJCWVyciA9IC1F
Tk9NRU07Cj4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9ncm91cHM7Cj4gLQkJfQo+IC0JCWdyb3Vw
c19saXN0W2ldLmF0dHJfZ3JvdXAubmFtZSA9IG5hbWU7Cj4gLQo+IC0JCS8qIFJlZ2lzdGVyIHRo
ZSBTeW5hcHNlcyBhc3NvY2lhdGVkIHdpdGggZWFjaCBDb3VudCAqLwo+IC0JCWVyciA9IGNvdW50
ZXJfc3luYXBzZXNfcmVnaXN0ZXIoZ3JvdXBzX2xpc3QgKyBpLCBjb3VudGVyLCBjb3VudCwKPiAt
CQkJCQkJbmFtZSk7Cj4gLQkJaWYgKGVycikKPiAtCQkJZ290byBlcnJfZnJlZV9hdHRyX2dyb3Vw
czsKPiAtCj4gLQkJLyogQ3JlYXRlIGFsbCBhdHRyaWJ1dGVzIGFzc29jaWF0ZWQgd2l0aCBDb3Vu
dCAqLwo+IC0JCWVyciA9IGNvdW50ZXJfY291bnRfYXR0cmlidXRlc19jcmVhdGUoZ3JvdXBzX2xp
c3QgKyBpLCBjb3VudGVyLAo+IC0JCQkJCQkgICAgICBjb3VudCk7Cj4gLQkJaWYgKGVycikKPiAt
CQkJZ290byBlcnJfZnJlZV9hdHRyX2dyb3VwczsKPiAtCX0KPiAtCj4gLQlyZXR1cm4gMDsKPiAt
Cj4gLWVycl9mcmVlX2F0dHJfZ3JvdXBzOgo+IC0JZG8gewo+IC0JCWtmcmVlKGdyb3Vwc19saXN0
W2ldLmF0dHJfZ3JvdXAubmFtZSk7Cj4gLQkJY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUo
Jmdyb3Vwc19saXN0W2ldLmF0dHJfbGlzdCk7Cj4gLQl9IHdoaWxlIChpLS0pOwo+IC0JcmV0dXJu
IGVycjsKPiAtfQo+IC0KPiAtc3RydWN0IGNvdW50ZXJfc2l6ZV91bml0IHsKPiAtCXNpemVfdCBz
aXplOwo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9kZXZpY2VfYXR0cl9zaXpl
X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJCSAgICAgc3RydWN0IGRldmljZV9hdHRy
aWJ1dGUgKmF0dHIsCj4gLQkJCQkJICAgICBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVj
dCBjb3VudGVyX3NpemVfdW5pdCAqY29uc3QgY29tcCA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKS0+
Y29tcG9uZW50Owo+IC0KPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV6dVxuIiwgY29tcC0+c2l6
ZSk7Cj4gLX0KPiAtCj4gLXN0YXRpYyBpbnQgY291bnRlcl9zaXplX2F0dHJpYnV0ZV9jcmVhdGUo
Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCj4gLQlj
b25zdCBzaXplX3Qgc2l6ZSwgY29uc3QgY2hhciAqY29uc3QgbmFtZSkKPiAtewo+IC0Jc3RydWN0
IGNvdW50ZXJfc2l6ZV91bml0ICpzaXplX2NvbXA7Cj4gLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bh
cm0gcGFybTsKPiAtCWludCBlcnI7Cj4gLQo+IC0JLyogQWxsb2NhdGUgc2l6ZSBhdHRyaWJ1dGUg
Y29tcG9uZW50ICovCj4gLQlzaXplX2NvbXAgPSBrbWFsbG9jKHNpemVvZigqc2l6ZV9jb21wKSwg
R0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIXNpemVfY29tcCkKPiAtCQlyZXR1cm4gLUVOT01FTTsKPiAt
CXNpemVfY29tcC0+c2l6ZSA9IHNpemU7Cj4gLQo+IC0JcGFybS5ncm91cCA9IGdyb3VwOwo+IC0J
cGFybS5wcmVmaXggPSAiIjsKPiAtCXBhcm0ubmFtZSA9IG5hbWU7Cj4gLQlwYXJtLnNob3cgPSBj
b3VudGVyX2RldmljZV9hdHRyX3NpemVfc2hvdzsKPiAtCXBhcm0uc3RvcmUgPSBOVUxMOwo+IC0J
cGFybS5jb21wb25lbnQgPSBzaXplX2NvbXA7Cj4gLQllcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9j
cmVhdGUoJnBhcm0pOwo+IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9mcmVlX3NpemVfY29tcDsK
PiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX3NpemVfY29tcDoKPiAtCWtmcmVlKHNp
emVfY29tcCk7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9leHRf
dW5pdCB7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZXh0ICpleHQ7Cj4gLX07Cj4g
LQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2RldmljZV9leHRfc2hvdyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4gLQkJCQkgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIg
KmJ1ZikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRl
dmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9l
eHRfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0JY29uc3Qg
c3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4dCAqY29uc3QgZXh0ID0gY29tcG9uZW50LT5leHQ7Cj4g
LQo+IC0JcmV0dXJuIGV4dC0+cmVhZChkZXZfZ2V0X2RydmRhdGEoZGV2KSwgZXh0LT5wcml2LCBi
dWYpOwo+IC19Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2RldmljZV9leHRfc3RvcmUo
c3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LAo+IC0JCQkJCWNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiAtewo+IC0JY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIo
YXR0cik7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9leHRfdW5pdCAqY29uc3QgY29tcG9uZW50
ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4
dCAqY29uc3QgZXh0ID0gY29tcG9uZW50LT5leHQ7Cj4gLQo+IC0JcmV0dXJuIGV4dC0+d3JpdGUo
ZGV2X2dldF9kcnZkYXRhKGRldiksIGV4dC0+cHJpdiwgYnVmLCBsZW4pOwo+IC19Cj4gLQo+IC1z
dGF0aWMgaW50IGNvdW50ZXJfZGV2aWNlX2V4dF9yZWdpc3RlcigKPiAtCXN0cnVjdCBjb3VudGVy
X2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiAtCXN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY29uc3QgY291bnRlcikKPiAtewo+IC0Jc2l6ZV90IGk7Cj4gLQlzdHJ1Y3QgY291bnRlcl9l
eHRfdW5pdCAqZXh0X2NvbXA7Cj4gLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiAt
CWludCBlcnI7Cj4gLQo+IC0JLyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBleHRlbnNp
b24gKi8KPiAtCWZvciAoaSA9IDAgOyBpIDwgY291bnRlci0+bnVtX2V4dDsgaSsrKSB7Cj4gLQkJ
LyogQWxsb2NhdGUgZXh0ZW5zaW9uIGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiAtCQlleHRfY29t
cCA9IGttYWxsb2Moc2l6ZW9mKCpleHRfY29tcCksIEdGUF9LRVJORUwpOwo+IC0JCWlmICghZXh0
X2NvbXApIHsKPiAtCQkJZXJyID0gLUVOT01FTTsKPiAtCQkJZ290byBlcnJfZnJlZV9hdHRyX2xp
c3Q7Cj4gLQkJfQo+IC0KPiAtCQlleHRfY29tcC0+ZXh0ID0gY291bnRlci0+ZXh0ICsgaTsKPiAt
Cj4gLQkJLyogQWxsb2NhdGUgZXh0ZW5zaW9uIGF0dHJpYnV0ZSAqLwo+IC0JCXBhcm0uZ3JvdXAg
PSBncm91cDsKPiAtCQlwYXJtLnByZWZpeCA9ICIiOwo+IC0JCXBhcm0ubmFtZSA9IGNvdW50ZXIt
PmV4dFtpXS5uYW1lOwo+IC0JCXBhcm0uc2hvdyA9IChjb3VudGVyLT5leHRbaV0ucmVhZCkgPyBj
b3VudGVyX2RldmljZV9leHRfc2hvdyA6IE5VTEw7Cj4gLQkJcGFybS5zdG9yZSA9IChjb3VudGVy
LT5leHRbaV0ud3JpdGUpID8gY291bnRlcl9kZXZpY2VfZXh0X3N0b3JlIDogTlVMTDsKPiAtCQlw
YXJtLmNvbXBvbmVudCA9IGV4dF9jb21wOwo+IC0JCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2Ny
ZWF0ZSgmcGFybSk7Cj4gLQkJaWYgKGVycikgewo+IC0JCQlrZnJlZShleHRfY29tcCk7Cj4gLQkJ
CWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0JCX0KPiAtCX0KPiAtCj4gLQlyZXR1cm4gMDsK
PiAtCj4gLWVycl9mcmVlX2F0dHJfbGlzdDoKPiAtCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9m
cmVlKCZncm91cC0+YXR0cl9saXN0KTsKPiAtCXJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0YXRp
YyBpbnQgY291bnRlcl9nbG9iYWxfYXR0cl9yZWdpc3RlcigKPiAtCXN0cnVjdCBjb3VudGVyX2Rl
dmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y29uc3QgY291bnRlcikKPiAtewo+IC0JaW50IGVycjsKPiAtCj4gLQkvKiBDcmVhdGUgbmFtZSBh
dHRyaWJ1dGUgKi8KPiAtCWVyciA9IGNvdW50ZXJfbmFtZV9hdHRyaWJ1dGVfY3JlYXRlKGdyb3Vw
LCBjb3VudGVyLT5uYW1lKTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVycjsKPiAtCj4gLQkv
KiBDcmVhdGUgbnVtX2NvdW50cyBhdHRyaWJ1dGUgKi8KPiAtCWVyciA9IGNvdW50ZXJfc2l6ZV9h
dHRyaWJ1dGVfY3JlYXRlKGdyb3VwLCBjb3VudGVyLT5udW1fY291bnRzLAo+IC0JCQkJCSAgICAi
bnVtX2NvdW50cyIpOwo+IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsK
PiAtCj4gLQkvKiBDcmVhdGUgbnVtX3NpZ25hbHMgYXR0cmlidXRlICovCj4gLQllcnIgPSBjb3Vu
dGVyX3NpemVfYXR0cmlidXRlX2NyZWF0ZShncm91cCwgY291bnRlci0+bnVtX3NpZ25hbHMsCj4g
LQkJCQkJICAgICJudW1fc2lnbmFscyIpOwo+IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9mcmVl
X2F0dHJfbGlzdDsKPiAtCj4gLQkvKiBSZWdpc3RlciBDb3VudGVyIGRldmljZSBleHRlbnNpb24g
YXR0cmlidXRlcyAqLwo+IC0JZXJyID0gY291bnRlcl9kZXZpY2VfZXh0X3JlZ2lzdGVyKGdyb3Vw
LCBjb3VudGVyKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4g
LQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6Cj4gLQljb3VudGVyX2Rl
dmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlzdCk7Cj4gLQlyZXR1cm4gZXJyOwo+
IC19Cj4gLQo+IC1zdGF0aWMgdm9pZCBjb3VudGVyX2RldmljZV9ncm91cHNfbGlzdF9mcmVlKAo+
IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3Vwc19saXN0LAo+
IC0JY29uc3Qgc2l6ZV90IG51bV9ncm91cHMpCj4gLXsKPiAtCXN0cnVjdCBjb3VudGVyX2Rldmlj
ZV9hdHRyX2dyb3VwICpncm91cDsKPiAtCXNpemVfdCBpOwo+IC0KPiAtCS8qIGxvb3AgdGhyb3Vn
aCBhbGwgYXR0cmlidXRlIGdyb3VwcyAoc2lnbmFscywgY291bnRzLCBnbG9iYWwsIGV0Yy4pICov
Cj4gLQlmb3IgKGkgPSAwOyBpIDwgbnVtX2dyb3VwczsgaSsrKSB7Cj4gLQkJZ3JvdXAgPSBncm91
cHNfbGlzdCArIGk7Cj4gLQo+IC0JCS8qIGZyZWUgYWxsIGF0dHJpYnV0ZSBncm91cCBhbmQgYXNz
b2NpYXRlZCBhdHRyaWJ1dGVzIG1lbW9yeSAqLwo+IC0JCWtmcmVlKGdyb3VwLT5hdHRyX2dyb3Vw
Lm5hbWUpOwo+IC0JCWtmcmVlKGdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzKTsKPiAtCQljb3VudGVy
X2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlzdCk7Cj4gLQl9Cj4gLQo+IC0J
a2ZyZWUoZ3JvdXBzX2xpc3QpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJfZGV2aWNl
X2dyb3Vwc19saXN0X3ByZXBhcmUoCj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNv
dW50ZXIpCj4gLXsKPiAtCWNvbnN0IHNpemVfdCB0b3RhbF9udW1fZ3JvdXBzID0KPiAtCQljb3Vu
dGVyLT5udW1fc2lnbmFscyArIGNvdW50ZXItPm51bV9jb3VudHMgKyAxOwo+IC0Jc3RydWN0IGNv
dW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmdyb3Vwc19saXN0Owo+IC0Jc2l6ZV90IGk7Cj4gLQlp
bnQgZXJyOwo+IC0Jc2l6ZV90IG51bV9ncm91cHMgPSAwOwo+IC0KPiAtCS8qIEFsbG9jYXRlIHNw
YWNlIGZvciBhdHRyaWJ1dGUgZ3JvdXBzIChzaWduYWxzLCBjb3VudHMsIGFuZCBleHQpICovCj4g
LQlncm91cHNfbGlzdCA9IGtjYWxsb2ModG90YWxfbnVtX2dyb3Vwcywgc2l6ZW9mKCpncm91cHNf
bGlzdCksCj4gLQkJCSAgICAgIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFncm91cHNfbGlzdCkKPiAt
CQlyZXR1cm4gLUVOT01FTTsKPiAtCj4gLQkvKiBJbml0aWFsaXplIGF0dHJpYnV0ZSBsaXN0cyAq
Lwo+IC0JZm9yIChpID0gMDsgaSA8IHRvdGFsX251bV9ncm91cHM7IGkrKykKPiAtCQlJTklUX0xJ
U1RfSEVBRCgmZ3JvdXBzX2xpc3RbaV0uYXR0cl9saXN0KTsKPiAtCj4gLQkvKiBSZWdpc3RlciBT
aWduYWxzICovCj4gLQllcnIgPSBjb3VudGVyX3NpZ25hbHNfcmVnaXN0ZXIoZ3JvdXBzX2xpc3Qs
IGNvdW50ZXIpOwo+IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9mcmVlX2dyb3Vwc19saXN0Owo+
IC0JbnVtX2dyb3VwcyArPSBjb3VudGVyLT5udW1fc2lnbmFsczsKPiAtCj4gLQkvKiBSZWdpc3Rl
ciBDb3VudHMgYW5kIHJlc3BlY3RpdmUgU3luYXBzZXMgKi8KPiAtCWVyciA9IGNvdW50ZXJfY291
bnRzX3JlZ2lzdGVyKGdyb3Vwc19saXN0ICsgbnVtX2dyb3VwcywgY291bnRlcik7Cj4gLQlpZiAo
ZXJyKQo+IC0JCWdvdG8gZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q7Cj4gLQludW1fZ3JvdXBzICs9IGNv
dW50ZXItPm51bV9jb3VudHM7Cj4gLQo+IC0JLyogUmVnaXN0ZXIgQ291bnRlciBnbG9iYWwgYXR0
cmlidXRlcyAqLwo+IC0JZXJyID0gY291bnRlcl9nbG9iYWxfYXR0cl9yZWdpc3Rlcihncm91cHNf
bGlzdCArIG51bV9ncm91cHMsIGNvdW50ZXIpOwo+IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9m
cmVlX2dyb3Vwc19saXN0Owo+IC0JbnVtX2dyb3VwcysrOwo+IC0KPiAtCS8qIFN0b3JlIGdyb3Vw
c19saXN0IGluIGRldmljZV9zdGF0ZSAqLwo+IC0JY291bnRlci0+ZGV2aWNlX3N0YXRlLT5ncm91
cHNfbGlzdCA9IGdyb3Vwc19saXN0Owo+IC0JY291bnRlci0+ZGV2aWNlX3N0YXRlLT5udW1fZ3Jv
dXBzID0gbnVtX2dyb3VwczsKPiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2dyb3Vw
c19saXN0Ogo+IC0JY291bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3RfZnJlZShncm91cHNfbGlzdCwg
bnVtX2dyb3Vwcyk7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50
ZXJfZGV2aWNlX2dyb3Vwc19wcmVwYXJlKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX3N0YXRl
ICpjb25zdCBkZXZpY2Vfc3RhdGUpCj4gLXsKPiAtCXNpemVfdCBpLCBqOwo+IC0Jc3RydWN0IGNv
dW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmdyb3VwOwo+IC0JaW50IGVycjsKPiAtCXN0cnVjdCBj
b3VudGVyX2RldmljZV9hdHRyICpwOwo+IC0KPiAtCS8qIEFsbG9jYXRlIGF0dHJpYnV0ZSBncm91
cHMgZm9yIGFzc29jaWF0aW9uIHdpdGggZGV2aWNlICovCj4gLQlkZXZpY2Vfc3RhdGUtPmdyb3Vw
cyA9IGtjYWxsb2MoZGV2aWNlX3N0YXRlLT5udW1fZ3JvdXBzICsgMSwKPiAtCQkJCSAgICAgICBz
aXplb2YoKmRldmljZV9zdGF0ZS0+Z3JvdXBzKSwKPiAtCQkJCSAgICAgICBHRlBfS0VSTkVMKTsK
PiAtCWlmICghZGV2aWNlX3N0YXRlLT5ncm91cHMpCj4gLQkJcmV0dXJuIC1FTk9NRU07Cj4gLQo+
IC0JLyogUHJlcGFyZSBlYWNoIGdyb3VwIG9mIGF0dHJpYnV0ZXMgZm9yIGFzc29jaWF0aW9uICov
Cj4gLQlmb3IgKGkgPSAwOyBpIDwgZGV2aWNlX3N0YXRlLT5udW1fZ3JvdXBzOyBpKyspIHsKPiAt
CQlncm91cCA9IGRldmljZV9zdGF0ZS0+Z3JvdXBzX2xpc3QgKyBpOwo+IC0KPiAtCQkvKiBBbGxv
Y2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIHBvaW50ZXJzIGluIGF0dHJpYnV0ZSBncm91cCAqLwo+
IC0JCWdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzID0ga2NhbGxvYyhncm91cC0+bnVtX2F0dHIgKyAx
LAo+IC0JCQlzaXplb2YoKmdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzKSwgR0ZQX0tFUk5FTCk7Cj4g
LQkJaWYgKCFncm91cC0+YXR0cl9ncm91cC5hdHRycykgewo+IC0JCQllcnIgPSAtRU5PTUVNOwo+
IC0JCQlnb3RvIGVycl9mcmVlX2dyb3VwczsKPiAtCQl9Cj4gLQo+IC0JCS8qIEFkZCBhdHRyaWJ1
dGUgcG9pbnRlcnMgdG8gYXR0cmlidXRlIGdyb3VwICovCj4gLQkJaiA9IDA7Cj4gLQkJbGlzdF9m
b3JfZWFjaF9lbnRyeShwLCAmZ3JvdXAtPmF0dHJfbGlzdCwgbCkKPiAtCQkJZ3JvdXAtPmF0dHJf
Z3JvdXAuYXR0cnNbaisrXSA9ICZwLT5kZXZfYXR0ci5hdHRyOwo+IC0KPiAtCQkvKiBHcm91cCBh
dHRyaWJ1dGVzIGluIGF0dHJpYnV0ZSBncm91cCAqLwo+IC0JCWRldmljZV9zdGF0ZS0+Z3JvdXBz
W2ldID0gJmdyb3VwLT5hdHRyX2dyb3VwOwo+IC0JfQo+IC0JLyogQXNzb2NpYXRlIGF0dHJpYnV0
ZXMgd2l0aCBkZXZpY2UgKi8KPiAtCWRldmljZV9zdGF0ZS0+ZGV2Lmdyb3VwcyA9IGRldmljZV9z
dGF0ZS0+Z3JvdXBzOwo+IC0KPiAtCXJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfZ3JvdXBzOgo+
IC0JZG8gewo+IC0JCWdyb3VwID0gZGV2aWNlX3N0YXRlLT5ncm91cHNfbGlzdCArIGk7Cj4gLQkJ
a2ZyZWUoZ3JvdXAtPmF0dHJfZ3JvdXAuYXR0cnMpOwo+IC0JCWdyb3VwLT5hdHRyX2dyb3VwLmF0
dHJzID0gTlVMTDsKPiAtCX0gd2hpbGUgKGktLSk7Cj4gLQlrZnJlZShkZXZpY2Vfc3RhdGUtPmdy
b3Vwcyk7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC0vKiBQcm92aWRlcyBhIHVuaXF1ZSBJ
RCBmb3IgZWFjaCBjb3VudGVyIGRldmljZSAqLwo+IC1zdGF0aWMgREVGSU5FX0lEQShjb3VudGVy
X2lkYSk7Cj4gLQo+IC1zdGF0aWMgdm9pZCBjb3VudGVyX2RldmljZV9yZWxlYXNlKHN0cnVjdCBk
ZXZpY2UgKmRldikKPiAtewo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVy
ID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUg
KmNvbnN0IGRldmljZV9zdGF0ZSA9IGNvdW50ZXItPmRldmljZV9zdGF0ZTsKPiAtCj4gLQlrZnJl
ZShkZXZpY2Vfc3RhdGUtPmdyb3Vwcyk7Cj4gLQljb3VudGVyX2RldmljZV9ncm91cHNfbGlzdF9m
cmVlKGRldmljZV9zdGF0ZS0+Z3JvdXBzX2xpc3QsCj4gLQkJCQkJZGV2aWNlX3N0YXRlLT5udW1f
Z3JvdXBzKTsKPiAtCWlkYV9zaW1wbGVfcmVtb3ZlKCZjb3VudGVyX2lkYSwgZGV2aWNlX3N0YXRl
LT5pZCk7Cj4gLQlrZnJlZShkZXZpY2Vfc3RhdGUpOwo+IC19Cj4gLQo+IC1zdGF0aWMgc3RydWN0
IGRldmljZV90eXBlIGNvdW50ZXJfZGV2aWNlX3R5cGUgPSB7Cj4gLQkubmFtZSA9ICJjb3VudGVy
X2RldmljZSIsCj4gLQkucmVsZWFzZSA9IGNvdW50ZXJfZGV2aWNlX3JlbGVhc2UKPiAtfTsKPiAt
Cj4gLXN0YXRpYyBzdHJ1Y3QgYnVzX3R5cGUgY291bnRlcl9idXNfdHlwZSA9IHsKPiAtCS5uYW1l
ID0gImNvdW50ZXIiCj4gLX07Cj4gLQo+IC0vKioKPiAtICogY291bnRlcl9yZWdpc3RlciAtIHJl
Z2lzdGVyIENvdW50ZXIgdG8gdGhlIHN5c3RlbQo+IC0gKiBAY291bnRlcjoJcG9pbnRlciB0byBD
b3VudGVyIHRvIHJlZ2lzdGVyCj4gLSAqCj4gLSAqIFRoaXMgZnVuY3Rpb24gcmVnaXN0ZXJzIGEg
Q291bnRlciB0byB0aGUgc3lzdGVtLiBBIHN5c2ZzICJjb3VudGVyIiBkaXJlY3RvcnkKPiAtICog
d2lsbCBiZSBjcmVhdGVkIGFuZCBwb3B1bGF0ZWQgd2l0aCBzeXNmcyBhdHRyaWJ1dGVzIGNvcnJl
bGF0aW5nIHdpdGggdGhlCj4gLSAqIENvdW50ZXIgU2lnbmFscywgU3luYXBzZXMsIGFuZCBDb3Vu
dHMgcmVzcGVjdGl2ZWx5Lgo+IC0gKi8KPiAtaW50IGNvdW50ZXJfcmVnaXN0ZXIoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZp
Y2Vfc3RhdGUgKmRldmljZV9zdGF0ZTsKPiAtCWludCBlcnI7Cj4gLQo+IC0JLyogQWxsb2NhdGUg
aW50ZXJuYWwgc3RhdGUgY29udGFpbmVyIGZvciBDb3VudGVyIGRldmljZSAqLwo+IC0JZGV2aWNl
X3N0YXRlID0ga3phbGxvYyhzaXplb2YoKmRldmljZV9zdGF0ZSksIEdGUF9LRVJORUwpOwo+IC0J
aWYgKCFkZXZpY2Vfc3RhdGUpCj4gLQkJcmV0dXJuIC1FTk9NRU07Cj4gLQljb3VudGVyLT5kZXZp
Y2Vfc3RhdGUgPSBkZXZpY2Vfc3RhdGU7Cj4gLQo+IC0JLyogQWNxdWlyZSB1bmlxdWUgSUQgKi8K
PiAtCWRldmljZV9zdGF0ZS0+aWQgPSBpZGFfc2ltcGxlX2dldCgmY291bnRlcl9pZGEsIDAsIDAs
IEdGUF9LRVJORUwpOwo+IC0JaWYgKGRldmljZV9zdGF0ZS0+aWQgPCAwKSB7Cj4gLQkJZXJyID0g
ZGV2aWNlX3N0YXRlLT5pZDsKPiAtCQlnb3RvIGVycl9mcmVlX2RldmljZV9zdGF0ZTsKPiAtCX0K
PiAtCj4gLQkvKiBDb25maWd1cmUgZGV2aWNlIHN0cnVjdHVyZSBmb3IgQ291bnRlciAqLwo+IC0J
ZGV2aWNlX3N0YXRlLT5kZXYudHlwZSA9ICZjb3VudGVyX2RldmljZV90eXBlOwo+IC0JZGV2aWNl
X3N0YXRlLT5kZXYuYnVzID0gJmNvdW50ZXJfYnVzX3R5cGU7Cj4gLQlpZiAoY291bnRlci0+cGFy
ZW50KSB7Cj4gLQkJZGV2aWNlX3N0YXRlLT5kZXYucGFyZW50ID0gY291bnRlci0+cGFyZW50Owo+
IC0JCWRldmljZV9zdGF0ZS0+ZGV2Lm9mX25vZGUgPSBjb3VudGVyLT5wYXJlbnQtPm9mX25vZGU7
Cj4gLQl9Cj4gLQlkZXZfc2V0X25hbWUoJmRldmljZV9zdGF0ZS0+ZGV2LCAiY291bnRlciVkIiwg
ZGV2aWNlX3N0YXRlLT5pZCk7Cj4gLQlkZXZpY2VfaW5pdGlhbGl6ZSgmZGV2aWNlX3N0YXRlLT5k
ZXYpOwo+IC0JZGV2X3NldF9kcnZkYXRhKCZkZXZpY2Vfc3RhdGUtPmRldiwgY291bnRlcik7Cj4g
LQo+IC0JLyogUHJlcGFyZSBkZXZpY2UgYXR0cmlidXRlcyAqLwo+IC0JZXJyID0gY291bnRlcl9k
ZXZpY2VfZ3JvdXBzX2xpc3RfcHJlcGFyZShjb3VudGVyKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290
byBlcnJfZnJlZV9pZDsKPiAtCj4gLQkvKiBPcmdhbml6ZSBkZXZpY2UgYXR0cmlidXRlcyB0byBn
cm91cHMgYW5kIG1hdGNoIHRvIGRldmljZSAqLwo+IC0JZXJyID0gY291bnRlcl9kZXZpY2VfZ3Jv
dXBzX3ByZXBhcmUoZGV2aWNlX3N0YXRlKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290byBlcnJfZnJl
ZV9ncm91cHNfbGlzdDsKPiAtCj4gLQkvKiBBZGQgZGV2aWNlIHRvIHN5c3RlbSAqLwo+IC0JZXJy
ID0gZGV2aWNlX2FkZCgmZGV2aWNlX3N0YXRlLT5kZXYpOwo+IC0JaWYgKGVycikKPiAtCQlnb3Rv
IGVycl9mcmVlX2dyb3VwczsKPiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2dyb3Vw
czoKPiAtCWtmcmVlKGRldmljZV9zdGF0ZS0+Z3JvdXBzKTsKPiAtZXJyX2ZyZWVfZ3JvdXBzX2xp
c3Q6Cj4gLQljb3VudGVyX2RldmljZV9ncm91cHNfbGlzdF9mcmVlKGRldmljZV9zdGF0ZS0+Z3Jv
dXBzX2xpc3QsCj4gLQkJCQkJZGV2aWNlX3N0YXRlLT5udW1fZ3JvdXBzKTsKPiAtZXJyX2ZyZWVf
aWQ6Cj4gLQlpZGFfc2ltcGxlX3JlbW92ZSgmY291bnRlcl9pZGEsIGRldmljZV9zdGF0ZS0+aWQp
Owo+IC1lcnJfZnJlZV9kZXZpY2Vfc3RhdGU6Cj4gLQlrZnJlZShkZXZpY2Vfc3RhdGUpOwo+IC0J
cmV0dXJuIGVycjsKPiAtfQo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3JlZ2lzdGVyKTsK
PiAtCj4gLS8qKgo+IC0gKiBjb3VudGVyX3VucmVnaXN0ZXIgLSB1bnJlZ2lzdGVyIENvdW50ZXIg
ZnJvbSB0aGUgc3lzdGVtCj4gLSAqIEBjb3VudGVyOglwb2ludGVyIHRvIENvdW50ZXIgdG8gdW5y
ZWdpc3Rlcgo+IC0gKgo+IC0gKiBUaGUgQ291bnRlciBpcyB1bnJlZ2lzdGVyZWQgZnJvbSB0aGUg
c3lzdGVtOyBhbGwgYWxsb2NhdGVkIG1lbW9yeSBpcyBmcmVlZC4KPiAtICovCj4gLXZvaWQgY291
bnRlcl91bnJlZ2lzdGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiAt
ewo+IC0JaWYgKGNvdW50ZXIpCj4gLQkJZGV2aWNlX2RlbCgmY291bnRlci0+ZGV2aWNlX3N0YXRl
LT5kZXYpOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfdW5yZWdpc3Rlcik7Cj4g
LQo+IC1zdGF0aWMgdm9pZCBkZXZtX2NvdW50ZXJfdW5yZWcoc3RydWN0IGRldmljZSAqZGV2LCB2
b2lkICpyZXMpCj4gLXsKPiAtCWNvdW50ZXJfdW5yZWdpc3RlcigqKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqKilyZXMpOwo+IC19Cj4gLQo+IC0vKioKPiAtICogZGV2bV9jb3VudGVyX3JlZ2lzdGVy
IC0gUmVzb3VyY2UtbWFuYWdlZCBjb3VudGVyX3JlZ2lzdGVyCj4gLSAqIEBkZXY6CWRldmljZSB0
byBhbGxvY2F0ZSBjb3VudGVyX2RldmljZSBmb3IKPiAtICogQGNvdW50ZXI6CXBvaW50ZXIgdG8g
Q291bnRlciB0byByZWdpc3Rlcgo+IC0gKgo+IC0gKiBNYW5hZ2VkIGNvdW50ZXJfcmVnaXN0ZXIu
IFRoZSBDb3VudGVyIHJlZ2lzdGVyZWQgd2l0aCB0aGlzIGZ1bmN0aW9uIGlzCj4gLSAqIGF1dG9t
YXRpY2FsbHkgdW5yZWdpc3RlcmVkIG9uIGRyaXZlciBkZXRhY2guIFRoaXMgZnVuY3Rpb24gY2Fs
bHMKPiAtICogY291bnRlcl9yZWdpc3RlciBpbnRlcm5hbGx5LiBSZWZlciB0byB0aGF0IGZ1bmN0
aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uLgo+IC0gKgo+IC0gKiBJZiBhbiBDb3VudGVyIHJlZ2lz
dGVyZWQgd2l0aCB0aGlzIGZ1bmN0aW9uIG5lZWRzIHRvIGJlIHVucmVnaXN0ZXJlZAo+IC0gKiBz
ZXBhcmF0ZWx5LCBkZXZtX2NvdW50ZXJfdW5yZWdpc3RlciBtdXN0IGJlIHVzZWQuCj4gLSAqCj4g
LSAqIFJFVFVSTlM6Cj4gLSAqIDAgb24gc3VjY2VzcywgbmVnYXRpdmUgZXJyb3IgbnVtYmVyIG9u
IGZhaWx1cmUuCj4gLSAqLwo+IC1pbnQgZGV2bV9jb3VudGVyX3JlZ2lzdGVyKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAtCQkJICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4g
LXsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqKnB0cjsKPiAtCWludCByZXQ7Cj4gLQo+IC0J
cHRyID0gZGV2cmVzX2FsbG9jKGRldm1fY291bnRlcl91bnJlZywgc2l6ZW9mKCpwdHIpLCBHRlBf
S0VSTkVMKTsKPiAtCWlmICghcHRyKQo+IC0JCXJldHVybiAtRU5PTUVNOwo+IC0KPiAtCXJldCA9
IGNvdW50ZXJfcmVnaXN0ZXIoY291bnRlcik7Cj4gLQlpZiAoIXJldCkgewo+IC0JCSpwdHIgPSBj
b3VudGVyOwo+IC0JCWRldnJlc19hZGQoZGV2LCBwdHIpOwo+IC0JfSBlbHNlIHsKPiAtCQlkZXZy
ZXNfZnJlZShwdHIpOwo+IC0JfQo+IC0KPiAtCXJldHVybiByZXQ7Cj4gLX0KPiAtRVhQT1JUX1NZ
TUJPTF9HUEwoZGV2bV9jb3VudGVyX3JlZ2lzdGVyKTsKPiAtCj4gLXN0YXRpYyBpbnQgZGV2bV9j
b3VudGVyX21hdGNoKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqcmVzLCB2b2lkICpkYXRhKQo+
IC17Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKipyID0gcmVzOwo+IC0KPiAtCWlmICghciB8
fCAhKnIpIHsKPiAtCQlXQVJOX09OKCFyIHx8ICEqcik7Cj4gLQkJcmV0dXJuIDA7Cj4gLQl9Cj4g
LQo+IC0JcmV0dXJuICpyID09IGRhdGE7Cj4gLX0KPiAtCj4gLS8qKgo+IC0gKiBkZXZtX2NvdW50
ZXJfdW5yZWdpc3RlciAtIFJlc291cmNlLW1hbmFnZWQgY291bnRlcl91bnJlZ2lzdGVyCj4gLSAq
IEBkZXY6CWRldmljZSB0aGlzIGNvdW50ZXJfZGV2aWNlIGJlbG9uZ3MgdG8KPiAtICogQGNvdW50
ZXI6CXBvaW50ZXIgdG8gQ291bnRlciBhc3NvY2lhdGVkIHdpdGggdGhlIGRldmljZQo+IC0gKgo+
IC0gKiBVbnJlZ2lzdGVyIENvdW50ZXIgcmVnaXN0ZXJlZCB3aXRoIGRldm1fY291bnRlcl9yZWdp
c3Rlci4KPiAtICovCj4gLXZvaWQgZGV2bV9jb3VudGVyX3VucmVnaXN0ZXIoc3RydWN0IGRldmlj
ZSAqZGV2LAo+IC0JCQkgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikK
PiAtewo+IC0JaW50IHJjOwo+IC0KPiAtCXJjID0gZGV2cmVzX3JlbGVhc2UoZGV2LCBkZXZtX2Nv
dW50ZXJfdW5yZWcsIGRldm1fY291bnRlcl9tYXRjaCwKPiAtCQkJICAgIGNvdW50ZXIpOwo+IC0J
V0FSTl9PTihyYyk7Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoZGV2bV9jb3VudGVyX3VucmVn
aXN0ZXIpOwo+IC0KPiAtc3RhdGljIGludCBfX2luaXQgY291bnRlcl9pbml0KHZvaWQpCj4gLXsK
PiAtCXJldHVybiBidXNfcmVnaXN0ZXIoJmNvdW50ZXJfYnVzX3R5cGUpOwo+IC19Cj4gLQo+IC1z
dGF0aWMgdm9pZCBfX2V4aXQgY291bnRlcl9leGl0KHZvaWQpCj4gLXsKPiAtCWJ1c191bnJlZ2lz
dGVyKCZjb3VudGVyX2J1c190eXBlKTsKPiAtfQo+IC0KPiAtc3Vic3lzX2luaXRjYWxsKGNvdW50
ZXJfaW5pdCk7Cj4gLW1vZHVsZV9leGl0KGNvdW50ZXJfZXhpdCk7Cj4gLQo+IC1NT0RVTEVfQVVU
SE9SKCJXaWxsaWFtIEJyZWF0aGl0dCBHcmF5IDx2aWxoZWxtLmdyYXlAZ21haWwuY29tPiIpOwo+
IC1NT0RVTEVfREVTQ1JJUFRJT04oIkdlbmVyaWMgQ291bnRlciBpbnRlcmZhY2UiKTsKPiAtTU9E
VUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvZnRt
LXF1YWRkZWMuYyBiL2RyaXZlcnMvY291bnRlci9mdG0tcXVhZGRlYy5jCj4gaW5kZXggNTNjMTVm
ODQ5MDliLi4wOTJhODA2YTQ2ZDggMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jb3VudGVyL2Z0bS1x
dWFkZGVjLmMKPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvZnRtLXF1YWRkZWMuYwo+IEBAIC0xNCw2
ICsxNCw3IEBACj4gICNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgo+ICAjaW5jbHVkZSA8bGludXgv
Y291bnRlci5oPgo+ICAjaW5jbHVkZSA8bGludXgvYml0ZmllbGQuaD4KPiArI2luY2x1ZGUgPGxp
bnV4L3R5cGVzLmg+Cj4gIAo+ICAjZGVmaW5lIEZUTV9GSUVMRF9VUERBVEUoZnRtLCBvZmZzZXQs
IG1hc2ssIHZhbCkJCQlcCj4gIAkoewkJCQkJCQkJXAo+IEBAIC0xMTUsOCArMTE2LDcgQEAgc3Rh
dGljIHZvaWQgZnRtX3F1YWRkZWNfZGlzYWJsZSh2b2lkICpmdG0pCj4gIH0KPiAgCj4gIHN0YXRp
YyBpbnQgZnRtX3F1YWRkZWNfZ2V0X3ByZXNjYWxlcihzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gLQkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAg
ICAgc2l6ZV90ICpjbnRfbW9kZSkKPiArCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50LCB1MzIgKmNudF9tb2RlKQo+ICB7Cj4gIAlzdHJ1Y3QgZnRtX3F1YWRkZWMgKmZ0bSA9IGNv
dW50ZXItPnByaXY7Cj4gIAl1aW50MzJfdCBzY2ZsYWdzOwo+IEBAIC0xMjksOCArMTI5LDcgQEAg
c3RhdGljIGludCBmdG1fcXVhZGRlY19nZXRfcHJlc2NhbGVyKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiAgfQo+ICAKPiAgc3RhdGljIGludCBmdG1fcXVhZGRlY19zZXRfcHJlc2Nh
bGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAgICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJICAgICBzaXplX3QgY250X21vZGUpCj4gKwkJCQkg
ICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyIGNudF9tb2RlKQo+ICB7Cj4gIAlz
dHJ1Y3QgZnRtX3F1YWRkZWMgKmZ0bSA9IGNvdW50ZXItPnByaXY7Cj4gIAo+IEBAIC0xNTEsMzMg
KzE1MCwyMSBAQCBzdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IGZ0bV9xdWFkZGVjX3ByZXNjYWxl
cltdID0gewo+ICAJIjEiLCAiMiIsICI0IiwgIjgiLCAiMTYiLCAiMzIiLCAiNjQiLCAiMTI4Igo+
ICB9Owo+ICAKPiAtc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvdW50X2VudW1fZXh0IGZ0bV9xdWFk
ZGVjX3ByZXNjYWxlcl9lbnVtID0gewo+IC0JLml0ZW1zID0gZnRtX3F1YWRkZWNfcHJlc2NhbGVy
LAo+IC0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUoZnRtX3F1YWRkZWNfcHJlc2NhbGVyKSwKPiAt
CS5nZXQgPSBmdG1fcXVhZGRlY19nZXRfcHJlc2NhbGVyLAo+IC0JLnNldCA9IGZ0bV9xdWFkZGVj
X3NldF9wcmVzY2FsZXIKPiAtfTsKPiAtCj4gLWVudW0gZnRtX3F1YWRkZWNfc3luYXBzZV9hY3Rp
b24gewo+IC0JRlRNX1FVQURERUNfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiAtfTsKPiAt
Cj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gZnRtX3F1YWRkZWNf
c3luYXBzZV9hY3Rpb25zW10gPSB7Cj4gLQlbRlRNX1FVQURERUNfU1lOQVBTRV9BQ1RJT05fQk9U
SF9FREdFU10gPQo+ICAJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gIH07Cj4g
IAo+ICBlbnVtIGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0aW9uIHsKPiAtCUZUTV9RVUFEREVDX0NP
VU5UX0VOQ09ERVJfTU9ERV8xLAo+ICsJRlRNX1FVQURERUNfQ09VTlRfRU5DT0RFUl9NT0RFXzEg
PSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gIH07Cj4gIAo+ICBzdGF0aWMgY29u
c3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0aW9uc1tdID0g
ewo+IC0JW0ZUTV9RVUFEREVDX0NPVU5UX0VOQ09ERVJfTU9ERV8xXSA9IENPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YNAo+ICsJRlRNX1FVQURERUNfQ09VTlRfRU5DT0RFUl9NT0RFXzEKPiAg
fTsKPiAgCj4gIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfY291bnRfcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gIAkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiAtCQkJCSAgdW5zaWduZWQgbG9uZyAqdmFsKQo+ICsJCQkJICB1NjQgKnZhbCkKPiAgewo+ICAJ
c3RydWN0IGZ0bV9xdWFkZGVjICpjb25zdCBmdG0gPSBjb3VudGVyLT5wcml2Owo+ICAJdWludDMy
X3QgY250dmFsOwo+IEBAIC0xOTEsNyArMTc4LDcgQEAgc3RhdGljIGludCBmdG1fcXVhZGRlY19j
b3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCj4gIHN0YXRpYyBp
bnQgZnRtX3F1YWRkZWNfY291bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICAJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJICAgY29uc3Qg
dW5zaWduZWQgbG9uZyB2YWwpCj4gKwkJCQkgICBjb25zdCB1NjQgdmFsKQo+ICB7Cj4gIAlzdHJ1
Y3QgZnRtX3F1YWRkZWMgKmNvbnN0IGZ0bSA9IGNvdW50ZXItPnByaXY7Cj4gIAo+IEBAIC0yMDUs
MjEgKzE5MiwyMSBAQCBzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2NvdW50X3dyaXRlKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMg
aW50IGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gLQkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkJ
ICBzaXplX3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0
aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCSAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQkgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24g
KmZ1bmN0aW9uKQo+ICB7Cj4gIAkqZnVuY3Rpb24gPSBGVE1fUVVBRERFQ19DT1VOVF9FTkNPREVS
X01PREVfMTsKPiAgCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIGludCBmdG1fcXVh
ZGRlY19hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJICBzdHJ1Y3QgY291bnRlcl9zeW5h
cHNlICpzeW5hcHNlLAo+IC0JCQkJICBzaXplX3QgKmFjdGlvbikKPiArc3RhdGljIGludCBmdG1f
cXVhZGRlY19hY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJ
CQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkgICBzdHJ1Y3QgY291bnRl
cl9zeW5hcHNlICpzeW5hcHNlLAo+ICsJCQkJICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9u
ICphY3Rpb24pCj4gIHsKPiAtCSphY3Rpb24gPSBGVE1fUVVBRERFQ19TWU5BUFNFX0FDVElPTl9C
T1RIX0VER0VTOwo+ICsJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdF
UzsKPiAgCj4gIAlyZXR1cm4gMDsKPiAgfQo+IEBAIC0yMjcsOCArMjE0LDggQEAgc3RhdGljIGlu
dCBmdG1fcXVhZGRlY19hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyBmdG1fcXVhZGRlY19jbnRfb3BzID0g
ewo+ICAJLmNvdW50X3JlYWQgPSBmdG1fcXVhZGRlY19jb3VudF9yZWFkLAo+ICAJLmNvdW50X3dy
aXRlID0gZnRtX3F1YWRkZWNfY291bnRfd3JpdGUsCj4gLQkuZnVuY3Rpb25fZ2V0ID0gZnRtX3F1
YWRkZWNfY291bnRfZnVuY3Rpb25fZ2V0LAo+IC0JLmFjdGlvbl9nZXQgPSBmdG1fcXVhZGRlY19h
Y3Rpb25fZ2V0LAo+ICsJLmZ1bmN0aW9uX3JlYWQgPSBmdG1fcXVhZGRlY19jb3VudF9mdW5jdGlv
bl9yZWFkLAo+ICsJLmFjdGlvbl9yZWFkID0gZnRtX3F1YWRkZWNfYWN0aW9uX3JlYWQsCj4gIH07
Cj4gIAo+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIGZ0bV9xdWFkZGVjX3NpZ25hbHNb
XSA9IHsKPiBAQCAtMjU1LDkgKzI0MiwxMiBAQCBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc3luYXBz
ZSBmdG1fcXVhZGRlY19jb3VudF9zeW5hcHNlc1tdID0gewo+ICAJfQo+ICB9Owo+ICAKPiAtc3Rh
dGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCBmdG1fcXVhZGRlY19jb3VudF9leHRb
XSA9IHsKPiAtCUNPVU5URVJfQ09VTlRfRU5VTSgicHJlc2NhbGVyIiwgJmZ0bV9xdWFkZGVjX3By
ZXNjYWxlcl9lbnVtKSwKPiAtCUNPVU5URVJfQ09VTlRfRU5VTV9BVkFJTEFCTEUoInByZXNjYWxl
ciIsICZmdG1fcXVhZGRlY19wcmVzY2FsZXJfZW51bSksCj4gK3N0YXRpYyBERUZJTkVfQ09VTlRF
Ul9FTlVNKGZ0bV9xdWFkZGVjX3ByZXNjYWxlcl9lbnVtLCBmdG1fcXVhZGRlY19wcmVzY2FsZXIp
Owo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgZnRtX3F1YWRkZWNfY291bnRfZXh0
W10gPSB7Cj4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfRU5VTSgicHJlc2NhbGVyIiwgZnRtX3F1YWRk
ZWNfZ2V0X3ByZXNjYWxlciwKPiArCQkJCWZ0bV9xdWFkZGVjX3NldF9wcmVzY2FsZXIsCj4gKwkJ
CQlmdG1fcXVhZGRlY19wcmVzY2FsZXJfZW51bSksCj4gIH07Cj4gIAo+ICBzdGF0aWMgc3RydWN0
IGNvdW50ZXJfY291bnQgZnRtX3F1YWRkZWNfY291bnRzID0gewo+IGRpZmYgLS1naXQgYS9kcml2
ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMKPiBp
bmRleCA4YTY4NDdkNWZiMmIuLjY5NmY2OGJjOTNiYyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Nv
dW50ZXIvaW50ZWwtcWVwLmMKPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMKPiBA
QCAtNjIsMTMgKzYyLDYgQEAKPiAgCj4gICNkZWZpbmUgSU5URUxfUUVQX0NMS19QRVJJT0RfTlMJ
CTEwCj4gIAo+IC0jZGVmaW5lIElOVEVMX1FFUF9DT1VOVEVSX0VYVF9SVyhfbmFtZSkJCQkJXAo+
IC17CQkJCQkJCQlcCj4gLQkubmFtZSA9ICNfbmFtZSwJCQkJCQlcCj4gLQkucmVhZCA9IF9uYW1l
IyNfcmVhZCwJCQkJCVwKPiAtCS53cml0ZSA9IF9uYW1lIyNfd3JpdGUsCQkJCQlcCj4gLX0KPiAt
Cj4gIHN0cnVjdCBpbnRlbF9xZXAgewo+ICAJc3RydWN0IGNvdW50ZXJfZGV2aWNlIGNvdW50ZXI7
Cj4gIAlzdHJ1Y3QgbXV0ZXggbG9jazsKPiBAQCAtMTE0LDggKzEwNyw3IEBAIHN0YXRpYyB2b2lk
IGludGVsX3FlcF9pbml0KHN0cnVjdCBpbnRlbF9xZXAgKnFlcCkKPiAgfQo+ICAKPiAgc3RhdGlj
IGludCBpbnRlbF9xZXBfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gLQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQl1bnNpZ25lZCBsb25n
ICp2YWwpCj4gKwkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsKQo+ICB7
Cj4gIAlzdHJ1Y3QgaW50ZWxfcWVwICpjb25zdCBxZXAgPSBjb3VudGVyLT5wcml2Owo+ICAKPiBA
QCAtMTMwLDExICsxMjIsMTEgQEAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiBp
bnRlbF9xZXBfY291bnRfZnVuY3Rpb25zW10gPSB7Cj4gIAlDT1VOVEVSX0ZVTkNUSU9OX1FVQURS
QVRVUkVfWDQsCj4gIH07Cj4gIAo+IC1zdGF0aWMgaW50IGludGVsX3FlcF9mdW5jdGlvbl9nZXQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCj4gLQkJCQkgIHNpemVfdCAqZnVuY3Rpb24pCj4gK3N0YXRpYyBpbnQgaW50
ZWxfcWVwX2Z1bmN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJ
CQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJICAgZW51bSBjb3VudGVy
X2Z1bmN0aW9uICpmdW5jdGlvbikKPiAgewo+IC0JKmZ1bmN0aW9uID0gMDsKPiArCSpmdW5jdGlv
biA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDsKPiAgCj4gIAlyZXR1cm4gMDsKPiAg
fQo+IEBAIC0xNDMsMTkgKzEzNSwxOSBAQCBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX3N5bmFw
c2VfYWN0aW9uIGludGVsX3FlcF9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAgCUNPVU5URVJfU1lO
QVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiAgfTsKPiAgCj4gLXN0YXRpYyBpbnQgaW50ZWxfcWVw
X2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3lu
YXBzZSwKPiAtCQkJCXNpemVfdCAqYWN0aW9uKQo+ICtzdGF0aWMgaW50IGludGVsX3FlcF9hY3Rp
b25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFw
c2UsCj4gKwkJCQkgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb24pCj4gIHsKPiAt
CSphY3Rpb24gPSAwOwo+ICsJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUzsKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50
ZXJfb3BzIGludGVsX3FlcF9jb3VudGVyX29wcyA9IHsKPiAgCS5jb3VudF9yZWFkID0gaW50ZWxf
cWVwX2NvdW50X3JlYWQsCj4gLQkuZnVuY3Rpb25fZ2V0ID0gaW50ZWxfcWVwX2Z1bmN0aW9uX2dl
dCwKPiAtCS5hY3Rpb25fZ2V0ID0gaW50ZWxfcWVwX2FjdGlvbl9nZXQsCj4gKwkuZnVuY3Rpb25f
cmVhZCA9IGludGVsX3FlcF9mdW5jdGlvbl9yZWFkLAo+ICsJLmFjdGlvbl9yZWFkID0gaW50ZWxf
cWVwX2FjdGlvbl9yZWFkLAo+ICB9Owo+ICAKPiAgI2RlZmluZSBJTlRFTF9RRVBfU0lHTkFMKF9p
ZCwgX25hbWUpIHsJCQkJXAo+IEBAIC0xODEsMzEgKzE3MywyNyBAQCBzdGF0aWMgc3RydWN0IGNv
dW50ZXJfc3luYXBzZSBpbnRlbF9xZXBfY291bnRfc3luYXBzZXNbXSA9IHsKPiAgCUlOVEVMX1FF
UF9TWU5BUFNFKDIpLAo+ICB9Owo+ICAKPiAtc3RhdGljIHNzaXplX3QgY2VpbGluZ19yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiAtCQkJICAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGlu
dCBpbnRlbF9xZXBfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKmNlaWxpbmcpCj4gIHsK
PiAgCXN0cnVjdCBpbnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7Cj4gLQl1MzIgcmVnOwo+
ICAKPiAgCXBtX3J1bnRpbWVfZ2V0X3N5bmMocWVwLT5kZXYpOwo+IC0JcmVnID0gaW50ZWxfcWVw
X3JlYWRsKHFlcCwgSU5URUxfUUVQTUFYKTsKPiArCSpjZWlsaW5nID0gaW50ZWxfcWVwX3JlYWRs
KHFlcCwgSU5URUxfUUVQTUFYKTsKPiAgCXBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsKPiAgCj4g
LQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIldVxuIiwgcmVnKTsKPiArCXJldHVybiAwOwo+ICB9
Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBjZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiAtCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJ
CSAgICAgdm9pZCAqcHJpdiwgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtzdGF0aWMg
aW50IGludGVsX3FlcF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiArCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IG1heCkKPiAgewo+
ICAJc3RydWN0IGludGVsX3FlcCAqcWVwID0gY291bnRlci0+cHJpdjsKPiAtCXUzMiBtYXg7Cj4g
LQlpbnQgcmV0Owo+ICsJaW50IHJldCA9IDA7Cj4gIAo+IC0JcmV0ID0ga3N0cnRvdTMyKGJ1Ziwg
MCwgJm1heCk7Cj4gLQlpZiAocmV0IDwgMCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJLyogSW50ZWwg
UUVQIGNlaWxpbmcgY29uZmlndXJhdGlvbiBvbmx5IHN1cHBvcnRzIDMyLWJpdCB2YWx1ZXMgKi8K
PiArCWlmIChtYXggIT0gKHUzMiltYXgpCj4gKwkJcmV0dXJuIC1FUkFOR0U7Cj4gIAo+ICAJbXV0
ZXhfbG9jaygmcWVwLT5sb2NrKTsKPiAgCWlmIChxZXAtPmVuYWJsZWQpIHsKPiBAQCAtMjE2LDM0
ICsyMDQsMjggQEAgc3RhdGljIHNzaXplX3QgY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gIAlwbV9ydW50aW1lX2dldF9zeW5jKHFlcC0+ZGV2KTsKPiAgCWlu
dGVsX3FlcF93cml0ZWwocWVwLCBJTlRFTF9RRVBNQVgsIG1heCk7Cj4gIAlwbV9ydW50aW1lX3B1
dChxZXAtPmRldik7Cj4gLQlyZXQgPSBsZW47Cj4gIAo+ICBvdXQ6Cj4gIAltdXRleF91bmxvY2so
JnFlcC0+bG9jayk7Cj4gIAlyZXR1cm4gcmV0Owo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBl
bmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+
ICtzdGF0aWMgaW50IGludGVsX3FlcF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gKwkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCAqZW5hYmxl
KQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owo+ICAKPiAt
CXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiV1XG4iLCBxZXAtPmVuYWJsZWQpOwo+ICsJKmVuYWJs
ZSA9IHFlcC0+ZW5hYmxlZDsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNz
aXplX3QgZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJ
ICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJICAgIHZvaWQgKnByaXYsIGNv
bnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGljIGludCBpbnRlbF9xZXBfZW5hYmxl
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1OCB2YWwpCj4gIHsKPiAgCXN0cnVjdCBpbnRlbF9xZXAgKnFl
cCA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgcmVnOwo+IC0JYm9vbCB2YWwsIGNoYW5nZWQ7Cj4g
LQlpbnQgcmV0Owo+IC0KPiAtCXJldCA9IGtzdHJ0b2Jvb2woYnVmLCAmdmFsKTsKPiAtCWlmIChy
ZXQpCj4gLQkJcmV0dXJuIHJldDsKPiArCWJvb2wgY2hhbmdlZDsKPiAgCj4gIAltdXRleF9sb2Nr
KCZxZXAtPmxvY2spOwo+ICAJY2hhbmdlZCA9IHZhbCBeIHFlcC0+ZW5hYmxlZDsKPiBAQCAtMjY3
LDEyICsyNDksMTIgQEAgc3RhdGljIHNzaXplX3QgZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAgCj4gIG91dDoKPiAgCW11dGV4X3VubG9jaygmcWVwLT5sb2Nr
KTsKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXpl
X3Qgc3Bpa2VfZmlsdGVyX25zX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
IC0JCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAgICB2b2lkICpw
cml2LCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc19y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQkgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQkgIHU2NCAqbGVuZ3RoKQo+ICB7Cj4gIAlzdHJ1Y3Qg
aW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIHJlZzsKPiBAQCAtMjgxLDI2
ICsyNjMsMjQgQEAgc3RhdGljIHNzaXplX3Qgc3Bpa2VfZmlsdGVyX25zX3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJcmVnID0gaW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5U
RUxfUUVQQ09OKTsKPiAgCWlmICghKHJlZyAmIElOVEVMX1FFUENPTl9GTFRfRU4pKSB7Cj4gIAkJ
cG1fcnVudGltZV9wdXQocWVwLT5kZXYpOwo+IC0JCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIjBc
biIpOwo+ICsJCXJldHVybiAwOwo+ICAJfQo+ICAJcmVnID0gSU5URUxfUUVQRkxUX01BWF9DT1VO
VChpbnRlbF9xZXBfcmVhZGwocWVwLCBJTlRFTF9RRVBGTFQpKTsKPiAgCXBtX3J1bnRpbWVfcHV0
KHFlcC0+ZGV2KTsKPiAgCj4gLQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIldVxuIiwgKHJlZyAr
IDIpICogSU5URUxfUUVQX0NMS19QRVJJT0RfTlMpOwo+ICsJKmxlbmd0aCA9IChyZWcgKyAyKSAq
IElOVEVMX1FFUF9DTEtfUEVSSU9EX05TOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1z
dGF0aWMgc3NpemVfdCBzcGlrZV9maWx0ZXJfbnNfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+IC0JCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJ
CQkgICAgIHZvaWQgKnByaXYsIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGlj
IGludCBpbnRlbF9xZXBfc3Bpa2VfZmlsdGVyX25zX3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiArCQkJCQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJ
CQkJICAgdTY0IGxlbmd0aCkKPiAgewo+ICAJc3RydWN0IGludGVsX3FlcCAqcWVwID0gY291bnRl
ci0+cHJpdjsKPiAtCXUzMiByZWcsIGxlbmd0aDsKPiArCXUzMiByZWc7Cj4gIAlib29sIGVuYWJs
ZTsKPiAtCWludCByZXQ7Cj4gLQo+IC0JcmV0ID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJmxlbmd0aCk7
Cj4gLQlpZiAocmV0IDwgMCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJaW50IHJldCA9IDA7Cj4gIAo+
ICAJLyoKPiAgCSAqIFNwaWtlIGZpbHRlciBsZW5ndGggaXMgKE1BWF9DT1VOVCArIDIpIGNsb2Nr
IHBlcmlvZHMuCj4gQEAgLTMzNiwxNiArMzE2LDE1IEBAIHN0YXRpYyBzc2l6ZV90IHNwaWtlX2Zp
bHRlcl9uc193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlpbnRlbF9x
ZXBfd3JpdGVsKHFlcCwgSU5URUxfUUVQRkxULCBsZW5ndGgpOwo+ICAJaW50ZWxfcWVwX3dyaXRl
bChxZXAsIElOVEVMX1FFUENPTiwgcmVnKTsKPiAgCXBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsK
PiAtCXJldCA9IGxlbjsKPiAgCj4gIG91dDoKPiAgCW11dGV4X3VubG9jaygmcWVwLT5sb2NrKTsK
PiAgCXJldHVybiByZXQ7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+ICtzdGF0
aWMgaW50IGludGVsX3FlcF9wcmVzZXRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICsJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQl1
OCAqcHJlc2V0X2VuYWJsZSkKPiAgewo+ICAJc3RydWN0IGludGVsX3FlcCAqcWVwID0gY291bnRl
ci0+cHJpdjsKPiAgCXUzMiByZWc7Cj4gQEAgLTM1MywyMSArMzMyLDE4IEBAIHN0YXRpYyBzc2l6
ZV90IHByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
IAlwbV9ydW50aW1lX2dldF9zeW5jKHFlcC0+ZGV2KTsKPiAgCXJlZyA9IGludGVsX3FlcF9yZWFk
bChxZXAsIElOVEVMX1FFUENPTik7Cj4gIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7Cj4gLQly
ZXR1cm4gc3lzZnNfZW1pdChidWYsICIldVxuIiwgIShyZWcgJiBJTlRFTF9RRVBDT05fQ09VTlRf
UlNUX01PREUpKTsKPiArCj4gKwkqcHJlc2V0X2VuYWJsZSA9ICEocmVnICYgSU5URUxfUUVQQ09O
X0NPVU5UX1JTVF9NT0RFKTsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNz
aXplX3QgcHJlc2V0X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gLQkJCQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICB2b2lkICpw
cml2LCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQgaW50ZWxfcWVw
X3ByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJ
CQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IHZhbCkKPiAgewo+ICAJc3RydWN0
IGludGVsX3FlcCAqcWVwID0gY291bnRlci0+cHJpdjsKPiAgCXUzMiByZWc7Cj4gLQlib29sIHZh
bDsKPiAtCWludCByZXQ7Cj4gLQo+IC0JcmV0ID0ga3N0cnRvYm9vbChidWYsICZ2YWwpOwo+IC0J
aWYgKHJldCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJaW50IHJldCA9IDA7Cj4gIAo+ICAJbXV0ZXhf
bG9jaygmcWVwLT5sb2NrKTsKPiAgCWlmIChxZXAtPmVuYWJsZWQpIHsKPiBAQCAtMzg0LDcgKzM2
MCw2IEBAIHN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICAKPiAgCWludGVsX3FlcF93cml0ZWwocWVwLCBJTlRFTF9RRVBD
T04sIHJlZyk7Cj4gIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7Cj4gLQlyZXQgPSBsZW47Cj4g
IAo+ICBvdXQ6Cj4gIAltdXRleF91bmxvY2soJnFlcC0+bG9jayk7Cj4gQEAgLTM5MiwxMSArMzY3
LDE0IEBAIHN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJuIHJldDsKPiAgfQo+ICAKPiAtc3RhdGljIGNvbnN0
IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCBpbnRlbF9xZXBfY291bnRfZXh0W10gPSB7Cj4gLQlJ
TlRFTF9RRVBfQ09VTlRFUl9FWFRfUlcoY2VpbGluZyksCj4gLQlJTlRFTF9RRVBfQ09VTlRFUl9F
WFRfUlcoZW5hYmxlKSwKPiAtCUlOVEVMX1FFUF9DT1VOVEVSX0VYVF9SVyhzcGlrZV9maWx0ZXJf
bnMpLAo+IC0JSU5URUxfUUVQX0NPVU5URVJfRVhUX1JXKHByZXNldF9lbmFibGUpCj4gK3N0YXRp
YyBzdHJ1Y3QgY291bnRlcl9jb21wIGludGVsX3FlcF9jb3VudF9leHRbXSA9IHsKPiArCUNPVU5U
RVJfQ09NUF9FTkFCTEUoaW50ZWxfcWVwX2VuYWJsZV9yZWFkLCBpbnRlbF9xZXBfZW5hYmxlX3dy
aXRlKSwKPiArCUNPVU5URVJfQ09NUF9DRUlMSU5HKGludGVsX3FlcF9jZWlsaW5nX3JlYWQsIGlu
dGVsX3FlcF9jZWlsaW5nX3dyaXRlKSwKPiArCUNPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKGlu
dGVsX3FlcF9wcmVzZXRfZW5hYmxlX3JlYWQsCj4gKwkJCQkgICBpbnRlbF9xZXBfcHJlc2V0X2Vu
YWJsZV93cml0ZSksCj4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfVTY0KCJzcGlrZV9maWx0ZXJfbnMi
LAo+ICsJCQkgICAgICAgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc19yZWFkLAo+ICsJCQkgICAg
ICAgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc193cml0ZSksCj4gIH07Cj4gIAo+ICBzdGF0aWMg
c3RydWN0IGNvdW50ZXJfY291bnQgaW50ZWxfcWVwX2NvdW50ZXJfY291bnRbXSA9IHsKPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL2ludGVycnVwdC1jbnQuYyBiL2RyaXZlcnMvY291bnRl
ci9pbnRlcnJ1cHQtY250LmMKPiBpbmRleCAxZGU0MjQzZGI0ODguLjg1MTRhODdmY2JlZSAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5jCj4gKysrIGIvZHJpdmVy
cy9jb3VudGVyL2ludGVycnVwdC1jbnQuYwo+IEBAIC0xMCw2ICsxMCw3IEBACj4gICNpbmNsdWRl
IDxsaW51eC9tb2RfZGV2aWNldGFibGUuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgo+
ICAjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC90
eXBlcy5oPgo+ICAKPiAgI2RlZmluZSBJTlRFUlJVUFRfQ05UX05BTUUgImludGVycnVwdC1jbnQi
Cj4gIAo+IEBAIC0zMywzMCArMzQsMjMgQEAgc3RhdGljIGlycXJldHVybl90IGludGVycnVwdF9j
bnRfaXNyKGludCBpcnEsIHZvaWQgKmRldl9pZCkKPiAgCXJldHVybiBJUlFfSEFORExFRDsKPiAg
fQo+ICAKPiAtc3RhdGljIHNzaXplX3QgaW50ZXJydXB0X2NudF9lbmFibGVfcmVhZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpj
b3VudCwKPiAtCQkJCQkgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IGlu
dGVycnVwdF9jbnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICsJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4ICplbmFibGUpCj4gIHsK
PiAgCXN0cnVjdCBpbnRlcnJ1cHRfY250X3ByaXYgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAK
PiAtCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVkXG4iLCBwcml2LT5lbmFibGVkKTsKPiArCSpl
bmFibGUgPSBwcml2LT5lbmFibGVkOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0
aWMgc3NpemVfdCBpbnRlcnJ1cHRfY250X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gLQkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJ
CQkJICB2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsCj4gLQkJCQkJICBzaXplX3QgbGVu
KQo+ICtzdGF0aWMgaW50IGludGVycnVwdF9jbnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgdTggZW5hYmxlKQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZXJydXB0X2NudF9wcml2ICpwcml2ID0g
Y291bnRlci0+cHJpdjsKPiAtCWJvb2wgZW5hYmxlOwo+IC0Jc3NpemVfdCByZXQ7Cj4gLQo+IC0J
cmV0ID0ga3N0cnRvYm9vbChidWYsICZlbmFibGUpOwo+IC0JaWYgKHJldCkKPiAtCQlyZXR1cm4g
cmV0Owo+ICAKPiAgCWlmIChwcml2LT5lbmFibGVkID09IGVuYWJsZSkKPiAtCQlyZXR1cm4gbGVu
Owo+ICsJCXJldHVybiAwOwo+ICAKPiAgCWlmIChlbmFibGUpIHsKPiAgCQlwcml2LT5lbmFibGVk
ID0gdHJ1ZTsKPiBAQCAtNjYsMzMgKzYwLDMwIEBAIHN0YXRpYyBzc2l6ZV90IGludGVycnVwdF9j
bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCQlwcml2
LT5lbmFibGVkID0gZmFsc2U7Cj4gIAl9Cj4gIAo+IC0JcmV0dXJuIGxlbjsKPiArCXJldHVybiAw
Owo+ICB9Cj4gIAo+IC1zdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0IGludGVy
cnVwdF9jbnRfZXh0W10gPSB7Cj4gLQl7Cj4gLQkJLm5hbWUgPSAiZW5hYmxlIiwKPiAtCQkucmVh
ZCA9IGludGVycnVwdF9jbnRfZW5hYmxlX3JlYWQsCj4gLQkJLndyaXRlID0gaW50ZXJydXB0X2Nu
dF9lbmFibGVfd3JpdGUsCj4gLQl9LAo+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBpbnRl
cnJ1cHRfY250X2V4dFtdID0gewo+ICsJQ09VTlRFUl9DT01QX0VOQUJMRShpbnRlcnJ1cHRfY250
X2VuYWJsZV9yZWFkLAo+ICsJCQkgICAgaW50ZXJydXB0X2NudF9lbmFibGVfd3JpdGUpLAo+ICB9
Owo+ICAKPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBpbnRlcnJ1
cHRfY250X3N5bmFwc2VfYWN0aW9uc1tdID0gewo+ICAJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9S
SVNJTkdfRURHRSwKPiAgfTsKPiAgCj4gLXN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9hY3Rpb25f
Z2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3lu
YXBzZSwKPiAtCQkJCSAgICBzaXplX3QgKmFjdGlvbikKPiArc3RhdGljIGludCBpbnRlcnJ1cHRf
Y250X2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJICAgICBzdHJ1Y3QgY291bnRl
cl9zeW5hcHNlICpzeW5hcHNlLAo+ICsJCQkJICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rp
b24gKmFjdGlvbikKPiAgewo+IC0JKmFjdGlvbiA9IDA7Cj4gKwkqYWN0aW9uID0gQ09VTlRFUl9T
WU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiAgCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAg
c3RhdGljIGludCBpbnRlcnJ1cHRfY250X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+IC0JCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHVuc2lnbmVkIGxv
bmcgKnZhbCkKPiArCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZh
bCkKPiAgewo+ICAJc3RydWN0IGludGVycnVwdF9jbnRfcHJpdiAqcHJpdiA9IGNvdW50ZXItPnBy
aXY7Cj4gIAo+IEBAIC0xMDIsOCArOTMsNyBAQCBzdGF0aWMgaW50IGludGVycnVwdF9jbnRfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQg
aW50ZXJydXB0X2NudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJ
CSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCSAgICAgICBjb25zdCB1
bnNpZ25lZCBsb25nIHZhbCkKPiArCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgY29uc3QgdTY0IHZhbCkKPiAgewo+ICAJc3RydWN0IGludGVycnVwdF9jbnRfcHJpdiAqcHJp
diA9IGNvdW50ZXItPnByaXY7Cj4gIAo+IEBAIC0xMTksMTEgKzEwOSwxMSBAQCBzdGF0aWMgY29u
c3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGludGVycnVwdF9jbnRfZnVuY3Rpb25zW10gPSB7Cj4g
IAlDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+ICB9Owo+ICAKPiAtc3RhdGljIGludCBpbnRl
cnJ1cHRfY250X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
LQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgICBzaXpl
X3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IGludGVycnVwdF9jbnRfZnVuY3Rpb25fcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVu
Y3Rpb24pCj4gIHsKPiAtCSpmdW5jdGlvbiA9IDA7Cj4gKwkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZV
TkNUSU9OX0lOQ1JFQVNFOwo+ICAKPiAgCXJldHVybiAwOwo+ICB9Cj4gQEAgLTE0OCwxMCArMTM4
LDEwIEBAIHN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9zaWduYWxfcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRl
cl9vcHMgaW50ZXJydXB0X2NudF9vcHMgPSB7Cj4gLQkuYWN0aW9uX2dldCA9IGludGVycnVwdF9j
bnRfYWN0aW9uX2dldCwKPiArCS5hY3Rpb25fcmVhZCA9IGludGVycnVwdF9jbnRfYWN0aW9uX3Jl
YWQsCj4gIAkuY291bnRfcmVhZCA9IGludGVycnVwdF9jbnRfcmVhZCwKPiAgCS5jb3VudF93cml0
ZSA9IGludGVycnVwdF9jbnRfd3JpdGUsCj4gLQkuZnVuY3Rpb25fZ2V0ID0gaW50ZXJydXB0X2Nu
dF9mdW5jdGlvbl9nZXQsCj4gKwkuZnVuY3Rpb25fcmVhZCA9IGludGVycnVwdF9jbnRfZnVuY3Rp
b25fcmVhZCwKPiAgCS5zaWduYWxfcmVhZCAgPSBpbnRlcnJ1cHRfY250X3NpZ25hbF9yZWFkLAo+
ICB9Owo+ICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2Fw
dHVyZS5jIGIvZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2FwdHVyZS5jCj4gaW5kZXgg
NGM1N2Q0M2U3ZDY2Li43OWUwYzg0YTNiODEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jb3VudGVy
L21pY3JvY2hpcC10Y2ItY2FwdHVyZS5jCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL21pY3JvY2hp
cC10Y2ItY2FwdHVyZS5jCj4gQEAgLTMyLDI4ICszMiwxNiBAQCBzdHJ1Y3QgbWNocF90Y19kYXRh
IHsKPiAgCWJvb2wgdHJpZ19pbnZlcnRlZDsKPiAgfTsKPiAgCj4gLWVudW0gbWNocF90Y19jb3Vu
dF9mdW5jdGlvbiB7Cj4gLQlNQ0hQX1RDX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0JTUNIUF9UQ19G
VU5DVElPTl9RVUFEUkFUVVJFLAo+IC19Owo+IC0KPiAtc3RhdGljIGNvbnN0IGVudW0gY291bnRl
cl9jb3VudF9mdW5jdGlvbiBtY2hwX3RjX2NvdW50X2Z1bmN0aW9uc1tdID0gewo+IC0JW01DSFBf
VENfRlVOQ1RJT05fSU5DUkVBU0VdID0gQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKPiAtCVtN
Q0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRVUkVdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJF
X1g0LAo+IC19Owo+IC0KPiAtZW51bSBtY2hwX3RjX3N5bmFwc2VfYWN0aW9uIHsKPiAtCU1DSFBf
VENfU1lOQVBTRV9BQ1RJT05fTk9ORSA9IDAsCj4gLQlNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX1JJ
U0lOR19FREdFLAo+IC0JTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gLQlN
Q0hQX1RDX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRQo+ICtzdGF0aWMgY29uc3QgZW51bSBjb3Vu
dGVyX2Z1bmN0aW9uIG1jaHBfdGNfY291bnRfZnVuY3Rpb25zW10gPSB7Cj4gKwlDT1VOVEVSX0ZV
TkNUSU9OX0lOQ1JFQVNFLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0LAo+ICB9
Owo+ICAKPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBtY2hwX3Rj
X3N5bmFwc2VfYWN0aW9uc1tdID0gewo+IC0JW01DSFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORV0g
PSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gLQlbTUNIUF9UQ19TWU5BUFNFX0FDVElP
Tl9SSVNJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+IC0J
W01DSFBfVENfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFXSA9IENPVU5URVJfU1lOQVBTRV9B
Q1RJT05fRkFMTElOR19FREdFLAo+IC0JW01DSFBfVENfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdF
XSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiArCUNPVU5URVJfU1lOQVBT
RV9BQ1RJT05fTk9ORSwKPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4g
KwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiArCUNPVU5URVJfU1lOQVBT
RV9BQ1RJT05fQk9USF9FREdFUywKPiAgfTsKPiAgCj4gIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9z
aWduYWwgbWNocF90Y19jb3VudF9zaWduYWxzW10gPSB7Cj4gQEAgLTgwLDIzICs2OCwyMyBAQCBz
dGF0aWMgc3RydWN0IGNvdW50ZXJfc3luYXBzZSBtY2hwX3RjX2NvdW50X3N5bmFwc2VzW10gPSB7
Cj4gIAl9Cj4gIH07Cj4gIAo+IC1zdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fZ2V0
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAgICAgIHNpemVfdCAqZnVuY3Rpb24pCj4gK3N0YXRp
YyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiArCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJ
CQkgICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKPiAgewo+ICAJc3RydWN0
IG1jaHBfdGNfZGF0YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAo+ICAJaWYgKHBy
aXYtPnFkZWNfbW9kZSkKPiAtCQkqZnVuY3Rpb24gPSBNQ0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRV
UkU7Cj4gKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Owo+ICAJ
ZWxzZQo+IC0JCSpmdW5jdGlvbiA9IE1DSFBfVENfRlVOQ1RJT05fSU5DUkVBU0U7Cj4gKwkJKmZ1
bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRTsKPiAgCj4gIAlyZXR1cm4gMDsKPiAg
fQo+ICAKPiAtc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsCj4gLQkJCQkgICAgICBzaXplX3QgZnVuY3Rpb24pCj4gK3N0YXRpYyBpbnQgbWNocF90
Y19jb3VudF9mdW5jdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
KwkJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJCWVudW0gY291bnRlcl9m
dW5jdGlvbiBmdW5jdGlvbikKPiAgewo+ICAJc3RydWN0IG1jaHBfdGNfZGF0YSAqY29uc3QgcHJp
diA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgYm1yLCBjbXI7Cj4gQEAgLTEwOCw3ICs5Niw3IEBA
IHN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ICAJY21yICY9IH5BVE1FTF9UQ19XQVZFOwo+ICAKPiAgCXN3aXRjaCAo
ZnVuY3Rpb24pIHsKPiAtCWNhc2UgTUNIUF9UQ19GVU5DVElPTl9JTkNSRUFTRToKPiArCWNhc2Ug
Q09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKPiAgCQlwcml2LT5xZGVjX21vZGUgPSAwOwo+ICAJ
CS8qIFNldCBoaWdoZXN0IHJhdGUgYmFzZWQgb24gd2hldGhlciBzb2MgaGFzIGdjbGsgb3Igbm90
ICovCj4gIAkJYm1yICY9IH4oQVRNRUxfVENfUURFTiB8IEFUTUVMX1RDX1BPU0VOKTsKPiBAQCAt
MTIwLDcgKzEwOCw3IEBAIHN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9zZXQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJCWNtciB8PSAgQVRNRUxfVENfQ01SX01B
U0s7Cj4gIAkJY21yICY9IH4oQVRNRUxfVENfQUJFVFJHIHwgQVRNRUxfVENfWEMwKTsKPiAgCQli
cmVhazsKPiAtCWNhc2UgTUNIUF9UQ19GVU5DVElPTl9RVUFEUkFUVVJFOgo+ICsJY2FzZSBDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gIAkJaWYgKCFwcml2LT50Y19jZmctPmhhc19x
ZGVjKQo+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPiAgCQkvKiBJbiBRREVDIG1vZGUgc2V0dGluZ3Mg
Ym90aCBjaGFubmVscyAwIGFuZCAxIGFyZSByZXF1aXJlZCAqLwo+IEBAIC0xNzYsMTAgKzE2NCwx
MCBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfc2lnbmFsX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgbWNo
cF90Y19jb3VudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAt
CQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgc3RydWN0IGNv
dW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtCQkJCSAgICBzaXplX3QgKmFjdGlvbikKPiArc3Rh
dGljIGludCBtY2hwX3RjX2NvdW50X2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiArCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJ
ICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ICsJCQkJICAgICBlbnVtIGNv
dW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+ICAJc3RydWN0IG1jaHBfdGNfZGF0
YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgY21yOwo+IEBAIC0xODgsMjYg
KzE3NiwyNiBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfYWN0aW9uX2dldChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAo+ICAJc3dpdGNoIChjbXIgJiBBVE1FTF9UQ19FVFJH
RURHKSB7Cj4gIAlkZWZhdWx0Ogo+IC0JCSphY3Rpb24gPSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9O
X05PTkU7Cj4gKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiAgCQli
cmVhazsKPiAgCWNhc2UgQVRNRUxfVENfRVRSR0VER19SSVNJTkc6Cj4gLQkJKmFjdGlvbiA9IE1D
SFBfVENfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gKwkJKmFjdGlvbiA9IENPVU5URVJf
U1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gIAkJYnJlYWs7Cj4gIAljYXNlIEFUTUVMX1RD
X0VUUkdFREdfRkFMTElORzoKPiAtCQkqYWN0aW9uID0gTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9G
QUxMSU5HX0VER0U7Cj4gKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fRkFMTElO
R19FREdFOwo+ICAJCWJyZWFrOwo+ICAJY2FzZSBBVE1FTF9UQ19FVFJHRURHX0JPVEg6Cj4gLQkJ
KmFjdGlvbiA9IE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFOwo+ICsJCSphY3Rpb24g
PSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gIAkJYnJlYWs7Cj4gIAl9Cj4g
IAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9hY3Rp
b25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAq
c3luYXBzZSwKPiAtCQkJCSAgICBzaXplX3QgYWN0aW9uKQo+ICtzdGF0aWMgaW50IG1jaHBfdGNf
Y291bnRfYWN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJ
CSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCSAgICAgIHN0cnVjdCBj
b3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gKwkJCQkgICAgICBlbnVtIGNvdW50ZXJfc3luYXBz
ZV9hY3Rpb24gYWN0aW9uKQo+ICB7Cj4gIAlzdHJ1Y3QgbWNocF90Y19kYXRhICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKPiAgCXUzMiBlZGdlID0gQVRNRUxfVENfRVRSR0VER19OT05FOwo+
IEBAIC0yMTcsMTYgKzIwNSwxNiBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfYWN0aW9uX3Nl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4g
IAo+ICAJc3dpdGNoIChhY3Rpb24pIHsKPiAtCWNhc2UgTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9O
T05FOgo+ICsJY2FzZSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU6Cj4gIAkJZWRnZSA9IEFU
TUVMX1RDX0VUUkdFREdfTk9ORTsKPiAgCQlicmVhazsKPiAtCWNhc2UgTUNIUF9UQ19TWU5BUFNF
X0FDVElPTl9SSVNJTkdfRURHRToKPiArCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJ
TkdfRURHRToKPiAgCQllZGdlID0gQVRNRUxfVENfRVRSR0VER19SSVNJTkc7Cj4gIAkJYnJlYWs7
Cj4gLQljYXNlIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOgo+ICsJY2FzZSBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRToKPiAgCQllZGdlID0gQVRNRUxfVENf
RVRSR0VER19GQUxMSU5HOwo+ICAJCWJyZWFrOwo+IC0JY2FzZSBNQ0hQX1RDX1NZTkFQU0VfQUNU
SU9OX0JPVEhfRURHRToKPiArCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VT
Ogo+ICAJCWVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX0JPVEg7Cj4gIAkJYnJlYWs7Cj4gIAlkZWZh
dWx0Ogo+IEBAIC0yNDAsOCArMjI4LDcgQEAgc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2FjdGlv
bl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4gIAo+ICBzdGF0aWMg
aW50IG1jaHBfdGNfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
LQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJICAgICAgdW5zaWdu
ZWQgbG9uZyAqdmFsKQo+ICsJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2
NCAqdmFsKQo+ICB7Cj4gIAlzdHJ1Y3QgbWNocF90Y19kYXRhICpjb25zdCBwcml2ID0gY291bnRl
ci0+cHJpdjsKPiAgCXUzMiBjbnQ7Cj4gQEAgLTI2NCwxMiArMjUxLDEyIEBAIHN0YXRpYyBzdHJ1
Y3QgY291bnRlcl9jb3VudCBtY2hwX3RjX2NvdW50c1tdID0gewo+ICB9Owo+ICAKPiAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyBtY2hwX3RjX29wcyA9IHsKPiAtCS5zaWduYWxfcmVh
ZCAgPSBtY2hwX3RjX2NvdW50X3NpZ25hbF9yZWFkLAo+IC0JLmNvdW50X3JlYWQgICA9IG1jaHBf
dGNfY291bnRfcmVhZCwKPiAtCS5mdW5jdGlvbl9nZXQgPSBtY2hwX3RjX2NvdW50X2Z1bmN0aW9u
X2dldCwKPiAtCS5mdW5jdGlvbl9zZXQgPSBtY2hwX3RjX2NvdW50X2Z1bmN0aW9uX3NldCwKPiAt
CS5hY3Rpb25fZ2V0ICAgPSBtY2hwX3RjX2NvdW50X2FjdGlvbl9nZXQsCj4gLQkuYWN0aW9uX3Nl
dCAgID0gbWNocF90Y19jb3VudF9hY3Rpb25fc2V0Cj4gKwkuc2lnbmFsX3JlYWQgICAgPSBtY2hw
X3RjX2NvdW50X3NpZ25hbF9yZWFkLAo+ICsJLmNvdW50X3JlYWQgICAgID0gbWNocF90Y19jb3Vu
dF9yZWFkLAo+ICsJLmZ1bmN0aW9uX3JlYWQgID0gbWNocF90Y19jb3VudF9mdW5jdGlvbl9yZWFk
LAo+ICsJLmZ1bmN0aW9uX3dyaXRlID0gbWNocF90Y19jb3VudF9mdW5jdGlvbl93cml0ZSwKPiAr
CS5hY3Rpb25fcmVhZCAgICA9IG1jaHBfdGNfY291bnRfYWN0aW9uX3JlYWQsCj4gKwkuYWN0aW9u
X3dyaXRlICAgPSBtY2hwX3RjX2NvdW50X2FjdGlvbl93cml0ZQo+ICB9Owo+ICAKPiAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBhdG1lbF90Y2JfY29uZmlnIHRjYl9ybTkyMDBfY29uZmlnID0gewo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYyBiL2RyaXZlcnMv
Y291bnRlci9zdG0zMi1scHRpbWVyLWNudC5jCj4gaW5kZXggMTM2NTY5NTdjNDVmLi5iZWRlODAy
NmI2YWIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmMK
PiArKysgYi9kcml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYwo+IEBAIC0xNyw2ICsx
Nyw3IEBACj4gICNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3Bp
bmN0cmwvY29uc3VtZXIuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgo+
ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KPiAgCj4gIHN0cnVjdCBzdG0zMl9scHRpbV9jbnQg
ewo+ICAJc3RydWN0IGNvdW50ZXJfZGV2aWNlIGNvdW50ZXI7Cj4gQEAgLTEzMCwzMiArMTMxLDQ2
IEBAIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fc2V0dXAoc3RydWN0IHN0bTMyX2xwdGltX2NudCAq
cHJpdiwgaW50IGVuYWJsZSkKPiAgICogKy0tLS0tLS0tLSstLS0tLS0tLS0tKy0tLS0tLS0tLS0r
LS0tLS0tLS0tKy0tLS0tLS0tLS0rLS0tLS0tLS0tKwo+ICAgKi8KPiAgZW51bSBzdG0zMl9scHRp
bV9jbnRfZnVuY3Rpb24gewo+IC0JU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRSwKPiAtCVNU
TTMyX0xQVElNX0VOQ09ERVJfQk9USF9FREdFLAo+ICsJU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNS
RUFTRSA9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCj4gKwlTVE0zMl9MUFRJTV9FTkNPREVS
X0JPVEhfRURHRSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiAgfTsKPiAgCj4g
IHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gc3RtMzJfbHB0aW1fY250X2Z1bmN0
aW9uc1tdID0gewo+IC0JW1NUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0VdID0gQ09VTlRFUl9G
VU5DVElPTl9JTkNSRUFTRSwKPiAtCVtTVE0zMl9MUFRJTV9FTkNPREVSX0JPVEhfRURHRV0gPSBD
T1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gKwlTVE0zMl9MUFRJTV9DT1VOVEVSX0lO
Q1JFQVNFLAo+ICsJU1RNMzJfTFBUSU1fRU5DT0RFUl9CT1RIX0VER0UsCj4gIH07Cj4gIAo+ICBl
bnVtIHN0bTMyX2xwdGltX3N5bmFwc2VfYWN0aW9uIHsKPiArCS8qIEluZGV4IG11c3QgbWF0Y2gg
d2l0aCBzdG0zMl9scHRpbV9jbnRfcG9sYXJpdHlbXSAocHJpdi0+cG9sYXJpdHkpICovCj4gIAlT
VE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiAgCVNUTTMyX0xQVElNX1NZ
TkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiAgCVNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9O
X0JPVEhfRURHRVMsCj4gIAlTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9OT05FLAo+ICB9Owo+
ICAKPiAtc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9scHRp
bV9jbnRfc3luYXBzZV9hY3Rpb25zW10gPSB7Cj4gLQkvKiBJbmRleCBtdXN0IG1hdGNoIHdpdGgg
c3RtMzJfbHB0aW1fY250X3BvbGFyaXR5W10gKHByaXYtPnBvbGFyaXR5KSAqLwo+ICtzdGF0aWMg
Y29uc3QgZW51bSBzdG0zMl9scHRpbV9zeW5hcHNlX2FjdGlvbiBzdG0zMl9scHRpbV9jMmxfYWN0
aW9uc19tYXBbXSA9IHsKPiArCVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9
IFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ICsJW0NPVU5URVJfU1lO
QVBTRV9BQ1RJT05fRkFMTElOR19FREdFXSA9IFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0ZB
TExJTkdfRURHRSwKPiArCVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVNdID0gU1RN
MzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiArCVtDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX05PTkVdID0gU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiArfTsKPiAr
Cj4gK3N0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gc3RtMzJfbHB0aW1f
bDJjX2FjdGlvbnNfbWFwW10gPSB7Cj4gIAlbU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fUklT
SU5HX0VER0VdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiAgCVtTVE0z
Ml9MUFRJTV9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0VdID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9GQUxMSU5HX0VER0UsCj4gIAlbU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFU10gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCj4gIAlbU1RNMzJfTFBU
SU1fU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4g
IH07Cj4gIAo+ICtzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIHN0bTMy
X2xwdGltX2NudF9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJ
T05fUklTSU5HX0VER0UsCj4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwK
PiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiArCUNPVU5URVJfU1lOQVBT
RV9BQ1RJT05fTk9ORSwKPiArfTsKPiArCj4gIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X3Jl
YWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nICp2YWwpCj4gKwkJCQlzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsIHU2NCAqdmFsKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpj
b25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCXUzMiBjbnQ7Cj4gQEAgLTE3MCw5ICsxODUs
OSBAQCBzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IHN0bTMyX2xw
dGltX2NudF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0J
CQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCQlzaXplX3QgKmZ1bmN0aW9u
KQo+ICtzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+ICsJCQkJCSBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKQo+ICB7Cj4gIAlzdHJ1
Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCj4gQEAg
LTE4OSwxNiArMjA0LDM3IEBAIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX2dl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1cm4gLUVJTlZBTDsKPiAg
fQo+ICAKPiAtc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gLQkJCQkJc2l6ZV90IGZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IHN0bTMyX2xwdGltX2Z1
bmNfbWFwKGVudW0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uICpjb25zdCBjbnRfZnVuYywKPiAr
CQkJCWNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbikKPiArewo+ICsJc3dpdGNo
IChmdW5jdGlvbikgewo+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOgo+ICsJCSpj
bnRfZnVuYyA9IFNUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0U7Cj4gKwkJcmV0dXJuIDA7Cj4g
KwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiArCQkqY250X2Z1bmMgPSBT
VE0zMl9MUFRJTV9FTkNPREVSX0JPVEhfRURHRTsKPiArCQlyZXR1cm4gMDsKPiArCWRlZmF1bHQ6
Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQgc3RtMzJf
bHB0aW1fY250X2Z1bmN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArCQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQkgIGVudW0gY291
bnRlcl9mdW5jdGlvbiBmdW5jdGlvbikKPiAgewo+ICAJc3RydWN0IHN0bTMyX2xwdGltX2NudCAq
Y29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gKwllbnVtIHN0bTMyX2xwdGltX2NudF9mdW5j
dGlvbiBjbnRfZnVuYzsKPiArCWludCBlcnI7Cj4gIAo+ICAJaWYgKHN0bTMyX2xwdGltX2lzX2Vu
YWJsZWQocHJpdikpCj4gIAkJcmV0dXJuIC1FQlVTWTsKPiAgCj4gLQlzd2l0Y2ggKGZ1bmN0aW9u
KSB7Cj4gKwllcnIgPSBzdG0zMl9scHRpbV9mdW5jX21hcCgmY250X2Z1bmMsIGZ1bmN0aW9uKTsK
PiArCWlmIChlcnIpCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwlzd2l0Y2ggKGNudF9mdW5jKSB7
Cj4gIAljYXNlIFNUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0U6Cj4gIAkJcHJpdi0+cXVhZHJh
dHVyZV9tb2RlID0gMDsKPiAgCQlyZXR1cm4gMDsKPiBAQCAtMjEyLDkgKzI0OCw5IEBAIHN0YXRp
YyBpbnQgc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gIAl9Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2Nu
dF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCSAgIHZvaWQgKnByaXZhdGUsIGNo
YXIgKmJ1ZikKPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3JlYWQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiArCQkJCSAgICAgICB1OCAqZW5hYmxlKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3Rt
MzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCWludCByZXQ7Cj4g
QEAgLTIyMywyMiArMjU5LDE4IEBAIHN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9lbmFi
bGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlpZiAocmV0IDwgMCkK
PiAgCQlyZXR1cm4gcmV0Owo+ICAKPiAtCXJldHVybiBzY25wcmludGYoYnVmLCBQQUdFX1NJWkUs
ICIldVxuIiwgcmV0KTsKPiArCSplbmFibGUgPSByZXQ7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gIH0K
PiAgCj4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gLQkJCQkJICAgIHZvaWQgKnByaXZhdGUsCj4gLQkJCQkJICAgIGNvbnN0IGNo
YXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfZW5hYmxl
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQlzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJdTggZW5hYmxlKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3Rt
MzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAtCWJvb2wgZW5hYmxl
Owo+ICAJaW50IHJldDsKPiAgCj4gLQlyZXQgPSBrc3RydG9ib29sKGJ1ZiwgJmVuYWJsZSk7Cj4g
LQlpZiAocmV0KQo+IC0JCXJldHVybiByZXQ7Cj4gLQo+ICAJLyogQ2hlY2sgbm9ib2R5IHVzZXMg
dGhlIHRpbWVyLCBvciBhbHJlYWR5IGRpc2FibGVkL2VuYWJsZWQgKi8KPiAgCXJldCA9IHN0bTMy
X2xwdGltX2lzX2VuYWJsZWQocHJpdik7Cj4gIAlpZiAoKHJldCA8IDApIHx8ICghcmV0ICYmICFl
bmFibGUpKQo+IEBAIC0yNTQsNzggKzI4Niw3MiBAQCBzdGF0aWMgc3NpemVfdCBzdG0zMl9scHRp
bV9jbnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCWlm
IChyZXQpCj4gIAkJcmV0dXJuIHJldDsKPiAgCj4gLQlyZXR1cm4gbGVuOwo+ICsJcmV0dXJuIDA7
Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3JlYWQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgICBzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCj4gLQkJCQkJICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiAr
c3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJ
CQkJdTY0ICpjZWlsaW5nKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBw
cml2ID0gY291bnRlci0+cHJpdjsKPiAgCj4gLQlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJ
WkUsICIldVxuIiwgcHJpdi0+Y2VpbGluZyk7Cj4gKwkqY2VpbGluZyA9IHByaXYtPmNlaWxpbmc7
Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGlt
X2NudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJ
CQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCQkgICAgIHZvaWQgKnBy
aXZhdGUsCj4gLQkJCQkJICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRp
YyBpbnQgc3RtMzJfbHB0aW1fY250X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICsJCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJ
IHU2NCBjZWlsaW5nKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKPiAtCXVuc2lnbmVkIGludCBjZWlsaW5nOwo+IC0JaW50IHJldDsK
PiAgCj4gIAlpZiAoc3RtMzJfbHB0aW1faXNfZW5hYmxlZChwcml2KSkKPiAgCQlyZXR1cm4gLUVC
VVNZOwo+ICAKPiAtCXJldCA9IGtzdHJ0b3VpbnQoYnVmLCAwLCAmY2VpbGluZyk7Cj4gLQlpZiAo
cmV0KQo+IC0JCXJldHVybiByZXQ7Cj4gLQo+ICAJaWYgKGNlaWxpbmcgPiBTVE0zMl9MUFRJTV9N
QVhfQVJSKQo+ICAJCXJldHVybiAtRVJBTkdFOwo+ICAKPiAgCXByaXYtPmNlaWxpbmcgPSBjZWls
aW5nOwo+ICAKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGlj
IGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCBzdG0zMl9scHRpbV9jbnRfZXh0W10gPSB7
Cj4gLQl7Cj4gLQkJLm5hbWUgPSAiZW5hYmxlIiwKPiAtCQkucmVhZCA9IHN0bTMyX2xwdGltX2Nu
dF9lbmFibGVfcmVhZCwKPiAtCQkud3JpdGUgPSBzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3dyaXRl
Cj4gLQl9LAo+IC0Jewo+IC0JCS5uYW1lID0gImNlaWxpbmciLAo+IC0JCS5yZWFkID0gc3RtMzJf
bHB0aW1fY250X2NlaWxpbmdfcmVhZCwKPiAtCQkud3JpdGUgPSBzdG0zMl9scHRpbV9jbnRfY2Vp
bGluZ193cml0ZQo+IC0JfSwKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgc3RtMzJfbHB0
aW1fY250X2V4dFtdID0gewo+ICsJQ09VTlRFUl9DT01QX0VOQUJMRShzdG0zMl9scHRpbV9jbnRf
ZW5hYmxlX3JlYWQsCj4gKwkJCSAgICBzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3dyaXRlKSwKPiAr
CUNPVU5URVJfQ09NUF9DRUlMSU5HKHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3JlYWQsCj4gKwkJ
CSAgICAgc3RtMzJfbHB0aW1fY250X2NlaWxpbmdfd3JpdGUpLAo+ICB9Owo+ICAKPiAtc3RhdGlj
IGludCBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkg
ICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+IC0JCQkJICAgICAgc2l6ZV90
ICphY3Rpb24pCj4gK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2FjdGlvbl9yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCj4gKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBz
ZSwKPiArCQkJCSAgICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAg
ewo+ICAJc3RydWN0IHN0bTMyX2xwdGltX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7
Cj4gLQlzaXplX3QgZnVuY3Rpb247Cj4gKwllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb247
Cj4gKwllbnVtIHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbiBjbnRfZnVuYzsKPiAgCWludCBlcnI7
Cj4gIAo+IC0JZXJyID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX2dldChjb3VudGVyLCBjb3Vu
dCwgJmZ1bmN0aW9uKTsKPiArCWVyciA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFkKGNv
dW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICAJaWYgKGVycikKPiAgCQlyZXR1cm4gZXJyOwo+
ICAKPiAtCXN3aXRjaCAoZnVuY3Rpb24pIHsKPiArCWVyciA9IHN0bTMyX2xwdGltX2Z1bmNfbWFw
KCZjbnRfZnVuYywgZnVuY3Rpb24pOwo+ICsJaWYgKGVycikKPiArCQlyZXR1cm4gZXJyOwo+ICsK
PiArCXN3aXRjaCAoY250X2Z1bmMpIHsKPiAgCWNhc2UgU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNS
RUFTRToKPiAgCQkvKiBMUCBUaW1lciBhY3RzIGFzIHVwLWNvdW50ZXIgb24gaW5wdXQgMSAqLwo+
ICAJCWlmIChzeW5hcHNlLT5zaWduYWwtPmlkID09IGNvdW50LT5zeW5hcHNlc1swXS5zaWduYWwt
PmlkKQo+IC0JCQkqYWN0aW9uID0gcHJpdi0+cG9sYXJpdHk7Cj4gKwkJCSphY3Rpb24gPSBzdG0z
Ml9scHRpbV9sMmNfYWN0aW9uc19tYXBbcHJpdi0+cG9sYXJpdHldOwo+ICAJCWVsc2UKPiAtCQkJ
KmFjdGlvbiA9IFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gKwkJCSphY3Rpb24g
PSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gIAkJcmV0dXJuIDA7Cj4gIAljYXNlIFNU
TTMyX0xQVElNX0VOQ09ERVJfQk9USF9FREdFOgo+IC0JCSphY3Rpb24gPSBwcml2LT5wb2xhcml0
eTsKPiArCQkqYWN0aW9uID0gc3RtMzJfbHB0aW1fbDJjX2FjdGlvbnNfbWFwW3ByaXYtPnBvbGFy
aXR5XTsKPiAgCQlyZXR1cm4gMDsKPiAgCWRlZmF1bHQ6Cj4gIAkJLyogc2hvdWxkIG5ldmVyIHJl
YWNoIHRoaXMgcGF0aCAqLwo+IEBAIC0zMzMsNDMgKzM1OSw0NCBAQCBzdGF0aWMgaW50IHN0bTMy
X2xwdGltX2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAg
CX0KPiAgfQo+ICAKPiAtc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX3NldChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCj4gLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNl
LAo+IC0JCQkJICAgICAgc2l6ZV90IGFjdGlvbikKPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9j
bnRfYWN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQlz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJc3RydWN0IGNvdW50ZXJfc3luYXBz
ZSAqc3luYXBzZSwKPiArCQkJCQllbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uKQo+
ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJp
djsKPiAtCXNpemVfdCBmdW5jdGlvbjsKPiArCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlv
bjsKPiArCWVudW0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uIGNudF9mdW5jOwo+ICAJaW50IGVy
cjsKPiAgCj4gIAlpZiAoc3RtMzJfbHB0aW1faXNfZW5hYmxlZChwcml2KSkKPiAgCQlyZXR1cm4g
LUVCVVNZOwo+ICAKPiAtCWVyciA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9nZXQoY291bnRl
ciwgY291bnQsICZmdW5jdGlvbik7Cj4gKwllcnIgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25f
cmVhZChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiArCWlmIChlcnIpCj4gKwkJcmV0dXJu
IGVycjsKPiArCj4gKwllcnIgPSBzdG0zMl9scHRpbV9mdW5jX21hcCgmY250X2Z1bmMsIGZ1bmN0
aW9uKTsKPiAgCWlmIChlcnIpCj4gIAkJcmV0dXJuIGVycjsKPiAgCj4gIAkvKiBvbmx5IHNldCBw
b2xhcml0eSB3aGVuIGluIGNvdW50ZXIgbW9kZSAob24gaW5wdXQgMSkgKi8KPiAtCWlmIChmdW5j
dGlvbiA9PSBTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNFCj4gLQkgICAgJiYgc3luYXBzZS0+
c2lnbmFsLT5pZCA9PSBjb3VudC0+c3luYXBzZXNbMF0uc2lnbmFsLT5pZCkgewo+IC0JCXN3aXRj
aCAoYWN0aW9uKSB7Cj4gLQkJY2FzZSBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9SSVNJTkdf
RURHRToKPiAtCQljYXNlIFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRToK
PiAtCQljYXNlIFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM6Cj4gLQkJCXBy
aXYtPnBvbGFyaXR5ID0gYWN0aW9uOwo+IC0JCQlyZXR1cm4gMDsKPiAtCQl9Cj4gLQl9Cj4gKwlp
ZiAoY250X2Z1bmMgIT0gU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRQo+ICsJICAgIHx8IHN5
bmFwc2UtPnNpZ25hbC0+aWQgIT0gY291bnQtPnN5bmFwc2VzWzBdLnNpZ25hbC0+aWQKPiArCSAg
ICB8fCBhY3Rpb24gPT0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FKQo+ICsJCXJldHVybiAt
RUlOVkFMOwo+ICAKPiAtCXJldHVybiAtRUlOVkFMOwo+ICsJcHJpdi0+cG9sYXJpdHkgPSBzdG0z
Ml9scHRpbV9jMmxfYWN0aW9uc19tYXBbYWN0aW9uXTsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+
ICAKPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyBzdG0zMl9scHRpbV9jbnRfb3Bz
ID0gewo+ICAJLmNvdW50X3JlYWQgPSBzdG0zMl9scHRpbV9jbnRfcmVhZCwKPiAtCS5mdW5jdGlv
bl9nZXQgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fZ2V0LAo+IC0JLmZ1bmN0aW9uX3NldCA9
IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9zZXQsCj4gLQkuYWN0aW9uX2dldCA9IHN0bTMyX2xw
dGltX2NudF9hY3Rpb25fZ2V0LAo+IC0JLmFjdGlvbl9zZXQgPSBzdG0zMl9scHRpbV9jbnRfYWN0
aW9uX3NldCwKPiArCS5mdW5jdGlvbl9yZWFkID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3Jl
YWQsCj4gKwkuZnVuY3Rpb25fd3JpdGUgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fd3JpdGUs
Cj4gKwkuYWN0aW9uX3JlYWQgPSBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX3JlYWQsCj4gKwkuYWN0
aW9uX3dyaXRlID0gc3RtMzJfbHB0aW1fY250X2FjdGlvbl93cml0ZSwKPiAgfTsKPiAgCj4gIHN0
YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWwgc3RtMzJfbHB0aW1fY250X3NpZ25hbHNbXSA9IHsK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jIGIvZHJpdmVy
cy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jCj4gaW5kZXggM2ZiMGRlYmQ3NDI1Li5jNjkwYjc2
ZTVkYWIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jCj4g
KysrIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jCj4gQEAgLTEzLDYgKzEzLDcg
QEAKPiAgI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgo+ICAjaW5jbHVkZSA8bGludXgvcGluY3Ry
bC9jb25zdW1lci5oPgo+ICAjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+Cj4gKyNp
bmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ICAKPiAgI2RlZmluZSBUSU1fQ0NNUl9DQ1hTCShCSVQo
OCkgfCBCSVQoMCkpCj4gICNkZWZpbmUgVElNX0NDTVJfTUFTSwkoVElNX0NDTVJfQ0MxUyB8IFRJ
TV9DQ01SX0NDMlMgfCBcCj4gQEAgLTQ0LDIxICs0NSwyMSBAQCBzdHJ1Y3Qgc3RtMzJfdGltZXJf
Y250IHsKPiAgICogQFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zOiBjb3VudHMgb24gYm90aCBU
STFGUDEgYW5kIFRJMkZQMiBlZGdlcwo+ICAgKi8KPiAgZW51bSBzdG0zMl9jb3VudF9mdW5jdGlv
biB7Cj4gKwlTVE0zMl9DT1VOVF9TTEFWRV9NT0RFX0RJU0FCTEVEID0gQ09VTlRFUl9GVU5DVElP
Tl9JTkNSRUFTRSwKPiArCVNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8xID0gQ09VTlRFUl9GVU5D
VElPTl9RVUFEUkFUVVJFX1gyX0EsCj4gKwlTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMiA9IENP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9CLAo+ICsJU1RNMzJfQ09VTlRfRU5DT0RFUl9N
T0RFXzMgPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gK307Cj4gKwo+ICtzdGF0
aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uIHN0bTMyX2NvdW50X2Z1bmN0aW9uc1tdID0g
ewo+ICAJU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxFRCwKPiAgCVNUTTMyX0NPVU5UX0VO
Q09ERVJfTU9ERV8xLAo+ICAJU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzIsCj4gIAlTVE0zMl9D
T1VOVF9FTkNPREVSX01PREVfMywKPiAgfTsKPiAgCj4gLXN0YXRpYyBjb25zdCBlbnVtIGNvdW50
ZXJfZnVuY3Rpb24gc3RtMzJfY291bnRfZnVuY3Rpb25zW10gPSB7Cj4gLQlbU1RNMzJfQ09VTlRf
U0xBVkVfTU9ERV9ESVNBQkxFRF0gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0JW1NU
TTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8xXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
Ml9BLAo+IC0JW1NUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yXSA9IENPVU5URVJfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YMl9CLAo+IC0JW1NUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zXSA9IENPVU5U
RVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiAtfTsKPiAtCj4gIHN0YXRpYyBpbnQgc3RtMzJf
Y291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHVuc2lnbmVkIGxvbmcgKnZhbCkKPiArCQkJICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2YWwpCj4gIHsKPiAgCXN0cnVjdCBzdG0z
Ml90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIGNudDsKPiBA
QCAtNzAsOCArNzEsNyBAQCBzdGF0aWMgaW50IHN0bTMyX2NvdW50X3JlYWQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4gIAo+ICBzdGF0aWMgaW50IHN0bTMyX2NvdW50X3dy
aXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCSAgICAgY29uc3QgdW5zaWduZWQgbG9uZyB2YWwpCj4g
KwkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBjb25zdCB1NjQgdmFsKQo+ICB7
Cj4gIAlzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsK
PiAgCXUzMiBjZWlsaW5nOwo+IEBAIC04Myw5ICs4Myw5IEBAIHN0YXRpYyBpbnQgc3RtMzJfY291
bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJuIHJlZ21h
cF93cml0ZShwcml2LT5yZWdtYXAsIFRJTV9DTlQsIHZhbCk7Cj4gIH0KPiAgCj4gLXN0YXRpYyBp
bnQgc3RtMzJfY291bnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgc2l6
ZV90ICpmdW5jdGlvbikKPiArc3RhdGljIGludCBzdG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAo+ICsJCQkJICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9u
KQo+ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+
cHJpdjsKPiAgCXUzMiBzbWNyOwo+IEBAIC0xMTAsOSArMTEwLDkgQEAgc3RhdGljIGludCBzdG0z
Ml9jb3VudF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJ
fQo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LAo+IC0JCQkJICAgIHNpemVfdCBmdW5jdGlvbikKPiArc3RhdGljIGludCBzdG0zMl9j
b3VudF9mdW5jdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJ
CQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkgICAgICBlbnVtIGNv
dW50ZXJfZnVuY3Rpb24gZnVuY3Rpb24pCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQg
KmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIGNyMSwgc21zOwo+IEBAIC0xNTAs
NDQgKzE1MCwzNyBAQCBzdGF0aWMgaW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGlj
IHNzaXplX3Qgc3RtMzJfY291bnRfZGlyZWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICtzdGF0aWMgaW50IHN0bTMyX2NvdW50X2RpcmVjdGlvbl9yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiAtCQkJCSAgICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArCQkJ
CSAgICAgIGVudW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gKmRpcmVjdGlvbikKPiAgewo+ICAJ
c3RydWN0IHN0bTMyX3RpbWVyX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gLQlj
b25zdCBjaGFyICpkaXJlY3Rpb247Cj4gIAl1MzIgY3IxOwo+ICAKPiAgCXJlZ21hcF9yZWFkKHBy
aXYtPnJlZ21hcCwgVElNX0NSMSwgJmNyMSk7Cj4gLQlkaXJlY3Rpb24gPSAoY3IxICYgVElNX0NS
MV9ESVIpID8gImJhY2t3YXJkIiA6ICJmb3J3YXJkIjsKPiArCSpkaXJlY3Rpb24gPSAoY3IxICYg
VElNX0NSMV9ESVIpID8gQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fQkFDS1dBUkQgOgo+ICsJCUNP
VU5URVJfQ09VTlRfRElSRUNUSU9OX0ZPUldBUkQ7Cj4gIAo+IC0JcmV0dXJuIHNjbnByaW50Zihi
dWYsIFBBR0VfU0laRSwgIiVzXG4iLCBkaXJlY3Rpb24pOwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAg
Cj4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+
IC0JCQkJCXZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBzdG0zMl9jb3Vu
dF9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICpjZWlsaW5nKQo+ICB7Cj4gIAlzdHJ1
Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCXUzMiBh
cnI7Cj4gIAo+ICAJcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fQVJSLCAmYXJyKTsKPiAg
Cj4gLQlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgYXJyKTsKPiArCSpj
ZWlsaW5nID0gYXJyOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVf
dCBzdG0zMl9jb3VudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtCQkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCSB2b2lkICpw
cml2YXRlLAo+IC0JCQkJCSBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBp
bnQgc3RtMzJfY291bnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IGNlaWxpbmcp
Cj4gIHsKPiAgCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5w
cml2Owo+IC0JdW5zaWduZWQgaW50IGNlaWxpbmc7Cj4gLQlpbnQgcmV0Owo+IC0KPiAtCXJldCA9
IGtzdHJ0b3VpbnQoYnVmLCAwLCAmY2VpbGluZyk7Cj4gLQlpZiAocmV0KQo+IC0JCXJldHVybiBy
ZXQ7Cj4gIAo+ICAJaWYgKGNlaWxpbmcgPiBwcml2LT5tYXhfYXJyKQo+ICAJCXJldHVybiAtRVJB
TkdFOwo+IEBAIC0xOTYsMzQgKzE4OSwyNyBAQCBzdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9j
ZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCXJlZ21hcF91
cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIFRJTV9DUjEsIFRJTV9DUjFfQVJQRSwgMCk7Cj4gIAly
ZWdtYXBfd3JpdGUocHJpdi0+cmVnbWFwLCBUSU1fQVJSLCBjZWlsaW5nKTsKPiAgCj4gLQlyZXR1
cm4gbGVuOwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2Nv
dW50X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgICAgdm9pZCAqcHJp
dmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHN0bTMyX2NvdW50X2VuYWJsZV9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwgdTggKmVuYWJsZSkKPiAgewo+ICAJc3RydWN0IHN0bTMyX3RpbWVyX2NudCAq
Y29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgY3IxOwo+ICAKPiAgCXJlZ21hcF9y
ZWFkKHByaXYtPnJlZ21hcCwgVElNX0NSMSwgJmNyMSk7Cj4gIAo+IC0JcmV0dXJuIHNjbnByaW50
ZihidWYsIFBBR0VfU0laRSwgIiVkXG4iLCAoYm9vbCkoY3IxICYgVElNX0NSMV9DRU4pKTsKPiAr
CSplbmFibGUgPSBjcjEgJiBUSU1fQ1IxX0NFTjsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAK
PiAtc3RhdGljIHNzaXplX3Qgc3RtMzJfY291bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAtCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4g
LQkJCQkJdm9pZCAqcHJpdmF0ZSwKPiAtCQkJCQljb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4p
Cj4gK3N0YXRpYyBpbnQgc3RtMzJfY291bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4
IGVuYWJsZSkKPiAgewo+ICAJc3RydWN0IHN0bTMyX3RpbWVyX2NudCAqY29uc3QgcHJpdiA9IGNv
dW50ZXItPnByaXY7Cj4gLQlpbnQgZXJyOwo+ICAJdTMyIGNyMTsKPiAtCWJvb2wgZW5hYmxlOwo+
IC0KPiAtCWVyciA9IGtzdHJ0b2Jvb2woYnVmLCAmZW5hYmxlKTsKPiAtCWlmIChlcnIpCj4gLQkJ
cmV0dXJuIGVycjsKPiAgCj4gIAlpZiAoZW5hYmxlKSB7Cj4gIAkJcmVnbWFwX3JlYWQocHJpdi0+
cmVnbWFwLCBUSU1fQ1IxLCAmY3IxKTsKPiBAQCAtMjQyLDcwICsyMjgsNTUgQEAgc3RhdGljIHNz
aXplX3Qgc3RtMzJfY291bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAgCS8qIEtlZXAgZW5hYmxlZCBzdGF0ZSB0byBwcm9wZXJseSBoYW5kbGUgbG93IHBv
d2VyIHN0YXRlcyAqLwo+ICAJcHJpdi0+ZW5hYmxlZCA9IGVuYWJsZTsKPiAgCj4gLQlyZXR1cm4g
bGVuOwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRl
cl9jb3VudF9leHQgc3RtMzJfY291bnRfZXh0W10gPSB7Cj4gLQl7Cj4gLQkJLm5hbWUgPSAiZGly
ZWN0aW9uIiwKPiAtCQkucmVhZCA9IHN0bTMyX2NvdW50X2RpcmVjdGlvbl9yZWFkLAo+IC0JfSwK
PiAtCXsKPiAtCQkubmFtZSA9ICJlbmFibGUiLAo+IC0JCS5yZWFkID0gc3RtMzJfY291bnRfZW5h
YmxlX3JlYWQsCj4gLQkJLndyaXRlID0gc3RtMzJfY291bnRfZW5hYmxlX3dyaXRlCj4gLQl9LAo+
IC0Jewo+IC0JCS5uYW1lID0gImNlaWxpbmciLAo+IC0JCS5yZWFkID0gc3RtMzJfY291bnRfY2Vp
bGluZ19yZWFkLAo+IC0JCS53cml0ZSA9IHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUKPiAtCX0s
Cj4gLX07Cj4gLQo+IC1lbnVtIHN0bTMyX3N5bmFwc2VfYWN0aW9uIHsKPiAtCVNUTTMyX1NZTkFQ
U0VfQUNUSU9OX05PTkUsCj4gLQlTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gK3N0
YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21wIHN0bTMyX2NvdW50X2V4dFtdID0gewo+ICsJQ09VTlRF
Ul9DT01QX0RJUkVDVElPTihzdG0zMl9jb3VudF9kaXJlY3Rpb25fcmVhZCksCj4gKwlDT1VOVEVS
X0NPTVBfRU5BQkxFKHN0bTMyX2NvdW50X2VuYWJsZV9yZWFkLCBzdG0zMl9jb3VudF9lbmFibGVf
d3JpdGUpLAo+ICsJQ09VTlRFUl9DT01QX0NFSUxJTkcoc3RtMzJfY291bnRfY2VpbGluZ19yZWFk
LAo+ICsJCQkgICAgIHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUpLAo+ICB9Owo+ICAKPiAgc3Rh
dGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9zeW5hcHNlX2FjdGlv
bnNbXSA9IHsKPiAtCVtTVE0zMl9TWU5BUFNFX0FDVElPTl9OT05FXSA9IENPVU5URVJfU1lOQVBT
RV9BQ1RJT05fTk9ORSwKPiAtCVtTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTXSA9IENP
VU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUwo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9OT05FLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gIH07Cj4gIAo+
IC1zdGF0aWMgaW50IHN0bTMyX2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+IC0JCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkgICAgc3Ry
dWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtCQkJICAgIHNpemVfdCAqYWN0aW9uKQo+
ICtzdGF0aWMgaW50IHN0bTMyX2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiArCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCSAgICAg
c3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiArCQkJICAgICBlbnVtIGNvdW50ZXJf
c3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+IC0Jc2l6ZV90IGZ1bmN0aW9uOwo+ICsJZW51
bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uOwo+ICAJaW50IGVycjsKPiAgCj4gLQllcnIgPSBz
dG0zMl9jb3VudF9mdW5jdGlvbl9nZXQoY291bnRlciwgY291bnQsICZmdW5jdGlvbik7Cj4gKwll
cnIgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24p
Owo+ICAJaWYgKGVycikKPiAgCQlyZXR1cm4gZXJyOwo+ICAKPiAgCXN3aXRjaCAoZnVuY3Rpb24p
IHsKPiAgCWNhc2UgU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxFRDoKPiAgCQkvKiBjb3Vu
dHMgb24gaW50ZXJuYWwgY2xvY2sgd2hlbiBDRU49MSAqLwo+IC0JCSphY3Rpb24gPSBTVE0zMl9T
WU5BUFNFX0FDVElPTl9OT05FOwo+ICsJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X05PTkU7Cj4gIAkJcmV0dXJuIDA7Cj4gIAljYXNlIFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8x
Ogo+ICAJCS8qIGNvdW50cyB1cC9kb3duIG9uIFRJMUZQMSBlZGdlIGRlcGVuZGluZyBvbiBUSTJG
UDIgbGV2ZWwgKi8KPiAgCQlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9PSBjb3VudC0+c3luYXBz
ZXNbMF0uc2lnbmFsLT5pZCkKPiAtCQkJKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVM7Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVM7Cj4gIAkJZWxzZQo+IC0JCQkqYWN0aW9uID0gU1RNMzJfU1lOQVBTRV9BQ1RJT05fTk9ORTsK
PiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiAgCQlyZXR1cm4g
MDsKPiAgCWNhc2UgU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzI6Cj4gIAkJLyogY291bnRzIHVw
L2Rvd24gb24gVEkyRlAyIGVkZ2UgZGVwZW5kaW5nIG9uIFRJMUZQMSBsZXZlbCAqLwo+ICAJCWlm
IChzeW5hcHNlLT5zaWduYWwtPmlkID09IGNvdW50LT5zeW5hcHNlc1sxXS5zaWduYWwtPmlkKQo+
IC0JCQkqYWN0aW9uID0gU1RNMzJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiArCQkJKmFj
dGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiAgCQllbHNlCj4gLQkJ
CSphY3Rpb24gPSBTVE0zMl9TWU5BUFNFX0FDVElPTl9OT05FOwo+ICsJCQkqYWN0aW9uID0gQ09V
TlRFUl9TWU5BUFNFX0FDVElPTl9OT05FOwo+ICAJCXJldHVybiAwOwo+ICAJY2FzZSBTVE0zMl9D
T1VOVF9FTkNPREVSX01PREVfMzoKPiAgCQkvKiBjb3VudHMgdXAvZG93biBvbiBib3RoIFRJMUZQ
MSBhbmQgVEkyRlAyIGVkZ2VzICovCj4gLQkJKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9O
X0JPVEhfRURHRVM7Cj4gKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUzsKPiAgCQlyZXR1cm4gMDsKPiAgCWRlZmF1bHQ6Cj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4g
QEAgLTMxNSw5ICsyODYsOSBAQCBzdGF0aWMgaW50IHN0bTMyX2FjdGlvbl9nZXQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3Bz
IHN0bTMyX3RpbWVyX2NudF9vcHMgPSB7Cj4gIAkuY291bnRfcmVhZCA9IHN0bTMyX2NvdW50X3Jl
YWQsCj4gIAkuY291bnRfd3JpdGUgPSBzdG0zMl9jb3VudF93cml0ZSwKPiAtCS5mdW5jdGlvbl9n
ZXQgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9nZXQsCj4gLQkuZnVuY3Rpb25fc2V0ID0gc3RtMzJf
Y291bnRfZnVuY3Rpb25fc2V0LAo+IC0JLmFjdGlvbl9nZXQgPSBzdG0zMl9hY3Rpb25fZ2V0LAo+
ICsJLmZ1bmN0aW9uX3JlYWQgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkLAo+ICsJLmZ1bmN0
aW9uX3dyaXRlID0gc3RtMzJfY291bnRfZnVuY3Rpb25fd3JpdGUsCj4gKwkuYWN0aW9uX3JlYWQg
PSBzdG0zMl9hY3Rpb25fcmVhZCwKPiAgfTsKPiAgCj4gIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9z
aWduYWwgc3RtMzJfc2lnbmFsc1tdID0gewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIv
dGktZXFlcC5jIGIvZHJpdmVycy9jb3VudGVyL3RpLWVxZXAuYwo+IGluZGV4IDk0ZmU1OGJiM2Vh
Yi4uMDk4MTdjOTUzZjlhIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvY291bnRlci90aS1lcWVwLmMK
PiArKysgYi9kcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5jCj4gQEAgLTEzLDYgKzEzLDcgQEAKPiAg
I2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgo+ICAjaW5jbHVkZSA8bGludXgvcG1f
cnVudGltZS5oPgo+ICAjaW5jbHVkZSA8bGludXgvcmVnbWFwLmg+Cj4gKyNpbmNsdWRlIDxsaW51
eC90eXBlcy5oPgo+ICAKPiAgLyogMzItYml0IHJlZ2lzdGVycyAqLwo+ICAjZGVmaW5lIFFQT1ND
TlQJCTB4MAo+IEBAIC03MywxOSArNzQsMTMgQEAgZW51bSB7Cj4gIH07Cj4gIAo+ICAvKiBQb3Np
dGlvbiBDb3VudGVyIElucHV0IE1vZGVzICovCj4gLWVudW0gewo+ICtlbnVtIHRpX2VxZXBfY291
bnRfZnVuYyB7Cj4gIAlUSV9FUUVQX0NPVU5UX0ZVTkNfUVVBRF9DT1VOVCwKPiAgCVRJX0VRRVBf
Q09VTlRfRlVOQ19ESVJfQ09VTlQsCj4gIAlUSV9FUUVQX0NPVU5UX0ZVTkNfVVBfQ09VTlQsCj4g
IAlUSV9FUUVQX0NPVU5UX0ZVTkNfRE9XTl9DT1VOVCwKPiAgfTsKPiAgCj4gLWVudW0gewo+IC0J
VElfRVFFUF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+IC0JVElfRVFFUF9TWU5BUFNFX0FD
VElPTl9SSVNJTkdfRURHRSwKPiAtCVRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiAtfTsK
PiAtCj4gIHN0cnVjdCB0aV9lcWVwX2NudCB7Cj4gIAlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgY291
bnRlcjsKPiAgCXN0cnVjdCByZWdtYXAgKnJlZ21hcDMyOwo+IEBAIC05Myw3ICs4OCw3IEBAIHN0
cnVjdCB0aV9lcWVwX2NudCB7Cj4gIH07Cj4gIAo+ICBzdGF0aWMgaW50IHRpX2VxZXBfY291bnRf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyAqdmFsKQo+ICsJCQkgICAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsKQo+ICB7Cj4gIAlzdHJ1Y3QgdGlfZXFl
cF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIGNudDsKPiBAQCAtMTA1LDcgKzEw
MCw3IEBAIHN0YXRpYyBpbnQgdGlfZXFlcF9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiAgfQo+ICAKPiAgc3RhdGljIGludCB0aV9lcWVwX2NvdW50X3dyaXRlKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyB2YWwpCj4gKwkJCSAgICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsIHU2NCB2YWwpCj4gIHsKPiAgCXN0cnVjdCB0aV9lcWVwX2NudCAq
cHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgbWF4Owo+IEBAIC0xMTcsNjQgKzExMiwxMDAg
QEAgc3RhdGljIGludCB0aV9lcWVwX2NvdW50X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAgCXJldHVybiByZWdtYXBfd3JpdGUocHJpdi0+cmVnbWFwMzIsIFFQT1NDTlQs
IHZhbCk7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgdGlfZXFlcF9mdW5jdGlvbl9nZXQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50LCBzaXplX3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IHRpX2VxZXBfZnVuY3Rpb25fcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAo+ICsJCQkJIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb24pCj4g
IHsKPiAgCXN0cnVjdCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIg
cWRlY2N0bDsKPiAgCj4gIAlyZWdtYXBfcmVhZChwcml2LT5yZWdtYXAxNiwgUURFQ0NUTCwgJnFk
ZWNjdGwpOwo+IC0JKmZ1bmN0aW9uID0gKHFkZWNjdGwgJiBRREVDQ1RMX1FTUkMpID4+IFFERUND
VExfUVNSQ19TSElGVDsKPiArCj4gKwlzd2l0Y2ggKChxZGVjY3RsICYgUURFQ0NUTF9RU1JDKSA+
PiBRREVDQ1RMX1FTUkNfU0hJRlQpIHsKPiArCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX1FVQURf
Q09VTlQ6Cj4gKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Owo+
ICsJCWJyZWFrOwo+ICsJY2FzZSBUSV9FUUVQX0NPVU5UX0ZVTkNfRElSX0NPVU5UOgo+ICsJCSpm
dW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOwo+ICsJCWJyZWFrOwo+
ICsJY2FzZSBUSV9FUUVQX0NPVU5UX0ZVTkNfVVBfQ09VTlQ6Cj4gKwkJKmZ1bmN0aW9uID0gQ09V
TlRFUl9GVU5DVElPTl9JTkNSRUFTRTsKPiArCQlicmVhazsKPiArCWNhc2UgVElfRVFFUF9DT1VO
VF9GVU5DX0RPV05fQ09VTlQ6Cj4gKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9ERUNS
RUFTRTsKPiArCQlicmVhazsKPiArCX0KPiAgCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3Rh
dGljIGludCB0aV9lcWVwX2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCBmdW5jdGlvbikK
PiArc3RhdGljIGludCB0aV9lcWVwX2Z1bmN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiArCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJ
ICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb24pCj4gIHsKPiAgCXN0cnVjdCB0aV9lcWVw
X2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gKwllbnVtIHRpX2VxZXBfY291bnRfZnVuYyBx
c3JjOwo+ICsKPiArCXN3aXRjaCAoZnVuY3Rpb24pIHsKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElP
Tl9RVUFEUkFUVVJFX1g0Ogo+ICsJCXFzcmMgPSBUSV9FUUVQX0NPVU5UX0ZVTkNfUVVBRF9DT1VO
VDsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT046
Cj4gKwkJcXNyYyA9IFRJX0VRRVBfQ09VTlRfRlVOQ19ESVJfQ09VTlQ7Cj4gKwkJYnJlYWs7Cj4g
KwljYXNlIENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0U6Cj4gKwkJcXNyYyA9IFRJX0VRRVBfQ09V
TlRfRlVOQ19VUF9DT1VOVDsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9E
RUNSRUFTRToKPiArCQlxc3JjID0gVElfRVFFUF9DT1VOVF9GVU5DX0RPV05fQ09VTlQ7Cj4gKwkJ
YnJlYWs7Cj4gKwlkZWZhdWx0Ogo+ICsJCS8qIHNob3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGgg
Ki8KPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiAgCj4gIAlyZXR1cm4gcmVnbWFwX3dyaXRl
X2JpdHMocHJpdi0+cmVnbWFwMTYsIFFERUNDVEwsIFFERUNDVExfUVNSQywKPiAtCQkJCSBmdW5j
dGlvbiA8PCBRREVDQ1RMX1FTUkNfU0hJRlQpOwo+ICsJCQkJIHFzcmMgPDwgUURFQ0NUTF9RU1JD
X1NISUZUKTsKPiAgfQo+ICAKPiAtc3RhdGljIGludCB0aV9lcWVwX2FjdGlvbl9nZXQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gLQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsIHNp
emVfdCAqYWN0aW9uKQo+ICtzdGF0aWMgaW50IHRpX2VxZXBfYWN0aW9uX3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LAo+ICsJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAr
CQkJICAgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKQo+ICB7Cj4gIAlz
dHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+IC0Jc2l6ZV90IGZ1bmN0
aW9uOwo+ICsJZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uOwo+ICAJdTMyIHFkZWNjdGw7
Cj4gIAlpbnQgZXJyOwo+ICAKPiAtCWVyciA9IHRpX2VxZXBfZnVuY3Rpb25fZ2V0KGNvdW50ZXIs
IGNvdW50LCAmZnVuY3Rpb24pOwo+ICsJZXJyID0gdGlfZXFlcF9mdW5jdGlvbl9yZWFkKGNvdW50
ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICAJaWYgKGVycikKPiAgCQlyZXR1cm4gZXJyOwo+ICAK
PiAgCXN3aXRjaCAoZnVuY3Rpb24pIHsKPiAtCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX1FVQURf
Q09VTlQ6Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiAgCQkvKiBJ
biBxdWFkcmF0dXJlIG1vZGUsIHRoZSByaXNpbmcgYW5kIGZhbGxpbmcgZWRnZSBvZiBib3RoCj4g
IAkJICogUUVQQSBhbmQgUUVQQiB0cmlnZ2VyIFFDTEsuCj4gIAkJICovCj4gLQkJKmFjdGlvbiA9
IFRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiArCQkqYWN0aW9uID0gQ09VTlRF
Ul9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICAJCXJldHVybiAwOwo+IC0JY2FzZSBUSV9F
UUVQX0NPVU5UX0ZVTkNfRElSX0NPVU5UOgo+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1BVTFNF
X0RJUkVDVElPTjoKPiAgCQkvKiBJbiBkaXJlY3Rpb24tY291bnQgbW9kZSBvbmx5IHJpc2luZyBl
ZGdlIG9mIFFFUEEgaXMgY291bnRlZAo+ICAJCSAqIGFuZCBRRVBCIGdpdmVzIGRpcmVjdGlvbi4K
PiAgCQkgKi8KPiAgCQlzd2l0Y2ggKHN5bmFwc2UtPnNpZ25hbC0+aWQpIHsKPiAgCQljYXNlIFRJ
X0VRRVBfU0lHTkFMX1FFUEE6Cj4gLQkJCSphY3Rpb24gPSBUSV9FUUVQX1NZTkFQU0VfQUNUSU9O
X1JJU0lOR19FREdFOwo+ICsJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJ
TkdfRURHRTsKPiAgCQkJcmV0dXJuIDA7Cj4gIAkJY2FzZSBUSV9FUUVQX1NJR05BTF9RRVBCOgo+
IC0JCQkqYWN0aW9uID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9OT05FOwo+ICsJCQkqYWN0aW9u
ID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FOwo+ICAJCQlyZXR1cm4gMDsKPiAgCQlkZWZh
dWx0Ogo+ICAJCQkvKiBzaG91bGQgbmV2ZXIgcmVhY2ggdGhpcyBwYXRoICovCj4gIAkJCXJldHVy
biAtRUlOVkFMOwo+ICAJCX0KPiAtCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX1VQX0NPVU5UOgo+
IC0JY2FzZSBUSV9FUUVQX0NPVU5UX0ZVTkNfRE9XTl9DT1VOVDoKPiArCWNhc2UgQ09VTlRFUl9G
VU5DVElPTl9JTkNSRUFTRToKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9ERUNSRUFTRToKPiAg
CQkvKiBJbiB1cC9kb3duLWNvdW50IG1vZGVzIG9ubHkgUUVQQSBpcyBjb3VudGVkIGFuZCBRRVBC
IGlzIG5vdAo+ICAJCSAqIHVzZWQuCj4gIAkJICovCj4gQEAgLTE4NSwxMiArMjE2LDEyIEBAIHN0
YXRpYyBpbnQgdGlfZXFlcF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAgCQkJCXJldHVybiBlcnI7Cj4gIAo+ICAJCQlpZiAocWRlY2N0bCAmIFFERUNDVExfWENS
KQo+IC0JCQkJKmFjdGlvbiA9IFRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiAr
CQkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gIAkJCWVs
c2UKPiAtCQkJCSphY3Rpb24gPSBUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+
ICsJCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gIAkJ
CXJldHVybiAwOwo+ICAJCWNhc2UgVElfRVFFUF9TSUdOQUxfUUVQQjoKPiAtCQkJKmFjdGlvbiA9
IFRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fTk9ORTsKPiAgCQkJcmV0dXJuIDA7Cj4gIAkJZGVmYXVsdDoKPiAgCQkJLyog
c2hvdWxkIG5ldmVyIHJlYWNoIHRoaXMgcGF0aCAqLwo+IEBAIC0yMDUsODIgKzIzNiw2NyBAQCBz
dGF0aWMgaW50IHRpX2VxZXBfYWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgdGlfZXFlcF9jb3VudGVyX29w
cyA9IHsKPiAgCS5jb3VudF9yZWFkCT0gdGlfZXFlcF9jb3VudF9yZWFkLAo+ICAJLmNvdW50X3dy
aXRlCT0gdGlfZXFlcF9jb3VudF93cml0ZSwKPiAtCS5mdW5jdGlvbl9nZXQJPSB0aV9lcWVwX2Z1
bmN0aW9uX2dldCwKPiAtCS5mdW5jdGlvbl9zZXQJPSB0aV9lcWVwX2Z1bmN0aW9uX3NldCwKPiAt
CS5hY3Rpb25fZ2V0CT0gdGlfZXFlcF9hY3Rpb25fZ2V0LAo+ICsJLmZ1bmN0aW9uX3JlYWQJPSB0
aV9lcWVwX2Z1bmN0aW9uX3JlYWQsCj4gKwkuZnVuY3Rpb25fd3JpdGUJPSB0aV9lcWVwX2Z1bmN0
aW9uX3dyaXRlLAo+ICsJLmFjdGlvbl9yZWFkCT0gdGlfZXFlcF9hY3Rpb25fcmVhZCwKPiAgfTsK
PiAgCj4gLXN0YXRpYyBzc2l6ZV90IHRpX2VxZXBfcG9zaXRpb25fY2VpbGluZ19yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiAtCQkJCQkgICAgIHZvaWQgKmV4dF9wcml2LCBjaGFyICpidWYpCj4gK3N0
YXRpYyBpbnQgdGlfZXFlcF9wb3NpdGlvbl9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ICsJCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJ
CQkJIHU2NCAqY2VpbGluZykKPiAgewo+ICAJc3RydWN0IHRpX2VxZXBfY250ICpwcml2ID0gY291
bnRlci0+cHJpdjsKPiAgCXUzMiBxcG9zbWF4Owo+ICAKPiAgCXJlZ21hcF9yZWFkKHByaXYtPnJl
Z21hcDMyLCBRUE9TTUFYLCAmcXBvc21heCk7Cj4gIAo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAi
JXVcbiIsIHFwb3NtYXgpOwo+ICsJKmNlaWxpbmcgPSBxcG9zbWF4Owo+ICsKPiArCXJldHVybiAw
Owo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCB0aV9lcWVwX3Bvc2l0aW9uX2NlaWxpbmdfd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCQkgICAgICB2b2lkICpleHRfcHJpdiwgY29uc3Qg
Y2hhciAqYnVmLAo+IC0JCQkJCSAgICAgIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQgdGlfZXFl
cF9wb3NpdGlvbl9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArCQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQkgIHU2NCBjZWls
aW5nKQo+ICB7Cj4gIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+
IC0JaW50IGVycjsKPiAtCXUzMiByZXM7Cj4gIAo+IC0JZXJyID0ga3N0cnRvdWludChidWYsIDAs
ICZyZXMpOwo+IC0JaWYgKGVyciA8IDApCj4gLQkJcmV0dXJuIGVycjsKPiArCWlmIChjZWlsaW5n
ICE9ICh1MzIpY2VpbGluZykKPiArCQlyZXR1cm4gLUVSQU5HRTsKPiAgCj4gLQlyZWdtYXBfd3Jp
dGUocHJpdi0+cmVnbWFwMzIsIFFQT1NNQVgsIHJlcyk7Cj4gKwlyZWdtYXBfd3JpdGUocHJpdi0+
cmVnbWFwMzIsIFFQT1NNQVgsIGNlaWxpbmcpOwo+ICAKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1
cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCQkgICAgdm9pZCAqZXh0X3ByaXYsIGNoYXIgKmJ1
ZikKPiArc3RhdGljIGludCB0aV9lcWVwX3Bvc2l0aW9uX2VuYWJsZV9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
IHU4ICplbmFibGUpCj4gIHsKPiAgCXN0cnVjdCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXIt
PnByaXY7Cj4gIAl1MzIgcWVwY3RsOwo+ICAKPiAgCXJlZ21hcF9yZWFkKHByaXYtPnJlZ21hcDE2
LCBRRVBDVEwsICZxZXBjdGwpOwo+ICAKPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAh
IShxZXBjdGwgJiBRRVBDVExfUEhFTikpOwo+ICsJKmVuYWJsZSA9ICEhKHFlcGN0bCAmIFFFUENU
TF9QSEVOKTsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgdGlf
ZXFlcF9wb3NpdGlvbl9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+IC0JCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCSAgICAg
dm9pZCAqZXh0X3ByaXYsIGNvbnN0IGNoYXIgKmJ1ZiwKPiAtCQkJCQkgICAgIHNpemVfdCBsZW4p
Cj4gK3N0YXRpYyBpbnQgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
IHU4IGVuYWJsZSkKPiAgewo+ICAJc3RydWN0IHRpX2VxZXBfY250ICpwcml2ID0gY291bnRlci0+
cHJpdjsKPiAtCWludCBlcnI7Cj4gLQlib29sIHJlczsKPiAtCj4gLQllcnIgPSBrc3RydG9ib29s
KGJ1ZiwgJnJlcyk7Cj4gLQlpZiAoZXJyIDwgMCkKPiAtCQlyZXR1cm4gZXJyOwo+ICAKPiAtCXJl
Z21hcF93cml0ZV9iaXRzKHByaXYtPnJlZ21hcDE2LCBRRVBDVEwsIFFFUENUTF9QSEVOLCByZXMg
PyAtMSA6IDApOwo+ICsJcmVnbWFwX3dyaXRlX2JpdHMocHJpdi0+cmVnbWFwMTYsIFFFUENUTCwg
UUVQQ1RMX1BIRU4sIGVuYWJsZSA/IC0xIDogMCk7Cj4gIAo+IC0JcmV0dXJuIGxlbjsKPiArCXJl
dHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0IHRpX2Vx
ZXBfcG9zaXRpb25fZXh0W10gPSB7Cj4gLQl7Cj4gLQkJLm5hbWUJPSAiY2VpbGluZyIsCj4gLQkJ
LnJlYWQJPSB0aV9lcWVwX3Bvc2l0aW9uX2NlaWxpbmdfcmVhZCwKPiAtCQkud3JpdGUJPSB0aV9l
cWVwX3Bvc2l0aW9uX2NlaWxpbmdfd3JpdGUsCj4gLQl9LAo+IC0Jewo+IC0JCS5uYW1lCT0gImVu
YWJsZSIsCj4gLQkJLnJlYWQJPSB0aV9lcWVwX3Bvc2l0aW9uX2VuYWJsZV9yZWFkLAo+IC0JCS53
cml0ZQk9IHRpX2VxZXBfcG9zaXRpb25fZW5hYmxlX3dyaXRlLAo+IC0JfSwKPiArc3RhdGljIHN0
cnVjdCBjb3VudGVyX2NvbXAgdGlfZXFlcF9wb3NpdGlvbl9leHRbXSA9IHsKPiArCUNPVU5URVJf
Q09NUF9DRUlMSU5HKHRpX2VxZXBfcG9zaXRpb25fY2VpbGluZ19yZWFkLAo+ICsJCQkgICAgIHRp
X2VxZXBfcG9zaXRpb25fY2VpbGluZ193cml0ZSksCj4gKwlDT1VOVEVSX0NPTVBfRU5BQkxFKHRp
X2VxZXBfcG9zaXRpb25fZW5hYmxlX3JlYWQsCj4gKwkJCSAgICB0aV9lcWVwX3Bvc2l0aW9uX2Vu
YWJsZV93cml0ZSksCj4gIH07Cj4gIAo+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIHRp
X2VxZXBfc2lnbmFsc1tdID0gewo+IEBAIC0yOTUsMTYgKzMxMSwxNiBAQCBzdGF0aWMgc3RydWN0
IGNvdW50ZXJfc2lnbmFsIHRpX2VxZXBfc2lnbmFsc1tdID0gewo+ICB9Owo+ICAKPiAgc3RhdGlj
IGNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiB0aV9lcWVwX3Bvc2l0aW9uX2Z1bmN0aW9uc1td
ID0gewo+IC0JW1RJX0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UXQk9IENPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YNCwKPiAtCVtUSV9FUUVQX0NPVU5UX0ZVTkNfRElSX0NPVU5UXQk9IENP
VU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OLAo+IC0JW1RJX0VRRVBfQ09VTlRfRlVOQ19V
UF9DT1VOVF0JPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0JW1RJX0VRRVBfQ09VTlRf
RlVOQ19ET1dOX0NPVU5UXQk9IENPVU5URVJfRlVOQ1RJT05fREVDUkVBU0UsCj4gKwlDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1BVTFNFX0RJUkVD
VElPTiwKPiArCUNPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCj4gKwlDT1VOVEVSX0ZVTkNUSU9O
X0RFQ1JFQVNFLAo+ICB9Owo+ICAKPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNl
X2FjdGlvbiB0aV9lcWVwX3Bvc2l0aW9uX3N5bmFwc2VfYWN0aW9uc1tdID0gewo+IC0JW1RJX0VR
RVBfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFU10JPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVMsCj4gLQlbVElfRVFFUF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRV0JPSBDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+IC0JW1RJX0VRRVBfU1lOQVBTRV9BQ1RJ
T05fTk9ORV0JCT0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+ICsJQ09VTlRFUl9TWU5B
UFNFX0FDVElPTl9CT1RIX0VER0VTLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdf
RURHRSwKPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiAgfTsKPiAgCj4gIHN0YXRp
YyBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlIHRpX2VxZXBfcG9zaXRpb25fc3luYXBzZXNbXSA9IHsK
PiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9jb3VudGVyLmggYi9pbmNsdWRlL2xpbnV4L2Nv
dW50ZXIuaAo+IGluZGV4IGQxNmNlMjgxOWI0OC4uYjY5Mjc3ZjVjNGM1IDEwMDY0NAo+IC0tLSBh
L2luY2x1ZGUvbGludXgvY291bnRlci5oCj4gKysrIGIvaW5jbHVkZS9saW51eC9jb3VudGVyLmgK
PiBAQCAtNiw0MiArNiwxODQgQEAKPiAgI2lmbmRlZiBfQ09VTlRFUl9IXwo+ICAjZGVmaW5lIF9D
T1VOVEVSX0hfCj4gIAo+IC0jaW5jbHVkZSA8bGludXgvY291bnRlcl9lbnVtLmg+Cj4gICNpbmNs
dWRlIDxsaW51eC9kZXZpY2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgo+ICAjaW5j
bHVkZSA8bGludXgvdHlwZXMuaD4KPiAgCj4gK3N0cnVjdCBjb3VudGVyX2RldmljZTsKPiArc3Ry
dWN0IGNvdW50ZXJfY291bnQ7Cj4gK3N0cnVjdCBjb3VudGVyX3N5bmFwc2U7Cj4gK3N0cnVjdCBj
b3VudGVyX3NpZ25hbDsKPiArCj4gK2VudW0gY291bnRlcl9jb21wX3R5cGUgewo+ICsJQ09VTlRF
Ul9DT01QX1U4LAo+ICsJQ09VTlRFUl9DT01QX1U2NCwKPiArCUNPVU5URVJfQ09NUF9CT09MLAo+
ICsJQ09VTlRFUl9DT01QX1NJR05BTF9MRVZFTCwKPiArCUNPVU5URVJfQ09NUF9GVU5DVElPTiwK
PiArCUNPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTiwKPiArCUNPVU5URVJfQ09NUF9FTlVNLAo+
ICsJQ09VTlRFUl9DT01QX0NPVU5UX0RJUkVDVElPTiwKPiArCUNPVU5URVJfQ09NUF9DT1VOVF9N
T0RFLAo+ICt9Owo+ICsKPiArZW51bSBjb3VudGVyX3Njb3BlIHsKPiArCUNPVU5URVJfU0NPUEVf
REVWSUNFLAo+ICsJQ09VTlRFUl9TQ09QRV9TSUdOQUwsCj4gKwlDT1VOVEVSX1NDT1BFX0NPVU5U
LAo+ICt9Owo+ICsKPiAgZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlvbiB7Cj4gLQlDT1VOVEVS
X0NPVU5UX0RJUkVDVElPTl9GT1JXQVJEID0gMCwKPiAtCUNPVU5URVJfQ09VTlRfRElSRUNUSU9O
X0JBQ0tXQVJECj4gKwlDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9GT1JXQVJELAo+ICsJQ09VTlRF
Ul9DT1VOVF9ESVJFQ1RJT05fQkFDS1dBUkQsCj4gIH07Cj4gLWV4dGVybiBjb25zdCBjaGFyICpj
b25zdCBjb3VudGVyX2NvdW50X2RpcmVjdGlvbl9zdHJbMl07Cj4gIAo+ICBlbnVtIGNvdW50ZXJf
Y291bnRfbW9kZSB7Cj4gLQlDT1VOVEVSX0NPVU5UX01PREVfTk9STUFMID0gMCwKPiArCUNPVU5U
RVJfQ09VTlRfTU9ERV9OT1JNQUwsCj4gIAlDT1VOVEVSX0NPVU5UX01PREVfUkFOR0VfTElNSVQs
Cj4gIAlDT1VOVEVSX0NPVU5UX01PREVfTk9OX1JFQ1lDTEUsCj4gLQlDT1VOVEVSX0NPVU5UX01P
REVfTU9EVUxPX04KPiArCUNPVU5URVJfQ09VTlRfTU9ERV9NT0RVTE9fTiwKPiAgfTsKPiAtZXh0
ZXJuIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfY291bnRfbW9kZV9zdHJbNF07Cj4gIAo+IC1z
dHJ1Y3QgY291bnRlcl9kZXZpY2U7Cj4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbDsKPiArZW51bSBj
b3VudGVyX2Z1bmN0aW9uIHsKPiArCUNPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCj4gKwlDT1VO
VEVSX0ZVTkNUSU9OX0RFQ1JFQVNFLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJ
T04sCj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQSwKPiArCUNPVU5URVJfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YMV9CLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gy
X0EsCj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQiwKPiArCUNPVU5URVJfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YNCwKPiArfTsKPiArCj4gK2VudW0gY291bnRlcl9zaWduYWxfbGV2
ZWwgewo+ICsJQ09VTlRFUl9TSUdOQUxfTEVWRUxfTE9XLAo+ICsJQ09VTlRFUl9TSUdOQUxfTEVW
RUxfSElHSCwKPiArfTsKPiArCj4gK2VudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiB7Cj4gKwlD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJ
U0lOR19FREdFLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gKwlD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCj4gK307Cj4gIAo+ICAvKioKPiAtICog
c3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCAtIENvdW50ZXIgU2lnbmFsIGV4dGVuc2lvbnMKPiAt
ICogQG5hbWU6CWF0dHJpYnV0ZSBuYW1lCj4gLSAqIEByZWFkOglyZWFkIGNhbGxiYWNrIGZvciB0
aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiAtICogQHdyaXRlOgl3cml0ZSBjYWxsYmFjayBm
b3IgdGhpcyBhdHRyaWJ1dGU7IG1heSBiZSBOVUxMCj4gLSAqIEBwcml2OglkYXRhIHByaXZhdGUg
dG8gdGhlIGRyaXZlcgo+ICsgKiBzdHJ1Y3QgY291bnRlcl9jb21wIC0gQ291bnRlciBjb21wb25l
bnQgbm9kZQo+ICsgKiBAdHlwZToJCUNvdW50ZXIgY29tcG9uZW50IGRhdGEgdHlwZQo+ICsgKiBA
bmFtZToJCWRldmljZS1zcGVjaWZpYyBjb21wb25lbnQgbmFtZQo+ICsgKiBAcHJpdjoJCWNvbXBv
bmVudC1yZWxldmFudCBkYXRhCj4gKyAqIEBhY3Rpb25fcmVhZAkJU3luYXBzZSBhY3Rpb24gbW9k
ZSByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiArICoJCQlyZXNwZWN0aXZl
IFN5bmFwc2UgYWN0aW9uIG1vZGUgc2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+ICsgKgkJCXRo
ZSBhY3Rpb24gcGFyYW1ldGVyLgo+ICsgKiBAZGV2aWNlX3U4X3JlYWQJRGV2aWNlIHU4IGNvbXBv
bmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiArICoJCQlyZXNwZWN0
aXZlIERldmljZSB1OCBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+ICsgKgkJ
CXRoZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAY291bnRfdThfcmVhZAlDb3VudCB1OCBjb21wb25l
bnQgcmVhZCBjYWxsYmFjay4gVGhlIHJlYWQgdmFsdWUgb2YgdGhlCj4gKyAqCQkJcmVzcGVjdGl2
ZSBDb3VudCB1OCBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+ICsgKgkJCXRo
ZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAc2lnbmFsX3U4X3JlYWQJU2lnbmFsIHU4IGNvbXBvbmVu
dCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiArICoJCQlyZXNwZWN0aXZl
IFNpZ25hbCB1OCBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+ICsgKgkJCXRo
ZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAZGV2aWNlX3UzMl9yZWFkCURldmljZSB1MzIgY29tcG9u
ZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mCj4gKyAqCQkJdGhlIHJlc3BlY3Rp
dmUgRGV2aWNlIHUzMiBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZAo+ICsgKgkJCWJhY2sgdmlh
IHRoZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAY291bnRfdTMyX3JlYWQJQ291bnQgdTMyIGNvbXBv
bmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiArICoJCQlyZXNwZWN0
aXZlIENvdW50IHUzMiBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+ICsgKgkJ
CXRoZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAc2lnbmFsX3UzMl9yZWFkCVNpZ25hbCB1MzIgY29t
cG9uZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mCj4gKyAqCQkJdGhlIHJlc3Bl
Y3RpdmUgU2lnbmFsIHUzMiBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZAo+ICsgKgkJCWJhY2sg
dmlhIHRoZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAZGV2aWNlX3U2NF9yZWFkCURldmljZSB1NjQg
Y29tcG9uZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mCj4gKyAqCQkJdGhlIHJl
c3BlY3RpdmUgRGV2aWNlIHU2NCBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZAo+ICsgKgkJCWJh
Y2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAY291bnRfdTY0X3JlYWQJQ291bnQgdTY0
IGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiArICoJCQly
ZXNwZWN0aXZlIENvdW50IHU2NCBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+
ICsgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAc2lnbmFsX3U2NF9yZWFkCVNpZ25hbCB1
NjQgY29tcG9uZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mCj4gKyAqCQkJdGhl
IHJlc3BlY3RpdmUgU2lnbmFsIHU2NCBjb21wb25lbnQgc2hvdWxkIGJlIHBhc3NlZAo+ICsgKgkJ
CWJhY2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgo+ICsgKiBAYWN0aW9uX3dyaXRlCVN5bmFwc2Ug
YWN0aW9uIG1vZGUgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgo+ICsgKgkJCXRo
ZSByZXNwZWN0aXZlIFN5bmFwc2UgYWN0aW9uIG1vZGUgaXMgcGFzc2VkIHZpYSB0aGUKPiArICoJ
CQlhY3Rpb24gcGFyYW1ldGVyLgo+ICsgKiBAZGV2aWNlX3U4X3dyaXRlCURldmljZSB1OCBjb21w
b25lbnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNw
ZWN0aXZlIERldmljZSB1OCBjb21wb25lbnQgaXMgcGFzc2VkIHZpYSB0aGUgdmFsCj4gKyAqCQkJ
cGFyYW1ldGVyLgo+ICsgKiBAY291bnRfdThfd3JpdGUJQ291bnQgdTggY29tcG9uZW50IHdyaXRl
IGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiArICoJCQl0aGUgcmVzcGVjdGl2ZSBDb3Vu
dCB1OCBjb21wb25lbnQgaXMgcGFzc2VkIHZpYSB0aGUgdmFsCj4gKyAqCQkJcGFyYW1ldGVyLgo+
ICsgKiBAc2lnbmFsX3U4X3dyaXRlCVNpZ25hbCB1OCBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2su
IFRoZSB3cml0ZSB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIFNpZ25hbCB1OCBjb21w
b25lbnQgaXMgcGFzc2VkIHZpYSB0aGUgdmFsCj4gKyAqCQkJcGFyYW1ldGVyLgo+ICsgKiBAZGV2
aWNlX3UzMl93cml0ZQlEZXZpY2UgdTMyIGNvbXBvbmVudCB3cml0ZSBjYWxsYmFjay4gVGhlIHdy
aXRlIHZhbHVlIG9mCj4gKyAqCQkJdGhlIHJlc3BlY3RpdmUgRGV2aWNlIHUzMiBjb21wb25lbnQg
aXMgcGFzc2VkIHZpYSB0aGUKPiArICoJCQl2YWwgcGFyYW1ldGVyLgo+ICsgKiBAY291bnRfdTMy
X3dyaXRlCUNvdW50IHUzMiBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1
ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIENvdW50IHUzMiBjb21wb25lbnQgaXMgcGFzc2Vk
IHZpYSB0aGUgdmFsCj4gKyAqCQkJcGFyYW1ldGVyLgo+ICsgKiBAc2lnbmFsX3UzMl93cml0ZQlT
aWduYWwgdTMyIGNvbXBvbmVudCB3cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4g
KyAqCQkJdGhlIHJlc3BlY3RpdmUgU2lnbmFsIHUzMiBjb21wb25lbnQgaXMgcGFzc2VkIHZpYSB0
aGUKPiArICoJCQl2YWwgcGFyYW1ldGVyLgo+ICsgKiBAZGV2aWNlX3U2NF93cml0ZQlEZXZpY2Ug
dTY0IGNvbXBvbmVudCB3cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4gKyAqCQkJ
dGhlIHJlc3BlY3RpdmUgRGV2aWNlIHU2NCBjb21wb25lbnQgaXMgcGFzc2VkIHZpYSB0aGUKPiAr
ICoJCQl2YWwgcGFyYW1ldGVyLgo+ICsgKiBAY291bnRfdTY0X3dyaXRlCUNvdW50IHU2NCBjb21w
b25lbnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNw
ZWN0aXZlIENvdW50IHU2NCBjb21wb25lbnQgaXMgcGFzc2VkIHZpYSB0aGUgdmFsCj4gKyAqCQkJ
cGFyYW1ldGVyLgo+ICsgKiBAc2lnbmFsX3U2NF93cml0ZQlTaWduYWwgdTY0IGNvbXBvbmVudCB3
cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4gKyAqCQkJdGhlIHJlc3BlY3RpdmUg
U2lnbmFsIHU2NCBjb21wb25lbnQgaXMgcGFzc2VkIHZpYSB0aGUKPiArICoJCQl2YWwgcGFyYW1l
dGVyLgo+ICAgKi8KPiAtc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCB7Cj4gK3N0cnVjdCBjb3Vu
dGVyX2NvbXAgewo+ICsJZW51bSBjb3VudGVyX2NvbXBfdHlwZSB0eXBlOwo+ICAJY29uc3QgY2hh
ciAqbmFtZTsKPiAtCXNzaXplX3QgKCpyZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLQkJCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2LCBjaGFy
ICpidWYpOwo+IC0Jc3NpemVfdCAoKndyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLQkJCSBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdiwKPiAt
CQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7Cj4gIAl2b2lkICpwcml2Owo+ICsJdW5p
b24gewo+ICsJCWludCAoKmFjdGlvbl9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gKwkJCQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkgICBzdHJ1
Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ICsJCQkJICAgZW51bSBjb3VudGVyX3N5bmFw
c2VfYWN0aW9uICphY3Rpb24pOwo+ICsJCWludCAoKmRldmljZV91OF9yZWFkKShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHU4ICp2YWwpOwo+ICsJCWludCAoKmNvdW50X3U4X3JlYWQp
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCB1OCAqdmFsKTsKPiArCQlpbnQgKCpzaWduYWxfdThfcmVhZCkoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgc3RydWN0IGNvdW50ZXJf
c2lnbmFsICpzaWduYWwsIHU4ICp2YWwpOwo+ICsJCWludCAoKmRldmljZV91MzJfcmVhZCkoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgIHUzMiAqdmFsKTsKPiAr
CQlpbnQgKCpjb3VudF91MzJfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICsJCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1MzIgKnZhbCk7Cj4gKwkJ
aW50ICgqc2lnbmFsX3UzMl9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
KwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHUzMiAqdmFsKTsKPiAr
CQlpbnQgKCpkZXZpY2VfdTY0X3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArCQkJCSAgICAgICB1NjQgKnZhbCk7Cj4gKwkJaW50ICgqY291bnRfdTY0X3JlYWQpKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwgdTY0ICp2YWwpOwo+ICsJCWludCAoKnNpZ25hbF91NjRfcmVhZCkoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX3Np
Z25hbCAqc2lnbmFsLCB1NjQgKnZhbCk7Cj4gKwl9Owo+ICsJdW5pb24gewo+ICsJCWludCAoKmFj
dGlvbl93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9zeW5h
cHNlICpzeW5hcHNlLAo+ICsJCQkJICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rp
b24pOwo+ICsJCWludCAoKmRldmljZV91OF93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLCB1OCB2YWwpOwo+ICsJCWludCAoKmNvdW50X3U4X3dyaXRlKShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsIHU4IHZhbCk7Cj4gKwkJaW50ICgqc2lnbmFsX3U4X3dyaXRlKShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWdu
YWwsIHU4IHZhbCk7Cj4gKwkJaW50ICgqZGV2aWNlX3UzMl93cml0ZSkoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCXUzMiB2YWwpOwo+ICsJCWludCAoKmNvdW50X3UzMl93
cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyIHZhbCk7Cj4gKwkJaW50ICgqc2lnbmFsX3UzMl93
cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCXN0cnVjdCBjb3Vu
dGVyX3NpZ25hbCAqc2lnbmFsLCB1MzIgdmFsKTsKPiArCQlpbnQgKCpkZXZpY2VfdTY0X3dyaXRl
KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkJdTY0IHZhbCk7Cj4gKwkJ
aW50ICgqY291bnRfdTY0X3dyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
KwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgdmFsKTsKPiArCQlp
bnQgKCpzaWduYWxfdTY0X3dyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
KwkJCQkJc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHU2NCB2YWwpOwo+ICsJfTsKPiAg
fTsKPiAgCj4gIC8qKgo+IEBAIC01MSwyNDggKzE5Myw1MiBAQCBzdHJ1Y3QgY291bnRlcl9zaWdu
YWxfZXh0IHsKPiAgICoJCWFzIGl0IGFwcGVhcnMgaW4gdGhlIGRhdGFzaGVldCBkb2N1bWVudGF0
aW9uCj4gICAqIEBleHQ6CW9wdGlvbmFsIGFycmF5IG9mIENvdW50ZXIgU2lnbmFsIGV4dGVuc2lv
bnMKPiAgICogQG51bV9leHQ6CW51bWJlciBvZiBDb3VudGVyIFNpZ25hbCBleHRlbnNpb25zIHNw
ZWNpZmllZCBpbiBAZXh0Cj4gLSAqIEBwcml2OglvcHRpb25hbCBwcml2YXRlIGRhdGEgc3VwcGxp
ZWQgYnkgZHJpdmVyCj4gICAqLwo+ICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgewo+ICAJaW50IGlk
Owo+ICAJY29uc3QgY2hhciAqbmFtZTsKPiAgCj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWdu
YWxfZXh0ICpleHQ7Cj4gKwlzdHJ1Y3QgY291bnRlcl9jb21wICpleHQ7Cj4gIAlzaXplX3QgbnVt
X2V4dDsKPiAtCj4gLQl2b2lkICpwcml2Owo+IC19Owo+IC0KPiAtLyoqCj4gLSAqIHN0cnVjdCBj
b3VudGVyX3NpZ25hbF9lbnVtX2V4dCAtIFNpZ25hbCBlbnVtIGV4dGVuc2lvbiBhdHRyaWJ1dGUK
PiAtICogQGl0ZW1zOglBcnJheSBvZiBzdHJpbmdzCj4gLSAqIEBudW1faXRlbXM6CU51bWJlciBv
ZiBpdGVtcyBzcGVjaWZpZWQgaW4gQGl0ZW1zCj4gLSAqIEBzZXQ6CVNldCBjYWxsYmFjayBmdW5j
dGlvbjsgbWF5IGJlIE5VTEwKPiAtICogQGdldDoJR2V0IGNhbGxiYWNrIGZ1bmN0aW9uOyBtYXkg
YmUgTlVMTAo+IC0gKgo+IC0gKiBUaGUgY291bnRlcl9zaWduYWxfZW51bV9leHQgc3RydWN0dXJl
IGNhbiBiZSB1c2VkIHRvIGltcGxlbWVudCBlbnVtIHN0eWxlCj4gLSAqIFNpZ25hbCBleHRlbnNp
b24gYXR0cmlidXRlcy4gRW51bSBzdHlsZSBhdHRyaWJ1dGVzIGFyZSB0aG9zZSB3aGljaCBoYXZl
IGEgc2V0Cj4gLSAqIG9mIHN0cmluZ3MgdGhhdCBtYXAgdG8gdW5zaWduZWQgaW50ZWdlciB2YWx1
ZXMuIFRoZSBHZW5lcmljIENvdW50ZXIgU2lnbmFsCj4gLSAqIGVudW0gZXh0ZW5zaW9uIGhlbHBl
ciBjb2RlIHRha2VzIGNhcmUgb2YgbWFwcGluZyBiZXR3ZWVuIHZhbHVlIGFuZCBzdHJpbmcsIGFz
Cj4gLSAqIHdlbGwgYXMgZ2VuZXJhdGluZyBhICJfYXZhaWxhYmxlIiBmaWxlIHdoaWNoIGNvbnRh
aW5zIGEgbGlzdCBvZiBhbGwgYXZhaWxhYmxlCj4gLSAqIGl0ZW1zLiBUaGUgZ2V0IGNhbGxiYWNr
IGlzIHVzZWQgdG8gcXVlcnkgdGhlIGN1cnJlbnRseSBhY3RpdmUgaXRlbTsgdGhlIGluZGV4Cj4g
LSAqIG9mIHRoZSBpdGVtIHdpdGhpbiB0aGUgcmVzcGVjdGl2ZSBpdGVtcyBhcnJheSBpcyByZXR1
cm5lZCB2aWEgdGhlICdpdGVtJwo+IC0gKiBwYXJhbWV0ZXIuIFRoZSBzZXQgY2FsbGJhY2sgaXMg
Y2FsbGVkIHdoZW4gdGhlIGF0dHJpYnV0ZSBpcyB1cGRhdGVkOyB0aGUKPiAtICogJ2l0ZW0nIHBh
cmFtZXRlciBjb250YWlucyB0aGUgaW5kZXggb2YgdGhlIG5ld2x5IGFjdGl2YXRlZCBpdGVtIHdp
dGhpbiB0aGUKPiAtICogcmVzcGVjdGl2ZSBpdGVtcyBhcnJheS4KPiAtICovCj4gLXN0cnVjdCBj
b3VudGVyX3NpZ25hbF9lbnVtX2V4dCB7Cj4gLQljb25zdCBjaGFyICogY29uc3QgKml0ZW1zOwo+
IC0Jc2l6ZV90IG51bV9pdGVtczsKPiAtCWludCAoKmdldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+IC0JCSAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCBzaXplX3Qg
Kml0ZW0pOwo+IC0JaW50ICgqc2V0KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
LQkJICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHNpemVfdCBpdGVtKTsKPiAtfTsK
PiAtCj4gLS8qKgo+IC0gKiBDT1VOVEVSX1NJR05BTF9FTlVNKCkgLSBJbml0aWFsaXplIFNpZ25h
bCBlbnVtIGV4dGVuc2lvbgo+IC0gKiBAX25hbWU6CUF0dHJpYnV0ZSBuYW1lCj4gLSAqIEBfZToJ
CVBvaW50ZXIgdG8gYSBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCBzdHJ1Y3R1cmUKPiAtICoKPiAt
ICogVGhpcyBzaG91bGQgdXN1YWxseSBiZSB1c2VkIHRvZ2V0aGVyIHdpdGggQ09VTlRFUl9TSUdO
QUxfRU5VTV9BVkFJTEFCTEUoKQo+IC0gKi8KPiAtI2RlZmluZSBDT1VOVEVSX1NJR05BTF9FTlVN
KF9uYW1lLCBfZSkgXAo+IC17IFwKPiAtCS5uYW1lID0gKF9uYW1lKSwgXAo+IC0JLnJlYWQgPSBj
b3VudGVyX3NpZ25hbF9lbnVtX3JlYWQsIFwKPiAtCS53cml0ZSA9IGNvdW50ZXJfc2lnbmFsX2Vu
dW1fd3JpdGUsIFwKPiAtCS5wcml2ID0gKF9lKSBcCj4gLX0KPiAtCj4gLS8qKgo+IC0gKiBDT1VO
VEVSX1NJR05BTF9FTlVNX0FWQUlMQUJMRSgpIC0gSW5pdGlhbGl6ZSBTaWduYWwgZW51bSBhdmFp
bGFibGUgZXh0ZW5zaW9uCj4gLSAqIEBfbmFtZToJQXR0cmlidXRlIG5hbWUgKCJfYXZhaWxhYmxl
IiB3aWxsIGJlIGFwcGVuZGVkIHRvIHRoZSBuYW1lKQo+IC0gKiBAX2U6CQlQb2ludGVyIHRvIGEg
Y291bnRlcl9zaWduYWxfZW51bV9leHQgc3RydWN0dXJlCj4gLSAqCj4gLSAqIENyZWF0ZXMgYSBy
ZWFkIG9ubHkgYXR0cmlidXRlIHRoYXQgbGlzdHMgYWxsIHRoZSBhdmFpbGFibGUgZW51bSBpdGVt
cyBpbiBhCj4gLSAqIG5ld2xpbmUgc2VwYXJhdGVkIGxpc3QuIFRoaXMgc2hvdWxkIHVzdWFsbHkg
YmUgdXNlZCB0b2dldGhlciB3aXRoCj4gLSAqIENPVU5URVJfU0lHTkFMX0VOVU0oKQo+IC0gKi8K
PiAtI2RlZmluZSBDT1VOVEVSX1NJR05BTF9FTlVNX0FWQUlMQUJMRShfbmFtZSwgX2UpIFwKPiAt
eyBcCj4gLQkubmFtZSA9IChfbmFtZSAiX2F2YWlsYWJsZSIpLCBcCj4gLQkucmVhZCA9IGNvdW50
ZXJfc2lnbmFsX2VudW1fYXZhaWxhYmxlX3JlYWQsIFwKPiAtCS5wcml2ID0gKF9lKSBcCj4gLX0K
PiAtCj4gLWVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiB7Cj4gLQlDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX05PTkUgPSAwLAo+IC0JQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwK
PiAtCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+IC0JQ09VTlRFUl9TWU5B
UFNFX0FDVElPTl9CT1RIX0VER0VTCj4gIH07Cj4gIAo+ICAvKioKPiAgICogc3RydWN0IGNvdW50
ZXJfc3luYXBzZSAtIENvdW50ZXIgU3luYXBzZSBub2RlCj4gLSAqIEBhY3Rpb246CQlpbmRleCBv
ZiBjdXJyZW50IGFjdGlvbiBtb2RlCj4gICAqIEBhY3Rpb25zX2xpc3Q6CWFycmF5IG9mIGF2YWls
YWJsZSBhY3Rpb24gbW9kZXMKPiAgICogQG51bV9hY3Rpb25zOgludW1iZXIgb2YgYWN0aW9uIG1v
ZGVzIHNwZWNpZmllZCBpbiBAYWN0aW9uc19saXN0Cj4gICAqIEBzaWduYWw6CQlwb2ludGVyIHRv
IGFzc29jaWF0ZWQgc2lnbmFsCj4gICAqLwo+ICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlIHsKPiAt
CXNpemVfdCBhY3Rpb247Cj4gIAljb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFj
dGlvbnNfbGlzdDsKPiAgCXNpemVfdCBudW1fYWN0aW9uczsKPiAgCj4gIAlzdHJ1Y3QgY291bnRl
cl9zaWduYWwgKnNpZ25hbDsKPiAgfTsKPiAgCj4gLXN0cnVjdCBjb3VudGVyX2NvdW50Owo+IC0K
PiAtLyoqCj4gLSAqIHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCAtIENvdW50ZXIgQ291bnQgZXh0
ZW5zaW9uCj4gLSAqIEBuYW1lOglhdHRyaWJ1dGUgbmFtZQo+IC0gKiBAcmVhZDoJcmVhZCBjYWxs
YmFjayBmb3IgdGhpcyBhdHRyaWJ1dGU7IG1heSBiZSBOVUxMCj4gLSAqIEB3cml0ZToJd3JpdGUg
Y2FsbGJhY2sgZm9yIHRoaXMgYXR0cmlidXRlOyBtYXkgYmUgTlVMTAo+IC0gKiBAcHJpdjoJZGF0
YSBwcml2YXRlIHRvIHRoZSBkcml2ZXIKPiAtICovCj4gLXN0cnVjdCBjb3VudGVyX2NvdW50X2V4
dCB7Cj4gLQljb25zdCBjaGFyICpuYW1lOwo+IC0Jc3NpemVfdCAoKnJlYWQpKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2
b2lkICpwcml2LCBjaGFyICpidWYpOwo+IC0Jc3NpemVfdCAoKndyaXRlKShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZv
aWQgKnByaXYsCj4gLQkJCSBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pOwo+IC0Jdm9pZCAq
cHJpdjsKPiAtfTsKPiAtCj4gLWVudW0gY291bnRlcl9mdW5jdGlvbiB7Cj4gLQlDT1VOVEVSX0ZV
TkNUSU9OX0lOQ1JFQVNFID0gMCwKPiAtCUNPVU5URVJfRlVOQ1RJT05fREVDUkVBU0UsCj4gLQlD
T1VOVEVSX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTiwKPiAtCUNPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YMV9BLAo+IC0JQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0IsCj4gLQlD
T1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQSwKPiAtCUNPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YMl9CLAo+IC0JQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Cj4gLX07Cj4g
LQo+ICAvKioKPiAgICogc3RydWN0IGNvdW50ZXJfY291bnQgLSBDb3VudGVyIENvdW50IG5vZGUK
PiAgICogQGlkOgkJCXVuaXF1ZSBJRCB1c2VkIHRvIGlkZW50aWZ5IENvdW50Cj4gICAqIEBuYW1l
OgkJZGV2aWNlLXNwZWNpZmljIENvdW50IG5hbWU7IGlkZWFsbHksIHRoaXMgc2hvdWxkIG1hdGNo
Cj4gICAqCQkJdGhlIG5hbWUgYXMgaXQgYXBwZWFycyBpbiB0aGUgZGF0YXNoZWV0IGRvY3VtZW50
YXRpb24KPiAtICogQGZ1bmN0aW9uOgkJaW5kZXggb2YgY3VycmVudCBmdW5jdGlvbiBtb2RlCj4g
ICAqIEBmdW5jdGlvbnNfbGlzdDoJYXJyYXkgYXZhaWxhYmxlIGZ1bmN0aW9uIG1vZGVzCj4gICAq
IEBudW1fZnVuY3Rpb25zOgludW1iZXIgb2YgZnVuY3Rpb24gbW9kZXMgc3BlY2lmaWVkIGluIEBm
dW5jdGlvbnNfbGlzdAo+ICAgKiBAc3luYXBzZXM6CQlhcnJheSBvZiBzeW5hcHNlcyBmb3IgaW5p
dGlhbGl6YXRpb24KPiAgICogQG51bV9zeW5hcHNlczoJbnVtYmVyIG9mIHN5bmFwc2VzIHNwZWNp
ZmllZCBpbiBAc3luYXBzZXMKPiAgICogQGV4dDoJCW9wdGlvbmFsIGFycmF5IG9mIENvdW50ZXIg
Q291bnQgZXh0ZW5zaW9ucwo+ICAgKiBAbnVtX2V4dDoJCW51bWJlciBvZiBDb3VudGVyIENvdW50
IGV4dGVuc2lvbnMgc3BlY2lmaWVkIGluIEBleHQKPiAtICogQHByaXY6CQlvcHRpb25hbCBwcml2
YXRlIGRhdGEgc3VwcGxpZWQgYnkgZHJpdmVyCj4gICAqLwo+ICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCB7Cj4gIAlpbnQgaWQ7Cj4gIAljb25zdCBjaGFyICpuYW1lOwo+ICAKPiAtCXNpemVfdCBmdW5j
dGlvbjsKPiAgCWNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb25zX2xpc3Q7Cj4g
IAlzaXplX3QgbnVtX2Z1bmN0aW9uczsKPiAgCj4gIAlzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpz
eW5hcHNlczsKPiAgCXNpemVfdCBudW1fc3luYXBzZXM7Cj4gIAo+IC0JY29uc3Qgc3RydWN0IGNv
dW50ZXJfY291bnRfZXh0ICpleHQ7Cj4gKwlzdHJ1Y3QgY291bnRlcl9jb21wICpleHQ7Cj4gIAlz
aXplX3QgbnVtX2V4dDsKPiAtCj4gLQl2b2lkICpwcml2Owo+IC19Owo+IC0KPiAtLyoqCj4gLSAq
IHN0cnVjdCBjb3VudGVyX2NvdW50X2VudW1fZXh0IC0gQ291bnQgZW51bSBleHRlbnNpb24gYXR0
cmlidXRlCj4gLSAqIEBpdGVtczoJQXJyYXkgb2Ygc3RyaW5ncwo+IC0gKiBAbnVtX2l0ZW1zOglO
dW1iZXIgb2YgaXRlbXMgc3BlY2lmaWVkIGluIEBpdGVtcwo+IC0gKiBAc2V0OglTZXQgY2FsbGJh
Y2sgZnVuY3Rpb247IG1heSBiZSBOVUxMCj4gLSAqIEBnZXQ6CUdldCBjYWxsYmFjayBmdW5jdGlv
bjsgbWF5IGJlIE5VTEwKPiAtICoKPiAtICogVGhlIGNvdW50ZXJfY291bnRfZW51bV9leHQgc3Ry
dWN0dXJlIGNhbiBiZSB1c2VkIHRvIGltcGxlbWVudCBlbnVtIHN0eWxlCj4gLSAqIENvdW50IGV4
dGVuc2lvbiBhdHRyaWJ1dGVzLiBFbnVtIHN0eWxlIGF0dHJpYnV0ZXMgYXJlIHRob3NlIHdoaWNo
IGhhdmUgYSBzZXQKPiAtICogb2Ygc3RyaW5ncyB0aGF0IG1hcCB0byB1bnNpZ25lZCBpbnRlZ2Vy
IHZhbHVlcy4gVGhlIEdlbmVyaWMgQ291bnRlciBDb3VudAo+IC0gKiBlbnVtIGV4dGVuc2lvbiBo
ZWxwZXIgY29kZSB0YWtlcyBjYXJlIG9mIG1hcHBpbmcgYmV0d2VlbiB2YWx1ZSBhbmQgc3RyaW5n
LCBhcwo+IC0gKiB3ZWxsIGFzIGdlbmVyYXRpbmcgYSAiX2F2YWlsYWJsZSIgZmlsZSB3aGljaCBj
b250YWlucyBhIGxpc3Qgb2YgYWxsIGF2YWlsYWJsZQo+IC0gKiBpdGVtcy4gVGhlIGdldCBjYWxs
YmFjayBpcyB1c2VkIHRvIHF1ZXJ5IHRoZSBjdXJyZW50bHkgYWN0aXZlIGl0ZW07IHRoZSBpbmRl
eAo+IC0gKiBvZiB0aGUgaXRlbSB3aXRoaW4gdGhlIHJlc3BlY3RpdmUgaXRlbXMgYXJyYXkgaXMg
cmV0dXJuZWQgdmlhIHRoZSAnaXRlbScKPiAtICogcGFyYW1ldGVyLiBUaGUgc2V0IGNhbGxiYWNr
IGlzIGNhbGxlZCB3aGVuIHRoZSBhdHRyaWJ1dGUgaXMgdXBkYXRlZDsgdGhlCj4gLSAqICdpdGVt
JyBwYXJhbWV0ZXIgY29udGFpbnMgdGhlIGluZGV4IG9mIHRoZSBuZXdseSBhY3RpdmF0ZWQgaXRl
bSB3aXRoaW4gdGhlCj4gLSAqIHJlc3BlY3RpdmUgaXRlbXMgYXJyYXkuCj4gLSAqLwo+IC1zdHJ1
Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4dCB7Cj4gLQljb25zdCBjaGFyICogY29uc3QgKml0ZW1z
Owo+IC0Jc2l6ZV90IG51bV9pdGVtczsKPiAtCWludCAoKmdldCkoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLCBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJICAgc2l6ZV90
ICppdGVtKTsKPiAtCWludCAoKnNldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJICAgc2l6ZV90IGl0ZW0pOwo+IC19Owo+
IC0KPiAtLyoqCj4gLSAqIENPVU5URVJfQ09VTlRfRU5VTSgpIC0gSW5pdGlhbGl6ZSBDb3VudCBl
bnVtIGV4dGVuc2lvbgo+IC0gKiBAX25hbWU6CUF0dHJpYnV0ZSBuYW1lCj4gLSAqIEBfZToJCVBv
aW50ZXIgdG8gYSBjb3VudGVyX2NvdW50X2VudW1fZXh0IHN0cnVjdHVyZQo+IC0gKgo+IC0gKiBU
aGlzIHNob3VsZCB1c3VhbGx5IGJlIHVzZWQgdG9nZXRoZXIgd2l0aCBDT1VOVEVSX0NPVU5UX0VO
VU1fQVZBSUxBQkxFKCkKPiAtICovCj4gLSNkZWZpbmUgQ09VTlRFUl9DT1VOVF9FTlVNKF9uYW1l
LCBfZSkgXAo+IC17IFwKPiAtCS5uYW1lID0gKF9uYW1lKSwgXAo+IC0JLnJlYWQgPSBjb3VudGVy
X2NvdW50X2VudW1fcmVhZCwgXAo+IC0JLndyaXRlID0gY291bnRlcl9jb3VudF9lbnVtX3dyaXRl
LCBcCj4gLQkucHJpdiA9IChfZSkgXAo+IC19Cj4gLQo+IC0vKioKPiAtICogQ09VTlRFUl9DT1VO
VF9FTlVNX0FWQUlMQUJMRSgpIC0gSW5pdGlhbGl6ZSBDb3VudCBlbnVtIGF2YWlsYWJsZSBleHRl
bnNpb24KPiAtICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZSAoIl9hdmFpbGFibGUiIHdpbGwgYmUg
YXBwZW5kZWQgdG8gdGhlIG5hbWUpCj4gLSAqIEBfZToJCVBvaW50ZXIgdG8gYSBjb3VudGVyX2Nv
dW50X2VudW1fZXh0IHN0cnVjdHVyZQo+IC0gKgo+IC0gKiBDcmVhdGVzIGEgcmVhZCBvbmx5IGF0
dHJpYnV0ZSB0aGF0IGxpc3RzIGFsbCB0aGUgYXZhaWxhYmxlIGVudW0gaXRlbXMgaW4gYQo+IC0g
KiBuZXdsaW5lIHNlcGFyYXRlZCBsaXN0LiBUaGlzIHNob3VsZCB1c3VhbGx5IGJlIHVzZWQgdG9n
ZXRoZXIgd2l0aAo+IC0gKiBDT1VOVEVSX0NPVU5UX0VOVU0oKQo+IC0gKi8KPiAtI2RlZmluZSBD
T1VOVEVSX0NPVU5UX0VOVU1fQVZBSUxBQkxFKF9uYW1lLCBfZSkgXAo+IC17IFwKPiAtCS5uYW1l
ID0gKF9uYW1lICJfYXZhaWxhYmxlIiksIFwKPiAtCS5yZWFkID0gY291bnRlcl9jb3VudF9lbnVt
X2F2YWlsYWJsZV9yZWFkLCBcCj4gLQkucHJpdiA9IChfZSkgXAo+IC19Cj4gLQo+IC0vKioKPiAt
ICogc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgLSBpbnRlcm5hbCBjb250YWluZXIg
Zm9yIGF0dHJpYnV0ZSBncm91cAo+IC0gKiBAYXR0cl9ncm91cDoJQ291bnRlciBzeXNmcyBhdHRy
aWJ1dGVzIGdyb3VwCj4gLSAqIEBhdHRyX2xpc3Q6CWxpc3QgdG8ga2VlcCB0cmFjayBvZiBjcmVh
dGVkIENvdW50ZXIgc3lzZnMgYXR0cmlidXRlcwo+IC0gKiBAbnVtX2F0dHI6CW51bWJlciBvZiBD
b3VudGVyIHN5c2ZzIGF0dHJpYnV0ZXMKPiAtICovCj4gLXN0cnVjdCBjb3VudGVyX2RldmljZV9h
dHRyX2dyb3VwIHsKPiAtCXN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgYXR0cl9ncm91cDsKPiAtCXN0
cnVjdCBsaXN0X2hlYWQgYXR0cl9saXN0Owo+IC0Jc2l6ZV90IG51bV9hdHRyOwo+IC19Owo+IC0K
PiAtLyoqCj4gLSAqIHN0cnVjdCBjb3VudGVyX2RldmljZV9zdGF0ZSAtIGludGVybmFsIHN0YXRl
IGNvbnRhaW5lciBmb3IgYSBDb3VudGVyIGRldmljZQo+IC0gKiBAaWQ6CQkJdW5pcXVlIElEIHVz
ZWQgdG8gaWRlbnRpZnkgdGhlIENvdW50ZXIKPiAtICogQGRldjoJCWludGVybmFsIGRldmljZSBz
dHJ1Y3R1cmUKPiAtICogQGdyb3Vwc19saXN0OglhdHRyaWJ1dGUgZ3JvdXBzIGxpc3QgKGZvciBT
aWduYWxzLCBDb3VudHMsIGFuZCBleHQpCj4gLSAqIEBudW1fZ3JvdXBzOgkJbnVtYmVyIG9mIGF0
dHJpYnV0ZSBncm91cHMgY29udGFpbmVycwo+IC0gKiBAZ3JvdXBzOgkJQ291bnRlciBzeXNmcyBh
dHRyaWJ1dGUgZ3JvdXBzICh0byBwb3B1bGF0ZSBAZGV2Lmdyb3VwcykKPiAtICovCj4gLXN0cnVj
dCBjb3VudGVyX2RldmljZV9zdGF0ZSB7Cj4gLQlpbnQgaWQ7Cj4gLQlzdHJ1Y3QgZGV2aWNlIGRl
djsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpncm91cHNfbGlzdDsKPiAt
CXNpemVfdCBudW1fZ3JvdXBzOwo+IC0JY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqKmdy
b3VwczsKPiAtfTsKPiAtCj4gLWVudW0gY291bnRlcl9zaWduYWxfbGV2ZWwgewo+IC0JQ09VTlRF
Ul9TSUdOQUxfTEVWRUxfTE9XLAo+IC0JQ09VTlRFUl9TSUdOQUxfTEVWRUxfSElHSCwKPiAgfTsK
PiAgCj4gIC8qKgo+IEBAIC0zMDYsMTE3ICsyNTIsNDcgQEAgZW51bSBjb3VudGVyX3NpZ25hbF9s
ZXZlbCB7Cj4gICAqIEBjb3VudF93cml0ZToJb3B0aW9uYWwgd3JpdGUgY2FsbGJhY2sgZm9yIENv
dW50IGF0dHJpYnV0ZS4gVGhlIHdyaXRlCj4gICAqCQkJdmFsdWUgZm9yIHRoZSByZXNwZWN0aXZl
IENvdW50IGlzIHBhc3NlZCBpbiB2aWEgdGhlIHZhbAo+ICAgKgkJCXBhcmFtZXRlci4KPiAtICog
QGZ1bmN0aW9uX2dldDoJZnVuY3Rpb24gdG8gZ2V0IHRoZSBjdXJyZW50IGNvdW50IGZ1bmN0aW9u
IG1vZGUuIFJldHVybnMKPiAtICoJCQkwIG9uIHN1Y2Nlc3MgYW5kIG5lZ2F0aXZlIGVycm9yIGNv
ZGUgb24gZXJyb3IuIFRoZSBpbmRleAo+IC0gKgkJCW9mIHRoZSByZXNwZWN0aXZlIENvdW50J3Mg
cmV0dXJuZWQgZnVuY3Rpb24gbW9kZSBzaG91bGQKPiAtICoJCQliZSBwYXNzZWQgYmFjayB2aWEg
dGhlIGZ1bmN0aW9uIHBhcmFtZXRlci4KPiAtICogQGZ1bmN0aW9uX3NldDoJZnVuY3Rpb24gdG8g
c2V0IHRoZSBjb3VudCBmdW5jdGlvbiBtb2RlLiBmdW5jdGlvbiBpcyB0aGUKPiAtICoJCQlpbmRl
eCBvZiB0aGUgcmVxdWVzdGVkIGZ1bmN0aW9uIG1vZGUgZnJvbSB0aGUgcmVzcGVjdGl2ZQo+IC0g
KgkJCUNvdW50J3MgZnVuY3Rpb25zX2xpc3QgYXJyYXkuCj4gLSAqIEBhY3Rpb25fZ2V0OgkJZnVu
Y3Rpb24gdG8gZ2V0IHRoZSBjdXJyZW50IGFjdGlvbiBtb2RlLiBSZXR1cm5zIDAgb24KPiAtICoJ
CQlzdWNjZXNzIGFuZCBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGVycm9yLiBUaGUgaW5kZXggb2YK
PiAtICoJCQl0aGUgcmVzcGVjdGl2ZSBTeW5hcHNlJ3MgcmV0dXJuZWQgYWN0aW9uIG1vZGUgc2hv
dWxkIGJlCj4gLSAqCQkJcGFzc2VkIGJhY2sgdmlhIHRoZSBhY3Rpb24gcGFyYW1ldGVyLgo+IC0g
KiBAYWN0aW9uX3NldDoJCWZ1bmN0aW9uIHRvIHNldCB0aGUgYWN0aW9uIG1vZGUuIGFjdGlvbiBp
cyB0aGUgaW5kZXggb2YKPiAtICoJCQl0aGUgcmVxdWVzdGVkIGFjdGlvbiBtb2RlIGZyb20gdGhl
IHJlc3BlY3RpdmUgU3luYXBzZSdzCj4gLSAqCQkJYWN0aW9uc19saXN0IGFycmF5Lgo+ICsgKiBA
ZnVuY3Rpb25fcmVhZDoJcmVhZCBjYWxsYmFjayB0aGUgQ291bnQgZnVuY3Rpb24gbW9kZXMuIFRo
ZSByZWFkCj4gKyAqCQkJZnVuY3Rpb24gbW9kZSBvZiB0aGUgcmVzcGVjdGl2ZSBDb3VudCBzaG91
bGQgYmUgcGFzc2VkCj4gKyAqCQkJYmFjayB2aWEgdGhlIGZ1bmN0aW9uIHBhcmFtZXRlci4KPiAr
ICogQGZ1bmN0aW9uX3dyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3IgQ291bnQgZnVuY3Rpb24gbW9k
ZXMuIFRoZSBmdW5jdGlvbgo+ICsgKgkJCW1vZGUgdG8gd3JpdGUgZm9yIHRoZSByZXNwZWN0aXZl
IENvdW50IGlzIHBhc3NlZCBpbiB2aWEKPiArICoJCQl0aGUgZnVuY3Rpb24gcGFyYW1ldGVyLgo+
ICsgKiBAYWN0aW9uX3JlYWQ6CXJlYWQgY2FsbGJhY2sgdGhlIFN5bmFwc2UgYWN0aW9uIG1vZGVz
LiBUaGUgcmVhZCBhY3Rpb24KPiArICoJCQltb2RlIG9mIHRoZSByZXNwZWN0aXZlIFN5bmFwc2Ug
c2hvdWxkIGJlIHBhc3NlZCBiYWNrIHZpYQo+ICsgKgkJCXRoZSBhY3Rpb24gcGFyYW1ldGVyLgo+
ICsgKiBAYWN0aW9uX3dyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3IgU3luYXBzZSBhY3Rpb24gbW9k
ZXMuIFRoZSBhY3Rpb24gbW9kZQo+ICsgKgkJCXRvIHdyaXRlIGZvciB0aGUgcmVzcGVjdGl2ZSBT
eW5hcHNlIGlzIHBhc3NlZCBpbiB2aWEgdGhlCj4gKyAqCQkJYWN0aW9uIHBhcmFtZXRlci4KPiAg
ICovCj4gIHN0cnVjdCBjb3VudGVyX29wcyB7Cj4gIAlpbnQgKCpzaWduYWxfcmVhZCkoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJCQkgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwg
KnNpZ25hbCwKPiAgCQkJICAgZW51bSBjb3VudGVyX3NpZ25hbF9sZXZlbCAqbGV2ZWwpOwo+ICAJ
aW50ICgqY291bnRfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyAqdmFsKTsKPiArCQkJ
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsdWUpOwo+ICAJaW50ICgqY291
bnRfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nIHZhbCk7Cj4gLQlpbnQgKCpmdW5j
dGlvbl9nZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90ICpmdW5jdGlvbik7Cj4gLQlpbnQgKCpmdW5j
dGlvbl9zZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90IGZ1bmN0aW9uKTsKPiAtCWludCAoKmFjdGlv
bl9nZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCSAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBz
ZSwgc2l6ZV90ICphY3Rpb24pOwo+IC0JaW50ICgqYWN0aW9uX3NldCkoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+IC0JCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAt
CQkJICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLCBzaXplX3QgYWN0aW9uKTsKPiAt
fTsKPiAtCj4gLS8qKgo+IC0gKiBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZXh0IC0gQ291bnRlciBk
ZXZpY2UgZXh0ZW5zaW9uCj4gLSAqIEBuYW1lOglhdHRyaWJ1dGUgbmFtZQo+IC0gKiBAcmVhZDoJ
cmVhZCBjYWxsYmFjayBmb3IgdGhpcyBhdHRyaWJ1dGU7IG1heSBiZSBOVUxMCj4gLSAqIEB3cml0
ZToJd3JpdGUgY2FsbGJhY2sgZm9yIHRoaXMgYXR0cmlidXRlOyBtYXkgYmUgTlVMTAo+IC0gKiBA
cHJpdjoJZGF0YSBwcml2YXRlIHRvIHRoZSBkcml2ZXIKPiAtICovCj4gLXN0cnVjdCBjb3VudGVy
X2RldmljZV9leHQgewo+IC0JY29uc3QgY2hhciAqbmFtZTsKPiAtCXNzaXplX3QgKCpyZWFkKShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHZvaWQgKnByaXYsIGNoYXIgKmJ1Zik7Cj4g
LQlzc2l6ZV90ICgqd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdm9pZCAq
cHJpdiwKPiAtCQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7Cj4gLQl2b2lkICpwcml2
Owo+ICsJCQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCB2YWx1ZSk7Cj4gKwlp
bnQgKCpmdW5jdGlvbl9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJ
CSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkgICAgIGVudW0gY291bnRl
cl9mdW5jdGlvbiAqZnVuY3Rpb24pOwo+ICsJaW50ICgqZnVuY3Rpb25fd3JpdGUpKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LAo+ICsJCQkgICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb24pOwo+ICsJ
aW50ICgqYWN0aW9uX3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJ
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkgICBzdHJ1Y3QgY291bnRlcl9z
eW5hcHNlICpzeW5hcHNlLAo+ICsJCQkgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFj
dGlvbik7Cj4gKwlpbnQgKCphY3Rpb25fd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiArCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJICAgIHN0
cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gKwkJCSAgICBlbnVtIGNvdW50ZXJfc3lu
YXBzZV9hY3Rpb24gYWN0aW9uKTsKPiAgfTsKPiAgCj4gLS8qKgo+IC0gKiBzdHJ1Y3QgY291bnRl
cl9kZXZpY2VfZW51bV9leHQgLSBDb3VudGVyIGVudW0gZXh0ZW5zaW9uIGF0dHJpYnV0ZQo+IC0g
KiBAaXRlbXM6CUFycmF5IG9mIHN0cmluZ3MKPiAtICogQG51bV9pdGVtczoJTnVtYmVyIG9mIGl0
ZW1zIHNwZWNpZmllZCBpbiBAaXRlbXMKPiAtICogQHNldDoJU2V0IGNhbGxiYWNrIGZ1bmN0aW9u
OyBtYXkgYmUgTlVMTAo+IC0gKiBAZ2V0OglHZXQgY2FsbGJhY2sgZnVuY3Rpb247IG1heSBiZSBO
VUxMCj4gLSAqCj4gLSAqIFRoZSBjb3VudGVyX2RldmljZV9lbnVtX2V4dCBzdHJ1Y3R1cmUgY2Fu
IGJlIHVzZWQgdG8gaW1wbGVtZW50IGVudW0gc3R5bGUKPiAtICogQ291bnRlciBleHRlbnNpb24g
YXR0cmlidXRlcy4gRW51bSBzdHlsZSBhdHRyaWJ1dGVzIGFyZSB0aG9zZSB3aGljaCBoYXZlIGEK
PiAtICogc2V0IG9mIHN0cmluZ3MgdGhhdCBtYXAgdG8gdW5zaWduZWQgaW50ZWdlciB2YWx1ZXMu
IFRoZSBHZW5lcmljIENvdW50ZXIgZW51bQo+IC0gKiBleHRlbnNpb24gaGVscGVyIGNvZGUgdGFr
ZXMgY2FyZSBvZiBtYXBwaW5nIGJldHdlZW4gdmFsdWUgYW5kIHN0cmluZywgYXMgd2VsbAo+IC0g
KiBhcyBnZW5lcmF0aW5nIGEgIl9hdmFpbGFibGUiIGZpbGUgd2hpY2ggY29udGFpbnMgYSBsaXN0
IG9mIGFsbCBhdmFpbGFibGUKPiAtICogaXRlbXMuIFRoZSBnZXQgY2FsbGJhY2sgaXMgdXNlZCB0
byBxdWVyeSB0aGUgY3VycmVudGx5IGFjdGl2ZSBpdGVtOyB0aGUgaW5kZXgKPiAtICogb2YgdGhl
IGl0ZW0gd2l0aGluIHRoZSByZXNwZWN0aXZlIGl0ZW1zIGFycmF5IGlzIHJldHVybmVkIHZpYSB0
aGUgJ2l0ZW0nCj4gLSAqIHBhcmFtZXRlci4gVGhlIHNldCBjYWxsYmFjayBpcyBjYWxsZWQgd2hl
biB0aGUgYXR0cmlidXRlIGlzIHVwZGF0ZWQ7IHRoZQo+IC0gKiAnaXRlbScgcGFyYW1ldGVyIGNv
bnRhaW5zIHRoZSBpbmRleCBvZiB0aGUgbmV3bHkgYWN0aXZhdGVkIGl0ZW0gd2l0aGluIHRoZQo+
IC0gKiByZXNwZWN0aXZlIGl0ZW1zIGFycmF5Lgo+IC0gKi8KPiAtc3RydWN0IGNvdW50ZXJfZGV2
aWNlX2VudW1fZXh0IHsKPiAtCWNvbnN0IGNoYXIgKiBjb25zdCAqaXRlbXM7Cj4gLQlzaXplX3Qg
bnVtX2l0ZW1zOwo+IC0JaW50ICgqZ2V0KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
IHNpemVfdCAqaXRlbSk7Cj4gLQlpbnQgKCpzZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwgc2l6ZV90IGl0ZW0pOwo+IC19Owo+IC0KPiAtLyoqCj4gLSAqIENPVU5URVJfREVWSUNF
X0VOVU0oKSAtIEluaXRpYWxpemUgQ291bnRlciBlbnVtIGV4dGVuc2lvbgo+IC0gKiBAX25hbWU6
CUF0dHJpYnV0ZSBuYW1lCj4gLSAqIEBfZToJCVBvaW50ZXIgdG8gYSBjb3VudGVyX2RldmljZV9l
bnVtX2V4dCBzdHJ1Y3R1cmUKPiAtICoKPiAtICogVGhpcyBzaG91bGQgdXN1YWxseSBiZSB1c2Vk
IHRvZ2V0aGVyIHdpdGggQ09VTlRFUl9ERVZJQ0VfRU5VTV9BVkFJTEFCTEUoKQo+IC0gKi8KPiAt
I2RlZmluZSBDT1VOVEVSX0RFVklDRV9FTlVNKF9uYW1lLCBfZSkgXAo+IC17IFwKPiAtCS5uYW1l
ID0gKF9uYW1lKSwgXAo+IC0JLnJlYWQgPSBjb3VudGVyX2RldmljZV9lbnVtX3JlYWQsIFwKPiAt
CS53cml0ZSA9IGNvdW50ZXJfZGV2aWNlX2VudW1fd3JpdGUsIFwKPiAtCS5wcml2ID0gKF9lKSBc
Cj4gLX0KPiAtCj4gLS8qKgo+IC0gKiBDT1VOVEVSX0RFVklDRV9FTlVNX0FWQUlMQUJMRSgpIC0g
SW5pdGlhbGl6ZSBDb3VudGVyIGVudW0gYXZhaWxhYmxlIGV4dGVuc2lvbgo+IC0gKiBAX25hbWU6
CUF0dHJpYnV0ZSBuYW1lICgiX2F2YWlsYWJsZSIgd2lsbCBiZSBhcHBlbmRlZCB0byB0aGUgbmFt
ZSkKPiAtICogQF9lOgkJUG9pbnRlciB0byBhIGNvdW50ZXJfZGV2aWNlX2VudW1fZXh0IHN0cnVj
dHVyZQo+IC0gKgo+IC0gKiBDcmVhdGVzIGEgcmVhZCBvbmx5IGF0dHJpYnV0ZSB0aGF0IGxpc3Rz
IGFsbCB0aGUgYXZhaWxhYmxlIGVudW0gaXRlbXMgaW4gYQo+IC0gKiBuZXdsaW5lIHNlcGFyYXRl
ZCBsaXN0LiBUaGlzIHNob3VsZCB1c3VhbGx5IGJlIHVzZWQgdG9nZXRoZXIgd2l0aAo+IC0gKiBD
T1VOVEVSX0RFVklDRV9FTlVNKCkKPiAtICovCj4gLSNkZWZpbmUgQ09VTlRFUl9ERVZJQ0VfRU5V
TV9BVkFJTEFCTEUoX25hbWUsIF9lKSBcCj4gLXsgXAo+IC0JLm5hbWUgPSAoX25hbWUgIl9hdmFp
bGFibGUiKSwgXAo+IC0JLnJlYWQgPSBjb3VudGVyX2RldmljZV9lbnVtX2F2YWlsYWJsZV9yZWFk
LCBcCj4gLQkucHJpdiA9IChfZSkgXAo+IC19Cj4gLQo+ICAvKioKPiAgICogc3RydWN0IGNvdW50
ZXJfZGV2aWNlIC0gQ291bnRlciBkYXRhIHN0cnVjdHVyZQo+ICAgKiBAbmFtZToJCW5hbWUgb2Yg
dGhlIGRldmljZSBhcyBpdCBhcHBlYXJzIGluIHRoZSBkYXRhc2hlZXQKPiAgICogQHBhcmVudDoJ
CW9wdGlvbmFsIHBhcmVudCBkZXZpY2UgcHJvdmlkaW5nIHRoZSBjb3VudGVycwo+IC0gKiBAZGV2
aWNlX3N0YXRlOglpbnRlcm5hbCBkZXZpY2Ugc3RhdGUgY29udGFpbmVyCj4gICAqIEBvcHM6CQlj
YWxsYmFja3MgZnJvbSBkcml2ZXIKPiAgICogQHNpZ25hbHM6CQlhcnJheSBvZiBTaWduYWxzCj4g
ICAqIEBudW1fc2lnbmFsczoJbnVtYmVyIG9mIFNpZ25hbHMgc3BlY2lmaWVkIGluIEBzaWduYWxz
Cj4gQEAgLTQyNSwxMSArMzAxLDExIEBAIHN0cnVjdCBjb3VudGVyX2RldmljZV9lbnVtX2V4dCB7
Cj4gICAqIEBleHQ6CQlvcHRpb25hbCBhcnJheSBvZiBDb3VudGVyIGRldmljZSBleHRlbnNpb25z
Cj4gICAqIEBudW1fZXh0OgkJbnVtYmVyIG9mIENvdW50ZXIgZGV2aWNlIGV4dGVuc2lvbnMgc3Bl
Y2lmaWVkIGluIEBleHQKPiAgICogQHByaXY6CQlvcHRpb25hbCBwcml2YXRlIGRhdGEgc3VwcGxp
ZWQgYnkgZHJpdmVyCj4gKyAqIEBkZXY6CQlpbnRlcm5hbCBkZXZpY2Ugc3RydWN0dXJlCj4gICAq
Lwo+ICBzdHJ1Y3QgY291bnRlcl9kZXZpY2Ugewo+ICAJY29uc3QgY2hhciAqbmFtZTsKPiAgCXN0
cnVjdCBkZXZpY2UgKnBhcmVudDsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9zdGF0ZSAqZGV2
aWNlX3N0YXRlOwo+ICAKPiAgCWNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyAqb3BzOwo+ICAKPiBA
QCAtNDM4LDE3ICszMTQsMTU5IEBAIHN0cnVjdCBjb3VudGVyX2RldmljZSB7Cj4gIAlzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnRzOwo+ICAJc2l6ZV90IG51bV9jb3VudHM7Cj4gIAo+IC0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4dCAqZXh0Owo+ICsJc3RydWN0IGNvdW50ZXJfY29t
cCAqZXh0Owo+ICAJc2l6ZV90IG51bV9leHQ7Cj4gIAo+ICAJdm9pZCAqcHJpdjsKPiArCj4gKwlz
dHJ1Y3QgZGV2aWNlIGRldjsKPiAgfTsKPiAgCj4gIGludCBjb3VudGVyX3JlZ2lzdGVyKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcik7Cj4gIHZvaWQgY291bnRlcl91bnJlZ2lz
dGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcik7Cj4gIGludCBkZXZtX2Nv
dW50ZXJfcmVnaXN0ZXIoc3RydWN0IGRldmljZSAqZGV2LAo+ICAJCQkgIHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY29uc3QgY291bnRlcik7Cj4gLXZvaWQgZGV2bV9jb3VudGVyX3VucmVnaXN0ZXIo
c3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29u
c3QgY291bnRlcik7Cj4gKwo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9ERVZJQ0VfVTgoX25hbWUs
IF9yZWFkLCBfd3JpdGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9VOCwgXAo+
ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gKwkuZGV2aWNlX3U4X3JlYWQgPSAoX3JlYWQpLCBcCj4g
KwkuZGV2aWNlX3U4X3dyaXRlID0gKF93cml0ZSksIFwKPiArfQo+ICsjZGVmaW5lIENPVU5URVJf
Q09NUF9DT1VOVF9VOChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ICt7IFwKPiArCS50eXBlID0g
Q09VTlRFUl9DT01QX1U4LCBcCj4gKwkubmFtZSA9IChfbmFtZSksIFwKPiArCS5jb3VudF91OF9y
ZWFkID0gKF9yZWFkKSwgXAo+ICsJLmNvdW50X3U4X3dyaXRlID0gKF93cml0ZSksIFwKPiArfQo+
ICsjZGVmaW5lIENPVU5URVJfQ09NUF9TSUdOQUxfVTgoX25hbWUsIF9yZWFkLCBfd3JpdGUpIFwK
PiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9VOCwgXAo+ICsJLm5hbWUgPSAoX25hbWUp
LCBcCj4gKwkuc2lnbmFsX3U4X3JlYWQgPSAoX3JlYWQpLCBcCj4gKwkuc2lnbmFsX3U4X3dyaXRl
ID0gKF93cml0ZSksIFwKPiArfQo+ICsKPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfREVWSUNFX1U2
NChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ICt7IFwKPiArCS50eXBlID0gQ09VTlRFUl9DT01Q
X1U2NCwgXAo+ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gKwkuZGV2aWNlX3U2NF9yZWFkID0gKF9y
ZWFkKSwgXAo+ICsJLmRldmljZV91NjRfd3JpdGUgPSAoX3dyaXRlKSwgXAo+ICt9Cj4gKyNkZWZp
bmUgQ09VTlRFUl9DT01QX0NPVU5UX1U2NChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ICt7IFwK
PiArCS50eXBlID0gQ09VTlRFUl9DT01QX1U2NCwgXAo+ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4g
KwkuY291bnRfdTY0X3JlYWQgPSAoX3JlYWQpLCBcCj4gKwkuY291bnRfdTY0X3dyaXRlID0gKF93
cml0ZSksIFwKPiArfQo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9TSUdOQUxfVTY0KF9uYW1lLCBf
cmVhZCwgX3dyaXRlKSBcCj4gK3sgXAo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfVTY0LCBcCj4g
KwkubmFtZSA9IChfbmFtZSksIFwKPiArCS5zaWduYWxfdTY0X3JlYWQgPSAoX3JlYWQpLCBcCj4g
Kwkuc2lnbmFsX3U2NF93cml0ZSA9IChfd3JpdGUpLCBcCj4gK30KPiArCj4gKyNkZWZpbmUgQ09V
TlRFUl9DT01QX0RFVklDRV9CT09MKF9uYW1lLCBfcmVhZCwgX3dyaXRlKSBcCj4gK3sgXAo+ICsJ
LnR5cGUgPSBDT1VOVEVSX0NPTVBfQk9PTCwgXAo+ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gKwku
ZGV2aWNlX3U4X3JlYWQgPSAoX3JlYWQpLCBcCj4gKwkuZGV2aWNlX3U4X3dyaXRlID0gKF93cml0
ZSksIFwKPiArfQo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9DT1VOVF9CT09MKF9uYW1lLCBfcmVh
ZCwgX3dyaXRlKSBcCj4gK3sgXAo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfQk9PTCwgXAo+ICsJ
Lm5hbWUgPSAoX25hbWUpLCBcCj4gKwkuY291bnRfdThfcmVhZCA9IChfcmVhZCksIFwKPiArCS5j
b3VudF91OF93cml0ZSA9IChfd3JpdGUpLCBcCj4gK30KPiArI2RlZmluZSBDT1VOVEVSX0NPTVBf
U0lHTkFMX0JPT0woX25hbWUsIF9yZWFkLCBfd3JpdGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENP
VU5URVJfQ09NUF9CT09MLCBcCj4gKwkubmFtZSA9IChfbmFtZSksIFwKPiArCS5zaWduYWxfdThf
cmVhZCA9IChfcmVhZCksIFwKPiArCS5zaWduYWxfdThfd3JpdGUgPSAoX3dyaXRlKSwgXAo+ICt9
Cj4gKwo+ICtzdHJ1Y3QgY291bnRlcl9hdmFpbGFibGUgewo+ICsJdW5pb24gewo+ICsJCWNvbnN0
IHUzMiAqZW51bXM7Cj4gKwkJY29uc3QgY2hhciAqY29uc3QgKnN0cnM7Cj4gKwl9Owo+ICsJc2l6
ZV90IG51bV9pdGVtczsKPiArfTsKPiArCj4gKyNkZWZpbmUgREVGSU5FX0NPVU5URVJfQVZBSUxB
QkxFKF9uYW1lLCBfZW51bXMpIFwKPiArCXN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSBfbmFtZSA9
IHsgXAo+ICsJCS5lbnVtcyA9IChfZW51bXMpLCBcCj4gKwkJLm51bV9pdGVtcyA9IEFSUkFZX1NJ
WkUoX2VudW1zKSwgXAo+ICsJfQo+ICsKPiArI2RlZmluZSBERUZJTkVfQ09VTlRFUl9FTlVNKF9u
YW1lLCBfc3RycykgXAo+ICsJc3RydWN0IGNvdW50ZXJfYXZhaWxhYmxlIF9uYW1lID0geyBcCj4g
KwkJLnN0cnMgPSAoX3N0cnMpLCBcCj4gKwkJLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUoX3N0cnMp
LCBcCj4gKwl9Cj4gKwo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9ERVZJQ0VfRU5VTShfbmFtZSwg
X2dldCwgX3NldCwgX2F2YWlsYWJsZSkgXAo+ICt7IFwKPiArCS50eXBlID0gQ09VTlRFUl9DT01Q
X0VOVU0sIFwKPiArCS5uYW1lID0gKF9uYW1lKSwgXAo+ICsJLmRldmljZV91MzJfcmVhZCA9IChf
Z2V0KSwgXAo+ICsJLmRldmljZV91MzJfd3JpdGUgPSAoX3NldCksIFwKPiArCS5wcml2ID0gJihf
YXZhaWxhYmxlKSwgXAo+ICt9Cj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX0NPVU5UX0VOVU0oX25h
bWUsIF9nZXQsIF9zZXQsIF9hdmFpbGFibGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJf
Q09NUF9FTlVNLCBcCj4gKwkubmFtZSA9IChfbmFtZSksIFwKPiArCS5jb3VudF91MzJfcmVhZCA9
IChfZ2V0KSwgXAo+ICsJLmNvdW50X3UzMl93cml0ZSA9IChfc2V0KSwgXAo+ICsJLnByaXYgPSAm
KF9hdmFpbGFibGUpLCBcCj4gK30KPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfU0lHTkFMX0VOVU0o
X25hbWUsIF9nZXQsIF9zZXQsIF9hdmFpbGFibGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5U
RVJfQ09NUF9FTlVNLCBcCj4gKwkubmFtZSA9IChfbmFtZSksIFwKPiArCS5zaWduYWxfdTMyX3Jl
YWQgPSAoX2dldCksIFwKPiArCS5zaWduYWxfdTMyX3dyaXRlID0gKF9zZXQpLCBcCj4gKwkucHJp
diA9ICYoX2F2YWlsYWJsZSksIFwKPiArfQo+ICsKPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfQ0VJ
TElORyhfcmVhZCwgX3dyaXRlKSBcCj4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfVTY0KCJjZWlsaW5n
IiwgX3JlYWQsIF93cml0ZSkKPiArCj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX0NPVU5UX01PREUo
X3JlYWQsIF93cml0ZSwgX2F2YWlsYWJsZSkgXAo+ICt7IFwKPiArCS50eXBlID0gQ09VTlRFUl9D
T01QX0NPVU5UX01PREUsIFwKPiArCS5uYW1lID0gImNvdW50X21vZGUiLCBcCj4gKwkuY291bnRf
dTMyX3JlYWQgPSAoX3JlYWQpLCBcCj4gKwkuY291bnRfdTMyX3dyaXRlID0gKF93cml0ZSksIFwK
PiArCS5wcml2ID0gJihfYXZhaWxhYmxlKSwgXAo+ICt9Cj4gKwo+ICsjZGVmaW5lIENPVU5URVJf
Q09NUF9ESVJFQ1RJT04oX3JlYWQpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9D
T1VOVF9ESVJFQ1RJT04sIFwKPiArCS5uYW1lID0gImRpcmVjdGlvbiIsIFwKPiArCS5jb3VudF91
MzJfcmVhZCA9IChfcmVhZCksIFwKPiArfQo+ICsKPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfRU5B
QkxFKF9yZWFkLCBfd3JpdGUpIFwKPiArCUNPVU5URVJfQ09NUF9DT1VOVF9CT09MKCJlbmFibGUi
LCBfcmVhZCwgX3dyaXRlKQo+ICsKPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfRkxPT1IoX3JlYWQs
IF93cml0ZSkgXAo+ICsJQ09VTlRFUl9DT01QX0NPVU5UX1U2NCgiZmxvb3IiLCBfcmVhZCwgX3dy
aXRlKQo+ICsKPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfUFJFU0VUKF9yZWFkLCBfd3JpdGUpIFwK
PiArCUNPVU5URVJfQ09NUF9DT1VOVF9VNjQoInByZXNldCIsIF9yZWFkLCBfd3JpdGUpCj4gKwo+
ICsjZGVmaW5lIENPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKF9yZWFkLCBfd3JpdGUpIFwKPiAr
CUNPVU5URVJfQ09NUF9DT1VOVF9CT09MKCJwcmVzZXRfZW5hYmxlIiwgX3JlYWQsIF93cml0ZSkK
PiAgCj4gICNlbmRpZiAvKiBfQ09VTlRFUl9IXyAqLwo+IGRpZmYgLS1naXQgYS9pbmNsdWRlL2xp
bnV4L2NvdW50ZXJfZW51bS5oIGIvaW5jbHVkZS9saW51eC9jb3VudGVyX2VudW0uaAo+IGRlbGV0
ZWQgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDlmOTE3Mjk4YTg4Zi4uMDAwMDAwMDAwMDAwCj4g
LS0tIGEvaW5jbHVkZS9saW51eC9jb3VudGVyX2VudW0uaAo+ICsrKyAvZGV2L251bGwKPiBAQCAt
MSw0NSArMCwwIEBACj4gLS8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovCj4g
LS8qCj4gLSAqIENvdW50ZXIgaW50ZXJmYWNlIGVudW0gZnVuY3Rpb25zCj4gLSAqIENvcHlyaWdo
dCAoQykgMjAxOCBXaWxsaWFtIEJyZWF0aGl0dCBHcmF5Cj4gLSAqLwo+IC0jaWZuZGVmIF9DT1VO
VEVSX0VOVU1fSF8KPiAtI2RlZmluZSBfQ09VTlRFUl9FTlVNX0hfCj4gLQo+IC0jaW5jbHVkZSA8
bGludXgvdHlwZXMuaD4KPiAtCj4gLXN0cnVjdCBjb3VudGVyX2RldmljZTsKPiAtc3RydWN0IGNv
dW50ZXJfc2lnbmFsOwo+IC1zdHJ1Y3QgY291bnRlcl9jb3VudDsKPiAtCj4gLXNzaXplX3QgY291
bnRlcl9zaWduYWxfZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAt
CQkJCSBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdiwKPiAtCQkJCSBj
aGFyICpidWYpOwo+IC1zc2l6ZV90IGNvdW50ZXJfc2lnbmFsX2VudW1fd3JpdGUoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNp
Z25hbCwgdm9pZCAqcHJpdiwKPiAtCQkJCSAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKTsK
PiAtCj4gLXNzaXplX3QgY291bnRlcl9zaWduYWxfZW51bV9hdmFpbGFibGVfcmVhZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJICAgc3RydWN0IGNvdW50ZXJfc2lnbmFs
ICpzaWduYWwsCj4gLQkJCQkJICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKTsKPiAtCj4gLXNzaXpl
X3QgY291bnRlcl9jb3VudF9lbnVtX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+IC0JCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2LAo+IC0JCQkJ
Y2hhciAqYnVmKTsKPiAtc3NpemVfdCBjb3VudGVyX2NvdW50X2VudW1fd3JpdGUoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgdm9pZCAqcHJpdiwKPiAtCQkJCSBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pOwo+IC0K
PiAtc3NpemVfdCBjb3VudGVyX2NvdW50X2VudW1fYXZhaWxhYmxlX3JlYWQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+IC0JCQkJCSAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKTsKPiAtCj4gLXNzaXplX3QgY291bnRl
cl9kZXZpY2VfZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdm9pZCAq
cHJpdiwKPiAtCQkJCSBjaGFyICpidWYpOwo+IC1zc2l6ZV90IGNvdW50ZXJfZGV2aWNlX2VudW1f
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LAo+IC0JCQkJ
ICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pOwo+IC0KPiAtc3NpemVfdCBjb3VudGVyX2Rl
dmljZV9lbnVtX2F2YWlsYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAtCQkJCQkgICB2b2lkICpwcml2LCBjaGFyICpidWYpOwo+IC0KPiAtI2VuZGlmIC8qIF9DT1VO
VEVSX0VOVU1fSF8gKi8KCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCkxpbnV4LXN0bTMyIG1haWxpbmcgbGlzdApMaW51eC1zdG0zMkBzdC1tZC1tYWlsbWFu
LnN0b3JtcmVwbHkuY29tCmh0dHBzOi8vc3QtbWQtbWFpbG1hbi5zdG9ybXJlcGx5LmNvbS9tYWls
bWFuL2xpc3RpbmZvL2xpbnV4LXN0bTMyCg==
