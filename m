Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 514FB40503E
	for <lists+linux-stm32@lfdr.de>; Thu,  9 Sep 2021 14:38:10 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 08D4AC5A4D8;
	Thu,  9 Sep 2021 12:38:10 +0000 (UTC)
Received: from mail.kernel.org (mail.kernel.org [198.145.29.99])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 07642C57B53
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Wed,  8 Sep 2021 17:41:25 +0000 (UTC)
Received: from jic23-huawei (cpc108967-cmbg20-2-0-cust86.5-4.cable.virginm.net
 [81.101.6.87])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by mail.kernel.org (Postfix) with ESMTPSA id 7673D6105A;
 Wed,  8 Sep 2021 17:41:17 +0000 (UTC)
Date: Wed, 8 Sep 2021 18:44:46 +0100
From: Jonathan Cameron <jic23@kernel.org>
To: Fabrice Gasnier <fabrice.gasnier@foss.st.com>
Message-ID: <20210908184446.2f783b3b@jic23-huawei>
In-Reply-To: <fcff44a7-5ac2-a510-ee9b-85ef7e2e29ef@foss.st.com>
References: <cover.1630031207.git.vilhelm.gray@gmail.com>
 <c68b4a1ffb195c1a2f65e8dd5ad7b7c14e79c6ef.1630031207.git.vilhelm.gray@gmail.com>
 <fcff44a7-5ac2-a510-ee9b-85ef7e2e29ef@foss.st.com>
X-Mailer: Claws Mail 4.0.0 (GTK+ 3.24.30; x86_64-pc-linux-gnu)
MIME-Version: 1.0
X-Mailman-Approved-At: Thu, 09 Sep 2021 12:38:08 +0000
Cc: kamel.bouhara@bootlin.com, gwendal@chromium.org, david@lechnology.com,
 alexandre.belloni@bootlin.com, linux-iio@vger.kernel.org,
 patrick.havelange@essensium.com, linux-stm32@st-md-mailman.stormreply.com,
 William Breathitt Gray <vilhelm.gray@gmail.com>, linux-kernel@vger.kernel.org,
 o.rempel@pengutronix.de, jarkko.nikula@linux.intel.com,
 linux-arm-kernel@lists.infradead.org, mcoquelin.stm32@gmail.com,
 fabrice.gasnier@st.com, syednwaris@gmail.com, kernel@pengutronix.de,
 Dan Carpenter <dan.carpenter@oracle.com>, alexandre.torgue@st.com
Subject: Re: [Linux-stm32] [PATCH v16 03/14] counter: Internalize sysfs
 interface code
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

T24gVHVlLCAzMSBBdWcgMjAyMSAxNTo0NDowNCArMDIwMApGYWJyaWNlIEdhc25pZXIgPGZhYnJp
Y2UuZ2FzbmllckBmb3NzLnN0LmNvbT4gd3JvdGU6Cgo+IE9uIDgvMjcvMjEgNTo0NyBBTSwgV2ls
bGlhbSBCcmVhdGhpdHQgR3JheSB3cm90ZToKPiA+IFRoaXMgaXMgYSByZWltcGxlbWVudGF0aW9u
IG9mIHRoZSBHZW5lcmljIENvdW50ZXIgZHJpdmVyIGludGVyZmFjZS4KPiA+IFRoZXJlIGFyZSBu
byBtb2RpZmljYXRpb25zIHRvIHRoZSBDb3VudGVyIHN1YnN5c3RlbSB1c2Vyc3BhY2UgaW50ZXJm
YWNlLAo+ID4gc28gZXhpc3RpbmcgdXNlcnNwYWNlIGFwcGxpY2F0aW9ucyBzaG91bGQgY29udGlu
dWUgdG8gcnVuIHNlYW1sZXNzbHkuCj4gPiAKPiA+IFRoZSBwdXJwb3NlIG9mIHRoaXMgcGF0Y2gg
aXMgdG8gaW50ZXJuYWxpemUgdGhlIHN5c2ZzIGludGVyZmFjZSBjb2RlCj4gPiBhbW9uZyB0aGUg
dmFyaW91cyBjb3VudGVyIGRyaXZlcnMgaW50byBhIHNoYXJlZCBtb2R1bGUuIENvdW50ZXIgZHJp
dmVycwo+ID4gcGFzcyBhbmQgdGFrZSBkYXRhIG5hdGl2ZWx5IChpLmUuIHU4LCB1NjQsIGV0Yy4p
IGFuZCB0aGUgc2hhcmVkIGNvdW50ZXIKPiA+IG1vZHVsZSBoYW5kbGVzIHRoZSB0cmFuc2xhdGlv
biBiZXR3ZWVuIHRoZSBzeXNmcyBpbnRlcmZhY2UgYW5kIHRoZQo+ID4gZGV2aWNlIGRyaXZlcnMu
IFRoaXMgZ3VhcmFudGVlcyBhIHN0YW5kYXJkIHVzZXJzcGFjZSBpbnRlcmZhY2UgZm9yIGFsbAo+
ID4gY291bnRlciBkcml2ZXJzLCBhbmQgaGVscHMgZ2VuZXJhbGl6ZSB0aGUgR2VuZXJpYyBDb3Vu
dGVyIGRyaXZlciBBQkkgaW4KPiA+IG9yZGVyIHRvIHN1cHBvcnQgdGhlIEdlbmVyaWMgQ291bnRl
ciBjaHJkZXYgaW50ZXJmYWNlIChpbnRyb2R1Y2VkIGluIGEKPiA+IHN1YnNlcXVlbnQgcGF0Y2gp
IHdpdGhvdXQgc2lnbmlmaWNhbnQgY2hhbmdlcyB0byB0aGUgZXhpc3RpbmcgY291bnRlcgo+ID4g
ZHJpdmVycy4KPiA+IAo+ID4gTm90ZSwgQ291bnRlciBkZXZpY2UgcmVnaXN0cmF0aW9uIGlzIHRo
ZSBzYW1lIGFzIGJlZm9yZTogZHJpdmVycwo+ID4gcG9wdWxhdGUgYSBzdHJ1Y3QgY291bnRlcl9k
ZXZpY2Ugd2l0aCBjb21wb25lbnRzIGFuZCBjYWxsYmFja3MsIHRoZW4KPiA+IHBhc3MgdGhlIHN0
cnVjdHVyZSB0byB0aGUgZGV2bV9jb3VudGVyX3JlZ2lzdGVyIGZ1bmN0aW9uLiBIb3dldmVyLAo+
ID4gd2hhdCdzIGRpZmZlcmVudCBub3cgaXMgaG93IHRoZSBDb3VudGVyIHN1YnN5c3RlbSBjb2Rl
IGhhbmRsZXMgdGhpcwo+ID4gcmVnaXN0cmF0aW9uIGludGVybmFsbHkuCj4gPiAKPiA+IFdoZXJl
YXMgYmVmb3JlIGNhbGxiYWNrcyB3b3VsZCBpbnRlcmFjdCBkaXJlY3RseSB3aXRoIHN5c2ZzIGRh
dGEsIHRoaXMKPiA+IGludGVyYWN0aW9uIGlzIG5vdyBhYnN0cmFjdGVkIGFuZCBpbnN0ZWFkIGNh
bGxiYWNrcyBpbnRlcmFjdCB3aXRoIG5hdGl2ZQo+ID4gQyBkYXRhIHR5cGVzLiBUaGUgY291bnRl
cl9jb21wIHN0cnVjdHVyZSBmb3JtcyB0aGUgYmFzaXMgZm9yIENvdW50ZXIKPiA+IGV4dGVuc2lv
bnMuCj4gPiAKPiA+IFRoZSBjb3VudGVyLXN5c2ZzLmMgZmlsZSBjb250YWlucyB0aGUgY29kZSB0
byBwYXJzZSB0aHJvdWdoIHRoZQo+ID4gY291bnRlcl9kZXZpY2Ugc3RydWN0dXJlIGFuZCByZWdp
c3RlciB0aGUgcmVxdWVzdGVkIGNvbXBvbmVudHMgYW5kCj4gPiBleHRlbnNpb25zLiBBdHRyaWJ1
dGVzIGFyZSBjcmVhdGVkIGFuZCBwb3B1bGF0ZWQgYmFzZWQgb24gdHlwZSwgd2l0aAo+ID4gcmVz
cGVjdGl2ZSB0cmFuc2xhdGlvbiBmdW5jdGlvbnMgdG8gaGFuZGxlIHRoZSBtYXBwaW5nIGJldHdl
ZW4gc3lzZnMgYW5kCj4gPiB0aGUgY291bnRlciBkcml2ZXIgY2FsbGJhY2tzLgo+ID4gCj4gPiBU
aGUgdHJhbnNsYXRpb24gcGVyZm9ybWVkIGZvciBlYWNoIGF0dHJpYnV0ZSBpcyBzdHJhaWdodGZv
cndhcmQ6IHRoZQo+ID4gYXR0cmlidXRlIHR5cGUgYW5kIGRhdGEgaXMgcGFyc2VkIGZyb20gdGhl
IGNvdW50ZXJfYXR0cmlidXRlIHN0cnVjdHVyZSwKPiA+IHRoZSByZXNwZWN0aXZlIGNvdW50ZXIg
ZHJpdmVyIHJlYWQvd3JpdGUgY2FsbGJhY2sgaXMgY2FsbGVkLCBhbmQgc3lzZnMKPiA+IEkvTyBp
cyBoYW5kbGVkIGJlZm9yZSBvciBhZnRlciB0aGUgZHJpdmVyIHJlYWQvd3JpdGUgZnVuY3Rpb24g
aXMgY2FsbGVkLgo+ID4gCj4gPiBDYzogSmFya2tvIE5pa3VsYSA8amFya2tvLm5pa3VsYUBsaW51
eC5pbnRlbC5jb20+Cj4gPiBDYzogUGF0cmljayBIYXZlbGFuZ2UgPHBhdHJpY2suaGF2ZWxhbmdl
QGVzc2Vuc2l1bS5jb20+Cj4gPiBDYzogS2FtZWwgQm91aGFyYSA8a2FtZWwuYm91aGFyYUBib290
bGluLmNvbT4KPiA+IENjOiBGYWJyaWNlIEdhc25pZXIgPGZhYnJpY2UuZ2FzbmllckBzdC5jb20+
Cj4gPiBDYzogTWF4aW1lIENvcXVlbGluIDxtY29xdWVsaW4uc3RtMzJAZ21haWwuY29tPgo+ID4g
Q2M6IEFsZXhhbmRyZSBUb3JndWUgPGFsZXhhbmRyZS50b3JndWVAc3QuY29tPgo+ID4gQ2M6IERh
biBDYXJwZW50ZXIgPGRhbi5jYXJwZW50ZXJAb3JhY2xlLmNvbT4KPiA+IEFja2VkLWJ5OiBTeWVk
IE5heXlhciBXYXJpcyA8c3llZG53YXJpc0BnbWFpbC5jb20+Cj4gPiBSZXZpZXdlZC1ieTogRGF2
aWQgTGVjaG5lciA8ZGF2aWRAbGVjaG5vbG9neS5jb20+Cj4gPiBUZXN0ZWQtYnk6IERhdmlkIExl
Y2huZXIgPGRhdmlkQGxlY2hub2xvZ3kuY29tPgo+ID4gU2lnbmVkLW9mZi1ieTogV2lsbGlhbSBC
cmVhdGhpdHQgR3JheSA8dmlsaGVsbS5ncmF5QGdtYWlsLmNvbT4KPiA+IC0tLQo+ID4gIE1BSU5U
QUlORVJTICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgIDEgLQo+ID4gIGRyaXZlcnMv
Y291bnRlci8xMDQtcXVhZC04LmMgICAgICAgICAgICB8ICA0NDkgKysrLS0tLQo+ID4gIGRyaXZl
cnMvY291bnRlci9NYWtlZmlsZSAgICAgICAgICAgICAgICB8ICAgIDEgKwo+ID4gIGRyaXZlcnMv
Y291bnRlci9jb3VudGVyLWNvcmUuYyAgICAgICAgICB8ICAxNDIgKysrCj4gPiAgZHJpdmVycy9j
b3VudGVyL2NvdW50ZXItc3lzZnMuYyAgICAgICAgIHwgIDg0OSArKysrKysrKysrKysrCj4gPiAg
ZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuaCAgICAgICAgIHwgICAxMyArCj4gPiAgZHJp
dmVycy9jb3VudGVyL2NvdW50ZXIuYyAgICAgICAgICAgICAgIHwgMTQ5NiAtLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQo+ID4gIGRyaXZlcnMvY291bnRlci9mdG0tcXVhZGRlYy5jICAgICAgICAgICB8
ICAgNjAgKy0KPiA+ICBkcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMgICAgICAgICAgICAgfCAg
MTQ0ICstLQo+ID4gIGRyaXZlcnMvY291bnRlci9pbnRlcnJ1cHQtY250LmMgICAgICAgICB8ICAg
NjIgKy0KPiA+ICBkcml2ZXJzL2NvdW50ZXIvbWljcm9jaGlwLXRjYi1jYXB0dXJlLmMgfCAgIDkx
ICstCj4gPiAgZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmMgICAgIHwgIDIxMiAr
Ky0tCj4gPiAgZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jICAgICAgIHwgIDE3OSAr
Ky0KPiA+ICBkcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5jICAgICAgICAgICAgICAgfCAgMTgwICst
LQo+ID4gIGluY2x1ZGUvbGludXgvY291bnRlci5oICAgICAgICAgICAgICAgICB8ICA2NTggKysr
KystLS0tLQo+ID4gIGluY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmggICAgICAgICAgICB8ICAg
NDUgLQo+ID4gIDE2IGZpbGVzIGNoYW5nZWQsIDE5NDkgaW5zZXJ0aW9ucygrKSwgMjYzMyBkZWxl
dGlvbnMoLSkKPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9jb3VudGVyL2NvdW50ZXIt
Y29yZS5jCj4gPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLXN5
c2ZzLmMKPiA+ICBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lz
ZnMuaAo+ID4gIGRlbGV0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2NvdW50ZXIvY291bnRlci5jCj4g
PiAgZGVsZXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmgKPiA+ICAg
Cj4gCj4gSGkgV2lsbGlhbSwKPiAKPiBGb3IgdGhlIFNUTTMyIGRyaXZlcnMsIHlvdSBjYW4gYWRk
IG15Ogo+IFJldmlld2VkLWJ5OiBGYWJyaWNlIEdhc25pZXIgPGZhYnJpY2UuZ2FzbmllckBmb3Nz
LnN0LmNvbT4KClRoYW5rcyBGYWJyaWNlIQoKTG9va3MgbGlrZSB0aGUgb25seSB3YXkgd2UgYXJl
IGdvaW5nIHRvIG1vdmUgZm9yd2FyZCB3aXRoIHRoaXMKaXMgdG8ganVzdCBnZXQgb24gYW5kIGFw
cGx5IGl0IHRoZW4gc2VlIGlmIHdlIGdldCBhbnkgYnJlYWthZ2UKcmVwb3J0cy4KClNvLCBhcHBs
aWVkIHRvIHRoZSB0b2dyZWcgYnJhbmNoIG9mIGlpby5naXQgYW5kIHB1c2hlZCBvdXQgYXMgdGVz
dGluZwpmb3IgMC1kYXkgdG8gcG9rZSBhdCBpdC4KClRoYW5rLAoKSm9uYXRoYW4KCj4gCj4gVGhh
bmtzLAo+IEZhYnJpY2UKPiAKPiAKPiAKPiA+IGRpZmYgLS1naXQgYS9NQUlOVEFJTkVSUyBiL01B
SU5UQUlORVJTCj4gPiBpbmRleCAyMTJiYWQ4NWUwN2EuLmIwY2RiOWFhY2E4NSAxMDA2NDQKPiA+
IC0tLSBhL01BSU5UQUlORVJTCj4gPiArKysgYi9NQUlOVEFJTkVSUwo+ID4gQEAgLTQ3ODEsNyAr
NDc4MSw2IEBAIEY6CURvY3VtZW50YXRpb24vQUJJL3Rlc3Rpbmcvc3lzZnMtYnVzLWNvdW50ZXIK
PiA+ICBGOglEb2N1bWVudGF0aW9uL2RyaXZlci1hcGkvZ2VuZXJpYy1jb3VudGVyLnJzdAo+ID4g
IEY6CWRyaXZlcnMvY291bnRlci8KPiA+ICBGOglpbmNsdWRlL2xpbnV4L2NvdW50ZXIuaAo+ID4g
LUY6CWluY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmgKPiA+ICAKPiA+ICBDUDI2MTUgSTJDIERS
SVZFUgo+ID4gIE06CUJlbmNlIENzw7Nrw6FzIDxiZW5jZTk4QHNjaC5ibWUuaHU+Cj4gPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyLzEwNC1xdWFkLTguYyBiL2RyaXZlcnMvY291bnRlci8x
MDQtcXVhZC04LmMKPiA+IGluZGV4IDBjYWE2MDUzN2IxNC4uYzU4N2YyOTVkNzIwIDEwMDY0NAo+
ID4gLS0tIGEvZHJpdmVycy9jb3VudGVyLzEwNC1xdWFkLTguYwo+ID4gKysrIGIvZHJpdmVycy9j
b3VudGVyLzEwNC1xdWFkLTguYwo+ID4gQEAgLTExNyw3ICsxMTcsNyBAQCBzdGF0aWMgaW50IHF1
YWQ4X3NpZ25hbF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICB9Cj4g
PiAgCj4gPiAgc3RhdGljIGludCBxdWFkOF9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiA+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBs
b25nICp2YWwpCj4gPiArCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2
YWwpCj4gPiAgewo+ID4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2
Owo+ID4gIAljb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsgMiAqIGNvdW50LT5p
ZDsKPiA+IEBAIC0xNDgsNyArMTQ4LDcgQEAgc3RhdGljIGludCBxdWFkOF9jb3VudF9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICB9Cj4gPiAgCj4gPiAgc3RhdGljIGlu
dCBxdWFkOF9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAt
CXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyB2YWwpCj4gPiArCQkJ
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCB2YWwpCj4gPiAgewo+ID4gIAlz
dHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAljb25zdCBpbnQg
YmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsgMiAqIGNvdW50LT5pZDsKPiA+IEBAIC0xODgsMjIg
KzE4OCwxNiBAQCBzdGF0aWMgaW50IHF1YWQ4X2NvdW50X3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiA+ICAJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLWVudW0gcXVh
ZDhfY291bnRfZnVuY3Rpb24gewo+ID4gLQlRVUFEOF9DT1VOVF9GVU5DVElPTl9QVUxTRV9ESVJF
Q1RJT04gPSAwLAo+ID4gLQlRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gxLAo+ID4g
LQlRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gyLAo+ID4gLQlRVUFEOF9DT1VOVF9G
VU5DVElPTl9RVUFEUkFUVVJFX1g0Cj4gPiAtfTsKPiA+IC0KPiA+ICBzdGF0aWMgY29uc3QgZW51
bSBjb3VudGVyX2Z1bmN0aW9uIHF1YWQ4X2NvdW50X2Z1bmN0aW9uc19saXN0W10gPSB7Cj4gPiAt
CVtRVUFEOF9DT1VOVF9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT05dID0gQ09VTlRFUl9GVU5DVElP
Tl9QVUxTRV9ESVJFQ1RJT04sCj4gPiAtCVtRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJF
X1gxXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BLAo+ID4gLQlbUVVBRDhfQ09V
TlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl0gPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDJfQSwKPiA+IC0JW1FVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDRdID0gQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Cj4gPiArCUNPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElS
RUNUSU9OLAo+ID4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQSwKPiA+ICsJQ09V
TlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0EsCj4gPiArCUNPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YNCwKPiA+ICB9Owo+ID4gIAo+ID4gLXN0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25f
Z2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0Jc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LCBzaXplX3QgKmZ1bmN0aW9uKQo+ID4gK3N0YXRpYyBpbnQgcXVhZDhfZnVu
Y3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJICAgICAg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkgICAgICAgZW51bSBjb3VudGVy
X2Z1bmN0aW9uICpmdW5jdGlvbikKPiA+ICB7Cj4gPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJp
diA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCWNvbnN0IGludCBpZCA9IGNvdW50LT5pZDsKPiA+IEBA
IC0yMTMsMjUgKzIwNywyNiBAQCBzdGF0aWMgaW50IHF1YWQ4X2Z1bmN0aW9uX2dldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCWlmIChwcml2LT5xdWFkcmF0dXJlX21vZGVb
aWRdKQo+ID4gIAkJc3dpdGNoIChwcml2LT5xdWFkcmF0dXJlX3NjYWxlW2lkXSkgewo+ID4gIAkJ
Y2FzZSAwOgo+ID4gLQkJCSpmdW5jdGlvbiA9IFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRV
UkVfWDE7Cj4gPiArCQkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gx
X0E7Cj4gPiAgCQkJYnJlYWs7Cj4gPiAgCQljYXNlIDE6Cj4gPiAtCQkJKmZ1bmN0aW9uID0gUVVB
RDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMjsKPiA+ICsJCQkqZnVuY3Rpb24gPSBDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQTsKPiA+ICAJCQlicmVhazsKPiA+ICAJCWNhc2Ug
MjoKPiA+IC0JCQkqZnVuY3Rpb24gPSBRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1g0
Owo+ID4gKwkJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDsKPiA+
ICAJCQlicmVhazsKPiA+ICAJCX0KPiA+ICAJZWxzZQo+ID4gLQkJKmZ1bmN0aW9uID0gUVVBRDhf
Q09VTlRfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOwo+ID4gKwkJKmZ1bmN0aW9uID0gQ09VTlRF
Ul9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT047Cj4gPiAgCj4gPiAgCW11dGV4X3VubG9jaygmcHJp
di0+bG9jayk7Cj4gPiAgCj4gPiAgCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMg
aW50IHF1YWQ4X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
PiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90IGZ1bmN0aW9uKQo+ID4gK3N0
YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ID4gKwkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJCWVudW0g
Y291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbikKPiA+ICB7Cj4gPiAgCXN0cnVjdCBxdWFkOCAqY29u
c3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCWNvbnN0IGludCBpZCA9IGNvdW50LT5pZDsK
PiA+IEBAIC0yNDcsNyArMjQyLDcgQEAgc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl9zZXQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAltb2RlX2NmZyA9IHByaXYtPmNvdW50
X21vZGVbaWRdIDw8IDE7Cj4gPiAgCWlkcl9jZmcgPSBwcml2LT5pbmRleF9wb2xhcml0eVtpZF0g
PDwgMTsKPiA+ICAKPiA+IC0JaWYgKGZ1bmN0aW9uID09IFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1BV
TFNFX0RJUkVDVElPTikgewo+ID4gKwlpZiAoZnVuY3Rpb24gPT0gQ09VTlRFUl9GVU5DVElPTl9Q
VUxTRV9ESVJFQ1RJT04pIHsKPiA+ICAJCSpxdWFkcmF0dXJlX21vZGUgPSAwOwo+ID4gIAo+ID4g
IAkJLyogUXVhZHJhdHVyZSBzY2FsaW5nIG9ubHkgYXZhaWxhYmxlIGluIHF1YWRyYXR1cmUgbW9k
ZSAqLwo+ID4gQEAgLTI2MywxNSArMjU4LDE1IEBAIHN0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25f
c2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJCSpxdWFkcmF0dXJlX21v
ZGUgPSAxOwo+ID4gIAo+ID4gIAkJc3dpdGNoIChmdW5jdGlvbikgewo+ID4gLQkJY2FzZSBRVUFE
OF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gxOgo+ID4gKwkJY2FzZSBDT1VOVEVSX0ZVTkNU
SU9OX1FVQURSQVRVUkVfWDFfQToKPiA+ICAJCQkqc2NhbGUgPSAwOwo+ID4gIAkJCW1vZGVfY2Zn
IHw9IFFVQUQ4X0NNUl9RVUFEUkFUVVJFX1gxOwo+ID4gIAkJCWJyZWFrOwo+ID4gLQkJY2FzZSBR
VUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gyOgo+ID4gKwkJY2FzZSBDT1VOVEVSX0ZV
TkNUSU9OX1FVQURSQVRVUkVfWDJfQToKPiA+ICAJCQkqc2NhbGUgPSAxOwo+ID4gIAkJCW1vZGVf
Y2ZnIHw9IFFVQUQ4X0NNUl9RVUFEUkFUVVJFX1gyOwo+ID4gIAkJCWJyZWFrOwo+ID4gLQkJY2Fz
ZSBRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Ogo+ID4gKwkJY2FzZSBDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gPiAgCQkJKnNjYWxlID0gMjsKPiA+ICAJCQltb2Rl
X2NmZyB8PSBRVUFEOF9DTVJfUVVBRFJBVFVSRV9YNDsKPiA+ICAJCQlicmVhazsKPiA+IEBAIC0y
OTAsOCArMjg1LDkgQEAgc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3Rh
dGljIHZvaWQgcXVhZDhfZGlyZWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgZW51bSBjb3VudGVyX2NvdW50
X2RpcmVjdGlvbiAqZGlyZWN0aW9uKQo+ID4gK3N0YXRpYyBpbnQgcXVhZDhfZGlyZWN0aW9uX3Jl
YWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQlzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCj4gPiArCQkJCWVudW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gKmRp
cmVjdGlvbikKPiA+ICB7Cj4gPiAgCWNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNv
dW50ZXItPnByaXY7Cj4gPiAgCXVuc2lnbmVkIGludCB1ZF9mbGFnOwo+ID4gQEAgLTMwMiw3NiAr
Mjk4LDc0IEBAIHN0YXRpYyB2b2lkIHF1YWQ4X2RpcmVjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ID4gIAo+ID4gIAkqZGlyZWN0aW9uID0gKHVkX2ZsYWcpID8gQ09V
TlRFUl9DT1VOVF9ESVJFQ1RJT05fRk9SV0FSRCA6Cj4gPiAgCQlDT1VOVEVSX0NPVU5UX0RJUkVD
VElPTl9CQUNLV0FSRDsKPiA+IC19Cj4gPiAgCj4gPiAtZW51bSBxdWFkOF9zeW5hcHNlX2FjdGlv
biB7Cj4gPiAtCVFVQUQ4X1NZTkFQU0VfQUNUSU9OX05PTkUgPSAwLAo+ID4gLQlRVUFEOF9TWU5B
UFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiA+IC0JUVVBRDhfU1lOQVBTRV9BQ1RJT05fRkFMTElO
R19FREdFLAo+ID4gLQlRVUFEOF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gPiAtfTsKPiA+
ICsJcmV0dXJuIDA7Cj4gPiArfQo+ID4gIAo+ID4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJf
c3luYXBzZV9hY3Rpb24gcXVhZDhfaW5kZXhfYWN0aW9uc19saXN0W10gPSB7Cj4gPiAtCVtRVUFE
OF9TWU5BUFNFX0FDVElPTl9OT05FXSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiA+
IC0JW1FVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5URVJfU1lOQVBTRV9B
Q1RJT05fUklTSU5HX0VER0UKPiA+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+ID4g
KwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ID4gIH07Cj4gPiAgCj4gPiAg
c3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBxdWFkOF9zeW5hcHNlX2Fj
dGlvbnNfbGlzdFtdID0gewo+ID4gLQlbUVVBRDhfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gPiAtCVtRVUFEOF9TWU5BUFNFX0FDVElPTl9SSVNJ
TkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ID4gLQlbUVVB
RDhfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFXSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05f
RkFMTElOR19FREdFLAo+ID4gLQlbUVVBRDhfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFU10gPSBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMKPiA+ICsJQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9OT05FLAo+ID4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ID4g
KwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiA+ICsJQ09VTlRFUl9TWU5B
UFNFX0FDVElPTl9CT1RIX0VER0VTLAo+ID4gIH07Cj4gPiAgCj4gPiAtc3RhdGljIGludCBxdWFk
OF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0Jc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+
ID4gLQlzaXplX3QgKmFjdGlvbikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X2FjdGlvbl9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiA+ICsJCQkgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFw
c2UsCj4gPiArCQkJICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiA+
ICB7Cj4gPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAg
CWludCBlcnI7Cj4gPiAtCXNpemVfdCBmdW5jdGlvbiA9IDA7Cj4gPiArCWVudW0gY291bnRlcl9m
dW5jdGlvbiBmdW5jdGlvbjsKPiA+ICAJY29uc3Qgc2l6ZV90IHNpZ25hbF9hX2lkID0gY291bnQt
PnN5bmFwc2VzWzBdLnNpZ25hbC0+aWQ7Cj4gPiAgCWVudW0gY291bnRlcl9jb3VudF9kaXJlY3Rp
b24gZGlyZWN0aW9uOwo+ID4gIAo+ID4gIAkvKiBIYW5kbGUgSW5kZXggc2lnbmFscyAqLwo+ID4g
IAlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA+PSAxNikgewo+ID4gIAkJaWYgKHByaXYtPnByZXNl
dF9lbmFibGVbY291bnQtPmlkXSkKPiA+IC0JCQkqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9BQ1RJ
T05fUklTSU5HX0VER0U7Cj4gPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05f
UklTSU5HX0VER0U7Cj4gPiAgCQllbHNlCj4gPiAtCQkJKmFjdGlvbiA9IFFVQUQ4X1NZTkFQU0Vf
QUNUSU9OX05PTkU7Cj4gPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9O
RTsKPiA+ICAKPiA+ICAJCXJldHVybiAwOwo+ID4gIAl9Cj4gPiAgCj4gPiAtCWVyciA9IHF1YWQ4
X2Z1bmN0aW9uX2dldChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiA+ICsJZXJyID0gcXVh
ZDhfZnVuY3Rpb25fcmVhZChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiA+ICAJaWYgKGVy
cikKPiA+ICAJCXJldHVybiBlcnI7Cj4gPiAgCj4gPiAgCS8qIERlZmF1bHQgYWN0aW9uIG1vZGUg
Ki8KPiA+IC0JKmFjdGlvbiA9IFFVQUQ4X1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gPiArCSphY3Rp
b24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gPiAgCj4gPiAgCS8qIERldGVybWlu
ZSBhY3Rpb24gbW9kZSBiYXNlZCBvbiBjdXJyZW50IGNvdW50IGZ1bmN0aW9uIG1vZGUgKi8KPiA+
ICAJc3dpdGNoIChmdW5jdGlvbikgewo+ID4gLQljYXNlIFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1BV
TFNFX0RJUkVDVElPTjoKPiA+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElP
TjoKPiA+ICAJCWlmIChzeW5hcHNlLT5zaWduYWwtPmlkID09IHNpZ25hbF9hX2lkKQo+ID4gLQkJ
CSphY3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiA+ICsJCQkqYWN0
aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiA+ICAJCXJldHVybiAw
Owo+ID4gLQljYXNlIFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDE6Cj4gPiArCWNh
c2UgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0E6Cj4gPiAgCQlpZiAoc3luYXBzZS0+
c2lnbmFsLT5pZCA9PSBzaWduYWxfYV9pZCkgewo+ID4gLQkJCXF1YWQ4X2RpcmVjdGlvbl9nZXQo
Y291bnRlciwgY291bnQsICZkaXJlY3Rpb24pOwo+ID4gKwkJCWVyciA9IHF1YWQ4X2RpcmVjdGlv
bl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZGlyZWN0aW9uKTsKPiA+ICsJCQlpZiAoZXJyKQo+ID4g
KwkJCQlyZXR1cm4gZXJyOwo+ID4gIAo+ID4gIAkJCWlmIChkaXJlY3Rpb24gPT0gQ09VTlRFUl9D
T1VOVF9ESVJFQ1RJT05fRk9SV0FSRCkKPiA+IC0JCQkJKmFjdGlvbiA9IFFVQUQ4X1NZTkFQU0Vf
QUNUSU9OX1JJU0lOR19FREdFOwo+ID4gKwkJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9SSVNJTkdfRURHRTsKPiA+ICAJCQllbHNlCj4gPiAtCQkJCSphY3Rpb24gPSBRVUFEOF9T
WU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0U7Cj4gPiArCQkJCSphY3Rpb24gPSBDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRTsKPiA+ICAJCX0KPiA+ICAJCXJldHVybiAwOwo+ID4g
LQljYXNlIFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDI6Cj4gPiArCWNhc2UgQ09V
TlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0E6Cj4gPiAgCQlpZiAoc3luYXBzZS0+c2lnbmFs
LT5pZCA9PSBzaWduYWxfYV9pZCkKPiA+IC0JCQkqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9BQ1RJ
T05fQk9USF9FREdFUzsKPiA+ICsJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9C
T1RIX0VER0VTOwo+ID4gIAkJcmV0dXJuIDA7Cj4gPiAtCWNhc2UgUVVBRDhfQ09VTlRfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YNDoKPiA+IC0JCSphY3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9C
T1RIX0VER0VTOwo+ID4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiA+
ICsJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gPiAgCQly
ZXR1cm4gMDsKPiA+ICAJZGVmYXVsdDoKPiA+ICAJCS8qIHNob3VsZCBuZXZlciByZWFjaCB0aGlz
IHBhdGggKi8KPiA+IEBAIC0zODMsOSArMzc3LDkgQEAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb3Vu
dGVyX29wcyBxdWFkOF9vcHMgPSB7Cj4gPiAgCS5zaWduYWxfcmVhZCA9IHF1YWQ4X3NpZ25hbF9y
ZWFkLAo+ID4gIAkuY291bnRfcmVhZCA9IHF1YWQ4X2NvdW50X3JlYWQsCj4gPiAgCS5jb3VudF93
cml0ZSA9IHF1YWQ4X2NvdW50X3dyaXRlLAo+ID4gLQkuZnVuY3Rpb25fZ2V0ID0gcXVhZDhfZnVu
Y3Rpb25fZ2V0LAo+ID4gLQkuZnVuY3Rpb25fc2V0ID0gcXVhZDhfZnVuY3Rpb25fc2V0LAo+ID4g
LQkuYWN0aW9uX2dldCA9IHF1YWQ4X2FjdGlvbl9nZXQKPiA+ICsJLmZ1bmN0aW9uX3JlYWQgPSBx
dWFkOF9mdW5jdGlvbl9yZWFkLAo+ID4gKwkuZnVuY3Rpb25fd3JpdGUgPSBxdWFkOF9mdW5jdGlv
bl93cml0ZSwKPiA+ICsJLmFjdGlvbl9yZWFkID0gcXVhZDhfYWN0aW9uX3JlYWQKPiA+ICB9Owo+
ID4gIAo+ID4gIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9pbmRleF9wb2xhcml0eV9t
b2Rlc1tdID0gewo+ID4gQEAgLTM5NCw3ICszODgsOCBAQCBzdGF0aWMgY29uc3QgY2hhciAqY29u
c3QgcXVhZDhfaW5kZXhfcG9sYXJpdHlfbW9kZXNbXSA9IHsKPiA+ICB9Owo+ID4gIAo+ID4gIHN0
YXRpYyBpbnQgcXVhZDhfaW5kZXhfcG9sYXJpdHlfZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiA+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHNpemVfdCAqaW5k
ZXhfcG9sYXJpdHkpCj4gPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwK
PiA+ICsJCQkJICAgIHUzMiAqaW5kZXhfcG9sYXJpdHkpCj4gPiAgewo+ID4gIAljb25zdCBzdHJ1
Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAljb25zdCBzaXplX3Qg
Y2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLSAxNjsKPiA+IEBAIC00MDUsNyArNDAwLDggQEAgc3Rh
dGljIGludCBxdWFkOF9pbmRleF9wb2xhcml0eV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+ID4gIH0KPiA+ICAKPiA+ICBzdGF0aWMgaW50IHF1YWQ4X2luZGV4X3BvbGFyaXR5
X3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCXN0cnVjdCBjb3VudGVy
X3NpZ25hbCAqc2lnbmFsLCBzaXplX3QgaW5kZXhfcG9sYXJpdHkpCj4gPiArCQkJCSAgICBzdHJ1
Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiA+ICsJCQkJICAgIHUzMiBpbmRleF9wb2xhcml0
eSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7
Cj4gPiAgCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAtIDE2Owo+ID4gQEAg
LTQyNiwyMCArNDIyLDE0IEBAIHN0YXRpYyBpbnQgcXVhZDhfaW5kZXhfcG9sYXJpdHlfc2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJcmV0dXJuIDA7Cj4gPiAgfQo+ID4g
IAo+ID4gLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51bV9leHQgcXVhZDhfaW5kZXhf
cG9sX2VudW0gPSB7Cj4gPiAtCS5pdGVtcyA9IHF1YWQ4X2luZGV4X3BvbGFyaXR5X21vZGVzLAo+
ID4gLQkubnVtX2l0ZW1zID0gQVJSQVlfU0laRShxdWFkOF9pbmRleF9wb2xhcml0eV9tb2Rlcyks
Cj4gPiAtCS5nZXQgPSBxdWFkOF9pbmRleF9wb2xhcml0eV9nZXQsCj4gPiAtCS5zZXQgPSBxdWFk
OF9pbmRleF9wb2xhcml0eV9zZXQKPiA+IC19Owo+ID4gLQo+ID4gIHN0YXRpYyBjb25zdCBjaGFy
ICpjb25zdCBxdWFkOF9zeW5jaHJvbm91c19tb2Rlc1tdID0gewo+ID4gIAkibm9uLXN5bmNocm9u
b3VzIiwKPiA+ICAJInN5bmNocm9ub3VzIgo+ID4gIH07Cj4gPiAgCj4gPiAgc3RhdGljIGludCBx
dWFkOF9zeW5jaHJvbm91c19tb2RlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCBzaXplX3QgKnN5bmNocm9ub3Vz
X21vZGUpCj4gPiArCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ID4g
KwkJCQkgICAgICB1MzIgKnN5bmNocm9ub3VzX21vZGUpCj4gPiAgewo+ID4gIAljb25zdCBzdHJ1
Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAljb25zdCBzaXplX3Qg
Y2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLSAxNjsKPiA+IEBAIC00NTAsNyArNDQwLDggQEAgc3Rh
dGljIGludCBxdWFkOF9zeW5jaHJvbm91c19tb2RlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gPiAgfQo+ID4gIAo+ID4gIHN0YXRpYyBpbnQgcXVhZDhfc3luY2hyb25vdXNf
bW9kZV9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQlzdHJ1Y3QgY291
bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90IHN5bmNocm9ub3VzX21vZGUpCj4gPiArCQkJCSAg
ICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ID4gKwkJCQkgICAgICB1MzIgc3lu
Y2hyb25vdXNfbW9kZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNv
dW50ZXItPnByaXY7Cj4gPiAgCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAt
IDE2Owo+ID4gQEAgLTQ3NywyMiArNDY4LDE4IEBAIHN0YXRpYyBpbnQgcXVhZDhfc3luY2hyb25v
dXNfbW9kZV9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAlyZXR1cm4g
MDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4
dCBxdWFkOF9zeW5fbW9kZV9lbnVtID0gewo+ID4gLQkuaXRlbXMgPSBxdWFkOF9zeW5jaHJvbm91
c19tb2RlcywKPiA+IC0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUocXVhZDhfc3luY2hyb25vdXNf
bW9kZXMpLAo+ID4gLQkuZ2V0ID0gcXVhZDhfc3luY2hyb25vdXNfbW9kZV9nZXQsCj4gPiAtCS5z
ZXQgPSBxdWFkOF9zeW5jaHJvbm91c19tb2RlX3NldAo+ID4gLX07Cj4gPiAtCj4gPiAtc3RhdGlj
IHNzaXplX3QgcXVhZDhfY291bnRfZmxvb3JfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwg
Y2hhciAqYnVmKQo+ID4gK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfZmxvb3JfcmVhZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB1NjQgKmZsb29yKQo+ID4gIHsKPiA+ICAJLyogT25seSBhIGZsb29yIG9mIDAgaXMg
c3VwcG9ydGVkICovCj4gPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIjBcbiIpOwo+ID4gKwkqZmxv
b3IgPSAwOwo+ID4gKwo+ID4gKwlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIGlu
dCBxdWFkOF9jb3VudF9tb2RlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
PiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90ICpjbnRfbW9kZSkKPiA+ICtz
dGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gPiArCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJCSBl
bnVtIGNvdW50ZXJfY291bnRfbW9kZSAqY250X21vZGUpCj4gPiAgewo+ID4gIAljb25zdCBzdHJ1
Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAo+ID4gQEAgLTUxNSwy
NiArNTAyLDI4IEBAIHN0YXRpYyBpbnQgcXVhZDhfY291bnRfbW9kZV9nZXQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3Rh
dGljIGludCBxdWFkOF9jb3VudF9tb2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90IGNudF9tb2RlKQo+
ID4gK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfbW9kZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4g
KwkJCQkgIGVudW0gY291bnRlcl9jb3VudF9tb2RlIGNudF9tb2RlKQo+ID4gIHsKPiA+ICAJc3Ry
dWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiA+ICsJdW5zaWduZWQgaW50
IGNvdW50X21vZGU7Cj4gPiAgCXVuc2lnbmVkIGludCBtb2RlX2NmZzsKPiA+ICAJY29uc3QgaW50
IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFzZSArIDIgKiBjb3VudC0+aWQgKyAxOwo+ID4gIAo+ID4g
IAkvKiBNYXAgR2VuZXJpYyBDb3VudGVyIGNvdW50IG1vZGUgdG8gMTA0LVFVQUQtOCBjb3VudCBt
b2RlICovCj4gPiAgCXN3aXRjaCAoY250X21vZGUpIHsKPiA+ICAJY2FzZSBDT1VOVEVSX0NPVU5U
X01PREVfTk9STUFMOgo+ID4gLQkJY250X21vZGUgPSAwOwo+ID4gKwkJY291bnRfbW9kZSA9IDA7
Cj4gPiAgCQlicmVhazsKPiA+ICAJY2FzZSBDT1VOVEVSX0NPVU5UX01PREVfUkFOR0VfTElNSVQ6
Cj4gPiAtCQljbnRfbW9kZSA9IDE7Cj4gPiArCQljb3VudF9tb2RlID0gMTsKPiA+ICAJCWJyZWFr
Owo+ID4gIAljYXNlIENPVU5URVJfQ09VTlRfTU9ERV9OT05fUkVDWUNMRToKPiA+IC0JCWNudF9t
b2RlID0gMjsKPiA+ICsJCWNvdW50X21vZGUgPSAyOwo+ID4gIAkJYnJlYWs7Cj4gPiAgCWNhc2Ug
Q09VTlRFUl9DT1VOVF9NT0RFX01PRFVMT19OOgo+ID4gLQkJY250X21vZGUgPSAzOwo+ID4gKwkJ
Y291bnRfbW9kZSA9IDM7Cj4gPiAgCQlicmVhazsKPiA+ICAJZGVmYXVsdDoKPiA+ICAJCS8qIHNo
b3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGggKi8KPiA+IEBAIC01NDMsMTAgKzUzMiwxMCBAQCBz
dGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiA+ICAKPiA+ICAJbXV0ZXhfbG9jaygmcHJpdi0+bG9jayk7Cj4gPiAgCj4gPiAtCXBy
aXYtPmNvdW50X21vZGVbY291bnQtPmlkXSA9IGNudF9tb2RlOwo+ID4gKwlwcml2LT5jb3VudF9t
b2RlW2NvdW50LT5pZF0gPSBjb3VudF9tb2RlOwo+ID4gIAo+ID4gIAkvKiBTZXQgY291bnQgbW9k
ZSBjb25maWd1cmF0aW9uIHZhbHVlICovCj4gPiAtCW1vZGVfY2ZnID0gY250X21vZGUgPDwgMTsK
PiA+ICsJbW9kZV9jZmcgPSBjb3VudF9tb2RlIDw8IDE7Cj4gPiAgCj4gPiAgCS8qIEFkZCBxdWFk
cmF0dXJlIG1vZGUgY29uZmlndXJhdGlvbiAqLwo+ID4gIAlpZiAocHJpdi0+cXVhZHJhdHVyZV9t
b2RlW2NvdW50LT5pZF0pCj4gPiBAQCAtNTYwLDU2ICs1NDksMzUgQEAgc3RhdGljIGludCBxdWFk
OF9jb3VudF9tb2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCXJl
dHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnRfZW51
bV9leHQgcXVhZDhfY250X21vZGVfZW51bSA9IHsKPiA+IC0JLml0ZW1zID0gY291bnRlcl9jb3Vu
dF9tb2RlX3N0ciwKPiA+IC0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUoY291bnRlcl9jb3VudF9t
b2RlX3N0ciksCj4gPiAtCS5nZXQgPSBxdWFkOF9jb3VudF9tb2RlX2dldCwKPiA+IC0JLnNldCA9
IHF1YWQ4X2NvdW50X21vZGVfc2V0Cj4gPiAtfTsKPiA+IC0KPiA+IC1zdGF0aWMgc3NpemVfdCBx
dWFkOF9jb3VudF9kaXJlY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdiwgY2hhciAqYnVm
KQo+ID4gLXsKPiA+IC0JZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlvbiBkaXI7Cj4gPiAtCj4g
PiAtCXF1YWQ4X2RpcmVjdGlvbl9nZXQoY291bnRlciwgY291bnQsICZkaXIpOwo+ID4gLQo+ID4g
LQlyZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291bnRlcl9jb3VudF9kaXJlY3Rpb25fc3Ry
W2Rpcl0pOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9lbmFi
bGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCXN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ID4gK3N0YXRpYyBp
bnQgcXVhZDhfY291bnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ID4gKwkJCQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4ICplbmFibGUpCj4g
PiAgewo+ID4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2
Owo+ID4gIAo+ID4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+YWJfZW5hYmxl
W2NvdW50LT5pZF0pOwo+ID4gKwkqZW5hYmxlID0gcHJpdi0+YWJfZW5hYmxlW2NvdW50LT5pZF07
Cj4gPiArCj4gPiArCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBx
dWFkOF9jb3VudF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNo
YXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50X2VuYWJsZV93
cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsIHU4IGVuYWJsZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBxdWFk
OCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCWNvbnN0IGludCBiYXNlX29mZnNl
dCA9IHByaXYtPmJhc2UgKyAyICogY291bnQtPmlkOwo+ID4gLQlpbnQgZXJyOwo+ID4gLQlib29s
IGFiX2VuYWJsZTsKPiA+ICAJdW5zaWduZWQgaW50IGlvcl9jZmc7Cj4gPiAgCj4gPiAtCWVyciA9
IGtzdHJ0b2Jvb2woYnVmLCAmYWJfZW5hYmxlKTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCXJldHVy
biBlcnI7Cj4gPiAtCj4gPiAgCW11dGV4X2xvY2soJnByaXYtPmxvY2spOwo+ID4gIAo+ID4gLQlw
cml2LT5hYl9lbmFibGVbY291bnQtPmlkXSA9IGFiX2VuYWJsZTsKPiA+ICsJcHJpdi0+YWJfZW5h
YmxlW2NvdW50LT5pZF0gPSBlbmFibGU7Cj4gPiAgCj4gPiAtCWlvcl9jZmcgPSBhYl9lbmFibGUg
fCBwcml2LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF0gPDwgMTsKPiA+ICsJaW9yX2NmZyA9IGVu
YWJsZSB8IHByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlkXSA8PCAxOwo+ID4gIAo+ID4gIAkv
KiBMb2FkIEkvTyBjb250cm9sIGNvbmZpZ3VyYXRpb24gKi8KPiA+ICAJb3V0YihRVUFEOF9DVFJf
SU9SIHwgaW9yX2NmZywgYmFzZV9vZmZzZXQgKyAxKTsKPiA+ICAKPiA+ICAJbXV0ZXhfdW5sb2Nr
KCZwcml2LT5sb2NrKTsKPiA+ICAKPiA+IC0JcmV0dXJuIGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4g
PiAgfQo+ID4gIAo+ID4gIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9ub2lzZV9lcnJv
cl9zdGF0ZXNbXSA9IHsKPiA+IEBAIC02MTgsNyArNTg2LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIg
KmNvbnN0IHF1YWQ4X25vaXNlX2Vycm9yX3N0YXRlc1tdID0gewo+ID4gIH07Cj4gPiAgCj4gPiAg
c3RhdGljIGludCBxdWFkOF9lcnJvcl9ub2lzZV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCAqbm9pc2Vf
ZXJyb3IpCj4gPiArCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHUzMiAqbm9pc2Vf
ZXJyb3IpCj4gPiAgewo+ID4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3Vu
dGVyLT5wcml2Owo+ID4gIAljb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsgMiAq
IGNvdW50LT5pZCArIDE7Cj4gPiBAQCAtNjI4LDE4ICs1OTYsMTQgQEAgc3RhdGljIGludCBxdWFk
OF9lcnJvcl9ub2lzZV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAly
ZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvdW50X2Vu
dW1fZXh0IHF1YWQ4X2Vycm9yX25vaXNlX2VudW0gPSB7Cj4gPiAtCS5pdGVtcyA9IHF1YWQ4X25v
aXNlX2Vycm9yX3N0YXRlcywKPiA+IC0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUocXVhZDhfbm9p
c2VfZXJyb3Jfc3RhdGVzKSwKPiA+IC0JLmdldCA9IHF1YWQ4X2Vycm9yX25vaXNlX2dldAo+ID4g
LX07Cj4gPiAtCj4gPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfcHJlc2V0X3JlYWQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X2Nv
dW50X3ByZXNldF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJ
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnByZXNldCkKPiA+ICB7Cj4gPiAg
CWNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCj4g
PiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBwcml2LT5wcmVzZXRbY291bnQtPmlkXSk7
Cj4gPiArCSpwcmVzZXQgPSBwcml2LT5wcmVzZXRbY291bnQtPmlkXTsKPiA+ICsKPiA+ICsJcmV0
dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gIHN0YXRpYyB2b2lkIHF1YWQ4X3ByZXNldF9yZWdpc3Rl
cl9zZXQoc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2LCBjb25zdCBpbnQgaWQsCj4gPiBAQCAtNjU4
LDE2ICs2MjIsMTAgQEAgc3RhdGljIHZvaWQgcXVhZDhfcHJlc2V0X3JlZ2lzdGVyX3NldChzdHJ1
Y3QgcXVhZDggKmNvbnN0IHByaXYsIGNvbnN0IGludCBpZCwKPiA+ICAJCW91dGIocHJlc2V0ID4+
ICg4ICogaSksIGJhc2Vfb2Zmc2V0KTsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHNzaXplX3Qg
cXVhZDhfY291bnRfcHJlc2V0X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiA+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2YXRlLCBjb25zdCBj
aGFyICpidWYsIHNpemVfdCBsZW4pCj4gPiArc3RhdGljIGludCBxdWFkOF9jb3VudF9wcmVzZXRf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgcHJlc2V0KQo+ID4gIHsKPiA+ICAJc3RydWN0IHF1
YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiA+IC0JdW5zaWduZWQgaW50IHByZXNl
dDsKPiA+IC0JaW50IHJldDsKPiA+IC0KPiA+IC0JcmV0ID0ga3N0cnRvdWludChidWYsIDAsICZw
cmVzZXQpOwo+ID4gLQlpZiAocmV0KQo+ID4gLQkJcmV0dXJuIHJldDsKPiA+ICAKPiA+ICAJLyog
T25seSAyNC1iaXQgdmFsdWVzIGFyZSBzdXBwb3J0ZWQgKi8KPiA+ICAJaWYgKHByZXNldCA+IDB4
RkZGRkZGKQo+ID4gQEAgLTY3OSwxMSArNjM3LDExIEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X2Nv
dW50X3ByZXNldF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCj4g
PiAgCW11dGV4X3VubG9jaygmcHJpdi0+bG9jayk7Cj4gPiAgCj4gPiAtCXJldHVybiBsZW47Cj4g
PiArCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3Vu
dF9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQlzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiA+ICtz
dGF0aWMgaW50IHF1YWQ4X2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAq
Y2VpbGluZykKPiA+ICB7Cj4gPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXIt
PnByaXY7Cj4gPiAgCj4gPiBAQCAtNjkzLDI2ICs2NTEsMjMgQEAgc3RhdGljIHNzaXplX3QgcXVh
ZDhfY291bnRfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+
ICAJc3dpdGNoIChwcml2LT5jb3VudF9tb2RlW2NvdW50LT5pZF0pIHsKPiA+ICAJY2FzZSAxOgo+
ID4gIAljYXNlIDM6Cj4gPiAtCQltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+ID4gLQkJcmV0
dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIHByaXYtPnByZXNldFtjb3VudC0+aWRdKTsKPiA+ICsJ
CSpjZWlsaW5nID0gcHJpdi0+cHJlc2V0W2NvdW50LT5pZF07Cj4gPiArCQlicmVhazsKPiA+ICsJ
ZGVmYXVsdDoKPiA+ICsJCS8qIEJ5IGRlZmF1bHQgMHgxRkZGRkZGICgyNSBiaXRzIHVuc2lnbmVk
KSBpcyBtYXhpbXVtIGNvdW50ICovCj4gPiArCQkqY2VpbGluZyA9IDB4MUZGRkZGRjsKPiA+ICsJ
CWJyZWFrOwo+ID4gIAl9Cj4gPiAgCj4gPiAgCW11dGV4X3VubG9jaygmcHJpdi0+bG9jayk7Cj4g
PiAgCj4gPiAtCS8qIEJ5IGRlZmF1bHQgMHgxRkZGRkZGICgyNSBiaXRzIHVuc2lnbmVkKSBpcyBt
YXhpbXVtIGNvdW50ICovCj4gPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIjMzNTU0NDMxXG4iKTsK
PiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2Nv
dW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQlz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNoYXIgKmJ1
Ziwgc2l6ZV90IGxlbikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50X2NlaWxpbmdfd3JpdGUo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdTY0IGNlaWxpbmcpCj4gPiAgewo+ID4gIAlzdHJ1Y3QgcXVhZDgg
KmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gLQl1bnNpZ25lZCBpbnQgY2VpbGluZzsK
PiA+IC0JaW50IHJldDsKPiA+IC0KPiA+IC0JcmV0ID0ga3N0cnRvdWludChidWYsIDAsICZjZWls
aW5nKTsKPiA+IC0JaWYgKHJldCkKPiA+IC0JCXJldHVybiByZXQ7Cj4gPiAgCj4gPiAgCS8qIE9u
bHkgMjQtYml0IHZhbHVlcyBhcmUgc3VwcG9ydGVkICovCj4gPiAgCWlmIChjZWlsaW5nID4gMHhG
RkZGRkYpCj4gPiBAQCAtNzI2LDcgKzY4MSw3IEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50
X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAljYXNl
IDM6Cj4gPiAgCQlxdWFkOF9wcmVzZXRfcmVnaXN0ZXJfc2V0KHByaXYsIGNvdW50LT5pZCwgY2Vp
bGluZyk7Cj4gPiAgCQltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+ID4gLQkJcmV0dXJuIGxl
bjsKPiA+ICsJCXJldHVybiAwOwo+ID4gIAl9Cj4gPiAgCj4gPiAgCW11dGV4X3VubG9jaygmcHJp
di0+bG9jayk7Cj4gPiBAQCAtNzM0LDI3ICs2ODksMjUgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhf
Y291bnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAg
CXJldHVybiAtRUlOVkFMOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9j
b3VudF9wcmVzZXRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1
ZikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwKPiA+ICsJCQkJCSAgdTggKnByZXNldF9lbmFibGUpCj4gPiAgewo+ID4gIAljb25z
dCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAo+ID4gLQly
ZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgIXByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlk
XSk7Cj4gPiArCSpwcmVzZXRfZW5hYmxlID0gIXByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlk
XTsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90
IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUs
IGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50
X3ByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4g
KwkJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gKwkJCQkJICAgdTggcHJl
c2V0X2VuYWJsZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50
ZXItPnByaXY7Cj4gPiAgCWNvbnN0IGludCBiYXNlX29mZnNldCA9IHByaXYtPmJhc2UgKyAyICog
Y291bnQtPmlkICsgMTsKPiA+IC0JYm9vbCBwcmVzZXRfZW5hYmxlOwo+ID4gLQlpbnQgcmV0Owo+
ID4gIAl1bnNpZ25lZCBpbnQgaW9yX2NmZzsKPiA+ICAKPiA+IC0JcmV0ID0ga3N0cnRvYm9vbChi
dWYsICZwcmVzZXRfZW5hYmxlKTsKPiA+IC0JaWYgKHJldCkKPiA+IC0JCXJldHVybiByZXQ7Cj4g
PiAtCj4gPiAgCS8qIFByZXNldCBlbmFibGUgaXMgYWN0aXZlIGxvdyBpbiBJbnB1dC9PdXRwdXQg
Q29udHJvbCByZWdpc3RlciAqLwo+ID4gIAlwcmVzZXRfZW5hYmxlID0gIXByZXNldF9lbmFibGU7
Cj4gPiAgCj4gPiBAQCAtNzYyLDI1ICs3MTUsMjQgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfY291
bnRfcHJlc2V0X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
PiAgCj4gPiAgCXByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlkXSA9IHByZXNldF9lbmFibGU7
Cj4gPiAgCj4gPiAtCWlvcl9jZmcgPSBwcml2LT5hYl9lbmFibGVbY291bnQtPmlkXSB8ICh1bnNp
Z25lZCBpbnQpcHJlc2V0X2VuYWJsZSA8PCAxOwo+ID4gKwlpb3JfY2ZnID0gcHJpdi0+YWJfZW5h
YmxlW2NvdW50LT5pZF0gfCBwcmVzZXRfZW5hYmxlIDw8IDE7Cj4gPiAgCj4gPiAgCS8qIExvYWQg
SS9PIGNvbnRyb2wgY29uZmlndXJhdGlvbiB0byBJbnB1dCAvIE91dHB1dCBDb250cm9sIFJlZ2lz
dGVyICovCj4gPiAgCW91dGIoUVVBRDhfQ1RSX0lPUiB8IGlvcl9jZmcsIGJhc2Vfb2Zmc2V0KTsK
PiA+ICAKPiA+ICAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPiA+ICAKPiA+IC0JcmV0dXJu
IGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IHF1
YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiA+IC0JCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gPiAtCQkJ
CQkgICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X3Np
Z25hbF9jYWJsZV9mYXVsdF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+
ICsJCQkJCSBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiA+ICsJCQkJCSB1OCAqY2Fi
bGVfZmF1bHQpCj4gPiAgewo+ID4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVy
LT5wcml2Owo+ID4gIAljb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+
ID4gIAlib29sIGRpc2FibGVkOwo+ID4gIAl1bnNpZ25lZCBpbnQgc3RhdHVzOwo+ID4gLQl1bnNp
Z25lZCBpbnQgZmF1bHQ7Cj4gPiAgCj4gPiAgCW11dGV4X2xvY2soJnByaXYtPmxvY2spOwo+ID4g
IAo+ID4gQEAgLTc5NywzNiArNzQ5LDMxIEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9j
YWJsZV9mYXVsdF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJbXV0
ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPiA+ICAKPiA+ICAJLyogTWFzayByZXNwZWN0aXZlIGNo
YW5uZWwgYW5kIGludmVydCBsb2dpYyAqLwo+ID4gLQlmYXVsdCA9ICEoc3RhdHVzICYgQklUKGNo
YW5uZWxfaWQpKTsKPiA+ICsJKmNhYmxlX2ZhdWx0ID0gIShzdGF0dXMgJiBCSVQoY2hhbm5lbF9p
ZCkpOwo+ID4gIAo+ID4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgZmF1bHQpOwo+ID4g
KwlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFs
X2NhYmxlX2ZhdWx0X2VuYWJsZV9yZWFkKAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ID4gLQl2b2lkICpwcml2YXRl
LCBjaGFyICpidWYpCj4gPiArc3RhdGljIGludCBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRfZW5h
YmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkJCXN0cnVj
dCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ID4gKwkJCQkJCXU4ICplbmFibGUpCj4gPiAgewo+
ID4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4g
IAljb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+ID4gLQljb25zdCB1
bnNpZ25lZCBpbnQgZW5iID0gISEocHJpdi0+Y2FibGVfZmF1bHRfZW5hYmxlICYgQklUKGNoYW5u
ZWxfaWQpKTsKPiA+ICAKPiA+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIGVuYik7Cj4g
PiArCSplbmFibGUgPSAhIShwcml2LT5jYWJsZV9mYXVsdF9lbmFibGUgJiBCSVQoY2hhbm5lbF9p
ZCkpOwo+ID4gKwo+ID4gKwlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHNzaXpl
X3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV93cml0ZSgKPiA+IC0Jc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLCBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiA+
IC0Jdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ID4gK3N0YXRp
YyBpbnQgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQkJIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2ln
bmFsLAo+ID4gKwkJCQkJCSB1OCBlbmFibGUpCj4gPiAgewo+ID4gIAlzdHJ1Y3QgcXVhZDggKmNv
bnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAljb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9
IHNpZ25hbC0+aWQgLyAyOwo+ID4gLQlib29sIGVuYWJsZTsKPiA+IC0JaW50IHJldDsKPiA+ICAJ
dW5zaWduZWQgaW50IGNhYmxlX2ZhdWx0X2VuYWJsZTsKPiA+ICAKPiA+IC0JcmV0ID0ga3N0cnRv
Ym9vbChidWYsICZlbmFibGUpOwo+ID4gLQlpZiAocmV0KQo+ID4gLQkJcmV0dXJuIHJldDsKPiA+
IC0KPiA+ICAJbXV0ZXhfbG9jaygmcHJpdi0+bG9jayk7Cj4gPiAgCj4gPiAgCWlmIChlbmFibGUp
Cj4gPiBAQCAtODQxLDMxICs3ODgsMjcgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2Nh
YmxlX2ZhdWx0X2VuYWJsZV93cml0ZSgKPiA+ICAKPiA+ICAJbXV0ZXhfdW5sb2NrKCZwcml2LT5s
b2NrKTsKPiA+ICAKPiA+IC0JcmV0dXJuIGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4g
IAo+ID4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3JlYWQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9zaWduYWwg
KnNpZ25hbCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ID4gK3N0YXRpYyBpbnQgcXVhZDhf
c2lnbmFsX2Zja19wcmVzY2FsZXJfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gPiArCQkJCQkgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiA+ICsJCQkJCSAg
IHU4ICpwcmVzY2FsZXIpCj4gPiAgewo+ID4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+ID4gLQljb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25h
bC0+aWQgLyAyOwo+ID4gIAo+ID4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+
ZmNrX3ByZXNjYWxlcltjaGFubmVsX2lkXSk7Cj4gPiArCSpwcmVzY2FsZXIgPSBwcml2LT5mY2tf
cHJlc2NhbGVyW3NpZ25hbC0+aWQgLyAyXTsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+
ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0Jc3RydWN0IGNvdW50ZXJfc2ln
bmFsICpzaWduYWwsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNoYXIgKmJ1ZiwKPiA+IC0Jc2l6ZV90
IGxlbikKPiA+ICtzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dyaXRlKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJCSAgICBzdHJ1Y3QgY291bnRl
cl9zaWduYWwgKnNpZ25hbCwKPiA+ICsJCQkJCSAgICB1OCBwcmVzY2FsZXIpCj4gPiAgewo+ID4g
IAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAljb25zdCBz
aXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+ID4gIAljb25zdCBpbnQgYmFzZV9v
ZmZzZXQgPSBwcml2LT5iYXNlICsgMiAqIGNoYW5uZWxfaWQ7Cj4gPiAtCXU4IHByZXNjYWxlcjsK
PiA+IC0JaW50IHJldDsKPiA+IC0KPiA+IC0JcmV0ID0ga3N0cnRvdTgoYnVmLCAwLCAmcHJlc2Nh
bGVyKTsKPiA+IC0JaWYgKHJldCkKPiA+IC0JCXJldHVybiByZXQ7Cj4gPiAgCj4gPiAgCW11dGV4
X2xvY2soJnByaXYtPmxvY2spOwo+ID4gIAo+ID4gQEAgLTg4MSwzMSArODI0LDMwIEBAIHN0YXRp
YyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dyaXRlKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiA+ICAKPiA+ICAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsK
PiA+ICAKPiA+IC0JcmV0dXJuIGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4g
LXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0IHF1YWQ4X3NpZ25hbF9leHRb
XSA9IHsKPiA+IC0Jewo+ID4gLQkJLm5hbWUgPSAiY2FibGVfZmF1bHQiLAo+ID4gLQkJLnJlYWQg
PSBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRfcmVhZAo+ID4gLQl9LAo+ID4gLQl7Cj4gPiAtCQku
bmFtZSA9ICJjYWJsZV9mYXVsdF9lbmFibGUiLAo+ID4gLQkJLnJlYWQgPSBxdWFkOF9zaWduYWxf
Y2FibGVfZmF1bHRfZW5hYmxlX3JlYWQsCj4gPiAtCQkud3JpdGUgPSBxdWFkOF9zaWduYWxfY2Fi
bGVfZmF1bHRfZW5hYmxlX3dyaXRlCj4gPiAtCX0sCj4gPiAtCXsKPiA+IC0JCS5uYW1lID0gImZp
bHRlcl9jbG9ja19wcmVzY2FsZXIiLAo+ID4gLQkJLnJlYWQgPSBxdWFkOF9zaWduYWxfZmNrX3By
ZXNjYWxlcl9yZWFkLAo+ID4gLQkJLndyaXRlID0gcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJf
d3JpdGUKPiA+IC0JfQo+ID4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21wIHF1YWQ4X3NpZ25h
bF9leHRbXSA9IHsKPiA+ICsJQ09VTlRFUl9DT01QX1NJR05BTF9CT09MKCJjYWJsZV9mYXVsdCIs
IHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9yZWFkLAo+ID4gKwkJCQkgTlVMTCksCj4gPiArCUNP
VU5URVJfQ09NUF9TSUdOQUxfQk9PTCgiY2FibGVfZmF1bHRfZW5hYmxlIiwKPiA+ICsJCQkJIHF1
YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFibGVfcmVhZCwKPiA+ICsJCQkJIHF1YWQ4X3NpZ25h
bF9jYWJsZV9mYXVsdF9lbmFibGVfd3JpdGUpLAo+ID4gKwlDT1VOVEVSX0NPTVBfU0lHTkFMX1U4
KCJmaWx0ZXJfY2xvY2tfcHJlc2NhbGVyIiwKPiA+ICsJCQkgICAgICAgcXVhZDhfc2lnbmFsX2Zj
a19wcmVzY2FsZXJfcmVhZCwKPiA+ICsJCQkgICAgICAgcXVhZDhfc2lnbmFsX2Zja19wcmVzY2Fs
ZXJfd3JpdGUpCj4gPiAgfTsKPiA+ICAKPiA+IC1zdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJf
c2lnbmFsX2V4dCBxdWFkOF9pbmRleF9leHRbXSA9IHsKPiA+IC0JQ09VTlRFUl9TSUdOQUxfRU5V
TSgiaW5kZXhfcG9sYXJpdHkiLCAmcXVhZDhfaW5kZXhfcG9sX2VudW0pLAo+ID4gLQlDT1VOVEVS
X1NJR05BTF9FTlVNX0FWQUlMQUJMRSgiaW5kZXhfcG9sYXJpdHkiLAkmcXVhZDhfaW5kZXhfcG9s
X2VudW0pLAo+ID4gLQlDT1VOVEVSX1NJR05BTF9FTlVNKCJzeW5jaHJvbm91c19tb2RlIiwgJnF1
YWQ4X3N5bl9tb2RlX2VudW0pLAo+ID4gLQlDT1VOVEVSX1NJR05BTF9FTlVNX0FWQUlMQUJMRSgi
c3luY2hyb25vdXNfbW9kZSIsICZxdWFkOF9zeW5fbW9kZV9lbnVtKQo+ID4gK3N0YXRpYyBERUZJ
TkVfQ09VTlRFUl9FTlVNKHF1YWQ4X2luZGV4X3BvbF9lbnVtLCBxdWFkOF9pbmRleF9wb2xhcml0
eV9tb2Rlcyk7Cj4gPiArc3RhdGljIERFRklORV9DT1VOVEVSX0VOVU0ocXVhZDhfc3luY2hfbW9k
ZV9lbnVtLCBxdWFkOF9zeW5jaHJvbm91c19tb2Rlcyk7Cj4gPiArCj4gPiArc3RhdGljIHN0cnVj
dCBjb3VudGVyX2NvbXAgcXVhZDhfaW5kZXhfZXh0W10gPSB7Cj4gPiArCUNPVU5URVJfQ09NUF9T
SUdOQUxfRU5VTSgiaW5kZXhfcG9sYXJpdHkiLCBxdWFkOF9pbmRleF9wb2xhcml0eV9nZXQsCj4g
PiArCQkJCSBxdWFkOF9pbmRleF9wb2xhcml0eV9zZXQsCj4gPiArCQkJCSBxdWFkOF9pbmRleF9w
b2xfZW51bSksCj4gPiArCUNPVU5URVJfQ09NUF9TSUdOQUxfRU5VTSgic3luY2hyb25vdXNfbW9k
ZSIsIHF1YWQ4X3N5bmNocm9ub3VzX21vZGVfZ2V0LAo+ID4gKwkJCQkgcXVhZDhfc3luY2hyb25v
dXNfbW9kZV9zZXQsCj4gPiArCQkJCSBxdWFkOF9zeW5jaF9tb2RlX2VudW0pLAo+ID4gIH07Cj4g
PiAgCj4gPiAgI2RlZmluZSBRVUFEOF9RVUFEX1NJR05BTChfaWQsIF9uYW1lKSB7CQlcCj4gPiBA
QCAtOTc0LDM5ICs5MTYsMzAgQEAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgcXVhZDhf
Y291bnRfc3luYXBzZXNbXVszXSA9IHsKPiA+ICAJUVVBRDhfQ09VTlRfU1lOQVBTRVMoNiksIFFV
QUQ4X0NPVU5UX1NZTkFQU0VTKDcpCj4gPiAgfTsKPiA+ICAKPiA+IC1zdGF0aWMgY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfY291bnRfZXh0IHF1YWQ4X2NvdW50X2V4dFtdID0gewo+ID4gLQl7Cj4gPiAt
CQkubmFtZSA9ICJjZWlsaW5nIiwKPiA+IC0JCS5yZWFkID0gcXVhZDhfY291bnRfY2VpbGluZ19y
ZWFkLAo+ID4gLQkJLndyaXRlID0gcXVhZDhfY291bnRfY2VpbGluZ193cml0ZQo+ID4gLQl9LAo+
ID4gLQl7Cj4gPiAtCQkubmFtZSA9ICJmbG9vciIsCj4gPiAtCQkucmVhZCA9IHF1YWQ4X2NvdW50
X2Zsb29yX3JlYWQKPiA+IC0JfSwKPiA+IC0JQ09VTlRFUl9DT1VOVF9FTlVNKCJjb3VudF9tb2Rl
IiwgJnF1YWQ4X2NudF9tb2RlX2VudW0pLAo+ID4gLQlDT1VOVEVSX0NPVU5UX0VOVU1fQVZBSUxB
QkxFKCJjb3VudF9tb2RlIiwgJnF1YWQ4X2NudF9tb2RlX2VudW0pLAo+ID4gLQl7Cj4gPiAtCQku
bmFtZSA9ICJkaXJlY3Rpb24iLAo+ID4gLQkJLnJlYWQgPSBxdWFkOF9jb3VudF9kaXJlY3Rpb25f
cmVhZAo+ID4gLQl9LAo+ID4gLQl7Cj4gPiAtCQkubmFtZSA9ICJlbmFibGUiLAo+ID4gLQkJLnJl
YWQgPSBxdWFkOF9jb3VudF9lbmFibGVfcmVhZCwKPiA+IC0JCS53cml0ZSA9IHF1YWQ4X2NvdW50
X2VuYWJsZV93cml0ZQo+ID4gLQl9LAo+ID4gLQlDT1VOVEVSX0NPVU5UX0VOVU0oImVycm9yX25v
aXNlIiwgJnF1YWQ4X2Vycm9yX25vaXNlX2VudW0pLAo+ID4gLQlDT1VOVEVSX0NPVU5UX0VOVU1f
QVZBSUxBQkxFKCJlcnJvcl9ub2lzZSIsICZxdWFkOF9lcnJvcl9ub2lzZV9lbnVtKSwKPiA+IC0J
ewo+ID4gLQkJLm5hbWUgPSAicHJlc2V0IiwKPiA+IC0JCS5yZWFkID0gcXVhZDhfY291bnRfcHJl
c2V0X3JlYWQsCj4gPiAtCQkud3JpdGUgPSBxdWFkOF9jb3VudF9wcmVzZXRfd3JpdGUKPiA+IC0J
fSwKPiA+IC0Jewo+ID4gLQkJLm5hbWUgPSAicHJlc2V0X2VuYWJsZSIsCj4gPiAtCQkucmVhZCA9
IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfcmVhZCwKPiA+IC0JCS53cml0ZSA9IHF1YWQ4X2Nv
dW50X3ByZXNldF9lbmFibGVfd3JpdGUKPiA+IC0JfQo+ID4gK3N0YXRpYyBjb25zdCBlbnVtIGNv
dW50ZXJfY291bnRfbW9kZSBxdWFkOF9jbnRfbW9kZXNbXSA9IHsKPiA+ICsJQ09VTlRFUl9DT1VO
VF9NT0RFX05PUk1BTCwKPiA+ICsJQ09VTlRFUl9DT1VOVF9NT0RFX1JBTkdFX0xJTUlULAo+ID4g
KwlDT1VOVEVSX0NPVU5UX01PREVfTk9OX1JFQ1lDTEUsCj4gPiArCUNPVU5URVJfQ09VTlRfTU9E
RV9NT0RVTE9fTiwKPiA+ICt9Owo+ID4gKwo+ID4gK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9BVkFJ
TEFCTEUocXVhZDhfY291bnRfbW9kZV9hdmFpbGFibGUsIHF1YWQ4X2NudF9tb2Rlcyk7Cj4gPiAr
Cj4gPiArc3RhdGljIERFRklORV9DT1VOVEVSX0VOVU0ocXVhZDhfZXJyb3Jfbm9pc2VfZW51bSwg
cXVhZDhfbm9pc2VfZXJyb3Jfc3RhdGVzKTsKPiA+ICsKPiA+ICtzdGF0aWMgc3RydWN0IGNvdW50
ZXJfY29tcCBxdWFkOF9jb3VudF9leHRbXSA9IHsKPiA+ICsJQ09VTlRFUl9DT01QX0NFSUxJTkco
cXVhZDhfY291bnRfY2VpbGluZ19yZWFkLAo+ID4gKwkJCSAgICAgcXVhZDhfY291bnRfY2VpbGlu
Z193cml0ZSksCj4gPiArCUNPVU5URVJfQ09NUF9GTE9PUihxdWFkOF9jb3VudF9mbG9vcl9yZWFk
LCBOVUxMKSwKPiA+ICsJQ09VTlRFUl9DT01QX0NPVU5UX01PREUocXVhZDhfY291bnRfbW9kZV9y
ZWFkLCBxdWFkOF9jb3VudF9tb2RlX3dyaXRlLAo+ID4gKwkJCQlxdWFkOF9jb3VudF9tb2RlX2F2
YWlsYWJsZSksCj4gPiArCUNPVU5URVJfQ09NUF9ESVJFQ1RJT04ocXVhZDhfZGlyZWN0aW9uX3Jl
YWQpLAo+ID4gKwlDT1VOVEVSX0NPTVBfRU5BQkxFKHF1YWQ4X2NvdW50X2VuYWJsZV9yZWFkLCBx
dWFkOF9jb3VudF9lbmFibGVfd3JpdGUpLAo+ID4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfRU5VTSgi
ZXJyb3Jfbm9pc2UiLCBxdWFkOF9lcnJvcl9ub2lzZV9nZXQsIE5VTEwsCj4gPiArCQkJCXF1YWQ4
X2Vycm9yX25vaXNlX2VudW0pLAo+ID4gKwlDT1VOVEVSX0NPTVBfUFJFU0VUKHF1YWQ4X2NvdW50
X3ByZXNldF9yZWFkLCBxdWFkOF9jb3VudF9wcmVzZXRfd3JpdGUpLAo+ID4gKwlDT1VOVEVSX0NP
TVBfUFJFU0VUX0VOQUJMRShxdWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3JlYWQsCj4gPiArCQkJ
CSAgIHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3JpdGUpLAo+ID4gIH07Cj4gPiAgCj4gPiAg
I2RlZmluZSBRVUFEOF9DT1VOVChfaWQsIF9jbnRuYW1lKSB7CQkJCQlcCj4gPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9jb3VudGVyL01ha2VmaWxlIGIvZHJpdmVycy9jb3VudGVyL01ha2VmaWxlCj4g
PiBpbmRleCAxOTc0MmU2ZjVlM2UuLjFhYjdlMDg3ZmRjMiAxMDA2NDQKPiA+IC0tLSBhL2RyaXZl
cnMvY291bnRlci9NYWtlZmlsZQo+ID4gKysrIGIvZHJpdmVycy9jb3VudGVyL01ha2VmaWxlCj4g
PiBAQCAtNCw2ICs0LDcgQEAKPiA+ICAjCj4gPiAgCj4gPiAgb2JqLSQoQ09ORklHX0NPVU5URVIp
ICs9IGNvdW50ZXIubwo+ID4gK2NvdW50ZXIteSA6PSBjb3VudGVyLWNvcmUubyBjb3VudGVyLXN5
c2ZzLm8KPiA+ICAKPiA+ICBvYmotJChDT05GSUdfMTA0X1FVQURfOCkJKz0gMTA0LXF1YWQtOC5v
Cj4gPiAgb2JqLSQoQ09ORklHX0lOVEVSUlVQVF9DTlQpCQkrPSBpbnRlcnJ1cHQtY250Lm8KPiA+
IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci1jb3JlLmMgYi9kcml2ZXJzL2Nv
dW50ZXIvY291bnRlci1jb3JlLmMKPiA+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gPiBpbmRleCAw
MDAwMDAwMDAwMDAuLmM1MzNhNmZmMTJjZgo+ID4gLS0tIC9kZXYvbnVsbAo+ID4gKysrIGIvZHJp
dmVycy9jb3VudGVyL2NvdW50ZXItY29yZS5jCj4gPiBAQCAtMCwwICsxLDE0MiBAQAo+ID4gKy8v
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wCj4gPiArLyoKPiA+ICsgKiBHZW5lcmlj
IENvdW50ZXIgaW50ZXJmYWNlCj4gPiArICogQ29weXJpZ2h0IChDKSAyMDIwIFdpbGxpYW0gQnJl
YXRoaXR0IEdyYXkKPiA+ICsgKi8KPiA+ICsjaW5jbHVkZSA8bGludXgvY291bnRlci5oPgo+ID4g
KyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvZXhwb3J0Lmg+
Cj4gPiArI2luY2x1ZGUgPGxpbnV4L2dmcC5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9pZHIuaD4K
PiA+ICsjaW5jbHVkZSA8bGludXgvaW5pdC5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC9tb2R1bGUu
aD4KPiA+ICsKPiA+ICsjaW5jbHVkZSAiY291bnRlci1zeXNmcy5oIgo+ID4gKwo+ID4gKy8qIFBy
b3ZpZGVzIGEgdW5pcXVlIElEIGZvciBlYWNoIGNvdW50ZXIgZGV2aWNlICovCj4gPiArc3RhdGlj
IERFRklORV9JREEoY291bnRlcl9pZGEpOwo+ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGNvdW50ZXJf
ZGV2aWNlX3JlbGVhc2Uoc3RydWN0IGRldmljZSAqZGV2KQo+ID4gK3sKPiA+ICsJaWRhX2ZyZWUo
JmNvdW50ZXJfaWRhLCBkZXYtPmlkKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHN0cnVjdCBk
ZXZpY2VfdHlwZSBjb3VudGVyX2RldmljZV90eXBlID0gewo+ID4gKwkubmFtZSA9ICJjb3VudGVy
X2RldmljZSIsCj4gPiArCS5yZWxlYXNlID0gY291bnRlcl9kZXZpY2VfcmVsZWFzZSwKPiA+ICt9
Owo+ID4gKwo+ID4gK3N0YXRpYyBzdHJ1Y3QgYnVzX3R5cGUgY291bnRlcl9idXNfdHlwZSA9IHsK
PiA+ICsJLm5hbWUgPSAiY291bnRlciIsCj4gPiArCS5kZXZfbmFtZSA9ICJjb3VudGVyIiwKPiA+
ICt9Owo+ID4gKwo+ID4gKy8qKgo+ID4gKyAqIGNvdW50ZXJfcmVnaXN0ZXIgLSByZWdpc3RlciBD
b3VudGVyIHRvIHRoZSBzeXN0ZW0KPiA+ICsgKiBAY291bnRlcjoJcG9pbnRlciB0byBDb3VudGVy
IHRvIHJlZ2lzdGVyCj4gPiArICoKPiA+ICsgKiBUaGlzIGZ1bmN0aW9uIHJlZ2lzdGVycyBhIENv
dW50ZXIgdG8gdGhlIHN5c3RlbS4gQSBzeXNmcyAiY291bnRlciIgZGlyZWN0b3J5Cj4gPiArICog
d2lsbCBiZSBjcmVhdGVkIGFuZCBwb3B1bGF0ZWQgd2l0aCBzeXNmcyBhdHRyaWJ1dGVzIGNvcnJl
bGF0aW5nIHdpdGggdGhlCj4gPiArICogQ291bnRlciBTaWduYWxzLCBTeW5hcHNlcywgYW5kIENv
dW50cyByZXNwZWN0aXZlbHkuCj4gPiArICovCj4gPiAraW50IGNvdW50ZXJfcmVnaXN0ZXIoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+ID4gK3sKPiA+ICsJc3RydWN0IGRl
dmljZSAqY29uc3QgZGV2ID0gJmNvdW50ZXItPmRldjsKPiA+ICsJaW50IGlkOwo+ID4gKwlpbnQg
ZXJyOwo+ID4gKwo+ID4gKwkvKiBBY3F1aXJlIHVuaXF1ZSBJRCAqLwo+ID4gKwlpZCA9IGlkYV9h
bGxvYygmY291bnRlcl9pZGEsIEdGUF9LRVJORUwpOwo+ID4gKwlpZiAoaWQgPCAwKQo+ID4gKwkJ
cmV0dXJuIGlkOwo+ID4gKwo+ID4gKwkvKiBDb25maWd1cmUgZGV2aWNlIHN0cnVjdHVyZSBmb3Ig
Q291bnRlciAqLwo+ID4gKwlkZXYtPmlkID0gaWQ7Cj4gPiArCWRldi0+dHlwZSA9ICZjb3VudGVy
X2RldmljZV90eXBlOwo+ID4gKwlkZXYtPmJ1cyA9ICZjb3VudGVyX2J1c190eXBlOwo+ID4gKwlp
ZiAoY291bnRlci0+cGFyZW50KSB7Cj4gPiArCQlkZXYtPnBhcmVudCA9IGNvdW50ZXItPnBhcmVu
dDsKPiA+ICsJCWRldi0+b2Zfbm9kZSA9IGNvdW50ZXItPnBhcmVudC0+b2Zfbm9kZTsKPiA+ICsJ
fQo+ID4gKwlkZXZpY2VfaW5pdGlhbGl6ZShkZXYpOwo+ID4gKwlkZXZfc2V0X2RydmRhdGEoZGV2
LCBjb3VudGVyKTsKPiA+ICsKPiA+ICsJLyogQWRkIENvdW50ZXIgc3lzZnMgYXR0cmlidXRlcyAq
Lwo+ID4gKwllcnIgPSBjb3VudGVyX3N5c2ZzX2FkZChjb3VudGVyKTsKPiA+ICsJaWYgKGVyciA8
IDApCj4gPiArCQlnb3RvIGVycl9mcmVlX2lkOwo+ID4gKwo+ID4gKwkvKiBBZGQgZGV2aWNlIHRv
IHN5c3RlbSAqLwo+ID4gKwllcnIgPSBkZXZpY2VfYWRkKGRldik7Cj4gPiArCWlmIChlcnIgPCAw
KQo+ID4gKwkJZ290byBlcnJfZnJlZV9pZDsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiArCj4g
PiArZXJyX2ZyZWVfaWQ6Cj4gPiArCXB1dF9kZXZpY2UoZGV2KTsKPiA+ICsJcmV0dXJuIGVycjsK
PiA+ICt9Cj4gPiArRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9yZWdpc3Rlcik7Cj4gPiArCj4g
PiArLyoqCj4gPiArICogY291bnRlcl91bnJlZ2lzdGVyIC0gdW5yZWdpc3RlciBDb3VudGVyIGZy
b20gdGhlIHN5c3RlbQo+ID4gKyAqIEBjb3VudGVyOglwb2ludGVyIHRvIENvdW50ZXIgdG8gdW5y
ZWdpc3Rlcgo+ID4gKyAqCj4gPiArICogVGhlIENvdW50ZXIgaXMgdW5yZWdpc3RlcmVkIGZyb20g
dGhlIHN5c3RlbS4KPiA+ICsgKi8KPiA+ICt2b2lkIGNvdW50ZXJfdW5yZWdpc3RlcihzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gPiArewo+ID4gKwlpZiAoIWNvdW50ZXIp
Cj4gPiArCQlyZXR1cm47Cj4gPiArCj4gPiArCWRldmljZV91bnJlZ2lzdGVyKCZjb3VudGVyLT5k
ZXYpOwo+ID4gK30KPiA+ICtFWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3VucmVnaXN0ZXIpOwo+
ID4gKwo+ID4gK3N0YXRpYyB2b2lkIGRldm1fY291bnRlcl9yZWxlYXNlKHZvaWQgKmNvdW50ZXIp
Cj4gPiArewo+ID4gKwljb3VudGVyX3VucmVnaXN0ZXIoY291bnRlcik7Cj4gPiArfQo+ID4gKwo+
ID4gKy8qKgo+ID4gKyAqIGRldm1fY291bnRlcl9yZWdpc3RlciAtIFJlc291cmNlLW1hbmFnZWQg
Y291bnRlcl9yZWdpc3Rlcgo+ID4gKyAqIEBkZXY6CWRldmljZSB0byBhbGxvY2F0ZSBjb3VudGVy
X2RldmljZSBmb3IKPiA+ICsgKiBAY291bnRlcjoJcG9pbnRlciB0byBDb3VudGVyIHRvIHJlZ2lz
dGVyCj4gPiArICoKPiA+ICsgKiBNYW5hZ2VkIGNvdW50ZXJfcmVnaXN0ZXIuIFRoZSBDb3VudGVy
IHJlZ2lzdGVyZWQgd2l0aCB0aGlzIGZ1bmN0aW9uIGlzCj4gPiArICogYXV0b21hdGljYWxseSB1
bnJlZ2lzdGVyZWQgb24gZHJpdmVyIGRldGFjaC4gVGhpcyBmdW5jdGlvbiBjYWxscwo+ID4gKyAq
IGNvdW50ZXJfcmVnaXN0ZXIgaW50ZXJuYWxseS4gUmVmZXIgdG8gdGhhdCBmdW5jdGlvbiBmb3Ig
bW9yZSBpbmZvcm1hdGlvbi4KPiA+ICsgKgo+ID4gKyAqIFJFVFVSTlM6Cj4gPiArICogMCBvbiBz
dWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBudW1iZXIgb24gZmFpbHVyZS4KPiA+ICsgKi8KPiA+ICtp
bnQgZGV2bV9jb3VudGVyX3JlZ2lzdGVyKHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+ICsJCQkgIHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiA+ICt7Cj4gPiArCWludCBlcnI7
Cj4gPiArCj4gPiArCWVyciA9IGNvdW50ZXJfcmVnaXN0ZXIoY291bnRlcik7Cj4gPiArCWlmIChl
cnIgPCAwKQo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsKPiA+ICsJcmV0dXJuIGRldm1fYWRkX2Fj
dGlvbl9vcl9yZXNldChkZXYsIGRldm1fY291bnRlcl9yZWxlYXNlLCBjb3VudGVyKTsKPiA+ICt9
Cj4gPiArRVhQT1JUX1NZTUJPTF9HUEwoZGV2bV9jb3VudGVyX3JlZ2lzdGVyKTsKPiA+ICsKPiA+
ICtzdGF0aWMgaW50IF9faW5pdCBjb3VudGVyX2luaXQodm9pZCkKPiA+ICt7Cj4gPiArCXJldHVy
biBidXNfcmVnaXN0ZXIoJmNvdW50ZXJfYnVzX3R5cGUpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0
aWMgdm9pZCBfX2V4aXQgY291bnRlcl9leGl0KHZvaWQpCj4gPiArewo+ID4gKwlidXNfdW5yZWdp
c3RlcigmY291bnRlcl9idXNfdHlwZSk7Cj4gPiArfQo+ID4gKwo+ID4gK3N1YnN5c19pbml0Y2Fs
bChjb3VudGVyX2luaXQpOwo+ID4gK21vZHVsZV9leGl0KGNvdW50ZXJfZXhpdCk7Cj4gPiArCj4g
PiArTU9EVUxFX0FVVEhPUigiV2lsbGlhbSBCcmVhdGhpdHQgR3JheSA8dmlsaGVsbS5ncmF5QGdt
YWlsLmNvbT4iKTsKPiA+ICtNT0RVTEVfREVTQ1JJUFRJT04oIkdlbmVyaWMgQ291bnRlciBpbnRl
cmZhY2UiKTsKPiA+ICtNT0RVTEVfTElDRU5TRSgiR1BMIHYyIik7Cj4gPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuYyBiL2RyaXZlcnMvY291bnRlci9jb3VudGVy
LXN5c2ZzLmMKPiA+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gPiBpbmRleCAwMDAwMDAwMDAwMDAu
LjEwOGNiZDgzOGViOQo+ID4gLS0tIC9kZXYvbnVsbAo+ID4gKysrIGIvZHJpdmVycy9jb3VudGVy
L2NvdW50ZXItc3lzZnMuYwo+ID4gQEAgLTAsMCArMSw4NDkgQEAKPiA+ICsvLyBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMAo+ID4gKy8qCj4gPiArICogR2VuZXJpYyBDb3VudGVyIHN5
c2ZzIGludGVyZmFjZQo+ID4gKyAqIENvcHlyaWdodCAoQykgMjAyMCBXaWxsaWFtIEJyZWF0aGl0
dCBHcmF5Cj4gPiArICovCj4gPiArI2luY2x1ZGUgPGxpbnV4L2NvdW50ZXIuaD4KPiA+ICsjaW5j
bHVkZSA8bGludXgvZGV2aWNlLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgo+ID4gKyNp
bmNsdWRlIDxsaW51eC9nZnAuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgva2VybmVsLmg+Cj4gPiAr
I2luY2x1ZGUgPGxpbnV4L2tzdHJ0b3guaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvbGlzdC5oPgo+
ID4gKyNpbmNsdWRlIDxsaW51eC9zdHJpbmcuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvc3lzZnMu
aD4KPiA+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KPiA+ICsKPiA+ICsjaW5jbHVkZSAiY291
bnRlci1zeXNmcy5oIgo+ID4gKwo+ID4gKy8qKgo+ID4gKyAqIHN0cnVjdCBjb3VudGVyX2F0dHJp
YnV0ZSAtIENvdW50ZXIgc3lzZnMgYXR0cmlidXRlCj4gPiArICogQGRldl9hdHRyOglkZXZpY2Ug
YXR0cmlidXRlIGZvciBzeXNmcwo+ID4gKyAqIEBsOgkJbm9kZSB0byBhZGQgQ291bnRlciBhdHRy
aWJ1dGUgdG8gYXR0cmlidXRlIGdyb3VwIGxpc3QKPiA+ICsgKiBAY29tcDoJQ291bnRlciBjb21w
b25lbnQgY2FsbGJhY2tzIGFuZCBkYXRhCj4gPiArICogQHNjb3BlOglDb3VudGVyIHNjb3BlIG9m
IHRoZSBhdHRyaWJ1dGUKPiA+ICsgKiBAcGFyZW50Oglwb2ludGVyIHRvIHRoZSBwYXJlbnQgY29t
cG9uZW50Cj4gPiArICovCj4gPiArc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlIHsKPiA+ICsJc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgZGV2X2F0dHI7Cj4gPiArCXN0cnVjdCBsaXN0X2hlYWQgbDsK
PiA+ICsKPiA+ICsJc3RydWN0IGNvdW50ZXJfY29tcCBjb21wOwo+ID4gKwllbnVtIGNvdW50ZXJf
c2NvcGUgc2NvcGU7Cj4gPiArCXZvaWQgKnBhcmVudDsKPiA+ICt9Owo+ID4gKwo+ID4gKyNkZWZp
bmUgdG9fY291bnRlcl9hdHRyaWJ1dGUoX2Rldl9hdHRyKSBcCj4gPiArCWNvbnRhaW5lcl9vZihf
ZGV2X2F0dHIsIHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSwgZGV2X2F0dHIpCj4gPiArCj4gPiAr
LyoqCj4gPiArICogc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwIC0gY29udGFpbmVyIGZv
ciBhdHRyaWJ1dGUgZ3JvdXAKPiA+ICsgKiBAbmFtZToJbmFtZSBvZiB0aGUgYXR0cmlidXRlIGdy
b3VwCj4gPiArICogQGF0dHJfbGlzdDoJbGlzdCB0byBrZWVwIHRyYWNrIG9mIGNyZWF0ZWQgYXR0
cmlidXRlcwo+ID4gKyAqIEBudW1fYXR0cjoJbnVtYmVyIG9mIGF0dHJpYnV0ZXMKPiA+ICsgKi8K
PiA+ICtzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgewo+ID4gKwljb25zdCBjaGFyICpu
YW1lOwo+ID4gKwlzdHJ1Y3QgbGlzdF9oZWFkIGF0dHJfbGlzdDsKPiA+ICsJc2l6ZV90IG51bV9h
dHRyOwo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJf
ZnVuY3Rpb25fc3RyW10gPSB7Cj4gPiArCVtDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFXSA9ICJp
bmNyZWFzZSIsCj4gPiArCVtDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFXSA9ICJkZWNyZWFzZSIs
Cj4gPiArCVtDT1VOVEVSX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTl0gPSAicHVsc2UtZGlyZWN0
aW9uIiwKPiA+ICsJW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BXSA9ICJxdWFkcmF0
dXJlIHgxIGEiLAo+ID4gKwlbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0JdID0gInF1
YWRyYXR1cmUgeDEgYiIsCj4gPiArCVtDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQV0g
PSAicXVhZHJhdHVyZSB4MiBhIiwKPiA+ICsJW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
Ml9CXSA9ICJxdWFkcmF0dXJlIHgyIGIiLAo+ID4gKwlbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFU
VVJFX1g0XSA9ICJxdWFkcmF0dXJlIHg0Igo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIGNvbnN0
IGNoYXIgKmNvbnN0IGNvdW50ZXJfc2lnbmFsX3ZhbHVlX3N0cltdID0gewo+ID4gKwlbQ09VTlRF
Ul9TSUdOQUxfTEVWRUxfTE9XXSA9ICJsb3ciLAo+ID4gKwlbQ09VTlRFUl9TSUdOQUxfTEVWRUxf
SElHSF0gPSAiaGlnaCIKPiA+ICt9Owo+ID4gKwo+ID4gK3N0YXRpYyBjb25zdCBjaGFyICpjb25z
dCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0cltdID0gewo+ID4gKwlbQ09VTlRFUl9TWU5BUFNF
X0FDVElPTl9OT05FXSA9ICJub25lIiwKPiA+ICsJW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklT
SU5HX0VER0VdID0gInJpc2luZyBlZGdlIiwKPiA+ICsJW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05f
RkFMTElOR19FREdFXSA9ICJmYWxsaW5nIGVkZ2UiLAo+ID4gKwlbQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9CT1RIX0VER0VTXSA9ICJib3RoIGVkZ2VzIgo+ID4gK307Cj4gPiArCj4gPiArc3RhdGlj
IGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfY291bnRfZGlyZWN0aW9uX3N0cltdID0gewo+ID4g
KwlbQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fRk9SV0FSRF0gPSAiZm9yd2FyZCIsCj4gPiArCVtD
T1VOVEVSX0NPVU5UX0RJUkVDVElPTl9CQUNLV0FSRF0gPSAiYmFja3dhcmQiCj4gPiArfTsKPiA+
ICsKPiA+ICtzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9jb3VudF9tb2RlX3N0cltd
ID0gewo+ID4gKwlbQ09VTlRFUl9DT1VOVF9NT0RFX05PUk1BTF0gPSAibm9ybWFsIiwKPiA+ICsJ
W0NPVU5URVJfQ09VTlRfTU9ERV9SQU5HRV9MSU1JVF0gPSAicmFuZ2UgbGltaXQiLAo+ID4gKwlb
Q09VTlRFUl9DT1VOVF9NT0RFX05PTl9SRUNZQ0xFXSA9ICJub24tcmVjeWNsZSIsCj4gPiArCVtD
T1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX05dID0gIm1vZHVsby1uIgo+ID4gK307Cj4gPiArCj4g
PiArc3RhdGljIHNzaXplX3QgY291bnRlcl9jb21wX3U4X3Nob3coc3RydWN0IGRldmljZSAqZGV2
LAo+ID4gKwkJCQkgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikK
PiA+ICt7Cj4gPiArCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9IHRv
X2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ID4gKwlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
bnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiA+ICsJaW50IGVycjsKPiA+ICsJ
dTggZGF0YSA9IDA7Cj4gPiArCj4gPiArCXN3aXRjaCAoYS0+c2NvcGUpIHsKPiA+ICsJY2FzZSBD
T1VOVEVSX1NDT1BFX0RFVklDRToKPiA+ICsJCWVyciA9IGEtPmNvbXAuZGV2aWNlX3U4X3JlYWQo
Y291bnRlciwgJmRhdGEpOwo+ID4gKwkJYnJlYWs7Cj4gPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9T
SUdOQUw6Cj4gPiArCQllcnIgPSBhLT5jb21wLnNpZ25hbF91OF9yZWFkKGNvdW50ZXIsIGEtPnBh
cmVudCwgJmRhdGEpOwo+ID4gKwkJYnJlYWs7Cj4gPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9DT1VO
VDoKPiA+ICsJCWVyciA9IGEtPmNvbXAuY291bnRfdThfcmVhZChjb3VudGVyLCBhLT5wYXJlbnQs
ICZkYXRhKTsKPiA+ICsJCWJyZWFrOwo+ID4gKwlkZWZhdWx0Ogo+ID4gKwkJcmV0dXJuIC1FSU5W
QUw7Cj4gPiArCX0KPiA+ICsJaWYgKGVyciA8IDApCj4gPiArCQlyZXR1cm4gZXJyOwo+ID4gKwo+
ID4gKwlpZiAoYS0+Y29tcC50eXBlID09IENPVU5URVJfQ09NUF9CT09MKQo+ID4gKwkJLyogZGF0
YSBzaG91bGQgYWxyZWFkeSBiZSBib29sZWFuIGJ1dCBlbnN1cmUganVzdCB0byBiZSBzYWZlICov
Cj4gPiArCQlkYXRhID0gISFkYXRhOwo+ID4gKwo+ID4gKwlyZXR1cm4gc3ByaW50ZihidWYsICIl
dVxuIiwgKHVuc2lnbmVkIGludClkYXRhKTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHNzaXpl
X3QgY291bnRlcl9jb21wX3U4X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+ICsJCQkJICAg
ICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiA+ICsJCQkJICAgICBjb25zdCBjaGFy
ICpidWYsIHNpemVfdCBsZW4pCj4gPiArewo+ID4gKwljb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRy
aWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKPiA+ICsJc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4g
PiArCWludCBlcnI7Cj4gPiArCWJvb2wgYm9vbF9kYXRhID0gMDsKPiA+ICsJdTggZGF0YSA9IDA7
Cj4gPiArCj4gPiArCWlmIChhLT5jb21wLnR5cGUgPT0gQ09VTlRFUl9DT01QX0JPT0wpIHsKPiA+
ICsJCWVyciA9IGtzdHJ0b2Jvb2woYnVmLCAmYm9vbF9kYXRhKTsKPiA+ICsJCWRhdGEgPSBib29s
X2RhdGE7Cj4gPiArCX0gZWxzZQo+ID4gKwkJZXJyID0ga3N0cnRvdTgoYnVmLCAwLCAmZGF0YSk7
Cj4gPiArCWlmIChlcnIgPCAwKQo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsKPiA+ICsJc3dpdGNo
IChhLT5zY29wZSkgewo+ID4gKwljYXNlIENPVU5URVJfU0NPUEVfREVWSUNFOgo+ID4gKwkJZXJy
ID0gYS0+Y29tcC5kZXZpY2VfdThfd3JpdGUoY291bnRlciwgZGF0YSk7Cj4gPiArCQlicmVhazsK
PiA+ICsJY2FzZSBDT1VOVEVSX1NDT1BFX1NJR05BTDoKPiA+ICsJCWVyciA9IGEtPmNvbXAuc2ln
bmFsX3U4X3dyaXRlKGNvdW50ZXIsIGEtPnBhcmVudCwgZGF0YSk7Cj4gPiArCQlicmVhazsKPiA+
ICsJY2FzZSBDT1VOVEVSX1NDT1BFX0NPVU5UOgo+ID4gKwkJZXJyID0gYS0+Y29tcC5jb3VudF91
OF93cml0ZShjb3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+ID4gKwkJYnJlYWs7Cj4gPiArCWRl
ZmF1bHQ6Cj4gPiArCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICsJfQo+ID4gKwlpZiAoZXJyIDwgMCkK
PiA+ICsJCXJldHVybiBlcnI7Cj4gPiArCj4gPiArCXJldHVybiBsZW47Cj4gPiArfQo+ID4gKwo+
ID4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91MzJfc2hvdyhzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4gPiArCQkJCSAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1
ZikKPiA+ICt7Cj4gPiArCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9
IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ID4gKwlzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiA+ICsJY29uc3Qgc3RydWN0
IGNvdW50ZXJfYXZhaWxhYmxlICpjb25zdCBhdmFpbCA9IGEtPmNvbXAucHJpdjsKPiA+ICsJaW50
IGVycjsKPiA+ICsJdTMyIGRhdGEgPSAwOwo+ID4gKwo+ID4gKwlzd2l0Y2ggKGEtPnNjb3BlKSB7
Cj4gPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9ERVZJQ0U6Cj4gPiArCQllcnIgPSBhLT5jb21wLmRl
dmljZV91MzJfcmVhZChjb3VudGVyLCAmZGF0YSk7Cj4gPiArCQlicmVhazsKPiA+ICsJY2FzZSBD
T1VOVEVSX1NDT1BFX1NJR05BTDoKPiA+ICsJCWVyciA9IGEtPmNvbXAuc2lnbmFsX3UzMl9yZWFk
KGNvdW50ZXIsIGEtPnBhcmVudCwgJmRhdGEpOwo+ID4gKwkJYnJlYWs7Cj4gPiArCWNhc2UgQ09V
TlRFUl9TQ09QRV9DT1VOVDoKPiA+ICsJCWlmIChhLT5jb21wLnR5cGUgPT0gQ09VTlRFUl9DT01Q
X1NZTkFQU0VfQUNUSU9OKQo+ID4gKwkJCWVyciA9IGEtPmNvbXAuYWN0aW9uX3JlYWQoY291bnRl
ciwgYS0+cGFyZW50LAo+ID4gKwkJCQkJCSAgYS0+Y29tcC5wcml2LCAmZGF0YSk7Cj4gPiArCQll
bHNlCj4gPiArCQkJZXJyID0gYS0+Y29tcC5jb3VudF91MzJfcmVhZChjb3VudGVyLCBhLT5wYXJl
bnQsICZkYXRhKTsKPiA+ICsJCWJyZWFrOwo+ID4gKwlkZWZhdWx0Ogo+ID4gKwkJcmV0dXJuIC1F
SU5WQUw7Cj4gPiArCX0KPiA+ICsJaWYgKGVyciA8IDApCj4gPiArCQlyZXR1cm4gZXJyOwo+ID4g
Kwo+ID4gKwlzd2l0Y2ggKGEtPmNvbXAudHlwZSkgewo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9G
VU5DVElPTjoKPiA+ICsJCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBjb3VudGVyX2Z1
bmN0aW9uX3N0cltkYXRhXSk7Cj4gPiArCWNhc2UgQ09VTlRFUl9DT01QX1NJR05BTF9MRVZFTDoK
PiA+ICsJCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBjb3VudGVyX3NpZ25hbF92YWx1
ZV9zdHJbZGF0YV0pOwo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjoKPiA+
ICsJCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBjb3VudGVyX3N5bmFwc2VfYWN0aW9u
X3N0cltkYXRhXSk7Cj4gPiArCWNhc2UgQ09VTlRFUl9DT01QX0VOVU06Cj4gPiArCQlyZXR1cm4g
c3lzZnNfZW1pdChidWYsICIlc1xuIiwgYXZhaWwtPnN0cnNbZGF0YV0pOwo+ID4gKwljYXNlIENP
VU5URVJfQ09NUF9DT1VOVF9ESVJFQ1RJT046Cj4gPiArCQlyZXR1cm4gc3lzZnNfZW1pdChidWYs
ICIlc1xuIiwgY291bnRlcl9jb3VudF9kaXJlY3Rpb25fc3RyW2RhdGFdKTsKPiA+ICsJY2FzZSBD
T1VOVEVSX0NPTVBfQ09VTlRfTU9ERToKPiA+ICsJCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVz
XG4iLCBjb3VudGVyX2NvdW50X21vZGVfc3RyW2RhdGFdKTsKPiA+ICsJZGVmYXVsdDoKPiA+ICsJ
CXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAodW5zaWduZWQgaW50KWRhdGEpOwo+ID4gKwl9
Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgY291bnRlcl9maW5kX2VudW0odTMyICpjb25z
dCBlbnVtX2l0ZW0sIGNvbnN0IHUzMiAqY29uc3QgZW51bXMsCj4gPiArCQkJICAgICBjb25zdCBz
aXplX3QgbnVtX2VudW1zLCBjb25zdCBjaGFyICpjb25zdCBidWYsCj4gPiArCQkJICAgICBjb25z
dCBjaGFyICpjb25zdCBzdHJpbmdfYXJyYXlbXSkKPiA+ICt7Cj4gPiArCXNpemVfdCBpbmRleDsK
PiA+ICsKPiA+ICsJZm9yIChpbmRleCA9IDA7IGluZGV4IDwgbnVtX2VudW1zOyBpbmRleCsrKSB7
Cj4gPiArCQkqZW51bV9pdGVtID0gZW51bXNbaW5kZXhdOwo+ID4gKwkJaWYgKHN5c2ZzX3N0cmVx
KGJ1Ziwgc3RyaW5nX2FycmF5WyplbnVtX2l0ZW1dKSkKPiA+ICsJCQlyZXR1cm4gMDsKPiA+ICsJ
fQo+ID4gKwo+ID4gKwlyZXR1cm4gLUVJTlZBTDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIHNz
aXplX3QgY291bnRlcl9jb21wX3UzMl9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gPiArCQkJ
CSAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ID4gKwkJCQkgICAgICBjb25z
dCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gPiArewo+ID4gKwljb25zdCBzdHJ1Y3QgY291bnRl
cl9hdHRyaWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKPiA+ICsJ
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRl
dik7Cj4gPiArCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGEtPnBhcmVudDsK
PiA+ICsJc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGEtPmNvbXAucHJp
djsKPiA+ICsJY29uc3Qgc3RydWN0IGNvdW50ZXJfYXZhaWxhYmxlICpjb25zdCBhdmFpbCA9IGEt
PmNvbXAucHJpdjsKPiA+ICsJaW50IGVycjsKPiA+ICsJdTMyIGRhdGEgPSAwOwo+ID4gKwo+ID4g
Kwlzd2l0Y2ggKGEtPmNvbXAudHlwZSkgewo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9GVU5DVElP
TjoKPiA+ICsJCWVyciA9IGNvdW50ZXJfZmluZF9lbnVtKCZkYXRhLCBjb3VudC0+ZnVuY3Rpb25z
X2xpc3QsCj4gPiArCQkJCQljb3VudC0+bnVtX2Z1bmN0aW9ucywgYnVmLAo+ID4gKwkJCQkJY291
bnRlcl9mdW5jdGlvbl9zdHIpOwo+ID4gKwkJYnJlYWs7Cj4gPiArCWNhc2UgQ09VTlRFUl9DT01Q
X1NZTkFQU0VfQUNUSU9OOgo+ID4gKwkJZXJyID0gY291bnRlcl9maW5kX2VudW0oJmRhdGEsIHN5
bmFwc2UtPmFjdGlvbnNfbGlzdCwKPiA+ICsJCQkJCXN5bmFwc2UtPm51bV9hY3Rpb25zLCBidWYs
Cj4gPiArCQkJCQljb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0cik7Cj4gPiArCQlicmVhazsKPiA+
ICsJY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKPiA+ICsJCWVyciA9IF9fc3lzZnNfbWF0Y2hfc3Ry
aW5nKGF2YWlsLT5zdHJzLCBhdmFpbC0+bnVtX2l0ZW1zLCBidWYpOwo+ID4gKwkJZGF0YSA9IGVy
cjsKPiA+ICsJCWJyZWFrOwo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9DT1VOVF9NT0RFOgo+ID4g
KwkJZXJyID0gY291bnRlcl9maW5kX2VudW0oJmRhdGEsIGF2YWlsLT5lbnVtcywgYXZhaWwtPm51
bV9pdGVtcywKPiA+ICsJCQkJCWJ1ZiwgY291bnRlcl9jb3VudF9tb2RlX3N0cik7Cj4gPiArCQli
cmVhazsKPiA+ICsJZGVmYXVsdDoKPiA+ICsJCWVyciA9IGtzdHJ0b3UzMihidWYsIDAsICZkYXRh
KTsKPiA+ICsJCWJyZWFrOwo+ID4gKwl9Cj4gPiArCWlmIChlcnIgPCAwKQo+ID4gKwkJcmV0dXJu
IGVycjsKPiA+ICsKPiA+ICsJc3dpdGNoIChhLT5zY29wZSkgewo+ID4gKwljYXNlIENPVU5URVJf
U0NPUEVfREVWSUNFOgo+ID4gKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdTMyX3dyaXRlKGNvdW50
ZXIsIGRhdGEpOwo+ID4gKwkJYnJlYWs7Cj4gPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9TSUdOQUw6
Cj4gPiArCQllcnIgPSBhLT5jb21wLnNpZ25hbF91MzJfd3JpdGUoY291bnRlciwgYS0+cGFyZW50
LCBkYXRhKTsKPiA+ICsJCWJyZWFrOwo+ID4gKwljYXNlIENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4g
PiArCQlpZiAoYS0+Y29tcC50eXBlID09IENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTikKPiA+
ICsJCQllcnIgPSBhLT5jb21wLmFjdGlvbl93cml0ZShjb3VudGVyLCBjb3VudCwgc3luYXBzZSwK
PiA+ICsJCQkJCQkgICBkYXRhKTsKPiA+ICsJCWVsc2UKPiA+ICsJCQllcnIgPSBhLT5jb21wLmNv
dW50X3UzMl93cml0ZShjb3VudGVyLCBjb3VudCwgZGF0YSk7Cj4gPiArCQlicmVhazsKPiA+ICsJ
ZGVmYXVsdDoKPiA+ICsJCXJldHVybiAtRUlOVkFMOwo+ID4gKwl9Cj4gPiArCWlmIChlcnIgPCAw
KQo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsKPiA+ICsJcmV0dXJuIGxlbjsKPiA+ICt9Cj4gPiAr
Cj4gPiArc3RhdGljIHNzaXplX3QgY291bnRlcl9jb21wX3U2NF9zaG93KHN0cnVjdCBkZXZpY2Ug
KmRldiwKPiA+ICsJCQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAq
YnVmKQo+ID4gK3sKPiA+ICsJY29uc3Qgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlICpjb25zdCBh
ID0gdG9fY291bnRlcl9hdHRyaWJ1dGUoYXR0cik7Cj4gPiArCXN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ID4gKwlpbnQgZXJyOwo+
ID4gKwl1NjQgZGF0YSA9IDA7Cj4gPiArCj4gPiArCXN3aXRjaCAoYS0+c2NvcGUpIHsKPiA+ICsJ
Y2FzZSBDT1VOVEVSX1NDT1BFX0RFVklDRToKPiA+ICsJCWVyciA9IGEtPmNvbXAuZGV2aWNlX3U2
NF9yZWFkKGNvdW50ZXIsICZkYXRhKTsKPiA+ICsJCWJyZWFrOwo+ID4gKwljYXNlIENPVU5URVJf
U0NPUEVfU0lHTkFMOgo+ID4gKwkJZXJyID0gYS0+Y29tcC5zaWduYWxfdTY0X3JlYWQoY291bnRl
ciwgYS0+cGFyZW50LCAmZGF0YSk7Cj4gPiArCQlicmVhazsKPiA+ICsJY2FzZSBDT1VOVEVSX1ND
T1BFX0NPVU5UOgo+ID4gKwkJZXJyID0gYS0+Y29tcC5jb3VudF91NjRfcmVhZChjb3VudGVyLCBh
LT5wYXJlbnQsICZkYXRhKTsKPiA+ICsJCWJyZWFrOwo+ID4gKwlkZWZhdWx0Ogo+ID4gKwkJcmV0
dXJuIC1FSU5WQUw7Cj4gPiArCX0KPiA+ICsJaWYgKGVyciA8IDApCj4gPiArCQlyZXR1cm4gZXJy
Owo+ID4gKwo+ID4gKwlyZXR1cm4gc3ByaW50ZihidWYsICIlbGx1XG4iLCAodW5zaWduZWQgbG9u
ZyBsb25nKWRhdGEpOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgc3NpemVfdCBjb3VudGVyX2Nv
bXBfdTY0X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+ICsJCQkJICAgICAgc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gPiArCQkJCSAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGxlbikKPiA+ICt7Cj4gPiArCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29u
c3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ID4gKwlzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiA+ICsJaW50IGVy
cjsKPiA+ICsJdTY0IGRhdGEgPSAwOwo+ID4gKwo+ID4gKwllcnIgPSBrc3RydG91NjQoYnVmLCAw
LCAmZGF0YSk7Cj4gPiArCWlmIChlcnIgPCAwKQo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsKPiA+
ICsJc3dpdGNoIChhLT5zY29wZSkgewo+ID4gKwljYXNlIENPVU5URVJfU0NPUEVfREVWSUNFOgo+
ID4gKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdTY0X3dyaXRlKGNvdW50ZXIsIGRhdGEpOwo+ID4g
KwkJYnJlYWs7Cj4gPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9TSUdOQUw6Cj4gPiArCQllcnIgPSBh
LT5jb21wLnNpZ25hbF91NjRfd3JpdGUoY291bnRlciwgYS0+cGFyZW50LCBkYXRhKTsKPiA+ICsJ
CWJyZWFrOwo+ID4gKwljYXNlIENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4gPiArCQllcnIgPSBhLT5j
b21wLmNvdW50X3U2NF93cml0ZShjb3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+ID4gKwkJYnJl
YWs7Cj4gPiArCWRlZmF1bHQ6Cj4gPiArCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICsJfQo+ID4gKwlp
ZiAoZXJyIDwgMCkKPiA+ICsJCXJldHVybiBlcnI7Cj4gPiArCj4gPiArCXJldHVybiBsZW47Cj4g
PiArfQo+ID4gKwo+ID4gK3N0YXRpYyBzc2l6ZV90IGVudW1zX2F2YWlsYWJsZV9zaG93KGNvbnN0
IHUzMiAqY29uc3QgZW51bXMsCj4gPiArCQkJCSAgICBjb25zdCBzaXplX3QgbnVtX2VudW1zLAo+
ID4gKwkJCQkgICAgY29uc3QgY2hhciAqY29uc3Qgc3Ryc1tdLCBjaGFyICpidWYpCj4gPiArewo+
ID4gKwlzaXplX3QgbGVuID0gMDsKPiA+ICsJc2l6ZV90IGluZGV4Owo+ID4gKwo+ID4gKwlmb3Ig
KGluZGV4ID0gMDsgaW5kZXggPCBudW1fZW51bXM7IGluZGV4KyspCj4gPiArCQlsZW4gKz0gc3lz
ZnNfZW1pdF9hdChidWYsIGxlbiwgIiVzXG4iLCBzdHJzW2VudW1zW2luZGV4XV0pOwo+ID4gKwo+
ID4gKwlyZXR1cm4gbGVuOwo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgc3NpemVfdCBzdHJzX2F2
YWlsYWJsZV9zaG93KGNvbnN0IHN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSAqY29uc3QgYXZhaWws
Cj4gPiArCQkJCSAgIGNoYXIgKmJ1ZikKPiA+ICt7Cj4gPiArCXNpemVfdCBsZW4gPSAwOwo+ID4g
KwlzaXplX3QgaW5kZXg7Cj4gPiArCj4gPiArCWZvciAoaW5kZXggPSAwOyBpbmRleCA8IGF2YWls
LT5udW1faXRlbXM7IGluZGV4KyspCj4gPiArCQlsZW4gKz0gc3lzZnNfZW1pdF9hdChidWYsIGxl
biwgIiVzXG4iLCBhdmFpbC0+c3Ryc1tpbmRleF0pOwo+ID4gKwo+ID4gKwlyZXR1cm4gbGVuOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvbXBfYXZhaWxhYmxlX3No
b3coc3RydWN0IGRldmljZSAqZGV2LAo+ID4gKwkJCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1
dGUgKmF0dHIsCj4gPiArCQkJCQkgICBjaGFyICpidWYpCj4gPiArewo+ID4gKwljb25zdCBzdHJ1
Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRy
KTsKPiA+ICsJY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gYS0+cGFy
ZW50Owo+ID4gKwljb25zdCBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpjb25zdCBzeW5hcHNlID0g
YS0+Y29tcC5wcml2Owo+ID4gKwljb25zdCBzdHJ1Y3QgY291bnRlcl9hdmFpbGFibGUgKmNvbnN0
IGF2YWlsID0gYS0+Y29tcC5wcml2Owo+ID4gKwo+ID4gKwlzd2l0Y2ggKGEtPmNvbXAudHlwZSkg
ewo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9GVU5DVElPTjoKPiA+ICsJCXJldHVybiBlbnVtc19h
dmFpbGFibGVfc2hvdyhjb3VudC0+ZnVuY3Rpb25zX2xpc3QsCj4gPiArCQkJCQkgICAgY291bnQt
Pm51bV9mdW5jdGlvbnMsCj4gPiArCQkJCQkgICAgY291bnRlcl9mdW5jdGlvbl9zdHIsIGJ1Zik7
Cj4gPiArCWNhc2UgQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OOgo+ID4gKwkJcmV0dXJuIGVu
dW1zX2F2YWlsYWJsZV9zaG93KHN5bmFwc2UtPmFjdGlvbnNfbGlzdCwKPiA+ICsJCQkJCSAgICBz
eW5hcHNlLT5udW1fYWN0aW9ucywKPiA+ICsJCQkJCSAgICBjb3VudGVyX3N5bmFwc2VfYWN0aW9u
X3N0ciwgYnVmKTsKPiA+ICsJY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKPiA+ICsJCXJldHVybiBz
dHJzX2F2YWlsYWJsZV9zaG93KGF2YWlsLCBidWYpOwo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9D
T1VOVF9NT0RFOgo+ID4gKwkJcmV0dXJuIGVudW1zX2F2YWlsYWJsZV9zaG93KGF2YWlsLT5lbnVt
cywgYXZhaWwtPm51bV9pdGVtcywKPiA+ICsJCQkJCSAgICBjb3VudGVyX2NvdW50X21vZGVfc3Ry
LCBidWYpOwo+ID4gKwlkZWZhdWx0Ogo+ID4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gPiArCX0KPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBjb3VudGVyX2F2YWlsX2F0dHJfY3JlYXRlKHN0cnVj
dCBkZXZpY2UgKmNvbnN0IGRldiwKPiA+ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3Vw
ICpjb25zdCBncm91cCwKPiA+ICsJY29uc3Qgc3RydWN0IGNvdW50ZXJfY29tcCAqY29uc3QgY29t
cCwgdm9pZCAqY29uc3QgcGFyZW50KQo+ID4gK3sKPiA+ICsJc3RydWN0IGNvdW50ZXJfYXR0cmli
dXRlICpjb3VudGVyX2F0dHI7Cj4gPiArCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICpkZXZfYXR0
cjsKPiA+ICsKPiA+ICsJY291bnRlcl9hdHRyID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKCpj
b3VudGVyX2F0dHIpLCBHRlBfS0VSTkVMKTsKPiA+ICsJaWYgKCFjb3VudGVyX2F0dHIpCj4gPiAr
CQlyZXR1cm4gLUVOT01FTTsKPiA+ICsKPiA+ICsJLyogQ29uZmlndXJlIENvdW50ZXIgYXR0cmli
dXRlICovCj4gPiArCWNvdW50ZXJfYXR0ci0+Y29tcC50eXBlID0gY29tcC0+dHlwZTsKPiA+ICsJ
Y291bnRlcl9hdHRyLT5jb21wLnByaXYgPSBjb21wLT5wcml2Owo+ID4gKwljb3VudGVyX2F0dHIt
PnBhcmVudCA9IHBhcmVudDsKPiA+ICsKPiA+ICsJLyogSW5pdGlhbGl6ZSBzeXNmcyBhdHRyaWJ1
dGUgKi8KPiA+ICsJZGV2X2F0dHIgPSAmY291bnRlcl9hdHRyLT5kZXZfYXR0cjsKPiA+ICsJc3lz
ZnNfYXR0cl9pbml0KCZkZXZfYXR0ci0+YXR0cik7Cj4gPiArCj4gPiArCS8qIENvbmZpZ3VyZSBk
ZXZpY2UgYXR0cmlidXRlICovCj4gPiArCWRldl9hdHRyLT5hdHRyLm5hbWUgPSBkZXZtX2thc3By
aW50ZihkZXYsIEdGUF9LRVJORUwsICIlc19hdmFpbGFibGUiLAo+ID4gKwkJCQkJICAgICBjb21w
LT5uYW1lKTsKPiA+ICsJaWYgKCFkZXZfYXR0ci0+YXR0ci5uYW1lKQo+ID4gKwkJcmV0dXJuIC1F
Tk9NRU07Cj4gPiArCWRldl9hdHRyLT5hdHRyLm1vZGUgPSAwNDQ0Owo+ID4gKwlkZXZfYXR0ci0+
c2hvdyA9IGNvdW50ZXJfY29tcF9hdmFpbGFibGVfc2hvdzsKPiA+ICsKPiA+ICsJLyogU3RvcmUg
bGlzdCBub2RlICovCj4gPiArCWxpc3RfYWRkKCZjb3VudGVyX2F0dHItPmwsICZncm91cC0+YXR0
cl9saXN0KTsKPiA+ICsJZ3JvdXAtPm51bV9hdHRyKys7Cj4gPiArCj4gPiArCXJldHVybiAwOwo+
ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGNvdW50ZXJfYXR0cl9jcmVhdGUoc3RydWN0IGRl
dmljZSAqY29uc3QgZGV2LAo+ID4gKwkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVf
Z3JvdXAgKmNvbnN0IGdyb3VwLAo+ID4gKwkJCSAgICAgICBjb25zdCBzdHJ1Y3QgY291bnRlcl9j
b21wICpjb25zdCBjb21wLAo+ID4gKwkJCSAgICAgICBjb25zdCBlbnVtIGNvdW50ZXJfc2NvcGUg
c2NvcGUsCj4gPiArCQkJICAgICAgIHZvaWQgKmNvbnN0IHBhcmVudCkKPiA+ICt7Cj4gPiArCXN0
cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY291bnRlcl9hdHRyOwo+ID4gKwlzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqZGV2X2F0dHI7Cj4gPiArCj4gPiArCWNvdW50ZXJfYXR0ciA9IGRldm1fa3ph
bGxvYyhkZXYsIHNpemVvZigqY291bnRlcl9hdHRyKSwgR0ZQX0tFUk5FTCk7Cj4gPiArCWlmICgh
Y291bnRlcl9hdHRyKQo+ID4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gPiArCj4gPiArCS8qIENvbmZp
Z3VyZSBDb3VudGVyIGF0dHJpYnV0ZSAqLwo+ID4gKwljb3VudGVyX2F0dHItPmNvbXAgPSAqY29t
cDsKPiA+ICsJY291bnRlcl9hdHRyLT5zY29wZSA9IHNjb3BlOwo+ID4gKwljb3VudGVyX2F0dHIt
PnBhcmVudCA9IHBhcmVudDsKPiA+ICsKPiA+ICsJLyogQ29uZmlndXJlIGRldmljZSBhdHRyaWJ1
dGUgKi8KPiA+ICsJZGV2X2F0dHIgPSAmY291bnRlcl9hdHRyLT5kZXZfYXR0cjsKPiA+ICsJc3lz
ZnNfYXR0cl9pbml0KCZkZXZfYXR0ci0+YXR0cik7Cj4gPiArCWRldl9hdHRyLT5hdHRyLm5hbWUg
PSBjb21wLT5uYW1lOwo+ID4gKwlzd2l0Y2ggKGNvbXAtPnR5cGUpIHsKPiA+ICsJY2FzZSBDT1VO
VEVSX0NPTVBfVTg6Cj4gPiArCWNhc2UgQ09VTlRFUl9DT01QX0JPT0w6Cj4gPiArCQlpZiAoY29t
cC0+ZGV2aWNlX3U4X3JlYWQpIHsKPiA+ICsJCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDA0NDQ7
Cj4gPiArCQkJZGV2X2F0dHItPnNob3cgPSBjb3VudGVyX2NvbXBfdThfc2hvdzsKPiA+ICsJCX0K
PiA+ICsJCWlmIChjb21wLT5kZXZpY2VfdThfd3JpdGUpIHsKPiA+ICsJCQlkZXZfYXR0ci0+YXR0
ci5tb2RlIHw9IDAyMDA7Cj4gPiArCQkJZGV2X2F0dHItPnN0b3JlID0gY291bnRlcl9jb21wX3U4
X3N0b3JlOwo+ID4gKwkJfQo+ID4gKwkJYnJlYWs7Cj4gPiArCWNhc2UgQ09VTlRFUl9DT01QX1NJ
R05BTF9MRVZFTDoKPiA+ICsJY2FzZSBDT1VOVEVSX0NPTVBfRlVOQ1RJT046Cj4gPiArCWNhc2Ug
Q09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OOgo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9FTlVN
Ogo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9DT1VOVF9ESVJFQ1RJT046Cj4gPiArCWNhc2UgQ09V
TlRFUl9DT01QX0NPVU5UX01PREU6Cj4gPiArCQlpZiAoY29tcC0+ZGV2aWNlX3UzMl9yZWFkKSB7
Cj4gPiArCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwNDQ0Owo+ID4gKwkJCWRldl9hdHRyLT5z
aG93ID0gY291bnRlcl9jb21wX3UzMl9zaG93Owo+ID4gKwkJfQo+ID4gKwkJaWYgKGNvbXAtPmRl
dmljZV91MzJfd3JpdGUpIHsKPiA+ICsJCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDAyMDA7Cj4g
PiArCQkJZGV2X2F0dHItPnN0b3JlID0gY291bnRlcl9jb21wX3UzMl9zdG9yZTsKPiA+ICsJCX0K
PiA+ICsJCWJyZWFrOwo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9VNjQ6Cj4gPiArCQlpZiAoY29t
cC0+ZGV2aWNlX3U2NF9yZWFkKSB7Cj4gPiArCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwNDQ0
Owo+ID4gKwkJCWRldl9hdHRyLT5zaG93ID0gY291bnRlcl9jb21wX3U2NF9zaG93Owo+ID4gKwkJ
fQo+ID4gKwkJaWYgKGNvbXAtPmRldmljZV91NjRfd3JpdGUpIHsKPiA+ICsJCQlkZXZfYXR0ci0+
YXR0ci5tb2RlIHw9IDAyMDA7Cj4gPiArCQkJZGV2X2F0dHItPnN0b3JlID0gY291bnRlcl9jb21w
X3U2NF9zdG9yZTsKPiA+ICsJCX0KPiA+ICsJCWJyZWFrOwo+ID4gKwlkZWZhdWx0Ogo+ID4gKwkJ
cmV0dXJuIC1FSU5WQUw7Cj4gPiArCX0KPiA+ICsKPiA+ICsJLyogU3RvcmUgbGlzdCBub2RlICov
Cj4gPiArCWxpc3RfYWRkKCZjb3VudGVyX2F0dHItPmwsICZncm91cC0+YXR0cl9saXN0KTsKPiA+
ICsJZ3JvdXAtPm51bV9hdHRyKys7Cj4gPiArCj4gPiArCS8qIENyZWF0ZSAiKl9hdmFpbGFibGUi
IGF0dHJpYnV0ZSBpZiBuZWVkZWQgKi8KPiA+ICsJc3dpdGNoIChjb21wLT50eXBlKSB7Cj4gPiAr
CWNhc2UgQ09VTlRFUl9DT01QX0ZVTkNUSU9OOgo+ID4gKwljYXNlIENPVU5URVJfQ09NUF9TWU5B
UFNFX0FDVElPTjoKPiA+ICsJY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKPiA+ICsJY2FzZSBDT1VO
VEVSX0NPTVBfQ09VTlRfTU9ERToKPiA+ICsJCXJldHVybiBjb3VudGVyX2F2YWlsX2F0dHJfY3Jl
YXRlKGRldiwgZ3JvdXAsIGNvbXAsIHBhcmVudCk7Cj4gPiArCWRlZmF1bHQ6Cj4gPiArCQlyZXR1
cm4gMDsKPiA+ICsJfQo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgc3NpemVfdCBjb3VudGVyX2Nv
bXBfbmFtZV9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+ICsJCQkJICAgICAgc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiA+ICt7Cj4gPiArCXJldHVybiBzeXNm
c19lbWl0KGJ1ZiwgIiVzXG4iLCB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKS0+Y29tcC5uYW1l
KTsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBjb3VudGVyX25hbWVfYXR0cl9jcmVhdGUo
c3RydWN0IGRldmljZSAqY29uc3QgZGV2LAo+ID4gKwkJCQkgICAgc3RydWN0IGNvdW50ZXJfYXR0
cmlidXRlX2dyb3VwICpjb25zdCBncm91cCwKPiA+ICsJCQkJICAgIGNvbnN0IGNoYXIgKmNvbnN0
IG5hbWUpCj4gPiArewo+ID4gKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNvdW50ZXJfYXR0
cjsKPiA+ICsKPiA+ICsJY291bnRlcl9hdHRyID0gZGV2bV9remFsbG9jKGRldiwgc2l6ZW9mKCpj
b3VudGVyX2F0dHIpLCBHRlBfS0VSTkVMKTsKPiA+ICsJaWYgKCFjb3VudGVyX2F0dHIpCj4gPiAr
CQlyZXR1cm4gLUVOT01FTTsKPiA+ICsKPiA+ICsJLyogQ29uZmlndXJlIENvdW50ZXIgYXR0cmli
dXRlICovCj4gPiArCWNvdW50ZXJfYXR0ci0+Y29tcC5uYW1lID0gbmFtZTsKPiA+ICsKPiA+ICsJ
LyogQ29uZmlndXJlIGRldmljZSBhdHRyaWJ1dGUgKi8KPiA+ICsJc3lzZnNfYXR0cl9pbml0KCZj
b3VudGVyX2F0dHItPmRldl9hdHRyLmF0dHIpOwo+ID4gKwljb3VudGVyX2F0dHItPmRldl9hdHRy
LmF0dHIubmFtZSA9ICJuYW1lIjsKPiA+ICsJY291bnRlcl9hdHRyLT5kZXZfYXR0ci5hdHRyLm1v
ZGUgPSAwNDQ0Owo+ID4gKwljb3VudGVyX2F0dHItPmRldl9hdHRyLnNob3cgPSBjb3VudGVyX2Nv
bXBfbmFtZV9zaG93Owo+ID4gKwo+ID4gKwkvKiBTdG9yZSBsaXN0IG5vZGUgKi8KPiA+ICsJbGlz
dF9hZGQoJmNvdW50ZXJfYXR0ci0+bCwgJmdyb3VwLT5hdHRyX2xpc3QpOwo+ID4gKwlncm91cC0+
bnVtX2F0dHIrKzsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRp
YyBzdHJ1Y3QgY291bnRlcl9jb21wIGNvdW50ZXJfc2lnbmFsX2NvbXAgPSB7Cj4gPiArCS50eXBl
ID0gQ09VTlRFUl9DT01QX1NJR05BTF9MRVZFTCwKPiA+ICsJLm5hbWUgPSAic2lnbmFsIiwKPiA+
ICt9Owo+ID4gKwo+ID4gK3N0YXRpYyBpbnQgY291bnRlcl9zaWduYWxfYXR0cnNfY3JlYXRlKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciwKPiA+ICsJc3RydWN0IGNvdW50ZXJf
YXR0cmlidXRlX2dyb3VwICpjb25zdCBjYXR0cl9ncm91cCwKPiA+ICsJc3RydWN0IGNvdW50ZXJf
c2lnbmFsICpjb25zdCBzaWduYWwpCj4gPiArewo+ID4gKwljb25zdCBlbnVtIGNvdW50ZXJfc2Nv
cGUgc2NvcGUgPSBDT1VOVEVSX1NDT1BFX1NJR05BTDsKPiA+ICsJc3RydWN0IGRldmljZSAqY29u
c3QgZGV2ID0gJmNvdW50ZXItPmRldjsKPiA+ICsJaW50IGVycjsKPiA+ICsJc3RydWN0IGNvdW50
ZXJfY29tcCBjb21wOwo+ID4gKwlzaXplX3QgaTsKPiA+ICsKPiA+ICsJLyogQ3JlYXRlIG1haW4g
U2lnbmFsIGF0dHJpYnV0ZSAqLwo+ID4gKwljb21wID0gY291bnRlcl9zaWduYWxfY29tcDsKPiA+
ICsJY29tcC5zaWduYWxfdTMyX3JlYWQgPSBjb3VudGVyLT5vcHMtPnNpZ25hbF9yZWFkOwo+ID4g
KwllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsICZjb21wLCBzY29w
ZSwgc2lnbmFsKTsKPiA+ICsJaWYgKGVyciA8IDApCj4gPiArCQlyZXR1cm4gZXJyOwo+ID4gKwo+
ID4gKwkvKiBDcmVhdGUgU2lnbmFsIG5hbWUgYXR0cmlidXRlICovCj4gPiArCWVyciA9IGNvdW50
ZXJfbmFtZV9hdHRyX2NyZWF0ZShkZXYsIGNhdHRyX2dyb3VwLCBzaWduYWwtPm5hbWUpOwo+ID4g
KwlpZiAoZXJyIDwgMCkKPiA+ICsJCXJldHVybiBlcnI7Cj4gPiArCj4gPiArCS8qIENyZWF0ZSBh
biBhdHRyaWJ1dGUgZm9yIGVhY2ggZXh0ZW5zaW9uICovCj4gPiArCWZvciAoaSA9IDA7IGkgPCBz
aWduYWwtPm51bV9leHQ7IGkrKykgewo+ID4gKwkJZXJyID0gY291bnRlcl9hdHRyX2NyZWF0ZShk
ZXYsIGNhdHRyX2dyb3VwLCBzaWduYWwtPmV4dCArIGksCj4gPiArCQkJCQkgIHNjb3BlLCBzaWdu
YWwpOwo+ID4gKwkJaWYgKGVyciA8IDApCj4gPiArCQkJcmV0dXJuIGVycjsKPiA+ICsJfQo+ID4g
Kwo+ID4gKwlyZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBjb3VudGVyX3N5
c2ZzX3NpZ25hbHNfYWRkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciwKPiA+
ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBncm91cHMpCj4gPiArewo+
ID4gKwlzaXplX3QgaTsKPiA+ICsJaW50IGVycjsKPiA+ICsKPiA+ICsJLyogQWRkIGVhY2ggU2ln
bmFsICovCj4gPiArCWZvciAoaSA9IDA7IGkgPCBjb3VudGVyLT5udW1fc2lnbmFsczsgaSsrKSB7
Cj4gPiArCQkvKiBHZW5lcmF0ZSBTaWduYWwgYXR0cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCj4g
PiArCQlncm91cHNbaV0ubmFtZSA9IGRldm1fa2FzcHJpbnRmKCZjb3VudGVyLT5kZXYsIEdGUF9L
RVJORUwsCj4gPiArCQkJCQkJInNpZ25hbCV6dSIsIGkpOwo+ID4gKwkJaWYgKCFncm91cHNbaV0u
bmFtZSkKPiA+ICsJCQlyZXR1cm4gLUVOT01FTTsKPiA+ICsKPiA+ICsJCS8qIENyZWF0ZSBhbGwg
YXR0cmlidXRlcyBhc3NvY2lhdGVkIHdpdGggU2lnbmFsICovCj4gPiArCQllcnIgPSBjb3VudGVy
X3NpZ25hbF9hdHRyc19jcmVhdGUoY291bnRlciwgZ3JvdXBzICsgaSwKPiA+ICsJCQkJCQkgIGNv
dW50ZXItPnNpZ25hbHMgKyBpKTsKPiA+ICsJCWlmIChlcnIgPCAwKQo+ID4gKwkJCXJldHVybiBl
cnI7Cj4gPiArCX0KPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRp
YyBpbnQgY291bnRlcl9zeXNmc19zeW5hcHNlc19hZGQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b25zdCBjb3VudGVyLAo+ID4gKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0
IGdyb3VwLAo+ID4gKwlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQpCj4gPiArewo+
ID4gKwlzaXplX3QgaTsKPiA+ICsKPiA+ICsJLyogQWRkIGVhY2ggU3luYXBzZSAqLwo+ID4gKwlm
b3IgKGkgPSAwOyBpIDwgY291bnQtPm51bV9zeW5hcHNlczsgaSsrKSB7Cj4gPiArCQlzdHJ1Y3Qg
ZGV2aWNlICpjb25zdCBkZXYgPSAmY291bnRlci0+ZGV2Owo+ID4gKwkJc3RydWN0IGNvdW50ZXJf
c3luYXBzZSAqc3luYXBzZTsKPiA+ICsJCXNpemVfdCBpZDsKPiA+ICsJCXN0cnVjdCBjb3VudGVy
X2NvbXAgY29tcDsKPiA+ICsJCWludCBlcnI7Cj4gPiArCj4gPiArCQlzeW5hcHNlID0gY291bnQt
PnN5bmFwc2VzICsgaTsKPiA+ICsKPiA+ICsJCS8qIEdlbmVyYXRlIFN5bmFwc2UgYWN0aW9uIG5h
bWUgKi8KPiA+ICsJCWlkID0gc3luYXBzZS0+c2lnbmFsIC0gY291bnRlci0+c2lnbmFsczsKPiA+
ICsJCWNvbXAubmFtZSA9IGRldm1fa2FzcHJpbnRmKGRldiwgR0ZQX0tFUk5FTCwgInNpZ25hbCV6
dV9hY3Rpb24iLAo+ID4gKwkJCQkJICAgaWQpOwo+ID4gKwkJaWYgKCFjb21wLm5hbWUpCj4gPiAr
CQkJcmV0dXJuIC1FTk9NRU07Cj4gPiArCj4gPiArCQkvKiBDcmVhdGUgYWN0aW9uIGF0dHJpYnV0
ZSAqLwo+ID4gKwkJY29tcC50eXBlID0gQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OOwo+ID4g
KwkJY29tcC5hY3Rpb25fcmVhZCA9IGNvdW50ZXItPm9wcy0+YWN0aW9uX3JlYWQ7Cj4gPiArCQlj
b21wLmFjdGlvbl93cml0ZSA9IGNvdW50ZXItPm9wcy0+YWN0aW9uX3dyaXRlOwo+ID4gKwkJY29t
cC5wcml2ID0gc3luYXBzZTsKPiA+ICsJCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBn
cm91cCwgJmNvbXAsCj4gPiArCQkJCQkgIENPVU5URVJfU0NPUEVfQ09VTlQsIGNvdW50KTsKPiA+
ICsJCWlmIChlcnIgPCAwKQo+ID4gKwkJCXJldHVybiBlcnI7Cj4gPiArCX0KPiA+ICsKPiA+ICsJ
cmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21wIGNv
dW50ZXJfY291bnRfY29tcCA9Cj4gPiArCUNPVU5URVJfQ09NUF9DT1VOVF9VNjQoImNvdW50Iiwg
TlVMTCwgTlVMTCk7Cj4gPiArCj4gPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgY291bnRl
cl9mdW5jdGlvbl9jb21wID0gewo+ID4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9GVU5DVElPTiwK
PiA+ICsJLm5hbWUgPSAiZnVuY3Rpb24iLAo+ID4gK307Cj4gPiArCj4gPiArc3RhdGljIGludCBj
b3VudGVyX2NvdW50X2F0dHJzX2NyZWF0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNv
dW50ZXIsCj4gPiArCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqY29uc3QgY2F0dHJf
Z3JvdXAsCj4gPiArCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCkKPiA+ICt7Cj4g
PiArCWNvbnN0IGVudW0gY291bnRlcl9zY29wZSBzY29wZSA9IENPVU5URVJfU0NPUEVfQ09VTlQ7
Cj4gPiArCXN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7Cj4gPiArCWlu
dCBlcnI7Cj4gPiArCXN0cnVjdCBjb3VudGVyX2NvbXAgY29tcDsKPiA+ICsJc2l6ZV90IGk7Cj4g
PiArCj4gPiArCS8qIENyZWF0ZSBtYWluIENvdW50IGF0dHJpYnV0ZSAqLwo+ID4gKwljb21wID0g
Y291bnRlcl9jb3VudF9jb21wOwo+ID4gKwljb21wLmNvdW50X3U2NF9yZWFkID0gY291bnRlci0+
b3BzLT5jb3VudF9yZWFkOwo+ID4gKwljb21wLmNvdW50X3U2NF93cml0ZSA9IGNvdW50ZXItPm9w
cy0+Y291bnRfd3JpdGU7Cj4gPiArCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0
cl9ncm91cCwgJmNvbXAsIHNjb3BlLCBjb3VudCk7Cj4gPiArCWlmIChlcnIgPCAwKQo+ID4gKwkJ
cmV0dXJuIGVycjsKPiA+ICsKPiA+ICsJLyogQ3JlYXRlIENvdW50IG5hbWUgYXR0cmlidXRlICov
Cj4gPiArCWVyciA9IGNvdW50ZXJfbmFtZV9hdHRyX2NyZWF0ZShkZXYsIGNhdHRyX2dyb3VwLCBj
b3VudC0+bmFtZSk7Cj4gPiArCWlmIChlcnIgPCAwKQo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsK
PiA+ICsJLyogQ3JlYXRlIENvdW50IGZ1bmN0aW9uIGF0dHJpYnV0ZSAqLwo+ID4gKwljb21wID0g
Y291bnRlcl9mdW5jdGlvbl9jb21wOwo+ID4gKwljb21wLmNvdW50X3UzMl9yZWFkID0gY291bnRl
ci0+b3BzLT5mdW5jdGlvbl9yZWFkOwo+ID4gKwljb21wLmNvdW50X3UzMl93cml0ZSA9IGNvdW50
ZXItPm9wcy0+ZnVuY3Rpb25fd3JpdGU7Cj4gPiArCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUo
ZGV2LCBjYXR0cl9ncm91cCwgJmNvbXAsIHNjb3BlLCBjb3VudCk7Cj4gPiArCWlmIChlcnIgPCAw
KQo+ID4gKwkJcmV0dXJuIGVycjsKPiA+ICsKPiA+ICsJLyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBm
b3IgZWFjaCBleHRlbnNpb24gKi8KPiA+ICsJZm9yIChpID0gMDsgaSA8IGNvdW50LT5udW1fZXh0
OyBpKyspIHsKPiA+ICsJCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91
cCwgY291bnQtPmV4dCArIGksCj4gPiArCQkJCQkgIHNjb3BlLCBjb3VudCk7Cj4gPiArCQlpZiAo
ZXJyIDwgMCkKPiA+ICsJCQlyZXR1cm4gZXJyOwo+ID4gKwl9Cj4gPiArCj4gPiArCXJldHVybiAw
Owo+ID4gK30KPiA+ICsKPiA+ICtzdGF0aWMgaW50IGNvdW50ZXJfc3lzZnNfY291bnRzX2FkZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIsCj4gPiArCXN0cnVjdCBjb3VudGVy
X2F0dHJpYnV0ZV9ncm91cCAqY29uc3QgZ3JvdXBzKQo+ID4gK3sKPiA+ICsJc2l6ZV90IGk7Cj4g
PiArCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKPiA+ICsJaW50IGVycjsKPiA+ICsKPiA+
ICsJLyogQWRkIGVhY2ggQ291bnQgKi8KPiA+ICsJZm9yIChpID0gMDsgaSA8IGNvdW50ZXItPm51
bV9jb3VudHM7IGkrKykgewo+ID4gKwkJY291bnQgPSBjb3VudGVyLT5jb3VudHMgKyBpOwo+ID4g
Kwo+ID4gKwkJLyogR2VuZXJhdGUgQ291bnQgYXR0cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCj4g
PiArCQlncm91cHNbaV0ubmFtZSA9IGRldm1fa2FzcHJpbnRmKCZjb3VudGVyLT5kZXYsIEdGUF9L
RVJORUwsCj4gPiArCQkJCQkJImNvdW50JXp1IiwgaSk7Cj4gPiArCQlpZiAoIWdyb3Vwc1tpXS5u
YW1lKQo+ID4gKwkJCXJldHVybiAtRU5PTUVNOwo+ID4gKwo+ID4gKwkJLyogQWRkIHN5c2ZzIGF0
dHJpYnV0ZXMgb2YgdGhlIFN5bmFwc2VzICovCj4gPiArCQllcnIgPSBjb3VudGVyX3N5c2ZzX3N5
bmFwc2VzX2FkZChjb3VudGVyLCBncm91cHMgKyBpLCBjb3VudCk7Cj4gPiArCQlpZiAoZXJyIDwg
MCkKPiA+ICsJCQlyZXR1cm4gZXJyOwo+ID4gKwo+ID4gKwkJLyogQ3JlYXRlIGFsbCBhdHRyaWJ1
dGVzIGFzc29jaWF0ZWQgd2l0aCBDb3VudCAqLwo+ID4gKwkJZXJyID0gY291bnRlcl9jb3VudF9h
dHRyc19jcmVhdGUoY291bnRlciwgZ3JvdXBzICsgaSwgY291bnQpOwo+ID4gKwkJaWYgKGVyciA8
IDApCj4gPiArCQkJcmV0dXJuIGVycjsKPiA+ICsJfQo+ID4gKwo+ID4gKwlyZXR1cm4gMDsKPiA+
ICt9Cj4gPiArCj4gPiArc3RhdGljIGludCBjb3VudGVyX251bV9zaWduYWxzX3JlYWQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB1OCAqdmFsKQo+ID4gK3sKPiA+ICsJKnZhbCA9IGNv
dW50ZXItPm51bV9zaWduYWxzOwo+ID4gKwlyZXR1cm4gMDsKPiA+ICt9Cj4gPiArCj4gPiArc3Rh
dGljIGludCBjb3VudGVyX251bV9jb3VudHNfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsIHU4ICp2YWwpCj4gPiArewo+ID4gKwkqdmFsID0gY291bnRlci0+bnVtX2NvdW50czsK
PiA+ICsJcmV0dXJuIDA7Cj4gPiArfQo+ID4gKwo+ID4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9j
b21wIGNvdW50ZXJfbnVtX3NpZ25hbHNfY29tcCA9Cj4gPiArCUNPVU5URVJfQ09NUF9ERVZJQ0Vf
VTgoIm51bV9zaWduYWxzIiwgY291bnRlcl9udW1fc2lnbmFsc19yZWFkLCBOVUxMKTsKPiA+ICsK
PiA+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBjb3VudGVyX251bV9jb3VudHNfY29tcCA9
Cj4gPiArCUNPVU5URVJfQ09NUF9ERVZJQ0VfVTgoIm51bV9jb3VudHMiLCBjb3VudGVyX251bV9j
b3VudHNfcmVhZCwgTlVMTCk7Cj4gPiArCj4gPiArc3RhdGljIGludCBjb3VudGVyX3N5c2ZzX2F0
dHJfYWRkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciwKPiA+ICsJCQkJICBz
dHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNhdHRyX2dyb3VwKQo+ID4gK3sKPiA+ICsJ
Y29uc3QgZW51bSBjb3VudGVyX3Njb3BlIHNjb3BlID0gQ09VTlRFUl9TQ09QRV9ERVZJQ0U7Cj4g
PiArCXN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7Cj4gPiArCWludCBl
cnI7Cj4gPiArCXNpemVfdCBpOwo+ID4gKwo+ID4gKwkvKiBBZGQgU2lnbmFscyBzeXNmcyBhdHRy
aWJ1dGVzICovCj4gPiArCWVyciA9IGNvdW50ZXJfc3lzZnNfc2lnbmFsc19hZGQoY291bnRlciwg
Y2F0dHJfZ3JvdXApOwo+ID4gKwlpZiAoZXJyIDwgMCkKPiA+ICsJCXJldHVybiBlcnI7Cj4gPiAr
CWNhdHRyX2dyb3VwICs9IGNvdW50ZXItPm51bV9zaWduYWxzOwo+ID4gKwo+ID4gKwkvKiBBZGQg
Q291bnRzIHN5c2ZzIGF0dHJpYnV0ZXMgKi8KPiA+ICsJZXJyID0gY291bnRlcl9zeXNmc19jb3Vu
dHNfYWRkKGNvdW50ZXIsIGNhdHRyX2dyb3VwKTsKPiA+ICsJaWYgKGVyciA8IDApCj4gPiArCQly
ZXR1cm4gZXJyOwo+ID4gKwljYXR0cl9ncm91cCArPSBjb3VudGVyLT5udW1fY291bnRzOwo+ID4g
Kwo+ID4gKwkvKiBDcmVhdGUgbmFtZSBhdHRyaWJ1dGUgKi8KPiA+ICsJZXJyID0gY291bnRlcl9u
YW1lX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsIGNvdW50ZXItPm5hbWUpOwo+ID4gKwlp
ZiAoZXJyIDwgMCkKPiA+ICsJCXJldHVybiBlcnI7Cj4gPiArCj4gPiArCS8qIENyZWF0ZSBudW1f
c2lnbmFscyBhdHRyaWJ1dGUgKi8KPiA+ICsJZXJyID0gY291bnRlcl9hdHRyX2NyZWF0ZShkZXYs
IGNhdHRyX2dyb3VwLCAmY291bnRlcl9udW1fc2lnbmFsc19jb21wLAo+ID4gKwkJCQkgIHNjb3Bl
LCBOVUxMKTsKPiA+ICsJaWYgKGVyciA8IDApCj4gPiArCQlyZXR1cm4gZXJyOwo+ID4gKwo+ID4g
KwkvKiBDcmVhdGUgbnVtX2NvdW50cyBhdHRyaWJ1dGUgKi8KPiA+ICsJZXJyID0gY291bnRlcl9h
dHRyX2NyZWF0ZShkZXYsIGNhdHRyX2dyb3VwLCAmY291bnRlcl9udW1fY291bnRzX2NvbXAsCj4g
PiArCQkJCSAgc2NvcGUsIE5VTEwpOwo+ID4gKwlpZiAoZXJyIDwgMCkKPiA+ICsJCXJldHVybiBl
cnI7Cj4gPiArCj4gPiArCS8qIENyZWF0ZSBhbiBhdHRyaWJ1dGUgZm9yIGVhY2ggZXh0ZW5zaW9u
ICovCj4gPiArCWZvciAoaSA9IDA7IGkgPCBjb3VudGVyLT5udW1fZXh0OyBpKyspIHsKPiA+ICsJ
CWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0cl9ncm91cCwgY291bnRlci0+ZXh0
ICsgaSwKPiA+ICsJCQkJCSAgc2NvcGUsIE5VTEwpOwo+ID4gKwkJaWYgKGVyciA8IDApCj4gPiAr
CQkJcmV0dXJuIGVycjsKPiA+ICsJfQo+ID4gKwo+ID4gKwlyZXR1cm4gMDsKPiA+ICt9Cj4gPiAr
Cj4gPiArLyoqCj4gPiArICogY291bnRlcl9zeXNmc19hZGQgLSBBZGRzIENvdW50ZXIgc3lzZnMg
YXR0cmlidXRlcyB0byB0aGUgZGV2aWNlIHN0cnVjdHVyZQo+ID4gKyAqIEBjb3VudGVyOglQb2lu
dGVyIHRvIHRoZSBDb3VudGVyIGRldmljZSBzdHJ1Y3R1cmUKPiA+ICsgKgo+ID4gKyAqIENvdW50
ZXIgc3lzZnMgYXR0cmlidXRlcyBhcmUgY3JlYXRlZCBhbmQgYWRkZWQgdG8gdGhlIHJlc3BlY3Rp
dmUgZGV2aWNlCj4gPiArICogc3RydWN0dXJlIGZvciBsYXRlciByZWdpc3RyYXRpb24gdG8gdGhl
IHN5c3RlbS4gUmVzb3VyY2UtbWFuYWdlZCBtZW1vcnkKPiA+ICsgKiBhbGxvY2F0aW9uIGlzIHBl
cmZvcm1lZCBieSB0aGlzIGZ1bmN0aW9uLCBhbmQgdGhpcyBtZW1vcnkgc2hvdWxkIGJlIGZyZWVk
Cj4gPiArICogd2hlbiBubyBsb25nZXIgbmVlZGVkIChhdXRvbWF0aWNhbGx5IGJ5IGEgZGV2aWNl
X3VucmVnaXN0ZXIgY2FsbCwgb3IKPiA+ICsgKiBtYW51YWxseSBieSBhIGRldnJlc19yZWxlYXNl
X2FsbCBjYWxsKS4KPiA+ICsgKi8KPiA+ICtpbnQgY291bnRlcl9zeXNmc19hZGQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+ID4gK3sKPiA+ICsJc3RydWN0IGRldmljZSAq
Y29uc3QgZGV2ID0gJmNvdW50ZXItPmRldjsKPiA+ICsJY29uc3Qgc2l6ZV90IG51bV9ncm91cHMg
PSBjb3VudGVyLT5udW1fc2lnbmFscyArIGNvdW50ZXItPm51bV9jb3VudHMgKyAxOwo+ID4gKwlz
dHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNhdHRyX2dyb3VwczsKPiA+ICsJc2l6ZV90
IGksIGo7Cj4gPiArCWludCBlcnI7Cj4gPiArCXN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKmdyb3Vw
czsKPiA+ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlICpwOwo+ID4gKwo+ID4gKwkvKiBBbGxv
Y2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIGdyb3VwcyAoc2lnbmFscywgY291bnRzLCBhbmQgZXh0
KSAqLwo+ID4gKwljYXR0cl9ncm91cHMgPSBkZXZtX2tjYWxsb2MoZGV2LCBudW1fZ3JvdXBzLCBz
aXplb2YoKmNhdHRyX2dyb3VwcyksCj4gPiArCQkJCSAgICBHRlBfS0VSTkVMKTsKPiA+ICsJaWYg
KCFjYXR0cl9ncm91cHMpCj4gPiArCQlyZXR1cm4gLUVOT01FTTsKPiA+ICsKPiA+ICsJLyogSW5p
dGlhbGl6ZSBhdHRyaWJ1dGUgbGlzdHMgKi8KPiA+ICsJZm9yIChpID0gMDsgaSA8IG51bV9ncm91
cHM7IGkrKykKPiA+ICsJCUlOSVRfTElTVF9IRUFEKCZjYXR0cl9ncm91cHNbaV0uYXR0cl9saXN0
KTsKPiA+ICsKPiA+ICsJLyogQWRkIENvdW50ZXIgZGV2aWNlIHN5c2ZzIGF0dHJpYnV0ZXMgKi8K
PiA+ICsJZXJyID0gY291bnRlcl9zeXNmc19hdHRyX2FkZChjb3VudGVyLCBjYXR0cl9ncm91cHMp
Owo+ID4gKwlpZiAoZXJyIDwgMCkKPiA+ICsJCXJldHVybiBlcnI7Cj4gPiArCj4gPiArCS8qIEFs
bG9jYXRlIGF0dHJpYnV0ZSBncm91cCBwb2ludGVycyBmb3IgYXNzb2NpYXRpb24gd2l0aCBkZXZp
Y2UgKi8KPiA+ICsJZGV2LT5ncm91cHMgPSBkZXZtX2tjYWxsb2MoZGV2LCBudW1fZ3JvdXBzICsg
MSwgc2l6ZW9mKCpkZXYtPmdyb3VwcyksCj4gPiArCQkJCSAgIEdGUF9LRVJORUwpOwo+ID4gKwlp
ZiAoIWRldi0+Z3JvdXBzKQo+ID4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gPiArCj4gPiArCS8qIEFs
bG9jYXRlIHNwYWNlIGZvciBhdHRyaWJ1dGUgZ3JvdXBzICovCj4gPiArCWdyb3VwcyA9IGRldm1f
a2NhbGxvYyhkZXYsIG51bV9ncm91cHMsIHNpemVvZigqZ3JvdXBzKSwgR0ZQX0tFUk5FTCk7Cj4g
PiArCWlmICghZ3JvdXBzKQo+ID4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gPiArCj4gPiArCS8qIFBy
ZXBhcmUgZWFjaCBncm91cCBvZiBhdHRyaWJ1dGVzIGZvciBhc3NvY2lhdGlvbiAqLwo+ID4gKwlm
b3IgKGkgPSAwOyBpIDwgbnVtX2dyb3VwczsgaSsrKSB7Cj4gPiArCQlncm91cHNbaV0ubmFtZSA9
IGNhdHRyX2dyb3Vwc1tpXS5uYW1lOwo+ID4gKwo+ID4gKwkJLyogQWxsb2NhdGUgc3BhY2UgZm9y
IGF0dHJpYnV0ZSBwb2ludGVycyAqLwo+ID4gKwkJZ3JvdXBzW2ldLmF0dHJzID0gZGV2bV9rY2Fs
bG9jKGRldiwKPiA+ICsJCQkJCSAgICAgICBjYXR0cl9ncm91cHNbaV0ubnVtX2F0dHIgKyAxLAo+
ID4gKwkJCQkJICAgICAgIHNpemVvZigqZ3JvdXBzW2ldLmF0dHJzKSwKPiA+ICsJCQkJCSAgICAg
ICBHRlBfS0VSTkVMKTsKPiA+ICsJCWlmICghZ3JvdXBzW2ldLmF0dHJzKQo+ID4gKwkJCXJldHVy
biAtRU5PTUVNOwo+ID4gKwo+ID4gKwkJLyogQWRkIGF0dHJpYnV0ZSBwb2ludGVycyB0byBhdHRy
aWJ1dGUgZ3JvdXAgKi8KPiA+ICsJCWogPSAwOwo+ID4gKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShw
LCAmY2F0dHJfZ3JvdXBzW2ldLmF0dHJfbGlzdCwgbCkKPiA+ICsJCQlncm91cHNbaV0uYXR0cnNb
aisrXSA9ICZwLT5kZXZfYXR0ci5hdHRyOwo+ID4gKwo+ID4gKwkJLyogQXNzb2NpYXRlIGF0dHJp
YnV0ZSBncm91cCAqLwo+ID4gKwkJZGV2LT5ncm91cHNbaV0gPSAmZ3JvdXBzW2ldOwo+ID4gKwl9
Cj4gPiArCj4gPiArCXJldHVybiAwOwo+ID4gK30KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2Nv
dW50ZXIvY291bnRlci1zeXNmcy5oIGIvZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuaAo+
ID4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiA+IGluZGV4IDAwMDAwMDAwMDAwMC4uMTRmZTU2NmFj
YTBlCj4gPiAtLS0gL2Rldi9udWxsCj4gPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvY291bnRlci1z
eXNmcy5oCj4gPiBAQCAtMCwwICsxLDEzIEBACj4gPiArLyogU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAgKi8KPiA+ICsvKgo+ID4gKyAqIENvdW50ZXIgc3lzZnMgaW50ZXJmYWNlCj4g
PiArICogQ29weXJpZ2h0IChDKSAyMDIwIFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkKPiA+ICsgKi8K
PiA+ICsjaWZuZGVmIF9DT1VOVEVSX1NZU0ZTX0hfCj4gPiArI2RlZmluZSBfQ09VTlRFUl9TWVNG
U19IXwo+ID4gKwo+ID4gKyNpbmNsdWRlIDxsaW51eC9jb3VudGVyLmg+Cj4gPiArCj4gPiAraW50
IGNvdW50ZXJfc3lzZnNfYWRkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcik7
Cj4gPiArCj4gPiArI2VuZGlmIC8qIF9DT1VOVEVSX1NZU0ZTX0hfICovCj4gPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy9jb3VudGVyL2NvdW50ZXIuYyBiL2RyaXZlcnMvY291bnRlci9jb3VudGVyLmMK
PiA+IGRlbGV0ZWQgZmlsZSBtb2RlIDEwMDY0NAo+ID4gaW5kZXggZGU5MjFlOGEzZjcyLi4wMDAw
MDAwMDAwMDAKPiA+IC0tLSBhL2RyaXZlcnMvY291bnRlci9jb3VudGVyLmMKPiA+ICsrKyAvZGV2
L251bGwKPiA+IEBAIC0xLDE0OTYgKzAsMCBAQAo+ID4gLS8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wCj4gPiAtLyoKPiA+IC0gKiBHZW5lcmljIENvdW50ZXIgaW50ZXJmYWNlCj4g
PiAtICogQ29weXJpZ2h0IChDKSAyMDE4IFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkKPiA+IC0gKi8K
PiA+IC0jaW5jbHVkZSA8bGludXgvY291bnRlci5oPgo+ID4gLSNpbmNsdWRlIDxsaW51eC9kZXZp
Y2UuaD4KPiA+IC0jaW5jbHVkZSA8bGludXgvZXJyLmg+Cj4gPiAtI2luY2x1ZGUgPGxpbnV4L2V4
cG9ydC5oPgo+ID4gLSNpbmNsdWRlIDxsaW51eC9mcy5oPgo+ID4gLSNpbmNsdWRlIDxsaW51eC9n
ZnAuaD4KPiA+IC0jaW5jbHVkZSA8bGludXgvaWRyLmg+Cj4gPiAtI2luY2x1ZGUgPGxpbnV4L2lu
aXQuaD4KPiA+IC0jaW5jbHVkZSA8bGludXgva2VybmVsLmg+Cj4gPiAtI2luY2x1ZGUgPGxpbnV4
L2xpc3QuaD4KPiA+IC0jaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+Cj4gPiAtI2luY2x1ZGUgPGxp
bnV4L3ByaW50ay5oPgo+ID4gLSNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Cj4gPiAtI2luY2x1ZGUg
PGxpbnV4L3N0cmluZy5oPgo+ID4gLSNpbmNsdWRlIDxsaW51eC9zeXNmcy5oPgo+ID4gLSNpbmNs
dWRlIDxsaW51eC90eXBlcy5oPgo+ID4gLQo+ID4gLWNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJf
Y291bnRfZGlyZWN0aW9uX3N0clsyXSA9IHsKPiA+IC0JW0NPVU5URVJfQ09VTlRfRElSRUNUSU9O
X0ZPUldBUkRdID0gImZvcndhcmQiLAo+ID4gLQlbQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fQkFD
S1dBUkRdID0gImJhY2t3YXJkIgo+ID4gLX07Cj4gPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRl
cl9jb3VudF9kaXJlY3Rpb25fc3RyKTsKPiA+IC0KPiA+IC1jb25zdCBjaGFyICpjb25zdCBjb3Vu
dGVyX2NvdW50X21vZGVfc3RyWzRdID0gewo+ID4gLQlbQ09VTlRFUl9DT1VOVF9NT0RFX05PUk1B
TF0gPSAibm9ybWFsIiwKPiA+IC0JW0NPVU5URVJfQ09VTlRfTU9ERV9SQU5HRV9MSU1JVF0gPSAi
cmFuZ2UgbGltaXQiLAo+ID4gLQlbQ09VTlRFUl9DT1VOVF9NT0RFX05PTl9SRUNZQ0xFXSA9ICJu
b24tcmVjeWNsZSIsCj4gPiAtCVtDT1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX05dID0gIm1vZHVs
by1uIgo+ID4gLX07Cj4gPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9jb3VudF9tb2RlX3N0
cik7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVyX3NpZ25hbF9lbnVtX3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpz
aWduYWwsIHZvaWQgKnByaXYsCj4gPiAtCQkJCSBjaGFyICpidWYpCj4gPiAtewo+ID4gLQljb25z
dCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+ID4gLQlp
bnQgZXJyOwo+ID4gLQlzaXplX3QgaW5kZXg7Cj4gPiAtCj4gPiAtCWlmICghZS0+Z2V0KQo+ID4g
LQkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAtCj4gPiAtCWVyciA9IGUtPmdldChjb3VudGVyLCBzaWdu
YWwsICZpbmRleCk7Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlyZXR1cm4gZXJyOwo+ID4gLQo+ID4g
LQlpZiAoaW5kZXggPj0gZS0+bnVtX2l0ZW1zKQo+ID4gLQkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAt
Cj4gPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBlLT5pdGVtc1tpbmRleF0pOwo+ID4g
LX0KPiA+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3NpZ25hbF9lbnVtX3JlYWQpOwo+ID4g
LQo+ID4gLXNzaXplX3QgY291bnRlcl9zaWduYWxfZW51bV93cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJCSAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWws
IHZvaWQgKnByaXYsCj4gPiAtCQkJCSAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ID4g
LXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0ICpjb25zdCBlID0g
cHJpdjsKPiA+IC0Jc3NpemVfdCBpbmRleDsKPiA+IC0JaW50IGVycjsKPiA+IC0KPiA+IC0JaWYg
KCFlLT5zZXQpCj4gPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiA+IC0KPiA+IC0JaW5kZXggPSBfX3N5
c2ZzX21hdGNoX3N0cmluZyhlLT5pdGVtcywgZS0+bnVtX2l0ZW1zLCBidWYpOwo+ID4gLQlpZiAo
aW5kZXggPCAwKQo+ID4gLQkJcmV0dXJuIGluZGV4Owo+ID4gLQo+ID4gLQllcnIgPSBlLT5zZXQo
Y291bnRlciwgc2lnbmFsLCBpbmRleCk7Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlyZXR1cm4gZXJy
Owo+ID4gLQo+ID4gLQlyZXR1cm4gbGVuOwo+ID4gLX0KPiA+IC1FWFBPUlRfU1lNQk9MX0dQTChj
b3VudGVyX3NpZ25hbF9lbnVtX3dyaXRlKTsKPiA+IC0KPiA+IC1zc2l6ZV90IGNvdW50ZXJfc2ln
bmFsX2VudW1fYXZhaWxhYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ID4gLQkJCQkJICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gPiAtCQkJCQkgICB2
b2lkICpwcml2LCBjaGFyICpidWYpCj4gPiAtewo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9z
aWduYWxfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+ID4gLQlzaXplX3QgaTsKPiA+IC0Jc2l6
ZV90IGxlbiA9IDA7Cj4gPiAtCj4gPiAtCWlmICghZS0+bnVtX2l0ZW1zKQo+ID4gLQkJcmV0dXJu
IDA7Cj4gPiAtCj4gPiAtCWZvciAoaSA9IDA7IGkgPCBlLT5udW1faXRlbXM7IGkrKykKPiA+IC0J
CWxlbiArPSBzcHJpbnRmKGJ1ZiArIGxlbiwgIiVzXG4iLCBlLT5pdGVtc1tpXSk7Cj4gPiAtCj4g
PiAtCXJldHVybiBsZW47Cj4gPiAtfQo+ID4gLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfc2ln
bmFsX2VudW1fYXZhaWxhYmxlX3JlYWQpOwo+ID4gLQo+ID4gLXNzaXplX3QgY291bnRlcl9jb3Vu
dF9lbnVtX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQlzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXYsCj4gPiAtCQkJCWNoYXIgKmJ1ZikK
PiA+IC17Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2VudW1fZXh0ICpjb25zdCBl
ID0gcHJpdjsKPiA+IC0JaW50IGVycjsKPiA+IC0Jc2l6ZV90IGluZGV4Owo+ID4gLQo+ID4gLQlp
ZiAoIWUtPmdldCkKPiA+IC0JCXJldHVybiAtRUlOVkFMOwo+ID4gLQo+ID4gLQllcnIgPSBlLT5n
ZXQoY291bnRlciwgY291bnQsICZpbmRleCk7Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlyZXR1cm4g
ZXJyOwo+ID4gLQo+ID4gLQlpZiAoaW5kZXggPj0gZS0+bnVtX2l0ZW1zKQo+ID4gLQkJcmV0dXJu
IC1FSU5WQUw7Cj4gPiAtCj4gPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBlLT5pdGVt
c1tpbmRleF0pOwo+ID4gLX0KPiA+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX2NvdW50X2Vu
dW1fcmVhZCk7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVyX2NvdW50X2VudW1fd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LCB2b2lkICpwcml2LAo+ID4gLQkJCQkgY29uc3QgY2hhciAqYnVmLCBzaXplX3Qg
bGVuKQo+ID4gLXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZW51bV9leHQgKmNv
bnN0IGUgPSBwcml2Owo+ID4gLQlzc2l6ZV90IGluZGV4Owo+ID4gLQlpbnQgZXJyOwo+ID4gLQo+
ID4gLQlpZiAoIWUtPnNldCkKPiA+IC0JCXJldHVybiAtRUlOVkFMOwo+ID4gLQo+ID4gLQlpbmRl
eCA9IF9fc3lzZnNfbWF0Y2hfc3RyaW5nKGUtPml0ZW1zLCBlLT5udW1faXRlbXMsIGJ1Zik7Cj4g
PiAtCWlmIChpbmRleCA8IDApCj4gPiAtCQlyZXR1cm4gaW5kZXg7Cj4gPiAtCj4gPiAtCWVyciA9
IGUtPnNldChjb3VudGVyLCBjb3VudCwgaW5kZXgpOwo+ID4gLQlpZiAoZXJyKQo+ID4gLQkJcmV0
dXJuIGVycjsKPiA+IC0KPiA+IC0JcmV0dXJuIGxlbjsKPiA+IC19Cj4gPiAtRVhQT1JUX1NZTUJP
TF9HUEwoY291bnRlcl9jb3VudF9lbnVtX3dyaXRlKTsKPiA+IC0KPiA+IC1zc2l6ZV90IGNvdW50
ZXJfY291bnRfZW51bV9hdmFpbGFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gPiAtCQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJCSAg
dm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+ID4gLXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJf
Y291bnRfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+ID4gLQlzaXplX3QgaTsKPiA+IC0Jc2l6
ZV90IGxlbiA9IDA7Cj4gPiAtCj4gPiAtCWlmICghZS0+bnVtX2l0ZW1zKQo+ID4gLQkJcmV0dXJu
IDA7Cj4gPiAtCj4gPiAtCWZvciAoaSA9IDA7IGkgPCBlLT5udW1faXRlbXM7IGkrKykKPiA+IC0J
CWxlbiArPSBzcHJpbnRmKGJ1ZiArIGxlbiwgIiVzXG4iLCBlLT5pdGVtc1tpXSk7Cj4gPiAtCj4g
PiAtCXJldHVybiBsZW47Cj4gPiAtfQo+ID4gLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfY291
bnRfZW51bV9hdmFpbGFibGVfcmVhZCk7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVyX2Rldmlj
ZV9lbnVtX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LAo+
ID4gLQkJCQkgY2hhciAqYnVmKQo+ID4gLXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2
aWNlX2VudW1fZXh0ICpjb25zdCBlID0gcHJpdjsKPiA+IC0JaW50IGVycjsKPiA+IC0Jc2l6ZV90
IGluZGV4Owo+ID4gLQo+ID4gLQlpZiAoIWUtPmdldCkKPiA+IC0JCXJldHVybiAtRUlOVkFMOwo+
ID4gLQo+ID4gLQllcnIgPSBlLT5nZXQoY291bnRlciwgJmluZGV4KTsKPiA+IC0JaWYgKGVycikK
PiA+IC0JCXJldHVybiBlcnI7Cj4gPiAtCj4gPiAtCWlmIChpbmRleCA+PSBlLT5udW1faXRlbXMp
Cj4gPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiA+IC0KPiA+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAi
JXNcbiIsIGUtPml0ZW1zW2luZGV4XSk7Cj4gPiAtfQo+ID4gLUVYUE9SVF9TWU1CT0xfR1BMKGNv
dW50ZXJfZGV2aWNlX2VudW1fcmVhZCk7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVyX2Rldmlj
ZV9lbnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdm9pZCAqcHJpdiwK
PiA+IC0JCQkJICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gPiAtewo+ID4gLQljb25z
dCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+ID4gLQlz
c2l6ZV90IGluZGV4Owo+ID4gLQlpbnQgZXJyOwo+ID4gLQo+ID4gLQlpZiAoIWUtPnNldCkKPiA+
IC0JCXJldHVybiAtRUlOVkFMOwo+ID4gLQo+ID4gLQlpbmRleCA9IF9fc3lzZnNfbWF0Y2hfc3Ry
aW5nKGUtPml0ZW1zLCBlLT5udW1faXRlbXMsIGJ1Zik7Cj4gPiAtCWlmIChpbmRleCA8IDApCj4g
PiAtCQlyZXR1cm4gaW5kZXg7Cj4gPiAtCj4gPiAtCWVyciA9IGUtPnNldChjb3VudGVyLCBpbmRl
eCk7Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlyZXR1cm4gZXJyOwo+ID4gLQo+ID4gLQlyZXR1cm4g
bGVuOwo+ID4gLX0KPiA+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX2RldmljZV9lbnVtX3dy
aXRlKTsKPiA+IC0KPiA+IC1zc2l6ZV90IGNvdW50ZXJfZGV2aWNlX2VudW1fYXZhaWxhYmxlX3Jl
YWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkJICAgdm9pZCAqcHJp
diwgY2hhciAqYnVmKQo+ID4gLXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2Vu
dW1fZXh0ICpjb25zdCBlID0gcHJpdjsKPiA+IC0Jc2l6ZV90IGk7Cj4gPiAtCXNpemVfdCBsZW4g
PSAwOwo+ID4gLQo+ID4gLQlpZiAoIWUtPm51bV9pdGVtcykKPiA+IC0JCXJldHVybiAwOwo+ID4g
LQo+ID4gLQlmb3IgKGkgPSAwOyBpIDwgZS0+bnVtX2l0ZW1zOyBpKyspCj4gPiAtCQlsZW4gKz0g
c3ByaW50ZihidWYgKyBsZW4sICIlc1xuIiwgZS0+aXRlbXNbaV0pOwo+ID4gLQo+ID4gLQlyZXR1
cm4gbGVuOwo+ID4gLX0KPiA+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX2RldmljZV9lbnVt
X2F2YWlsYWJsZV9yZWFkKTsKPiA+IC0KPiA+IC1zdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gewo+
ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqZ3JvdXA7Cj4gPiAtCWNvbnN0
IGNoYXIgKnByZWZpeDsKPiA+IC0JY29uc3QgY2hhciAqbmFtZTsKPiA+IC0Jc3NpemVfdCAoKnNo
b3cpKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4g
PiAtCQkJY2hhciAqYnVmKTsKPiA+IC0Jc3NpemVfdCAoKnN0b3JlKShzdHJ1Y3QgZGV2aWNlICpk
ZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ID4gLQkJCSBjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pOwo+ID4gLQl2b2lkICpjb21wb25lbnQ7Cj4gPiAtfTsKPiA+IC0KPiA+
IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciB7Cj4gPiAtCXN0cnVjdCBkZXZpY2VfYXR0cmli
dXRlIGRldl9hdHRyOwo+ID4gLQlzdHJ1Y3QgbGlzdF9oZWFkIGw7Cj4gPiAtCXZvaWQgKmNvbXBv
bmVudDsKPiA+IC19Owo+ID4gLQo+ID4gLXN0YXRpYyBpbnQgY291bnRlcl9hdHRyaWJ1dGVfY3Jl
YXRlKGNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJfcGFybSAqY29uc3QgcGFybSkKPiA+IC17Cj4g
PiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb3VudGVyX2F0dHI7Cj4gPiAtCXN0cnVj
dCBkZXZpY2VfYXR0cmlidXRlICpkZXZfYXR0cjsKPiA+IC0JaW50IGVycjsKPiA+IC0Jc3RydWN0
IGxpc3RfaGVhZCAqY29uc3QgYXR0cl9saXN0ID0gJnBhcm0tPmdyb3VwLT5hdHRyX2xpc3Q7Cj4g
PiAtCj4gPiAtCS8qIEFsbG9jYXRlIGEgQ291bnRlciBkZXZpY2UgYXR0cmlidXRlICovCj4gPiAt
CWNvdW50ZXJfYXR0ciA9IGt6YWxsb2Moc2l6ZW9mKCpjb3VudGVyX2F0dHIpLCBHRlBfS0VSTkVM
KTsKPiA+IC0JaWYgKCFjb3VudGVyX2F0dHIpCj4gPiAtCQlyZXR1cm4gLUVOT01FTTsKPiA+IC0J
ZGV2X2F0dHIgPSAmY291bnRlcl9hdHRyLT5kZXZfYXR0cjsKPiA+IC0KPiA+IC0Jc3lzZnNfYXR0
cl9pbml0KCZkZXZfYXR0ci0+YXR0cik7Cj4gPiAtCj4gPiAtCS8qIENvbmZpZ3VyZSBkZXZpY2Ug
YXR0cmlidXRlICovCj4gPiAtCWRldl9hdHRyLT5hdHRyLm5hbWUgPSBrYXNwcmludGYoR0ZQX0tF
Uk5FTCwgIiVzJXMiLCBwYXJtLT5wcmVmaXgsCj4gPiAtCQkJCQlwYXJtLT5uYW1lKTsKPiA+IC0J
aWYgKCFkZXZfYXR0ci0+YXR0ci5uYW1lKSB7Cj4gPiAtCQllcnIgPSAtRU5PTUVNOwo+ID4gLQkJ
Z290byBlcnJfZnJlZV9jb3VudGVyX2F0dHI7Cj4gPiAtCX0KPiA+IC0JaWYgKHBhcm0tPnNob3cp
IHsKPiA+IC0JCWRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDQ0NDsKPiA+IC0JCWRldl9hdHRyLT5z
aG93ID0gcGFybS0+c2hvdzsKPiA+IC0JfQo+ID4gLQlpZiAocGFybS0+c3RvcmUpIHsKPiA+IC0J
CWRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDIwMDsKPiA+IC0JCWRldl9hdHRyLT5zdG9yZSA9IHBh
cm0tPnN0b3JlOwo+ID4gLQl9Cj4gPiAtCj4gPiAtCS8qIFN0b3JlIGFzc29jaWF0ZWQgQ291bnRl
ciBjb21wb25lbnQgd2l0aCBhdHRyaWJ1dGUgKi8KPiA+IC0JY291bnRlcl9hdHRyLT5jb21wb25l
bnQgPSBwYXJtLT5jb21wb25lbnQ7Cj4gPiAtCj4gPiAtCS8qIEtlZXAgdHJhY2sgb2YgdGhlIGF0
dHJpYnV0ZSBmb3IgbGF0ZXIgY2xlYW51cCAqLwo+ID4gLQlsaXN0X2FkZCgmY291bnRlcl9hdHRy
LT5sLCBhdHRyX2xpc3QpOwo+ID4gLQlwYXJtLT5ncm91cC0+bnVtX2F0dHIrKzsKPiA+IC0KPiA+
IC0JcmV0dXJuIDA7Cj4gPiAtCj4gPiAtZXJyX2ZyZWVfY291bnRlcl9hdHRyOgo+ID4gLQlrZnJl
ZShjb3VudGVyX2F0dHIpOwo+ID4gLQlyZXR1cm4gZXJyOwo+ID4gLX0KPiA+IC0KPiA+IC0jZGVm
aW5lIHRvX2NvdW50ZXJfYXR0cihfZGV2X2F0dHIpIFwKPiA+IC0JY29udGFpbmVyX29mKF9kZXZf
YXR0ciwgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIsIGRldl9hdHRyKQo+ID4gLQo+ID4gLXN0
cnVjdCBjb3VudGVyX3NpZ25hbF91bml0IHsKPiA+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpz
aWduYWw7Cj4gPiAtfTsKPiA+IC0KPiA+IC1zdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRl
cl9zaWduYWxfbGV2ZWxfc3RyW10gPSB7Cj4gPiAtCVtDT1VOVEVSX1NJR05BTF9MRVZFTF9MT1dd
ID0gImxvdyIsCj4gPiAtCVtDT1VOVEVSX1NJR05BTF9MRVZFTF9ISUdIXSA9ICJoaWdoIgo+ID4g
LX07Cj4gPiAtCj4gPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9zaWduYWxfc2hvdyhzdHJ1Y3Qg
ZGV2aWNlICpkZXYsCj4gPiAtCQkJCSAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBj
aGFyICpidWYpCj4gPiAtewo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50
ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2
aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gPiAtCWNv
bnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZhdHRy
LT5jb21wb25lbnQ7Cj4gPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qgc2lnbmFsID0g
Y29tcG9uZW50LT5zaWduYWw7Cj4gPiAtCWludCBlcnI7Cj4gPiAtCWVudW0gY291bnRlcl9zaWdu
YWxfbGV2ZWwgbGV2ZWw7Cj4gPiAtCj4gPiAtCWVyciA9IGNvdW50ZXItPm9wcy0+c2lnbmFsX3Jl
YWQoY291bnRlciwgc2lnbmFsLCAmbGV2ZWwpOwo+ID4gLQlpZiAoZXJyKQo+ID4gLQkJcmV0dXJu
IGVycjsKPiA+IC0KPiA+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGNvdW50ZXJfc2ln
bmFsX2xldmVsX3N0cltsZXZlbF0pOwo+ID4gLX0KPiA+IC0KPiA+IC1zdHJ1Y3QgY291bnRlcl9u
YW1lX3VuaXQgewo+ID4gLQljb25zdCBjaGFyICpuYW1lOwo+ID4gLX07Cj4gPiAtCj4gPiAtc3Rh
dGljIHNzaXplX3QgY291bnRlcl9kZXZpY2VfYXR0cl9uYW1lX3Nob3coc3RydWN0IGRldmljZSAq
ZGV2LAo+ID4gLQkJCQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiA+IC0J
CQkJCSAgICAgY2hhciAqYnVmKQo+ID4gLXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfbmFt
ZV91bml0ICpjb25zdCBjb21wID0gdG9fY291bnRlcl9hdHRyKGF0dHIpLT5jb21wb25lbnQ7Cj4g
PiAtCj4gPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb21wLT5uYW1lKTsKPiA+IC19
Cj4gPiAtCj4gPiAtc3RhdGljIGludCBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0ZSgKPiA+
IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3VwLAo+ID4gLQlj
b25zdCBjaGFyICpjb25zdCBuYW1lKQo+ID4gLXsKPiA+IC0Jc3RydWN0IGNvdW50ZXJfbmFtZV91
bml0ICpuYW1lX2NvbXA7Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2F0dHJfcGFybSBwYXJtOwo+ID4g
LQlpbnQgZXJyOwo+ID4gLQo+ID4gLQkvKiBTa2lwIGlmIG5vIG5hbWUgKi8KPiA+IC0JaWYgKCFu
YW1lKQo+ID4gLQkJcmV0dXJuIDA7Cj4gPiAtCj4gPiAtCS8qIEFsbG9jYXRlIG5hbWUgYXR0cmli
dXRlIGNvbXBvbmVudCAqLwo+ID4gLQluYW1lX2NvbXAgPSBrbWFsbG9jKHNpemVvZigqbmFtZV9j
b21wKSwgR0ZQX0tFUk5FTCk7Cj4gPiAtCWlmICghbmFtZV9jb21wKQo+ID4gLQkJcmV0dXJuIC1F
Tk9NRU07Cj4gPiAtCW5hbWVfY29tcC0+bmFtZSA9IG5hbWU7Cj4gPiAtCj4gPiAtCS8qIEFsbG9j
YXRlIFNpZ25hbCBuYW1lIGF0dHJpYnV0ZSAqLwo+ID4gLQlwYXJtLmdyb3VwID0gZ3JvdXA7Cj4g
PiAtCXBhcm0ucHJlZml4ID0gIiI7Cj4gPiAtCXBhcm0ubmFtZSA9ICJuYW1lIjsKPiA+IC0JcGFy
bS5zaG93ID0gY291bnRlcl9kZXZpY2VfYXR0cl9uYW1lX3Nob3c7Cj4gPiAtCXBhcm0uc3RvcmUg
PSBOVUxMOwo+ID4gLQlwYXJtLmNvbXBvbmVudCA9IG5hbWVfY29tcDsKPiA+IC0JZXJyID0gY291
bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCWdvdG8g
ZXJyX2ZyZWVfbmFtZV9jb21wOwo+ID4gLQo+ID4gLQlyZXR1cm4gMDsKPiA+IC0KPiA+IC1lcnJf
ZnJlZV9uYW1lX2NvbXA6Cj4gPiAtCWtmcmVlKG5hbWVfY29tcCk7Cj4gPiAtCXJldHVybiBlcnI7
Cj4gPiAtfQo+ID4gLQo+ID4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHRfdW5pdCB7Cj4gPiAt
CXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsOwo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRl
cl9zaWduYWxfZXh0ICpleHQ7Cj4gPiAtfTsKPiA+IC0KPiA+IC1zdGF0aWMgc3NpemVfdCBjb3Vu
dGVyX3NpZ25hbF9leHRfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gPiAtCQkJCSAgICAgICBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4gLXsKPiA+IC0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVy
X2F0dHIoYXR0cik7Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHRfdW5pdCAq
Y29uc3QgY29tcCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50
ZXJfc2lnbmFsX2V4dCAqY29uc3QgZXh0ID0gY29tcC0+ZXh0Owo+ID4gLQo+ID4gLQlyZXR1cm4g
ZXh0LT5yZWFkKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBjb21wLT5zaWduYWwsIGV4dC0+cHJpdiwg
YnVmKTsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9zaWduYWxfZXh0
X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+IC0JCQkJCXN0cnVjdCBkZXZpY2VfYXR0cmli
dXRlICphdHRyLAo+ID4gLQkJCQkJY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ID4gLXsK
PiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0
b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9l
eHRfdW5pdCAqY29uc3QgY29tcCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiA+IC0JY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsX2V4dCAqY29uc3QgZXh0ID0gY29tcC0+ZXh0Owo+ID4gLQo+ID4g
LQlyZXR1cm4gZXh0LT53cml0ZShkZXZfZ2V0X2RydmRhdGEoZGV2KSwgY29tcC0+c2lnbmFsLCBl
eHQtPnByaXYsIGJ1ZiwKPiA+IC0JCWxlbik7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyB2b2lk
IGNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKHN0cnVjdCBsaXN0X2hlYWQgKmF0dHJfbGlz
dCkKPiA+IC17Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpwLCAqbjsKPiA+IC0K
PiA+IC0JbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKHAsIG4sIGF0dHJfbGlzdCwgbCkgewo+ID4g
LQkJLyogZnJlZSBhdHRyaWJ1dGUgbmFtZSBhbmQgYXNzb2NpYXRlZCBjb21wb25lbnQgbWVtb3J5
ICovCj4gPiAtCQlrZnJlZShwLT5kZXZfYXR0ci5hdHRyLm5hbWUpOwo+ID4gLQkJa2ZyZWUocC0+
Y29tcG9uZW50KTsKPiA+IC0JCWxpc3RfZGVsKCZwLT5sKTsKPiA+IC0JCWtmcmVlKHApOwo+ID4g
LQl9Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyBpbnQgY291bnRlcl9zaWduYWxfZXh0X3JlZ2lz
dGVyKAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXAs
Cj4gPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qgc2lnbmFsKQo+ID4gLXsKPiA+IC0J
Y29uc3Qgc2l6ZV90IG51bV9leHQgPSBzaWduYWwtPm51bV9leHQ7Cj4gPiAtCXNpemVfdCBpOwo+
ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0ICpleHQ7Cj4gPiAtCXN0cnVjdCBj
b3VudGVyX3NpZ25hbF9leHRfdW5pdCAqc2lnbmFsX2V4dF9jb21wOwo+ID4gLQlzdHJ1Y3QgY291
bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiA+IC0JaW50IGVycjsKPiA+IC0KPiA+IC0JLyogQ3JlYXRl
IGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBleHRlbnNpb24gKi8KPiA+IC0JZm9yIChpID0gMCA7IGkg
PCBudW1fZXh0OyBpKyspIHsKPiA+IC0JCWV4dCA9IHNpZ25hbC0+ZXh0ICsgaTsKPiA+IC0KPiA+
IC0JCS8qIEFsbG9jYXRlIHNpZ25hbF9leHQgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+ID4gLQkJ
c2lnbmFsX2V4dF9jb21wID0ga21hbGxvYyhzaXplb2YoKnNpZ25hbF9leHRfY29tcCksIEdGUF9L
RVJORUwpOwo+ID4gLQkJaWYgKCFzaWduYWxfZXh0X2NvbXApIHsKPiA+IC0JCQllcnIgPSAtRU5P
TUVNOwo+ID4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQkJfQo+ID4gLQkJc2ln
bmFsX2V4dF9jb21wLT5zaWduYWwgPSBzaWduYWw7Cj4gPiAtCQlzaWduYWxfZXh0X2NvbXAtPmV4
dCA9IGV4dDsKPiA+IC0KPiA+IC0JCS8qIEFsbG9jYXRlIGEgQ291bnRlciBkZXZpY2UgYXR0cmli
dXRlICovCj4gPiAtCQlwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gPiAtCQlwYXJtLnByZWZpeCA9ICIi
Owo+ID4gLQkJcGFybS5uYW1lID0gZXh0LT5uYW1lOwo+ID4gLQkJcGFybS5zaG93ID0gKGV4dC0+
cmVhZCkgPyBjb3VudGVyX3NpZ25hbF9leHRfc2hvdyA6IE5VTEw7Cj4gPiAtCQlwYXJtLnN0b3Jl
ID0gKGV4dC0+d3JpdGUpID8gY291bnRlcl9zaWduYWxfZXh0X3N0b3JlIDogTlVMTDsKPiA+IC0J
CXBhcm0uY29tcG9uZW50ID0gc2lnbmFsX2V4dF9jb21wOwo+ID4gLQkJZXJyID0gY291bnRlcl9h
dHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiA+IC0JCWlmIChlcnIpIHsKPiA+IC0JCQlrZnJlZShz
aWduYWxfZXh0X2NvbXApOwo+ID4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQkJ
fQo+ID4gLQl9Cj4gPiAtCj4gPiAtCXJldHVybiAwOwo+ID4gLQo+ID4gLWVycl9mcmVlX2F0dHJf
bGlzdDoKPiA+IC0JY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xp
c3QpOwo+ID4gLQlyZXR1cm4gZXJyOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgaW50IGNvdW50
ZXJfc2lnbmFsX2F0dHJpYnV0ZXNfY3JlYXRlKAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2Vf
YXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY29uc3QgY291bnRlciwKPiA+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpjb25zdCBzaWdu
YWwpCj4gPiAtewo+ID4gLQlzdHJ1Y3QgY291bnRlcl9zaWduYWxfdW5pdCAqc2lnbmFsX2NvbXA7
Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2F0dHJfcGFybSBwYXJtOwo+ID4gLQlpbnQgZXJyOwo+ID4g
LQo+ID4gLQkvKiBBbGxvY2F0ZSBTaWduYWwgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+ID4gLQlz
aWduYWxfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpzaWduYWxfY29tcCksIEdGUF9LRVJORUwpOwo+
ID4gLQlpZiAoIXNpZ25hbF9jb21wKQo+ID4gLQkJcmV0dXJuIC1FTk9NRU07Cj4gPiAtCXNpZ25h
bF9jb21wLT5zaWduYWwgPSBzaWduYWw7Cj4gPiAtCj4gPiAtCS8qIENyZWF0ZSBtYWluIFNpZ25h
bCBhdHRyaWJ1dGUgKi8KPiA+IC0JcGFybS5ncm91cCA9IGdyb3VwOwo+ID4gLQlwYXJtLnByZWZp
eCA9ICIiOwo+ID4gLQlwYXJtLm5hbWUgPSAic2lnbmFsIjsKPiA+IC0JcGFybS5zaG93ID0gKGNv
dW50ZXItPm9wcy0+c2lnbmFsX3JlYWQpID8gY291bnRlcl9zaWduYWxfc2hvdyA6IE5VTEw7Cj4g
PiAtCXBhcm0uc3RvcmUgPSBOVUxMOwo+ID4gLQlwYXJtLmNvbXBvbmVudCA9IHNpZ25hbF9jb21w
Owo+ID4gLQllcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+ID4gLQlpZiAo
ZXJyKSB7Cj4gPiAtCQlrZnJlZShzaWduYWxfY29tcCk7Cj4gPiAtCQlyZXR1cm4gZXJyOwo+ID4g
LQl9Cj4gPiAtCj4gPiAtCS8qIENyZWF0ZSBTaWduYWwgbmFtZSBhdHRyaWJ1dGUgKi8KPiA+IC0J
ZXJyID0gY291bnRlcl9uYW1lX2F0dHJpYnV0ZV9jcmVhdGUoZ3JvdXAsIHNpZ25hbC0+bmFtZSk7
Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiA+IC0KPiA+
IC0JLyogUmVnaXN0ZXIgU2lnbmFsIGV4dGVuc2lvbiBhdHRyaWJ1dGVzICovCj4gPiAtCWVyciA9
IGNvdW50ZXJfc2lnbmFsX2V4dF9yZWdpc3Rlcihncm91cCwgc2lnbmFsKTsKPiA+IC0JaWYgKGVy
cikKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQo+ID4gLQlyZXR1cm4gMDsK
PiA+IC0KPiA+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6Cj4gPiAtCWNvdW50ZXJfZGV2aWNlX2F0dHJf
bGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsKPiA+IC0JcmV0dXJuIGVycjsKPiA+IC19Cj4g
PiAtCj4gPiAtc3RhdGljIGludCBjb3VudGVyX3NpZ25hbHNfcmVnaXN0ZXIoCj4gPiAtCXN0cnVj
dCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cHNfbGlzdCwKPiA+IC0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+ID4gLXsKPiA+IC0JY29u
c3Qgc2l6ZV90IG51bV9zaWduYWxzID0gY291bnRlci0+bnVtX3NpZ25hbHM7Cj4gPiAtCXNpemVf
dCBpOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbDsKPiA+IC0JY29uc3QgY2hh
ciAqbmFtZTsKPiA+IC0JaW50IGVycjsKPiA+IC0KPiA+IC0JLyogUmVnaXN0ZXIgZWFjaCBTaWdu
YWwgKi8KPiA+IC0JZm9yIChpID0gMDsgaSA8IG51bV9zaWduYWxzOyBpKyspIHsKPiA+IC0JCXNp
Z25hbCA9IGNvdW50ZXItPnNpZ25hbHMgKyBpOwo+ID4gLQo+ID4gLQkJLyogR2VuZXJhdGUgU2ln
bmFsIGF0dHJpYnV0ZSBkaXJlY3RvcnkgbmFtZSAqLwo+ID4gLQkJbmFtZSA9IGthc3ByaW50ZihH
RlBfS0VSTkVMLCAic2lnbmFsJWQiLCBzaWduYWwtPmlkKTsKPiA+IC0JCWlmICghbmFtZSkgewo+
ID4gLQkJCWVyciA9IC1FTk9NRU07Cj4gPiAtCQkJZ290byBlcnJfZnJlZV9hdHRyX2dyb3VwczsK
PiA+IC0JCX0KPiA+IC0JCWdyb3Vwc19saXN0W2ldLmF0dHJfZ3JvdXAubmFtZSA9IG5hbWU7Cj4g
PiAtCj4gPiAtCQkvKiBDcmVhdGUgYWxsIGF0dHJpYnV0ZXMgYXNzb2NpYXRlZCB3aXRoIFNpZ25h
bCAqLwo+ID4gLQkJZXJyID0gY291bnRlcl9zaWduYWxfYXR0cmlidXRlc19jcmVhdGUoZ3JvdXBz
X2xpc3QgKyBpLCBjb3VudGVyLAo+ID4gLQkJCQkJCSAgICAgICBzaWduYWwpOwo+ID4gLQkJaWYg
KGVycikKPiA+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfZ3JvdXBzOwo+ID4gLQl9Cj4gPiAtCj4g
PiAtCXJldHVybiAwOwo+ID4gLQo+ID4gLWVycl9mcmVlX2F0dHJfZ3JvdXBzOgo+ID4gLQlkbyB7
Cj4gPiAtCQlrZnJlZShncm91cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUpOwo+ID4gLQkJY291
bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3Vwc19saXN0W2ldLmF0dHJfbGlzdCk7Cj4g
PiAtCX0gd2hpbGUgKGktLSk7Cj4gPiAtCXJldHVybiBlcnI7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0
YXRpYyBjb25zdCBjaGFyICpjb25zdCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0cltdID0gewo+
ID4gLQlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FXSA9ICJub25lIiwKPiA+IC0JW0NPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0VdID0gInJpc2luZyBlZGdlIiwKPiA+IC0JW0NP
VU5URVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFXSA9ICJmYWxsaW5nIGVkZ2UiLAo+ID4g
LQlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTXSA9ICJib3RoIGVkZ2VzIgo+ID4g
LX07Cj4gPiAtCj4gPiAtc3RydWN0IGNvdW50ZXJfYWN0aW9uX3VuaXQgewo+ID4gLQlzdHJ1Y3Qg
Y291bnRlcl9zeW5hcHNlICpzeW5hcHNlOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQ7Cj4gPiAtfTsKPiA+IC0KPiA+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2FjdGlvbl9zaG93
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+IC0JCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUg
KmF0dHIsIGNoYXIgKmJ1ZikKPiA+IC17Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rldmlj
ZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+ID4gLQlpbnQg
ZXJyOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0
X2RydmRhdGEoZGV2KTsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfYWN0aW9uX3VuaXQgKmNv
bnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiA+IC0Jc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvbnN0IGNvdW50ID0gY29tcG9uZW50LT5jb3VudDsKPiA+IC0Jc3RydWN0IGNvdW50
ZXJfc3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGNvbXBvbmVudC0+c3luYXBzZTsKPiA+IC0Jc2l6
ZV90IGFjdGlvbl9pbmRleDsKPiA+IC0JZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlv
bjsKPiA+IC0KPiA+IC0JZXJyID0gY291bnRlci0+b3BzLT5hY3Rpb25fZ2V0KGNvdW50ZXIsIGNv
dW50LCBzeW5hcHNlLCAmYWN0aW9uX2luZGV4KTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCXJldHVy
biBlcnI7Cj4gPiAtCj4gPiAtCXN5bmFwc2UtPmFjdGlvbiA9IGFjdGlvbl9pbmRleDsKPiA+IC0K
PiA+IC0JYWN0aW9uID0gc3luYXBzZS0+YWN0aW9uc19saXN0W2FjdGlvbl9pbmRleF07Cj4gPiAt
CXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0clth
Y3Rpb25dKTsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9hY3Rpb25f
c3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+ID4gLQkJCQkgICAgc3RydWN0IGRldmljZV9hdHRy
aWJ1dGUgKmF0dHIsCj4gPiAtCQkJCSAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4g
PiAtewo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0
ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfYWN0
aW9uX3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiA+IC0Jc3Ry
dWN0IGNvdW50ZXJfc3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGNvbXBvbmVudC0+c3luYXBzZTsK
PiA+IC0Jc2l6ZV90IGFjdGlvbl9pbmRleDsKPiA+IC0JY29uc3Qgc2l6ZV90IG51bV9hY3Rpb25z
ID0gc3luYXBzZS0+bnVtX2FjdGlvbnM7Cj4gPiAtCWVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlv
biBhY3Rpb247Cj4gPiAtCWludCBlcnI7Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29u
c3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY29uc3QgY291bnQgPSBjb21wb25lbnQtPmNvdW50Owo+ID4gLQo+ID4gLQkvKiBGaW5k
IHJlcXVlc3RlZCBhY3Rpb24gbW9kZSAqLwo+ID4gLQlmb3IgKGFjdGlvbl9pbmRleCA9IDA7IGFj
dGlvbl9pbmRleCA8IG51bV9hY3Rpb25zOyBhY3Rpb25faW5kZXgrKykgewo+ID4gLQkJYWN0aW9u
ID0gc3luYXBzZS0+YWN0aW9uc19saXN0W2FjdGlvbl9pbmRleF07Cj4gPiAtCQlpZiAoc3lzZnNf
c3RyZXEoYnVmLCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0clthY3Rpb25dKSkKPiA+IC0JCQli
cmVhazsKPiA+IC0JfQo+ID4gLQkvKiBJZiByZXF1ZXN0ZWQgYWN0aW9uIG1vZGUgbm90IGZvdW5k
ICovCj4gPiAtCWlmIChhY3Rpb25faW5kZXggPj0gbnVtX2FjdGlvbnMpCj4gPiAtCQlyZXR1cm4g
LUVJTlZBTDsKPiA+IC0KPiA+IC0JZXJyID0gY291bnRlci0+b3BzLT5hY3Rpb25fc2V0KGNvdW50
ZXIsIGNvdW50LCBzeW5hcHNlLCBhY3Rpb25faW5kZXgpOwo+ID4gLQlpZiAoZXJyKQo+ID4gLQkJ
cmV0dXJuIGVycjsKPiA+IC0KPiA+IC0Jc3luYXBzZS0+YWN0aW9uID0gYWN0aW9uX2luZGV4Owo+
ID4gLQo+ID4gLQlyZXR1cm4gbGVuOwo+ID4gLX0KPiA+IC0KPiA+IC1zdHJ1Y3QgY291bnRlcl9h
Y3Rpb25fYXZhaWxfdW5pdCB7Cj4gPiAtCWNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlv
biAqYWN0aW9uc19saXN0Owo+ID4gLQlzaXplX3QgbnVtX2FjdGlvbnM7Cj4gPiAtfTsKPiA+IC0K
PiA+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX2F2YWlsYWJsZV9zaG93
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+IC0Jc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIs
IGNoYXIgKmJ1ZikKPiA+IC17Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRy
ICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+ID4gLQljb25zdCBzdHJ1
Y3QgY291bnRlcl9hY3Rpb25fYXZhaWxfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+
Y29tcG9uZW50Owo+ID4gLQlzaXplX3QgaTsKPiA+IC0JZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0
aW9uIGFjdGlvbjsKPiA+IC0Jc3NpemVfdCBsZW4gPSAwOwo+ID4gLQo+ID4gLQlmb3IgKGkgPSAw
OyBpIDwgY29tcG9uZW50LT5udW1fYWN0aW9uczsgaSsrKSB7Cj4gPiAtCQlhY3Rpb24gPSBjb21w
b25lbnQtPmFjdGlvbnNfbGlzdFtpXTsKPiA+IC0JCWxlbiArPSBzcHJpbnRmKGJ1ZiArIGxlbiwg
IiVzXG4iLAo+ID4gLQkJCSAgICAgICBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0clthY3Rpb25d
KTsKPiA+IC0JfQo+ID4gLQo+ID4gLQlyZXR1cm4gbGVuOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0
aWMgaW50IGNvdW50ZXJfc3luYXBzZXNfcmVnaXN0ZXIoCj4gPiAtCXN0cnVjdCBjb3VudGVyX2Rl
dmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb25zdCBjb3VudGVyLAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3Qg
Y291bnQsIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50X2F0dHJfbmFtZSkKPiA+IC17Cj4gPiAtCXNp
emVfdCBpOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlOwo+ID4gLQljb25z
dCBjaGFyICpwcmVmaXg7Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2FjdGlvbl91bml0ICphY3Rpb25f
Y29tcDsKPiA+IC0Jc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Cj4gPiAtCWludCBlcnI7
Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2FjdGlvbl9hdmFpbF91bml0ICphdmFpbF9jb21wOwo+ID4g
LQo+ID4gLQkvKiBSZWdpc3RlciBlYWNoIFN5bmFwc2UgKi8KPiA+IC0JZm9yIChpID0gMDsgaSA8
IGNvdW50LT5udW1fc3luYXBzZXM7IGkrKykgewo+ID4gLQkJc3luYXBzZSA9IGNvdW50LT5zeW5h
cHNlcyArIGk7Cj4gPiAtCj4gPiAtCQkvKiBHZW5lcmF0ZSBhdHRyaWJ1dGUgcHJlZml4ICovCj4g
PiAtCQlwcmVmaXggPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgInNpZ25hbCVkXyIsCj4gPiAtCQkJ
CSAgIHN5bmFwc2UtPnNpZ25hbC0+aWQpOwo+ID4gLQkJaWYgKCFwcmVmaXgpIHsKPiA+IC0JCQll
cnIgPSAtRU5PTUVNOwo+ID4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQkJfQo+
ID4gLQo+ID4gLQkJLyogQWxsb2NhdGUgYWN0aW9uIGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiA+
IC0JCWFjdGlvbl9jb21wID0ga21hbGxvYyhzaXplb2YoKmFjdGlvbl9jb21wKSwgR0ZQX0tFUk5F
TCk7Cj4gPiAtCQlpZiAoIWFjdGlvbl9jb21wKSB7Cj4gPiAtCQkJZXJyID0gLUVOT01FTTsKPiA+
IC0JCQlnb3RvIGVycl9mcmVlX3ByZWZpeDsKPiA+IC0JCX0KPiA+IC0JCWFjdGlvbl9jb21wLT5z
eW5hcHNlID0gc3luYXBzZTsKPiA+IC0JCWFjdGlvbl9jb21wLT5jb3VudCA9IGNvdW50Owo+ID4g
LQo+ID4gLQkJLyogQ3JlYXRlIGFjdGlvbiBhdHRyaWJ1dGUgKi8KPiA+IC0JCXBhcm0uZ3JvdXAg
PSBncm91cDsKPiA+IC0JCXBhcm0ucHJlZml4ID0gcHJlZml4Owo+ID4gLQkJcGFybS5uYW1lID0g
ImFjdGlvbiI7Cj4gPiAtCQlwYXJtLnNob3cgPSAoY291bnRlci0+b3BzLT5hY3Rpb25fZ2V0KSA/
IGNvdW50ZXJfYWN0aW9uX3Nob3cgOiBOVUxMOwo+ID4gLQkJcGFybS5zdG9yZSA9IChjb3VudGVy
LT5vcHMtPmFjdGlvbl9zZXQpID8gY291bnRlcl9hY3Rpb25fc3RvcmUgOiBOVUxMOwo+ID4gLQkJ
cGFybS5jb21wb25lbnQgPSBhY3Rpb25fY29tcDsKPiA+IC0JCWVyciA9IGNvdW50ZXJfYXR0cmli
dXRlX2NyZWF0ZSgmcGFybSk7Cj4gPiAtCQlpZiAoZXJyKSB7Cj4gPiAtCQkJa2ZyZWUoYWN0aW9u
X2NvbXApOwo+ID4gLQkJCWdvdG8gZXJyX2ZyZWVfcHJlZml4Owo+ID4gLQkJfQo+ID4gLQo+ID4g
LQkJLyogQWxsb2NhdGUgYWN0aW9uIGF2YWlsYWJsZSBhdHRyaWJ1dGUgY29tcG9uZW50ICovCj4g
PiAtCQlhdmFpbF9jb21wID0ga21hbGxvYyhzaXplb2YoKmF2YWlsX2NvbXApLCBHRlBfS0VSTkVM
KTsKPiA+IC0JCWlmICghYXZhaWxfY29tcCkgewo+ID4gLQkJCWVyciA9IC1FTk9NRU07Cj4gPiAt
CQkJZ290byBlcnJfZnJlZV9wcmVmaXg7Cj4gPiAtCQl9Cj4gPiAtCQlhdmFpbF9jb21wLT5hY3Rp
b25zX2xpc3QgPSBzeW5hcHNlLT5hY3Rpb25zX2xpc3Q7Cj4gPiAtCQlhdmFpbF9jb21wLT5udW1f
YWN0aW9ucyA9IHN5bmFwc2UtPm51bV9hY3Rpb25zOwo+ID4gLQo+ID4gLQkJLyogQ3JlYXRlIGFj
dGlvbl9hdmFpbGFibGUgYXR0cmlidXRlICovCj4gPiAtCQlwYXJtLmdyb3VwID0gZ3JvdXA7Cj4g
PiAtCQlwYXJtLnByZWZpeCA9IHByZWZpeDsKPiA+IC0JCXBhcm0ubmFtZSA9ICJhY3Rpb25fYXZh
aWxhYmxlIjsKPiA+IC0JCXBhcm0uc2hvdyA9IGNvdW50ZXJfc3luYXBzZV9hY3Rpb25fYXZhaWxh
YmxlX3Nob3c7Cj4gPiAtCQlwYXJtLnN0b3JlID0gTlVMTDsKPiA+IC0JCXBhcm0uY29tcG9uZW50
ID0gYXZhaWxfY29tcDsKPiA+IC0JCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFy
bSk7Cj4gPiAtCQlpZiAoZXJyKSB7Cj4gPiAtCQkJa2ZyZWUoYXZhaWxfY29tcCk7Cj4gPiAtCQkJ
Z290byBlcnJfZnJlZV9wcmVmaXg7Cj4gPiAtCQl9Cj4gPiAtCj4gPiAtCQlrZnJlZShwcmVmaXgp
Owo+ID4gLQl9Cj4gPiAtCj4gPiAtCXJldHVybiAwOwo+ID4gLQo+ID4gLWVycl9mcmVlX3ByZWZp
eDoKPiA+IC0Ja2ZyZWUocHJlZml4KTsKPiA+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6Cj4gPiAtCWNv
dW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsKPiA+IC0JcmV0
dXJuIGVycjsKPiA+IC19Cj4gPiAtCj4gPiAtc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCB7Cj4g
PiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKPiA+IC19Owo+ID4gLQo+ID4gLXN0YXRp
YyBzc2l6ZV90IGNvdW50ZXJfY291bnRfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gPiAtCQkJ
CSAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gPiAtCQkJCSAgY2hhciAqYnVmKQo+
ID4gLXsKPiA+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dl
dF9kcnZkYXRhKGRldik7Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpj
b25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+ID4gLQljb25zdCBzdHJ1Y3Qg
Y291bnRlcl9jb3VudF91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZhdHRyLT5jb21wb25lbnQ7
Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGNvbXBvbmVudC0+Y291
bnQ7Cj4gPiAtCWludCBlcnI7Cj4gPiAtCXVuc2lnbmVkIGxvbmcgdmFsOwo+ID4gLQo+ID4gLQll
cnIgPSBjb3VudGVyLT5vcHMtPmNvdW50X3JlYWQoY291bnRlciwgY291bnQsICZ2YWwpOwo+ID4g
LQlpZiAoZXJyKQo+ID4gLQkJcmV0dXJuIGVycjsKPiA+IC0KPiA+IC0JcmV0dXJuIHNwcmludGYo
YnVmLCAiJWx1XG4iLCB2YWwpOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgc3NpemVfdCBjb3Vu
dGVyX2NvdW50X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+IC0JCQkJICAgc3RydWN0IGRl
dmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gPiAtCQkJCSAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90
IGxlbikKPiA+IC17Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9
IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2Vf
YXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiA+IC0JY29uc3Qg
c3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29t
cG9uZW50Owo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBjb21wb25l
bnQtPmNvdW50Owo+ID4gLQlpbnQgZXJyOwo+ID4gLQl1bnNpZ25lZCBsb25nIHZhbDsKPiA+IC0K
PiA+IC0JZXJyID0ga3N0cnRvdWwoYnVmLCAwLCAmdmFsKTsKPiA+IC0JaWYgKGVycikKPiA+IC0J
CXJldHVybiBlcnI7Cj4gPiAtCj4gPiAtCWVyciA9IGNvdW50ZXItPm9wcy0+Y291bnRfd3JpdGUo
Y291bnRlciwgY291bnQsIHZhbCk7Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlyZXR1cm4gZXJyOwo+
ID4gLQo+ID4gLQlyZXR1cm4gbGVuOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgY29uc3QgY2hh
ciAqY29uc3QgY291bnRlcl9mdW5jdGlvbl9zdHJbXSA9IHsKPiA+IC0JW0NPVU5URVJfRlVOQ1RJ
T05fSU5DUkVBU0VdID0gImluY3JlYXNlIiwKPiA+IC0JW0NPVU5URVJfRlVOQ1RJT05fREVDUkVB
U0VdID0gImRlY3JlYXNlIiwKPiA+IC0JW0NPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9O
XSA9ICJwdWxzZS1kaXJlY3Rpb24iLAo+ID4gLQlbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJF
X1gxX0FdID0gInF1YWRyYXR1cmUgeDEgYSIsCj4gPiAtCVtDT1VOVEVSX0ZVTkNUSU9OX1FVQURS
QVRVUkVfWDFfQl0gPSAicXVhZHJhdHVyZSB4MSBiIiwKPiA+IC0JW0NPVU5URVJfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YMl9BXSA9ICJxdWFkcmF0dXJlIHgyIGEiLAo+ID4gLQlbQ09VTlRFUl9GVU5D
VElPTl9RVUFEUkFUVVJFX1gyX0JdID0gInF1YWRyYXR1cmUgeDIgYiIsCj4gPiAtCVtDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDRdID0gInF1YWRyYXR1cmUgeDQiCj4gPiAtfTsKPiA+IC0K
PiA+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2Z1bmN0aW9uX3Nob3coc3RydWN0IGRldmljZSAq
ZGV2LAo+ID4gLQkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpi
dWYpCj4gPiAtewo+ID4gLQlpbnQgZXJyOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
bnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiA+IC0JY29uc3Qgc3RydWN0IGNv
dW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7
Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9
IGRldmF0dHItPmNvbXBvbmVudDsKPiA+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNv
dW50ID0gY29tcG9uZW50LT5jb3VudDsKPiA+IC0Jc2l6ZV90IGZ1bmNfaW5kZXg7Cj4gPiAtCWVu
dW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiA+IC0KPiA+IC0JZXJyID0gY291bnRlci0+
b3BzLT5mdW5jdGlvbl9nZXQoY291bnRlciwgY291bnQsICZmdW5jX2luZGV4KTsKPiA+IC0JaWYg
KGVycikKPiA+IC0JCXJldHVybiBlcnI7Cj4gPiAtCj4gPiAtCWNvdW50LT5mdW5jdGlvbiA9IGZ1
bmNfaW5kZXg7Cj4gPiAtCj4gPiAtCWZ1bmN0aW9uID0gY291bnQtPmZ1bmN0aW9uc19saXN0W2Z1
bmNfaW5kZXhdOwo+ID4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291bnRlcl9mdW5j
dGlvbl9zdHJbZnVuY3Rpb25dKTsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIHNzaXplX3QgY291
bnRlcl9mdW5jdGlvbl9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gPiAtCQkJCSAgICAgIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ID4gLQkJCQkgICAgICBjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pCj4gPiAtewo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2Vf
YXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiA+IC0JY29uc3Qg
c3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29t
cG9uZW50Owo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBjb21wb25l
bnQtPmNvdW50Owo+ID4gLQljb25zdCBzaXplX3QgbnVtX2Z1bmN0aW9ucyA9IGNvdW50LT5udW1f
ZnVuY3Rpb25zOwo+ID4gLQlzaXplX3QgZnVuY19pbmRleDsKPiA+IC0JZW51bSBjb3VudGVyX2Z1
bmN0aW9uIGZ1bmN0aW9uOwo+ID4gLQlpbnQgZXJyOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiA+IC0KPiA+IC0JLyog
RmluZCByZXF1ZXN0ZWQgQ291bnQgZnVuY3Rpb24gbW9kZSAqLwo+ID4gLQlmb3IgKGZ1bmNfaW5k
ZXggPSAwOyBmdW5jX2luZGV4IDwgbnVtX2Z1bmN0aW9uczsgZnVuY19pbmRleCsrKSB7Cj4gPiAt
CQlmdW5jdGlvbiA9IGNvdW50LT5mdW5jdGlvbnNfbGlzdFtmdW5jX2luZGV4XTsKPiA+IC0JCWlm
IChzeXNmc19zdHJlcShidWYsIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSkpCj4gPiAt
CQkJYnJlYWs7Cj4gPiAtCX0KPiA+IC0JLyogUmV0dXJuIGVycm9yIGlmIHJlcXVlc3RlZCBDb3Vu
dCBmdW5jdGlvbiBtb2RlIG5vdCBmb3VuZCAqLwo+ID4gLQlpZiAoZnVuY19pbmRleCA+PSBudW1f
ZnVuY3Rpb25zKQo+ID4gLQkJcmV0dXJuIC1FSU5WQUw7Cj4gPiAtCj4gPiAtCWVyciA9IGNvdW50
ZXItPm9wcy0+ZnVuY3Rpb25fc2V0KGNvdW50ZXIsIGNvdW50LCBmdW5jX2luZGV4KTsKPiA+IC0J
aWYgKGVycikKPiA+IC0JCXJldHVybiBlcnI7Cj4gPiAtCj4gPiAtCWNvdW50LT5mdW5jdGlvbiA9
IGZ1bmNfaW5kZXg7Cj4gPiAtCj4gPiAtCXJldHVybiBsZW47Cj4gPiAtfQo+ID4gLQo+ID4gLXN0
cnVjdCBjb3VudGVyX2NvdW50X2V4dF91bml0IHsKPiA+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50Owo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgKmV4dDsKPiA+IC19
Owo+ID4gLQo+ID4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY291bnRfZXh0X3Nob3coc3RydWN0
IGRldmljZSAqZGV2LAo+ID4gLQkJCQkgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQo+ID4gLXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0
dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gPiAtCWNvbnN0IHN0
cnVjdCBjb3VudGVyX2NvdW50X2V4dF91bml0ICpjb25zdCBjb21wID0gZGV2YXR0ci0+Y29tcG9u
ZW50Owo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgKmNvbnN0IGV4dCA9IGNv
bXAtPmV4dDsKPiA+IC0KPiA+IC0JcmV0dXJuIGV4dC0+cmVhZChkZXZfZ2V0X2RydmRhdGEoZGV2
KSwgY29tcC0+Y291bnQsIGV4dC0+cHJpdiwgYnVmKTsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGlj
IHNzaXplX3QgY291bnRlcl9jb3VudF9leHRfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+ID4g
LQkJCQkgICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gPiAtCQkJCSAgICAg
ICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gPiAtewo+ID4gLQljb25zdCBzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRy
KTsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0X3VuaXQgKmNvbnN0IGNvbXAg
PSBkZXZhdHRyLT5jb21wb25lbnQ7Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4
dCAqY29uc3QgZXh0ID0gY29tcC0+ZXh0Owo+ID4gLQo+ID4gLQlyZXR1cm4gZXh0LT53cml0ZShk
ZXZfZ2V0X2RydmRhdGEoZGV2KSwgY29tcC0+Y291bnQsIGV4dC0+cHJpdiwgYnVmLAo+ID4gLQkJ
bGVuKTsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIGludCBjb3VudGVyX2NvdW50X2V4dF9yZWdp
c3RlcigKPiA+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3Vw
LAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQpCj4gPiAtewo+ID4gLQlz
aXplX3QgaTsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0ICpleHQ7Cj4gPiAt
CXN0cnVjdCBjb3VudGVyX2NvdW50X2V4dF91bml0ICpjb3VudF9leHRfY29tcDsKPiA+IC0Jc3Ry
dWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Cj4gPiAtCWludCBlcnI7Cj4gPiAtCj4gPiAtCS8q
IENyZWF0ZSBhbiBhdHRyaWJ1dGUgZm9yIGVhY2ggZXh0ZW5zaW9uICovCj4gPiAtCWZvciAoaSA9
IDAgOyBpIDwgY291bnQtPm51bV9leHQ7IGkrKykgewo+ID4gLQkJZXh0ID0gY291bnQtPmV4dCAr
IGk7Cj4gPiAtCj4gPiAtCQkvKiBBbGxvY2F0ZSBjb3VudF9leHQgYXR0cmlidXRlIGNvbXBvbmVu
dCAqLwo+ID4gLQkJY291bnRfZXh0X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqY291bnRfZXh0X2Nv
bXApLCBHRlBfS0VSTkVMKTsKPiA+IC0JCWlmICghY291bnRfZXh0X2NvbXApIHsKPiA+IC0JCQll
cnIgPSAtRU5PTUVNOwo+ID4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQkJfQo+
ID4gLQkJY291bnRfZXh0X2NvbXAtPmNvdW50ID0gY291bnQ7Cj4gPiAtCQljb3VudF9leHRfY29t
cC0+ZXh0ID0gZXh0Owo+ID4gLQo+ID4gLQkJLyogQWxsb2NhdGUgY291bnRfZXh0IGF0dHJpYnV0
ZSAqLwo+ID4gLQkJcGFybS5ncm91cCA9IGdyb3VwOwo+ID4gLQkJcGFybS5wcmVmaXggPSAiIjsK
PiA+IC0JCXBhcm0ubmFtZSA9IGV4dC0+bmFtZTsKPiA+IC0JCXBhcm0uc2hvdyA9IChleHQtPnJl
YWQpID8gY291bnRlcl9jb3VudF9leHRfc2hvdyA6IE5VTEw7Cj4gPiAtCQlwYXJtLnN0b3JlID0g
KGV4dC0+d3JpdGUpID8gY291bnRlcl9jb3VudF9leHRfc3RvcmUgOiBOVUxMOwo+ID4gLQkJcGFy
bS5jb21wb25lbnQgPSBjb3VudF9leHRfY29tcDsKPiA+IC0JCWVyciA9IGNvdW50ZXJfYXR0cmli
dXRlX2NyZWF0ZSgmcGFybSk7Cj4gPiAtCQlpZiAoZXJyKSB7Cj4gPiAtCQkJa2ZyZWUoY291bnRf
ZXh0X2NvbXApOwo+ID4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQkJfQo+ID4g
LQl9Cj4gPiAtCj4gPiAtCXJldHVybiAwOwo+ID4gLQo+ID4gLWVycl9mcmVlX2F0dHJfbGlzdDoK
PiA+IC0JY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwo+
ID4gLQlyZXR1cm4gZXJyOwo+ID4gLX0KPiA+IC0KPiA+IC1zdHJ1Y3QgY291bnRlcl9mdW5jX2F2
YWlsX3VuaXQgewo+ID4gLQljb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uc19s
aXN0Owo+ID4gLQlzaXplX3QgbnVtX2Z1bmN0aW9uczsKPiA+IC19Owo+ID4gLQo+ID4gLXN0YXRp
YyBzc2l6ZV90IGNvdW50ZXJfZnVuY3Rpb25fYXZhaWxhYmxlX3Nob3coc3RydWN0IGRldmljZSAq
ZGV2LAo+ID4gLQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ID4g
LXsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIg
PSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Z1bmNf
YXZhaWxfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+ID4gLQlj
b25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmNvbnN0IGZ1bmNfbGlzdCA9IGNvbXBvbmVudC0+
ZnVuY3Rpb25zX2xpc3Q7Cj4gPiAtCWNvbnN0IHNpemVfdCBudW1fZnVuY3Rpb25zID0gY29tcG9u
ZW50LT5udW1fZnVuY3Rpb25zOwo+ID4gLQlzaXplX3QgaTsKPiA+IC0JZW51bSBjb3VudGVyX2Z1
bmN0aW9uIGZ1bmN0aW9uOwo+ID4gLQlzc2l6ZV90IGxlbiA9IDA7Cj4gPiAtCj4gPiAtCWZvciAo
aSA9IDA7IGkgPCBudW1fZnVuY3Rpb25zOyBpKyspIHsKPiA+IC0JCWZ1bmN0aW9uID0gZnVuY19s
aXN0W2ldOwo+ID4gLQkJbGVuICs9IHNwcmludGYoYnVmICsgbGVuLCAiJXNcbiIsCj4gPiAtCQkJ
ICAgICAgIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSk7Cj4gPiAtCX0KPiA+IC0KPiA+
IC0JcmV0dXJuIGxlbjsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIGludCBjb3VudGVyX2NvdW50
X2F0dHJpYnV0ZXNfY3JlYXRlKAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91
cCAqY29uc3QgZ3JvdXAsCj4gPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3Qg
Y291bnRlciwKPiA+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50KQo+ID4gLXsK
PiA+IC0Jc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqY291bnRfY29tcDsKPiA+IC0Jc3RydWN0
IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Cj4gPiAtCWludCBlcnI7Cj4gPiAtCXN0cnVjdCBjb3Vu
dGVyX2NvdW50X3VuaXQgKmZ1bmNfY29tcDsKPiA+IC0Jc3RydWN0IGNvdW50ZXJfZnVuY19hdmFp
bF91bml0ICphdmFpbF9jb21wOwo+ID4gLQo+ID4gLQkvKiBBbGxvY2F0ZSBjb3VudCBhdHRyaWJ1
dGUgY29tcG9uZW50ICovCj4gPiAtCWNvdW50X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqY291bnRf
Y29tcCksIEdGUF9LRVJORUwpOwo+ID4gLQlpZiAoIWNvdW50X2NvbXApCj4gPiAtCQlyZXR1cm4g
LUVOT01FTTsKPiA+IC0JY291bnRfY29tcC0+Y291bnQgPSBjb3VudDsKPiA+IC0KPiA+IC0JLyog
Q3JlYXRlIG1haW4gQ291bnQgYXR0cmlidXRlICovCj4gPiAtCXBhcm0uZ3JvdXAgPSBncm91cDsK
PiA+IC0JcGFybS5wcmVmaXggPSAiIjsKPiA+IC0JcGFybS5uYW1lID0gImNvdW50IjsKPiA+IC0J
cGFybS5zaG93ID0gKGNvdW50ZXItPm9wcy0+Y291bnRfcmVhZCkgPyBjb3VudGVyX2NvdW50X3No
b3cgOiBOVUxMOwo+ID4gLQlwYXJtLnN0b3JlID0gKGNvdW50ZXItPm9wcy0+Y291bnRfd3JpdGUp
ID8gY291bnRlcl9jb3VudF9zdG9yZSA6IE5VTEw7Cj4gPiAtCXBhcm0uY29tcG9uZW50ID0gY291
bnRfY29tcDsKPiA+IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiA+
IC0JaWYgKGVycikgewo+ID4gLQkJa2ZyZWUoY291bnRfY29tcCk7Cj4gPiAtCQlyZXR1cm4gZXJy
Owo+ID4gLQl9Cj4gPiAtCj4gPiAtCS8qIEFsbG9jYXRlIGZ1bmN0aW9uIGF0dHJpYnV0ZSBjb21w
b25lbnQgKi8KPiA+IC0JZnVuY19jb21wID0ga21hbGxvYyhzaXplb2YoKmZ1bmNfY29tcCksIEdG
UF9LRVJORUwpOwo+ID4gLQlpZiAoIWZ1bmNfY29tcCkgewo+ID4gLQkJZXJyID0gLUVOT01FTTsK
PiA+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQl9Cj4gPiAtCWZ1bmNfY29tcC0+
Y291bnQgPSBjb3VudDsKPiA+IC0KPiA+IC0JLyogQ3JlYXRlIENvdW50IGZ1bmN0aW9uIGF0dHJp
YnV0ZSAqLwo+ID4gLQlwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gPiAtCXBhcm0ucHJlZml4ID0gIiI7
Cj4gPiAtCXBhcm0ubmFtZSA9ICJmdW5jdGlvbiI7Cj4gPiAtCXBhcm0uc2hvdyA9IChjb3VudGVy
LT5vcHMtPmZ1bmN0aW9uX2dldCkgPyBjb3VudGVyX2Z1bmN0aW9uX3Nob3cgOiBOVUxMOwo+ID4g
LQlwYXJtLnN0b3JlID0gKGNvdW50ZXItPm9wcy0+ZnVuY3Rpb25fc2V0KSA/IGNvdW50ZXJfZnVu
Y3Rpb25fc3RvcmUgOiBOVUxMOwo+ID4gLQlwYXJtLmNvbXBvbmVudCA9IGZ1bmNfY29tcDsKPiA+
IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiA+IC0JaWYgKGVycikg
ewo+ID4gLQkJa2ZyZWUoZnVuY19jb21wKTsKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0
Owo+ID4gLQl9Cj4gPiAtCj4gPiAtCS8qIEFsbG9jYXRlIGZ1bmN0aW9uIGF2YWlsYWJsZSBhdHRy
aWJ1dGUgY29tcG9uZW50ICovCj4gPiAtCWF2YWlsX2NvbXAgPSBrbWFsbG9jKHNpemVvZigqYXZh
aWxfY29tcCksIEdGUF9LRVJORUwpOwo+ID4gLQlpZiAoIWF2YWlsX2NvbXApIHsKPiA+IC0JCWVy
ciA9IC1FTk9NRU07Cj4gPiAtCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiA+IC0JfQo+ID4g
LQlhdmFpbF9jb21wLT5mdW5jdGlvbnNfbGlzdCA9IGNvdW50LT5mdW5jdGlvbnNfbGlzdDsKPiA+
IC0JYXZhaWxfY29tcC0+bnVtX2Z1bmN0aW9ucyA9IGNvdW50LT5udW1fZnVuY3Rpb25zOwo+ID4g
LQo+ID4gLQkvKiBDcmVhdGUgQ291bnQgZnVuY3Rpb25fYXZhaWxhYmxlIGF0dHJpYnV0ZSAqLwo+
ID4gLQlwYXJtLmdyb3VwID0gZ3JvdXA7Cj4gPiAtCXBhcm0ucHJlZml4ID0gIiI7Cj4gPiAtCXBh
cm0ubmFtZSA9ICJmdW5jdGlvbl9hdmFpbGFibGUiOwo+ID4gLQlwYXJtLnNob3cgPSBjb3VudGVy
X2Z1bmN0aW9uX2F2YWlsYWJsZV9zaG93Owo+ID4gLQlwYXJtLnN0b3JlID0gTlVMTDsKPiA+IC0J
cGFybS5jb21wb25lbnQgPSBhdmFpbF9jb21wOwo+ID4gLQllcnIgPSBjb3VudGVyX2F0dHJpYnV0
ZV9jcmVhdGUoJnBhcm0pOwo+ID4gLQlpZiAoZXJyKSB7Cj4gPiAtCQlrZnJlZShhdmFpbF9jb21w
KTsKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQl9Cj4gPiAtCj4gPiAtCS8q
IENyZWF0ZSBDb3VudCBuYW1lIGF0dHJpYnV0ZSAqLwo+ID4gLQllcnIgPSBjb3VudGVyX25hbWVf
YXR0cmlidXRlX2NyZWF0ZShncm91cCwgY291bnQtPm5hbWUpOwo+ID4gLQlpZiAoZXJyKQo+ID4g
LQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4gPiAtCj4gPiAtCS8qIFJlZ2lzdGVyIENvdW50
IGV4dGVuc2lvbiBhdHRyaWJ1dGVzICovCj4gPiAtCWVyciA9IGNvdW50ZXJfY291bnRfZXh0X3Jl
Z2lzdGVyKGdyb3VwLCBjb3VudCk7Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlnb3RvIGVycl9mcmVl
X2F0dHJfbGlzdDsKPiA+IC0KPiA+IC0JcmV0dXJuIDA7Cj4gPiAtCj4gPiAtZXJyX2ZyZWVfYXR0
cl9saXN0Ogo+ID4gLQljb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJf
bGlzdCk7Cj4gPiAtCXJldHVybiBlcnI7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyBpbnQgY291
bnRlcl9jb3VudHNfcmVnaXN0ZXIoCj4gPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dy
b3VwICpjb25zdCBncm91cHNfbGlzdCwKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb25zdCBjb3VudGVyKQo+ID4gLXsKPiA+IC0Jc2l6ZV90IGk7Cj4gPiAtCXN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudDsKPiA+IC0JY29uc3QgY2hhciAqbmFtZTsKPiA+IC0JaW50IGVycjsK
PiA+IC0KPiA+IC0JLyogUmVnaXN0ZXIgZWFjaCBDb3VudCAqLwo+ID4gLQlmb3IgKGkgPSAwOyBp
IDwgY291bnRlci0+bnVtX2NvdW50czsgaSsrKSB7Cj4gPiAtCQljb3VudCA9IGNvdW50ZXItPmNv
dW50cyArIGk7Cj4gPiAtCj4gPiAtCQkvKiBHZW5lcmF0ZSBDb3VudCBhdHRyaWJ1dGUgZGlyZWN0
b3J5IG5hbWUgKi8KPiA+IC0JCW5hbWUgPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgImNvdW50JWQi
LCBjb3VudC0+aWQpOwo+ID4gLQkJaWYgKCFuYW1lKSB7Cj4gPiAtCQkJZXJyID0gLUVOT01FTTsK
PiA+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfZ3JvdXBzOwo+ID4gLQkJfQo+ID4gLQkJZ3JvdXBz
X2xpc3RbaV0uYXR0cl9ncm91cC5uYW1lID0gbmFtZTsKPiA+IC0KPiA+IC0JCS8qIFJlZ2lzdGVy
IHRoZSBTeW5hcHNlcyBhc3NvY2lhdGVkIHdpdGggZWFjaCBDb3VudCAqLwo+ID4gLQkJZXJyID0g
Y291bnRlcl9zeW5hcHNlc19yZWdpc3Rlcihncm91cHNfbGlzdCArIGksIGNvdW50ZXIsIGNvdW50
LAo+ID4gLQkJCQkJCW5hbWUpOwo+ID4gLQkJaWYgKGVycikKPiA+IC0JCQlnb3RvIGVycl9mcmVl
X2F0dHJfZ3JvdXBzOwo+ID4gLQo+ID4gLQkJLyogQ3JlYXRlIGFsbCBhdHRyaWJ1dGVzIGFzc29j
aWF0ZWQgd2l0aCBDb3VudCAqLwo+ID4gLQkJZXJyID0gY291bnRlcl9jb3VudF9hdHRyaWJ1dGVz
X2NyZWF0ZShncm91cHNfbGlzdCArIGksIGNvdW50ZXIsCj4gPiAtCQkJCQkJICAgICAgY291bnQp
Owo+ID4gLQkJaWYgKGVycikKPiA+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfZ3JvdXBzOwo+ID4g
LQl9Cj4gPiAtCj4gPiAtCXJldHVybiAwOwo+ID4gLQo+ID4gLWVycl9mcmVlX2F0dHJfZ3JvdXBz
Ogo+ID4gLQlkbyB7Cj4gPiAtCQlrZnJlZShncm91cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUp
Owo+ID4gLQkJY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3Vwc19saXN0W2ldLmF0
dHJfbGlzdCk7Cj4gPiAtCX0gd2hpbGUgKGktLSk7Cj4gPiAtCXJldHVybiBlcnI7Cj4gPiAtfQo+
ID4gLQo+ID4gLXN0cnVjdCBjb3VudGVyX3NpemVfdW5pdCB7Cj4gPiAtCXNpemVfdCBzaXplOwo+
ID4gLX07Cj4gPiAtCj4gPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9kZXZpY2VfYXR0cl9zaXpl
X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+ID4gLQkJCQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0
dHJpYnV0ZSAqYXR0ciwKPiA+IC0JCQkJCSAgICAgY2hhciAqYnVmKQo+ID4gLXsKPiA+IC0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfc2l6ZV91bml0ICpjb25zdCBjb21wID0gdG9fY291bnRlcl9hdHRy
KGF0dHIpLT5jb21wb25lbnQ7Cj4gPiAtCj4gPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV6dVxu
IiwgY29tcC0+c2l6ZSk7Cj4gPiAtfQo+ID4gLQo+ID4gLXN0YXRpYyBpbnQgY291bnRlcl9zaXpl
X2F0dHJpYnV0ZV9jcmVhdGUoCj4gPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3Vw
ICpjb25zdCBncm91cCwKPiA+IC0JY29uc3Qgc2l6ZV90IHNpemUsIGNvbnN0IGNoYXIgKmNvbnN0
IG5hbWUpCj4gPiAtewo+ID4gLQlzdHJ1Y3QgY291bnRlcl9zaXplX3VuaXQgKnNpemVfY29tcDsK
PiA+IC0Jc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Cj4gPiAtCWludCBlcnI7Cj4gPiAt
Cj4gPiAtCS8qIEFsbG9jYXRlIHNpemUgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+ID4gLQlzaXpl
X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqc2l6ZV9jb21wKSwgR0ZQX0tFUk5FTCk7Cj4gPiAtCWlm
ICghc2l6ZV9jb21wKQo+ID4gLQkJcmV0dXJuIC1FTk9NRU07Cj4gPiAtCXNpemVfY29tcC0+c2l6
ZSA9IHNpemU7Cj4gPiAtCj4gPiAtCXBhcm0uZ3JvdXAgPSBncm91cDsKPiA+IC0JcGFybS5wcmVm
aXggPSAiIjsKPiA+IC0JcGFybS5uYW1lID0gbmFtZTsKPiA+IC0JcGFybS5zaG93ID0gY291bnRl
cl9kZXZpY2VfYXR0cl9zaXplX3Nob3c7Cj4gPiAtCXBhcm0uc3RvcmUgPSBOVUxMOwo+ID4gLQlw
YXJtLmNvbXBvbmVudCA9IHNpemVfY29tcDsKPiA+IC0JZXJyID0gY291bnRlcl9hdHRyaWJ1dGVf
Y3JlYXRlKCZwYXJtKTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfc2l6ZV9j
b21wOwo+ID4gLQo+ID4gLQlyZXR1cm4gMDsKPiA+IC0KPiA+IC1lcnJfZnJlZV9zaXplX2NvbXA6
Cj4gPiAtCWtmcmVlKHNpemVfY29tcCk7Cj4gPiAtCXJldHVybiBlcnI7Cj4gPiAtfQo+ID4gLQo+
ID4gLXN0cnVjdCBjb3VudGVyX2V4dF91bml0IHsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2V4dCAqZXh0Owo+ID4gLX07Cj4gPiAtCj4gPiAtc3RhdGljIHNzaXplX3QgY291bnRl
cl9kZXZpY2VfZXh0X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+ID4gLQkJCQkgICAgICAgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiA+IC17Cj4gPiAtCWNvbnN0
IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9h
dHRyKGF0dHIpOwo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9leHRfdW5pdCAqY29uc3QgY29t
cG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+ID4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9k
ZXZpY2VfZXh0ICpjb25zdCBleHQgPSBjb21wb25lbnQtPmV4dDsKPiA+IC0KPiA+IC0JcmV0dXJu
IGV4dC0+cmVhZChkZXZfZ2V0X2RydmRhdGEoZGV2KSwgZXh0LT5wcml2LCBidWYpOwo+ID4gLX0K
PiA+IC0KPiA+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2RldmljZV9leHRfc3RvcmUoc3RydWN0
IGRldmljZSAqZGV2LAo+ID4gLQkJCQkJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4g
PiAtCQkJCQljb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gPiAtewo+ID4gLQljb25zdCBz
dHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0
cihhdHRyKTsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZXh0X3VuaXQgKmNvbnN0IGNvbXBv
bmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2
aWNlX2V4dCAqY29uc3QgZXh0ID0gY29tcG9uZW50LT5leHQ7Cj4gPiAtCj4gPiAtCXJldHVybiBl
eHQtPndyaXRlKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBleHQtPnByaXYsIGJ1ZiwgbGVuKTsKPiA+
IC19Cj4gPiAtCj4gPiAtc3RhdGljIGludCBjb3VudGVyX2RldmljZV9leHRfcmVnaXN0ZXIoCj4g
PiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiA+IC0J
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQo+ID4gLXsKPiA+IC0Jc2l6ZV90
IGk7Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2V4dF91bml0ICpleHRfY29tcDsKPiA+IC0Jc3RydWN0
IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Cj4gPiAtCWludCBlcnI7Cj4gPiAtCj4gPiAtCS8qIENy
ZWF0ZSBhbiBhdHRyaWJ1dGUgZm9yIGVhY2ggZXh0ZW5zaW9uICovCj4gPiAtCWZvciAoaSA9IDAg
OyBpIDwgY291bnRlci0+bnVtX2V4dDsgaSsrKSB7Cj4gPiAtCQkvKiBBbGxvY2F0ZSBleHRlbnNp
b24gYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+ID4gLQkJZXh0X2NvbXAgPSBrbWFsbG9jKHNpemVv
ZigqZXh0X2NvbXApLCBHRlBfS0VSTkVMKTsKPiA+IC0JCWlmICghZXh0X2NvbXApIHsKPiA+IC0J
CQllcnIgPSAtRU5PTUVNOwo+ID4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQkJ
fQo+ID4gLQo+ID4gLQkJZXh0X2NvbXAtPmV4dCA9IGNvdW50ZXItPmV4dCArIGk7Cj4gPiAtCj4g
PiAtCQkvKiBBbGxvY2F0ZSBleHRlbnNpb24gYXR0cmlidXRlICovCj4gPiAtCQlwYXJtLmdyb3Vw
ID0gZ3JvdXA7Cj4gPiAtCQlwYXJtLnByZWZpeCA9ICIiOwo+ID4gLQkJcGFybS5uYW1lID0gY291
bnRlci0+ZXh0W2ldLm5hbWU7Cj4gPiAtCQlwYXJtLnNob3cgPSAoY291bnRlci0+ZXh0W2ldLnJl
YWQpID8gY291bnRlcl9kZXZpY2VfZXh0X3Nob3cgOiBOVUxMOwo+ID4gLQkJcGFybS5zdG9yZSA9
IChjb3VudGVyLT5leHRbaV0ud3JpdGUpID8gY291bnRlcl9kZXZpY2VfZXh0X3N0b3JlIDogTlVM
TDsKPiA+IC0JCXBhcm0uY29tcG9uZW50ID0gZXh0X2NvbXA7Cj4gPiAtCQllcnIgPSBjb3VudGVy
X2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+ID4gLQkJaWYgKGVycikgewo+ID4gLQkJCWtmcmVl
KGV4dF9jb21wKTsKPiA+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiA+IC0JCX0KPiA+
IC0JfQo+ID4gLQo+ID4gLQlyZXR1cm4gMDsKPiA+IC0KPiA+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6
Cj4gPiAtCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsK
PiA+IC0JcmV0dXJuIGVycjsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIGludCBjb3VudGVyX2ds
b2JhbF9hdHRyX3JlZ2lzdGVyKAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91
cCAqY29uc3QgZ3JvdXAsCj4gPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRl
cikKPiA+IC17Cj4gPiAtCWludCBlcnI7Cj4gPiAtCj4gPiAtCS8qIENyZWF0ZSBuYW1lIGF0dHJp
YnV0ZSAqLwo+ID4gLQllcnIgPSBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0ZShncm91cCwg
Y291bnRlci0+bmFtZSk7Cj4gPiAtCWlmIChlcnIpCj4gPiAtCQlyZXR1cm4gZXJyOwo+ID4gLQo+
ID4gLQkvKiBDcmVhdGUgbnVtX2NvdW50cyBhdHRyaWJ1dGUgKi8KPiA+IC0JZXJyID0gY291bnRl
cl9zaXplX2F0dHJpYnV0ZV9jcmVhdGUoZ3JvdXAsIGNvdW50ZXItPm51bV9jb3VudHMsCj4gPiAt
CQkJCQkgICAgIm51bV9jb3VudHMiKTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCWdvdG8gZXJyX2Zy
ZWVfYXR0cl9saXN0Owo+ID4gLQo+ID4gLQkvKiBDcmVhdGUgbnVtX3NpZ25hbHMgYXR0cmlidXRl
ICovCj4gPiAtCWVyciA9IGNvdW50ZXJfc2l6ZV9hdHRyaWJ1dGVfY3JlYXRlKGdyb3VwLCBjb3Vu
dGVyLT5udW1fc2lnbmFscywKPiA+IC0JCQkJCSAgICAibnVtX3NpZ25hbHMiKTsKPiA+IC0JaWYg
KGVycikKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+ID4gLQo+ID4gLQkvKiBSZWdp
c3RlciBDb3VudGVyIGRldmljZSBleHRlbnNpb24gYXR0cmlidXRlcyAqLwo+ID4gLQllcnIgPSBj
b3VudGVyX2RldmljZV9leHRfcmVnaXN0ZXIoZ3JvdXAsIGNvdW50ZXIpOwo+ID4gLQlpZiAoZXJy
KQo+ID4gLQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4gPiAtCj4gPiAtCXJldHVybiAwOwo+
ID4gLQo+ID4gLWVycl9mcmVlX2F0dHJfbGlzdDoKPiA+IC0JY291bnRlcl9kZXZpY2VfYXR0cl9s
aXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwo+ID4gLQlyZXR1cm4gZXJyOwo+ID4gLX0KPiA+
IC0KPiA+IC1zdGF0aWMgdm9pZCBjb3VudGVyX2RldmljZV9ncm91cHNfbGlzdF9mcmVlKAo+ID4g
LQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXBzX2xpc3QsCj4g
PiAtCWNvbnN0IHNpemVfdCBudW1fZ3JvdXBzKQo+ID4gLXsKPiA+IC0Jc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2F0dHJfZ3JvdXAgKmdyb3VwOwo+ID4gLQlzaXplX3QgaTsKPiA+IC0KPiA+IC0JLyog
bG9vcCB0aHJvdWdoIGFsbCBhdHRyaWJ1dGUgZ3JvdXBzIChzaWduYWxzLCBjb3VudHMsIGdsb2Jh
bCwgZXRjLikgKi8KPiA+IC0JZm9yIChpID0gMDsgaSA8IG51bV9ncm91cHM7IGkrKykgewo+ID4g
LQkJZ3JvdXAgPSBncm91cHNfbGlzdCArIGk7Cj4gPiAtCj4gPiAtCQkvKiBmcmVlIGFsbCBhdHRy
aWJ1dGUgZ3JvdXAgYW5kIGFzc29jaWF0ZWQgYXR0cmlidXRlcyBtZW1vcnkgKi8KPiA+IC0JCWtm
cmVlKGdyb3VwLT5hdHRyX2dyb3VwLm5hbWUpOwo+ID4gLQkJa2ZyZWUoZ3JvdXAtPmF0dHJfZ3Jv
dXAuYXR0cnMpOwo+ID4gLQkJY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5h
dHRyX2xpc3QpOwo+ID4gLQl9Cj4gPiAtCj4gPiAtCWtmcmVlKGdyb3Vwc19saXN0KTsKPiA+IC19
Cj4gPiAtCj4gPiAtc3RhdGljIGludCBjb3VudGVyX2RldmljZV9ncm91cHNfbGlzdF9wcmVwYXJl
KAo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gPiAtewo+ID4g
LQljb25zdCBzaXplX3QgdG90YWxfbnVtX2dyb3VwcyA9Cj4gPiAtCQljb3VudGVyLT5udW1fc2ln
bmFscyArIGNvdW50ZXItPm51bV9jb3VudHMgKyAxOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZp
Y2VfYXR0cl9ncm91cCAqZ3JvdXBzX2xpc3Q7Cj4gPiAtCXNpemVfdCBpOwo+ID4gLQlpbnQgZXJy
Owo+ID4gLQlzaXplX3QgbnVtX2dyb3VwcyA9IDA7Cj4gPiAtCj4gPiAtCS8qIEFsbG9jYXRlIHNw
YWNlIGZvciBhdHRyaWJ1dGUgZ3JvdXBzIChzaWduYWxzLCBjb3VudHMsIGFuZCBleHQpICovCj4g
PiAtCWdyb3Vwc19saXN0ID0ga2NhbGxvYyh0b3RhbF9udW1fZ3JvdXBzLCBzaXplb2YoKmdyb3Vw
c19saXN0KSwKPiA+IC0JCQkgICAgICBHRlBfS0VSTkVMKTsKPiA+IC0JaWYgKCFncm91cHNfbGlz
dCkKPiA+IC0JCXJldHVybiAtRU5PTUVNOwo+ID4gLQo+ID4gLQkvKiBJbml0aWFsaXplIGF0dHJp
YnV0ZSBsaXN0cyAqLwo+ID4gLQlmb3IgKGkgPSAwOyBpIDwgdG90YWxfbnVtX2dyb3VwczsgaSsr
KQo+ID4gLQkJSU5JVF9MSVNUX0hFQUQoJmdyb3Vwc19saXN0W2ldLmF0dHJfbGlzdCk7Cj4gPiAt
Cj4gPiAtCS8qIFJlZ2lzdGVyIFNpZ25hbHMgKi8KPiA+IC0JZXJyID0gY291bnRlcl9zaWduYWxz
X3JlZ2lzdGVyKGdyb3Vwc19saXN0LCBjb3VudGVyKTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCWdv
dG8gZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q7Cj4gPiAtCW51bV9ncm91cHMgKz0gY291bnRlci0+bnVt
X3NpZ25hbHM7Cj4gPiAtCj4gPiAtCS8qIFJlZ2lzdGVyIENvdW50cyBhbmQgcmVzcGVjdGl2ZSBT
eW5hcHNlcyAqLwo+ID4gLQllcnIgPSBjb3VudGVyX2NvdW50c19yZWdpc3Rlcihncm91cHNfbGlz
dCArIG51bV9ncm91cHMsIGNvdW50ZXIpOwo+ID4gLQlpZiAoZXJyKQo+ID4gLQkJZ290byBlcnJf
ZnJlZV9ncm91cHNfbGlzdDsKPiA+IC0JbnVtX2dyb3VwcyArPSBjb3VudGVyLT5udW1fY291bnRz
Owo+ID4gLQo+ID4gLQkvKiBSZWdpc3RlciBDb3VudGVyIGdsb2JhbCBhdHRyaWJ1dGVzICovCj4g
PiAtCWVyciA9IGNvdW50ZXJfZ2xvYmFsX2F0dHJfcmVnaXN0ZXIoZ3JvdXBzX2xpc3QgKyBudW1f
Z3JvdXBzLCBjb3VudGVyKTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfZ3Jv
dXBzX2xpc3Q7Cj4gPiAtCW51bV9ncm91cHMrKzsKPiA+IC0KPiA+IC0JLyogU3RvcmUgZ3JvdXBz
X2xpc3QgaW4gZGV2aWNlX3N0YXRlICovCj4gPiAtCWNvdW50ZXItPmRldmljZV9zdGF0ZS0+Z3Jv
dXBzX2xpc3QgPSBncm91cHNfbGlzdDsKPiA+IC0JY291bnRlci0+ZGV2aWNlX3N0YXRlLT5udW1f
Z3JvdXBzID0gbnVtX2dyb3VwczsKPiA+IC0KPiA+IC0JcmV0dXJuIDA7Cj4gPiAtCj4gPiAtZXJy
X2ZyZWVfZ3JvdXBzX2xpc3Q6Cj4gPiAtCWNvdW50ZXJfZGV2aWNlX2dyb3Vwc19saXN0X2ZyZWUo
Z3JvdXBzX2xpc3QsIG51bV9ncm91cHMpOwo+ID4gLQlyZXR1cm4gZXJyOwo+ID4gLX0KPiA+IC0K
PiA+IC1zdGF0aWMgaW50IGNvdW50ZXJfZGV2aWNlX2dyb3Vwc19wcmVwYXJlKAo+ID4gLQlzdHJ1
Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgKmNvbnN0IGRldmljZV9zdGF0ZSkKPiA+IC17Cj4gPiAt
CXNpemVfdCBpLCBqOwo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqZ3Jv
dXA7Cj4gPiAtCWludCBlcnI7Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpwOwo+
ID4gLQo+ID4gLQkvKiBBbGxvY2F0ZSBhdHRyaWJ1dGUgZ3JvdXBzIGZvciBhc3NvY2lhdGlvbiB3
aXRoIGRldmljZSAqLwo+ID4gLQlkZXZpY2Vfc3RhdGUtPmdyb3VwcyA9IGtjYWxsb2MoZGV2aWNl
X3N0YXRlLT5udW1fZ3JvdXBzICsgMSwKPiA+IC0JCQkJICAgICAgIHNpemVvZigqZGV2aWNlX3N0
YXRlLT5ncm91cHMpLAo+ID4gLQkJCQkgICAgICAgR0ZQX0tFUk5FTCk7Cj4gPiAtCWlmICghZGV2
aWNlX3N0YXRlLT5ncm91cHMpCj4gPiAtCQlyZXR1cm4gLUVOT01FTTsKPiA+IC0KPiA+IC0JLyog
UHJlcGFyZSBlYWNoIGdyb3VwIG9mIGF0dHJpYnV0ZXMgZm9yIGFzc29jaWF0aW9uICovCj4gPiAt
CWZvciAoaSA9IDA7IGkgPCBkZXZpY2Vfc3RhdGUtPm51bV9ncm91cHM7IGkrKykgewo+ID4gLQkJ
Z3JvdXAgPSBkZXZpY2Vfc3RhdGUtPmdyb3Vwc19saXN0ICsgaTsKPiA+IC0KPiA+IC0JCS8qIEFs
bG9jYXRlIHNwYWNlIGZvciBhdHRyaWJ1dGUgcG9pbnRlcnMgaW4gYXR0cmlidXRlIGdyb3VwICov
Cj4gPiAtCQlncm91cC0+YXR0cl9ncm91cC5hdHRycyA9IGtjYWxsb2MoZ3JvdXAtPm51bV9hdHRy
ICsgMSwKPiA+IC0JCQlzaXplb2YoKmdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzKSwgR0ZQX0tFUk5F
TCk7Cj4gPiAtCQlpZiAoIWdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzKSB7Cj4gPiAtCQkJZXJyID0g
LUVOT01FTTsKPiA+IC0JCQlnb3RvIGVycl9mcmVlX2dyb3VwczsKPiA+IC0JCX0KPiA+IC0KPiA+
IC0JCS8qIEFkZCBhdHRyaWJ1dGUgcG9pbnRlcnMgdG8gYXR0cmlidXRlIGdyb3VwICovCj4gPiAt
CQlqID0gMDsKPiA+IC0JCWxpc3RfZm9yX2VhY2hfZW50cnkocCwgJmdyb3VwLT5hdHRyX2xpc3Qs
IGwpCj4gPiAtCQkJZ3JvdXAtPmF0dHJfZ3JvdXAuYXR0cnNbaisrXSA9ICZwLT5kZXZfYXR0ci5h
dHRyOwo+ID4gLQo+ID4gLQkJLyogR3JvdXAgYXR0cmlidXRlcyBpbiBhdHRyaWJ1dGUgZ3JvdXAg
Ki8KPiA+IC0JCWRldmljZV9zdGF0ZS0+Z3JvdXBzW2ldID0gJmdyb3VwLT5hdHRyX2dyb3VwOwo+
ID4gLQl9Cj4gPiAtCS8qIEFzc29jaWF0ZSBhdHRyaWJ1dGVzIHdpdGggZGV2aWNlICovCj4gPiAt
CWRldmljZV9zdGF0ZS0+ZGV2Lmdyb3VwcyA9IGRldmljZV9zdGF0ZS0+Z3JvdXBzOwo+ID4gLQo+
ID4gLQlyZXR1cm4gMDsKPiA+IC0KPiA+IC1lcnJfZnJlZV9ncm91cHM6Cj4gPiAtCWRvIHsKPiA+
IC0JCWdyb3VwID0gZGV2aWNlX3N0YXRlLT5ncm91cHNfbGlzdCArIGk7Cj4gPiAtCQlrZnJlZShn
cm91cC0+YXR0cl9ncm91cC5hdHRycyk7Cj4gPiAtCQlncm91cC0+YXR0cl9ncm91cC5hdHRycyA9
IE5VTEw7Cj4gPiAtCX0gd2hpbGUgKGktLSk7Cj4gPiAtCWtmcmVlKGRldmljZV9zdGF0ZS0+Z3Jv
dXBzKTsKPiA+IC0JcmV0dXJuIGVycjsKPiA+IC19Cj4gPiAtCj4gPiAtLyogUHJvdmlkZXMgYSB1
bmlxdWUgSUQgZm9yIGVhY2ggY291bnRlciBkZXZpY2UgKi8KPiA+IC1zdGF0aWMgREVGSU5FX0lE
QShjb3VudGVyX2lkYSk7Cj4gPiAtCj4gPiAtc3RhdGljIHZvaWQgY291bnRlcl9kZXZpY2VfcmVs
ZWFzZShzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gPiAtewo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiA+IC0Jc3RydWN0IGNv
dW50ZXJfZGV2aWNlX3N0YXRlICpjb25zdCBkZXZpY2Vfc3RhdGUgPSBjb3VudGVyLT5kZXZpY2Vf
c3RhdGU7Cj4gPiAtCj4gPiAtCWtmcmVlKGRldmljZV9zdGF0ZS0+Z3JvdXBzKTsKPiA+IC0JY291
bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3RfZnJlZShkZXZpY2Vfc3RhdGUtPmdyb3Vwc19saXN0LAo+
ID4gLQkJCQkJZGV2aWNlX3N0YXRlLT5udW1fZ3JvdXBzKTsKPiA+IC0JaWRhX3NpbXBsZV9yZW1v
dmUoJmNvdW50ZXJfaWRhLCBkZXZpY2Vfc3RhdGUtPmlkKTsKPiA+IC0Ja2ZyZWUoZGV2aWNlX3N0
YXRlKTsKPiA+IC19Cj4gPiAtCj4gPiAtc3RhdGljIHN0cnVjdCBkZXZpY2VfdHlwZSBjb3VudGVy
X2RldmljZV90eXBlID0gewo+ID4gLQkubmFtZSA9ICJjb3VudGVyX2RldmljZSIsCj4gPiAtCS5y
ZWxlYXNlID0gY291bnRlcl9kZXZpY2VfcmVsZWFzZQo+ID4gLX07Cj4gPiAtCj4gPiAtc3RhdGlj
IHN0cnVjdCBidXNfdHlwZSBjb3VudGVyX2J1c190eXBlID0gewo+ID4gLQkubmFtZSA9ICJjb3Vu
dGVyIgo+ID4gLX07Cj4gPiAtCj4gPiAtLyoqCj4gPiAtICogY291bnRlcl9yZWdpc3RlciAtIHJl
Z2lzdGVyIENvdW50ZXIgdG8gdGhlIHN5c3RlbQo+ID4gLSAqIEBjb3VudGVyOglwb2ludGVyIHRv
IENvdW50ZXIgdG8gcmVnaXN0ZXIKPiA+IC0gKgo+ID4gLSAqIFRoaXMgZnVuY3Rpb24gcmVnaXN0
ZXJzIGEgQ291bnRlciB0byB0aGUgc3lzdGVtLiBBIHN5c2ZzICJjb3VudGVyIiBkaXJlY3RvcnkK
PiA+IC0gKiB3aWxsIGJlIGNyZWF0ZWQgYW5kIHBvcHVsYXRlZCB3aXRoIHN5c2ZzIGF0dHJpYnV0
ZXMgY29ycmVsYXRpbmcgd2l0aCB0aGUKPiA+IC0gKiBDb3VudGVyIFNpZ25hbHMsIFN5bmFwc2Vz
LCBhbmQgQ291bnRzIHJlc3BlY3RpdmVseS4KPiA+IC0gKi8KPiA+IC1pbnQgY291bnRlcl9yZWdp
c3RlcihzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gPiAtewo+ID4gLQlz
dHJ1Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgKmRldmljZV9zdGF0ZTsKPiA+IC0JaW50IGVycjsK
PiA+IC0KPiA+IC0JLyogQWxsb2NhdGUgaW50ZXJuYWwgc3RhdGUgY29udGFpbmVyIGZvciBDb3Vu
dGVyIGRldmljZSAqLwo+ID4gLQlkZXZpY2Vfc3RhdGUgPSBremFsbG9jKHNpemVvZigqZGV2aWNl
X3N0YXRlKSwgR0ZQX0tFUk5FTCk7Cj4gPiAtCWlmICghZGV2aWNlX3N0YXRlKQo+ID4gLQkJcmV0
dXJuIC1FTk9NRU07Cj4gPiAtCWNvdW50ZXItPmRldmljZV9zdGF0ZSA9IGRldmljZV9zdGF0ZTsK
PiA+IC0KPiA+IC0JLyogQWNxdWlyZSB1bmlxdWUgSUQgKi8KPiA+IC0JZGV2aWNlX3N0YXRlLT5p
ZCA9IGlkYV9zaW1wbGVfZ2V0KCZjb3VudGVyX2lkYSwgMCwgMCwgR0ZQX0tFUk5FTCk7Cj4gPiAt
CWlmIChkZXZpY2Vfc3RhdGUtPmlkIDwgMCkgewo+ID4gLQkJZXJyID0gZGV2aWNlX3N0YXRlLT5p
ZDsKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfZGV2aWNlX3N0YXRlOwo+ID4gLQl9Cj4gPiAtCj4gPiAt
CS8qIENvbmZpZ3VyZSBkZXZpY2Ugc3RydWN0dXJlIGZvciBDb3VudGVyICovCj4gPiAtCWRldmlj
ZV9zdGF0ZS0+ZGV2LnR5cGUgPSAmY291bnRlcl9kZXZpY2VfdHlwZTsKPiA+IC0JZGV2aWNlX3N0
YXRlLT5kZXYuYnVzID0gJmNvdW50ZXJfYnVzX3R5cGU7Cj4gPiAtCWlmIChjb3VudGVyLT5wYXJl
bnQpIHsKPiA+IC0JCWRldmljZV9zdGF0ZS0+ZGV2LnBhcmVudCA9IGNvdW50ZXItPnBhcmVudDsK
PiA+IC0JCWRldmljZV9zdGF0ZS0+ZGV2Lm9mX25vZGUgPSBjb3VudGVyLT5wYXJlbnQtPm9mX25v
ZGU7Cj4gPiAtCX0KPiA+IC0JZGV2X3NldF9uYW1lKCZkZXZpY2Vfc3RhdGUtPmRldiwgImNvdW50
ZXIlZCIsIGRldmljZV9zdGF0ZS0+aWQpOwo+ID4gLQlkZXZpY2VfaW5pdGlhbGl6ZSgmZGV2aWNl
X3N0YXRlLT5kZXYpOwo+ID4gLQlkZXZfc2V0X2RydmRhdGEoJmRldmljZV9zdGF0ZS0+ZGV2LCBj
b3VudGVyKTsKPiA+IC0KPiA+IC0JLyogUHJlcGFyZSBkZXZpY2UgYXR0cmlidXRlcyAqLwo+ID4g
LQllcnIgPSBjb3VudGVyX2RldmljZV9ncm91cHNfbGlzdF9wcmVwYXJlKGNvdW50ZXIpOwo+ID4g
LQlpZiAoZXJyKQo+ID4gLQkJZ290byBlcnJfZnJlZV9pZDsKPiA+IC0KPiA+IC0JLyogT3JnYW5p
emUgZGV2aWNlIGF0dHJpYnV0ZXMgdG8gZ3JvdXBzIGFuZCBtYXRjaCB0byBkZXZpY2UgKi8KPiA+
IC0JZXJyID0gY291bnRlcl9kZXZpY2VfZ3JvdXBzX3ByZXBhcmUoZGV2aWNlX3N0YXRlKTsKPiA+
IC0JaWYgKGVycikKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q7Cj4gPiAtCj4gPiAt
CS8qIEFkZCBkZXZpY2UgdG8gc3lzdGVtICovCj4gPiAtCWVyciA9IGRldmljZV9hZGQoJmRldmlj
ZV9zdGF0ZS0+ZGV2KTsKPiA+IC0JaWYgKGVycikKPiA+IC0JCWdvdG8gZXJyX2ZyZWVfZ3JvdXBz
Owo+ID4gLQo+ID4gLQlyZXR1cm4gMDsKPiA+IC0KPiA+IC1lcnJfZnJlZV9ncm91cHM6Cj4gPiAt
CWtmcmVlKGRldmljZV9zdGF0ZS0+Z3JvdXBzKTsKPiA+IC1lcnJfZnJlZV9ncm91cHNfbGlzdDoK
PiA+IC0JY291bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3RfZnJlZShkZXZpY2Vfc3RhdGUtPmdyb3Vw
c19saXN0LAo+ID4gLQkJCQkJZGV2aWNlX3N0YXRlLT5udW1fZ3JvdXBzKTsKPiA+IC1lcnJfZnJl
ZV9pZDoKPiA+IC0JaWRhX3NpbXBsZV9yZW1vdmUoJmNvdW50ZXJfaWRhLCBkZXZpY2Vfc3RhdGUt
PmlkKTsKPiA+IC1lcnJfZnJlZV9kZXZpY2Vfc3RhdGU6Cj4gPiAtCWtmcmVlKGRldmljZV9zdGF0
ZSk7Cj4gPiAtCXJldHVybiBlcnI7Cj4gPiAtfQo+ID4gLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50
ZXJfcmVnaXN0ZXIpOwo+ID4gLQo+ID4gLS8qKgo+ID4gLSAqIGNvdW50ZXJfdW5yZWdpc3RlciAt
IHVucmVnaXN0ZXIgQ291bnRlciBmcm9tIHRoZSBzeXN0ZW0KPiA+IC0gKiBAY291bnRlcjoJcG9p
bnRlciB0byBDb3VudGVyIHRvIHVucmVnaXN0ZXIKPiA+IC0gKgo+ID4gLSAqIFRoZSBDb3VudGVy
IGlzIHVucmVnaXN0ZXJlZCBmcm9tIHRoZSBzeXN0ZW07IGFsbCBhbGxvY2F0ZWQgbWVtb3J5IGlz
IGZyZWVkLgo+ID4gLSAqLwo+ID4gLXZvaWQgY291bnRlcl91bnJlZ2lzdGVyKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiA+IC17Cj4gPiAtCWlmIChjb3VudGVyKQo+ID4g
LQkJZGV2aWNlX2RlbCgmY291bnRlci0+ZGV2aWNlX3N0YXRlLT5kZXYpOwo+ID4gLX0KPiA+IC1F
WFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3VucmVnaXN0ZXIpOwo+ID4gLQo+ID4gLXN0YXRpYyB2
b2lkIGRldm1fY291bnRlcl91bnJlZyhzdHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKnJlcykKPiA+
IC17Cj4gPiAtCWNvdW50ZXJfdW5yZWdpc3RlcigqKHN0cnVjdCBjb3VudGVyX2RldmljZSAqKily
ZXMpOwo+ID4gLX0KPiA+IC0KPiA+IC0vKioKPiA+IC0gKiBkZXZtX2NvdW50ZXJfcmVnaXN0ZXIg
LSBSZXNvdXJjZS1tYW5hZ2VkIGNvdW50ZXJfcmVnaXN0ZXIKPiA+IC0gKiBAZGV2OglkZXZpY2Ug
dG8gYWxsb2NhdGUgY291bnRlcl9kZXZpY2UgZm9yCj4gPiAtICogQGNvdW50ZXI6CXBvaW50ZXIg
dG8gQ291bnRlciB0byByZWdpc3Rlcgo+ID4gLSAqCj4gPiAtICogTWFuYWdlZCBjb3VudGVyX3Jl
Z2lzdGVyLiBUaGUgQ291bnRlciByZWdpc3RlcmVkIHdpdGggdGhpcyBmdW5jdGlvbiBpcwo+ID4g
LSAqIGF1dG9tYXRpY2FsbHkgdW5yZWdpc3RlcmVkIG9uIGRyaXZlciBkZXRhY2guIFRoaXMgZnVu
Y3Rpb24gY2FsbHMKPiA+IC0gKiBjb3VudGVyX3JlZ2lzdGVyIGludGVybmFsbHkuIFJlZmVyIHRv
IHRoYXQgZnVuY3Rpb24gZm9yIG1vcmUgaW5mb3JtYXRpb24uCj4gPiAtICoKPiA+IC0gKiBJZiBh
biBDb3VudGVyIHJlZ2lzdGVyZWQgd2l0aCB0aGlzIGZ1bmN0aW9uIG5lZWRzIHRvIGJlIHVucmVn
aXN0ZXJlZAo+ID4gLSAqIHNlcGFyYXRlbHksIGRldm1fY291bnRlcl91bnJlZ2lzdGVyIG11c3Qg
YmUgdXNlZC4KPiA+IC0gKgo+ID4gLSAqIFJFVFVSTlM6Cj4gPiAtICogMCBvbiBzdWNjZXNzLCBu
ZWdhdGl2ZSBlcnJvciBudW1iZXIgb24gZmFpbHVyZS4KPiA+IC0gKi8KPiA+IC1pbnQgZGV2bV9j
b3VudGVyX3JlZ2lzdGVyKHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+IC0JCQkgIHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiA+IC17Cj4gPiAtCXN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqKnB0cjsKPiA+IC0JaW50IHJldDsKPiA+IC0KPiA+IC0JcHRyID0gZGV2cmVzX2FsbG9j
KGRldm1fY291bnRlcl91bnJlZywgc2l6ZW9mKCpwdHIpLCBHRlBfS0VSTkVMKTsKPiA+IC0JaWYg
KCFwdHIpCj4gPiAtCQlyZXR1cm4gLUVOT01FTTsKPiA+IC0KPiA+IC0JcmV0ID0gY291bnRlcl9y
ZWdpc3Rlcihjb3VudGVyKTsKPiA+IC0JaWYgKCFyZXQpIHsKPiA+IC0JCSpwdHIgPSBjb3VudGVy
Owo+ID4gLQkJZGV2cmVzX2FkZChkZXYsIHB0cik7Cj4gPiAtCX0gZWxzZSB7Cj4gPiAtCQlkZXZy
ZXNfZnJlZShwdHIpOwo+ID4gLQl9Cj4gPiAtCj4gPiAtCXJldHVybiByZXQ7Cj4gPiAtfQo+ID4g
LUVYUE9SVF9TWU1CT0xfR1BMKGRldm1fY291bnRlcl9yZWdpc3Rlcik7Cj4gPiAtCj4gPiAtc3Rh
dGljIGludCBkZXZtX2NvdW50ZXJfbWF0Y2goc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICpyZXMs
IHZvaWQgKmRhdGEpCj4gPiAtewo+ID4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKipyID0gcmVz
Owo+ID4gLQo+ID4gLQlpZiAoIXIgfHwgISpyKSB7Cj4gPiAtCQlXQVJOX09OKCFyIHx8ICEqcik7
Cj4gPiAtCQlyZXR1cm4gMDsKPiA+IC0JfQo+ID4gLQo+ID4gLQlyZXR1cm4gKnIgPT0gZGF0YTsK
PiA+IC19Cj4gPiAtCj4gPiAtLyoqCj4gPiAtICogZGV2bV9jb3VudGVyX3VucmVnaXN0ZXIgLSBS
ZXNvdXJjZS1tYW5hZ2VkIGNvdW50ZXJfdW5yZWdpc3Rlcgo+ID4gLSAqIEBkZXY6CWRldmljZSB0
aGlzIGNvdW50ZXJfZGV2aWNlIGJlbG9uZ3MgdG8KPiA+IC0gKiBAY291bnRlcjoJcG9pbnRlciB0
byBDb3VudGVyIGFzc29jaWF0ZWQgd2l0aCB0aGUgZGV2aWNlCj4gPiAtICoKPiA+IC0gKiBVbnJl
Z2lzdGVyIENvdW50ZXIgcmVnaXN0ZXJlZCB3aXRoIGRldm1fY291bnRlcl9yZWdpc3Rlci4KPiA+
IC0gKi8KPiA+IC12b2lkIGRldm1fY291bnRlcl91bnJlZ2lzdGVyKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiA+IC0JCQkgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiA+
IC17Cj4gPiAtCWludCByYzsKPiA+IC0KPiA+IC0JcmMgPSBkZXZyZXNfcmVsZWFzZShkZXYsIGRl
dm1fY291bnRlcl91bnJlZywgZGV2bV9jb3VudGVyX21hdGNoLAo+ID4gLQkJCSAgICBjb3VudGVy
KTsKPiA+IC0JV0FSTl9PTihyYyk7Cj4gPiAtfQo+ID4gLUVYUE9SVF9TWU1CT0xfR1BMKGRldm1f
Y291bnRlcl91bnJlZ2lzdGVyKTsKPiA+IC0KPiA+IC1zdGF0aWMgaW50IF9faW5pdCBjb3VudGVy
X2luaXQodm9pZCkKPiA+IC17Cj4gPiAtCXJldHVybiBidXNfcmVnaXN0ZXIoJmNvdW50ZXJfYnVz
X3R5cGUpOwo+ID4gLX0KPiA+IC0KPiA+IC1zdGF0aWMgdm9pZCBfX2V4aXQgY291bnRlcl9leGl0
KHZvaWQpCj4gPiAtewo+ID4gLQlidXNfdW5yZWdpc3RlcigmY291bnRlcl9idXNfdHlwZSk7Cj4g
PiAtfQo+ID4gLQo+ID4gLXN1YnN5c19pbml0Y2FsbChjb3VudGVyX2luaXQpOwo+ID4gLW1vZHVs
ZV9leGl0KGNvdW50ZXJfZXhpdCk7Cj4gPiAtCj4gPiAtTU9EVUxFX0FVVEhPUigiV2lsbGlhbSBC
cmVhdGhpdHQgR3JheSA8dmlsaGVsbS5ncmF5QGdtYWlsLmNvbT4iKTsKPiA+IC1NT0RVTEVfREVT
Q1JJUFRJT04oIkdlbmVyaWMgQ291bnRlciBpbnRlcmZhY2UiKTsKPiA+IC1NT0RVTEVfTElDRU5T
RSgiR1BMIHYyIik7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL2Z0bS1xdWFkZGVj
LmMgYi9kcml2ZXJzL2NvdW50ZXIvZnRtLXF1YWRkZWMuYwo+ID4gaW5kZXggNTNjMTVmODQ5MDli
Li41ZWYwNDc4NzA5Y2QgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvZnRtLXF1YWRk
ZWMuYwo+ID4gKysrIGIvZHJpdmVycy9jb3VudGVyL2Z0bS1xdWFkZGVjLmMKPiA+IEBAIC0xNCw2
ICsxNCw3IEBACj4gPiAgI2luY2x1ZGUgPGxpbnV4L211dGV4Lmg+Cj4gPiAgI2luY2x1ZGUgPGxp
bnV4L2NvdW50ZXIuaD4KPiA+ICAjaW5jbHVkZSA8bGludXgvYml0ZmllbGQuaD4KPiA+ICsjaW5j
bHVkZSA8bGludXgvdHlwZXMuaD4KPiA+ICAKPiA+ICAjZGVmaW5lIEZUTV9GSUVMRF9VUERBVEUo
ZnRtLCBvZmZzZXQsIG1hc2ssIHZhbCkJCQlcCj4gPiAgCSh7CQkJCQkJCQlcCj4gPiBAQCAtMTE1
LDggKzExNiw3IEBAIHN0YXRpYyB2b2lkIGZ0bV9xdWFkZGVjX2Rpc2FibGUodm9pZCAqZnRtKQo+
ID4gIH0KPiA+ICAKPiA+ICBzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2dldF9wcmVzY2FsZXIoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiA+IC0JCQkJICAgICBzaXplX3QgKmNudF9tb2RlKQo+ID4gKwkJCQkg
ICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyICpjbnRfbW9kZSkKPiA+ICB7Cj4g
PiAgCXN0cnVjdCBmdG1fcXVhZGRlYyAqZnRtID0gY291bnRlci0+cHJpdjsKPiA+ICAJdWludDMy
X3Qgc2NmbGFnczsKPiA+IEBAIC0xMjksOCArMTI5LDcgQEAgc3RhdGljIGludCBmdG1fcXVhZGRl
Y19nZXRfcHJlc2NhbGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICB9Cj4g
PiAgCj4gPiAgc3RhdGljIGludCBmdG1fcXVhZGRlY19zZXRfcHJlc2NhbGVyKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsCj4gPiAtCQkJCSAgICAgc2l6ZV90IGNudF9tb2RlKQo+ID4gKwkJCQkgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyIGNudF9tb2RlKQo+ID4gIHsKPiA+ICAJc3RydWN0
IGZ0bV9xdWFkZGVjICpmdG0gPSBjb3VudGVyLT5wcml2Owo+ID4gIAo+ID4gQEAgLTE1MSwzMyAr
MTUwLDE3IEBAIHN0YXRpYyBjb25zdCBjaGFyICogY29uc3QgZnRtX3F1YWRkZWNfcHJlc2NhbGVy
W10gPSB7Cj4gPiAgCSIxIiwgIjIiLCAiNCIsICI4IiwgIjE2IiwgIjMyIiwgIjY0IiwgIjEyOCIK
PiA+ICB9Owo+ID4gIAo+ID4gLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4dCBm
dG1fcXVhZGRlY19wcmVzY2FsZXJfZW51bSA9IHsKPiA+IC0JLml0ZW1zID0gZnRtX3F1YWRkZWNf
cHJlc2NhbGVyLAo+ID4gLQkubnVtX2l0ZW1zID0gQVJSQVlfU0laRShmdG1fcXVhZGRlY19wcmVz
Y2FsZXIpLAo+ID4gLQkuZ2V0ID0gZnRtX3F1YWRkZWNfZ2V0X3ByZXNjYWxlciwKPiA+IC0JLnNl
dCA9IGZ0bV9xdWFkZGVjX3NldF9wcmVzY2FsZXIKPiA+IC19Owo+ID4gLQo+ID4gLWVudW0gZnRt
X3F1YWRkZWNfc3luYXBzZV9hY3Rpb24gewo+ID4gLQlGVE1fUVVBRERFQ19TWU5BUFNFX0FDVElP
Tl9CT1RIX0VER0VTLAo+ID4gLX07Cj4gPiAtCj4gPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRl
cl9zeW5hcHNlX2FjdGlvbiBmdG1fcXVhZGRlY19zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiA+IC0J
W0ZUTV9RVUFEREVDX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVNdID0KPiA+ICAJQ09VTlRFUl9T
WU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gPiAgfTsKPiA+ICAKPiA+IC1lbnVtIGZ0bV9xdWFk
ZGVjX2NvdW50X2Z1bmN0aW9uIHsKPiA+IC0JRlRNX1FVQURERUNfQ09VTlRfRU5DT0RFUl9NT0RF
XzEsCj4gPiAtfTsKPiA+IC0KPiA+ICBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9u
IGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0aW9uc1tdID0gewo+ID4gLQlbRlRNX1FVQURERUNfQ09V
TlRfRU5DT0RFUl9NT0RFXzFdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Cj4gPiAr
CUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNAo+ID4gIH07Cj4gPiAgCj4gPiAgc3RhdGlj
IGludCBmdG1fcXVhZGRlY19jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiA+ICAJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCSAgdW5z
aWduZWQgbG9uZyAqdmFsKQo+ID4gKwkJCQkgIHU2NCAqdmFsKQo+ID4gIHsKPiA+ICAJc3RydWN0
IGZ0bV9xdWFkZGVjICpjb25zdCBmdG0gPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1aW50MzJfdCBj
bnR2YWw7Cj4gPiBAQCAtMTkxLDcgKzE3NCw3IEBAIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfY291
bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCj4gPiAgc3RhdGlj
IGludCBmdG1fcXVhZGRlY19jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gPiAgCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJICAg
Y29uc3QgdW5zaWduZWQgbG9uZyB2YWwpCj4gPiArCQkJCSAgIGNvbnN0IHU2NCB2YWwpCj4gPiAg
ewo+ID4gIAlzdHJ1Y3QgZnRtX3F1YWRkZWMgKmNvbnN0IGZ0bSA9IGNvdW50ZXItPnByaXY7Cj4g
PiAgCj4gPiBAQCAtMjA1LDIxICsxODgsMjEgQEAgc3RhdGljIGludCBmdG1fcXVhZGRlY19jb3Vu
dF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCXJldHVybiAwOwo+
ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0aW9uX2dl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJCQkgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJCSAgc2l6ZV90ICpmdW5jdGlvbikKPiA+ICtzdGF0
aWMgaW50IGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ID4gKwkJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+
ID4gKwkJCQkJICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKPiA+ICB7Cj4gPiAt
CSpmdW5jdGlvbiA9IEZUTV9RVUFEREVDX0NPVU5UX0VOQ09ERVJfTU9ERV8xOwo+ID4gKwkqZnVu
Y3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ7Cj4gPiAgCj4gPiAgCXJldHVy
biAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2FjdGlvbl9nZXQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiA+IC0JCQkJICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNl
LAo+ID4gLQkJCQkgIHNpemVfdCAqYWN0aW9uKQo+ID4gK3N0YXRpYyBpbnQgZnRtX3F1YWRkZWNf
YWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkgICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJCSAgIHN0cnVjdCBjb3VudGVyX3N5
bmFwc2UgKnN5bmFwc2UsCj4gPiArCQkJCSAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAq
YWN0aW9uKQo+ID4gIHsKPiA+IC0JKmFjdGlvbiA9IEZUTV9RVUFEREVDX1NZTkFQU0VfQUNUSU9O
X0JPVEhfRURHRVM7Cj4gPiArCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhf
RURHRVM7Cj4gPiAgCj4gPiAgCXJldHVybiAwOwo+ID4gIH0KPiA+IEBAIC0yMjcsOCArMjEwLDgg
QEAgc3RhdGljIGludCBmdG1fcXVhZGRlY19hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiA+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIGZ0bV9xdWFk
ZGVjX2NudF9vcHMgPSB7Cj4gPiAgCS5jb3VudF9yZWFkID0gZnRtX3F1YWRkZWNfY291bnRfcmVh
ZCwKPiA+ICAJLmNvdW50X3dyaXRlID0gZnRtX3F1YWRkZWNfY291bnRfd3JpdGUsCj4gPiAtCS5m
dW5jdGlvbl9nZXQgPSBmdG1fcXVhZGRlY19jb3VudF9mdW5jdGlvbl9nZXQsCj4gPiAtCS5hY3Rp
b25fZ2V0ID0gZnRtX3F1YWRkZWNfYWN0aW9uX2dldCwKPiA+ICsJLmZ1bmN0aW9uX3JlYWQgPSBm
dG1fcXVhZGRlY19jb3VudF9mdW5jdGlvbl9yZWFkLAo+ID4gKwkuYWN0aW9uX3JlYWQgPSBmdG1f
cXVhZGRlY19hY3Rpb25fcmVhZCwKPiA+ICB9Owo+ID4gIAo+ID4gIHN0YXRpYyBzdHJ1Y3QgY291
bnRlcl9zaWduYWwgZnRtX3F1YWRkZWNfc2lnbmFsc1tdID0gewo+ID4gQEAgLTI1NSw5ICsyMzgs
MTIgQEAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgZnRtX3F1YWRkZWNfY291bnRfc3lu
YXBzZXNbXSA9IHsKPiA+ICAJfQo+ID4gIH07Cj4gPiAgCj4gPiAtc3RhdGljIGNvbnN0IHN0cnVj
dCBjb3VudGVyX2NvdW50X2V4dCBmdG1fcXVhZGRlY19jb3VudF9leHRbXSA9IHsKPiA+IC0JQ09V
TlRFUl9DT1VOVF9FTlVNKCJwcmVzY2FsZXIiLCAmZnRtX3F1YWRkZWNfcHJlc2NhbGVyX2VudW0p
LAo+ID4gLQlDT1VOVEVSX0NPVU5UX0VOVU1fQVZBSUxBQkxFKCJwcmVzY2FsZXIiLCAmZnRtX3F1
YWRkZWNfcHJlc2NhbGVyX2VudW0pLAo+ID4gK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9FTlVNKGZ0
bV9xdWFkZGVjX3ByZXNjYWxlcl9lbnVtLCBmdG1fcXVhZGRlY19wcmVzY2FsZXIpOwo+ID4gKwo+
ID4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21wIGZ0bV9xdWFkZGVjX2NvdW50X2V4dFtdID0g
ewo+ID4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfRU5VTSgicHJlc2NhbGVyIiwgZnRtX3F1YWRkZWNf
Z2V0X3ByZXNjYWxlciwKPiA+ICsJCQkJZnRtX3F1YWRkZWNfc2V0X3ByZXNjYWxlciwKPiA+ICsJ
CQkJZnRtX3F1YWRkZWNfcHJlc2NhbGVyX2VudW0pLAo+ID4gIH07Cj4gPiAgCj4gPiAgc3RhdGlj
IHN0cnVjdCBjb3VudGVyX2NvdW50IGZ0bV9xdWFkZGVjX2NvdW50cyA9IHsKPiA+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZWwt
cWVwLmMKPiA+IGluZGV4IDhhNjg0N2Q1ZmIyYi4uNjk2ZjY4YmM5M2JjIDEwMDY0NAo+ID4gLS0t
IGEvZHJpdmVycy9jb3VudGVyL2ludGVsLXFlcC5jCj4gPiArKysgYi9kcml2ZXJzL2NvdW50ZXIv
aW50ZWwtcWVwLmMKPiA+IEBAIC02MiwxMyArNjIsNiBAQAo+ID4gIAo+ID4gICNkZWZpbmUgSU5U
RUxfUUVQX0NMS19QRVJJT0RfTlMJCTEwCj4gPiAgCj4gPiAtI2RlZmluZSBJTlRFTF9RRVBfQ09V
TlRFUl9FWFRfUlcoX25hbWUpCQkJCVwKPiA+IC17CQkJCQkJCQlcCj4gPiAtCS5uYW1lID0gI19u
YW1lLAkJCQkJCVwKPiA+IC0JLnJlYWQgPSBfbmFtZSMjX3JlYWQsCQkJCQlcCj4gPiAtCS53cml0
ZSA9IF9uYW1lIyNfd3JpdGUsCQkJCQlcCj4gPiAtfQo+ID4gLQo+ID4gIHN0cnVjdCBpbnRlbF9x
ZXAgewo+ID4gIAlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgY291bnRlcjsKPiA+ICAJc3RydWN0IG11
dGV4IGxvY2s7Cj4gPiBAQCAtMTE0LDggKzEwNyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3FlcF9p
bml0KHN0cnVjdCBpbnRlbF9xZXAgKnFlcCkKPiA+ICB9Cj4gPiAgCj4gPiAgc3RhdGljIGludCBp
bnRlbF9xZXBfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAt
CQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJdW5zaWduZWQgbG9uZyAq
dmFsKQo+ID4gKwkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsKQo+ID4g
IHsKPiA+ICAJc3RydWN0IGludGVsX3FlcCAqY29uc3QgcWVwID0gY291bnRlci0+cHJpdjsKPiA+
ICAKPiA+IEBAIC0xMzAsMTEgKzEyMiwxMSBAQCBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1
bmN0aW9uIGludGVsX3FlcF9jb3VudF9mdW5jdGlvbnNbXSA9IHsKPiA+ICAJQ09VTlRFUl9GVU5D
VElPTl9RVUFEUkFUVVJFX1g0LAo+ID4gIH07Cj4gPiAgCj4gPiAtc3RhdGljIGludCBpbnRlbF9x
ZXBfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJ
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCSAgc2l6ZV90ICpmdW5jdGlv
bikKPiA+ICtzdGF0aWMgaW50IGludGVsX3FlcF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+ID4gKwkJCQkgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKQo+ID4gIHsKPiA+
IC0JKmZ1bmN0aW9uID0gMDsKPiA+ICsJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0Owo+ID4gIAo+ID4gIAlyZXR1cm4gMDsKPiA+ICB9Cj4gPiBAQCAtMTQzLDE5ICsx
MzUsMTkgQEAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBpbnRlbF9x
ZXBfc3luYXBzZV9hY3Rpb25zW10gPSB7Cj4gPiAgCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9U
SF9FREdFUywKPiA+ICB9Owo+ID4gIAo+ID4gLXN0YXRpYyBpbnQgaW50ZWxfcWVwX2FjdGlvbl9n
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQlzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCj4gPiAtCQkJCXN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2Us
Cj4gPiAtCQkJCXNpemVfdCAqYWN0aW9uKQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfcWVwX2FjdGlv
bl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5
bmFwc2UsCj4gPiArCQkJCSBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiA+
ICB7Cj4gPiAtCSphY3Rpb24gPSAwOwo+ID4gKwkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9CT1RIX0VER0VTOwo+ID4gIAlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAgc3RhdGlj
IGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyBpbnRlbF9xZXBfY291bnRlcl9vcHMgPSB7Cj4gPiAg
CS5jb3VudF9yZWFkID0gaW50ZWxfcWVwX2NvdW50X3JlYWQsCj4gPiAtCS5mdW5jdGlvbl9nZXQg
PSBpbnRlbF9xZXBfZnVuY3Rpb25fZ2V0LAo+ID4gLQkuYWN0aW9uX2dldCA9IGludGVsX3FlcF9h
Y3Rpb25fZ2V0LAo+ID4gKwkuZnVuY3Rpb25fcmVhZCA9IGludGVsX3FlcF9mdW5jdGlvbl9yZWFk
LAo+ID4gKwkuYWN0aW9uX3JlYWQgPSBpbnRlbF9xZXBfYWN0aW9uX3JlYWQsCj4gPiAgfTsKPiA+
ICAKPiA+ICAjZGVmaW5lIElOVEVMX1FFUF9TSUdOQUwoX2lkLCBfbmFtZSkgewkJCQlcCj4gPiBA
QCAtMTgxLDMxICsxNzMsMjcgQEAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgaW50ZWxf
cWVwX2NvdW50X3N5bmFwc2VzW10gPSB7Cj4gPiAgCUlOVEVMX1FFUF9TWU5BUFNFKDIpLAo+ID4g
IH07Cj4gPiAgCj4gPiAtc3RhdGljIHNzaXplX3QgY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiA+IC0JCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+ID4gLQkJCSAgICB2b2lkICpwcml2LCBjaGFyICpidWYpCj4gPiArc3RhdGljIGludCBpbnRl
bF9xZXBfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJ
CQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqY2VpbGluZykKPiA+ICB7Cj4g
PiAgCXN0cnVjdCBpbnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7Cj4gPiAtCXUzMiByZWc7
Cj4gPiAgCj4gPiAgCXBtX3J1bnRpbWVfZ2V0X3N5bmMocWVwLT5kZXYpOwo+ID4gLQlyZWcgPSBp
bnRlbF9xZXBfcmVhZGwocWVwLCBJTlRFTF9RRVBNQVgpOwo+ID4gKwkqY2VpbGluZyA9IGludGVs
X3FlcF9yZWFkbChxZXAsIElOVEVMX1FFUE1BWCk7Cj4gPiAgCXBtX3J1bnRpbWVfcHV0KHFlcC0+
ZGV2KTsKPiA+ICAKPiA+IC0JcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJXVcbiIsIHJlZyk7Cj4g
PiArCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBjZWlsaW5nX3dy
aXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkgICAgIHZvaWQgKnByaXYsIGNvbnN0IGNoYXIg
KmJ1Ziwgc2l6ZV90IGxlbikKPiA+ICtzdGF0aWMgaW50IGludGVsX3FlcF9jZWlsaW5nX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCB1NjQgbWF4KQo+ID4gIHsKPiA+ICAJc3RydWN0IGludGVsX3FlcCAq
cWVwID0gY291bnRlci0+cHJpdjsKPiA+IC0JdTMyIG1heDsKPiA+IC0JaW50IHJldDsKPiA+ICsJ
aW50IHJldCA9IDA7Cj4gPiAgCj4gPiAtCXJldCA9IGtzdHJ0b3UzMihidWYsIDAsICZtYXgpOwo+
ID4gLQlpZiAocmV0IDwgMCkKPiA+IC0JCXJldHVybiByZXQ7Cj4gPiArCS8qIEludGVsIFFFUCBj
ZWlsaW5nIGNvbmZpZ3VyYXRpb24gb25seSBzdXBwb3J0cyAzMi1iaXQgdmFsdWVzICovCj4gPiAr
CWlmIChtYXggIT0gKHUzMiltYXgpCj4gPiArCQlyZXR1cm4gLUVSQU5HRTsKPiA+ICAKPiA+ICAJ
bXV0ZXhfbG9jaygmcWVwLT5sb2NrKTsKPiA+ICAJaWYgKHFlcC0+ZW5hYmxlZCkgewo+ID4gQEAg
LTIxNiwzNCArMjA0LDI4IEBAIHN0YXRpYyBzc2l6ZV90IGNlaWxpbmdfd3JpdGUoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAlwbV9ydW50aW1lX2dldF9zeW5jKHFlcC0+ZGV2
KTsKPiA+ICAJaW50ZWxfcWVwX3dyaXRlbChxZXAsIElOVEVMX1FFUE1BWCwgbWF4KTsKPiA+ICAJ
cG1fcnVudGltZV9wdXQocWVwLT5kZXYpOwo+ID4gLQlyZXQgPSBsZW47Cj4gPiAgCj4gPiAgb3V0
Ogo+ID4gIAltdXRleF91bmxvY2soJnFlcC0+bG9jayk7Cj4gPiAgCXJldHVybiByZXQ7Cj4gPiAg
fQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IGVuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiA+IC0JCQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4g
PiAtCQkJICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfcWVw
X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggKmVuYWJsZSkKPiA+ICB7Cj4gPiAgCXN0cnVj
dCBpbnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCj4gPiAtCXJldHVybiBzeXNm
c19lbWl0KGJ1ZiwgIiV1XG4iLCBxZXAtPmVuYWJsZWQpOwo+ID4gKwkqZW5hYmxlID0gcWVwLT5l
bmFibGVkOwo+ID4gKwo+ID4gKwlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHNz
aXplX3QgZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0J
CQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCSAgICB2b2lkICpwcml2
LCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gPiArc3RhdGljIGludCBpbnRlbF9xZXBf
ZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IHZhbCkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBp
bnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCXUzMiByZWc7Cj4gPiAtCWJvb2wg
dmFsLCBjaGFuZ2VkOwo+ID4gLQlpbnQgcmV0Owo+ID4gLQo+ID4gLQlyZXQgPSBrc3RydG9ib29s
KGJ1ZiwgJnZhbCk7Cj4gPiAtCWlmIChyZXQpCj4gPiAtCQlyZXR1cm4gcmV0Owo+ID4gKwlib29s
IGNoYW5nZWQ7Cj4gPiAgCj4gPiAgCW11dGV4X2xvY2soJnFlcC0+bG9jayk7Cj4gPiAgCWNoYW5n
ZWQgPSB2YWwgXiBxZXAtPmVuYWJsZWQ7Cj4gPiBAQCAtMjY3LDEyICsyNDksMTIgQEAgc3RhdGlj
IHNzaXplX3QgZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+
ICAKPiA+ICBvdXQ6Cj4gPiAgCW11dGV4X3VubG9jaygmcWVwLT5sb2NrKTsKPiA+IC0JcmV0dXJu
IGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IHNw
aWtlX2ZpbHRlcl9uc19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0J
CQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJICAgIHZvaWQgKnBy
aXYsIGNoYXIgKmJ1ZikKPiA+ICtzdGF0aWMgaW50IGludGVsX3FlcF9zcGlrZV9maWx0ZXJfbnNf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQkgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJCSAgdTY0ICpsZW5ndGgpCj4gPiAgewo+ID4g
IAlzdHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1MzIgcmVnOwo+
ID4gQEAgLTI4MSwyNiArMjYzLDI0IEBAIHN0YXRpYyBzc2l6ZV90IHNwaWtlX2ZpbHRlcl9uc19y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJcmVnID0gaW50ZWxfcWVw
X3JlYWRsKHFlcCwgSU5URUxfUUVQQ09OKTsKPiA+ICAJaWYgKCEocmVnICYgSU5URUxfUUVQQ09O
X0ZMVF9FTikpIHsKPiA+ICAJCXBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsKPiA+IC0JCXJldHVy
biBzeXNmc19lbWl0KGJ1ZiwgIjBcbiIpOwo+ID4gKwkJcmV0dXJuIDA7Cj4gPiAgCX0KPiA+ICAJ
cmVnID0gSU5URUxfUUVQRkxUX01BWF9DT1VOVChpbnRlbF9xZXBfcmVhZGwocWVwLCBJTlRFTF9R
RVBGTFQpKTsKPiA+ICAJcG1fcnVudGltZV9wdXQocWVwLT5kZXYpOwo+ID4gIAo+ID4gLQlyZXR1
cm4gc3lzZnNfZW1pdChidWYsICIldVxuIiwgKHJlZyArIDIpICogSU5URUxfUUVQX0NMS19QRVJJ
T0RfTlMpOwo+ID4gKwkqbGVuZ3RoID0gKHJlZyArIDIpICogSU5URUxfUUVQX0NMS19QRVJJT0Rf
TlM7Cj4gPiArCj4gPiArCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVf
dCBzcGlrZV9maWx0ZXJfbnNfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ID4gLQkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJICAgICB2
b2lkICpwcml2LCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gPiArc3RhdGljIGludCBp
bnRlbF9xZXBfc3Bpa2VfZmlsdGVyX25zX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiA+ICsJCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJ
CSAgIHU2NCBsZW5ndGgpCj4gPiAgewo+ID4gIAlzdHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3Vu
dGVyLT5wcml2Owo+ID4gLQl1MzIgcmVnLCBsZW5ndGg7Cj4gPiArCXUzMiByZWc7Cj4gPiAgCWJv
b2wgZW5hYmxlOwo+ID4gLQlpbnQgcmV0Owo+ID4gLQo+ID4gLQlyZXQgPSBrc3RydG91MzIoYnVm
LCAwLCAmbGVuZ3RoKTsKPiA+IC0JaWYgKHJldCA8IDApCj4gPiAtCQlyZXR1cm4gcmV0Owo+ID4g
KwlpbnQgcmV0ID0gMDsKPiA+ICAKPiA+ICAJLyoKPiA+ICAJICogU3Bpa2UgZmlsdGVyIGxlbmd0
aCBpcyAoTUFYX0NPVU5UICsgMikgY2xvY2sgcGVyaW9kcy4KPiA+IEBAIC0zMzYsMTYgKzMxNiwx
NSBAQCBzdGF0aWMgc3NpemVfdCBzcGlrZV9maWx0ZXJfbnNfd3JpdGUoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ID4gIAlpbnRlbF9xZXBfd3JpdGVsKHFlcCwgSU5URUxfUUVQRkxU
LCBsZW5ndGgpOwo+ID4gIAlpbnRlbF9xZXBfd3JpdGVsKHFlcCwgSU5URUxfUUVQQ09OLCByZWcp
Owo+ID4gIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7Cj4gPiAtCXJldCA9IGxlbjsKPiA+ICAK
PiA+ICBvdXQ6Cj4gPiAgCW11dGV4X3VubG9jaygmcWVwLT5sb2NrKTsKPiA+ICAJcmV0dXJuIHJl
dDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCj4gPiAtCQkJCSAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+ID4gK3N0YXRp
YyBpbnQgaW50ZWxfcWVwX3ByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJ
CQl1OCAqcHJlc2V0X2VuYWJsZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBpbnRlbF9xZXAgKnFlcCA9
IGNvdW50ZXItPnByaXY7Cj4gPiAgCXUzMiByZWc7Cj4gPiBAQCAtMzUzLDIxICszMzIsMTggQEAg
c3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiA+ICAJcG1fcnVudGltZV9nZXRfc3luYyhxZXAtPmRldik7Cj4gPiAgCXJlZyA9
IGludGVsX3FlcF9yZWFkbChxZXAsIElOVEVMX1FFUENPTik7Cj4gPiAgCXBtX3J1bnRpbWVfcHV0
KHFlcC0+ZGV2KTsKPiA+IC0JcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJXVcbiIsICEocmVnICYg
SU5URUxfUUVQQ09OX0NPVU5UX1JTVF9NT0RFKSk7Cj4gPiArCj4gPiArCSpwcmVzZXRfZW5hYmxl
ID0gIShyZWcgJiBJTlRFTF9RRVBDT05fQ09VTlRfUlNUX01PREUpOwo+ID4gKwo+ID4gKwlyZXR1
cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV93cml0
ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJCSAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJICAgdm9pZCAqcHJpdiwgY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgbGVuKQo+ID4gK3N0YXRpYyBpbnQgaW50ZWxfcWVwX3ByZXNldF9lbmFibGVfd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkJIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdTggdmFsKQo+ID4gIHsKPiA+ICAJc3RydWN0IGludGVsX3FlcCAq
cWVwID0gY291bnRlci0+cHJpdjsKPiA+ICAJdTMyIHJlZzsKPiA+IC0JYm9vbCB2YWw7Cj4gPiAt
CWludCByZXQ7Cj4gPiAtCj4gPiAtCXJldCA9IGtzdHJ0b2Jvb2woYnVmLCAmdmFsKTsKPiA+IC0J
aWYgKHJldCkKPiA+IC0JCXJldHVybiByZXQ7Cj4gPiArCWludCByZXQgPSAwOwo+ID4gIAo+ID4g
IAltdXRleF9sb2NrKCZxZXAtPmxvY2spOwo+ID4gIAlpZiAocWVwLT5lbmFibGVkKSB7Cj4gPiBA
QCAtMzg0LDcgKzM2MCw2IEBAIHN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAo+ID4gIAlpbnRlbF9xZXBfd3JpdGVs
KHFlcCwgSU5URUxfUUVQQ09OLCByZWcpOwo+ID4gIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7
Cj4gPiAtCXJldCA9IGxlbjsKPiA+ICAKPiA+ICBvdXQ6Cj4gPiAgCW11dGV4X3VubG9jaygmcWVw
LT5sb2NrKTsKPiA+IEBAIC0zOTIsMTEgKzM2NywxNCBAQCBzdGF0aWMgc3NpemVfdCBwcmVzZXRf
ZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJcmV0dXJu
IHJldDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50
X2V4dCBpbnRlbF9xZXBfY291bnRfZXh0W10gPSB7Cj4gPiAtCUlOVEVMX1FFUF9DT1VOVEVSX0VY
VF9SVyhjZWlsaW5nKSwKPiA+IC0JSU5URUxfUUVQX0NPVU5URVJfRVhUX1JXKGVuYWJsZSksCj4g
PiAtCUlOVEVMX1FFUF9DT1VOVEVSX0VYVF9SVyhzcGlrZV9maWx0ZXJfbnMpLAo+ID4gLQlJTlRF
TF9RRVBfQ09VTlRFUl9FWFRfUlcocHJlc2V0X2VuYWJsZSkKPiA+ICtzdGF0aWMgc3RydWN0IGNv
dW50ZXJfY29tcCBpbnRlbF9xZXBfY291bnRfZXh0W10gPSB7Cj4gPiArCUNPVU5URVJfQ09NUF9F
TkFCTEUoaW50ZWxfcWVwX2VuYWJsZV9yZWFkLCBpbnRlbF9xZXBfZW5hYmxlX3dyaXRlKSwKPiA+
ICsJQ09VTlRFUl9DT01QX0NFSUxJTkcoaW50ZWxfcWVwX2NlaWxpbmdfcmVhZCwgaW50ZWxfcWVw
X2NlaWxpbmdfd3JpdGUpLAo+ID4gKwlDT1VOVEVSX0NPTVBfUFJFU0VUX0VOQUJMRShpbnRlbF9x
ZXBfcHJlc2V0X2VuYWJsZV9yZWFkLAo+ID4gKwkJCQkgICBpbnRlbF9xZXBfcHJlc2V0X2VuYWJs
ZV93cml0ZSksCj4gPiArCUNPVU5URVJfQ09NUF9DT1VOVF9VNjQoInNwaWtlX2ZpbHRlcl9ucyIs
Cj4gPiArCQkJICAgICAgIGludGVsX3FlcF9zcGlrZV9maWx0ZXJfbnNfcmVhZCwKPiA+ICsJCQkg
ICAgICAgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc193cml0ZSksCj4gPiAgfTsKPiA+ICAKPiA+
ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnQgaW50ZWxfcWVwX2NvdW50ZXJfY291bnRbXSA9
IHsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5jIGIvZHJp
dmVycy9jb3VudGVyL2ludGVycnVwdC1jbnQuYwo+ID4gaW5kZXggMWRlNDI0M2RiNDg4Li44NTE0
YTg3ZmNiZWUgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5j
Cj4gPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5jCj4gPiBAQCAtMTAsNiAr
MTAsNyBAQAo+ID4gICNpbmNsdWRlIDxsaW51eC9tb2RfZGV2aWNldGFibGUuaD4KPiA+ICAjaW5j
bHVkZSA8bGludXgvbW9kdWxlLmg+Cj4gPiAgI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2Rldmlj
ZS5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ID4gIAo+ID4gICNkZWZpbmUgSU5U
RVJSVVBUX0NOVF9OQU1FICJpbnRlcnJ1cHQtY250Igo+ID4gIAo+ID4gQEAgLTMzLDMwICszNCwy
MyBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgaW50ZXJydXB0X2NudF9pc3IoaW50IGlycSwgdm9pZCAq
ZGV2X2lkKQo+ID4gIAlyZXR1cm4gSVJRX0hBTkRMRUQ7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRp
YyBzc2l6ZV90IGludGVycnVwdF9jbnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ID4gLQkJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0J
CQkJCSB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCj4gPiArc3RhdGljIGludCBpbnRlcnJ1cHRf
Y250X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJ
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4ICplbmFibGUpCj4gPiAgewo+ID4g
IAlzdHJ1Y3QgaW50ZXJydXB0X2NudF9wcml2ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiA+ICAK
PiA+IC0JcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJWRcbiIsIHByaXYtPmVuYWJsZWQpOwo+ID4g
KwkqZW5hYmxlID0gcHJpdi0+ZW5hYmxlZDsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+
ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IGludGVycnVwdF9jbnRfZW5hYmxlX3dyaXRlKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJCSAgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAo+ID4gLQkJCQkJICB2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsCj4g
PiAtCQkJCQkgIHNpemVfdCBsZW4pCj4gPiArc3RhdGljIGludCBpbnRlcnJ1cHRfY250X2VuYWJs
ZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggZW5hYmxlKQo+ID4gIHsKPiA+ICAJc3RydWN0
IGludGVycnVwdF9jbnRfcHJpdiAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAtCWJvb2wgZW5h
YmxlOwo+ID4gLQlzc2l6ZV90IHJldDsKPiA+IC0KPiA+IC0JcmV0ID0ga3N0cnRvYm9vbChidWYs
ICZlbmFibGUpOwo+ID4gLQlpZiAocmV0KQo+ID4gLQkJcmV0dXJuIHJldDsKPiA+ICAKPiA+ICAJ
aWYgKHByaXYtPmVuYWJsZWQgPT0gZW5hYmxlKQo+ID4gLQkJcmV0dXJuIGxlbjsKPiA+ICsJCXJl
dHVybiAwOwo+ID4gIAo+ID4gIAlpZiAoZW5hYmxlKSB7Cj4gPiAgCQlwcml2LT5lbmFibGVkID0g
dHJ1ZTsKPiA+IEBAIC02NiwzMyArNjAsMzAgQEAgc3RhdGljIHNzaXplX3QgaW50ZXJydXB0X2Nu
dF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAkJcHJp
di0+ZW5hYmxlZCA9IGZhbHNlOwo+ID4gIAl9Cj4gPiAgCj4gPiAtCXJldHVybiBsZW47Cj4gPiAr
CXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJf
Y291bnRfZXh0IGludGVycnVwdF9jbnRfZXh0W10gPSB7Cj4gPiAtCXsKPiA+IC0JCS5uYW1lID0g
ImVuYWJsZSIsCj4gPiAtCQkucmVhZCA9IGludGVycnVwdF9jbnRfZW5hYmxlX3JlYWQsCj4gPiAt
CQkud3JpdGUgPSBpbnRlcnJ1cHRfY250X2VuYWJsZV93cml0ZSwKPiA+IC0JfSwKPiA+ICtzdGF0
aWMgc3RydWN0IGNvdW50ZXJfY29tcCBpbnRlcnJ1cHRfY250X2V4dFtdID0gewo+ID4gKwlDT1VO
VEVSX0NPTVBfRU5BQkxFKGludGVycnVwdF9jbnRfZW5hYmxlX3JlYWQsCj4gPiArCQkJICAgIGlu
dGVycnVwdF9jbnRfZW5hYmxlX3dyaXRlKSwKPiA+ICB9Owo+ID4gIAo+ID4gIHN0YXRpYyBjb25z
dCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gaW50ZXJydXB0X2NudF9zeW5hcHNlX2FjdGlv
bnNbXSA9IHsKPiA+ICAJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiA+ICB9
Owo+ID4gIAo+ID4gLXN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwKPiA+IC0JCQkJICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4g
PiAtCQkJCSAgICBzaXplX3QgKmFjdGlvbikKPiA+ICtzdGF0aWMgaW50IGludGVycnVwdF9jbnRf
YWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkgICAg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJICAgICBzdHJ1Y3QgY291bnRl
cl9zeW5hcHNlICpzeW5hcHNlLAo+ID4gKwkJCQkgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2Fj
dGlvbiAqYWN0aW9uKQo+ID4gIHsKPiA+IC0JKmFjdGlvbiA9IDA7Cj4gPiArCSphY3Rpb24gPSBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ID4gIAo+ID4gIAlyZXR1cm4gMDsK
PiA+ICB9Cj4gPiAgCj4gPiAgc3RhdGljIGludCBpbnRlcnJ1cHRfY250X3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwgdW5zaWduZWQgbG9uZyAqdmFsKQo+ID4gKwkJCSAgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwgdTY0ICp2YWwpCj4gPiAgewo+ID4gIAlzdHJ1Y3QgaW50ZXJydXB0X2Nu
dF9wcml2ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiA+ICAKPiA+IEBAIC0xMDIsOCArOTMsNyBA
QCBzdGF0aWMgaW50IGludGVycnVwdF9jbnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gPiAgfQo+ID4gIAo+ID4gIHN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF93cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJICAgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkgICAgICAgY29uc3QgdW5zaWduZWQgbG9uZyB2YWwp
Cj4gPiArCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgY29uc3QgdTY0IHZh
bCkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBpbnRlcnJ1cHRfY250X3ByaXYgKnByaXYgPSBjb3VudGVy
LT5wcml2Owo+ID4gIAo+ID4gQEAgLTExOSwxMSArMTA5LDExIEBAIHN0YXRpYyBjb25zdCBlbnVt
IGNvdW50ZXJfZnVuY3Rpb24gaW50ZXJydXB0X2NudF9mdW5jdGlvbnNbXSA9IHsKPiA+ICAJQ09V
TlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKPiA+ICB9Owo+ID4gIAo+ID4gLXN0YXRpYyBpbnQgaW50
ZXJydXB0X2NudF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ID4gLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCSAgICAg
IHNpemVfdCAqZnVuY3Rpb24pCj4gPiArc3RhdGljIGludCBpbnRlcnJ1cHRfY250X2Z1bmN0aW9u
X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkgICAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gKwkJCQkgICAgICAgZW51bSBjb3VudGVyX2Z1
bmN0aW9uICpmdW5jdGlvbikKPiA+ICB7Cj4gPiAtCSpmdW5jdGlvbiA9IDA7Cj4gPiArCSpmdW5j
dGlvbiA9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0U7Cj4gPiAgCj4gPiAgCXJldHVybiAwOwo+
ID4gIH0KPiA+IEBAIC0xNDgsMTAgKzEzOCwxMCBAQCBzdGF0aWMgaW50IGludGVycnVwdF9jbnRf
c2lnbmFsX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIH0KPiA+ICAK
PiA+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIGludGVycnVwdF9jbnRfb3BzID0g
ewo+ID4gLQkuYWN0aW9uX2dldCA9IGludGVycnVwdF9jbnRfYWN0aW9uX2dldCwKPiA+ICsJLmFj
dGlvbl9yZWFkID0gaW50ZXJydXB0X2NudF9hY3Rpb25fcmVhZCwKPiA+ICAJLmNvdW50X3JlYWQg
PSBpbnRlcnJ1cHRfY250X3JlYWQsCj4gPiAgCS5jb3VudF93cml0ZSA9IGludGVycnVwdF9jbnRf
d3JpdGUsCj4gPiAtCS5mdW5jdGlvbl9nZXQgPSBpbnRlcnJ1cHRfY250X2Z1bmN0aW9uX2dldCwK
PiA+ICsJLmZ1bmN0aW9uX3JlYWQgPSBpbnRlcnJ1cHRfY250X2Z1bmN0aW9uX3JlYWQsCj4gPiAg
CS5zaWduYWxfcmVhZCAgPSBpbnRlcnJ1cHRfY250X3NpZ25hbF9yZWFkLAo+ID4gIH07Cj4gPiAg
Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2FwdHVyZS5j
IGIvZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2FwdHVyZS5jCj4gPiBpbmRleCAxYWE3
MGI5YzQ4MzMuLjc5ZTBjODRhM2I4MSAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvY291bnRlci9t
aWNyb2NoaXAtdGNiLWNhcHR1cmUuYwo+ID4gKysrIGIvZHJpdmVycy9jb3VudGVyL21pY3JvY2hp
cC10Y2ItY2FwdHVyZS5jCj4gPiBAQCAtMzIsMjggKzMyLDE2IEBAIHN0cnVjdCBtY2hwX3RjX2Rh
dGEgewo+ID4gIAlib29sIHRyaWdfaW52ZXJ0ZWQ7Cj4gPiAgfTsKPiA+ICAKPiA+IC1lbnVtIG1j
aHBfdGNfY291bnRfZnVuY3Rpb24gewo+ID4gLQlNQ0hQX1RDX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+
ID4gLQlNQ0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRVUkUsCj4gPiAtfTsKPiA+IC0KPiA+ICBzdGF0
aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uIG1jaHBfdGNfY291bnRfZnVuY3Rpb25zW10g
PSB7Cj4gPiAtCVtNQ0hQX1RDX0ZVTkNUSU9OX0lOQ1JFQVNFXSA9IENPVU5URVJfRlVOQ1RJT05f
SU5DUkVBU0UsCj4gPiAtCVtNQ0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRVUkVdID0gQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1g0LAo+ID4gLX07Cj4gPiAtCj4gPiAtZW51bSBtY2hwX3RjX3N5
bmFwc2VfYWN0aW9uIHsKPiA+IC0JTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9OT05FID0gMCwKPiA+
IC0JTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiA+IC0JTUNIUF9UQ19TWU5B
UFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gPiAtCU1DSFBfVENfU1lOQVBTRV9BQ1RJT05fQk9U
SF9FREdFCj4gPiArCUNPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCj4gPiArCUNPVU5URVJfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YNCwKPiA+ICB9Owo+ID4gIAo+ID4gIHN0YXRpYyBjb25zdCBlbnVt
IGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gbWNocF90Y19zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiA+
IC0JW01DSFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X05PTkUsCj4gPiAtCVtNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gPiAtCVtNQ0hQX1RDX1NZTkFQU0VfQUNU
SU9OX0ZBTExJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwK
PiA+IC0JW01DSFBfVENfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFXSA9IENPVU5URVJfU1lOQVBT
RV9BQ1RJT05fQk9USF9FREdFUywKPiA+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+
ID4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+ID4gKwlDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiA+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9C
T1RIX0VER0VTLAo+ID4gIH07Cj4gPiAgCj4gPiAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCBtY2hwX3RjX2NvdW50X3NpZ25hbHNbXSA9IHsKPiA+IEBAIC04MCwyMyArNjgsMjMgQEAgc3Rh
dGljIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgbWNocF90Y19jb3VudF9zeW5hcHNlc1tdID0gewo+
ID4gIAl9Cj4gPiAgfTsKPiA+ICAKPiA+IC1zdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rp
b25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJICAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkgICAgICBzaXplX3QgKmZ1bmN0aW9u
KQo+ID4gK3N0YXRpYyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwKPiA+ICsJCQkJICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb24p
Cj4gPiAgewo+ID4gIAlzdHJ1Y3QgbWNocF90Y19kYXRhICpjb25zdCBwcml2ID0gY291bnRlci0+
cHJpdjsKPiA+ICAKPiA+ICAJaWYgKHByaXYtPnFkZWNfbW9kZSkKPiA+IC0JCSpmdW5jdGlvbiA9
IE1DSFBfVENfRlVOQ1RJT05fUVVBRFJBVFVSRTsKPiA+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YNDsKPiA+ICAJZWxzZQo+ID4gLQkJKmZ1bmN0aW9uID0gTUNI
UF9UQ19GVU5DVElPTl9JTkNSRUFTRTsKPiA+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJ
T05fSU5DUkVBU0U7Cj4gPiAgCj4gPiAgCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0
aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiA+IC0JCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4g
LQkJCQkgICAgICBzaXplX3QgZnVuY3Rpb24pCj4gPiArc3RhdGljIGludCBtY2hwX3RjX2NvdW50
X2Z1bmN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJ
CXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJCWVudW0gY291bnRlcl9mdW5j
dGlvbiBmdW5jdGlvbikKPiA+ICB7Cj4gPiAgCXN0cnVjdCBtY2hwX3RjX2RhdGEgKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1MzIgYm1yLCBjbXI7Cj4gPiBAQCAtMTA4LDcgKzk2
LDcgQEAgc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCWNtciAmPSB+QVRNRUxfVENfV0FWRTsKPiA+ICAKPiA+
ICAJc3dpdGNoIChmdW5jdGlvbikgewo+ID4gLQljYXNlIE1DSFBfVENfRlVOQ1RJT05fSU5DUkVB
U0U6Cj4gPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKPiA+ICAJCXByaXYtPnFk
ZWNfbW9kZSA9IDA7Cj4gPiAgCQkvKiBTZXQgaGlnaGVzdCByYXRlIGJhc2VkIG9uIHdoZXRoZXIg
c29jIGhhcyBnY2xrIG9yIG5vdCAqLwo+ID4gIAkJYm1yICY9IH4oQVRNRUxfVENfUURFTiB8IEFU
TUVMX1RDX1BPU0VOKTsKPiA+IEBAIC0xMjAsNyArMTA4LDcgQEAgc3RhdGljIGludCBtY2hwX3Rj
X2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAg
CQljbXIgfD0gIEFUTUVMX1RDX0NNUl9NQVNLOwo+ID4gIAkJY21yICY9IH4oQVRNRUxfVENfQUJF
VFJHIHwgQVRNRUxfVENfWEMwKTsKPiA+ICAJCWJyZWFrOwo+ID4gLQljYXNlIE1DSFBfVENfRlVO
Q1RJT05fUVVBRFJBVFVSRToKPiA+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDQ6Cj4gPiAgCQlpZiAoIXByaXYtPnRjX2NmZy0+aGFzX3FkZWMpCj4gPiAgCQkJcmV0dXJuIC1F
SU5WQUw7Cj4gPiAgCQkvKiBJbiBRREVDIG1vZGUgc2V0dGluZ3MgYm90aCBjaGFubmVscyAwIGFu
ZCAxIGFyZSByZXF1aXJlZCAqLwo+ID4gQEAgLTE3NiwxMCArMTY0LDEwIEBAIHN0YXRpYyBpbnQg
bWNocF90Y19jb3VudF9zaWduYWxfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gPiAgCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgaW50IG1jaHBfdGNfY291
bnRfYWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJCSAg
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCSAgICBzdHJ1Y3QgY291bnRl
cl9zeW5hcHNlICpzeW5hcHNlLAo+ID4gLQkJCQkgICAgc2l6ZV90ICphY3Rpb24pCj4gPiArc3Rh
dGljIGludCBtY2hwX3RjX2NvdW50X2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiA+ICsJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAr
CQkJCSAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiA+ICsJCQkJICAgICBl
bnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiA+ICB7Cj4gPiAgCXN0cnVjdCBt
Y2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1MzIgY21yOwo+
ID4gQEAgLTE4OCwyNiArMTc2LDI2IEBAIHN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9hY3Rpb25f
Z2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAKPiA+ICAJc3dpdGNoIChj
bXIgJiBBVE1FTF9UQ19FVFJHRURHKSB7Cj4gPiAgCWRlZmF1bHQ6Cj4gPiAtCQkqYWN0aW9uID0g
TUNIUF9UQ19TWU5BUFNFX0FDVElPTl9OT05FOwo+ID4gKwkJKmFjdGlvbiA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fTk9ORTsKPiA+ICAJCWJyZWFrOwo+ID4gIAljYXNlIEFUTUVMX1RDX0VUUkdF
REdfUklTSU5HOgo+ID4gLQkJKmFjdGlvbiA9IE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fUklTSU5H
X0VER0U7Cj4gPiArCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURH
RTsKPiA+ICAJCWJyZWFrOwo+ID4gIAljYXNlIEFUTUVMX1RDX0VUUkdFREdfRkFMTElORzoKPiA+
IC0JCSphY3Rpb24gPSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRTsKPiA+ICsJ
CSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRTsKPiA+ICAJCWJy
ZWFrOwo+ID4gIAljYXNlIEFUTUVMX1RDX0VUUkdFREdfQk9USDoKPiA+IC0JCSphY3Rpb24gPSBN
Q0hQX1RDX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRTsKPiA+ICsJCSphY3Rpb24gPSBDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gPiAgCQlicmVhazsKPiA+ICAJfQo+ID4gIAo+
ID4gIAlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIGludCBtY2hwX3RjX2NvdW50
X2FjdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJf
c3luYXBzZSAqc3luYXBzZSwKPiA+IC0JCQkJICAgIHNpemVfdCBhY3Rpb24pCj4gPiArc3RhdGlj
IGludCBtY2hwX3RjX2NvdW50X2FjdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gPiArCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJ
CQkJICAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiA+ICsJCQkJICAgICAg
ZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlvbikKPiA+ICB7Cj4gPiAgCXN0cnVjdCBt
Y2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1MzIgZWRnZSA9
IEFUTUVMX1RDX0VUUkdFREdfTk9ORTsKPiA+IEBAIC0yMTcsMTYgKzIwNSwxNiBAQCBzdGF0aWMg
aW50IG1jaHBfdGNfY291bnRfYWN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAKPiA+ICAJc3dpdGNoIChhY3Rpb24pIHsK
PiA+IC0JY2FzZSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX05PTkU6Cj4gPiArCWNhc2UgQ09VTlRF
Ul9TWU5BUFNFX0FDVElPTl9OT05FOgo+ID4gIAkJZWRnZSA9IEFUTUVMX1RDX0VUUkdFREdfTk9O
RTsKPiA+ICAJCWJyZWFrOwo+ID4gLQljYXNlIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fUklTSU5H
X0VER0U6Cj4gPiArCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRToKPiA+
ICAJCWVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX1JJU0lORzsKPiA+ICAJCWJyZWFrOwo+ID4gLQlj
YXNlIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOgo+ID4gKwljYXNlIENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOgo+ID4gIAkJZWRnZSA9IEFUTUVMX1RDX0VU
UkdFREdfRkFMTElORzsKPiA+ICAJCWJyZWFrOwo+ID4gLQljYXNlIE1DSFBfVENfU1lOQVBTRV9B
Q1RJT05fQk9USF9FREdFOgo+ID4gKwljYXNlIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUzoKPiA+ICAJCWVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX0JPVEg7Cj4gPiAgCQlicmVhazsK
PiA+ICAJZGVmYXVsdDoKPiA+IEBAIC0yNDAsOCArMjI4LDcgQEAgc3RhdGljIGludCBtY2hwX3Rj
X2NvdW50X2FjdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIH0K
PiA+ICAKPiA+ICBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+ID4gLQkJCSAgICAgIHVuc2lnbmVkIGxvbmcgKnZhbCkKPiA+ICsJCQkgICAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsKQo+ID4gIHsKPiA+ICAJc3RydWN0IG1jaHBf
dGNfZGF0YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCXUzMiBjbnQ7Cj4gPiBA
QCAtMjY0LDEyICsyNTEsMTIgQEAgc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvdW50IG1jaHBfdGNf
Y291bnRzW10gPSB7Cj4gPiAgfTsKPiA+ICAKPiA+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50
ZXJfb3BzIG1jaHBfdGNfb3BzID0gewo+ID4gLQkuc2lnbmFsX3JlYWQgID0gbWNocF90Y19jb3Vu
dF9zaWduYWxfcmVhZCwKPiA+IC0JLmNvdW50X3JlYWQgICA9IG1jaHBfdGNfY291bnRfcmVhZCwK
PiA+IC0JLmZ1bmN0aW9uX2dldCA9IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fZ2V0LAo+ID4gLQku
ZnVuY3Rpb25fc2V0ID0gbWNocF90Y19jb3VudF9mdW5jdGlvbl9zZXQsCj4gPiAtCS5hY3Rpb25f
Z2V0ICAgPSBtY2hwX3RjX2NvdW50X2FjdGlvbl9nZXQsCj4gPiAtCS5hY3Rpb25fc2V0ICAgPSBt
Y2hwX3RjX2NvdW50X2FjdGlvbl9zZXQKPiA+ICsJLnNpZ25hbF9yZWFkICAgID0gbWNocF90Y19j
b3VudF9zaWduYWxfcmVhZCwKPiA+ICsJLmNvdW50X3JlYWQgICAgID0gbWNocF90Y19jb3VudF9y
ZWFkLAo+ID4gKwkuZnVuY3Rpb25fcmVhZCAgPSBtY2hwX3RjX2NvdW50X2Z1bmN0aW9uX3JlYWQs
Cj4gPiArCS5mdW5jdGlvbl93cml0ZSA9IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fd3JpdGUsCj4g
PiArCS5hY3Rpb25fcmVhZCAgICA9IG1jaHBfdGNfY291bnRfYWN0aW9uX3JlYWQsCj4gPiArCS5h
Y3Rpb25fd3JpdGUgICA9IG1jaHBfdGNfY291bnRfYWN0aW9uX3dyaXRlCj4gPiAgfTsKPiA+ICAK
PiA+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGF0bWVsX3RjYl9jb25maWcgdGNiX3JtOTIwMF9jb25m
aWcgPSB7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250
LmMgYi9kcml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYwo+ID4gaW5kZXggNzM2N2Y0
NmM2ZjkxLi41MTY4ODMzYjFmZGYgMTAwNjQ0Cj4gPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvc3Rt
MzItbHB0aW1lci1jbnQuYwo+ID4gKysrIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXIt
Y250LmMKPiA+IEBAIC0xNyw2ICsxNyw3IEBACj4gPiAgI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5o
Pgo+ID4gICNpbmNsdWRlIDxsaW51eC9waW5jdHJsL2NvbnN1bWVyLmg+Cj4gPiAgI2luY2x1ZGUg
PGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgo+ID4gKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+
ID4gIAo+ID4gIHN0cnVjdCBzdG0zMl9scHRpbV9jbnQgewo+ID4gIAlzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgY291bnRlcjsKPiA+IEBAIC0xMDcsMTEgKzEwOCw3IEBAIHN0YXRpYyBpbnQgc3RtMzJf
bHB0aW1fc2V0dXAoc3RydWN0IHN0bTMyX2xwdGltX2NudCAqcHJpdiwgaW50IGVuYWJsZSkKPiA+
ICAJcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIFNUTTMyX0xQVElNX0NG
R1IsIG1hc2ssIHZhbCk7Cj4gPiAgfQo+ID4gIAo+ID4gLS8qKgo+ID4gLSAqIGVudW0gc3RtMzJf
bHB0aW1fY250X2Z1bmN0aW9uIC0gZW51bWVyYXRlcyBMUFRpbWVyIGNvdW50ZXIgJiBlbmNvZGVy
IG1vZGVzCj4gPiAtICogQFNUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0U6IHVwIGNvdW50IG9u
IElOMSByaXNpbmcsIGZhbGxpbmcgb3IgYm90aCBlZGdlcwo+ID4gLSAqIEBTVE0zMl9MUFRJTV9F
TkNPREVSX0JPVEhfRURHRTogY291bnQgb24gYm90aCBlZGdlcyAoSU4xICYgSU4yIHF1YWRyYXR1
cmUpCj4gPiAtICoKPiA+ICsvKgo+ID4gICAqIEluIG5vbi1xdWFkcmF0dXJlIG1vZGUsIGRldmlj
ZSBjb3VudHMgdXAgb24gYWN0aXZlIGVkZ2UuCj4gPiAgICogSW4gcXVhZHJhdHVyZSBtb2RlLCBl
bmNvZGVyIGNvdW50aW5nIHNjZW5hcmlvcyBhcmUgYXMgZm9sbG93czoKPiA+ICAgKiArLS0tLS0t
LS0tKy0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0r
Cj4gPiBAQCAtMTI5LDMzICsxMjYsMjAgQEAgc3RhdGljIGludCBzdG0zMl9scHRpbV9zZXR1cChz
dHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpwcml2LCBpbnQgZW5hYmxlKQo+ID4gICAqIHwgZWRnZXMg
ICB8IExvdyAgLT4gIHwgICBVcCAgICAgfCAgIERvd24gIHwgICBEb3duICAgfCAgIFVwICAgIHwK
PiA+ICAgKiArLS0tLS0tLS0tKy0tLS0tLS0tLS0rLS0tLS0tLS0tLSstLS0tLS0tLS0rLS0tLS0t
LS0tLSstLS0tLS0tLS0rCj4gPiAgICovCj4gPiAtZW51bSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rp
b24gewo+ID4gLQlTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNFLAo+ID4gLQlTVE0zMl9MUFRJ
TV9FTkNPREVSX0JPVEhfRURHRSwKPiA+IC19Owo+ID4gLQo+ID4gIHN0YXRpYyBjb25zdCBlbnVt
IGNvdW50ZXJfZnVuY3Rpb24gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uc1tdID0gewo+ID4gLQlb
U1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRV0gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNF
LAo+ID4gLQlbU1RNMzJfTFBUSU1fRU5DT0RFUl9CT1RIX0VER0VdID0gQ09VTlRFUl9GVU5DVElP
Tl9RVUFEUkFUVVJFX1g0LAo+ID4gLX07Cj4gPiAtCj4gPiAtZW51bSBzdG0zMl9scHRpbV9zeW5h
cHNlX2FjdGlvbiB7Cj4gPiAtCVNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdF
ID0gU1RNMzJfTFBUSU1fQ0tQT0xfUklTSU5HX0VER0UsCj4gPiAtCVNUTTMyX0xQVElNX1NZTkFQ
U0VfQUNUSU9OX0ZBTExJTkdfRURHRSA9IFNUTTMyX0xQVElNX0NLUE9MX0ZBTExJTkdfRURHRSwK
PiA+IC0JU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUyA9IFNUTTMyX0xQVElN
X0NLUE9MX0JPVEhfRURHRVMsCj4gPiAtCVNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX05PTkUs
Cj4gPiArCUNPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCj4gPiArCUNPVU5URVJfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YNCwKPiA+ICB9Owo+ID4gIAo+ID4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50
ZXJfc3luYXBzZV9hY3Rpb24gc3RtMzJfbHB0aW1fY250X3N5bmFwc2VfYWN0aW9uc1tdID0gewo+
ID4gLQkvKiBJbmRleCBtdXN0IG1hdGNoIHdpdGggc3RtMzJfbHB0aW1fY250X3BvbGFyaXR5W10g
KHByaXYtPnBvbGFyaXR5KSAqLwo+ID4gLQlbU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fUklT
SU5HX0VER0VdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiA+IC0JW1NU
TTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX0ZBTExJTkdfRURHRSwKPiA+IC0JW1NUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVNdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+ID4gLQlbU1RN
MzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05P
TkUsCj4gPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gPiArCUNPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+ID4gKwlDT1VOVEVSX1NZTkFQU0VfQUNU
SU9OX0JPVEhfRURHRVMsCj4gPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiA+ICB9
Owo+ID4gIAo+ID4gIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X3JlYWQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
IHVuc2lnbmVkIGxvbmcgKnZhbCkKPiA+ICsJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1NjQgKnZhbCkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1MzIgY250Owo+ID4gQEAgLTE3MCwyOCArMTU0LDI4
IEBAIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ID4gIAlyZXR1cm4gMDsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIGludCBz
dG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiA+IC0JCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJCXNpemVf
dCAqZnVuY3Rpb24pCj4gPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQkgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAo+ID4gKwkJCQkJIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rp
b24pCj4gPiAgewo+ID4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291
bnRlci0+cHJpdjsKPiA+ICAKPiA+ICAJaWYgKCFwcml2LT5xdWFkcmF0dXJlX21vZGUpIHsKPiA+
IC0JCSpmdW5jdGlvbiA9IFNUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0U7Cj4gPiArCQkqZnVu
Y3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOwo+ID4gIAkJcmV0dXJuIDA7Cj4gPiAg
CX0KPiA+ICAKPiA+IC0JaWYgKHByaXYtPnBvbGFyaXR5ID09IFNUTTMyX0xQVElNX1NZTkFQU0Vf
QUNUSU9OX0JPVEhfRURHRVMpIHsKPiA+IC0JCSpmdW5jdGlvbiA9IFNUTTMyX0xQVElNX0VOQ09E
RVJfQk9USF9FREdFOwo+ID4gKwlpZiAocHJpdi0+cG9sYXJpdHkgPT0gU1RNMzJfTFBUSU1fQ0tQ
T0xfQk9USF9FREdFUykgewo+ID4gKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0Owo+ID4gIAkJcmV0dXJuIDA7Cj4gPiAgCX0KPiA+ICAKPiA+ICAJcmV0dXJuIC1F
SU5WQUw7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2Z1bmN0
aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJCQlzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCQlzaXplX3QgZnVuY3Rpb24pCj4gPiArc3Rh
dGljIGludCBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ID4gKwkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4g
PiArCQkJCQkgIGVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbikKPiA+ICB7Cj4gPiAgCXN0
cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAo+
ID4gQEAgLTE5OSwxMiArMTgzLDEyIEBAIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2Z1bmN0
aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCQlyZXR1cm4gLUVC
VVNZOwo+ID4gIAo+ID4gIAlzd2l0Y2ggKGZ1bmN0aW9uKSB7Cj4gPiAtCWNhc2UgU1RNMzJfTFBU
SU1fQ09VTlRFUl9JTkNSRUFTRToKPiA+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNF
Ogo+ID4gIAkJcHJpdi0+cXVhZHJhdHVyZV9tb2RlID0gMDsKPiA+ICAJCXJldHVybiAwOwo+ID4g
LQljYXNlIFNUTTMyX0xQVElNX0VOQ09ERVJfQk9USF9FREdFOgo+ID4gKwljYXNlIENPVU5URVJf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiA+ICAJCXByaXYtPnF1YWRyYXR1cmVfbW9kZSA9IDE7
Cj4gPiAtCQlwcml2LT5wb2xhcml0eSA9IFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0JPVEhf
RURHRVM7Cj4gPiArCQlwcml2LT5wb2xhcml0eSA9IFNUTTMyX0xQVElNX0NLUE9MX0JPVEhfRURH
RVM7Cj4gPiAgCQlyZXR1cm4gMDsKPiA+ICAJZGVmYXVsdDoKPiA+ICAJCS8qIHNob3VsZCBuZXZl
ciByZWFjaCB0aGlzIHBhdGggKi8KPiA+IEBAIC0yMTIsOSArMTk2LDkgQEAgc3RhdGljIGludCBz
dG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiA+ICAJfQo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9scHRpbV9j
bnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkJ
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkJICAgdm9pZCAqcHJpdmF0
ZSwgY2hhciAqYnVmKQo+ID4gK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2VuYWJsZV9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJICAgICAgIHU4ICplbmFibGUpCj4gPiAgewo+
ID4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsK
PiA+ICAJaW50IHJldDsKPiA+IEBAIC0yMjMsMjIgKzIwNywxOCBAQCBzdGF0aWMgc3NpemVfdCBz
dG0zMl9scHRpbV9jbnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ID4gIAlpZiAocmV0IDwgMCkKPiA+ICAJCXJldHVybiByZXQ7Cj4gPiAgCj4gPiAtCXJldHVy
biBzY25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgcmV0KTsKPiA+ICsJKmVuYWJsZSA9
IHJldDsKPiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6
ZV90IHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+ID4gLQkJCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0J
CQkJCSAgICB2b2lkICpwcml2YXRlLAo+ID4gLQkJCQkJICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGxlbikKPiA+ICtzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkJc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAo+ID4gKwkJCQkJdTggZW5hYmxlKQo+ID4gIHsKPiA+ICAJc3RydWN0IHN0bTMy
X2xwdGltX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAtCWJvb2wgZW5hYmxl
Owo+ID4gIAlpbnQgcmV0Owo+ID4gIAo+ID4gLQlyZXQgPSBrc3RydG9ib29sKGJ1ZiwgJmVuYWJs
ZSk7Cj4gPiAtCWlmIChyZXQpCj4gPiAtCQlyZXR1cm4gcmV0Owo+ID4gLQo+ID4gIAkvKiBDaGVj
ayBub2JvZHkgdXNlcyB0aGUgdGltZXIsIG9yIGFscmVhZHkgZGlzYWJsZWQvZW5hYmxlZCAqLwo+
ID4gIAlyZXQgPSBzdG0zMl9scHRpbV9pc19lbmFibGVkKHByaXYpOwo+ID4gIAlpZiAoKHJldCA8
IDApIHx8ICghcmV0ICYmICFlbmFibGUpKQo+ID4gQEAgLTI1NCw3OCArMjM0LDgxIEBAIHN0YXRp
YyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ID4gIAlpZiAocmV0KQo+ID4gIAkJcmV0dXJuIHJldDsKPiA+ICAKPiA+
IC0JcmV0dXJuIGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBz
c2l6ZV90IHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ID4gLQkJCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+
IC0JCQkJCSAgICB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCj4gPiArc3RhdGljIGludCBzdG0z
Ml9scHRpbV9jbnRfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiA+ICsJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJCXU2NCAqY2Vp
bGluZykKPiA+ICB7Cj4gPiAgCXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHByaXYgPSBj
b3VudGVyLT5wcml2Owo+ID4gIAo+ID4gLQlyZXR1cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUs
ICIldVxuIiwgcHJpdi0+Y2VpbGluZyk7Cj4gPiArCSpjZWlsaW5nID0gcHJpdi0+Y2VpbGluZzsK
PiA+ICsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IHN0
bTMyX2xwdGltX2NudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiA+IC0JCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkJ
ICAgICB2b2lkICpwcml2YXRlLAo+ID4gLQkJCQkJICAgICBjb25zdCBjaGFyICpidWYsIHNpemVf
dCBsZW4pCj4gPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfY2VpbGluZ193cml0ZShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQkgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAo+ID4gKwkJCQkJIHU2NCBjZWlsaW5nKQo+ID4gIHsKPiA+ICAJc3RydWN0IHN0
bTMyX2xwdGltX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAtCXVuc2lnbmVk
IGludCBjZWlsaW5nOwo+ID4gLQlpbnQgcmV0Owo+ID4gIAo+ID4gIAlpZiAoc3RtMzJfbHB0aW1f
aXNfZW5hYmxlZChwcml2KSkKPiA+ICAJCXJldHVybiAtRUJVU1k7Cj4gPiAgCj4gPiAtCXJldCA9
IGtzdHJ0b3VpbnQoYnVmLCAwLCAmY2VpbGluZyk7Cj4gPiAtCWlmIChyZXQpCj4gPiAtCQlyZXR1
cm4gcmV0Owo+ID4gLQo+ID4gIAlpZiAoY2VpbGluZyA+IFNUTTMyX0xQVElNX01BWF9BUlIpCj4g
PiAgCQlyZXR1cm4gLUVSQU5HRTsKPiA+ICAKPiA+ICAJcHJpdi0+Y2VpbGluZyA9IGNlaWxpbmc7
Cj4gPiAgCj4gPiAtCXJldHVybiBsZW47Cj4gPiArCXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+
IC1zdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0IHN0bTMyX2xwdGltX2NudF9l
eHRbXSA9IHsKPiA+IC0Jewo+ID4gLQkJLm5hbWUgPSAiZW5hYmxlIiwKPiA+IC0JCS5yZWFkID0g
c3RtMzJfbHB0aW1fY250X2VuYWJsZV9yZWFkLAo+ID4gLQkJLndyaXRlID0gc3RtMzJfbHB0aW1f
Y250X2VuYWJsZV93cml0ZQo+ID4gLQl9LAo+ID4gLQl7Cj4gPiAtCQkubmFtZSA9ICJjZWlsaW5n
IiwKPiA+IC0JCS5yZWFkID0gc3RtMzJfbHB0aW1fY250X2NlaWxpbmdfcmVhZCwKPiA+IC0JCS53
cml0ZSA9IHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3dyaXRlCj4gPiAtCX0sCj4gPiArc3RhdGlj
IHN0cnVjdCBjb3VudGVyX2NvbXAgc3RtMzJfbHB0aW1fY250X2V4dFtdID0gewo+ID4gKwlDT1VO
VEVSX0NPTVBfRU5BQkxFKHN0bTMyX2xwdGltX2NudF9lbmFibGVfcmVhZCwKPiA+ICsJCQkgICAg
c3RtMzJfbHB0aW1fY250X2VuYWJsZV93cml0ZSksCj4gPiArCUNPVU5URVJfQ09NUF9DRUlMSU5H
KHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3JlYWQsCj4gPiArCQkJICAgICBzdG0zMl9scHRpbV9j
bnRfY2VpbGluZ193cml0ZSksCj4gPiAgfTsKPiA+ICAKPiA+IC1zdGF0aWMgaW50IHN0bTMyX2xw
dGltX2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0J
CQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkgICAgICBzdHJ1
Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ID4gLQkJCQkgICAgICBzaXplX3QgKmFjdGlv
bikKPiA+ICtzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gPiArCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNl
LAo+ID4gKwkJCQkgICAgICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb24pCj4g
PiAgewo+ID4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+
cHJpdjsKPiA+IC0Jc2l6ZV90IGZ1bmN0aW9uOwo+ID4gKwllbnVtIGNvdW50ZXJfZnVuY3Rpb24g
ZnVuY3Rpb247Cj4gPiAgCWludCBlcnI7Cj4gPiAgCj4gPiAtCWVyciA9IHN0bTMyX2xwdGltX2Nu
dF9mdW5jdGlvbl9nZXQoY291bnRlciwgY291bnQsICZmdW5jdGlvbik7Cj4gPiArCWVyciA9IHN0
bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+
ID4gIAlpZiAoZXJyKQo+ID4gIAkJcmV0dXJuIGVycjsKPiA+ICAKPiA+ICAJc3dpdGNoIChmdW5j
dGlvbikgewo+ID4gLQljYXNlIFNUTTMyX0xQVElNX0NPVU5URVJfSU5DUkVBU0U6Cj4gPiArCWNh
c2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKPiA+ICAJCS8qIExQIFRpbWVyIGFjdHMgYXMg
dXAtY291bnRlciBvbiBpbnB1dCAxICovCj4gPiAtCQlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9
PSBjb3VudC0+c3luYXBzZXNbMF0uc2lnbmFsLT5pZCkKPiA+IC0JCQkqYWN0aW9uID0gcHJpdi0+
cG9sYXJpdHk7Cj4gPiAtCQllbHNlCj4gPiAtCQkJKmFjdGlvbiA9IFNUTTMyX0xQVElNX1NZTkFQ
U0VfQUNUSU9OX05PTkU7Cj4gPiAtCQlyZXR1cm4gMDsKPiA+IC0JY2FzZSBTVE0zMl9MUFRJTV9F
TkNPREVSX0JPVEhfRURHRToKPiA+IC0JCSphY3Rpb24gPSBwcml2LT5wb2xhcml0eTsKPiA+ICsJ
CWlmIChzeW5hcHNlLT5zaWduYWwtPmlkICE9IGNvdW50LT5zeW5hcHNlc1swXS5zaWduYWwtPmlk
KSB7Cj4gPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiA+ICsJ
CQlyZXR1cm4gMDsKPiA+ICsJCX0KPiA+ICsKPiA+ICsJCXN3aXRjaCAocHJpdi0+cG9sYXJpdHkp
IHsKPiA+ICsJCWNhc2UgU1RNMzJfTFBUSU1fQ0tQT0xfUklTSU5HX0VER0U6Cj4gPiArCQkJKmFj
dGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gPiArCQkJcmV0dXJu
IDA7Cj4gPiArCQljYXNlIFNUTTMyX0xQVElNX0NLUE9MX0ZBTExJTkdfRURHRToKPiA+ICsJCQkq
YWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0U7Cj4gPiArCQkJcmV0
dXJuIDA7Cj4gPiArCQljYXNlIFNUTTMyX0xQVElNX0NLUE9MX0JPVEhfRURHRVM6Cj4gPiArCQkJ
KmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiA+ICsJCQlyZXR1
cm4gMDsKPiA+ICsJCWRlZmF1bHQ6Cj4gPiArCQkJLyogc2hvdWxkIG5ldmVyIHJlYWNoIHRoaXMg
cGF0aCAqLwo+ID4gKwkJCXJldHVybiAtRUlOVkFMOwo+ID4gKwkJfQo+ID4gKwljYXNlIENPVU5U
RVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiA+ICsJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gPiAgCQlyZXR1cm4gMDsKPiA+ICAJZGVmYXVsdDoKPiA+
ICAJCS8qIHNob3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGggKi8KPiA+IEBAIC0zMzMsNDMgKzMx
Niw0OCBAQCBzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJfQo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgaW50
IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiA+IC0JCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkg
ICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ID4gLQkJCQkgICAgICBzaXpl
X3QgYWN0aW9uKQo+ID4gK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2FjdGlvbl93cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCj4gPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+
ID4gKwkJCQkJZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlvbikKPiA+ICB7Cj4gPiAg
CXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4g
LQlzaXplX3QgZnVuY3Rpb247Cj4gPiArCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsK
PiA+ICAJaW50IGVycjsKPiA+ICAKPiA+ICAJaWYgKHN0bTMyX2xwdGltX2lzX2VuYWJsZWQocHJp
dikpCj4gPiAgCQlyZXR1cm4gLUVCVVNZOwo+ID4gIAo+ID4gLQllcnIgPSBzdG0zMl9scHRpbV9j
bnRfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ID4gKwllcnIgPSBz
dG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fcmVhZChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsK
PiA+ICAJaWYgKGVycikKPiA+ICAJCXJldHVybiBlcnI7Cj4gPiAgCj4gPiAgCS8qIG9ubHkgc2V0
IHBvbGFyaXR5IHdoZW4gaW4gY291bnRlciBtb2RlIChvbiBpbnB1dCAxKSAqLwo+ID4gLQlpZiAo
ZnVuY3Rpb24gPT0gU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRQo+ID4gLQkgICAgJiYgc3lu
YXBzZS0+c2lnbmFsLT5pZCA9PSBjb3VudC0+c3luYXBzZXNbMF0uc2lnbmFsLT5pZCkgewo+ID4g
LQkJc3dpdGNoIChhY3Rpb24pIHsKPiA+IC0JCWNhc2UgU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJ
T05fUklTSU5HX0VER0U6Cj4gPiAtCQljYXNlIFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0ZB
TExJTkdfRURHRToKPiA+IC0JCWNhc2UgU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUzoKPiA+IC0JCQlwcml2LT5wb2xhcml0eSA9IGFjdGlvbjsKPiA+IC0JCQlyZXR1cm4gMDsK
PiA+IC0JCX0KPiA+IC0JfQo+ID4gKwlpZiAoZnVuY3Rpb24gIT0gQ09VTlRFUl9GVU5DVElPTl9J
TkNSRUFTRQo+ID4gKwkgICAgfHwgc3luYXBzZS0+c2lnbmFsLT5pZCAhPSBjb3VudC0+c3luYXBz
ZXNbMF0uc2lnbmFsLT5pZCkKPiA+ICsJCXJldHVybiAtRUlOVkFMOwo+ID4gIAo+ID4gLQlyZXR1
cm4gLUVJTlZBTDsKPiA+ICsJc3dpdGNoIChhY3Rpb24pIHsKPiA+ICsJY2FzZSBDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOgo+ID4gKwkJcHJpdi0+cG9sYXJpdHkgPSBTVE0zMl9M
UFRJTV9DS1BPTF9SSVNJTkdfRURHRTsKPiA+ICsJCXJldHVybiAwOwo+ID4gKwljYXNlIENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOgo+ID4gKwkJcHJpdi0+cG9sYXJpdHkgPSBT
VE0zMl9MUFRJTV9DS1BPTF9GQUxMSU5HX0VER0U7Cj4gPiArCQlyZXR1cm4gMDsKPiA+ICsJY2Fz
ZSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM6Cj4gPiArCQlwcml2LT5wb2xhcml0
eSA9IFNUTTMyX0xQVElNX0NLUE9MX0JPVEhfRURHRVM7Cj4gPiArCQlyZXR1cm4gMDsKPiA+ICsJ
ZGVmYXVsdDoKPiA+ICsJCXJldHVybiAtRUlOVkFMOwo+ID4gKwl9Cj4gPiAgfQo+ID4gIAo+ID4g
IHN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgc3RtMzJfbHB0aW1fY250X29wcyA9IHsK
PiA+ICAJLmNvdW50X3JlYWQgPSBzdG0zMl9scHRpbV9jbnRfcmVhZCwKPiA+IC0JLmZ1bmN0aW9u
X2dldCA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9nZXQsCj4gPiAtCS5mdW5jdGlvbl9zZXQg
PSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0LAo+ID4gLQkuYWN0aW9uX2dldCA9IHN0bTMy
X2xwdGltX2NudF9hY3Rpb25fZ2V0LAo+ID4gLQkuYWN0aW9uX3NldCA9IHN0bTMyX2xwdGltX2Nu
dF9hY3Rpb25fc2V0LAo+ID4gKwkuZnVuY3Rpb25fcmVhZCA9IHN0bTMyX2xwdGltX2NudF9mdW5j
dGlvbl9yZWFkLAo+ID4gKwkuZnVuY3Rpb25fd3JpdGUgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rp
b25fd3JpdGUsCj4gPiArCS5hY3Rpb25fcmVhZCA9IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fcmVh
ZCwKPiA+ICsJLmFjdGlvbl93cml0ZSA9IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fd3JpdGUsCj4g
PiAgfTsKPiA+ICAKPiA+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIHN0bTMyX2xwdGlt
X2NudF9zaWduYWxzW10gPSB7Cj4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL3N0bTMy
LXRpbWVyLWNudC5jIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jCj4gPiBpbmRl
eCAxZmJjNDZmNGVlNjYuLjA1NDZlOTMyZGIwYyAxMDA2NDQKPiA+IC0tLSBhL2RyaXZlcnMvY291
bnRlci9zdG0zMi10aW1lci1jbnQuYwo+ID4gKysrIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLXRp
bWVyLWNudC5jCj4gPiBAQCAtMTMsNiArMTMsNyBAQAo+ID4gICNpbmNsdWRlIDxsaW51eC9tb2R1
bGUuaD4KPiA+ICAjaW5jbHVkZSA8bGludXgvcGluY3RybC9jb25zdW1lci5oPgo+ID4gICNpbmNs
dWRlIDxsaW51eC9wbGF0Zm9ybV9kZXZpY2UuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMu
aD4KPiA+ICAKPiA+ICAjZGVmaW5lIFRJTV9DQ01SX0NDWFMJKEJJVCg4KSB8IEJJVCgwKSkKPiA+
ICAjZGVmaW5lIFRJTV9DQ01SX01BU0sJKFRJTV9DQ01SX0NDMVMgfCBUSU1fQ0NNUl9DQzJTIHwg
XAo+ID4gQEAgLTM2LDI5ICszNywxNSBAQCBzdHJ1Y3Qgc3RtMzJfdGltZXJfY250IHsKPiA+ICAJ
c3RydWN0IHN0bTMyX3RpbWVyX3JlZ3MgYmFrOwo+ID4gIH07Cj4gPiAgCj4gPiAtLyoqCj4gPiAt
ICogZW51bSBzdG0zMl9jb3VudF9mdW5jdGlvbiAtIGVudW1lcmF0ZXMgc3RtMzIgdGltZXIgY291
bnRlciBlbmNvZGVyIG1vZGVzCj4gPiAtICogQFNUTTMyX0NPVU5UX1NMQVZFX01PREVfRElTQUJM
RUQ6IGNvdW50cyBvbiBpbnRlcm5hbCBjbG9jayB3aGVuIENFTj0xCj4gPiAtICogQFNUTTMyX0NP
VU5UX0VOQ09ERVJfTU9ERV8xOiBjb3VudHMgVEkxRlAxIGVkZ2VzLCBkZXBlbmRpbmcgb24gVEky
RlAyIGxldmVsCj4gPiAtICogQFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yOiBjb3VudHMgVEky
RlAyIGVkZ2VzLCBkZXBlbmRpbmcgb24gVEkxRlAxIGxldmVsCj4gPiAtICogQFNUTTMyX0NPVU5U
X0VOQ09ERVJfTU9ERV8zOiBjb3VudHMgb24gYm90aCBUSTFGUDEgYW5kIFRJMkZQMiBlZGdlcwo+
ID4gLSAqLwo+ID4gLWVudW0gc3RtMzJfY291bnRfZnVuY3Rpb24gewo+ID4gLQlTVE0zMl9DT1VO
VF9TTEFWRV9NT0RFX0RJU0FCTEVELAo+ID4gLQlTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMSwK
PiA+IC0JU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzIsCj4gPiAtCVNUTTMyX0NPVU5UX0VOQ09E
RVJfTU9ERV8zLAo+ID4gLX07Cj4gPiAtCj4gPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9m
dW5jdGlvbiBzdG0zMl9jb3VudF9mdW5jdGlvbnNbXSA9IHsKPiA+IC0JW1NUTTMyX0NPVU5UX1NM
QVZFX01PREVfRElTQUJMRURdID0gQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKPiA+IC0JW1NU
TTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8xXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
Ml9BLAo+ID4gLQlbU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzJdID0gQ09VTlRFUl9GVU5DVElP
Tl9RVUFEUkFUVVJFX1gyX0IsCj4gPiAtCVtTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfM10gPSBD
T1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gPiArCUNPVU5URVJfRlVOQ1RJT05fSU5D
UkVBU0UsCj4gPiArCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BLAo+ID4gKwlDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQiwKPiA+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0LAo+ID4gIH07Cj4gPiAgCj4gPiAgc3RhdGljIGludCBzdG0zMl9jb3VudF9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nICp2YWwpCj4gPiArCQkJICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2YWwpCj4gPiAgewo+ID4gIAlzdHJ1Y3Qgc3RtMzJf
dGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiA+ICAJdTMyIGNudDsKPiA+
IEBAIC03MCw4ICs1Nyw3IEBAIHN0YXRpYyBpbnQgc3RtMzJfY291bnRfcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgfQo+ID4gIAo+ID4gIHN0YXRpYyBpbnQgc3RtMzJf
Y291bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCSAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCSAgICAgY29uc3QgdW5zaWduZWQg
bG9uZyB2YWwpCj4gPiArCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIGNvbnN0
IHU2NCB2YWwpCj4gPiAgewo+ID4gIAlzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKPiA+ICAJdTMyIGNlaWxpbmc7Cj4gPiBAQCAtODMsOSArNjksOSBA
QCBzdGF0aWMgaW50IHN0bTMyX2NvdW50X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiA+ICAJcmV0dXJuIHJlZ21hcF93cml0ZShwcml2LT5yZWdtYXAsIFRJTV9DTlQsIHZh
bCk7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBpbnQgc3RtMzJfY291bnRfZnVuY3Rpb25fZ2V0
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJICAgIHNpemVfdCAqZnVuY3Rpb24pCj4gPiArc3Rh
dGljIGludCBzdG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiA+ICsJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAr
CQkJCSAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKPiA+ICB7Cj4gPiAgCXN0
cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1
MzIgc21jcjsKPiA+IEBAIC05NCw0MCArODAsNDAgQEAgc3RhdGljIGludCBzdG0zMl9jb3VudF9m
dW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gIAo+ID4gIAlz
d2l0Y2ggKHNtY3IgJiBUSU1fU01DUl9TTVMpIHsKPiA+ICAJY2FzZSBUSU1fU01DUl9TTVNfU0xB
VkVfTU9ERV9ESVNBQkxFRDoKPiA+IC0JCSpmdW5jdGlvbiA9IFNUTTMyX0NPVU5UX1NMQVZFX01P
REVfRElTQUJMRUQ7Cj4gPiArCQkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNF
Owo+ID4gIAkJcmV0dXJuIDA7Cj4gPiAgCWNhc2UgVElNX1NNQ1JfU01TX0VOQ09ERVJfTU9ERV8x
Ogo+ID4gLQkJKmZ1bmN0aW9uID0gU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzE7Cj4gPiArCQkq
ZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQTsKPiA+ICAJCXJldHVy
biAwOwo+ID4gIAljYXNlIFRJTV9TTUNSX1NNU19FTkNPREVSX01PREVfMjoKPiA+IC0JCSpmdW5j
dGlvbiA9IFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yOwo+ID4gKwkJKmZ1bmN0aW9uID0gQ09V
TlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0I7Cj4gPiAgCQlyZXR1cm4gMDsKPiA+ICAJY2Fz
ZSBUSU1fU01DUl9TTVNfRU5DT0RFUl9NT0RFXzM6Cj4gPiAtCQkqZnVuY3Rpb24gPSBTVE0zMl9D
T1VOVF9FTkNPREVSX01PREVfMzsKPiA+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YNDsKPiA+ICAJCXJldHVybiAwOwo+ID4gIAlkZWZhdWx0Ogo+ID4gIAkJcmV0
dXJuIC1FSU5WQUw7Cj4gPiAgCX0KPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIGludCBzdG0zMl9j
b3VudF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJ
CQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkgICAgc2l6ZV90IGZ1
bmN0aW9uKQo+ID4gK3N0YXRpYyBpbnQgc3RtMzJfY291bnRfZnVuY3Rpb25fd3JpdGUoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCj4gPiArCQkJCSAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlv
bikKPiA+ICB7Cj4gPiAgCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3Vu
dGVyLT5wcml2Owo+ID4gIAl1MzIgY3IxLCBzbXM7Cj4gPiAgCj4gPiAgCXN3aXRjaCAoZnVuY3Rp
b24pIHsKPiA+IC0JY2FzZSBTVE0zMl9DT1VOVF9TTEFWRV9NT0RFX0RJU0FCTEVEOgo+ID4gKwlj
YXNlIENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0U6Cj4gPiAgCQlzbXMgPSBUSU1fU01DUl9TTVNf
U0xBVkVfTU9ERV9ESVNBQkxFRDsKPiA+ICAJCWJyZWFrOwo+ID4gLQljYXNlIFNUTTMyX0NPVU5U
X0VOQ09ERVJfTU9ERV8xOgo+ID4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
Ml9BOgo+ID4gIAkJc21zID0gVElNX1NNQ1JfU01TX0VOQ09ERVJfTU9ERV8xOwo+ID4gIAkJYnJl
YWs7Cj4gPiAtCWNhc2UgU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzI6Cj4gPiArCWNhc2UgQ09V
TlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0I6Cj4gPiAgCQlzbXMgPSBUSU1fU01DUl9TTVNf
RU5DT0RFUl9NT0RFXzI7Cj4gPiAgCQlicmVhazsKPiA+IC0JY2FzZSBTVE0zMl9DT1VOVF9FTkNP
REVSX01PREVfMzoKPiA+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4g
PiAgCQlzbXMgPSBUSU1fU01DUl9TTVNfRU5DT0RFUl9NT0RFXzM7Cj4gPiAgCQlicmVhazsKPiA+
ICAJZGVmYXVsdDoKPiA+IEBAIC0xNTAsNDQgKzEzNiwzNyBAQCBzdGF0aWMgaW50IHN0bTMyX2Nv
dW50X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCXJl
dHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9kaXJl
Y3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArc3RhdGljIGlu
dCBzdG0zMl9jb3VudF9kaXJlY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gPiAgCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJ
ICAgICAgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ID4gKwkJCQkgICAgICBlbnVtIGNvdW50
ZXJfY291bnRfZGlyZWN0aW9uICpkaXJlY3Rpb24pCj4gPiAgewo+ID4gIAlzdHJ1Y3Qgc3RtMzJf
dGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiA+IC0JY29uc3QgY2hhciAq
ZGlyZWN0aW9uOwo+ID4gIAl1MzIgY3IxOwo+ID4gIAo+ID4gIAlyZWdtYXBfcmVhZChwcml2LT5y
ZWdtYXAsIFRJTV9DUjEsICZjcjEpOwo+ID4gLQlkaXJlY3Rpb24gPSAoY3IxICYgVElNX0NSMV9E
SVIpID8gImJhY2t3YXJkIiA6ICJmb3J3YXJkIjsKPiA+ICsJKmRpcmVjdGlvbiA9IChjcjEgJiBU
SU1fQ1IxX0RJUikgPyBDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9CQUNLV0FSRCA6Cj4gPiArCQlD
T1VOVEVSX0NPVU5UX0RJUkVDVElPTl9GT1JXQVJEOwo+ID4gIAo+ID4gLQlyZXR1cm4gc2NucHJp
bnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXNcbiIsIGRpcmVjdGlvbik7Cj4gPiArCXJldHVybiAwOwo+
ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9jZWlsaW5nX3JlYWQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkJc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAo+ID4gLQkJCQkJdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ID4gK3N0
YXRpYyBpbnQgc3RtMzJfY291bnRfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiA+ICsJCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICpj
ZWlsaW5nKQo+ID4gIHsKPiA+ICAJc3RydWN0IHN0bTMyX3RpbWVyX2NudCAqY29uc3QgcHJpdiA9
IGNvdW50ZXItPnByaXY7Cj4gPiAgCXUzMiBhcnI7Cj4gPiAgCj4gPiAgCXJlZ21hcF9yZWFkKHBy
aXYtPnJlZ21hcCwgVElNX0FSUiwgJmFycik7Cj4gPiAgCj4gPiAtCXJldHVybiBzbnByaW50Zihi
dWYsIFBBR0VfU0laRSwgIiV1XG4iLCBhcnIpOwo+ID4gKwkqY2VpbGluZyA9IGFycjsKPiA+ICsK
PiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2Nv
dW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJ
CQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkJCSB2b2lkICpwcml2YXRl
LAo+ID4gLQkJCQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiA+ICtzdGF0aWMgaW50
IHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ID4gKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IGNlaWxpbmcp
Cj4gPiAgewo+ID4gIAlzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRl
ci0+cHJpdjsKPiA+IC0JdW5zaWduZWQgaW50IGNlaWxpbmc7Cj4gPiAtCWludCByZXQ7Cj4gPiAt
Cj4gPiAtCXJldCA9IGtzdHJ0b3VpbnQoYnVmLCAwLCAmY2VpbGluZyk7Cj4gPiAtCWlmIChyZXQp
Cj4gPiAtCQlyZXR1cm4gcmV0Owo+ID4gIAo+ID4gIAlpZiAoY2VpbGluZyA+IHByaXYtPm1heF9h
cnIpCj4gPiAgCQlyZXR1cm4gLUVSQU5HRTsKPiA+IEBAIC0xOTYsMzQgKzE3NSwyNyBAQCBzdGF0
aWMgc3NpemVfdCBzdG0zMl9jb3VudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiA+ICAJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgVElNX0NS
MSwgVElNX0NSMV9BUlBFLCAwKTsKPiA+ICAJcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcCwgVElN
X0FSUiwgY2VpbGluZyk7Cj4gPiAgCj4gPiAtCXJldHVybiBsZW47Cj4gPiArCXJldHVybiAwOwo+
ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9lbmFibGVfcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJCSAgICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCSAgICAgICB2b2lkICpwcml2YXRlLCBjaGFyICpi
dWYpCj4gPiArc3RhdGljIGludCBzdG0zMl9jb3VudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgdTggKmVuYWJsZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0
IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gIAl1MzIgY3IxOwo+ID4gIAo+ID4gIAlyZWdtYXBf
cmVhZChwcml2LT5yZWdtYXAsIFRJTV9DUjEsICZjcjEpOwo+ID4gIAo+ID4gLQlyZXR1cm4gc2Nu
cHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJWRcbiIsIChib29sKShjcjEgJiBUSU1fQ1IxX0NFTikp
Owo+ID4gKwkqZW5hYmxlID0gY3IxICYgVElNX0NSMV9DRU47Cj4gPiArCj4gPiArCXJldHVybiAw
Owo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9lbmFibGVfd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkJc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkJdm9pZCAqcHJpdmF0ZSwKPiA+IC0JCQkJCWNvbnN0
IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiA+ICtzdGF0aWMgaW50IHN0bTMyX2NvdW50X2VuYWJs
ZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IGVuYWJsZSkKPiA+ICB7Cj4gPiAgCXN0cnVjdCBz
dG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ID4gLQlpbnQgZXJy
Owo+ID4gIAl1MzIgY3IxOwo+ID4gLQlib29sIGVuYWJsZTsKPiA+IC0KPiA+IC0JZXJyID0ga3N0
cnRvYm9vbChidWYsICZlbmFibGUpOwo+ID4gLQlpZiAoZXJyKQo+ID4gLQkJcmV0dXJuIGVycjsK
PiA+ICAKPiA+ICAJaWYgKGVuYWJsZSkgewo+ID4gIAkJcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFw
LCBUSU1fQ1IxLCAmY3IxKTsKPiA+IEBAIC0yNDIsNzAgKzIxNCw1NSBAQCBzdGF0aWMgc3NpemVf
dCBzdG0zMl9jb3VudF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ID4gIAkvKiBLZWVwIGVuYWJsZWQgc3RhdGUgdG8gcHJvcGVybHkgaGFuZGxlIGxvdyBwb3dl
ciBzdGF0ZXMgKi8KPiA+ICAJcHJpdi0+ZW5hYmxlZCA9IGVuYWJsZTsKPiA+ICAKPiA+IC0JcmV0
dXJuIGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBjb25zdCBz
dHJ1Y3QgY291bnRlcl9jb3VudF9leHQgc3RtMzJfY291bnRfZXh0W10gPSB7Cj4gPiAtCXsKPiA+
IC0JCS5uYW1lID0gImRpcmVjdGlvbiIsCj4gPiAtCQkucmVhZCA9IHN0bTMyX2NvdW50X2RpcmVj
dGlvbl9yZWFkLAo+ID4gLQl9LAo+ID4gLQl7Cj4gPiAtCQkubmFtZSA9ICJlbmFibGUiLAo+ID4g
LQkJLnJlYWQgPSBzdG0zMl9jb3VudF9lbmFibGVfcmVhZCwKPiA+IC0JCS53cml0ZSA9IHN0bTMy
X2NvdW50X2VuYWJsZV93cml0ZQo+ID4gLQl9LAo+ID4gLQl7Cj4gPiAtCQkubmFtZSA9ICJjZWls
aW5nIiwKPiA+IC0JCS5yZWFkID0gc3RtMzJfY291bnRfY2VpbGluZ19yZWFkLAo+ID4gLQkJLndy
aXRlID0gc3RtMzJfY291bnRfY2VpbGluZ193cml0ZQo+ID4gLQl9LAo+ID4gLX07Cj4gPiAtCj4g
PiAtZW51bSBzdG0zMl9zeW5hcHNlX2FjdGlvbiB7Cj4gPiAtCVNUTTMyX1NZTkFQU0VfQUNUSU9O
X05PTkUsCj4gPiAtCVNUTTMyX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMKPiA+ICtzdGF0aWMg
c3RydWN0IGNvdW50ZXJfY29tcCBzdG0zMl9jb3VudF9leHRbXSA9IHsKPiA+ICsJQ09VTlRFUl9D
T01QX0RJUkVDVElPTihzdG0zMl9jb3VudF9kaXJlY3Rpb25fcmVhZCksCj4gPiArCUNPVU5URVJf
Q09NUF9FTkFCTEUoc3RtMzJfY291bnRfZW5hYmxlX3JlYWQsIHN0bTMyX2NvdW50X2VuYWJsZV93
cml0ZSksCj4gPiArCUNPVU5URVJfQ09NUF9DRUlMSU5HKHN0bTMyX2NvdW50X2NlaWxpbmdfcmVh
ZCwKPiA+ICsJCQkgICAgIHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUpLAo+ID4gIH07Cj4gPiAg
Cj4gPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9zeW5h
cHNlX2FjdGlvbnNbXSA9IHsKPiA+IC0JW1NUTTMyX1NZTkFQU0VfQUNUSU9OX05PTkVdID0gQ09V
TlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+ID4gLQlbU1RNMzJfU1lOQVBTRV9BQ1RJT05fQk9U
SF9FREdFU10gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMKPiA+ICsJQ09VTlRF
Ul9TWU5BUFNFX0FDVElPTl9OT05FLAo+ID4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhf
RURHRVMKPiA+ICB9Owo+ID4gIAo+ID4gLXN0YXRpYyBpbnQgc3RtMzJfYWN0aW9uX2dldChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiA+IC0JCQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwK
PiA+IC0JCQkgICAgc2l6ZV90ICphY3Rpb24pCj4gPiArc3RhdGljIGludCBzdG0zMl9hY3Rpb25f
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJICAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNl
ICpzeW5hcHNlLAo+ID4gKwkJCSAgICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rp
b24pCj4gPiAgewo+ID4gLQlzaXplX3QgZnVuY3Rpb247Cj4gPiArCWVudW0gY291bnRlcl9mdW5j
dGlvbiBmdW5jdGlvbjsKPiA+ICAJaW50IGVycjsKPiA+ICAKPiA+IC0JZXJyID0gc3RtMzJfY291
bnRfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ID4gKwllcnIgPSBz
dG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ID4g
IAlpZiAoZXJyKQo+ID4gIAkJcmV0dXJuIGVycjsKPiA+ICAKPiA+ICAJc3dpdGNoIChmdW5jdGlv
bikgewo+ID4gLQljYXNlIFNUTTMyX0NPVU5UX1NMQVZFX01PREVfRElTQUJMRUQ6Cj4gPiArCWNh
c2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKPiA+ICAJCS8qIGNvdW50cyBvbiBpbnRlcm5h
bCBjbG9jayB3aGVuIENFTj0xICovCj4gPiAtCQkqYWN0aW9uID0gU1RNMzJfU1lOQVBTRV9BQ1RJ
T05fTk9ORTsKPiA+ICsJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4g
PiAgCQlyZXR1cm4gMDsKPiA+IC0JY2FzZSBTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMToKPiA+
ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQToKPiA+ICAJCS8qIGNvdW50
cyB1cC9kb3duIG9uIFRJMUZQMSBlZGdlIGRlcGVuZGluZyBvbiBUSTJGUDIgbGV2ZWwgKi8KPiA+
ICAJCWlmIChzeW5hcHNlLT5zaWduYWwtPmlkID09IGNvdW50LT5zeW5hcHNlc1swXS5zaWduYWwt
PmlkKQo+ID4gLQkJCSphY3Rpb24gPSBTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+
ID4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gPiAg
CQllbHNlCj4gPiAtCQkJKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gPiAr
CQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiA+ICAJCXJldHVybiAw
Owo+ID4gLQljYXNlIFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yOgo+ID4gKwljYXNlIENPVU5U
RVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9COgo+ID4gIAkJLyogY291bnRzIHVwL2Rvd24gb24g
VEkyRlAyIGVkZ2UgZGVwZW5kaW5nIG9uIFRJMUZQMSBsZXZlbCAqLwo+ID4gIAkJaWYgKHN5bmFw
c2UtPnNpZ25hbC0+aWQgPT0gY291bnQtPnN5bmFwc2VzWzFdLnNpZ25hbC0+aWQpCj4gPiAtCQkJ
KmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gPiArCQkJKmFjdGlv
biA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiA+ICAJCWVsc2UKPiA+IC0J
CQkqYWN0aW9uID0gU1RNMzJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiA+ICsJCQkqYWN0aW9uID0g
Q09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FOwo+ID4gIAkJcmV0dXJuIDA7Cj4gPiAtCWNhc2Ug
U1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzM6Cj4gPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9R
VUFEUkFUVVJFX1g0Ogo+ID4gIAkJLyogY291bnRzIHVwL2Rvd24gb24gYm90aCBUSTFGUDEgYW5k
IFRJMkZQMiBlZGdlcyAqLwo+ID4gLQkJKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVM7Cj4gPiArCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VE
R0VTOwo+ID4gIAkJcmV0dXJuIDA7Cj4gPiAgCWRlZmF1bHQ6Cj4gPiAgCQlyZXR1cm4gLUVJTlZB
TDsKPiA+IEBAIC0zMTUsOSArMjcyLDkgQEAgc3RhdGljIGludCBzdG0zMl9hY3Rpb25fZ2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGNv
dW50ZXJfb3BzIHN0bTMyX3RpbWVyX2NudF9vcHMgPSB7Cj4gPiAgCS5jb3VudF9yZWFkID0gc3Rt
MzJfY291bnRfcmVhZCwKPiA+ICAJLmNvdW50X3dyaXRlID0gc3RtMzJfY291bnRfd3JpdGUsCj4g
PiAtCS5mdW5jdGlvbl9nZXQgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9nZXQsCj4gPiAtCS5mdW5j
dGlvbl9zZXQgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9zZXQsCj4gPiAtCS5hY3Rpb25fZ2V0ID0g
c3RtMzJfYWN0aW9uX2dldCwKPiA+ICsJLmZ1bmN0aW9uX3JlYWQgPSBzdG0zMl9jb3VudF9mdW5j
dGlvbl9yZWFkLAo+ID4gKwkuZnVuY3Rpb25fd3JpdGUgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl93
cml0ZSwKPiA+ICsJLmFjdGlvbl9yZWFkID0gc3RtMzJfYWN0aW9uX3JlYWQsCj4gPiAgfTsKPiA+
ICAKPiA+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIHN0bTMyX3NpZ25hbHNbXSA9IHsK
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5jIGIvZHJpdmVycy9jb3Vu
dGVyL3RpLWVxZXAuYwo+ID4gaW5kZXggOTRmZTU4YmIzZWFiLi4wOTgxN2M5NTNmOWEgMTAwNjQ0
Cj4gPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5jCj4gPiArKysgYi9kcml2ZXJzL2Nv
dW50ZXIvdGktZXFlcC5jCj4gPiBAQCAtMTMsNiArMTMsNyBAQAo+ID4gICNpbmNsdWRlIDxsaW51
eC9wbGF0Zm9ybV9kZXZpY2UuaD4KPiA+ICAjaW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgo+
ID4gICNpbmNsdWRlIDxsaW51eC9yZWdtYXAuaD4KPiA+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMu
aD4KPiA+ICAKPiA+ICAvKiAzMi1iaXQgcmVnaXN0ZXJzICovCj4gPiAgI2RlZmluZSBRUE9TQ05U
CQkweDAKPiA+IEBAIC03MywxOSArNzQsMTMgQEAgZW51bSB7Cj4gPiAgfTsKPiA+ICAKPiA+ICAv
KiBQb3NpdGlvbiBDb3VudGVyIElucHV0IE1vZGVzICovCj4gPiAtZW51bSB7Cj4gPiArZW51bSB0
aV9lcWVwX2NvdW50X2Z1bmMgewo+ID4gIAlUSV9FUUVQX0NPVU5UX0ZVTkNfUVVBRF9DT1VOVCwK
PiA+ICAJVElfRVFFUF9DT1VOVF9GVU5DX0RJUl9DT1VOVCwKPiA+ICAJVElfRVFFUF9DT1VOVF9G
VU5DX1VQX0NPVU5ULAo+ID4gIAlUSV9FUUVQX0NPVU5UX0ZVTkNfRE9XTl9DT1VOVCwKPiA+ICB9
Owo+ID4gIAo+ID4gLWVudW0gewo+ID4gLQlUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVMsCj4gPiAtCVRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gPiAtCVRJX0VR
RVBfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiA+IC19Owo+ID4gLQo+ID4gIHN0cnVjdCB0aV9lcWVw
X2NudCB7Cj4gPiAgCXN0cnVjdCBjb3VudGVyX2RldmljZSBjb3VudGVyOwo+ID4gIAlzdHJ1Y3Qg
cmVnbWFwICpyZWdtYXAzMjsKPiA+IEBAIC05Myw3ICs4OCw3IEBAIHN0cnVjdCB0aV9lcWVwX2Nu
dCB7Cj4gPiAgfTsKPiA+ICAKPiA+ICBzdGF0aWMgaW50IHRpX2VxZXBfY291bnRfcmVhZChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJICAgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nICp2YWwpCj4gPiArCQkJICAgICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKPiA+ICB7Cj4gPiAgCXN0cnVjdCB0aV9lcWVw
X2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gPiAgCXUzMiBjbnQ7Cj4gPiBAQCAtMTA1LDcg
KzEwMCw3IEBAIHN0YXRpYyBpbnQgdGlfZXFlcF9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiA+ICB9Cj4gPiAgCj4gPiAgc3RhdGljIGludCB0aV9lcWVwX2NvdW50
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkgICAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nIHZhbCkKPiA+ICsJCQkgICAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgdmFsKQo+ID4gIHsKPiA+ICAJc3Ry
dWN0IHRpX2VxZXBfY250ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiA+ICAJdTMyIG1heDsKPiA+
IEBAIC0xMTcsNjQgKzExMiwxMDAgQEAgc3RhdGljIGludCB0aV9lcWVwX2NvdW50X3dyaXRlKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJcmV0dXJuIHJlZ21hcF93cml0ZShw
cml2LT5yZWdtYXAzMiwgUVBPU0NOVCwgdmFsKTsKPiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIGlu
dCB0aV9lcWVwX2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
PiAtCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90ICpmdW5jdGlvbikKPiA+
ICtzdGF0aWMgaW50IHRpX2VxZXBfZnVuY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gPiArCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJ
CSBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKQo+ID4gIHsKPiA+ICAJc3RydWN0IHRp
X2VxZXBfY250ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiA+ICAJdTMyIHFkZWNjdGw7Cj4gPiAg
Cj4gPiAgCXJlZ21hcF9yZWFkKHByaXYtPnJlZ21hcDE2LCBRREVDQ1RMLCAmcWRlY2N0bCk7Cj4g
PiAtCSpmdW5jdGlvbiA9IChxZGVjY3RsICYgUURFQ0NUTF9RU1JDKSA+PiBRREVDQ1RMX1FTUkNf
U0hJRlQ7Cj4gPiArCj4gPiArCXN3aXRjaCAoKHFkZWNjdGwgJiBRREVDQ1RMX1FTUkMpID4+IFFE
RUNDVExfUVNSQ19TSElGVCkgewo+ID4gKwljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NP
VU5UOgo+ID4gKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Owo+
ID4gKwkJYnJlYWs7Cj4gPiArCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX0RJUl9DT1VOVDoKPiA+
ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOwo+ID4gKwkJ
YnJlYWs7Cj4gPiArCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX1VQX0NPVU5UOgo+ID4gKwkJKmZ1
bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRTsKPiA+ICsJCWJyZWFrOwo+ID4gKwlj
YXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19ET1dOX0NPVU5UOgo+ID4gKwkJKmZ1bmN0aW9uID0gQ09V
TlRFUl9GVU5DVElPTl9ERUNSRUFTRTsKPiA+ICsJCWJyZWFrOwo+ID4gKwl9Cj4gPiAgCj4gPiAg
CXJldHVybiAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgaW50IHRpX2VxZXBfZnVuY3Rpb25f
c2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCBzaXplX3QgZnVuY3Rpb24pCj4gPiArc3RhdGljIGludCB0aV9lcWVw
X2Z1bmN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJ
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJCSAgZW51bSBjb3VudGVyX2Z1
bmN0aW9uIGZ1bmN0aW9uKQo+ID4gIHsKPiA+ICAJc3RydWN0IHRpX2VxZXBfY250ICpwcml2ID0g
Y291bnRlci0+cHJpdjsKPiA+ICsJZW51bSB0aV9lcWVwX2NvdW50X2Z1bmMgcXNyYzsKPiA+ICsK
PiA+ICsJc3dpdGNoIChmdW5jdGlvbikgewo+ID4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YNDoKPiA+ICsJCXFzcmMgPSBUSV9FUUVQX0NPVU5UX0ZVTkNfUVVBRF9DT1VOVDsK
PiA+ICsJCWJyZWFrOwo+ID4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9O
Ogo+ID4gKwkJcXNyYyA9IFRJX0VRRVBfQ09VTlRfRlVOQ19ESVJfQ09VTlQ7Cj4gPiArCQlicmVh
azsKPiA+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOgo+ID4gKwkJcXNyYyA9IFRJ
X0VRRVBfQ09VTlRfRlVOQ19VUF9DT1VOVDsKPiA+ICsJCWJyZWFrOwo+ID4gKwljYXNlIENPVU5U
RVJfRlVOQ1RJT05fREVDUkVBU0U6Cj4gPiArCQlxc3JjID0gVElfRVFFUF9DT1VOVF9GVU5DX0RP
V05fQ09VTlQ7Cj4gPiArCQlicmVhazsKPiA+ICsJZGVmYXVsdDoKPiA+ICsJCS8qIHNob3VsZCBu
ZXZlciByZWFjaCB0aGlzIHBhdGggKi8KPiA+ICsJCXJldHVybiAtRUlOVkFMOwo+ID4gKwl9Cj4g
PiAgCj4gPiAgCXJldHVybiByZWdtYXBfd3JpdGVfYml0cyhwcml2LT5yZWdtYXAxNiwgUURFQ0NU
TCwgUURFQ0NUTF9RU1JDLAo+ID4gLQkJCQkgZnVuY3Rpb24gPDwgUURFQ0NUTF9RU1JDX1NISUZU
KTsKPiA+ICsJCQkJIHFzcmMgPDwgUURFQ0NUTF9RU1JDX1NISUZUKTsKPiA+ICB9Cj4gPiAgCj4g
PiAtc3RhdGljIGludCB0aV9lcWVwX2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+ID4gLQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0J
CQkgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLCBzaXplX3QgKmFjdGlvbikK
PiA+ICtzdGF0aWMgaW50IHRpX2VxZXBfYWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ID4gKwkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4g
PiArCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gPiArCQkJICAg
ICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKQo+ID4gIHsKPiA+ICAJc3Ry
dWN0IHRpX2VxZXBfY250ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiA+IC0Jc2l6ZV90IGZ1bmN0
aW9uOwo+ID4gKwllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb247Cj4gPiAgCXUzMiBxZGVj
Y3RsOwo+ID4gIAlpbnQgZXJyOwo+ID4gIAo+ID4gLQllcnIgPSB0aV9lcWVwX2Z1bmN0aW9uX2dl
dChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiA+ICsJZXJyID0gdGlfZXFlcF9mdW5jdGlv
bl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ID4gIAlpZiAoZXJyKQo+ID4gIAkJ
cmV0dXJuIGVycjsKPiA+ICAKPiA+ICAJc3dpdGNoIChmdW5jdGlvbikgewo+ID4gLQljYXNlIFRJ
X0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UOgo+ID4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YNDoKPiA+ICAJCS8qIEluIHF1YWRyYXR1cmUgbW9kZSwgdGhlIHJpc2luZyBh
bmQgZmFsbGluZyBlZGdlIG9mIGJvdGgKPiA+ICAJCSAqIFFFUEEgYW5kIFFFUEIgdHJpZ2dlciBR
Q0xLLgo+ID4gIAkJICovCj4gPiAtCQkqYWN0aW9uID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9C
T1RIX0VER0VTOwo+ID4gKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUzsKPiA+ICAJCXJldHVybiAwOwo+ID4gLQljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19ESVJf
Q09VTlQ6Cj4gPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT046Cj4gPiAg
CQkvKiBJbiBkaXJlY3Rpb24tY291bnQgbW9kZSBvbmx5IHJpc2luZyBlZGdlIG9mIFFFUEEgaXMg
Y291bnRlZAo+ID4gIAkJICogYW5kIFFFUEIgZ2l2ZXMgZGlyZWN0aW9uLgo+ID4gIAkJICovCj4g
PiAgCQlzd2l0Y2ggKHN5bmFwc2UtPnNpZ25hbC0+aWQpIHsKPiA+ICAJCWNhc2UgVElfRVFFUF9T
SUdOQUxfUUVQQToKPiA+IC0JCQkqYWN0aW9uID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9SSVNJ
TkdfRURHRTsKPiA+ICsJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdf
RURHRTsKPiA+ICAJCQlyZXR1cm4gMDsKPiA+ICAJCWNhc2UgVElfRVFFUF9TSUdOQUxfUUVQQjoK
PiA+IC0JCQkqYWN0aW9uID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9OT05FOwo+ID4gKwkJCSph
Y3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gPiAgCQkJcmV0dXJuIDA7Cj4g
PiAgCQlkZWZhdWx0Ogo+ID4gIAkJCS8qIHNob3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGggKi8K
PiA+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPiA+ICAJCX0KPiA+IC0JY2FzZSBUSV9FUUVQX0NPVU5U
X0ZVTkNfVVBfQ09VTlQ6Cj4gPiAtCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX0RPV05fQ09VTlQ6
Cj4gPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKPiA+ICsJY2FzZSBDT1VOVEVS
X0ZVTkNUSU9OX0RFQ1JFQVNFOgo+ID4gIAkJLyogSW4gdXAvZG93bi1jb3VudCBtb2RlcyBvbmx5
IFFFUEEgaXMgY291bnRlZCBhbmQgUUVQQiBpcyBub3QKPiA+ICAJCSAqIHVzZWQuCj4gPiAgCQkg
Ki8KPiA+IEBAIC0xODUsMTIgKzIxNiwxMiBAQCBzdGF0aWMgaW50IHRpX2VxZXBfYWN0aW9uX2dl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAgCQkJCXJldHVybiBlcnI7Cj4g
PiAgCj4gPiAgCQkJaWYgKHFkZWNjdGwgJiBRREVDQ1RMX1hDUikKPiA+IC0JCQkJKmFjdGlvbiA9
IFRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiA+ICsJCQkJKmFjdGlvbiA9IENP
VU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiA+ICAJCQllbHNlCj4gPiAtCQkJCSph
Y3Rpb24gPSBUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ID4gKwkJCQkqYWN0
aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiA+ICAJCQlyZXR1cm4g
MDsKPiA+ICAJCWNhc2UgVElfRVFFUF9TSUdOQUxfUUVQQjoKPiA+IC0JCQkqYWN0aW9uID0gVElf
RVFFUF9TWU5BUFNFX0FDVElPTl9OT05FOwo+ID4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX05PTkU7Cj4gPiAgCQkJcmV0dXJuIDA7Cj4gPiAgCQlkZWZhdWx0Ogo+ID4gIAkJ
CS8qIHNob3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGggKi8KPiA+IEBAIC0yMDUsODIgKzIzNiw2
NyBAQCBzdGF0aWMgaW50IHRpX2VxZXBfYWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyB0aV9lcWVwX2Nv
dW50ZXJfb3BzID0gewo+ID4gIAkuY291bnRfcmVhZAk9IHRpX2VxZXBfY291bnRfcmVhZCwKPiA+
ICAJLmNvdW50X3dyaXRlCT0gdGlfZXFlcF9jb3VudF93cml0ZSwKPiA+IC0JLmZ1bmN0aW9uX2dl
dAk9IHRpX2VxZXBfZnVuY3Rpb25fZ2V0LAo+ID4gLQkuZnVuY3Rpb25fc2V0CT0gdGlfZXFlcF9m
dW5jdGlvbl9zZXQsCj4gPiAtCS5hY3Rpb25fZ2V0CT0gdGlfZXFlcF9hY3Rpb25fZ2V0LAo+ID4g
KwkuZnVuY3Rpb25fcmVhZAk9IHRpX2VxZXBfZnVuY3Rpb25fcmVhZCwKPiA+ICsJLmZ1bmN0aW9u
X3dyaXRlCT0gdGlfZXFlcF9mdW5jdGlvbl93cml0ZSwKPiA+ICsJLmFjdGlvbl9yZWFkCT0gdGlf
ZXFlcF9hY3Rpb25fcmVhZCwKPiA+ICB9Owo+ID4gIAo+ID4gLXN0YXRpYyBzc2l6ZV90IHRpX2Vx
ZXBfcG9zaXRpb25fY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiA+IC0JCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkJICAg
ICB2b2lkICpleHRfcHJpdiwgY2hhciAqYnVmKQo+ID4gK3N0YXRpYyBpbnQgdGlfZXFlcF9wb3Np
dGlvbl9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJ
CQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+ICsJCQkJCSB1NjQgKmNlaWxpbmcp
Cj4gPiAgewo+ID4gIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+
ID4gIAl1MzIgcXBvc21heDsKPiA+ICAKPiA+ICAJcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwMzIs
IFFQT1NNQVgsICZxcG9zbWF4KTsKPiA+ICAKPiA+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXVc
biIsIHFwb3NtYXgpOwo+ID4gKwkqY2VpbGluZyA9IHFwb3NtYXg7Cj4gPiArCj4gPiArCXJldHVy
biAwOwo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCB0aV9lcWVwX3Bvc2l0aW9uX2Nl
aWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkJICAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gLQkJCQkJICAgICAgdm9pZCAqZXh0
X3ByaXYsIGNvbnN0IGNoYXIgKmJ1ZiwKPiA+IC0JCQkJCSAgICAgIHNpemVfdCBsZW4pCj4gPiAr
c3RhdGljIGludCB0aV9lcWVwX3Bvc2l0aW9uX2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
Cj4gPiArCQkJCQkgIHU2NCBjZWlsaW5nKQo+ID4gIHsKPiA+ICAJc3RydWN0IHRpX2VxZXBfY250
ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiA+IC0JaW50IGVycjsKPiA+IC0JdTMyIHJlczsKPiA+
ICAKPiA+IC0JZXJyID0ga3N0cnRvdWludChidWYsIDAsICZyZXMpOwo+ID4gLQlpZiAoZXJyIDwg
MCkKPiA+IC0JCXJldHVybiBlcnI7Cj4gPiArCWlmIChjZWlsaW5nICE9ICh1MzIpY2VpbGluZykK
PiA+ICsJCXJldHVybiAtRVJBTkdFOwo+ID4gIAo+ID4gLQlyZWdtYXBfd3JpdGUocHJpdi0+cmVn
bWFwMzIsIFFQT1NNQVgsIHJlcyk7Cj4gPiArCXJlZ21hcF93cml0ZShwcml2LT5yZWdtYXAzMiwg
UVBPU01BWCwgY2VpbGluZyk7Cj4gPiAgCj4gPiAtCXJldHVybiBsZW47Cj4gPiArCXJldHVybiAw
Owo+ID4gIH0KPiA+ICAKPiA+IC1zdGF0aWMgc3NpemVfdCB0aV9lcWVwX3Bvc2l0aW9uX2VuYWJs
ZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJCSAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCQkgICAgdm9pZCAqZXh0X3ByaXYsIGNo
YXIgKmJ1ZikKPiA+ICtzdGF0aWMgaW50IHRpX2VxZXBfcG9zaXRpb25fZW5hYmxlX3JlYWQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCQkJc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LCB1OCAqZW5hYmxlKQo+ID4gIHsKPiA+ICAJc3RydWN0IHRpX2VxZXBfY250ICpw
cml2ID0gY291bnRlci0+cHJpdjsKPiA+ICAJdTMyIHFlcGN0bDsKPiA+ICAKPiA+ICAJcmVnbWFw
X3JlYWQocHJpdi0+cmVnbWFwMTYsIFFFUENUTCwgJnFlcGN0bCk7Cj4gPiAgCj4gPiAtCXJldHVy
biBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAhIShxZXBjdGwgJiBRRVBDVExfUEhFTikpOwo+ID4gKwkq
ZW5hYmxlID0gISEocWVwY3RsICYgUUVQQ1RMX1BIRU4pOwo+ID4gKwo+ID4gKwlyZXR1cm4gMDsK
PiA+ICB9Cj4gPiAgCj4gPiAtc3RhdGljIHNzaXplX3QgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkJICAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCQkgICAgIHZvaWQgKmV4dF9wcml2LCBj
b25zdCBjaGFyICpidWYsCj4gPiAtCQkJCQkgICAgIHNpemVfdCBsZW4pCj4gPiArc3RhdGljIGlu
dCB0aV9lcWVwX3Bvc2l0aW9uX2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gPiArCQkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCBlbmFibGUp
Cj4gPiAgewo+ID4gIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+
ID4gLQlpbnQgZXJyOwo+ID4gLQlib29sIHJlczsKPiA+IC0KPiA+IC0JZXJyID0ga3N0cnRvYm9v
bChidWYsICZyZXMpOwo+ID4gLQlpZiAoZXJyIDwgMCkKPiA+IC0JCXJldHVybiBlcnI7Cj4gPiAg
Cj4gPiAtCXJlZ21hcF93cml0ZV9iaXRzKHByaXYtPnJlZ21hcDE2LCBRRVBDVEwsIFFFUENUTF9Q
SEVOLCByZXMgPyAtMSA6IDApOwo+ID4gKwlyZWdtYXBfd3JpdGVfYml0cyhwcml2LT5yZWdtYXAx
NiwgUUVQQ1RMLCBRRVBDVExfUEhFTiwgZW5hYmxlID8gLTEgOiAwKTsKPiA+ICAKPiA+IC0JcmV0
dXJuIGxlbjsKPiA+ICsJcmV0dXJuIDA7Cj4gPiAgfQo+ID4gIAo+ID4gLXN0YXRpYyBzdHJ1Y3Qg
Y291bnRlcl9jb3VudF9leHQgdGlfZXFlcF9wb3NpdGlvbl9leHRbXSA9IHsKPiA+IC0Jewo+ID4g
LQkJLm5hbWUJPSAiY2VpbGluZyIsCj4gPiAtCQkucmVhZAk9IHRpX2VxZXBfcG9zaXRpb25fY2Vp
bGluZ19yZWFkLAo+ID4gLQkJLndyaXRlCT0gdGlfZXFlcF9wb3NpdGlvbl9jZWlsaW5nX3dyaXRl
LAo+ID4gLQl9LAo+ID4gLQl7Cj4gPiAtCQkubmFtZQk9ICJlbmFibGUiLAo+ID4gLQkJLnJlYWQJ
PSB0aV9lcWVwX3Bvc2l0aW9uX2VuYWJsZV9yZWFkLAo+ID4gLQkJLndyaXRlCT0gdGlfZXFlcF9w
b3NpdGlvbl9lbmFibGVfd3JpdGUsCj4gPiAtCX0sCj4gPiArc3RhdGljIHN0cnVjdCBjb3VudGVy
X2NvbXAgdGlfZXFlcF9wb3NpdGlvbl9leHRbXSA9IHsKPiA+ICsJQ09VTlRFUl9DT01QX0NFSUxJ
TkcodGlfZXFlcF9wb3NpdGlvbl9jZWlsaW5nX3JlYWQsCj4gPiArCQkJICAgICB0aV9lcWVwX3Bv
c2l0aW9uX2NlaWxpbmdfd3JpdGUpLAo+ID4gKwlDT1VOVEVSX0NPTVBfRU5BQkxFKHRpX2VxZXBf
cG9zaXRpb25fZW5hYmxlX3JlYWQsCj4gPiArCQkJICAgIHRpX2VxZXBfcG9zaXRpb25fZW5hYmxl
X3dyaXRlKSwKPiA+ICB9Owo+ID4gIAo+ID4gIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWwg
dGlfZXFlcF9zaWduYWxzW10gPSB7Cj4gPiBAQCAtMjk1LDE2ICszMTEsMTYgQEAgc3RhdGljIHN0
cnVjdCBjb3VudGVyX3NpZ25hbCB0aV9lcWVwX3NpZ25hbHNbXSA9IHsKPiA+ICB9Owo+ID4gIAo+
ID4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gdGlfZXFlcF9wb3NpdGlvbl9m
dW5jdGlvbnNbXSA9IHsKPiA+IC0JW1RJX0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UXQk9IENP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiA+IC0JW1RJX0VRRVBfQ09VTlRfRlVOQ19E
SVJfQ09VTlRdCT0gQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04sCj4gPiAtCVtUSV9F
UUVQX0NPVU5UX0ZVTkNfVVBfQ09VTlRdCT0gQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKPiA+
IC0JW1RJX0VRRVBfQ09VTlRfRlVOQ19ET1dOX0NPVU5UXQk9IENPVU5URVJfRlVOQ1RJT05fREVD
UkVBU0UsCj4gPiArCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiA+ICsJQ09VTlRF
Ul9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04sCj4gPiArCUNPVU5URVJfRlVOQ1RJT05fSU5DUkVB
U0UsCj4gPiArCUNPVU5URVJfRlVOQ1RJT05fREVDUkVBU0UsCj4gPiAgfTsKPiA+ICAKPiA+ICBz
dGF0aWMgY29uc3QgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIHRpX2VxZXBfcG9zaXRpb25f
c3luYXBzZV9hY3Rpb25zW10gPSB7Cj4gPiAtCVtUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX0JPVEhf
RURHRVNdCT0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+ID4gLQlbVElfRVFF
UF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRV0JPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJ
U0lOR19FREdFLAo+ID4gLQlbVElfRVFFUF9TWU5BUFNFX0FDVElPTl9OT05FXQkJPSBDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUywKPiA+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiA+ICsJQ09V
TlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+ID4gIH07Cj4gPiAgCj4gPiAgc3RhdGljIHN0cnVj
dCBjb3VudGVyX3N5bmFwc2UgdGlfZXFlcF9wb3NpdGlvbl9zeW5hcHNlc1tdID0gewo+ID4gZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvY291bnRlci5oIGIvaW5jbHVkZS9saW51eC9jb3VudGVy
LmgKPiA+IGluZGV4IGQxNmNlMjgxOWI0OC4uYjY5Mjc3ZjVjNGM1IDEwMDY0NAo+ID4gLS0tIGEv
aW5jbHVkZS9saW51eC9jb3VudGVyLmgKPiA+ICsrKyBiL2luY2x1ZGUvbGludXgvY291bnRlci5o
Cj4gPiBAQCAtNiw0MiArNiwxODQgQEAKPiA+ICAjaWZuZGVmIF9DT1VOVEVSX0hfCj4gPiAgI2Rl
ZmluZSBfQ09VTlRFUl9IXwo+ID4gIAo+ID4gLSNpbmNsdWRlIDxsaW51eC9jb3VudGVyX2VudW0u
aD4KPiA+ICAjaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+Cj4gPiArI2luY2x1ZGUgPGxpbnV4L2tl
cm5lbC5oPgo+ID4gICNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ID4gIAo+ID4gK3N0cnVjdCBj
b3VudGVyX2RldmljZTsKPiA+ICtzdHJ1Y3QgY291bnRlcl9jb3VudDsKPiA+ICtzdHJ1Y3QgY291
bnRlcl9zeW5hcHNlOwo+ID4gK3N0cnVjdCBjb3VudGVyX3NpZ25hbDsKPiA+ICsKPiA+ICtlbnVt
IGNvdW50ZXJfY29tcF90eXBlIHsKPiA+ICsJQ09VTlRFUl9DT01QX1U4LAo+ID4gKwlDT1VOVEVS
X0NPTVBfVTY0LAo+ID4gKwlDT1VOVEVSX0NPTVBfQk9PTCwKPiA+ICsJQ09VTlRFUl9DT01QX1NJ
R05BTF9MRVZFTCwKPiA+ICsJQ09VTlRFUl9DT01QX0ZVTkNUSU9OLAo+ID4gKwlDT1VOVEVSX0NP
TVBfU1lOQVBTRV9BQ1RJT04sCj4gPiArCUNPVU5URVJfQ09NUF9FTlVNLAo+ID4gKwlDT1VOVEVS
X0NPTVBfQ09VTlRfRElSRUNUSU9OLAo+ID4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERSwKPiA+
ICt9Owo+ID4gKwo+ID4gK2VudW0gY291bnRlcl9zY29wZSB7Cj4gPiArCUNPVU5URVJfU0NPUEVf
REVWSUNFLAo+ID4gKwlDT1VOVEVSX1NDT1BFX1NJR05BTCwKPiA+ICsJQ09VTlRFUl9TQ09QRV9D
T1VOVCwKPiA+ICt9Owo+ID4gKwo+ID4gIGVudW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gewo+
ID4gLQlDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9GT1JXQVJEID0gMCwKPiA+IC0JQ09VTlRFUl9D
T1VOVF9ESVJFQ1RJT05fQkFDS1dBUkQKPiA+ICsJQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fRk9S
V0FSRCwKPiA+ICsJQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fQkFDS1dBUkQsCj4gPiAgfTsKPiA+
IC1leHRlcm4gY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9jb3VudF9kaXJlY3Rpb25fc3RyWzJd
Owo+ID4gIAo+ID4gIGVudW0gY291bnRlcl9jb3VudF9tb2RlIHsKPiA+IC0JQ09VTlRFUl9DT1VO
VF9NT0RFX05PUk1BTCA9IDAsCj4gPiArCUNPVU5URVJfQ09VTlRfTU9ERV9OT1JNQUwsCj4gPiAg
CUNPVU5URVJfQ09VTlRfTU9ERV9SQU5HRV9MSU1JVCwKPiA+ICAJQ09VTlRFUl9DT1VOVF9NT0RF
X05PTl9SRUNZQ0xFLAo+ID4gLQlDT1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX04KPiA+ICsJQ09V
TlRFUl9DT1VOVF9NT0RFX01PRFVMT19OLAo+ID4gIH07Cj4gPiAtZXh0ZXJuIGNvbnN0IGNoYXIg
KmNvbnN0IGNvdW50ZXJfY291bnRfbW9kZV9zdHJbNF07Cj4gPiAgCj4gPiAtc3RydWN0IGNvdW50
ZXJfZGV2aWNlOwo+ID4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbDsKPiA+ICtlbnVtIGNvdW50ZXJf
ZnVuY3Rpb24gewo+ID4gKwlDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+ID4gKwlDT1VOVEVS
X0ZVTkNUSU9OX0RFQ1JFQVNFLAo+ID4gKwlDT1VOVEVSX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElP
TiwKPiA+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0EsCj4gPiArCUNPVU5URVJf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9CLAo+ID4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRV
UkVfWDJfQSwKPiA+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0IsCj4gPiArCUNP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiA+ICt9Owo+ID4gKwo+ID4gK2VudW0gY291
bnRlcl9zaWduYWxfbGV2ZWwgewo+ID4gKwlDT1VOVEVSX1NJR05BTF9MRVZFTF9MT1csCj4gPiAr
CUNPVU5URVJfU0lHTkFMX0xFVkVMX0hJR0gsCj4gPiArfTsKPiA+ICsKPiA+ICtlbnVtIGNvdW50
ZXJfc3luYXBzZV9hY3Rpb24gewo+ID4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4g
PiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gPiArCUNPVU5URVJfU1lO
QVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+ID4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVMsCj4gPiArfTsKPiA+ICAKPiA+ICAvKioKPiA+IC0gKiBzdHJ1Y3QgY291bnRlcl9z
aWduYWxfZXh0IC0gQ291bnRlciBTaWduYWwgZXh0ZW5zaW9ucwo+ID4gLSAqIEBuYW1lOglhdHRy
aWJ1dGUgbmFtZQo+ID4gLSAqIEByZWFkOglyZWFkIGNhbGxiYWNrIGZvciB0aGlzIGF0dHJpYnV0
ZTsgbWF5IGJlIE5VTEwKPiA+IC0gKiBAd3JpdGU6CXdyaXRlIGNhbGxiYWNrIGZvciB0aGlzIGF0
dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiA+IC0gKiBAcHJpdjoJZGF0YSBwcml2YXRlIHRvIHRoZSBk
cml2ZXIKPiA+ICsgKiBzdHJ1Y3QgY291bnRlcl9jb21wIC0gQ291bnRlciBjb21wb25lbnQgbm9k
ZQo+ID4gKyAqIEB0eXBlOgkJQ291bnRlciBjb21wb25lbnQgZGF0YSB0eXBlCj4gPiArICogQG5h
bWU6CQlkZXZpY2Utc3BlY2lmaWMgY29tcG9uZW50IG5hbWUKPiA+ICsgKiBAcHJpdjoJCWNvbXBv
bmVudC1yZWxldmFudCBkYXRhCj4gPiArICogQGFjdGlvbl9yZWFkCQlTeW5hcHNlIGFjdGlvbiBt
b2RlIHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mIHRoZQo+ID4gKyAqCQkJcmVzcGVj
dGl2ZSBTeW5hcHNlIGFjdGlvbiBtb2RlIHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiA+ICsg
KgkJCXRoZSBhY3Rpb24gcGFyYW1ldGVyLgo+ID4gKyAqIEBkZXZpY2VfdThfcmVhZAlEZXZpY2Ug
dTggY29tcG9uZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mIHRoZQo+ID4gKyAq
CQkJcmVzcGVjdGl2ZSBEZXZpY2UgdTggY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2
aWEKPiA+ICsgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBjb3VudF91OF9yZWFkCUNv
dW50IHU4IGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZiB0aGUKPiA+
ICsgKgkJCXJlc3BlY3RpdmUgQ291bnQgdTggY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQgYmFj
ayB2aWEKPiA+ICsgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBzaWduYWxfdThfcmVh
ZAlTaWduYWwgdTggY29tcG9uZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mIHRo
ZQo+ID4gKyAqCQkJcmVzcGVjdGl2ZSBTaWduYWwgdTggY29tcG9uZW50IHNob3VsZCBiZSBwYXNz
ZWQgYmFjayB2aWEKPiA+ICsgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBkZXZpY2Vf
dTMyX3JlYWQJRGV2aWNlIHUzMiBjb21wb25lbnQgcmVhZCBjYWxsYmFjay4gVGhlIHJlYWQgdmFs
dWUgb2YKPiA+ICsgKgkJCXRoZSByZXNwZWN0aXZlIERldmljZSB1MzIgY29tcG9uZW50IHNob3Vs
ZCBiZSBwYXNzZWQKPiA+ICsgKgkJCWJhY2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgo+ID4gKyAq
IEBjb3VudF91MzJfcmVhZAlDb3VudCB1MzIgY29tcG9uZW50IHJlYWQgY2FsbGJhY2suIFRoZSBy
ZWFkIHZhbHVlIG9mIHRoZQo+ID4gKyAqCQkJcmVzcGVjdGl2ZSBDb3VudCB1MzIgY29tcG9uZW50
IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiA+ICsgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgo+
ID4gKyAqIEBzaWduYWxfdTMyX3JlYWQJU2lnbmFsIHUzMiBjb21wb25lbnQgcmVhZCBjYWxsYmFj
ay4gVGhlIHJlYWQgdmFsdWUgb2YKPiA+ICsgKgkJCXRoZSByZXNwZWN0aXZlIFNpZ25hbCB1MzIg
Y29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQKPiA+ICsgKgkJCWJhY2sgdmlhIHRoZSB2YWwgcGFy
YW1ldGVyLgo+ID4gKyAqIEBkZXZpY2VfdTY0X3JlYWQJRGV2aWNlIHU2NCBjb21wb25lbnQgcmVh
ZCBjYWxsYmFjay4gVGhlIHJlYWQgdmFsdWUgb2YKPiA+ICsgKgkJCXRoZSByZXNwZWN0aXZlIERl
dmljZSB1NjQgY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQKPiA+ICsgKgkJCWJhY2sgdmlhIHRo
ZSB2YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBjb3VudF91NjRfcmVhZAlDb3VudCB1NjQgY29tcG9u
ZW50IHJlYWQgY2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mIHRoZQo+ID4gKyAqCQkJcmVzcGVj
dGl2ZSBDb3VudCB1NjQgY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiA+ICsg
KgkJCXRoZSB2YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBzaWduYWxfdTY0X3JlYWQJU2lnbmFsIHU2
NCBjb21wb25lbnQgcmVhZCBjYWxsYmFjay4gVGhlIHJlYWQgdmFsdWUgb2YKPiA+ICsgKgkJCXRo
ZSByZXNwZWN0aXZlIFNpZ25hbCB1NjQgY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQKPiA+ICsg
KgkJCWJhY2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBhY3Rpb25fd3JpdGUJU3lu
YXBzZSBhY3Rpb24gbW9kZSB3cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4gPiAr
ICoJCQl0aGUgcmVzcGVjdGl2ZSBTeW5hcHNlIGFjdGlvbiBtb2RlIGlzIHBhc3NlZCB2aWEgdGhl
Cj4gPiArICoJCQlhY3Rpb24gcGFyYW1ldGVyLgo+ID4gKyAqIEBkZXZpY2VfdThfd3JpdGUJRGV2
aWNlIHU4IGNvbXBvbmVudCB3cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4gPiAr
ICoJCQl0aGUgcmVzcGVjdGl2ZSBEZXZpY2UgdTggY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhl
IHZhbAo+ID4gKyAqCQkJcGFyYW1ldGVyLgo+ID4gKyAqIEBjb3VudF91OF93cml0ZQlDb3VudCB1
OCBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgo+ID4gKyAqCQkJ
dGhlIHJlc3BlY3RpdmUgQ291bnQgdTggY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlIHZhbAo+
ID4gKyAqCQkJcGFyYW1ldGVyLgo+ID4gKyAqIEBzaWduYWxfdThfd3JpdGUJU2lnbmFsIHU4IGNv
bXBvbmVudCB3cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4gPiArICoJCQl0aGUg
cmVzcGVjdGl2ZSBTaWduYWwgdTggY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlIHZhbAo+ID4g
KyAqCQkJcGFyYW1ldGVyLgo+ID4gKyAqIEBkZXZpY2VfdTMyX3dyaXRlCURldmljZSB1MzIgY29t
cG9uZW50IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiA+ICsgKgkJCXRoZSBy
ZXNwZWN0aXZlIERldmljZSB1MzIgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlCj4gPiArICoJ
CQl2YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBjb3VudF91MzJfd3JpdGUJQ291bnQgdTMyIGNvbXBv
bmVudCB3cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4gPiArICoJCQl0aGUgcmVz
cGVjdGl2ZSBDb3VudCB1MzIgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlIHZhbAo+ID4gKyAq
CQkJcGFyYW1ldGVyLgo+ID4gKyAqIEBzaWduYWxfdTMyX3dyaXRlCVNpZ25hbCB1MzIgY29tcG9u
ZW50IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiA+ICsgKgkJCXRoZSByZXNw
ZWN0aXZlIFNpZ25hbCB1MzIgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlCj4gPiArICoJCQl2
YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBkZXZpY2VfdTY0X3dyaXRlCURldmljZSB1NjQgY29tcG9u
ZW50IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiA+ICsgKgkJCXRoZSByZXNw
ZWN0aXZlIERldmljZSB1NjQgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlCj4gPiArICoJCQl2
YWwgcGFyYW1ldGVyLgo+ID4gKyAqIEBjb3VudF91NjRfd3JpdGUJQ291bnQgdTY0IGNvbXBvbmVu
dCB3cml0ZSBjYWxsYmFjay4gVGhlIHdyaXRlIHZhbHVlIG9mCj4gPiArICoJCQl0aGUgcmVzcGVj
dGl2ZSBDb3VudCB1NjQgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlIHZhbAo+ID4gKyAqCQkJ
cGFyYW1ldGVyLgo+ID4gKyAqIEBzaWduYWxfdTY0X3dyaXRlCVNpZ25hbCB1NjQgY29tcG9uZW50
IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiA+ICsgKgkJCXRoZSByZXNwZWN0
aXZlIFNpZ25hbCB1NjQgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlCj4gPiArICoJCQl2YWwg
cGFyYW1ldGVyLgo+ID4gICAqLwo+ID4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgewo+ID4g
K3N0cnVjdCBjb3VudGVyX2NvbXAgewo+ID4gKwllbnVtIGNvdW50ZXJfY29tcF90eXBlIHR5cGU7
Cj4gPiAgCWNvbnN0IGNoYXIgKm5hbWU7Cj4gPiAtCXNzaXplX3QgKCpyZWFkKShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWdu
YWwsIHZvaWQgKnByaXYsIGNoYXIgKmJ1Zik7Cj4gPiAtCXNzaXplX3QgKCp3cml0ZSkoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCSBzdHJ1Y3QgY291bnRlcl9zaWduYWwg
KnNpZ25hbCwgdm9pZCAqcHJpdiwKPiA+IC0JCQkgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVu
KTsKPiA+ICAJdm9pZCAqcHJpdjsKPiA+ICsJdW5pb24gewo+ID4gKwkJaW50ICgqYWN0aW9uX3Jl
YWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LAo+ID4gKwkJCQkgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpz
eW5hcHNlLAo+ID4gKwkJCQkgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbik7
Cj4gPiArCQlpbnQgKCpkZXZpY2VfdThfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLCB1OCAqdmFsKTsKPiA+ICsJCWludCAoKmNvdW50X3U4X3JlYWQpKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsIHU4ICp2YWwpOwo+ID4gKwkJaW50ICgqc2lnbmFsX3U4X3JlYWQpKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpz
aWduYWwsIHU4ICp2YWwpOwo+ID4gKwkJaW50ICgqZGV2aWNlX3UzMl9yZWFkKShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCSAgICAgICB1MzIgKnZhbCk7Cj4gPiArCQlp
bnQgKCpjb3VudF91MzJfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4g
KwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHUzMiAqdmFsKTsKPiA+ICsJ
CWludCAoKnNpZ25hbF91MzJfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ID4gKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHUzMiAqdmFsKTsK
PiA+ICsJCWludCAoKmRldmljZV91NjRfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ID4gKwkJCQkgICAgICAgdTY0ICp2YWwpOwo+ID4gKwkJaW50ICgqY291bnRfdTY0X3Jl
YWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCk7Cj4gPiArCQlpbnQgKCpzaWduYWxfdTY0
X3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgICAgIHN0
cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB1NjQgKnZhbCk7Cj4gPiArCX07Cj4gPiArCXVu
aW9uIHsKPiA+ICsJCWludCAoKmFjdGlvbl93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+ID4gKwkJCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ID4gKwkJ
CQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiA+ICsJCQkJICAgIGVudW0g
Y291bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rpb24pOwo+ID4gKwkJaW50ICgqZGV2aWNlX3U4X3dy
aXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHU4IHZhbCk7Cj4gPiArCQlpbnQg
KCpjb3VudF91OF93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJ
CQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IHZhbCk7Cj4gPiArCQlpbnQg
KCpzaWduYWxfdThfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJ
CQkJICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB1OCB2YWwpOwo+ID4gKwkJ
aW50ICgqZGV2aWNlX3UzMl93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ID4gKwkJCQkJdTMyIHZhbCk7Cj4gPiArCQlpbnQgKCpjb3VudF91MzJfd3JpdGUpKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwgdTMyIHZhbCk7Cj4gPiArCQlpbnQgKCpzaWduYWxfdTMyX3dyaXRlKShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9zaWdu
YWwgKnNpZ25hbCwgdTMyIHZhbCk7Cj4gPiArCQlpbnQgKCpkZXZpY2VfdTY0X3dyaXRlKShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJCQl1NjQgdmFsKTsKPiA+ICsJCWlu
dCAoKmNvdW50X3U2NF93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4g
KwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgdmFsKTsKPiA+ICsJ
CWludCAoKnNpZ25hbF91NjRfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiA+ICsJCQkJCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB1NjQgdmFsKTsKPiA+ICsJ
fTsKPiA+ICB9Owo+ID4gIAo+ID4gIC8qKgo+ID4gQEAgLTUxLDI0OCArMTkzLDUyIEBAIHN0cnVj
dCBjb3VudGVyX3NpZ25hbF9leHQgewo+ID4gICAqCQlhcyBpdCBhcHBlYXJzIGluIHRoZSBkYXRh
c2hlZXQgZG9jdW1lbnRhdGlvbgo+ID4gICAqIEBleHQ6CW9wdGlvbmFsIGFycmF5IG9mIENvdW50
ZXIgU2lnbmFsIGV4dGVuc2lvbnMKPiA+ICAgKiBAbnVtX2V4dDoJbnVtYmVyIG9mIENvdW50ZXIg
U2lnbmFsIGV4dGVuc2lvbnMgc3BlY2lmaWVkIGluIEBleHQKPiA+IC0gKiBAcHJpdjoJb3B0aW9u
YWwgcHJpdmF0ZSBkYXRhIHN1cHBsaWVkIGJ5IGRyaXZlcgo+ID4gICAqLwo+ID4gIHN0cnVjdCBj
b3VudGVyX3NpZ25hbCB7Cj4gPiAgCWludCBpZDsKPiA+ICAJY29uc3QgY2hhciAqbmFtZTsKPiA+
ICAKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCAqZXh0Owo+ID4gKwlzdHJ1
Y3QgY291bnRlcl9jb21wICpleHQ7Cj4gPiAgCXNpemVfdCBudW1fZXh0Owo+ID4gLQo+ID4gLQl2
b2lkICpwcml2Owo+ID4gLX07Cj4gPiAtCj4gPiAtLyoqCj4gPiAtICogc3RydWN0IGNvdW50ZXJf
c2lnbmFsX2VudW1fZXh0IC0gU2lnbmFsIGVudW0gZXh0ZW5zaW9uIGF0dHJpYnV0ZQo+ID4gLSAq
IEBpdGVtczoJQXJyYXkgb2Ygc3RyaW5ncwo+ID4gLSAqIEBudW1faXRlbXM6CU51bWJlciBvZiBp
dGVtcyBzcGVjaWZpZWQgaW4gQGl0ZW1zCj4gPiAtICogQHNldDoJU2V0IGNhbGxiYWNrIGZ1bmN0
aW9uOyBtYXkgYmUgTlVMTAo+ID4gLSAqIEBnZXQ6CUdldCBjYWxsYmFjayBmdW5jdGlvbjsgbWF5
IGJlIE5VTEwKPiA+IC0gKgo+ID4gLSAqIFRoZSBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCBzdHJ1
Y3R1cmUgY2FuIGJlIHVzZWQgdG8gaW1wbGVtZW50IGVudW0gc3R5bGUKPiA+IC0gKiBTaWduYWwg
ZXh0ZW5zaW9uIGF0dHJpYnV0ZXMuIEVudW0gc3R5bGUgYXR0cmlidXRlcyBhcmUgdGhvc2Ugd2hp
Y2ggaGF2ZSBhIHNldAo+ID4gLSAqIG9mIHN0cmluZ3MgdGhhdCBtYXAgdG8gdW5zaWduZWQgaW50
ZWdlciB2YWx1ZXMuIFRoZSBHZW5lcmljIENvdW50ZXIgU2lnbmFsCj4gPiAtICogZW51bSBleHRl
bnNpb24gaGVscGVyIGNvZGUgdGFrZXMgY2FyZSBvZiBtYXBwaW5nIGJldHdlZW4gdmFsdWUgYW5k
IHN0cmluZywgYXMKPiA+IC0gKiB3ZWxsIGFzIGdlbmVyYXRpbmcgYSAiX2F2YWlsYWJsZSIgZmls
ZSB3aGljaCBjb250YWlucyBhIGxpc3Qgb2YgYWxsIGF2YWlsYWJsZQo+ID4gLSAqIGl0ZW1zLiBU
aGUgZ2V0IGNhbGxiYWNrIGlzIHVzZWQgdG8gcXVlcnkgdGhlIGN1cnJlbnRseSBhY3RpdmUgaXRl
bTsgdGhlIGluZGV4Cj4gPiAtICogb2YgdGhlIGl0ZW0gd2l0aGluIHRoZSByZXNwZWN0aXZlIGl0
ZW1zIGFycmF5IGlzIHJldHVybmVkIHZpYSB0aGUgJ2l0ZW0nCj4gPiAtICogcGFyYW1ldGVyLiBU
aGUgc2V0IGNhbGxiYWNrIGlzIGNhbGxlZCB3aGVuIHRoZSBhdHRyaWJ1dGUgaXMgdXBkYXRlZDsg
dGhlCj4gPiAtICogJ2l0ZW0nIHBhcmFtZXRlciBjb250YWlucyB0aGUgaW5kZXggb2YgdGhlIG5l
d2x5IGFjdGl2YXRlZCBpdGVtIHdpdGhpbiB0aGUKPiA+IC0gKiByZXNwZWN0aXZlIGl0ZW1zIGFy
cmF5Lgo+ID4gLSAqLwo+ID4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCB7Cj4gPiAt
CWNvbnN0IGNoYXIgKiBjb25zdCAqaXRlbXM7Cj4gPiAtCXNpemVfdCBudW1faXRlbXM7Cj4gPiAt
CWludCAoKmdldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJICAgc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHNpemVfdCAqaXRlbSk7Cj4gPiAtCWludCAoKnNl
dCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJICAgc3RydWN0IGNvdW50
ZXJfc2lnbmFsICpzaWduYWwsIHNpemVfdCBpdGVtKTsKPiA+IC19Owo+ID4gLQo+ID4gLS8qKgo+
ID4gLSAqIENPVU5URVJfU0lHTkFMX0VOVU0oKSAtIEluaXRpYWxpemUgU2lnbmFsIGVudW0gZXh0
ZW5zaW9uCj4gPiAtICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZQo+ID4gLSAqIEBfZToJCVBvaW50
ZXIgdG8gYSBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCBzdHJ1Y3R1cmUKPiA+IC0gKgo+ID4gLSAq
IFRoaXMgc2hvdWxkIHVzdWFsbHkgYmUgdXNlZCB0b2dldGhlciB3aXRoIENPVU5URVJfU0lHTkFM
X0VOVU1fQVZBSUxBQkxFKCkKPiA+IC0gKi8KPiA+IC0jZGVmaW5lIENPVU5URVJfU0lHTkFMX0VO
VU0oX25hbWUsIF9lKSBcCj4gPiAteyBcCj4gPiAtCS5uYW1lID0gKF9uYW1lKSwgXAo+ID4gLQku
cmVhZCA9IGNvdW50ZXJfc2lnbmFsX2VudW1fcmVhZCwgXAo+ID4gLQkud3JpdGUgPSBjb3VudGVy
X3NpZ25hbF9lbnVtX3dyaXRlLCBcCj4gPiAtCS5wcml2ID0gKF9lKSBcCj4gPiAtfQo+ID4gLQo+
ID4gLS8qKgo+ID4gLSAqIENPVU5URVJfU0lHTkFMX0VOVU1fQVZBSUxBQkxFKCkgLSBJbml0aWFs
aXplIFNpZ25hbCBlbnVtIGF2YWlsYWJsZSBleHRlbnNpb24KPiA+IC0gKiBAX25hbWU6CUF0dHJp
YnV0ZSBuYW1lICgiX2F2YWlsYWJsZSIgd2lsbCBiZSBhcHBlbmRlZCB0byB0aGUgbmFtZSkKPiA+
IC0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRlcl9zaWduYWxfZW51bV9leHQgc3RydWN0dXJl
Cj4gPiAtICoKPiA+IC0gKiBDcmVhdGVzIGEgcmVhZCBvbmx5IGF0dHJpYnV0ZSB0aGF0IGxpc3Rz
IGFsbCB0aGUgYXZhaWxhYmxlIGVudW0gaXRlbXMgaW4gYQo+ID4gLSAqIG5ld2xpbmUgc2VwYXJh
dGVkIGxpc3QuIFRoaXMgc2hvdWxkIHVzdWFsbHkgYmUgdXNlZCB0b2dldGhlciB3aXRoCj4gPiAt
ICogQ09VTlRFUl9TSUdOQUxfRU5VTSgpCj4gPiAtICovCj4gPiAtI2RlZmluZSBDT1VOVEVSX1NJ
R05BTF9FTlVNX0FWQUlMQUJMRShfbmFtZSwgX2UpIFwKPiA+IC17IFwKPiA+IC0JLm5hbWUgPSAo
X25hbWUgIl9hdmFpbGFibGUiKSwgXAo+ID4gLQkucmVhZCA9IGNvdW50ZXJfc2lnbmFsX2VudW1f
YXZhaWxhYmxlX3JlYWQsIFwKPiA+IC0JLnByaXYgPSAoX2UpIFwKPiA+IC19Cj4gPiAtCj4gPiAt
ZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIHsKPiA+IC0JQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9OT05FID0gMCwKPiA+IC0JQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiA+
IC0JQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gPiAtCUNPVU5URVJfU1lO
QVBTRV9BQ1RJT05fQk9USF9FREdFUwo+ID4gIH07Cj4gPiAgCj4gPiAgLyoqCj4gPiAgICogc3Ry
dWN0IGNvdW50ZXJfc3luYXBzZSAtIENvdW50ZXIgU3luYXBzZSBub2RlCj4gPiAtICogQGFjdGlv
bjoJCWluZGV4IG9mIGN1cnJlbnQgYWN0aW9uIG1vZGUKPiA+ICAgKiBAYWN0aW9uc19saXN0Oglh
cnJheSBvZiBhdmFpbGFibGUgYWN0aW9uIG1vZGVzCj4gPiAgICogQG51bV9hY3Rpb25zOgludW1i
ZXIgb2YgYWN0aW9uIG1vZGVzIHNwZWNpZmllZCBpbiBAYWN0aW9uc19saXN0Cj4gPiAgICogQHNp
Z25hbDoJCXBvaW50ZXIgdG8gYXNzb2NpYXRlZCBzaWduYWwKPiA+ICAgKi8KPiA+ICBzdHJ1Y3Qg
Y291bnRlcl9zeW5hcHNlIHsKPiA+IC0Jc2l6ZV90IGFjdGlvbjsKPiA+ICAJY29uc3QgZW51bSBj
b3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb25zX2xpc3Q7Cj4gPiAgCXNpemVfdCBudW1fYWN0
aW9uczsKPiA+ICAKPiA+ICAJc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWw7Cj4gPiAgfTsK
PiA+ICAKPiA+IC1zdHJ1Y3QgY291bnRlcl9jb3VudDsKPiA+IC0KPiA+IC0vKioKPiA+IC0gKiBz
dHJ1Y3QgY291bnRlcl9jb3VudF9leHQgLSBDb3VudGVyIENvdW50IGV4dGVuc2lvbgo+ID4gLSAq
IEBuYW1lOglhdHRyaWJ1dGUgbmFtZQo+ID4gLSAqIEByZWFkOglyZWFkIGNhbGxiYWNrIGZvciB0
aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiA+IC0gKiBAd3JpdGU6CXdyaXRlIGNhbGxiYWNr
IGZvciB0aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiA+IC0gKiBAcHJpdjoJZGF0YSBwcml2
YXRlIHRvIHRoZSBkcml2ZXIKPiA+IC0gKi8KPiA+IC1zdHJ1Y3QgY291bnRlcl9jb3VudF9leHQg
ewo+ID4gLQljb25zdCBjaGFyICpuYW1lOwo+ID4gLQlzc2l6ZV90ICgqcmVhZCkoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgdm9pZCAqcHJpdiwgY2hhciAqYnVmKTsKPiA+IC0Jc3NpemVfdCAoKndyaXRlKShzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpj
b3VudCwgdm9pZCAqcHJpdiwKPiA+IC0JCQkgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKTsK
PiA+IC0Jdm9pZCAqcHJpdjsKPiA+IC19Owo+ID4gLQo+ID4gLWVudW0gY291bnRlcl9mdW5jdGlv
biB7Cj4gPiAtCUNPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UgPSAwLAo+ID4gLQlDT1VOVEVSX0ZV
TkNUSU9OX0RFQ1JFQVNFLAo+ID4gLQlDT1VOVEVSX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTiwK
PiA+IC0JQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0EsCj4gPiAtCUNPVU5URVJfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YMV9CLAo+ID4gLQlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDJfQSwKPiA+IC0JQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0IsCj4gPiAtCUNPVU5U
RVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNAo+ID4gLX07Cj4gPiAtCj4gPiAgLyoqCj4gPiAgICog
c3RydWN0IGNvdW50ZXJfY291bnQgLSBDb3VudGVyIENvdW50IG5vZGUKPiA+ICAgKiBAaWQ6CQkJ
dW5pcXVlIElEIHVzZWQgdG8gaWRlbnRpZnkgQ291bnQKPiA+ICAgKiBAbmFtZToJCWRldmljZS1z
cGVjaWZpYyBDb3VudCBuYW1lOyBpZGVhbGx5LCB0aGlzIHNob3VsZCBtYXRjaAo+ID4gICAqCQkJ
dGhlIG5hbWUgYXMgaXQgYXBwZWFycyBpbiB0aGUgZGF0YXNoZWV0IGRvY3VtZW50YXRpb24KPiA+
IC0gKiBAZnVuY3Rpb246CQlpbmRleCBvZiBjdXJyZW50IGZ1bmN0aW9uIG1vZGUKPiA+ICAgKiBA
ZnVuY3Rpb25zX2xpc3Q6CWFycmF5IGF2YWlsYWJsZSBmdW5jdGlvbiBtb2Rlcwo+ID4gICAqIEBu
dW1fZnVuY3Rpb25zOgludW1iZXIgb2YgZnVuY3Rpb24gbW9kZXMgc3BlY2lmaWVkIGluIEBmdW5j
dGlvbnNfbGlzdAo+ID4gICAqIEBzeW5hcHNlczoJCWFycmF5IG9mIHN5bmFwc2VzIGZvciBpbml0
aWFsaXphdGlvbgo+ID4gICAqIEBudW1fc3luYXBzZXM6CW51bWJlciBvZiBzeW5hcHNlcyBzcGVj
aWZpZWQgaW4gQHN5bmFwc2VzCj4gPiAgICogQGV4dDoJCW9wdGlvbmFsIGFycmF5IG9mIENvdW50
ZXIgQ291bnQgZXh0ZW5zaW9ucwo+ID4gICAqIEBudW1fZXh0OgkJbnVtYmVyIG9mIENvdW50ZXIg
Q291bnQgZXh0ZW5zaW9ucyBzcGVjaWZpZWQgaW4gQGV4dAo+ID4gLSAqIEBwcml2OgkJb3B0aW9u
YWwgcHJpdmF0ZSBkYXRhIHN1cHBsaWVkIGJ5IGRyaXZlcgo+ID4gICAqLwo+ID4gIHN0cnVjdCBj
b3VudGVyX2NvdW50IHsKPiA+ICAJaW50IGlkOwo+ID4gIAljb25zdCBjaGFyICpuYW1lOwo+ID4g
IAo+ID4gLQlzaXplX3QgZnVuY3Rpb247Cj4gPiAgCWNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlv
biAqZnVuY3Rpb25zX2xpc3Q7Cj4gPiAgCXNpemVfdCBudW1fZnVuY3Rpb25zOwo+ID4gIAo+ID4g
IAlzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlczsKPiA+ICAJc2l6ZV90IG51bV9zeW5h
cHNlczsKPiA+ICAKPiA+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0ICpleHQ7Cj4g
PiArCXN0cnVjdCBjb3VudGVyX2NvbXAgKmV4dDsKPiA+ICAJc2l6ZV90IG51bV9leHQ7Cj4gPiAt
Cj4gPiAtCXZvaWQgKnByaXY7Cj4gPiAtfTsKPiA+IC0KPiA+IC0vKioKPiA+IC0gKiBzdHJ1Y3Qg
Y291bnRlcl9jb3VudF9lbnVtX2V4dCAtIENvdW50IGVudW0gZXh0ZW5zaW9uIGF0dHJpYnV0ZQo+
ID4gLSAqIEBpdGVtczoJQXJyYXkgb2Ygc3RyaW5ncwo+ID4gLSAqIEBudW1faXRlbXM6CU51bWJl
ciBvZiBpdGVtcyBzcGVjaWZpZWQgaW4gQGl0ZW1zCj4gPiAtICogQHNldDoJU2V0IGNhbGxiYWNr
IGZ1bmN0aW9uOyBtYXkgYmUgTlVMTAo+ID4gLSAqIEBnZXQ6CUdldCBjYWxsYmFjayBmdW5jdGlv
bjsgbWF5IGJlIE5VTEwKPiA+IC0gKgo+ID4gLSAqIFRoZSBjb3VudGVyX2NvdW50X2VudW1fZXh0
IHN0cnVjdHVyZSBjYW4gYmUgdXNlZCB0byBpbXBsZW1lbnQgZW51bSBzdHlsZQo+ID4gLSAqIENv
dW50IGV4dGVuc2lvbiBhdHRyaWJ1dGVzLiBFbnVtIHN0eWxlIGF0dHJpYnV0ZXMgYXJlIHRob3Nl
IHdoaWNoIGhhdmUgYSBzZXQKPiA+IC0gKiBvZiBzdHJpbmdzIHRoYXQgbWFwIHRvIHVuc2lnbmVk
IGludGVnZXIgdmFsdWVzLiBUaGUgR2VuZXJpYyBDb3VudGVyIENvdW50Cj4gPiAtICogZW51bSBl
eHRlbnNpb24gaGVscGVyIGNvZGUgdGFrZXMgY2FyZSBvZiBtYXBwaW5nIGJldHdlZW4gdmFsdWUg
YW5kIHN0cmluZywgYXMKPiA+IC0gKiB3ZWxsIGFzIGdlbmVyYXRpbmcgYSAiX2F2YWlsYWJsZSIg
ZmlsZSB3aGljaCBjb250YWlucyBhIGxpc3Qgb2YgYWxsIGF2YWlsYWJsZQo+ID4gLSAqIGl0ZW1z
LiBUaGUgZ2V0IGNhbGxiYWNrIGlzIHVzZWQgdG8gcXVlcnkgdGhlIGN1cnJlbnRseSBhY3RpdmUg
aXRlbTsgdGhlIGluZGV4Cj4gPiAtICogb2YgdGhlIGl0ZW0gd2l0aGluIHRoZSByZXNwZWN0aXZl
IGl0ZW1zIGFycmF5IGlzIHJldHVybmVkIHZpYSB0aGUgJ2l0ZW0nCj4gPiAtICogcGFyYW1ldGVy
LiBUaGUgc2V0IGNhbGxiYWNrIGlzIGNhbGxlZCB3aGVuIHRoZSBhdHRyaWJ1dGUgaXMgdXBkYXRl
ZDsgdGhlCj4gPiAtICogJ2l0ZW0nIHBhcmFtZXRlciBjb250YWlucyB0aGUgaW5kZXggb2YgdGhl
IG5ld2x5IGFjdGl2YXRlZCBpdGVtIHdpdGhpbiB0aGUKPiA+IC0gKiByZXNwZWN0aXZlIGl0ZW1z
IGFycmF5Lgo+ID4gLSAqLwo+ID4gLXN0cnVjdCBjb3VudGVyX2NvdW50X2VudW1fZXh0IHsKPiA+
IC0JY29uc3QgY2hhciAqIGNvbnN0ICppdGVtczsKPiA+IC0Jc2l6ZV90IG51bV9pdGVtczsKPiA+
IC0JaW50ICgqZ2V0KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCSAgIHNpemVfdCAqaXRlbSk7Cj4gPiAtCWludCAoKnNl
dCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsCj4gPiAtCQkgICBzaXplX3QgaXRlbSk7Cj4gPiAtfTsKPiA+IC0KPiA+IC0vKioKPiA+
IC0gKiBDT1VOVEVSX0NPVU5UX0VOVU0oKSAtIEluaXRpYWxpemUgQ291bnQgZW51bSBleHRlbnNp
b24KPiA+IC0gKiBAX25hbWU6CUF0dHJpYnV0ZSBuYW1lCj4gPiAtICogQF9lOgkJUG9pbnRlciB0
byBhIGNvdW50ZXJfY291bnRfZW51bV9leHQgc3RydWN0dXJlCj4gPiAtICoKPiA+IC0gKiBUaGlz
IHNob3VsZCB1c3VhbGx5IGJlIHVzZWQgdG9nZXRoZXIgd2l0aCBDT1VOVEVSX0NPVU5UX0VOVU1f
QVZBSUxBQkxFKCkKPiA+IC0gKi8KPiA+IC0jZGVmaW5lIENPVU5URVJfQ09VTlRfRU5VTShfbmFt
ZSwgX2UpIFwKPiA+IC17IFwKPiA+IC0JLm5hbWUgPSAoX25hbWUpLCBcCj4gPiAtCS5yZWFkID0g
Y291bnRlcl9jb3VudF9lbnVtX3JlYWQsIFwKPiA+IC0JLndyaXRlID0gY291bnRlcl9jb3VudF9l
bnVtX3dyaXRlLCBcCj4gPiAtCS5wcml2ID0gKF9lKSBcCj4gPiAtfQo+ID4gLQo+ID4gLS8qKgo+
ID4gLSAqIENPVU5URVJfQ09VTlRfRU5VTV9BVkFJTEFCTEUoKSAtIEluaXRpYWxpemUgQ291bnQg
ZW51bSBhdmFpbGFibGUgZXh0ZW5zaW9uCj4gPiAtICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZSAo
Il9hdmFpbGFibGUiIHdpbGwgYmUgYXBwZW5kZWQgdG8gdGhlIG5hbWUpCj4gPiAtICogQF9lOgkJ
UG9pbnRlciB0byBhIGNvdW50ZXJfY291bnRfZW51bV9leHQgc3RydWN0dXJlCj4gPiAtICoKPiA+
IC0gKiBDcmVhdGVzIGEgcmVhZCBvbmx5IGF0dHJpYnV0ZSB0aGF0IGxpc3RzIGFsbCB0aGUgYXZh
aWxhYmxlIGVudW0gaXRlbXMgaW4gYQo+ID4gLSAqIG5ld2xpbmUgc2VwYXJhdGVkIGxpc3QuIFRo
aXMgc2hvdWxkIHVzdWFsbHkgYmUgdXNlZCB0b2dldGhlciB3aXRoCj4gPiAtICogQ09VTlRFUl9D
T1VOVF9FTlVNKCkKPiA+IC0gKi8KPiA+IC0jZGVmaW5lIENPVU5URVJfQ09VTlRfRU5VTV9BVkFJ
TEFCTEUoX25hbWUsIF9lKSBcCj4gPiAteyBcCj4gPiAtCS5uYW1lID0gKF9uYW1lICJfYXZhaWxh
YmxlIiksIFwKPiA+IC0JLnJlYWQgPSBjb3VudGVyX2NvdW50X2VudW1fYXZhaWxhYmxlX3JlYWQs
IFwKPiA+IC0JLnByaXYgPSAoX2UpIFwKPiA+IC19Cj4gPiAtCj4gPiAtLyoqCj4gPiAtICogc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgLSBpbnRlcm5hbCBjb250YWluZXIgZm9yIGF0
dHJpYnV0ZSBncm91cAo+ID4gLSAqIEBhdHRyX2dyb3VwOglDb3VudGVyIHN5c2ZzIGF0dHJpYnV0
ZXMgZ3JvdXAKPiA+IC0gKiBAYXR0cl9saXN0OglsaXN0IHRvIGtlZXAgdHJhY2sgb2YgY3JlYXRl
ZCBDb3VudGVyIHN5c2ZzIGF0dHJpYnV0ZXMKPiA+IC0gKiBAbnVtX2F0dHI6CW51bWJlciBvZiBD
b3VudGVyIHN5c2ZzIGF0dHJpYnV0ZXMKPiA+IC0gKi8KPiA+IC1zdHJ1Y3QgY291bnRlcl9kZXZp
Y2VfYXR0cl9ncm91cCB7Cj4gPiAtCXN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgYXR0cl9ncm91cDsK
PiA+IC0Jc3RydWN0IGxpc3RfaGVhZCBhdHRyX2xpc3Q7Cj4gPiAtCXNpemVfdCBudW1fYXR0cjsK
PiA+IC19Owo+ID4gLQo+ID4gLS8qKgo+ID4gLSAqIHN0cnVjdCBjb3VudGVyX2RldmljZV9zdGF0
ZSAtIGludGVybmFsIHN0YXRlIGNvbnRhaW5lciBmb3IgYSBDb3VudGVyIGRldmljZQo+ID4gLSAq
IEBpZDoJCQl1bmlxdWUgSUQgdXNlZCB0byBpZGVudGlmeSB0aGUgQ291bnRlcgo+ID4gLSAqIEBk
ZXY6CQlpbnRlcm5hbCBkZXZpY2Ugc3RydWN0dXJlCj4gPiAtICogQGdyb3Vwc19saXN0OglhdHRy
aWJ1dGUgZ3JvdXBzIGxpc3QgKGZvciBTaWduYWxzLCBDb3VudHMsIGFuZCBleHQpCj4gPiAtICog
QG51bV9ncm91cHM6CQludW1iZXIgb2YgYXR0cmlidXRlIGdyb3VwcyBjb250YWluZXJzCj4gPiAt
ICogQGdyb3VwczoJCUNvdW50ZXIgc3lzZnMgYXR0cmlidXRlIGdyb3VwcyAodG8gcG9wdWxhdGUg
QGRldi5ncm91cHMpCj4gPiAtICovCj4gPiAtc3RydWN0IGNvdW50ZXJfZGV2aWNlX3N0YXRlIHsK
PiA+IC0JaW50IGlkOwo+ID4gLQlzdHJ1Y3QgZGV2aWNlIGRldjsKPiA+IC0Jc3RydWN0IGNvdW50
ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmdyb3Vwc19saXN0Owo+ID4gLQlzaXplX3QgbnVtX2dyb3Vw
czsKPiA+IC0JY29uc3Qgc3RydWN0IGF0dHJpYnV0ZV9ncm91cCAqKmdyb3VwczsKPiA+IC19Owo+
ID4gLQo+ID4gLWVudW0gY291bnRlcl9zaWduYWxfbGV2ZWwgewo+ID4gLQlDT1VOVEVSX1NJR05B
TF9MRVZFTF9MT1csCj4gPiAtCUNPVU5URVJfU0lHTkFMX0xFVkVMX0hJR0gsCj4gPiAgfTsKPiA+
ICAKPiA+ICAvKioKPiA+IEBAIC0zMDYsMTE3ICsyNTIsNDcgQEAgZW51bSBjb3VudGVyX3NpZ25h
bF9sZXZlbCB7Cj4gPiAgICogQGNvdW50X3dyaXRlOglvcHRpb25hbCB3cml0ZSBjYWxsYmFjayBm
b3IgQ291bnQgYXR0cmlidXRlLiBUaGUgd3JpdGUKPiA+ICAgKgkJCXZhbHVlIGZvciB0aGUgcmVz
cGVjdGl2ZSBDb3VudCBpcyBwYXNzZWQgaW4gdmlhIHRoZSB2YWwKPiA+ICAgKgkJCXBhcmFtZXRl
ci4KPiA+IC0gKiBAZnVuY3Rpb25fZ2V0OglmdW5jdGlvbiB0byBnZXQgdGhlIGN1cnJlbnQgY291
bnQgZnVuY3Rpb24gbW9kZS4gUmV0dXJucwo+ID4gLSAqCQkJMCBvbiBzdWNjZXNzIGFuZCBuZWdh
dGl2ZSBlcnJvciBjb2RlIG9uIGVycm9yLiBUaGUgaW5kZXgKPiA+IC0gKgkJCW9mIHRoZSByZXNw
ZWN0aXZlIENvdW50J3MgcmV0dXJuZWQgZnVuY3Rpb24gbW9kZSBzaG91bGQKPiA+IC0gKgkJCWJl
IHBhc3NlZCBiYWNrIHZpYSB0aGUgZnVuY3Rpb24gcGFyYW1ldGVyLgo+ID4gLSAqIEBmdW5jdGlv
bl9zZXQ6CWZ1bmN0aW9uIHRvIHNldCB0aGUgY291bnQgZnVuY3Rpb24gbW9kZS4gZnVuY3Rpb24g
aXMgdGhlCj4gPiAtICoJCQlpbmRleCBvZiB0aGUgcmVxdWVzdGVkIGZ1bmN0aW9uIG1vZGUgZnJv
bSB0aGUgcmVzcGVjdGl2ZQo+ID4gLSAqCQkJQ291bnQncyBmdW5jdGlvbnNfbGlzdCBhcnJheS4K
PiA+IC0gKiBAYWN0aW9uX2dldDoJCWZ1bmN0aW9uIHRvIGdldCB0aGUgY3VycmVudCBhY3Rpb24g
bW9kZS4gUmV0dXJucyAwIG9uCj4gPiAtICoJCQlzdWNjZXNzIGFuZCBuZWdhdGl2ZSBlcnJvciBj
b2RlIG9uIGVycm9yLiBUaGUgaW5kZXggb2YKPiA+IC0gKgkJCXRoZSByZXNwZWN0aXZlIFN5bmFw
c2UncyByZXR1cm5lZCBhY3Rpb24gbW9kZSBzaG91bGQgYmUKPiA+IC0gKgkJCXBhc3NlZCBiYWNr
IHZpYSB0aGUgYWN0aW9uIHBhcmFtZXRlci4KPiA+IC0gKiBAYWN0aW9uX3NldDoJCWZ1bmN0aW9u
IHRvIHNldCB0aGUgYWN0aW9uIG1vZGUuIGFjdGlvbiBpcyB0aGUgaW5kZXggb2YKPiA+IC0gKgkJ
CXRoZSByZXF1ZXN0ZWQgYWN0aW9uIG1vZGUgZnJvbSB0aGUgcmVzcGVjdGl2ZSBTeW5hcHNlJ3MK
PiA+IC0gKgkJCWFjdGlvbnNfbGlzdCBhcnJheS4KPiA+ICsgKiBAZnVuY3Rpb25fcmVhZDoJcmVh
ZCBjYWxsYmFjayB0aGUgQ291bnQgZnVuY3Rpb24gbW9kZXMuIFRoZSByZWFkCj4gPiArICoJCQlm
dW5jdGlvbiBtb2RlIG9mIHRoZSByZXNwZWN0aXZlIENvdW50IHNob3VsZCBiZSBwYXNzZWQKPiA+
ICsgKgkJCWJhY2sgdmlhIHRoZSBmdW5jdGlvbiBwYXJhbWV0ZXIuCj4gPiArICogQGZ1bmN0aW9u
X3dyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3IgQ291bnQgZnVuY3Rpb24gbW9kZXMuIFRoZSBmdW5j
dGlvbgo+ID4gKyAqCQkJbW9kZSB0byB3cml0ZSBmb3IgdGhlIHJlc3BlY3RpdmUgQ291bnQgaXMg
cGFzc2VkIGluIHZpYQo+ID4gKyAqCQkJdGhlIGZ1bmN0aW9uIHBhcmFtZXRlci4KPiA+ICsgKiBA
YWN0aW9uX3JlYWQ6CXJlYWQgY2FsbGJhY2sgdGhlIFN5bmFwc2UgYWN0aW9uIG1vZGVzLiBUaGUg
cmVhZCBhY3Rpb24KPiA+ICsgKgkJCW1vZGUgb2YgdGhlIHJlc3BlY3RpdmUgU3luYXBzZSBzaG91
bGQgYmUgcGFzc2VkIGJhY2sgdmlhCj4gPiArICoJCQl0aGUgYWN0aW9uIHBhcmFtZXRlci4KPiA+
ICsgKiBAYWN0aW9uX3dyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3IgU3luYXBzZSBhY3Rpb24gbW9k
ZXMuIFRoZSBhY3Rpb24gbW9kZQo+ID4gKyAqCQkJdG8gd3JpdGUgZm9yIHRoZSByZXNwZWN0aXZl
IFN5bmFwc2UgaXMgcGFzc2VkIGluIHZpYSB0aGUKPiA+ICsgKgkJCWFjdGlvbiBwYXJhbWV0ZXIu
Cj4gPiAgICovCj4gPiAgc3RydWN0IGNvdW50ZXJfb3BzIHsKPiA+ICAJaW50ICgqc2lnbmFsX3Jl
YWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICAJCQkgICBzdHJ1Y3QgY291
bnRlcl9zaWduYWwgKnNpZ25hbCwKPiA+ICAJCQkgICBlbnVtIGNvdW50ZXJfc2lnbmFsX2xldmVs
ICpsZXZlbCk7Cj4gPiAgCWludCAoKmNvdW50X3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiA+IC0JCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQg
bG9uZyAqdmFsKTsKPiA+ICsJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2
YWx1ZSk7Cj4gPiAgCWludCAoKmNvdW50X3dyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gPiAtCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBs
b25nIHZhbCk7Cj4gPiAtCWludCAoKmZ1bmN0aW9uX2dldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ID4gLQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVf
dCAqZnVuY3Rpb24pOwo+ID4gLQlpbnQgKCpmdW5jdGlvbl9zZXQpKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiA+IC0JCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBz
aXplX3QgZnVuY3Rpb24pOwo+ID4gLQlpbnQgKCphY3Rpb25fZ2V0KShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gPiAtCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4g
PiAtCQkJICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLCBzaXplX3QgKmFjdGlvbik7
Cj4gPiAtCWludCAoKmFjdGlvbl9zZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiA+IC0JCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiA+IC0JCQkgIHN0cnVjdCBj
b3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsIHNpemVfdCBhY3Rpb24pOwo+ID4gLX07Cj4gPiAtCj4g
PiAtLyoqCj4gPiAtICogc3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4dCAtIENvdW50ZXIgZGV2aWNl
IGV4dGVuc2lvbgo+ID4gLSAqIEBuYW1lOglhdHRyaWJ1dGUgbmFtZQo+ID4gLSAqIEByZWFkOgly
ZWFkIGNhbGxiYWNrIGZvciB0aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiA+IC0gKiBAd3Jp
dGU6CXdyaXRlIGNhbGxiYWNrIGZvciB0aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiA+IC0g
KiBAcHJpdjoJZGF0YSBwcml2YXRlIHRvIHRoZSBkcml2ZXIKPiA+IC0gKi8KPiA+IC1zdHJ1Y3Qg
Y291bnRlcl9kZXZpY2VfZXh0IHsKPiA+IC0JY29uc3QgY2hhciAqbmFtZTsKPiA+IC0Jc3NpemVf
dCAoKnJlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdm9pZCAqcHJpdiwgY2hh
ciAqYnVmKTsKPiA+IC0Jc3NpemVfdCAoKndyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsIHZvaWQgKnByaXYsCj4gPiAtCQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7
Cj4gPiAtCXZvaWQgKnByaXY7Cj4gPiArCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1NjQgdmFsdWUpOwo+ID4gKwlpbnQgKCpmdW5jdGlvbl9yZWFkKShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gPiArCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
Cj4gPiArCQkJICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKTsKPiA+ICsJaW50
ICgqZnVuY3Rpb25fd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJ
CQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJICAgICAgZW51bSBj
b3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uKTsKPiA+ICsJaW50ICgqYWN0aW9uX3JlYWQpKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+ICsJCQkgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gPiArCQkJICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiA+
ICsJCQkgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbik7Cj4gPiArCWludCAo
KmFjdGlvbl93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gKwkJCSAg
ICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiArCQkJICAgIHN0cnVjdCBjb3VudGVy
X3N5bmFwc2UgKnN5bmFwc2UsCj4gPiArCQkJICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlv
biBhY3Rpb24pOwo+ID4gIH07Cj4gPiAgCj4gPiAtLyoqCj4gPiAtICogc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2VudW1fZXh0IC0gQ291bnRlciBlbnVtIGV4dGVuc2lvbiBhdHRyaWJ1dGUKPiA+IC0g
KiBAaXRlbXM6CUFycmF5IG9mIHN0cmluZ3MKPiA+IC0gKiBAbnVtX2l0ZW1zOglOdW1iZXIgb2Yg
aXRlbXMgc3BlY2lmaWVkIGluIEBpdGVtcwo+ID4gLSAqIEBzZXQ6CVNldCBjYWxsYmFjayBmdW5j
dGlvbjsgbWF5IGJlIE5VTEwKPiA+IC0gKiBAZ2V0OglHZXQgY2FsbGJhY2sgZnVuY3Rpb247IG1h
eSBiZSBOVUxMCj4gPiAtICoKPiA+IC0gKiBUaGUgY291bnRlcl9kZXZpY2VfZW51bV9leHQgc3Ry
dWN0dXJlIGNhbiBiZSB1c2VkIHRvIGltcGxlbWVudCBlbnVtIHN0eWxlCj4gPiAtICogQ291bnRl
ciBleHRlbnNpb24gYXR0cmlidXRlcy4gRW51bSBzdHlsZSBhdHRyaWJ1dGVzIGFyZSB0aG9zZSB3
aGljaCBoYXZlIGEKPiA+IC0gKiBzZXQgb2Ygc3RyaW5ncyB0aGF0IG1hcCB0byB1bnNpZ25lZCBp
bnRlZ2VyIHZhbHVlcy4gVGhlIEdlbmVyaWMgQ291bnRlciBlbnVtCj4gPiAtICogZXh0ZW5zaW9u
IGhlbHBlciBjb2RlIHRha2VzIGNhcmUgb2YgbWFwcGluZyBiZXR3ZWVuIHZhbHVlIGFuZCBzdHJp
bmcsIGFzIHdlbGwKPiA+IC0gKiBhcyBnZW5lcmF0aW5nIGEgIl9hdmFpbGFibGUiIGZpbGUgd2hp
Y2ggY29udGFpbnMgYSBsaXN0IG9mIGFsbCBhdmFpbGFibGUKPiA+IC0gKiBpdGVtcy4gVGhlIGdl
dCBjYWxsYmFjayBpcyB1c2VkIHRvIHF1ZXJ5IHRoZSBjdXJyZW50bHkgYWN0aXZlIGl0ZW07IHRo
ZSBpbmRleAo+ID4gLSAqIG9mIHRoZSBpdGVtIHdpdGhpbiB0aGUgcmVzcGVjdGl2ZSBpdGVtcyBh
cnJheSBpcyByZXR1cm5lZCB2aWEgdGhlICdpdGVtJwo+ID4gLSAqIHBhcmFtZXRlci4gVGhlIHNl
dCBjYWxsYmFjayBpcyBjYWxsZWQgd2hlbiB0aGUgYXR0cmlidXRlIGlzIHVwZGF0ZWQ7IHRoZQo+
ID4gLSAqICdpdGVtJyBwYXJhbWV0ZXIgY29udGFpbnMgdGhlIGluZGV4IG9mIHRoZSBuZXdseSBh
Y3RpdmF0ZWQgaXRlbSB3aXRoaW4gdGhlCj4gPiAtICogcmVzcGVjdGl2ZSBpdGVtcyBhcnJheS4K
PiA+IC0gKi8KPiA+IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2VfZW51bV9leHQgewo+ID4gLQljb25z
dCBjaGFyICogY29uc3QgKml0ZW1zOwo+ID4gLQlzaXplX3QgbnVtX2l0ZW1zOwo+ID4gLQlpbnQg
KCpnZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgc2l6ZV90ICppdGVtKTsKPiA+
IC0JaW50ICgqc2V0KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHNpemVfdCBpdGVt
KTsKPiA+IC19Owo+ID4gLQo+ID4gLS8qKgo+ID4gLSAqIENPVU5URVJfREVWSUNFX0VOVU0oKSAt
IEluaXRpYWxpemUgQ291bnRlciBlbnVtIGV4dGVuc2lvbgo+ID4gLSAqIEBfbmFtZToJQXR0cmli
dXRlIG5hbWUKPiA+IC0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRlcl9kZXZpY2VfZW51bV9l
eHQgc3RydWN0dXJlCj4gPiAtICoKPiA+IC0gKiBUaGlzIHNob3VsZCB1c3VhbGx5IGJlIHVzZWQg
dG9nZXRoZXIgd2l0aCBDT1VOVEVSX0RFVklDRV9FTlVNX0FWQUlMQUJMRSgpCj4gPiAtICovCj4g
PiAtI2RlZmluZSBDT1VOVEVSX0RFVklDRV9FTlVNKF9uYW1lLCBfZSkgXAo+ID4gLXsgXAo+ID4g
LQkubmFtZSA9IChfbmFtZSksIFwKPiA+IC0JLnJlYWQgPSBjb3VudGVyX2RldmljZV9lbnVtX3Jl
YWQsIFwKPiA+IC0JLndyaXRlID0gY291bnRlcl9kZXZpY2VfZW51bV93cml0ZSwgXAo+ID4gLQku
cHJpdiA9IChfZSkgXAo+ID4gLX0KPiA+IC0KPiA+IC0vKioKPiA+IC0gKiBDT1VOVEVSX0RFVklD
RV9FTlVNX0FWQUlMQUJMRSgpIC0gSW5pdGlhbGl6ZSBDb3VudGVyIGVudW0gYXZhaWxhYmxlIGV4
dGVuc2lvbgo+ID4gLSAqIEBfbmFtZToJQXR0cmlidXRlIG5hbWUgKCJfYXZhaWxhYmxlIiB3aWxs
IGJlIGFwcGVuZGVkIHRvIHRoZSBuYW1lKQo+ID4gLSAqIEBfZToJCVBvaW50ZXIgdG8gYSBjb3Vu
dGVyX2RldmljZV9lbnVtX2V4dCBzdHJ1Y3R1cmUKPiA+IC0gKgo+ID4gLSAqIENyZWF0ZXMgYSBy
ZWFkIG9ubHkgYXR0cmlidXRlIHRoYXQgbGlzdHMgYWxsIHRoZSBhdmFpbGFibGUgZW51bSBpdGVt
cyBpbiBhCj4gPiAtICogbmV3bGluZSBzZXBhcmF0ZWQgbGlzdC4gVGhpcyBzaG91bGQgdXN1YWxs
eSBiZSB1c2VkIHRvZ2V0aGVyIHdpdGgKPiA+IC0gKiBDT1VOVEVSX0RFVklDRV9FTlVNKCkKPiA+
IC0gKi8KPiA+IC0jZGVmaW5lIENPVU5URVJfREVWSUNFX0VOVU1fQVZBSUxBQkxFKF9uYW1lLCBf
ZSkgXAo+ID4gLXsgXAo+ID4gLQkubmFtZSA9IChfbmFtZSAiX2F2YWlsYWJsZSIpLCBcCj4gPiAt
CS5yZWFkID0gY291bnRlcl9kZXZpY2VfZW51bV9hdmFpbGFibGVfcmVhZCwgXAo+ID4gLQkucHJp
diA9IChfZSkgXAo+ID4gLX0KPiA+IC0KPiA+ICAvKioKPiA+ICAgKiBzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgLSBDb3VudGVyIGRhdGEgc3RydWN0dXJlCj4gPiAgICogQG5hbWU6CQluYW1lIG9mIHRo
ZSBkZXZpY2UgYXMgaXQgYXBwZWFycyBpbiB0aGUgZGF0YXNoZWV0Cj4gPiAgICogQHBhcmVudDoJ
CW9wdGlvbmFsIHBhcmVudCBkZXZpY2UgcHJvdmlkaW5nIHRoZSBjb3VudGVycwo+ID4gLSAqIEBk
ZXZpY2Vfc3RhdGU6CWludGVybmFsIGRldmljZSBzdGF0ZSBjb250YWluZXIKPiA+ICAgKiBAb3Bz
OgkJY2FsbGJhY2tzIGZyb20gZHJpdmVyCj4gPiAgICogQHNpZ25hbHM6CQlhcnJheSBvZiBTaWdu
YWxzCj4gPiAgICogQG51bV9zaWduYWxzOgludW1iZXIgb2YgU2lnbmFscyBzcGVjaWZpZWQgaW4g
QHNpZ25hbHMKPiA+IEBAIC00MjUsMTEgKzMwMSwxMSBAQCBzdHJ1Y3QgY291bnRlcl9kZXZpY2Vf
ZW51bV9leHQgewo+ID4gICAqIEBleHQ6CQlvcHRpb25hbCBhcnJheSBvZiBDb3VudGVyIGRldmlj
ZSBleHRlbnNpb25zCj4gPiAgICogQG51bV9leHQ6CQludW1iZXIgb2YgQ291bnRlciBkZXZpY2Ug
ZXh0ZW5zaW9ucyBzcGVjaWZpZWQgaW4gQGV4dAo+ID4gICAqIEBwcml2OgkJb3B0aW9uYWwgcHJp
dmF0ZSBkYXRhIHN1cHBsaWVkIGJ5IGRyaXZlcgo+ID4gKyAqIEBkZXY6CQlpbnRlcm5hbCBkZXZp
Y2Ugc3RydWN0dXJlCj4gPiAgICovCj4gPiAgc3RydWN0IGNvdW50ZXJfZGV2aWNlIHsKPiA+ICAJ
Y29uc3QgY2hhciAqbmFtZTsKPiA+ICAJc3RydWN0IGRldmljZSAqcGFyZW50Owo+ID4gLQlzdHJ1
Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgKmRldmljZV9zdGF0ZTsKPiA+ICAKPiA+ICAJY29uc3Qg
c3RydWN0IGNvdW50ZXJfb3BzICpvcHM7Cj4gPiAgCj4gPiBAQCAtNDM4LDE3ICszMTQsMTU5IEBA
IHN0cnVjdCBjb3VudGVyX2RldmljZSB7Cj4gPiAgCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dHM7Cj4gPiAgCXNpemVfdCBudW1fY291bnRzOwo+ID4gIAo+ID4gLQljb25zdCBzdHJ1Y3QgY291
bnRlcl9kZXZpY2VfZXh0ICpleHQ7Cj4gPiArCXN0cnVjdCBjb3VudGVyX2NvbXAgKmV4dDsKPiA+
ICAJc2l6ZV90IG51bV9leHQ7Cj4gPiAgCj4gPiAgCXZvaWQgKnByaXY7Cj4gPiArCj4gPiArCXN0
cnVjdCBkZXZpY2UgZGV2Owo+ID4gIH07Cj4gPiAgCj4gPiAgaW50IGNvdW50ZXJfcmVnaXN0ZXIo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKTsKPiA+ICB2b2lkIGNvdW50ZXJf
dW5yZWdpc3RlcihzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpOwo+ID4gIGlu
dCBkZXZtX2NvdW50ZXJfcmVnaXN0ZXIoc3RydWN0IGRldmljZSAqZGV2LAo+ID4gIAkJCSAgc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKTsKPiA+IC12b2lkIGRldm1fY291bnRl
cl91bnJlZ2lzdGVyKHN0cnVjdCBkZXZpY2UgKmRldiwKPiA+IC0JCQkgICAgIHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY29uc3QgY291bnRlcik7Cj4gPiArCj4gPiArI2RlZmluZSBDT1VOVEVSX0NP
TVBfREVWSUNFX1U4KF9uYW1lLCBfcmVhZCwgX3dyaXRlKSBcCj4gPiAreyBcCj4gPiArCS50eXBl
ID0gQ09VTlRFUl9DT01QX1U4LCBcCj4gPiArCS5uYW1lID0gKF9uYW1lKSwgXAo+ID4gKwkuZGV2
aWNlX3U4X3JlYWQgPSAoX3JlYWQpLCBcCj4gPiArCS5kZXZpY2VfdThfd3JpdGUgPSAoX3dyaXRl
KSwgXAo+ID4gK30KPiA+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9DT1VOVF9VOChfbmFtZSwgX3Jl
YWQsIF93cml0ZSkgXAo+ID4gK3sgXAo+ID4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9VOCwgXAo+
ID4gKwkubmFtZSA9IChfbmFtZSksIFwKPiA+ICsJLmNvdW50X3U4X3JlYWQgPSAoX3JlYWQpLCBc
Cj4gPiArCS5jb3VudF91OF93cml0ZSA9IChfd3JpdGUpLCBcCj4gPiArfQo+ID4gKyNkZWZpbmUg
Q09VTlRFUl9DT01QX1NJR05BTF9VOChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ID4gK3sgXAo+
ID4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9VOCwgXAo+ID4gKwkubmFtZSA9IChfbmFtZSksIFwK
PiA+ICsJLnNpZ25hbF91OF9yZWFkID0gKF9yZWFkKSwgXAo+ID4gKwkuc2lnbmFsX3U4X3dyaXRl
ID0gKF93cml0ZSksIFwKPiA+ICt9Cj4gPiArCj4gPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfREVW
SUNFX1U2NChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ID4gK3sgXAo+ID4gKwkudHlwZSA9IENP
VU5URVJfQ09NUF9VNjQsIFwKPiA+ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gPiArCS5kZXZpY2Vf
dTY0X3JlYWQgPSAoX3JlYWQpLCBcCj4gPiArCS5kZXZpY2VfdTY0X3dyaXRlID0gKF93cml0ZSks
IFwKPiA+ICt9Cj4gPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfQ09VTlRfVTY0KF9uYW1lLCBfcmVh
ZCwgX3dyaXRlKSBcCj4gPiAreyBcCj4gPiArCS50eXBlID0gQ09VTlRFUl9DT01QX1U2NCwgXAo+
ID4gKwkubmFtZSA9IChfbmFtZSksIFwKPiA+ICsJLmNvdW50X3U2NF9yZWFkID0gKF9yZWFkKSwg
XAo+ID4gKwkuY291bnRfdTY0X3dyaXRlID0gKF93cml0ZSksIFwKPiA+ICt9Cj4gPiArI2RlZmlu
ZSBDT1VOVEVSX0NPTVBfU0lHTkFMX1U2NChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ID4gK3sg
XAo+ID4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9VNjQsIFwKPiA+ICsJLm5hbWUgPSAoX25hbWUp
LCBcCj4gPiArCS5zaWduYWxfdTY0X3JlYWQgPSAoX3JlYWQpLCBcCj4gPiArCS5zaWduYWxfdTY0
X3dyaXRlID0gKF93cml0ZSksIFwKPiA+ICt9Cj4gPiArCj4gPiArI2RlZmluZSBDT1VOVEVSX0NP
TVBfREVWSUNFX0JPT0woX25hbWUsIF9yZWFkLCBfd3JpdGUpIFwKPiA+ICt7IFwKPiA+ICsJLnR5
cGUgPSBDT1VOVEVSX0NPTVBfQk9PTCwgXAo+ID4gKwkubmFtZSA9IChfbmFtZSksIFwKPiA+ICsJ
LmRldmljZV91OF9yZWFkID0gKF9yZWFkKSwgXAo+ID4gKwkuZGV2aWNlX3U4X3dyaXRlID0gKF93
cml0ZSksIFwKPiA+ICt9Cj4gPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfQ09VTlRfQk9PTChfbmFt
ZSwgX3JlYWQsIF93cml0ZSkgXAo+ID4gK3sgXAo+ID4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9C
T09MLCBcCj4gPiArCS5uYW1lID0gKF9uYW1lKSwgXAo+ID4gKwkuY291bnRfdThfcmVhZCA9IChf
cmVhZCksIFwKPiA+ICsJLmNvdW50X3U4X3dyaXRlID0gKF93cml0ZSksIFwKPiA+ICt9Cj4gPiAr
I2RlZmluZSBDT1VOVEVSX0NPTVBfU0lHTkFMX0JPT0woX25hbWUsIF9yZWFkLCBfd3JpdGUpIFwK
PiA+ICt7IFwKPiA+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfQk9PTCwgXAo+ID4gKwkubmFtZSA9
IChfbmFtZSksIFwKPiA+ICsJLnNpZ25hbF91OF9yZWFkID0gKF9yZWFkKSwgXAo+ID4gKwkuc2ln
bmFsX3U4X3dyaXRlID0gKF93cml0ZSksIFwKPiA+ICt9Cj4gPiArCj4gPiArc3RydWN0IGNvdW50
ZXJfYXZhaWxhYmxlIHsKPiA+ICsJdW5pb24gewo+ID4gKwkJY29uc3QgdTMyICplbnVtczsKPiA+
ICsJCWNvbnN0IGNoYXIgKmNvbnN0ICpzdHJzOwo+ID4gKwl9Owo+ID4gKwlzaXplX3QgbnVtX2l0
ZW1zOwo+ID4gK307Cj4gPiArCj4gPiArI2RlZmluZSBERUZJTkVfQ09VTlRFUl9BVkFJTEFCTEUo
X25hbWUsIF9lbnVtcykgXAo+ID4gKwlzdHJ1Y3QgY291bnRlcl9hdmFpbGFibGUgX25hbWUgPSB7
IFwKPiA+ICsJCS5lbnVtcyA9IChfZW51bXMpLCBcCj4gPiArCQkubnVtX2l0ZW1zID0gQVJSQVlf
U0laRShfZW51bXMpLCBcCj4gPiArCX0KPiA+ICsKPiA+ICsjZGVmaW5lIERFRklORV9DT1VOVEVS
X0VOVU0oX25hbWUsIF9zdHJzKSBcCj4gPiArCXN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSBfbmFt
ZSA9IHsgXAo+ID4gKwkJLnN0cnMgPSAoX3N0cnMpLCBcCj4gPiArCQkubnVtX2l0ZW1zID0gQVJS
QVlfU0laRShfc3RycyksIFwKPiA+ICsJfQo+ID4gKwo+ID4gKyNkZWZpbmUgQ09VTlRFUl9DT01Q
X0RFVklDRV9FTlVNKF9uYW1lLCBfZ2V0LCBfc2V0LCBfYXZhaWxhYmxlKSBcCj4gPiAreyBcCj4g
PiArCS50eXBlID0gQ09VTlRFUl9DT01QX0VOVU0sIFwKPiA+ICsJLm5hbWUgPSAoX25hbWUpLCBc
Cj4gPiArCS5kZXZpY2VfdTMyX3JlYWQgPSAoX2dldCksIFwKPiA+ICsJLmRldmljZV91MzJfd3Jp
dGUgPSAoX3NldCksIFwKPiA+ICsJLnByaXYgPSAmKF9hdmFpbGFibGUpLCBcCj4gPiArfQo+ID4g
KyNkZWZpbmUgQ09VTlRFUl9DT01QX0NPVU5UX0VOVU0oX25hbWUsIF9nZXQsIF9zZXQsIF9hdmFp
bGFibGUpIFwKPiA+ICt7IFwKPiA+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfRU5VTSwgXAo+ID4g
KwkubmFtZSA9IChfbmFtZSksIFwKPiA+ICsJLmNvdW50X3UzMl9yZWFkID0gKF9nZXQpLCBcCj4g
PiArCS5jb3VudF91MzJfd3JpdGUgPSAoX3NldCksIFwKPiA+ICsJLnByaXYgPSAmKF9hdmFpbGFi
bGUpLCBcCj4gPiArfQo+ID4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX1NJR05BTF9FTlVNKF9uYW1l
LCBfZ2V0LCBfc2V0LCBfYXZhaWxhYmxlKSBcCj4gPiAreyBcCj4gPiArCS50eXBlID0gQ09VTlRF
Ul9DT01QX0VOVU0sIFwKPiA+ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gPiArCS5zaWduYWxfdTMy
X3JlYWQgPSAoX2dldCksIFwKPiA+ICsJLnNpZ25hbF91MzJfd3JpdGUgPSAoX3NldCksIFwKPiA+
ICsJLnByaXYgPSAmKF9hdmFpbGFibGUpLCBcCj4gPiArfQo+ID4gKwo+ID4gKyNkZWZpbmUgQ09V
TlRFUl9DT01QX0NFSUxJTkcoX3JlYWQsIF93cml0ZSkgXAo+ID4gKwlDT1VOVEVSX0NPTVBfQ09V
TlRfVTY0KCJjZWlsaW5nIiwgX3JlYWQsIF93cml0ZSkKPiA+ICsKPiA+ICsjZGVmaW5lIENPVU5U
RVJfQ09NUF9DT1VOVF9NT0RFKF9yZWFkLCBfd3JpdGUsIF9hdmFpbGFibGUpIFwKPiA+ICt7IFwK
PiA+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERSwgXAo+ID4gKwkubmFtZSA9ICJj
b3VudF9tb2RlIiwgXAo+ID4gKwkuY291bnRfdTMyX3JlYWQgPSAoX3JlYWQpLCBcCj4gPiArCS5j
b3VudF91MzJfd3JpdGUgPSAoX3dyaXRlKSwgXAo+ID4gKwkucHJpdiA9ICYoX2F2YWlsYWJsZSks
IFwKPiA+ICt9Cj4gPiArCj4gPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfRElSRUNUSU9OKF9yZWFk
KSBcCj4gPiAreyBcCj4gPiArCS50eXBlID0gQ09VTlRFUl9DT01QX0NPVU5UX0RJUkVDVElPTiwg
XAo+ID4gKwkubmFtZSA9ICJkaXJlY3Rpb24iLCBcCj4gPiArCS5jb3VudF91MzJfcmVhZCA9IChf
cmVhZCksIFwKPiA+ICt9Cj4gPiArCj4gPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfRU5BQkxFKF9y
ZWFkLCBfd3JpdGUpIFwKPiA+ICsJQ09VTlRFUl9DT01QX0NPVU5UX0JPT0woImVuYWJsZSIsIF9y
ZWFkLCBfd3JpdGUpCj4gPiArCj4gPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfRkxPT1IoX3JlYWQs
IF93cml0ZSkgXAo+ID4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfVTY0KCJmbG9vciIsIF9yZWFkLCBf
d3JpdGUpCj4gPiArCj4gPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfUFJFU0VUKF9yZWFkLCBfd3Jp
dGUpIFwKPiA+ICsJQ09VTlRFUl9DT01QX0NPVU5UX1U2NCgicHJlc2V0IiwgX3JlYWQsIF93cml0
ZSkKPiA+ICsKPiA+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKF9yZWFkLCBf
d3JpdGUpIFwKPiA+ICsJQ09VTlRFUl9DT01QX0NPVU5UX0JPT0woInByZXNldF9lbmFibGUiLCBf
cmVhZCwgX3dyaXRlKQo+ID4gIAo+ID4gICNlbmRpZiAvKiBfQ09VTlRFUl9IXyAqLwo+ID4gZGlm
ZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmggYi9pbmNsdWRlL2xpbnV4L2Nv
dW50ZXJfZW51bS5oCj4gPiBkZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKPiA+IGluZGV4IDlmOTE3
Mjk4YTg4Zi4uMDAwMDAwMDAwMDAwCj4gPiAtLS0gYS9pbmNsdWRlL2xpbnV4L2NvdW50ZXJfZW51
bS5oCj4gPiArKysgL2Rldi9udWxsCj4gPiBAQCAtMSw0NSArMCwwIEBACj4gPiAtLyogU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8KPiA+IC0vKgo+ID4gLSAqIENvdW50ZXIgaW50
ZXJmYWNlIGVudW0gZnVuY3Rpb25zCj4gPiAtICogQ29weXJpZ2h0IChDKSAyMDE4IFdpbGxpYW0g
QnJlYXRoaXR0IEdyYXkKPiA+IC0gKi8KPiA+IC0jaWZuZGVmIF9DT1VOVEVSX0VOVU1fSF8KPiA+
IC0jZGVmaW5lIF9DT1VOVEVSX0VOVU1fSF8KPiA+IC0KPiA+IC0jaW5jbHVkZSA8bGludXgvdHlw
ZXMuaD4KPiA+IC0KPiA+IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2U7Cj4gPiAtc3RydWN0IGNvdW50
ZXJfc2lnbmFsOwo+ID4gLXN0cnVjdCBjb3VudGVyX2NvdW50Owo+ID4gLQo+ID4gLXNzaXplX3Qg
Y291bnRlcl9zaWduYWxfZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiA+IC0JCQkJIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2LAo+ID4g
LQkJCQkgY2hhciAqYnVmKTsKPiA+IC1zc2l6ZV90IGNvdW50ZXJfc2lnbmFsX2VudW1fd3JpdGUo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ID4gLQkJCQkgIHN0cnVjdCBjb3VudGVy
X3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2LAo+ID4gLQkJCQkgIGNvbnN0IGNoYXIgKmJ1Ziwg
c2l6ZV90IGxlbik7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVyX3NpZ25hbF9lbnVtX2F2YWls
YWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJCSAgIHN0
cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ID4gLQkJCQkJICAgdm9pZCAqcHJpdiwgY2hh
ciAqYnVmKTsKPiA+IC0KPiA+IC1zc2l6ZV90IGNvdW50ZXJfY291bnRfZW51bV9yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+IC0JCQkJc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB2b2lkICpwcml2LAo+ID4gLQkJCQljaGFyICpidWYpOwo+ID4gLXNzaXplX3QgY291
bnRlcl9jb3VudF9lbnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiA+
IC0JCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdiwKPiA+IC0JCQkJ
IGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVy
X2NvdW50X2VudW1fYXZhaWxhYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ID4gLQkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gPiAtCQkJCQkgIHZv
aWQgKnByaXYsIGNoYXIgKmJ1Zik7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVyX2RldmljZV9l
bnVtX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LAo+ID4g
LQkJCQkgY2hhciAqYnVmKTsKPiA+IC1zc2l6ZV90IGNvdW50ZXJfZGV2aWNlX2VudW1fd3JpdGUo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LAo+ID4gLQkJCQkgIGNv
bnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7Cj4gPiAtCj4gPiAtc3NpemVfdCBjb3VudGVyX2Rl
dmljZV9lbnVtX2F2YWlsYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiA+IC0JCQkJCSAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1Zik7Cj4gPiAtCj4gPiAtI2VuZGlmIC8q
IF9DT1VOVEVSX0VOVU1fSF8gKi8KPiA+ICAgCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpMaW51eC1zdG0zMiBtYWlsaW5nIGxpc3QKTGludXgtc3RtMzJA
c3QtbWQtbWFpbG1hbi5zdG9ybXJlcGx5LmNvbQpodHRwczovL3N0LW1kLW1haWxtYW4uc3Rvcm1y
ZXBseS5jb20vbWFpbG1hbi9saXN0aW5mby9saW51eC1zdG0zMgo=
