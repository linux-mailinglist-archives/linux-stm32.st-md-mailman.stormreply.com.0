Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id B511D3FD427
	for <lists+linux-stm32@lfdr.de>; Wed,  1 Sep 2021 09:02:50 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 5BD49C5A4F4;
	Wed,  1 Sep 2021 07:02:50 +0000 (UTC)
Received: from mx07-00178001.pphosted.com (mx07-00178001.pphosted.com
 [185.132.182.106])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id CB587C424AF
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Tue, 31 Aug 2021 13:45:34 +0000 (UTC)
Received: from pps.filterd (m0241204.ppops.net [127.0.0.1])
 by mx07-00178001.pphosted.com (8.16.1.2/8.16.0.43) with SMTP id 17V9QZk8013891;
 Tue, 31 Aug 2021 15:44:10 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=foss.st.com;
 h=subject : to : cc :
 references : from : message-id : date : mime-version : in-reply-to :
 content-type : content-transfer-encoding; s=selector1;
 bh=VhPuWuOXbHr3/QBJ6kiDuHL9UfpnvKVxpVOokgyX/Zg=;
 b=20u4iIfO9Xner0y0nPvwkWRSj06e2O58t3+Io6zVp1plFtSZHItJtqSTTa3eYMdXimUC
 HvIZ/M3z/bjMqcgNGBvgz2WTUS1fvzjJZL0U58W5QcA7pkOEQF9BQrWkdHPbYewGNh61
 /3wNtdq1p0/zXUMkENU0HTq3JuDKfjiy9zdk0cjhqTFlmjDbujD+ftAuUwu+7akEyZt8
 uNptLXdEgFKcU79BHfE3K7pFeVg0BqxIRFT8iTPO8m8ZvwwkBHogwv8JA+z0hIbXjPOy
 TkgicZOFu+8KX2XuZ5f6F6ZMQ9UdWsb/wYJxOaQp81tNU6vU+fcOl6sBewu34Jeo0D/7 hg== 
Received: from beta.dmz-eu.st.com (beta.dmz-eu.st.com [164.129.1.35])
 by mx07-00178001.pphosted.com with ESMTP id 3asc7e3dk2-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 31 Aug 2021 15:44:10 +0200
Received: from euls16034.sgp.st.com (euls16034.sgp.st.com [10.75.44.20])
 by beta.dmz-eu.st.com (STMicroelectronics) with ESMTP id 74F47100034;
 Tue, 31 Aug 2021 15:44:09 +0200 (CEST)
Received: from Webmail-eu.st.com (sfhdag2node3.st.com [10.75.127.6])
 by euls16034.sgp.st.com (STMicroelectronics) with ESMTP id 51F77241874;
 Tue, 31 Aug 2021 15:44:09 +0200 (CEST)
Received: from [10.211.11.146] (10.75.127.46) by SFHDAG2NODE3.st.com
 (10.75.127.6) with Microsoft SMTP Server (TLS) id 15.0.1497.2; Tue, 31 Aug
 2021 15:44:05 +0200
To: William Breathitt Gray <vilhelm.gray@gmail.com>, <jic23@kernel.org>
References: <cover.1630031207.git.vilhelm.gray@gmail.com>
 <c68b4a1ffb195c1a2f65e8dd5ad7b7c14e79c6ef.1630031207.git.vilhelm.gray@gmail.com>
From: Fabrice Gasnier <fabrice.gasnier@foss.st.com>
Message-ID: <fcff44a7-5ac2-a510-ee9b-85ef7e2e29ef@foss.st.com>
Date: Tue, 31 Aug 2021 15:44:04 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
 Thunderbird/68.10.0
MIME-Version: 1.0
In-Reply-To: <c68b4a1ffb195c1a2f65e8dd5ad7b7c14e79c6ef.1630031207.git.vilhelm.gray@gmail.com>
Content-Language: en-US
X-Originating-IP: [10.75.127.46]
X-ClientProxiedBy: SFHDAG2NODE2.st.com (10.75.127.5) To SFHDAG2NODE3.st.com
 (10.75.127.6)
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.182.1,Aquarius:18.0.790,Hydra:6.0.391,FMLib:17.0.607.475
 definitions=2021-08-31_05,2021-08-31_01,2020-04-07_01
X-Mailman-Approved-At: Wed, 01 Sep 2021 07:02:49 +0000
Cc: kamel.bouhara@bootlin.com, gwendal@chromium.org, david@lechnology.com,
 linux-iio@vger.kernel.org, patrick.havelange@essensium.com,
 linux-stm32@st-md-mailman.stormreply.com, alexandre.belloni@bootlin.com,
 linux-kernel@vger.kernel.org, o.rempel@pengutronix.de,
 jarkko.nikula@linux.intel.com, linux-arm-kernel@lists.infradead.org,
 mcoquelin.stm32@gmail.com, fabrice.gasnier@st.com, syednwaris@gmail.com,
 kernel@pengutronix.de, Dan Carpenter <dan.carpenter@oracle.com>,
 alexandre.torgue@st.com
Subject: Re: [Linux-stm32] [PATCH v16 03/14] counter: Internalize sysfs
 interface code
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

T24gOC8yNy8yMSA1OjQ3IEFNLCBXaWxsaWFtIEJyZWF0aGl0dCBHcmF5IHdyb3RlOgo+IFRoaXMg
aXMgYSByZWltcGxlbWVudGF0aW9uIG9mIHRoZSBHZW5lcmljIENvdW50ZXIgZHJpdmVyIGludGVy
ZmFjZS4KPiBUaGVyZSBhcmUgbm8gbW9kaWZpY2F0aW9ucyB0byB0aGUgQ291bnRlciBzdWJzeXN0
ZW0gdXNlcnNwYWNlIGludGVyZmFjZSwKPiBzbyBleGlzdGluZyB1c2Vyc3BhY2UgYXBwbGljYXRp
b25zIHNob3VsZCBjb250aW51ZSB0byBydW4gc2VhbWxlc3NseS4KPiAKPiBUaGUgcHVycG9zZSBv
ZiB0aGlzIHBhdGNoIGlzIHRvIGludGVybmFsaXplIHRoZSBzeXNmcyBpbnRlcmZhY2UgY29kZQo+
IGFtb25nIHRoZSB2YXJpb3VzIGNvdW50ZXIgZHJpdmVycyBpbnRvIGEgc2hhcmVkIG1vZHVsZS4g
Q291bnRlciBkcml2ZXJzCj4gcGFzcyBhbmQgdGFrZSBkYXRhIG5hdGl2ZWx5IChpLmUuIHU4LCB1
NjQsIGV0Yy4pIGFuZCB0aGUgc2hhcmVkIGNvdW50ZXIKPiBtb2R1bGUgaGFuZGxlcyB0aGUgdHJh
bnNsYXRpb24gYmV0d2VlbiB0aGUgc3lzZnMgaW50ZXJmYWNlIGFuZCB0aGUKPiBkZXZpY2UgZHJp
dmVycy4gVGhpcyBndWFyYW50ZWVzIGEgc3RhbmRhcmQgdXNlcnNwYWNlIGludGVyZmFjZSBmb3Ig
YWxsCj4gY291bnRlciBkcml2ZXJzLCBhbmQgaGVscHMgZ2VuZXJhbGl6ZSB0aGUgR2VuZXJpYyBD
b3VudGVyIGRyaXZlciBBQkkgaW4KPiBvcmRlciB0byBzdXBwb3J0IHRoZSBHZW5lcmljIENvdW50
ZXIgY2hyZGV2IGludGVyZmFjZSAoaW50cm9kdWNlZCBpbiBhCj4gc3Vic2VxdWVudCBwYXRjaCkg
d2l0aG91dCBzaWduaWZpY2FudCBjaGFuZ2VzIHRvIHRoZSBleGlzdGluZyBjb3VudGVyCj4gZHJp
dmVycy4KPiAKPiBOb3RlLCBDb3VudGVyIGRldmljZSByZWdpc3RyYXRpb24gaXMgdGhlIHNhbWUg
YXMgYmVmb3JlOiBkcml2ZXJzCj4gcG9wdWxhdGUgYSBzdHJ1Y3QgY291bnRlcl9kZXZpY2Ugd2l0
aCBjb21wb25lbnRzIGFuZCBjYWxsYmFja3MsIHRoZW4KPiBwYXNzIHRoZSBzdHJ1Y3R1cmUgdG8g
dGhlIGRldm1fY291bnRlcl9yZWdpc3RlciBmdW5jdGlvbi4gSG93ZXZlciwKPiB3aGF0J3MgZGlm
ZmVyZW50IG5vdyBpcyBob3cgdGhlIENvdW50ZXIgc3Vic3lzdGVtIGNvZGUgaGFuZGxlcyB0aGlz
Cj4gcmVnaXN0cmF0aW9uIGludGVybmFsbHkuCj4gCj4gV2hlcmVhcyBiZWZvcmUgY2FsbGJhY2tz
IHdvdWxkIGludGVyYWN0IGRpcmVjdGx5IHdpdGggc3lzZnMgZGF0YSwgdGhpcwo+IGludGVyYWN0
aW9uIGlzIG5vdyBhYnN0cmFjdGVkIGFuZCBpbnN0ZWFkIGNhbGxiYWNrcyBpbnRlcmFjdCB3aXRo
IG5hdGl2ZQo+IEMgZGF0YSB0eXBlcy4gVGhlIGNvdW50ZXJfY29tcCBzdHJ1Y3R1cmUgZm9ybXMg
dGhlIGJhc2lzIGZvciBDb3VudGVyCj4gZXh0ZW5zaW9ucy4KPiAKPiBUaGUgY291bnRlci1zeXNm
cy5jIGZpbGUgY29udGFpbnMgdGhlIGNvZGUgdG8gcGFyc2UgdGhyb3VnaCB0aGUKPiBjb3VudGVy
X2RldmljZSBzdHJ1Y3R1cmUgYW5kIHJlZ2lzdGVyIHRoZSByZXF1ZXN0ZWQgY29tcG9uZW50cyBh
bmQKPiBleHRlbnNpb25zLiBBdHRyaWJ1dGVzIGFyZSBjcmVhdGVkIGFuZCBwb3B1bGF0ZWQgYmFz
ZWQgb24gdHlwZSwgd2l0aAo+IHJlc3BlY3RpdmUgdHJhbnNsYXRpb24gZnVuY3Rpb25zIHRvIGhh
bmRsZSB0aGUgbWFwcGluZyBiZXR3ZWVuIHN5c2ZzIGFuZAo+IHRoZSBjb3VudGVyIGRyaXZlciBj
YWxsYmFja3MuCj4gCj4gVGhlIHRyYW5zbGF0aW9uIHBlcmZvcm1lZCBmb3IgZWFjaCBhdHRyaWJ1
dGUgaXMgc3RyYWlnaHRmb3J3YXJkOiB0aGUKPiBhdHRyaWJ1dGUgdHlwZSBhbmQgZGF0YSBpcyBw
YXJzZWQgZnJvbSB0aGUgY291bnRlcl9hdHRyaWJ1dGUgc3RydWN0dXJlLAo+IHRoZSByZXNwZWN0
aXZlIGNvdW50ZXIgZHJpdmVyIHJlYWQvd3JpdGUgY2FsbGJhY2sgaXMgY2FsbGVkLCBhbmQgc3lz
ZnMKPiBJL08gaXMgaGFuZGxlZCBiZWZvcmUgb3IgYWZ0ZXIgdGhlIGRyaXZlciByZWFkL3dyaXRl
IGZ1bmN0aW9uIGlzIGNhbGxlZC4KPiAKPiBDYzogSmFya2tvIE5pa3VsYSA8amFya2tvLm5pa3Vs
YUBsaW51eC5pbnRlbC5jb20+Cj4gQ2M6IFBhdHJpY2sgSGF2ZWxhbmdlIDxwYXRyaWNrLmhhdmVs
YW5nZUBlc3NlbnNpdW0uY29tPgo+IENjOiBLYW1lbCBCb3VoYXJhIDxrYW1lbC5ib3VoYXJhQGJv
b3RsaW4uY29tPgo+IENjOiBGYWJyaWNlIEdhc25pZXIgPGZhYnJpY2UuZ2FzbmllckBzdC5jb20+
Cj4gQ2M6IE1heGltZSBDb3F1ZWxpbiA8bWNvcXVlbGluLnN0bTMyQGdtYWlsLmNvbT4KPiBDYzog
QWxleGFuZHJlIFRvcmd1ZSA8YWxleGFuZHJlLnRvcmd1ZUBzdC5jb20+Cj4gQ2M6IERhbiBDYXJw
ZW50ZXIgPGRhbi5jYXJwZW50ZXJAb3JhY2xlLmNvbT4KPiBBY2tlZC1ieTogU3llZCBOYXl5YXIg
V2FyaXMgPHN5ZWRud2FyaXNAZ21haWwuY29tPgo+IFJldmlld2VkLWJ5OiBEYXZpZCBMZWNobmVy
IDxkYXZpZEBsZWNobm9sb2d5LmNvbT4KPiBUZXN0ZWQtYnk6IERhdmlkIExlY2huZXIgPGRhdmlk
QGxlY2hub2xvZ3kuY29tPgo+IFNpZ25lZC1vZmYtYnk6IFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkg
PHZpbGhlbG0uZ3JheUBnbWFpbC5jb20+Cj4gLS0tCj4gIE1BSU5UQUlORVJTICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB8ICAgIDEgLQo+ICBkcml2ZXJzL2NvdW50ZXIvMTA0LXF1YWQtOC5j
ICAgICAgICAgICAgfCAgNDQ5ICsrKy0tLS0KPiAgZHJpdmVycy9jb3VudGVyL01ha2VmaWxlICAg
ICAgICAgICAgICAgIHwgICAgMSArCj4gIGRyaXZlcnMvY291bnRlci9jb3VudGVyLWNvcmUuYyAg
ICAgICAgICB8ICAxNDIgKysrCj4gIGRyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmMgICAg
ICAgICB8ICA4NDkgKysrKysrKysrKysrKwo+ICBkcml2ZXJzL2NvdW50ZXIvY291bnRlci1zeXNm
cy5oICAgICAgICAgfCAgIDEzICsKPiAgZHJpdmVycy9jb3VudGVyL2NvdW50ZXIuYyAgICAgICAg
ICAgICAgIHwgMTQ5NiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo+ICBkcml2ZXJzL2NvdW50ZXIv
ZnRtLXF1YWRkZWMuYyAgICAgICAgICAgfCAgIDYwICstCj4gIGRyaXZlcnMvY291bnRlci9pbnRl
bC1xZXAuYyAgICAgICAgICAgICB8ICAxNDQgKy0tCj4gIGRyaXZlcnMvY291bnRlci9pbnRlcnJ1
cHQtY250LmMgICAgICAgICB8ICAgNjIgKy0KPiAgZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10
Y2ItY2FwdHVyZS5jIHwgICA5MSArLQo+ICBkcml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1j
bnQuYyAgICAgfCAgMjEyICsrLS0KPiAgZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5j
ICAgICAgIHwgIDE3OSArKy0KPiAgZHJpdmVycy9jb3VudGVyL3RpLWVxZXAuYyAgICAgICAgICAg
ICAgIHwgIDE4MCArLS0KPiAgaW5jbHVkZS9saW51eC9jb3VudGVyLmggICAgICAgICAgICAgICAg
IHwgIDY1OCArKysrKy0tLS0tCj4gIGluY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmggICAgICAg
ICAgICB8ICAgNDUgLQo+ICAxNiBmaWxlcyBjaGFuZ2VkLCAxOTQ5IGluc2VydGlvbnMoKyksIDI2
MzMgZGVsZXRpb25zKC0pCj4gIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2NvdW50ZXIvY291
bnRlci1jb3JlLmMKPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVy
LXN5c2ZzLmMKPiAgY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLXN5
c2ZzLmgKPiAgZGVsZXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLmMKPiAg
ZGVsZXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmgKPiAKCkhpIFdp
bGxpYW0sCgpGb3IgdGhlIFNUTTMyIGRyaXZlcnMsIHlvdSBjYW4gYWRkIG15OgpSZXZpZXdlZC1i
eTogRmFicmljZSBHYXNuaWVyIDxmYWJyaWNlLmdhc25pZXJAZm9zcy5zdC5jb20+CgpUaGFua3Ms
CkZhYnJpY2UKCgoKPiBkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMgYi9NQUlOVEFJTkVSUwo+IGlu
ZGV4IDIxMmJhZDg1ZTA3YS4uYjBjZGI5YWFjYTg1IDEwMDY0NAo+IC0tLSBhL01BSU5UQUlORVJT
Cj4gKysrIGIvTUFJTlRBSU5FUlMKPiBAQCAtNDc4MSw3ICs0NzgxLDYgQEAgRjoJRG9jdW1lbnRh
dGlvbi9BQkkvdGVzdGluZy9zeXNmcy1idXMtY291bnRlcgo+ICBGOglEb2N1bWVudGF0aW9uL2Ry
aXZlci1hcGkvZ2VuZXJpYy1jb3VudGVyLnJzdAo+ICBGOglkcml2ZXJzL2NvdW50ZXIvCj4gIEY6
CWluY2x1ZGUvbGludXgvY291bnRlci5oCj4gLUY6CWluY2x1ZGUvbGludXgvY291bnRlcl9lbnVt
LmgKPiAgCj4gIENQMjYxNSBJMkMgRFJJVkVSCj4gIE06CUJlbmNlIENzw7Nrw6FzIDxiZW5jZTk4
QHNjaC5ibWUuaHU+Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci8xMDQtcXVhZC04LmMg
Yi9kcml2ZXJzL2NvdW50ZXIvMTA0LXF1YWQtOC5jCj4gaW5kZXggMGNhYTYwNTM3YjE0Li5jNTg3
ZjI5NWQ3MjAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jb3VudGVyLzEwNC1xdWFkLTguYwo+ICsr
KyBiL2RyaXZlcnMvY291bnRlci8xMDQtcXVhZC04LmMKPiBAQCAtMTE3LDcgKzExNyw3IEBAIHN0
YXRpYyBpbnQgcXVhZDhfc2lnbmFsX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICB9Cj4gIAo+ICBzdGF0aWMgaW50IHF1YWQ4X2NvdW50X3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25l
ZCBsb25nICp2YWwpCj4gKwkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAq
dmFsKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+
ICAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFzZSArIDIgKiBjb3VudC0+aWQ7Cj4g
QEAgLTE0OCw3ICsxNDgsNyBAQCBzdGF0aWMgaW50IHF1YWQ4X2NvdW50X3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4gIAo+ICBzdGF0aWMgaW50IHF1YWQ4X2NvdW50
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyB2YWwpCj4gKwkJCSAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCB1NjQgdmFsKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+ICAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFz
ZSArIDIgKiBjb3VudC0+aWQ7Cj4gQEAgLTE4OCwyMiArMTg4LDE2IEBAIHN0YXRpYyBpbnQgcXVh
ZDhfY291bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJu
IDA7Cj4gIH0KPiAgCj4gLWVudW0gcXVhZDhfY291bnRfZnVuY3Rpb24gewo+IC0JUVVBRDhfQ09V
TlRfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OID0gMCwKPiAtCVFVQUQ4X0NPVU5UX0ZVTkNUSU9O
X1FVQURSQVRVUkVfWDEsCj4gLQlRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gyLAo+
IC0JUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNAo+IC19Owo+IC0KPiAgc3RhdGlj
IGNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiBxdWFkOF9jb3VudF9mdW5jdGlvbnNfbGlzdFtd
ID0gewo+IC0JW1FVQUQ4X0NPVU5UX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTl0gPSBDT1VOVEVS
X0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTiwKPiAtCVtRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFE
UkFUVVJFX1gxXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BLAo+IC0JW1FVQUQ4
X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFU
VVJFX1gyX0EsCj4gLQlbUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNF0gPSBDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQKPiArCUNPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElS
RUNUSU9OLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0EsCj4gKwlDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQSwKPiArCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVS
RV9YNCwKPiAgfTsKPiAgCj4gLXN0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25fZ2V0KHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwg
c2l6ZV90ICpmdW5jdGlvbikKPiArc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl9yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKPiArCQkJICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb24p
Cj4gIHsKPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAlj
b25zdCBpbnQgaWQgPSBjb3VudC0+aWQ7Cj4gQEAgLTIxMywyNSArMjA3LDI2IEBAIHN0YXRpYyBp
bnQgcXVhZDhfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAg
CWlmIChwcml2LT5xdWFkcmF0dXJlX21vZGVbaWRdKQo+ICAJCXN3aXRjaCAocHJpdi0+cXVhZHJh
dHVyZV9zY2FsZVtpZF0pIHsKPiAgCQljYXNlIDA6Cj4gLQkJCSpmdW5jdGlvbiA9IFFVQUQ4X0NP
VU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDE7Cj4gKwkJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YMV9BOwo+ICAJCQlicmVhazsKPiAgCQljYXNlIDE6Cj4gLQkJCSpm
dW5jdGlvbiA9IFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDI7Cj4gKwkJCSpmdW5j
dGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BOwo+ICAJCQlicmVhazsKPiAg
CQljYXNlIDI6Cj4gLQkJCSpmdW5jdGlvbiA9IFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRV
UkVfWDQ7Cj4gKwkJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDsK
PiAgCQkJYnJlYWs7Cj4gIAkJfQo+ICAJZWxzZQo+IC0JCSpmdW5jdGlvbiA9IFFVQUQ4X0NPVU5U
X0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTjsKPiArCQkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNU
SU9OX1BVTFNFX0RJUkVDVElPTjsKPiAgCj4gIAltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+
ICAKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IHF1YWQ4X2Z1bmN0aW9uX3Nl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsIHNpemVfdCBmdW5jdGlvbikKPiArc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl93
cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQlzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCj4gKwkJCQllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb24pCj4g
IHsKPiAgCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAljb25z
dCBpbnQgaWQgPSBjb3VudC0+aWQ7Cj4gQEAgLTI0Nyw3ICsyNDIsNyBAQCBzdGF0aWMgaW50IHF1
YWQ4X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAltb2Rl
X2NmZyA9IHByaXYtPmNvdW50X21vZGVbaWRdIDw8IDE7Cj4gIAlpZHJfY2ZnID0gcHJpdi0+aW5k
ZXhfcG9sYXJpdHlbaWRdIDw8IDE7Cj4gIAo+IC0JaWYgKGZ1bmN0aW9uID09IFFVQUQ4X0NPVU5U
X0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTikgewo+ICsJaWYgKGZ1bmN0aW9uID09IENPVU5URVJf
RlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OKSB7Cj4gIAkJKnF1YWRyYXR1cmVfbW9kZSA9IDA7Cj4g
IAo+ICAJCS8qIFF1YWRyYXR1cmUgc2NhbGluZyBvbmx5IGF2YWlsYWJsZSBpbiBxdWFkcmF0dXJl
IG1vZGUgKi8KPiBAQCAtMjYzLDE1ICsyNTgsMTUgQEAgc3RhdGljIGludCBxdWFkOF9mdW5jdGlv
bl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJCSpxdWFkcmF0dXJlX21v
ZGUgPSAxOwo+ICAKPiAgCQlzd2l0Y2ggKGZ1bmN0aW9uKSB7Cj4gLQkJY2FzZSBRVUFEOF9DT1VO
VF9GVU5DVElPTl9RVUFEUkFUVVJFX1gxOgo+ICsJCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1gxX0E6Cj4gIAkJCSpzY2FsZSA9IDA7Cj4gIAkJCW1vZGVfY2ZnIHw9IFFVQUQ4X0NN
Ul9RVUFEUkFUVVJFX1gxOwo+ICAJCQlicmVhazsKPiAtCQljYXNlIFFVQUQ4X0NPVU5UX0ZVTkNU
SU9OX1FVQURSQVRVUkVfWDI6Cj4gKwkJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDJfQToKPiAgCQkJKnNjYWxlID0gMTsKPiAgCQkJbW9kZV9jZmcgfD0gUVVBRDhfQ01SX1FVQURS
QVRVUkVfWDI7Cj4gIAkJCWJyZWFrOwo+IC0JCWNhc2UgUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YNDoKPiArCQljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiAg
CQkJKnNjYWxlID0gMjsKPiAgCQkJbW9kZV9jZmcgfD0gUVVBRDhfQ01SX1FVQURSQVRVUkVfWDQ7
Cj4gIAkJCWJyZWFrOwo+IEBAIC0yOTAsOCArMjg1LDkgQEAgc3RhdGljIGludCBxdWFkOF9mdW5j
dGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJuIDA7Cj4g
IH0KPiAgCj4gLXN0YXRpYyB2b2lkIHF1YWQ4X2RpcmVjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBlbnVtIGNv
dW50ZXJfY291bnRfZGlyZWN0aW9uICpkaXJlY3Rpb24pCj4gK3N0YXRpYyBpbnQgcXVhZDhfZGly
ZWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlv
biAqZGlyZWN0aW9uKQo+ICB7Cj4gIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBj
b3VudGVyLT5wcml2Owo+ICAJdW5zaWduZWQgaW50IHVkX2ZsYWc7Cj4gQEAgLTMwMiw3NiArMjk4
LDc0IEBAIHN0YXRpYyB2b2lkIHF1YWQ4X2RpcmVjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+ICAKPiAgCSpkaXJlY3Rpb24gPSAodWRfZmxhZykgPyBDT1VOVEVSX0NP
VU5UX0RJUkVDVElPTl9GT1JXQVJEIDoKPiAgCQlDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9CQUNL
V0FSRDsKPiAtfQo+ICAKPiAtZW51bSBxdWFkOF9zeW5hcHNlX2FjdGlvbiB7Cj4gLQlRVUFEOF9T
WU5BUFNFX0FDVElPTl9OT05FID0gMCwKPiAtCVFVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19F
REdFLAo+IC0JUVVBRDhfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+IC0JUVVBRDhfU1lO
QVBTRV9BQ1RJT05fQk9USF9FREdFUwo+IC19Owo+ICsJcmV0dXJuIDA7Cj4gK30KPiAgCj4gIHN0
YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gcXVhZDhfaW5kZXhfYWN0aW9u
c19saXN0W10gPSB7Cj4gLQlbUVVBRDhfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX05PTkUsCj4gLQlbUVVBRDhfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0Vd
ID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRQo+ICsJQ09VTlRFUl9TWU5BUFNF
X0FDVElPTl9OT05FLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiAg
fTsKPiAgCj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gcXVhZDhf
c3luYXBzZV9hY3Rpb25zX2xpc3RbXSA9IHsKPiAtCVtRVUFEOF9TWU5BUFNFX0FDVElPTl9OT05F
XSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiAtCVtRVUFEOF9TWU5BUFNFX0FDVElP
Tl9SSVNJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+IC0J
W1FVQUQ4X1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNU
SU9OX0ZBTExJTkdfRURHRSwKPiAtCVtRVUFEOF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTXSA9
IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUwo+ICsJQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9OT05FLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiArCUNP
VU5URVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9CT1RIX0VER0VTLAo+ICB9Owo+ICAKPiAtc3RhdGljIGludCBxdWFkOF9hY3Rpb25fZ2V0
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtCXNpemVfdCAqYWN0
aW9uKQo+ICtzdGF0aWMgaW50IHF1YWQ4X2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiArCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJ
CSAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiArCQkJICAgICBlbnVtIGNv
dW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25z
dCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCWludCBlcnI7Cj4gLQlzaXplX3QgZnVuY3Rpb24g
PSAwOwo+ICsJZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uOwo+ICAJY29uc3Qgc2l6ZV90
IHNpZ25hbF9hX2lkID0gY291bnQtPnN5bmFwc2VzWzBdLnNpZ25hbC0+aWQ7Cj4gIAllbnVtIGNv
dW50ZXJfY291bnRfZGlyZWN0aW9uIGRpcmVjdGlvbjsKPiAgCj4gIAkvKiBIYW5kbGUgSW5kZXgg
c2lnbmFscyAqLwo+ICAJaWYgKHN5bmFwc2UtPnNpZ25hbC0+aWQgPj0gMTYpIHsKPiAgCQlpZiAo
cHJpdi0+cHJlc2V0X2VuYWJsZVtjb3VudC0+aWRdKQo+IC0JCQkqYWN0aW9uID0gUVVBRDhfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX1JJU0lOR19FREdFOwo+ICAJCWVsc2UKPiAtCQkJKmFjdGlvbiA9IFFVQUQ4X1NZTkFQ
U0VfQUNUSU9OX05PTkU7Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05P
TkU7Cj4gIAo+ICAJCXJldHVybiAwOwo+ICAJfQo+ICAKPiAtCWVyciA9IHF1YWQ4X2Z1bmN0aW9u
X2dldChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9uKTsKPiArCWVyciA9IHF1YWQ4X2Z1bmN0aW9u
X3JlYWQoY291bnRlciwgY291bnQsICZmdW5jdGlvbik7Cj4gIAlpZiAoZXJyKQo+ICAJCXJldHVy
biBlcnI7Cj4gIAo+ICAJLyogRGVmYXVsdCBhY3Rpb24gbW9kZSAqLwo+IC0JKmFjdGlvbiA9IFFV
QUQ4X1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gKwkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9OT05FOwo+ICAKPiAgCS8qIERldGVybWluZSBhY3Rpb24gbW9kZSBiYXNlZCBvbiBjdXJy
ZW50IGNvdW50IGZ1bmN0aW9uIG1vZGUgKi8KPiAgCXN3aXRjaCAoZnVuY3Rpb24pIHsKPiAtCWNh
c2UgUVVBRDhfQ09VTlRfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOgo+ICsJY2FzZSBDT1VOVEVS
X0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTjoKPiAgCQlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9
PSBzaWduYWxfYV9pZCkKPiAtCQkJKmFjdGlvbiA9IFFVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lO
R19FREdFOwo+ICsJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURH
RTsKPiAgCQlyZXR1cm4gMDsKPiAtCWNhc2UgUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVS
RV9YMToKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0E6Cj4gIAkJaWYg
KHN5bmFwc2UtPnNpZ25hbC0+aWQgPT0gc2lnbmFsX2FfaWQpIHsKPiAtCQkJcXVhZDhfZGlyZWN0
aW9uX2dldChjb3VudGVyLCBjb3VudCwgJmRpcmVjdGlvbik7Cj4gKwkJCWVyciA9IHF1YWQ4X2Rp
cmVjdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZGlyZWN0aW9uKTsKPiArCQkJaWYgKGVycikK
PiArCQkJCXJldHVybiBlcnI7Cj4gIAo+ICAJCQlpZiAoZGlyZWN0aW9uID09IENPVU5URVJfQ09V
TlRfRElSRUNUSU9OX0ZPUldBUkQpCj4gLQkJCQkqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9BQ1RJ
T05fUklTSU5HX0VER0U7Cj4gKwkJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9S
SVNJTkdfRURHRTsKPiAgCQkJZWxzZQo+IC0JCQkJKmFjdGlvbiA9IFFVQUQ4X1NZTkFQU0VfQUNU
SU9OX0ZBTExJTkdfRURHRTsKPiArCQkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X0ZBTExJTkdfRURHRTsKPiAgCQl9Cj4gIAkJcmV0dXJuIDA7Cj4gLQljYXNlIFFVQUQ4X0NPVU5U
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDI6Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJB
VFVSRV9YMl9BOgo+ICAJCWlmIChzeW5hcHNlLT5zaWduYWwtPmlkID09IHNpZ25hbF9hX2lkKQo+
IC0JCQkqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiArCQkJKmFj
dGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiAgCQlyZXR1cm4gMDsK
PiAtCWNhc2UgUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiAtCQkqYWN0aW9u
ID0gUVVBRDhfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiArCWNhc2UgQ09VTlRFUl9GVU5D
VElPTl9RVUFEUkFUVVJFX1g0Ogo+ICsJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X0JPVEhfRURHRVM7Cj4gIAkJcmV0dXJuIDA7Cj4gIAlkZWZhdWx0Ogo+ICAJCS8qIHNob3VsZCBu
ZXZlciByZWFjaCB0aGlzIHBhdGggKi8KPiBAQCAtMzgzLDkgKzM3Nyw5IEBAIHN0YXRpYyBjb25z
dCBzdHJ1Y3QgY291bnRlcl9vcHMgcXVhZDhfb3BzID0gewo+ICAJLnNpZ25hbF9yZWFkID0gcXVh
ZDhfc2lnbmFsX3JlYWQsCj4gIAkuY291bnRfcmVhZCA9IHF1YWQ4X2NvdW50X3JlYWQsCj4gIAku
Y291bnRfd3JpdGUgPSBxdWFkOF9jb3VudF93cml0ZSwKPiAtCS5mdW5jdGlvbl9nZXQgPSBxdWFk
OF9mdW5jdGlvbl9nZXQsCj4gLQkuZnVuY3Rpb25fc2V0ID0gcXVhZDhfZnVuY3Rpb25fc2V0LAo+
IC0JLmFjdGlvbl9nZXQgPSBxdWFkOF9hY3Rpb25fZ2V0Cj4gKwkuZnVuY3Rpb25fcmVhZCA9IHF1
YWQ4X2Z1bmN0aW9uX3JlYWQsCj4gKwkuZnVuY3Rpb25fd3JpdGUgPSBxdWFkOF9mdW5jdGlvbl93
cml0ZSwKPiArCS5hY3Rpb25fcmVhZCA9IHF1YWQ4X2FjdGlvbl9yZWFkCj4gIH07Cj4gIAo+ICBz
dGF0aWMgY29uc3QgY2hhciAqY29uc3QgcXVhZDhfaW5kZXhfcG9sYXJpdHlfbW9kZXNbXSA9IHsK
PiBAQCAtMzk0LDcgKzM4OCw4IEBAIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9pbmRl
eF9wb2xhcml0eV9tb2Rlc1tdID0gewo+ICB9Owo+ICAKPiAgc3RhdGljIGludCBxdWFkOF9pbmRl
eF9wb2xhcml0eV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0
IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHNpemVfdCAqaW5kZXhfcG9sYXJpdHkpCj4gKwkJCQkg
ICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gKwkJCQkgICAgdTMyICppbmRleF9w
b2xhcml0eSkKPiAgewo+ICAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRl
ci0+cHJpdjsKPiAgCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAtIDE2Owo+
IEBAIC00MDUsNyArNDAwLDggQEAgc3RhdGljIGludCBxdWFkOF9pbmRleF9wb2xhcml0eV9nZXQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICB9Cj4gIAo+ICBzdGF0aWMgaW50IHF1
YWQ4X2luZGV4X3BvbGFyaXR5X3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
LQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90IGluZGV4X3BvbGFyaXR5KQo+
ICsJCQkJICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ICsJCQkJICAgIHUzMiBp
bmRleF9wb2xhcml0eSkKPiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRl
ci0+cHJpdjsKPiAgCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAtIDE2Owo+
IEBAIC00MjYsMjAgKzQyMiwxNCBAQCBzdGF0aWMgaW50IHF1YWQ4X2luZGV4X3BvbGFyaXR5X3Nl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAK
PiAtc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCBxdWFkOF9pbmRleF9wb2xf
ZW51bSA9IHsKPiAtCS5pdGVtcyA9IHF1YWQ4X2luZGV4X3BvbGFyaXR5X21vZGVzLAo+IC0JLm51
bV9pdGVtcyA9IEFSUkFZX1NJWkUocXVhZDhfaW5kZXhfcG9sYXJpdHlfbW9kZXMpLAo+IC0JLmdl
dCA9IHF1YWQ4X2luZGV4X3BvbGFyaXR5X2dldCwKPiAtCS5zZXQgPSBxdWFkOF9pbmRleF9wb2xh
cml0eV9zZXQKPiAtfTsKPiAtCj4gIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9zeW5j
aHJvbm91c19tb2Rlc1tdID0gewo+ICAJIm5vbi1zeW5jaHJvbm91cyIsCj4gIAkic3luY2hyb25v
dXMiCj4gIH07Cj4gIAo+ICBzdGF0aWMgaW50IHF1YWQ4X3N5bmNocm9ub3VzX21vZGVfZ2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAq
c2lnbmFsLCBzaXplX3QgKnN5bmNocm9ub3VzX21vZGUpCj4gKwkJCQkgICAgICBzdHJ1Y3QgY291
bnRlcl9zaWduYWwgKnNpZ25hbCwKPiArCQkJCSAgICAgIHUzMiAqc3luY2hyb25vdXNfbW9kZSkK
PiAgewo+ICAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsK
PiAgCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAtIDE2Owo+IEBAIC00NTAs
NyArNDQwLDggQEAgc3RhdGljIGludCBxdWFkOF9zeW5jaHJvbm91c19tb2RlX2dldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQgcXVhZDhfc3lu
Y2hyb25vdXNfbW9kZV9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHNpemVfdCBzeW5jaHJvbm91c19tb2RlKQo+ICsJ
CQkJICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gKwkJCQkgICAgICB1MzIg
c3luY2hyb25vdXNfbW9kZSkKPiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291
bnRlci0+cHJpdjsKPiAgCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAtIDE2
Owo+IEBAIC00NzcsMjIgKzQ2OCwxOCBAQCBzdGF0aWMgaW50IHF1YWQ4X3N5bmNocm9ub3VzX21v
ZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCXJldHVybiAwOwo+ICB9
Cj4gIAo+IC1zdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0IHF1YWQ4X3N5bl9t
b2RlX2VudW0gPSB7Cj4gLQkuaXRlbXMgPSBxdWFkOF9zeW5jaHJvbm91c19tb2RlcywKPiAtCS5u
dW1faXRlbXMgPSBBUlJBWV9TSVpFKHF1YWQ4X3N5bmNocm9ub3VzX21vZGVzKSwKPiAtCS5nZXQg
PSBxdWFkOF9zeW5jaHJvbm91c19tb2RlX2dldCwKPiAtCS5zZXQgPSBxdWFkOF9zeW5jaHJvbm91
c19tb2RlX3NldAo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfZmxvb3Jf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBxdWFk
OF9jb3VudF9mbG9vcl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJ
CSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKmZsb29yKQo+ICB7Cj4gIAkvKiBP
bmx5IGEgZmxvb3Igb2YgMCBpcyBzdXBwb3J0ZWQgKi8KPiAtCXJldHVybiBzcHJpbnRmKGJ1Ziwg
IjBcbiIpOwo+ICsJKmZsb29yID0gMDsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3Rh
dGljIGludCBxdWFkOF9jb3VudF9tb2RlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCAqY250X21vZGUpCj4g
K3N0YXRpYyBpbnQgcXVhZDhfY291bnRfbW9kZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiArCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkgZW51
bSBjb3VudGVyX2NvdW50X21vZGUgKmNudF9tb2RlKQo+ICB7Cj4gIAljb25zdCBzdHJ1Y3QgcXVh
ZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAKPiBAQCAtNTE1LDI2ICs1MDIsMjgg
QEAgc3RhdGljIGludCBxdWFkOF9jb3VudF9tb2RlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIGludCBxdWFkOF9jb3Vu
dF9tb2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCBjbnRfbW9kZSkKPiArc3RhdGljIGludCBxdWFkOF9j
b3VudF9tb2RlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJICBlbnVtIGNvdW50ZXJfY291bnRf
bW9kZSBjbnRfbW9kZSkKPiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRl
ci0+cHJpdjsKPiArCXVuc2lnbmVkIGludCBjb3VudF9tb2RlOwo+ICAJdW5zaWduZWQgaW50IG1v
ZGVfY2ZnOwo+ICAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFzZSArIDIgKiBjb3Vu
dC0+aWQgKyAxOwo+ICAKPiAgCS8qIE1hcCBHZW5lcmljIENvdW50ZXIgY291bnQgbW9kZSB0byAx
MDQtUVVBRC04IGNvdW50IG1vZGUgKi8KPiAgCXN3aXRjaCAoY250X21vZGUpIHsKPiAgCWNhc2Ug
Q09VTlRFUl9DT1VOVF9NT0RFX05PUk1BTDoKPiAtCQljbnRfbW9kZSA9IDA7Cj4gKwkJY291bnRf
bW9kZSA9IDA7Cj4gIAkJYnJlYWs7Cj4gIAljYXNlIENPVU5URVJfQ09VTlRfTU9ERV9SQU5HRV9M
SU1JVDoKPiAtCQljbnRfbW9kZSA9IDE7Cj4gKwkJY291bnRfbW9kZSA9IDE7Cj4gIAkJYnJlYWs7
Cj4gIAljYXNlIENPVU5URVJfQ09VTlRfTU9ERV9OT05fUkVDWUNMRToKPiAtCQljbnRfbW9kZSA9
IDI7Cj4gKwkJY291bnRfbW9kZSA9IDI7Cj4gIAkJYnJlYWs7Cj4gIAljYXNlIENPVU5URVJfQ09V
TlRfTU9ERV9NT0RVTE9fTjoKPiAtCQljbnRfbW9kZSA9IDM7Cj4gKwkJY291bnRfbW9kZSA9IDM7
Cj4gIAkJYnJlYWs7Cj4gIAlkZWZhdWx0Ogo+ICAJCS8qIHNob3VsZCBuZXZlciByZWFjaCB0aGlz
IHBhdGggKi8KPiBAQCAtNTQzLDEwICs1MzIsMTAgQEAgc3RhdGljIGludCBxdWFkOF9jb3VudF9t
b2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAo+ICAJbXV0ZXhfbG9j
aygmcHJpdi0+bG9jayk7Cj4gIAo+IC0JcHJpdi0+Y291bnRfbW9kZVtjb3VudC0+aWRdID0gY250
X21vZGU7Cj4gKwlwcml2LT5jb3VudF9tb2RlW2NvdW50LT5pZF0gPSBjb3VudF9tb2RlOwo+ICAK
PiAgCS8qIFNldCBjb3VudCBtb2RlIGNvbmZpZ3VyYXRpb24gdmFsdWUgKi8KPiAtCW1vZGVfY2Zn
ID0gY250X21vZGUgPDwgMTsKPiArCW1vZGVfY2ZnID0gY291bnRfbW9kZSA8PCAxOwo+ICAKPiAg
CS8qIEFkZCBxdWFkcmF0dXJlIG1vZGUgY29uZmlndXJhdGlvbiAqLwo+ICAJaWYgKHByaXYtPnF1
YWRyYXR1cmVfbW9kZVtjb3VudC0+aWRdKQo+IEBAIC01NjAsNTYgKzU0OSwzNSBAQCBzdGF0aWMg
aW50IHF1YWQ4X2NvdW50X21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnRfZW51
bV9leHQgcXVhZDhfY250X21vZGVfZW51bSA9IHsKPiAtCS5pdGVtcyA9IGNvdW50ZXJfY291bnRf
bW9kZV9zdHIsCj4gLQkubnVtX2l0ZW1zID0gQVJSQVlfU0laRShjb3VudGVyX2NvdW50X21vZGVf
c3RyKSwKPiAtCS5nZXQgPSBxdWFkOF9jb3VudF9tb2RlX2dldCwKPiAtCS5zZXQgPSBxdWFkOF9j
b3VudF9tb2RlX3NldAo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfZGly
ZWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2LCBjaGFyICpidWYpCj4gLXsKPiAtCWVudW0g
Y291bnRlcl9jb3VudF9kaXJlY3Rpb24gZGlyOwo+IC0KPiAtCXF1YWQ4X2RpcmVjdGlvbl9nZXQo
Y291bnRlciwgY291bnQsICZkaXIpOwo+IC0KPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4i
LCBjb3VudGVyX2NvdW50X2RpcmVjdGlvbl9zdHJbZGlyXSk7Cj4gLX0KPiAtCj4gLXN0YXRpYyBz
c2l6ZV90IHF1YWQ4X2NvdW50X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hh
ciAqYnVmKQo+ICtzdGF0aWMgaW50IHF1YWQ4X2NvdW50X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgdTggKmVuYWJsZSkKPiAgewo+ICAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0g
Y291bnRlci0+cHJpdjsKPiAgCj4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+
YWJfZW5hYmxlW2NvdW50LT5pZF0pOwo+ICsJKmVuYWJsZSA9IHByaXYtPmFiX2VuYWJsZVtjb3Vu
dC0+aWRdOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBxdWFk
OF9jb3VudF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0J
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfZW5hYmxlX3dyaXRlKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsIHU4IGVuYWJsZSkKPiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKPiAgCWNvbnN0IGludCBiYXNlX29mZnNldCA9IHByaXYtPmJhc2Ug
KyAyICogY291bnQtPmlkOwo+IC0JaW50IGVycjsKPiAtCWJvb2wgYWJfZW5hYmxlOwo+ICAJdW5z
aWduZWQgaW50IGlvcl9jZmc7Cj4gIAo+IC0JZXJyID0ga3N0cnRvYm9vbChidWYsICZhYl9lbmFi
bGUpOwo+IC0JaWYgKGVycikKPiAtCQlyZXR1cm4gZXJyOwo+IC0KPiAgCW11dGV4X2xvY2soJnBy
aXYtPmxvY2spOwo+ICAKPiAtCXByaXYtPmFiX2VuYWJsZVtjb3VudC0+aWRdID0gYWJfZW5hYmxl
Owo+ICsJcHJpdi0+YWJfZW5hYmxlW2NvdW50LT5pZF0gPSBlbmFibGU7Cj4gIAo+IC0JaW9yX2Nm
ZyA9IGFiX2VuYWJsZSB8IHByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlkXSA8PCAxOwo+ICsJ
aW9yX2NmZyA9IGVuYWJsZSB8IHByaXYtPnByZXNldF9lbmFibGVbY291bnQtPmlkXSA8PCAxOwo+
ICAKPiAgCS8qIExvYWQgSS9PIGNvbnRyb2wgY29uZmlndXJhdGlvbiAqLwo+ICAJb3V0YihRVUFE
OF9DVFJfSU9SIHwgaW9yX2NmZywgYmFzZV9vZmZzZXQgKyAxKTsKPiAgCj4gIAltdXRleF91bmxv
Y2soJnByaXYtPmxvY2spOwo+ICAKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+
ICAKPiAgc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IHF1YWQ4X25vaXNlX2Vycm9yX3N0YXRlc1td
ID0gewo+IEBAIC02MTgsNyArNTg2LDcgQEAgc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IHF1YWQ4
X25vaXNlX2Vycm9yX3N0YXRlc1tdID0gewo+ICB9Owo+ICAKPiAgc3RhdGljIGludCBxdWFkOF9l
cnJvcl9ub2lzZV9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgKm5vaXNlX2Vycm9yKQo+ICsJCQkJIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyICpub2lzZV9lcnJvcikKPiAgewo+ICAJY29uc3Qg
c3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCWNvbnN0IGludCBi
YXNlX29mZnNldCA9IHByaXYtPmJhc2UgKyAyICogY291bnQtPmlkICsgMTsKPiBAQCAtNjI4LDE4
ICs1OTYsMTQgQEAgc3RhdGljIGludCBxdWFkOF9lcnJvcl9ub2lzZV9nZXQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzdHJ1
Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4dCBxdWFkOF9lcnJvcl9ub2lzZV9lbnVtID0gewo+IC0J
Lml0ZW1zID0gcXVhZDhfbm9pc2VfZXJyb3Jfc3RhdGVzLAo+IC0JLm51bV9pdGVtcyA9IEFSUkFZ
X1NJWkUocXVhZDhfbm9pc2VfZXJyb3Jfc3RhdGVzKSwKPiAtCS5nZXQgPSBxdWFkOF9lcnJvcl9u
b2lzZV9nZXQKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHF1YWQ4
X2NvdW50X3ByZXNldF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJ
CSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICpwcmVzZXQpCj4gIHsKPiAgCWNv
bnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAo+IC0JcmV0
dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIHByaXYtPnByZXNldFtjb3VudC0+aWRdKTsKPiArCSpw
cmVzZXQgPSBwcml2LT5wcmVzZXRbY291bnQtPmlkXTsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+
ICAKPiAgc3RhdGljIHZvaWQgcXVhZDhfcHJlc2V0X3JlZ2lzdGVyX3NldChzdHJ1Y3QgcXVhZDgg
KmNvbnN0IHByaXYsIGNvbnN0IGludCBpZCwKPiBAQCAtNjU4LDE2ICs2MjIsMTAgQEAgc3RhdGlj
IHZvaWQgcXVhZDhfcHJlc2V0X3JlZ2lzdGVyX3NldChzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYs
IGNvbnN0IGludCBpZCwKPiAgCQlvdXRiKHByZXNldCA+PiAoOCAqIGkpLCBiYXNlX29mZnNldCk7
Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF93cml0ZShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGlj
IGludCBxdWFkOF9jb3VudF9wcmVzZXRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICsJCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IHByZXNldCkK
PiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAtCXVu
c2lnbmVkIGludCBwcmVzZXQ7Cj4gLQlpbnQgcmV0Owo+IC0KPiAtCXJldCA9IGtzdHJ0b3VpbnQo
YnVmLCAwLCAmcHJlc2V0KTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJuIHJldDsKPiAgCj4gIAkv
KiBPbmx5IDI0LWJpdCB2YWx1ZXMgYXJlIHN1cHBvcnRlZCAqLwo+ICAJaWYgKHByZXNldCA+IDB4
RkZGRkZGKQo+IEBAIC02NzksMTEgKzYzNywxMSBAQCBzdGF0aWMgc3NpemVfdCBxdWFkOF9jb3Vu
dF9wcmVzZXRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAKPiAgCW11
dGV4X3VubG9jaygmcHJpdi0+bG9jayk7Cj4gIAo+IC0JcmV0dXJuIGxlbjsKPiArCXJldHVybiAw
Owo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9jZWlsaW5nX3JlYWQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50LCB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQgcXVhZDhfY291bnRf
Y2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqY2VpbGluZykKPiAgewo+ICAJc3RydWN0
IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCj4gQEAgLTY5MywyNiArNjUx
LDIzIEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlzd2l0Y2ggKHByaXYtPmNvdW50X21vZGVbY291bnQt
PmlkXSkgewo+ICAJY2FzZSAxOgo+ICAJY2FzZSAzOgo+IC0JCW11dGV4X3VubG9jaygmcHJpdi0+
bG9jayk7Cj4gLQkJcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIHByaXYtPnByZXNldFtjb3Vu
dC0+aWRdKTsKPiArCQkqY2VpbGluZyA9IHByaXYtPnByZXNldFtjb3VudC0+aWRdOwo+ICsJCWJy
ZWFrOwo+ICsJZGVmYXVsdDoKPiArCQkvKiBCeSBkZWZhdWx0IDB4MUZGRkZGRiAoMjUgYml0cyB1
bnNpZ25lZCkgaXMgbWF4aW11bSBjb3VudCAqLwo+ICsJCSpjZWlsaW5nID0gMHgxRkZGRkZGOwo+
ICsJCWJyZWFrOwo+ICAJfQo+ICAKPiAgCW11dGV4X3VubG9jaygmcHJpdi0+bG9jayk7Cj4gIAo+
IC0JLyogQnkgZGVmYXVsdCAweDFGRkZGRkYgKDI1IGJpdHMgdW5zaWduZWQpIGlzIG1heGltdW0g
Y291bnQgKi8KPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIjMzNTU0NDMxXG4iKTsKPiArCXJldHVy
biAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9jZWlsaW5nX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtz
dGF0aWMgaW50IHF1YWQ4X2NvdW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICsJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCBj
ZWlsaW5nKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2
Owo+IC0JdW5zaWduZWQgaW50IGNlaWxpbmc7Cj4gLQlpbnQgcmV0Owo+IC0KPiAtCXJldCA9IGtz
dHJ0b3VpbnQoYnVmLCAwLCAmY2VpbGluZyk7Cj4gLQlpZiAocmV0KQo+IC0JCXJldHVybiByZXQ7
Cj4gIAo+ICAJLyogT25seSAyNC1iaXQgdmFsdWVzIGFyZSBzdXBwb3J0ZWQgKi8KPiAgCWlmIChj
ZWlsaW5nID4gMHhGRkZGRkYpCj4gQEAgLTcyNiw3ICs2ODEsNyBAQCBzdGF0aWMgc3NpemVfdCBx
dWFkOF9jb3VudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAgCWNhc2UgMzoKPiAgCQlxdWFkOF9wcmVzZXRfcmVnaXN0ZXJfc2V0KHByaXYsIGNvdW50LT5p
ZCwgY2VpbGluZyk7Cj4gIAkJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPiAtCQlyZXR1cm4g
bGVuOwo+ICsJCXJldHVybiAwOwo+ICAJfQo+ICAKPiAgCW11dGV4X3VubG9jaygmcHJpdi0+bG9j
ayk7Cj4gQEAgLTczNCwyNyArNjg5LDI1IEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2Nl
aWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJcmV0dXJuIC1F
SU5WQUw7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFi
bGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQlzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBx
dWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICsJCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJCSAgdTgg
KnByZXNldF9lbmFibGUpCj4gIHsKPiAgCWNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9
IGNvdW50ZXItPnByaXY7Cj4gIAo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsICFwcml2
LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF0pOwo+ICsJKnByZXNldF9lbmFibGUgPSAhcHJpdi0+
cHJlc2V0X2VuYWJsZVtjb3VudC0+aWRdOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1z
dGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9p
ZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHF1
YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICsJCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQkgICB1
OCBwcmVzZXRfZW5hYmxlKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3Vu
dGVyLT5wcml2Owo+ICAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFzZSArIDIgKiBj
b3VudC0+aWQgKyAxOwo+IC0JYm9vbCBwcmVzZXRfZW5hYmxlOwo+IC0JaW50IHJldDsKPiAgCXVu
c2lnbmVkIGludCBpb3JfY2ZnOwo+ICAKPiAtCXJldCA9IGtzdHJ0b2Jvb2woYnVmLCAmcHJlc2V0
X2VuYWJsZSk7Cj4gLQlpZiAocmV0KQo+IC0JCXJldHVybiByZXQ7Cj4gLQo+ICAJLyogUHJlc2V0
IGVuYWJsZSBpcyBhY3RpdmUgbG93IGluIElucHV0L091dHB1dCBDb250cm9sIHJlZ2lzdGVyICov
Cj4gIAlwcmVzZXRfZW5hYmxlID0gIXByZXNldF9lbmFibGU7Cj4gIAo+IEBAIC03NjIsMjUgKzcx
NSwyNCBAQCBzdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3dyaXRlKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCj4gIAlwcml2LT5wcmVzZXRfZW5hYmxl
W2NvdW50LT5pZF0gPSBwcmVzZXRfZW5hYmxlOwo+ICAKPiAtCWlvcl9jZmcgPSBwcml2LT5hYl9l
bmFibGVbY291bnQtPmlkXSB8ICh1bnNpZ25lZCBpbnQpcHJlc2V0X2VuYWJsZSA8PCAxOwo+ICsJ
aW9yX2NmZyA9IHByaXYtPmFiX2VuYWJsZVtjb3VudC0+aWRdIHwgcHJlc2V0X2VuYWJsZSA8PCAx
Owo+ICAKPiAgCS8qIExvYWQgSS9PIGNvbnRyb2wgY29uZmlndXJhdGlvbiB0byBJbnB1dCAvIE91
dHB1dCBDb250cm9sIFJlZ2lzdGVyICovCj4gIAlvdXRiKFFVQUQ4X0NUUl9JT1IgfCBpb3JfY2Zn
LCBiYXNlX29mZnNldCk7Cj4gIAo+ICAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKPiAgCj4g
LQlyZXR1cm4gbGVuOwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHF1
YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtCQkJCQkgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+IC0JCQkJCSAg
ICAgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9j
YWJsZV9mYXVsdF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQkg
c3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gKwkJCQkJIHU4ICpjYWJsZV9mYXVsdCkK
PiAgewo+ICAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCWNv
bnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5pZCAvIDI7Cj4gIAlib29sIGRpc2FibGVk
Owo+ICAJdW5zaWduZWQgaW50IHN0YXR1czsKPiAtCXVuc2lnbmVkIGludCBmYXVsdDsKPiAgCj4g
IAltdXRleF9sb2NrKCZwcml2LT5sb2NrKTsKPiAgCj4gQEAgLTc5NywzNiArNzQ5LDMxIEBAIHN0
YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9yZWFkKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAgCW11dGV4X3VubG9jaygmcHJpdi0+bG9jayk7Cj4gIAo+ICAJ
LyogTWFzayByZXNwZWN0aXZlIGNoYW5uZWwgYW5kIGludmVydCBsb2dpYyAqLwo+IC0JZmF1bHQg
PSAhKHN0YXR1cyAmIEJJVChjaGFubmVsX2lkKSk7Cj4gKwkqY2FibGVfZmF1bHQgPSAhKHN0YXR1
cyAmIEJJVChjaGFubmVsX2lkKSk7Cj4gIAo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIs
IGZhdWx0KTsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBxdWFkOF9z
aWduYWxfY2FibGVfZmF1bHRfZW5hYmxlX3JlYWQoCj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+IC0Jdm9pZCAqcHJpdmF0
ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFi
bGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkJCXN0cnVjdCBj
b3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+ICsJCQkJCQl1OCAqZW5hYmxlKQo+ICB7Cj4gIAljb25z
dCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJY29uc3Qgc2l6
ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC8gMjsKPiAtCWNvbnN0IHVuc2lnbmVkIGludCBl
bmIgPSAhIShwcml2LT5jYWJsZV9mYXVsdF9lbmFibGUgJiBCSVQoY2hhbm5lbF9pZCkpOwo+ICAK
PiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBlbmIpOwo+ICsJKmVuYWJsZSA9ICEhKHBy
aXYtPmNhYmxlX2ZhdWx0X2VuYWJsZSAmIEJJVChjaGFubmVsX2lkKSk7Cj4gKwo+ICsJcmV0dXJu
IDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9l
bmFibGVfd3JpdGUoCj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHN0cnVjdCBj
b3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+IC0Jdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFi
bGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCQkgc3RydWN0
IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gKwkJCQkJCSB1OCBlbmFibGUpCj4gIHsKPiAgCXN0
cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAljb25zdCBzaXplX3Qg
Y2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+IC0JYm9vbCBlbmFibGU7Cj4gLQlpbnQgcmV0
Owo+ICAJdW5zaWduZWQgaW50IGNhYmxlX2ZhdWx0X2VuYWJsZTsKPiAgCj4gLQlyZXQgPSBrc3Ry
dG9ib29sKGJ1ZiwgJmVuYWJsZSk7Cj4gLQlpZiAocmV0KQo+IC0JCXJldHVybiByZXQ7Cj4gLQo+
ICAJbXV0ZXhfbG9jaygmcHJpdi0+bG9jayk7Cj4gIAo+ICAJaWYgKGVuYWJsZSkKPiBAQCAtODQx
LDMxICs3ODgsMjcgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2Vu
YWJsZV93cml0ZSgKPiAgCj4gIAltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwo+ICAKPiAtCXJl
dHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgcXVhZDhf
c2lnbmFsX2Zja19wcmVzY2FsZXJfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gLQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAq
YnVmKQo+ICtzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3JlYWQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCSAgIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCAqc2lnbmFsLAo+ICsJCQkJCSAgIHU4ICpwcmVzY2FsZXIpCj4gIHsKPiAgCWNvbnN0IHN0cnVj
dCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gLQljb25zdCBzaXplX3QgY2hh
bm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwo+ICAKPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1
XG4iLCBwcml2LT5mY2tfcHJlc2NhbGVyW2NoYW5uZWxfaWRdKTsKPiArCSpwcmVzY2FsZXIgPSBw
cml2LT5mY2tfcHJlc2NhbGVyW3NpZ25hbC0+aWQgLyAyXTsKPiArCj4gKwlyZXR1cm4gMDsKPiAg
fQo+ICAKPiAtc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfd3JpdGUo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFs
ICpzaWduYWwsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNoYXIgKmJ1ZiwKPiAtCXNpemVfdCBsZW4p
Cj4gK3N0YXRpYyBpbnQgcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfd3JpdGUoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwg
KnNpZ25hbCwKPiArCQkJCQkgICAgdTggcHJlc2NhbGVyKQo+ICB7Cj4gIAlzdHJ1Y3QgcXVhZDgg
KmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQg
PSBzaWduYWwtPmlkIC8gMjsKPiAgCWNvbnN0IGludCBiYXNlX29mZnNldCA9IHByaXYtPmJhc2Ug
KyAyICogY2hhbm5lbF9pZDsKPiAtCXU4IHByZXNjYWxlcjsKPiAtCWludCByZXQ7Cj4gLQo+IC0J
cmV0ID0ga3N0cnRvdTgoYnVmLCAwLCAmcHJlc2NhbGVyKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0
dXJuIHJldDsKPiAgCj4gIAltdXRleF9sb2NrKCZwcml2LT5sb2NrKTsKPiAgCj4gQEAgLTg4MSwz
MSArODI0LDMwIEBAIHN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dy
aXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCj4gIAltdXRleF91bmxvY2so
JnByaXYtPmxvY2spOwo+ICAKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAK
PiAtc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgcXVhZDhfc2lnbmFsX2V4
dFtdID0gewo+IC0Jewo+IC0JCS5uYW1lID0gImNhYmxlX2ZhdWx0IiwKPiAtCQkucmVhZCA9IHF1
YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9yZWFkCj4gLQl9LAo+IC0Jewo+IC0JCS5uYW1lID0gImNh
YmxlX2ZhdWx0X2VuYWJsZSIsCj4gLQkJLnJlYWQgPSBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRf
ZW5hYmxlX3JlYWQsCj4gLQkJLndyaXRlID0gcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJs
ZV93cml0ZQo+IC0JfSwKPiAtCXsKPiAtCQkubmFtZSA9ICJmaWx0ZXJfY2xvY2tfcHJlc2NhbGVy
IiwKPiAtCQkucmVhZCA9IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3JlYWQsCj4gLQkJLndy
aXRlID0gcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfd3JpdGUKPiAtCX0KPiArc3RhdGljIHN0
cnVjdCBjb3VudGVyX2NvbXAgcXVhZDhfc2lnbmFsX2V4dFtdID0gewo+ICsJQ09VTlRFUl9DT01Q
X1NJR05BTF9CT09MKCJjYWJsZV9mYXVsdCIsIHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9yZWFk
LAo+ICsJCQkJIE5VTEwpLAo+ICsJQ09VTlRFUl9DT01QX1NJR05BTF9CT09MKCJjYWJsZV9mYXVs
dF9lbmFibGUiLAo+ICsJCQkJIHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFibGVfcmVhZCwK
PiArCQkJCSBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRfZW5hYmxlX3dyaXRlKSwKPiArCUNPVU5U
RVJfQ09NUF9TSUdOQUxfVTgoImZpbHRlcl9jbG9ja19wcmVzY2FsZXIiLAo+ICsJCQkgICAgICAg
cXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfcmVhZCwKPiArCQkJICAgICAgIHF1YWQ4X3NpZ25h
bF9mY2tfcHJlc2NhbGVyX3dyaXRlKQo+ICB9Owo+ICAKPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBj
b3VudGVyX3NpZ25hbF9leHQgcXVhZDhfaW5kZXhfZXh0W10gPSB7Cj4gLQlDT1VOVEVSX1NJR05B
TF9FTlVNKCJpbmRleF9wb2xhcml0eSIsICZxdWFkOF9pbmRleF9wb2xfZW51bSksCj4gLQlDT1VO
VEVSX1NJR05BTF9FTlVNX0FWQUlMQUJMRSgiaW5kZXhfcG9sYXJpdHkiLAkmcXVhZDhfaW5kZXhf
cG9sX2VudW0pLAo+IC0JQ09VTlRFUl9TSUdOQUxfRU5VTSgic3luY2hyb25vdXNfbW9kZSIsICZx
dWFkOF9zeW5fbW9kZV9lbnVtKSwKPiAtCUNPVU5URVJfU0lHTkFMX0VOVU1fQVZBSUxBQkxFKCJz
eW5jaHJvbm91c19tb2RlIiwgJnF1YWQ4X3N5bl9tb2RlX2VudW0pCj4gK3N0YXRpYyBERUZJTkVf
Q09VTlRFUl9FTlVNKHF1YWQ4X2luZGV4X3BvbF9lbnVtLCBxdWFkOF9pbmRleF9wb2xhcml0eV9t
b2Rlcyk7Cj4gK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9FTlVNKHF1YWQ4X3N5bmNoX21vZGVfZW51
bSwgcXVhZDhfc3luY2hyb25vdXNfbW9kZXMpOwo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVy
X2NvbXAgcXVhZDhfaW5kZXhfZXh0W10gPSB7Cj4gKwlDT1VOVEVSX0NPTVBfU0lHTkFMX0VOVU0o
ImluZGV4X3BvbGFyaXR5IiwgcXVhZDhfaW5kZXhfcG9sYXJpdHlfZ2V0LAo+ICsJCQkJIHF1YWQ4
X2luZGV4X3BvbGFyaXR5X3NldCwKPiArCQkJCSBxdWFkOF9pbmRleF9wb2xfZW51bSksCj4gKwlD
T1VOVEVSX0NPTVBfU0lHTkFMX0VOVU0oInN5bmNocm9ub3VzX21vZGUiLCBxdWFkOF9zeW5jaHJv
bm91c19tb2RlX2dldCwKPiArCQkJCSBxdWFkOF9zeW5jaHJvbm91c19tb2RlX3NldCwKPiArCQkJ
CSBxdWFkOF9zeW5jaF9tb2RlX2VudW0pLAo+ICB9Owo+ICAKPiAgI2RlZmluZSBRVUFEOF9RVUFE
X1NJR05BTChfaWQsIF9uYW1lKSB7CQlcCj4gQEAgLTk3NCwzOSArOTE2LDMwIEBAIHN0YXRpYyBz
dHJ1Y3QgY291bnRlcl9zeW5hcHNlIHF1YWQ4X2NvdW50X3N5bmFwc2VzW11bM10gPSB7Cj4gIAlR
VUFEOF9DT1VOVF9TWU5BUFNFUyg2KSwgUVVBRDhfQ09VTlRfU1lOQVBTRVMoNykKPiAgfTsKPiAg
Cj4gLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgcXVhZDhfY291bnRfZXh0
W10gPSB7Cj4gLQl7Cj4gLQkJLm5hbWUgPSAiY2VpbGluZyIsCj4gLQkJLnJlYWQgPSBxdWFkOF9j
b3VudF9jZWlsaW5nX3JlYWQsCj4gLQkJLndyaXRlID0gcXVhZDhfY291bnRfY2VpbGluZ193cml0
ZQo+IC0JfSwKPiAtCXsKPiAtCQkubmFtZSA9ICJmbG9vciIsCj4gLQkJLnJlYWQgPSBxdWFkOF9j
b3VudF9mbG9vcl9yZWFkCj4gLQl9LAo+IC0JQ09VTlRFUl9DT1VOVF9FTlVNKCJjb3VudF9tb2Rl
IiwgJnF1YWQ4X2NudF9tb2RlX2VudW0pLAo+IC0JQ09VTlRFUl9DT1VOVF9FTlVNX0FWQUlMQUJM
RSgiY291bnRfbW9kZSIsICZxdWFkOF9jbnRfbW9kZV9lbnVtKSwKPiAtCXsKPiAtCQkubmFtZSA9
ICJkaXJlY3Rpb24iLAo+IC0JCS5yZWFkID0gcXVhZDhfY291bnRfZGlyZWN0aW9uX3JlYWQKPiAt
CX0sCj4gLQl7Cj4gLQkJLm5hbWUgPSAiZW5hYmxlIiwKPiAtCQkucmVhZCA9IHF1YWQ4X2NvdW50
X2VuYWJsZV9yZWFkLAo+IC0JCS53cml0ZSA9IHF1YWQ4X2NvdW50X2VuYWJsZV93cml0ZQo+IC0J
fSwKPiAtCUNPVU5URVJfQ09VTlRfRU5VTSgiZXJyb3Jfbm9pc2UiLCAmcXVhZDhfZXJyb3Jfbm9p
c2VfZW51bSksCj4gLQlDT1VOVEVSX0NPVU5UX0VOVU1fQVZBSUxBQkxFKCJlcnJvcl9ub2lzZSIs
ICZxdWFkOF9lcnJvcl9ub2lzZV9lbnVtKSwKPiAtCXsKPiAtCQkubmFtZSA9ICJwcmVzZXQiLAo+
IC0JCS5yZWFkID0gcXVhZDhfY291bnRfcHJlc2V0X3JlYWQsCj4gLQkJLndyaXRlID0gcXVhZDhf
Y291bnRfcHJlc2V0X3dyaXRlCj4gLQl9LAo+IC0Jewo+IC0JCS5uYW1lID0gInByZXNldF9lbmFi
bGUiLAo+IC0JCS5yZWFkID0gcXVhZDhfY291bnRfcHJlc2V0X2VuYWJsZV9yZWFkLAo+IC0JCS53
cml0ZSA9IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfd3JpdGUKPiAtCX0KPiArc3RhdGljIGNv
bnN0IGVudW0gY291bnRlcl9jb3VudF9tb2RlIHF1YWQ4X2NudF9tb2Rlc1tdID0gewo+ICsJQ09V
TlRFUl9DT1VOVF9NT0RFX05PUk1BTCwKPiArCUNPVU5URVJfQ09VTlRfTU9ERV9SQU5HRV9MSU1J
VCwKPiArCUNPVU5URVJfQ09VTlRfTU9ERV9OT05fUkVDWUNMRSwKPiArCUNPVU5URVJfQ09VTlRf
TU9ERV9NT0RVTE9fTiwKPiArfTsKPiArCj4gK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9BVkFJTEFC
TEUocXVhZDhfY291bnRfbW9kZV9hdmFpbGFibGUsIHF1YWQ4X2NudF9tb2Rlcyk7Cj4gKwo+ICtz
dGF0aWMgREVGSU5FX0NPVU5URVJfRU5VTShxdWFkOF9lcnJvcl9ub2lzZV9lbnVtLCBxdWFkOF9u
b2lzZV9lcnJvcl9zdGF0ZXMpOwo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgcXVh
ZDhfY291bnRfZXh0W10gPSB7Cj4gKwlDT1VOVEVSX0NPTVBfQ0VJTElORyhxdWFkOF9jb3VudF9j
ZWlsaW5nX3JlYWQsCj4gKwkJCSAgICAgcXVhZDhfY291bnRfY2VpbGluZ193cml0ZSksCj4gKwlD
T1VOVEVSX0NPTVBfRkxPT1IocXVhZDhfY291bnRfZmxvb3JfcmVhZCwgTlVMTCksCj4gKwlDT1VO
VEVSX0NPTVBfQ09VTlRfTU9ERShxdWFkOF9jb3VudF9tb2RlX3JlYWQsIHF1YWQ4X2NvdW50X21v
ZGVfd3JpdGUsCj4gKwkJCQlxdWFkOF9jb3VudF9tb2RlX2F2YWlsYWJsZSksCj4gKwlDT1VOVEVS
X0NPTVBfRElSRUNUSU9OKHF1YWQ4X2RpcmVjdGlvbl9yZWFkKSwKPiArCUNPVU5URVJfQ09NUF9F
TkFCTEUocXVhZDhfY291bnRfZW5hYmxlX3JlYWQsIHF1YWQ4X2NvdW50X2VuYWJsZV93cml0ZSks
Cj4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfRU5VTSgiZXJyb3Jfbm9pc2UiLCBxdWFkOF9lcnJvcl9u
b2lzZV9nZXQsIE5VTEwsCj4gKwkJCQlxdWFkOF9lcnJvcl9ub2lzZV9lbnVtKSwKPiArCUNPVU5U
RVJfQ09NUF9QUkVTRVQocXVhZDhfY291bnRfcHJlc2V0X3JlYWQsIHF1YWQ4X2NvdW50X3ByZXNl
dF93cml0ZSksCj4gKwlDT1VOVEVSX0NPTVBfUFJFU0VUX0VOQUJMRShxdWFkOF9jb3VudF9wcmVz
ZXRfZW5hYmxlX3JlYWQsCj4gKwkJCQkgICBxdWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3dyaXRl
KSwKPiAgfTsKPiAgCj4gICNkZWZpbmUgUVVBRDhfQ09VTlQoX2lkLCBfY250bmFtZSkgewkJCQkJ
XAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvTWFrZWZpbGUgYi9kcml2ZXJzL2NvdW50
ZXIvTWFrZWZpbGUKPiBpbmRleCAxOTc0MmU2ZjVlM2UuLjFhYjdlMDg3ZmRjMiAxMDA2NDQKPiAt
LS0gYS9kcml2ZXJzL2NvdW50ZXIvTWFrZWZpbGUKPiArKysgYi9kcml2ZXJzL2NvdW50ZXIvTWFr
ZWZpbGUKPiBAQCAtNCw2ICs0LDcgQEAKPiAgIwo+ICAKPiAgb2JqLSQoQ09ORklHX0NPVU5URVIp
ICs9IGNvdW50ZXIubwo+ICtjb3VudGVyLXkgOj0gY291bnRlci1jb3JlLm8gY291bnRlci1zeXNm
cy5vCj4gIAo+ICBvYmotJChDT05GSUdfMTA0X1FVQURfOCkJKz0gMTA0LXF1YWQtOC5vCj4gIG9i
ai0kKENPTkZJR19JTlRFUlJVUFRfQ05UKQkJKz0gaW50ZXJydXB0LWNudC5vCj4gZGlmZiAtLWdp
dCBhL2RyaXZlcnMvY291bnRlci9jb3VudGVyLWNvcmUuYyBiL2RyaXZlcnMvY291bnRlci9jb3Vu
dGVyLWNvcmUuYwo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi5j
NTMzYTZmZjEyY2YKPiAtLS0gL2Rldi9udWxsCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL2NvdW50
ZXItY29yZS5jCj4gQEAgLTAsMCArMSwxNDIgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjAKPiArLyoKPiArICogR2VuZXJpYyBDb3VudGVyIGludGVyZmFjZQo+ICsgKiBD
b3B5cmlnaHQgKEMpIDIwMjAgV2lsbGlhbSBCcmVhdGhpdHQgR3JheQo+ICsgKi8KPiArI2luY2x1
ZGUgPGxpbnV4L2NvdW50ZXIuaD4KPiArI2luY2x1ZGUgPGxpbnV4L2RldmljZS5oPgo+ICsjaW5j
bHVkZSA8bGludXgvZXhwb3J0Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9nZnAuaD4KPiArI2luY2x1
ZGUgPGxpbnV4L2lkci5oPgo+ICsjaW5jbHVkZSA8bGludXgvaW5pdC5oPgo+ICsjaW5jbHVkZSA8
bGludXgvbW9kdWxlLmg+Cj4gKwo+ICsjaW5jbHVkZSAiY291bnRlci1zeXNmcy5oIgo+ICsKPiAr
LyogUHJvdmlkZXMgYSB1bmlxdWUgSUQgZm9yIGVhY2ggY291bnRlciBkZXZpY2UgKi8KPiArc3Rh
dGljIERFRklORV9JREEoY291bnRlcl9pZGEpOwo+ICsKPiArc3RhdGljIHZvaWQgY291bnRlcl9k
ZXZpY2VfcmVsZWFzZShzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gK3sKPiArCWlkYV9mcmVlKCZjb3Vu
dGVyX2lkYSwgZGV2LT5pZCk7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgZGV2aWNlX3R5cGUg
Y291bnRlcl9kZXZpY2VfdHlwZSA9IHsKPiArCS5uYW1lID0gImNvdW50ZXJfZGV2aWNlIiwKPiAr
CS5yZWxlYXNlID0gY291bnRlcl9kZXZpY2VfcmVsZWFzZSwKPiArfTsKPiArCj4gK3N0YXRpYyBz
dHJ1Y3QgYnVzX3R5cGUgY291bnRlcl9idXNfdHlwZSA9IHsKPiArCS5uYW1lID0gImNvdW50ZXIi
LAo+ICsJLmRldl9uYW1lID0gImNvdW50ZXIiLAo+ICt9Owo+ICsKPiArLyoqCj4gKyAqIGNvdW50
ZXJfcmVnaXN0ZXIgLSByZWdpc3RlciBDb3VudGVyIHRvIHRoZSBzeXN0ZW0KPiArICogQGNvdW50
ZXI6CXBvaW50ZXIgdG8gQ291bnRlciB0byByZWdpc3Rlcgo+ICsgKgo+ICsgKiBUaGlzIGZ1bmN0
aW9uIHJlZ2lzdGVycyBhIENvdW50ZXIgdG8gdGhlIHN5c3RlbS4gQSBzeXNmcyAiY291bnRlciIg
ZGlyZWN0b3J5Cj4gKyAqIHdpbGwgYmUgY3JlYXRlZCBhbmQgcG9wdWxhdGVkIHdpdGggc3lzZnMg
YXR0cmlidXRlcyBjb3JyZWxhdGluZyB3aXRoIHRoZQo+ICsgKiBDb3VudGVyIFNpZ25hbHMsIFN5
bmFwc2VzLCBhbmQgQ291bnRzIHJlc3BlY3RpdmVseS4KPiArICovCj4gK2ludCBjb3VudGVyX3Jl
Z2lzdGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiArewo+ICsJc3Ry
dWN0IGRldmljZSAqY29uc3QgZGV2ID0gJmNvdW50ZXItPmRldjsKPiArCWludCBpZDsKPiArCWlu
dCBlcnI7Cj4gKwo+ICsJLyogQWNxdWlyZSB1bmlxdWUgSUQgKi8KPiArCWlkID0gaWRhX2FsbG9j
KCZjb3VudGVyX2lkYSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoaWQgPCAwKQo+ICsJCXJldHVybiBp
ZDsKPiArCj4gKwkvKiBDb25maWd1cmUgZGV2aWNlIHN0cnVjdHVyZSBmb3IgQ291bnRlciAqLwo+
ICsJZGV2LT5pZCA9IGlkOwo+ICsJZGV2LT50eXBlID0gJmNvdW50ZXJfZGV2aWNlX3R5cGU7Cj4g
KwlkZXYtPmJ1cyA9ICZjb3VudGVyX2J1c190eXBlOwo+ICsJaWYgKGNvdW50ZXItPnBhcmVudCkg
ewo+ICsJCWRldi0+cGFyZW50ID0gY291bnRlci0+cGFyZW50Owo+ICsJCWRldi0+b2Zfbm9kZSA9
IGNvdW50ZXItPnBhcmVudC0+b2Zfbm9kZTsKPiArCX0KPiArCWRldmljZV9pbml0aWFsaXplKGRl
dik7Cj4gKwlkZXZfc2V0X2RydmRhdGEoZGV2LCBjb3VudGVyKTsKPiArCj4gKwkvKiBBZGQgQ291
bnRlciBzeXNmcyBhdHRyaWJ1dGVzICovCj4gKwllcnIgPSBjb3VudGVyX3N5c2ZzX2FkZChjb3Vu
dGVyKTsKPiArCWlmIChlcnIgPCAwKQo+ICsJCWdvdG8gZXJyX2ZyZWVfaWQ7Cj4gKwo+ICsJLyog
QWRkIGRldmljZSB0byBzeXN0ZW0gKi8KPiArCWVyciA9IGRldmljZV9hZGQoZGV2KTsKPiArCWlm
IChlcnIgPCAwKQo+ICsJCWdvdG8gZXJyX2ZyZWVfaWQ7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gKwo+
ICtlcnJfZnJlZV9pZDoKPiArCXB1dF9kZXZpY2UoZGV2KTsKPiArCXJldHVybiBlcnI7Cj4gK30K
PiArRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9yZWdpc3Rlcik7Cj4gKwo+ICsvKioKPiArICog
Y291bnRlcl91bnJlZ2lzdGVyIC0gdW5yZWdpc3RlciBDb3VudGVyIGZyb20gdGhlIHN5c3RlbQo+
ICsgKiBAY291bnRlcjoJcG9pbnRlciB0byBDb3VudGVyIHRvIHVucmVnaXN0ZXIKPiArICoKPiAr
ICogVGhlIENvdW50ZXIgaXMgdW5yZWdpc3RlcmVkIGZyb20gdGhlIHN5c3RlbS4KPiArICovCj4g
K3ZvaWQgY291bnRlcl91bnJlZ2lzdGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291
bnRlcikKPiArewo+ICsJaWYgKCFjb3VudGVyKQo+ICsJCXJldHVybjsKPiArCj4gKwlkZXZpY2Vf
dW5yZWdpc3RlcigmY291bnRlci0+ZGV2KTsKPiArfQo+ICtFWFBPUlRfU1lNQk9MX0dQTChjb3Vu
dGVyX3VucmVnaXN0ZXIpOwo+ICsKPiArc3RhdGljIHZvaWQgZGV2bV9jb3VudGVyX3JlbGVhc2Uo
dm9pZCAqY291bnRlcikKPiArewo+ICsJY291bnRlcl91bnJlZ2lzdGVyKGNvdW50ZXIpOwo+ICt9
Cj4gKwo+ICsvKioKPiArICogZGV2bV9jb3VudGVyX3JlZ2lzdGVyIC0gUmVzb3VyY2UtbWFuYWdl
ZCBjb3VudGVyX3JlZ2lzdGVyCj4gKyAqIEBkZXY6CWRldmljZSB0byBhbGxvY2F0ZSBjb3VudGVy
X2RldmljZSBmb3IKPiArICogQGNvdW50ZXI6CXBvaW50ZXIgdG8gQ291bnRlciB0byByZWdpc3Rl
cgo+ICsgKgo+ICsgKiBNYW5hZ2VkIGNvdW50ZXJfcmVnaXN0ZXIuIFRoZSBDb3VudGVyIHJlZ2lz
dGVyZWQgd2l0aCB0aGlzIGZ1bmN0aW9uIGlzCj4gKyAqIGF1dG9tYXRpY2FsbHkgdW5yZWdpc3Rl
cmVkIG9uIGRyaXZlciBkZXRhY2guIFRoaXMgZnVuY3Rpb24gY2FsbHMKPiArICogY291bnRlcl9y
ZWdpc3RlciBpbnRlcm5hbGx5LiBSZWZlciB0byB0aGF0IGZ1bmN0aW9uIGZvciBtb3JlIGluZm9y
bWF0aW9uLgo+ICsgKgo+ICsgKiBSRVRVUk5TOgo+ICsgKiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZl
IGVycm9yIG51bWJlciBvbiBmYWlsdXJlLgo+ICsgKi8KPiAraW50IGRldm1fY291bnRlcl9yZWdp
c3RlcihzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gKwkJCSAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b25zdCBjb3VudGVyKQo+ICt7Cj4gKwlpbnQgZXJyOwo+ICsKPiArCWVyciA9IGNvdW50ZXJfcmVn
aXN0ZXIoY291bnRlcik7Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiAr
CXJldHVybiBkZXZtX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGV2LCBkZXZtX2NvdW50ZXJfcmVsZWFz
ZSwgY291bnRlcik7Cj4gK30KPiArRVhQT1JUX1NZTUJPTF9HUEwoZGV2bV9jb3VudGVyX3JlZ2lz
dGVyKTsKPiArCj4gK3N0YXRpYyBpbnQgX19pbml0IGNvdW50ZXJfaW5pdCh2b2lkKQo+ICt7Cj4g
KwlyZXR1cm4gYnVzX3JlZ2lzdGVyKCZjb3VudGVyX2J1c190eXBlKTsKPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgX19leGl0IGNvdW50ZXJfZXhpdCh2b2lkKQo+ICt7Cj4gKwlidXNfdW5yZWdpc3Rl
cigmY291bnRlcl9idXNfdHlwZSk7Cj4gK30KPiArCj4gK3N1YnN5c19pbml0Y2FsbChjb3VudGVy
X2luaXQpOwo+ICttb2R1bGVfZXhpdChjb3VudGVyX2V4aXQpOwo+ICsKPiArTU9EVUxFX0FVVEhP
UigiV2lsbGlhbSBCcmVhdGhpdHQgR3JheSA8dmlsaGVsbS5ncmF5QGdtYWlsLmNvbT4iKTsKPiAr
TU9EVUxFX0RFU0NSSVBUSU9OKCJHZW5lcmljIENvdW50ZXIgaW50ZXJmYWNlIik7Cj4gK01PRFVM
RV9MSUNFTlNFKCJHUEwgdjIiKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL2NvdW50
ZXItc3lzZnMuYyBiL2RyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmMKPiBuZXcgZmlsZSBt
b2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMDAwMC4uMTA4Y2JkODM4ZWI5Cj4gLS0tIC9kZXYv
bnVsbAo+ICsrKyBiL2RyaXZlcnMvY291bnRlci9jb3VudGVyLXN5c2ZzLmMKPiBAQCAtMCwwICsx
LDg0OSBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAo+ICsvKgo+ICsg
KiBHZW5lcmljIENvdW50ZXIgc3lzZnMgaW50ZXJmYWNlCj4gKyAqIENvcHlyaWdodCAoQykgMjAy
MCBXaWxsaWFtIEJyZWF0aGl0dCBHcmF5Cj4gKyAqLwo+ICsjaW5jbHVkZSA8bGludXgvY291bnRl
ci5oPgo+ICsjaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9lcnIu
aD4KPiArI2luY2x1ZGUgPGxpbnV4L2dmcC5oPgo+ICsjaW5jbHVkZSA8bGludXgva2VybmVsLmg+
Cj4gKyNpbmNsdWRlIDxsaW51eC9rc3RydG94Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+
Cj4gKyNpbmNsdWRlIDxsaW51eC9zdHJpbmcuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3N5c2ZzLmg+
Cj4gKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ICsKPiArI2luY2x1ZGUgImNvdW50ZXItc3lz
ZnMuaCIKPiArCj4gKy8qKgo+ICsgKiBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgLSBDb3VudGVy
IHN5c2ZzIGF0dHJpYnV0ZQo+ICsgKiBAZGV2X2F0dHI6CWRldmljZSBhdHRyaWJ1dGUgZm9yIHN5
c2ZzCj4gKyAqIEBsOgkJbm9kZSB0byBhZGQgQ291bnRlciBhdHRyaWJ1dGUgdG8gYXR0cmlidXRl
IGdyb3VwIGxpc3QKPiArICogQGNvbXA6CUNvdW50ZXIgY29tcG9uZW50IGNhbGxiYWNrcyBhbmQg
ZGF0YQo+ICsgKiBAc2NvcGU6CUNvdW50ZXIgc2NvcGUgb2YgdGhlIGF0dHJpYnV0ZQo+ICsgKiBA
cGFyZW50Oglwb2ludGVyIHRvIHRoZSBwYXJlbnQgY29tcG9uZW50Cj4gKyAqLwo+ICtzdHJ1Y3Qg
Y291bnRlcl9hdHRyaWJ1dGUgewo+ICsJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgZGV2X2F0dHI7
Cj4gKwlzdHJ1Y3QgbGlzdF9oZWFkIGw7Cj4gKwo+ICsJc3RydWN0IGNvdW50ZXJfY29tcCBjb21w
Owo+ICsJZW51bSBjb3VudGVyX3Njb3BlIHNjb3BlOwo+ICsJdm9pZCAqcGFyZW50Owo+ICt9Owo+
ICsKPiArI2RlZmluZSB0b19jb3VudGVyX2F0dHJpYnV0ZShfZGV2X2F0dHIpIFwKPiArCWNvbnRh
aW5lcl9vZihfZGV2X2F0dHIsIHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSwgZGV2X2F0dHIpCj4g
Kwo+ICsvKioKPiArICogc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwIC0gY29udGFpbmVy
IGZvciBhdHRyaWJ1dGUgZ3JvdXAKPiArICogQG5hbWU6CW5hbWUgb2YgdGhlIGF0dHJpYnV0ZSBn
cm91cAo+ICsgKiBAYXR0cl9saXN0OglsaXN0IHRvIGtlZXAgdHJhY2sgb2YgY3JlYXRlZCBhdHRy
aWJ1dGVzCj4gKyAqIEBudW1fYXR0cjoJbnVtYmVyIG9mIGF0dHJpYnV0ZXMKPiArICovCj4gK3N0
cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCB7Cj4gKwljb25zdCBjaGFyICpuYW1lOwo+ICsJ
c3RydWN0IGxpc3RfaGVhZCBhdHRyX2xpc3Q7Cj4gKwlzaXplX3QgbnVtX2F0dHI7Cj4gK307Cj4g
Kwo+ICtzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9mdW5jdGlvbl9zdHJbXSA9IHsK
PiArCVtDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFXSA9ICJpbmNyZWFzZSIsCj4gKwlbQ09VTlRF
Ul9GVU5DVElPTl9ERUNSRUFTRV0gPSAiZGVjcmVhc2UiLAo+ICsJW0NPVU5URVJfRlVOQ1RJT05f
UFVMU0VfRElSRUNUSU9OXSA9ICJwdWxzZS1kaXJlY3Rpb24iLAo+ICsJW0NPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YMV9BXSA9ICJxdWFkcmF0dXJlIHgxIGEiLAo+ICsJW0NPVU5URVJfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YMV9CXSA9ICJxdWFkcmF0dXJlIHgxIGIiLAo+ICsJW0NPVU5URVJf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BXSA9ICJxdWFkcmF0dXJlIHgyIGEiLAo+ICsJW0NPVU5U
RVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9CXSA9ICJxdWFkcmF0dXJlIHgyIGIiLAo+ICsJW0NP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNF0gPSAicXVhZHJhdHVyZSB4NCIKPiArfTsKPiAr
Cj4gK3N0YXRpYyBjb25zdCBjaGFyICpjb25zdCBjb3VudGVyX3NpZ25hbF92YWx1ZV9zdHJbXSA9
IHsKPiArCVtDT1VOVEVSX1NJR05BTF9MRVZFTF9MT1ddID0gImxvdyIsCj4gKwlbQ09VTlRFUl9T
SUdOQUxfTEVWRUxfSElHSF0gPSAiaGlnaCIKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCBjaGFy
ICpjb25zdCBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX3N0cltdID0gewo+ICsJW0NPVU5URVJfU1lO
QVBTRV9BQ1RJT05fTk9ORV0gPSAibm9uZSIsCj4gKwlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9S
SVNJTkdfRURHRV0gPSAicmlzaW5nIGVkZ2UiLAo+ICsJW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05f
RkFMTElOR19FREdFXSA9ICJmYWxsaW5nIGVkZ2UiLAo+ICsJW0NPVU5URVJfU1lOQVBTRV9BQ1RJ
T05fQk9USF9FREdFU10gPSAiYm90aCBlZGdlcyIKPiArfTsKPiArCj4gK3N0YXRpYyBjb25zdCBj
aGFyICpjb25zdCBjb3VudGVyX2NvdW50X2RpcmVjdGlvbl9zdHJbXSA9IHsKPiArCVtDT1VOVEVS
X0NPVU5UX0RJUkVDVElPTl9GT1JXQVJEXSA9ICJmb3J3YXJkIiwKPiArCVtDT1VOVEVSX0NPVU5U
X0RJUkVDVElPTl9CQUNLV0FSRF0gPSAiYmFja3dhcmQiCj4gK307Cj4gKwo+ICtzdGF0aWMgY29u
c3QgY2hhciAqY29uc3QgY291bnRlcl9jb3VudF9tb2RlX3N0cltdID0gewo+ICsJW0NPVU5URVJf
Q09VTlRfTU9ERV9OT1JNQUxdID0gIm5vcm1hbCIsCj4gKwlbQ09VTlRFUl9DT1VOVF9NT0RFX1JB
TkdFX0xJTUlUXSA9ICJyYW5nZSBsaW1pdCIsCj4gKwlbQ09VTlRFUl9DT1VOVF9NT0RFX05PTl9S
RUNZQ0xFXSA9ICJub24tcmVjeWNsZSIsCj4gKwlbQ09VTlRFUl9DT1VOVF9NT0RFX01PRFVMT19O
XSA9ICJtb2R1bG8tbiIKPiArfTsKPiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91
OF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiArCQkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJp
YnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICt7Cj4gKwljb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRy
aWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKPiArCXN0cnVjdCBj
b3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ICsJ
aW50IGVycjsKPiArCXU4IGRhdGEgPSAwOwo+ICsKPiArCXN3aXRjaCAoYS0+c2NvcGUpIHsKPiAr
CWNhc2UgQ09VTlRFUl9TQ09QRV9ERVZJQ0U6Cj4gKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdThf
cmVhZChjb3VudGVyLCAmZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENPVU5URVJfU0NPUEVf
U0lHTkFMOgo+ICsJCWVyciA9IGEtPmNvbXAuc2lnbmFsX3U4X3JlYWQoY291bnRlciwgYS0+cGFy
ZW50LCAmZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4g
KwkJZXJyID0gYS0+Y29tcC5jb3VudF91OF9yZWFkKGNvdW50ZXIsIGEtPnBhcmVudCwgJmRhdGEp
Owo+ICsJCWJyZWFrOwo+ICsJZGVmYXVsdDoKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiAr
CWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJaWYgKGEtPmNvbXAudHlwZSA9
PSBDT1VOVEVSX0NPTVBfQk9PTCkKPiArCQkvKiBkYXRhIHNob3VsZCBhbHJlYWR5IGJlIGJvb2xl
YW4gYnV0IGVuc3VyZSBqdXN0IHRvIGJlIHNhZmUgKi8KPiArCQlkYXRhID0gISFkYXRhOwo+ICsK
PiArCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAodW5zaWduZWQgaW50KWRhdGEpOwo+ICt9
Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvbXBfdThfc3RvcmUoc3RydWN0IGRldmlj
ZSAqZGV2LAo+ICsJCQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiArCQkJ
CSAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICt7Cj4gKwljb25zdCBzdHJ1Y3Qg
Y291bnRlcl9hdHRyaWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsK
PiArCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0
YShkZXYpOwo+ICsJaW50IGVycjsKPiArCWJvb2wgYm9vbF9kYXRhID0gMDsKPiArCXU4IGRhdGEg
PSAwOwo+ICsKPiArCWlmIChhLT5jb21wLnR5cGUgPT0gQ09VTlRFUl9DT01QX0JPT0wpIHsKPiAr
CQllcnIgPSBrc3RydG9ib29sKGJ1ZiwgJmJvb2xfZGF0YSk7Cj4gKwkJZGF0YSA9IGJvb2xfZGF0
YTsKPiArCX0gZWxzZQo+ICsJCWVyciA9IGtzdHJ0b3U4KGJ1ZiwgMCwgJmRhdGEpOwo+ICsJaWYg
KGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwlzd2l0Y2ggKGEtPnNjb3BlKSB7Cj4g
KwljYXNlIENPVU5URVJfU0NPUEVfREVWSUNFOgo+ICsJCWVyciA9IGEtPmNvbXAuZGV2aWNlX3U4
X3dyaXRlKGNvdW50ZXIsIGRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX1NDT1BF
X1NJR05BTDoKPiArCQllcnIgPSBhLT5jb21wLnNpZ25hbF91OF93cml0ZShjb3VudGVyLCBhLT5w
YXJlbnQsIGRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX1NDT1BFX0NPVU5UOgo+
ICsJCWVyciA9IGEtPmNvbXAuY291bnRfdThfd3JpdGUoY291bnRlciwgYS0+cGFyZW50LCBkYXRh
KTsKPiArCQlicmVhazsKPiArCWRlZmF1bHQ6Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4g
KwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCXJldHVybiBsZW47Cj4gK30K
PiArCj4gK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91MzJfc2hvdyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsCj4gKwkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpi
dWYpCj4gK3sKPiArCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY29uc3QgYSA9IHRv
X2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOwo+ICsJc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25z
dCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gKwljb25zdCBzdHJ1Y3QgY291bnRl
cl9hdmFpbGFibGUgKmNvbnN0IGF2YWlsID0gYS0+Y29tcC5wcml2Owo+ICsJaW50IGVycjsKPiAr
CXUzMiBkYXRhID0gMDsKPiArCj4gKwlzd2l0Y2ggKGEtPnNjb3BlKSB7Cj4gKwljYXNlIENPVU5U
RVJfU0NPUEVfREVWSUNFOgo+ICsJCWVyciA9IGEtPmNvbXAuZGV2aWNlX3UzMl9yZWFkKGNvdW50
ZXIsICZkYXRhKTsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9TSUdOQUw6Cj4g
KwkJZXJyID0gYS0+Y29tcC5zaWduYWxfdTMyX3JlYWQoY291bnRlciwgYS0+cGFyZW50LCAmZGF0
YSk7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENPVU5URVJfU0NPUEVfQ09VTlQ6Cj4gKwkJaWYgKGEt
PmNvbXAudHlwZSA9PSBDT1VOVEVSX0NPTVBfU1lOQVBTRV9BQ1RJT04pCj4gKwkJCWVyciA9IGEt
PmNvbXAuYWN0aW9uX3JlYWQoY291bnRlciwgYS0+cGFyZW50LAo+ICsJCQkJCQkgIGEtPmNvbXAu
cHJpdiwgJmRhdGEpOwo+ICsJCWVsc2UKPiArCQkJZXJyID0gYS0+Y29tcC5jb3VudF91MzJfcmVh
ZChjb3VudGVyLCBhLT5wYXJlbnQsICZkYXRhKTsKPiArCQlicmVhazsKPiArCWRlZmF1bHQ6Cj4g
KwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJy
Owo+ICsKPiArCXN3aXRjaCAoYS0+Y29tcC50eXBlKSB7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9G
VU5DVElPTjoKPiArCQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwgY291bnRlcl9mdW5j
dGlvbl9zdHJbZGF0YV0pOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfU0lHTkFMX0xFVkVMOgo+ICsJ
CXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBjb3VudGVyX3NpZ25hbF92YWx1ZV9zdHJb
ZGF0YV0pOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfU1lOQVBTRV9BQ1RJT046Cj4gKwkJcmV0dXJu
IHN5c2ZzX2VtaXQoYnVmLCAiJXNcbiIsIGNvdW50ZXJfc3luYXBzZV9hY3Rpb25fc3RyW2RhdGFd
KTsKPiArCWNhc2UgQ09VTlRFUl9DT01QX0VOVU06Cj4gKwkJcmV0dXJuIHN5c2ZzX2VtaXQoYnVm
LCAiJXNcbiIsIGF2YWlsLT5zdHJzW2RhdGFdKTsKPiArCWNhc2UgQ09VTlRFUl9DT01QX0NPVU5U
X0RJUkVDVElPTjoKPiArCQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwgY291bnRlcl9j
b3VudF9kaXJlY3Rpb25fc3RyW2RhdGFdKTsKPiArCWNhc2UgQ09VTlRFUl9DT01QX0NPVU5UX01P
REU6Cj4gKwkJcmV0dXJuIHN5c2ZzX2VtaXQoYnVmLCAiJXNcbiIsIGNvdW50ZXJfY291bnRfbW9k
ZV9zdHJbZGF0YV0pOwo+ICsJZGVmYXVsdDoKPiArCQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxu
IiwgKHVuc2lnbmVkIGludClkYXRhKTsKPiArCX0KPiArfQo+ICsKPiArc3RhdGljIGludCBjb3Vu
dGVyX2ZpbmRfZW51bSh1MzIgKmNvbnN0IGVudW1faXRlbSwgY29uc3QgdTMyICpjb25zdCBlbnVt
cywKPiArCQkJICAgICBjb25zdCBzaXplX3QgbnVtX2VudW1zLCBjb25zdCBjaGFyICpjb25zdCBi
dWYsCj4gKwkJCSAgICAgY29uc3QgY2hhciAqY29uc3Qgc3RyaW5nX2FycmF5W10pCj4gK3sKPiAr
CXNpemVfdCBpbmRleDsKPiArCj4gKwlmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBudW1fZW51bXM7
IGluZGV4KyspIHsKPiArCQkqZW51bV9pdGVtID0gZW51bXNbaW5kZXhdOwo+ICsJCWlmIChzeXNm
c19zdHJlcShidWYsIHN0cmluZ19hcnJheVsqZW51bV9pdGVtXSkpCj4gKwkJCXJldHVybiAwOwo+
ICsJfQo+ICsKPiArCXJldHVybiAtRUlOVkFMOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCBj
b3VudGVyX2NvbXBfdTMyX3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiArCQkJCSAgICAgIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ICsJCQkJICAgICAgY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgbGVuKQo+ICt7Cj4gKwljb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNv
bnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKPiArCXN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ICsJc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gYS0+cGFyZW50Owo+ICsJc3RydWN0IGNvdW50ZXJf
c3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGEtPmNvbXAucHJpdjsKPiArCWNvbnN0IHN0cnVjdCBj
b3VudGVyX2F2YWlsYWJsZSAqY29uc3QgYXZhaWwgPSBhLT5jb21wLnByaXY7Cj4gKwlpbnQgZXJy
Owo+ICsJdTMyIGRhdGEgPSAwOwo+ICsKPiArCXN3aXRjaCAoYS0+Y29tcC50eXBlKSB7Cj4gKwlj
YXNlIENPVU5URVJfQ09NUF9GVU5DVElPTjoKPiArCQllcnIgPSBjb3VudGVyX2ZpbmRfZW51bSgm
ZGF0YSwgY291bnQtPmZ1bmN0aW9uc19saXN0LAo+ICsJCQkJCWNvdW50LT5udW1fZnVuY3Rpb25z
LCBidWYsCj4gKwkJCQkJY291bnRlcl9mdW5jdGlvbl9zdHIpOwo+ICsJCWJyZWFrOwo+ICsJY2Fz
ZSBDT1VOVEVSX0NPTVBfU1lOQVBTRV9BQ1RJT046Cj4gKwkJZXJyID0gY291bnRlcl9maW5kX2Vu
dW0oJmRhdGEsIHN5bmFwc2UtPmFjdGlvbnNfbGlzdCwKPiArCQkJCQlzeW5hcHNlLT5udW1fYWN0
aW9ucywgYnVmLAo+ICsJCQkJCWNvdW50ZXJfc3luYXBzZV9hY3Rpb25fc3RyKTsKPiArCQlicmVh
azsKPiArCWNhc2UgQ09VTlRFUl9DT01QX0VOVU06Cj4gKwkJZXJyID0gX19zeXNmc19tYXRjaF9z
dHJpbmcoYXZhaWwtPnN0cnMsIGF2YWlsLT5udW1faXRlbXMsIGJ1Zik7Cj4gKwkJZGF0YSA9IGVy
cjsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9DT01QX0NPVU5UX01PREU6Cj4gKwkJZXJy
ID0gY291bnRlcl9maW5kX2VudW0oJmRhdGEsIGF2YWlsLT5lbnVtcywgYXZhaWwtPm51bV9pdGVt
cywKPiArCQkJCQlidWYsIGNvdW50ZXJfY291bnRfbW9kZV9zdHIpOwo+ICsJCWJyZWFrOwo+ICsJ
ZGVmYXVsdDoKPiArCQllcnIgPSBrc3RydG91MzIoYnVmLCAwLCAmZGF0YSk7Cj4gKwkJYnJlYWs7
Cj4gKwl9Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCXN3aXRjaCAo
YS0+c2NvcGUpIHsKPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9ERVZJQ0U6Cj4gKwkJZXJyID0gYS0+
Y29tcC5kZXZpY2VfdTMyX3dyaXRlKGNvdW50ZXIsIGRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJY2Fz
ZSBDT1VOVEVSX1NDT1BFX1NJR05BTDoKPiArCQllcnIgPSBhLT5jb21wLnNpZ25hbF91MzJfd3Jp
dGUoY291bnRlciwgYS0+cGFyZW50LCBkYXRhKTsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRF
Ul9TQ09QRV9DT1VOVDoKPiArCQlpZiAoYS0+Y29tcC50eXBlID09IENPVU5URVJfQ09NUF9TWU5B
UFNFX0FDVElPTikKPiArCQkJZXJyID0gYS0+Y29tcC5hY3Rpb25fd3JpdGUoY291bnRlciwgY291
bnQsIHN5bmFwc2UsCj4gKwkJCQkJCSAgIGRhdGEpOwo+ICsJCWVsc2UKPiArCQkJZXJyID0gYS0+
Y29tcC5jb3VudF91MzJfd3JpdGUoY291bnRlciwgY291bnQsIGRhdGEpOwo+ICsJCWJyZWFrOwo+
ICsJZGVmYXVsdDoKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArCWlmIChlcnIgPCAwKQo+
ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJcmV0dXJuIGxlbjsKPiArfQo+ICsKPiArc3RhdGljIHNz
aXplX3QgY291bnRlcl9jb21wX3U2NF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiArCQkJCSAg
ICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiArewo+ICsJY29u
c3Qgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlICpjb25zdCBhID0gdG9fY291bnRlcl9hdHRyaWJ1
dGUoYXR0cik7Cj4gKwlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZf
Z2V0X2RydmRhdGEoZGV2KTsKPiArCWludCBlcnI7Cj4gKwl1NjQgZGF0YSA9IDA7Cj4gKwo+ICsJ
c3dpdGNoIChhLT5zY29wZSkgewo+ICsJY2FzZSBDT1VOVEVSX1NDT1BFX0RFVklDRToKPiArCQll
cnIgPSBhLT5jb21wLmRldmljZV91NjRfcmVhZChjb3VudGVyLCAmZGF0YSk7Cj4gKwkJYnJlYWs7
Cj4gKwljYXNlIENPVU5URVJfU0NPUEVfU0lHTkFMOgo+ICsJCWVyciA9IGEtPmNvbXAuc2lnbmFs
X3U2NF9yZWFkKGNvdW50ZXIsIGEtPnBhcmVudCwgJmRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJY2Fz
ZSBDT1VOVEVSX1NDT1BFX0NPVU5UOgo+ICsJCWVyciA9IGEtPmNvbXAuY291bnRfdTY0X3JlYWQo
Y291bnRlciwgYS0+cGFyZW50LCAmZGF0YSk7Cj4gKwkJYnJlYWs7Cj4gKwlkZWZhdWx0Ogo+ICsJ
CXJldHVybiAtRUlOVkFMOwo+ICsJfQo+ICsJaWYgKGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsK
PiArCj4gKwlyZXR1cm4gc3ByaW50ZihidWYsICIlbGx1XG4iLCAodW5zaWduZWQgbG9uZyBsb25n
KWRhdGEpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvbXBfdTY0X3N0b3Jl
KHN0cnVjdCBkZXZpY2UgKmRldiwKPiArCQkJCSAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLAo+ICsJCQkJICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICt7Cj4g
Kwljb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0
dHJpYnV0ZShhdHRyKTsKPiArCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9
IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+ICsJaW50IGVycjsKPiArCXU2NCBkYXRhID0gMDsKPiAr
Cj4gKwllcnIgPSBrc3RydG91NjQoYnVmLCAwLCAmZGF0YSk7Cj4gKwlpZiAoZXJyIDwgMCkKPiAr
CQlyZXR1cm4gZXJyOwo+ICsKPiArCXN3aXRjaCAoYS0+c2NvcGUpIHsKPiArCWNhc2UgQ09VTlRF
Ul9TQ09QRV9ERVZJQ0U6Cj4gKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdTY0X3dyaXRlKGNvdW50
ZXIsIGRhdGEpOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX1NDT1BFX1NJR05BTDoKPiAr
CQllcnIgPSBhLT5jb21wLnNpZ25hbF91NjRfd3JpdGUoY291bnRlciwgYS0+cGFyZW50LCBkYXRh
KTsKPiArCQlicmVhazsKPiArCWNhc2UgQ09VTlRFUl9TQ09QRV9DT1VOVDoKPiArCQllcnIgPSBh
LT5jb21wLmNvdW50X3U2NF93cml0ZShjb3VudGVyLCBhLT5wYXJlbnQsIGRhdGEpOwo+ICsJCWJy
ZWFrOwo+ICsJZGVmYXVsdDoKPiArCQlyZXR1cm4gLUVJTlZBTDsKPiArCX0KPiArCWlmIChlcnIg
PCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJcmV0dXJuIGxlbjsKPiArfQo+ICsKPiArc3Rh
dGljIHNzaXplX3QgZW51bXNfYXZhaWxhYmxlX3Nob3coY29uc3QgdTMyICpjb25zdCBlbnVtcywK
PiArCQkJCSAgICBjb25zdCBzaXplX3QgbnVtX2VudW1zLAo+ICsJCQkJICAgIGNvbnN0IGNoYXIg
KmNvbnN0IHN0cnNbXSwgY2hhciAqYnVmKQo+ICt7Cj4gKwlzaXplX3QgbGVuID0gMDsKPiArCXNp
emVfdCBpbmRleDsKPiArCj4gKwlmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBudW1fZW51bXM7IGlu
ZGV4KyspCj4gKwkJbGVuICs9IHN5c2ZzX2VtaXRfYXQoYnVmLCBsZW4sICIlc1xuIiwgc3Ryc1tl
bnVtc1tpbmRleF1dKTsKPiArCj4gKwlyZXR1cm4gbGVuOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3Np
emVfdCBzdHJzX2F2YWlsYWJsZV9zaG93KGNvbnN0IHN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSAq
Y29uc3QgYXZhaWwsCj4gKwkJCQkgICBjaGFyICpidWYpCj4gK3sKPiArCXNpemVfdCBsZW4gPSAw
Owo+ICsJc2l6ZV90IGluZGV4Owo+ICsKPiArCWZvciAoaW5kZXggPSAwOyBpbmRleCA8IGF2YWls
LT5udW1faXRlbXM7IGluZGV4KyspCj4gKwkJbGVuICs9IHN5c2ZzX2VtaXRfYXQoYnVmLCBsZW4s
ICIlc1xuIiwgYXZhaWwtPnN0cnNbaW5kZXhdKTsKPiArCj4gKwlyZXR1cm4gbGVuOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvbXBfYXZhaWxhYmxlX3Nob3coc3RydWN0IGRl
dmljZSAqZGV2LAo+ICsJCQkJCSAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+ICsJ
CQkJCSAgIGNoYXIgKmJ1ZikKPiArewo+ICsJY29uc3Qgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRl
ICpjb25zdCBhID0gdG9fY291bnRlcl9hdHRyaWJ1dGUoYXR0cik7Cj4gKwljb25zdCBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBhLT5wYXJlbnQ7Cj4gKwljb25zdCBzdHJ1Y3Qg
Y291bnRlcl9zeW5hcHNlICpjb25zdCBzeW5hcHNlID0gYS0+Y29tcC5wcml2Owo+ICsJY29uc3Qg
c3RydWN0IGNvdW50ZXJfYXZhaWxhYmxlICpjb25zdCBhdmFpbCA9IGEtPmNvbXAucHJpdjsKPiAr
Cj4gKwlzd2l0Y2ggKGEtPmNvbXAudHlwZSkgewo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfRlVOQ1RJ
T046Cj4gKwkJcmV0dXJuIGVudW1zX2F2YWlsYWJsZV9zaG93KGNvdW50LT5mdW5jdGlvbnNfbGlz
dCwKPiArCQkJCQkgICAgY291bnQtPm51bV9mdW5jdGlvbnMsCj4gKwkJCQkJICAgIGNvdW50ZXJf
ZnVuY3Rpb25fc3RyLCBidWYpOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfU1lOQVBTRV9BQ1RJT046
Cj4gKwkJcmV0dXJuIGVudW1zX2F2YWlsYWJsZV9zaG93KHN5bmFwc2UtPmFjdGlvbnNfbGlzdCwK
PiArCQkJCQkgICAgc3luYXBzZS0+bnVtX2FjdGlvbnMsCj4gKwkJCQkJICAgIGNvdW50ZXJfc3lu
YXBzZV9hY3Rpb25fc3RyLCBidWYpOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKPiArCQly
ZXR1cm4gc3Ryc19hdmFpbGFibGVfc2hvdyhhdmFpbCwgYnVmKTsKPiArCWNhc2UgQ09VTlRFUl9D
T01QX0NPVU5UX01PREU6Cj4gKwkJcmV0dXJuIGVudW1zX2F2YWlsYWJsZV9zaG93KGF2YWlsLT5l
bnVtcywgYXZhaWwtPm51bV9pdGVtcywKPiArCQkJCQkgICAgY291bnRlcl9jb3VudF9tb2RlX3N0
ciwgYnVmKTsKPiArCWRlZmF1bHQ6Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gK30KPiAr
Cj4gK3N0YXRpYyBpbnQgY291bnRlcl9hdmFpbF9hdHRyX2NyZWF0ZShzdHJ1Y3QgZGV2aWNlICpj
b25zdCBkZXYsCj4gKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGdyb3Vw
LAo+ICsJY29uc3Qgc3RydWN0IGNvdW50ZXJfY29tcCAqY29uc3QgY29tcCwgdm9pZCAqY29uc3Qg
cGFyZW50KQo+ICt7Cj4gKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKmNvdW50ZXJfYXR0cjsK
PiArCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICpkZXZfYXR0cjsKPiArCj4gKwljb3VudGVyX2F0
dHIgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmNvdW50ZXJfYXR0ciksIEdGUF9LRVJORUwp
Owo+ICsJaWYgKCFjb3VudGVyX2F0dHIpCj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJLyog
Q29uZmlndXJlIENvdW50ZXIgYXR0cmlidXRlICovCj4gKwljb3VudGVyX2F0dHItPmNvbXAudHlw
ZSA9IGNvbXAtPnR5cGU7Cj4gKwljb3VudGVyX2F0dHItPmNvbXAucHJpdiA9IGNvbXAtPnByaXY7
Cj4gKwljb3VudGVyX2F0dHItPnBhcmVudCA9IHBhcmVudDsKPiArCj4gKwkvKiBJbml0aWFsaXpl
IHN5c2ZzIGF0dHJpYnV0ZSAqLwo+ICsJZGV2X2F0dHIgPSAmY291bnRlcl9hdHRyLT5kZXZfYXR0
cjsKPiArCXN5c2ZzX2F0dHJfaW5pdCgmZGV2X2F0dHItPmF0dHIpOwo+ICsKPiArCS8qIENvbmZp
Z3VyZSBkZXZpY2UgYXR0cmlidXRlICovCj4gKwlkZXZfYXR0ci0+YXR0ci5uYW1lID0gZGV2bV9r
YXNwcmludGYoZGV2LCBHRlBfS0VSTkVMLCAiJXNfYXZhaWxhYmxlIiwKPiArCQkJCQkgICAgIGNv
bXAtPm5hbWUpOwo+ICsJaWYgKCFkZXZfYXR0ci0+YXR0ci5uYW1lKQo+ICsJCXJldHVybiAtRU5P
TUVNOwo+ICsJZGV2X2F0dHItPmF0dHIubW9kZSA9IDA0NDQ7Cj4gKwlkZXZfYXR0ci0+c2hvdyA9
IGNvdW50ZXJfY29tcF9hdmFpbGFibGVfc2hvdzsKPiArCj4gKwkvKiBTdG9yZSBsaXN0IG5vZGUg
Ki8KPiArCWxpc3RfYWRkKCZjb3VudGVyX2F0dHItPmwsICZncm91cC0+YXR0cl9saXN0KTsKPiAr
CWdyb3VwLT5udW1fYXR0cisrOwo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtzdGF0aWMg
aW50IGNvdW50ZXJfYXR0cl9jcmVhdGUoc3RydWN0IGRldmljZSAqY29uc3QgZGV2LAo+ICsJCQkg
ICAgICAgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBncm91cCwKPiArCQkJ
ICAgICAgIGNvbnN0IHN0cnVjdCBjb3VudGVyX2NvbXAgKmNvbnN0IGNvbXAsCj4gKwkJCSAgICAg
ICBjb25zdCBlbnVtIGNvdW50ZXJfc2NvcGUgc2NvcGUsCj4gKwkJCSAgICAgICB2b2lkICpjb25z
dCBwYXJlbnQpCj4gK3sKPiArCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY291bnRlcl9hdHRy
Owo+ICsJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmRldl9hdHRyOwo+ICsKPiArCWNvdW50ZXJf
YXR0ciA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqY291bnRlcl9hdHRyKSwgR0ZQX0tFUk5F
TCk7Cj4gKwlpZiAoIWNvdW50ZXJfYXR0cikKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwkv
KiBDb25maWd1cmUgQ291bnRlciBhdHRyaWJ1dGUgKi8KPiArCWNvdW50ZXJfYXR0ci0+Y29tcCA9
ICpjb21wOwo+ICsJY291bnRlcl9hdHRyLT5zY29wZSA9IHNjb3BlOwo+ICsJY291bnRlcl9hdHRy
LT5wYXJlbnQgPSBwYXJlbnQ7Cj4gKwo+ICsJLyogQ29uZmlndXJlIGRldmljZSBhdHRyaWJ1dGUg
Ki8KPiArCWRldl9hdHRyID0gJmNvdW50ZXJfYXR0ci0+ZGV2X2F0dHI7Cj4gKwlzeXNmc19hdHRy
X2luaXQoJmRldl9hdHRyLT5hdHRyKTsKPiArCWRldl9hdHRyLT5hdHRyLm5hbWUgPSBjb21wLT5u
YW1lOwo+ICsJc3dpdGNoIChjb21wLT50eXBlKSB7Cj4gKwljYXNlIENPVU5URVJfQ09NUF9VODoK
PiArCWNhc2UgQ09VTlRFUl9DT01QX0JPT0w6Cj4gKwkJaWYgKGNvbXAtPmRldmljZV91OF9yZWFk
KSB7Cj4gKwkJCWRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDQ0NDsKPiArCQkJZGV2X2F0dHItPnNo
b3cgPSBjb3VudGVyX2NvbXBfdThfc2hvdzsKPiArCQl9Cj4gKwkJaWYgKGNvbXAtPmRldmljZV91
OF93cml0ZSkgewo+ICsJCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDAyMDA7Cj4gKwkJCWRldl9h
dHRyLT5zdG9yZSA9IGNvdW50ZXJfY29tcF91OF9zdG9yZTsKPiArCQl9Cj4gKwkJYnJlYWs7Cj4g
KwljYXNlIENPVU5URVJfQ09NUF9TSUdOQUxfTEVWRUw6Cj4gKwljYXNlIENPVU5URVJfQ09NUF9G
VU5DVElPTjoKPiArCWNhc2UgQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OOgo+ICsJY2FzZSBD
T1VOVEVSX0NPTVBfRU5VTToKPiArCWNhc2UgQ09VTlRFUl9DT01QX0NPVU5UX0RJUkVDVElPTjoK
PiArCWNhc2UgQ09VTlRFUl9DT01QX0NPVU5UX01PREU6Cj4gKwkJaWYgKGNvbXAtPmRldmljZV91
MzJfcmVhZCkgewo+ICsJCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDA0NDQ7Cj4gKwkJCWRldl9h
dHRyLT5zaG93ID0gY291bnRlcl9jb21wX3UzMl9zaG93Owo+ICsJCX0KPiArCQlpZiAoY29tcC0+
ZGV2aWNlX3UzMl93cml0ZSkgewo+ICsJCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDAyMDA7Cj4g
KwkJCWRldl9hdHRyLT5zdG9yZSA9IGNvdW50ZXJfY29tcF91MzJfc3RvcmU7Cj4gKwkJfQo+ICsJ
CWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX0NPTVBfVTY0Ogo+ICsJCWlmIChjb21wLT5kZXZpY2Vf
dTY0X3JlYWQpIHsKPiArCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwNDQ0Owo+ICsJCQlkZXZf
YXR0ci0+c2hvdyA9IGNvdW50ZXJfY29tcF91NjRfc2hvdzsKPiArCQl9Cj4gKwkJaWYgKGNvbXAt
PmRldmljZV91NjRfd3JpdGUpIHsKPiArCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAwOwo+
ICsJCQlkZXZfYXR0ci0+c3RvcmUgPSBjb3VudGVyX2NvbXBfdTY0X3N0b3JlOwo+ICsJCX0KPiAr
CQlicmVhazsKPiArCWRlZmF1bHQ6Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4gKwo+ICsJ
LyogU3RvcmUgbGlzdCBub2RlICovCj4gKwlsaXN0X2FkZCgmY291bnRlcl9hdHRyLT5sLCAmZ3Jv
dXAtPmF0dHJfbGlzdCk7Cj4gKwlncm91cC0+bnVtX2F0dHIrKzsKPiArCj4gKwkvKiBDcmVhdGUg
IipfYXZhaWxhYmxlIiBhdHRyaWJ1dGUgaWYgbmVlZGVkICovCj4gKwlzd2l0Y2ggKGNvbXAtPnR5
cGUpIHsKPiArCWNhc2UgQ09VTlRFUl9DT01QX0ZVTkNUSU9OOgo+ICsJY2FzZSBDT1VOVEVSX0NP
TVBfU1lOQVBTRV9BQ1RJT046Cj4gKwljYXNlIENPVU5URVJfQ09NUF9FTlVNOgo+ICsJY2FzZSBD
T1VOVEVSX0NPTVBfQ09VTlRfTU9ERToKPiArCQlyZXR1cm4gY291bnRlcl9hdmFpbF9hdHRyX2Ny
ZWF0ZShkZXYsIGdyb3VwLCBjb21wLCBwYXJlbnQpOwo+ICsJZGVmYXVsdDoKPiArCQlyZXR1cm4g
MDsKPiArCX0KPiArfQo+ICsKPiArc3RhdGljIHNzaXplX3QgY291bnRlcl9jb21wX25hbWVfc2hv
dyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gKwkJCQkgICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwgY2hhciAqYnVmKQo+ICt7Cj4gKwlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xu
IiwgdG9fY291bnRlcl9hdHRyaWJ1dGUoYXR0ciktPmNvbXAubmFtZSk7Cj4gK30KPiArCj4gK3N0
YXRpYyBpbnQgY291bnRlcl9uYW1lX2F0dHJfY3JlYXRlKHN0cnVjdCBkZXZpY2UgKmNvbnN0IGRl
diwKPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGdyb3Vw
LAo+ICsJCQkJICAgIGNvbnN0IGNoYXIgKmNvbnN0IG5hbWUpCj4gK3sKPiArCXN0cnVjdCBjb3Vu
dGVyX2F0dHJpYnV0ZSAqY291bnRlcl9hdHRyOwo+ICsKPiArCWNvdW50ZXJfYXR0ciA9IGRldm1f
a3phbGxvYyhkZXYsIHNpemVvZigqY291bnRlcl9hdHRyKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAo
IWNvdW50ZXJfYXR0cikKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCj4gKwkvKiBDb25maWd1cmUg
Q291bnRlciBhdHRyaWJ1dGUgKi8KPiArCWNvdW50ZXJfYXR0ci0+Y29tcC5uYW1lID0gbmFtZTsK
PiArCj4gKwkvKiBDb25maWd1cmUgZGV2aWNlIGF0dHJpYnV0ZSAqLwo+ICsJc3lzZnNfYXR0cl9p
bml0KCZjb3VudGVyX2F0dHItPmRldl9hdHRyLmF0dHIpOwo+ICsJY291bnRlcl9hdHRyLT5kZXZf
YXR0ci5hdHRyLm5hbWUgPSAibmFtZSI7Cj4gKwljb3VudGVyX2F0dHItPmRldl9hdHRyLmF0dHIu
bW9kZSA9IDA0NDQ7Cj4gKwljb3VudGVyX2F0dHItPmRldl9hdHRyLnNob3cgPSBjb3VudGVyX2Nv
bXBfbmFtZV9zaG93Owo+ICsKPiArCS8qIFN0b3JlIGxpc3Qgbm9kZSAqLwo+ICsJbGlzdF9hZGQo
JmNvdW50ZXJfYXR0ci0+bCwgJmdyb3VwLT5hdHRyX2xpc3QpOwo+ICsJZ3JvdXAtPm51bV9hdHRy
Kys7Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9j
b21wIGNvdW50ZXJfc2lnbmFsX2NvbXAgPSB7Cj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9TSUdO
QUxfTEVWRUwsCj4gKwkubmFtZSA9ICJzaWduYWwiLAo+ICt9Owo+ICsKPiArc3RhdGljIGludCBj
b3VudGVyX3NpZ25hbF9hdHRyc19jcmVhdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBj
b3VudGVyLAo+ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBjYXR0cl9n
cm91cCwKPiArCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qgc2lnbmFsKQo+ICt7Cj4gKwlj
b25zdCBlbnVtIGNvdW50ZXJfc2NvcGUgc2NvcGUgPSBDT1VOVEVSX1NDT1BFX1NJR05BTDsKPiAr
CXN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7Cj4gKwlpbnQgZXJyOwo+
ICsJc3RydWN0IGNvdW50ZXJfY29tcCBjb21wOwo+ICsJc2l6ZV90IGk7Cj4gKwo+ICsJLyogQ3Jl
YXRlIG1haW4gU2lnbmFsIGF0dHJpYnV0ZSAqLwo+ICsJY29tcCA9IGNvdW50ZXJfc2lnbmFsX2Nv
bXA7Cj4gKwljb21wLnNpZ25hbF91MzJfcmVhZCA9IGNvdW50ZXItPm9wcy0+c2lnbmFsX3JlYWQ7
Cj4gKwllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsICZjb21wLCBz
Y29wZSwgc2lnbmFsKTsKPiArCWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJ
LyogQ3JlYXRlIFNpZ25hbCBuYW1lIGF0dHJpYnV0ZSAqLwo+ICsJZXJyID0gY291bnRlcl9uYW1l
X2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsIHNpZ25hbC0+bmFtZSk7Cj4gKwlpZiAoZXJy
IDwgMCkKPiArCQlyZXR1cm4gZXJyOwo+ICsKPiArCS8qIENyZWF0ZSBhbiBhdHRyaWJ1dGUgZm9y
IGVhY2ggZXh0ZW5zaW9uICovCj4gKwlmb3IgKGkgPSAwOyBpIDwgc2lnbmFsLT5udW1fZXh0OyBp
KyspIHsKPiArCQllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsIHNp
Z25hbC0+ZXh0ICsgaSwKPiArCQkJCQkgIHNjb3BlLCBzaWduYWwpOwo+ICsJCWlmIChlcnIgPCAw
KQo+ICsJCQlyZXR1cm4gZXJyOwo+ICsJfQo+ICsKPiArCXJldHVybiAwOwo+ICt9Cj4gKwo+ICtz
dGF0aWMgaW50IGNvdW50ZXJfc3lzZnNfc2lnbmFsc19hZGQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb25zdCBjb3VudGVyLAo+ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25z
dCBncm91cHMpCj4gK3sKPiArCXNpemVfdCBpOwo+ICsJaW50IGVycjsKPiArCj4gKwkvKiBBZGQg
ZWFjaCBTaWduYWwgKi8KPiArCWZvciAoaSA9IDA7IGkgPCBjb3VudGVyLT5udW1fc2lnbmFsczsg
aSsrKSB7Cj4gKwkJLyogR2VuZXJhdGUgU2lnbmFsIGF0dHJpYnV0ZSBkaXJlY3RvcnkgbmFtZSAq
Lwo+ICsJCWdyb3Vwc1tpXS5uYW1lID0gZGV2bV9rYXNwcmludGYoJmNvdW50ZXItPmRldiwgR0ZQ
X0tFUk5FTCwKPiArCQkJCQkJInNpZ25hbCV6dSIsIGkpOwo+ICsJCWlmICghZ3JvdXBzW2ldLm5h
bWUpCj4gKwkJCXJldHVybiAtRU5PTUVNOwo+ICsKPiArCQkvKiBDcmVhdGUgYWxsIGF0dHJpYnV0
ZXMgYXNzb2NpYXRlZCB3aXRoIFNpZ25hbCAqLwo+ICsJCWVyciA9IGNvdW50ZXJfc2lnbmFsX2F0
dHJzX2NyZWF0ZShjb3VudGVyLCBncm91cHMgKyBpLAo+ICsJCQkJCQkgIGNvdW50ZXItPnNpZ25h
bHMgKyBpKTsKPiArCQlpZiAoZXJyIDwgMCkKPiArCQkJcmV0dXJuIGVycjsKPiArCX0KPiArCj4g
KwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBjb3VudGVyX3N5c2ZzX3N5bmFwc2Vz
X2FkZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIsCj4gKwlzdHJ1Y3QgY291
bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGdyb3VwLAo+ICsJc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvbnN0IGNvdW50KQo+ICt7Cj4gKwlzaXplX3QgaTsKPiArCj4gKwkvKiBBZGQgZWFjaCBT
eW5hcHNlICovCj4gKwlmb3IgKGkgPSAwOyBpIDwgY291bnQtPm51bV9zeW5hcHNlczsgaSsrKSB7
Cj4gKwkJc3RydWN0IGRldmljZSAqY29uc3QgZGV2ID0gJmNvdW50ZXItPmRldjsKPiArCQlzdHJ1
Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlOwo+ICsJCXNpemVfdCBpZDsKPiArCQlzdHJ1Y3Qg
Y291bnRlcl9jb21wIGNvbXA7Cj4gKwkJaW50IGVycjsKPiArCj4gKwkJc3luYXBzZSA9IGNvdW50
LT5zeW5hcHNlcyArIGk7Cj4gKwo+ICsJCS8qIEdlbmVyYXRlIFN5bmFwc2UgYWN0aW9uIG5hbWUg
Ki8KPiArCQlpZCA9IHN5bmFwc2UtPnNpZ25hbCAtIGNvdW50ZXItPnNpZ25hbHM7Cj4gKwkJY29t
cC5uYW1lID0gZGV2bV9rYXNwcmludGYoZGV2LCBHRlBfS0VSTkVMLCAic2lnbmFsJXp1X2FjdGlv
biIsCj4gKwkJCQkJICAgaWQpOwo+ICsJCWlmICghY29tcC5uYW1lKQo+ICsJCQlyZXR1cm4gLUVO
T01FTTsKPiArCj4gKwkJLyogQ3JlYXRlIGFjdGlvbiBhdHRyaWJ1dGUgKi8KPiArCQljb21wLnR5
cGUgPSBDT1VOVEVSX0NPTVBfU1lOQVBTRV9BQ1RJT047Cj4gKwkJY29tcC5hY3Rpb25fcmVhZCA9
IGNvdW50ZXItPm9wcy0+YWN0aW9uX3JlYWQ7Cj4gKwkJY29tcC5hY3Rpb25fd3JpdGUgPSBjb3Vu
dGVyLT5vcHMtPmFjdGlvbl93cml0ZTsKPiArCQljb21wLnByaXYgPSBzeW5hcHNlOwo+ICsJCWVy
ciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBncm91cCwgJmNvbXAsCj4gKwkJCQkJICBDT1VO
VEVSX1NDT1BFX0NPVU5ULCBjb3VudCk7Cj4gKwkJaWYgKGVyciA8IDApCj4gKwkJCXJldHVybiBl
cnI7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgY291
bnRlcl9jb21wIGNvdW50ZXJfY291bnRfY29tcCA9Cj4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfVTY0
KCJjb3VudCIsIE5VTEwsIE5VTEwpOwo+ICsKPiArc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAg
Y291bnRlcl9mdW5jdGlvbl9jb21wID0gewo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfRlVOQ1RJ
T04sCj4gKwkubmFtZSA9ICJmdW5jdGlvbiIsCj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IGNvdW50
ZXJfY291bnRfYXR0cnNfY3JlYXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRl
ciwKPiArCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqY29uc3QgY2F0dHJfZ3JvdXAs
Cj4gKwlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQpCj4gK3sKPiArCWNvbnN0IGVu
dW0gY291bnRlcl9zY29wZSBzY29wZSA9IENPVU5URVJfU0NPUEVfQ09VTlQ7Cj4gKwlzdHJ1Y3Qg
ZGV2aWNlICpjb25zdCBkZXYgPSAmY291bnRlci0+ZGV2Owo+ICsJaW50IGVycjsKPiArCXN0cnVj
dCBjb3VudGVyX2NvbXAgY29tcDsKPiArCXNpemVfdCBpOwo+ICsKPiArCS8qIENyZWF0ZSBtYWlu
IENvdW50IGF0dHJpYnV0ZSAqLwo+ICsJY29tcCA9IGNvdW50ZXJfY291bnRfY29tcDsKPiArCWNv
bXAuY291bnRfdTY0X3JlYWQgPSBjb3VudGVyLT5vcHMtPmNvdW50X3JlYWQ7Cj4gKwljb21wLmNv
dW50X3U2NF93cml0ZSA9IGNvdW50ZXItPm9wcy0+Y291bnRfd3JpdGU7Cj4gKwllcnIgPSBjb3Vu
dGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsICZjb21wLCBzY29wZSwgY291bnQpOwo+
ICsJaWYgKGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwkvKiBDcmVhdGUgQ291bnQg
bmFtZSBhdHRyaWJ1dGUgKi8KPiArCWVyciA9IGNvdW50ZXJfbmFtZV9hdHRyX2NyZWF0ZShkZXYs
IGNhdHRyX2dyb3VwLCBjb3VudC0+bmFtZSk7Cj4gKwlpZiAoZXJyIDwgMCkKPiArCQlyZXR1cm4g
ZXJyOwo+ICsKPiArCS8qIENyZWF0ZSBDb3VudCBmdW5jdGlvbiBhdHRyaWJ1dGUgKi8KPiArCWNv
bXAgPSBjb3VudGVyX2Z1bmN0aW9uX2NvbXA7Cj4gKwljb21wLmNvdW50X3UzMl9yZWFkID0gY291
bnRlci0+b3BzLT5mdW5jdGlvbl9yZWFkOwo+ICsJY29tcC5jb3VudF91MzJfd3JpdGUgPSBjb3Vu
dGVyLT5vcHMtPmZ1bmN0aW9uX3dyaXRlOwo+ICsJZXJyID0gY291bnRlcl9hdHRyX2NyZWF0ZShk
ZXYsIGNhdHRyX2dyb3VwLCAmY29tcCwgc2NvcGUsIGNvdW50KTsKPiArCWlmIChlcnIgPCAwKQo+
ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJLyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBl
eHRlbnNpb24gKi8KPiArCWZvciAoaSA9IDA7IGkgPCBjb3VudC0+bnVtX2V4dDsgaSsrKSB7Cj4g
KwkJZXJyID0gY291bnRlcl9hdHRyX2NyZWF0ZShkZXYsIGNhdHRyX2dyb3VwLCBjb3VudC0+ZXh0
ICsgaSwKPiArCQkJCQkgIHNjb3BlLCBjb3VudCk7Cj4gKwkJaWYgKGVyciA8IDApCj4gKwkJCXJl
dHVybiBlcnI7Cj4gKwl9Cj4gKwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBpbnQg
Y291bnRlcl9zeXNmc19jb3VudHNfYWRkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291
bnRlciwKPiArCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqY29uc3QgZ3JvdXBzKQo+
ICt7Cj4gKwlzaXplX3QgaTsKPiArCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKPiArCWlu
dCBlcnI7Cj4gKwo+ICsJLyogQWRkIGVhY2ggQ291bnQgKi8KPiArCWZvciAoaSA9IDA7IGkgPCBj
b3VudGVyLT5udW1fY291bnRzOyBpKyspIHsKPiArCQljb3VudCA9IGNvdW50ZXItPmNvdW50cyAr
IGk7Cj4gKwo+ICsJCS8qIEdlbmVyYXRlIENvdW50IGF0dHJpYnV0ZSBkaXJlY3RvcnkgbmFtZSAq
Lwo+ICsJCWdyb3Vwc1tpXS5uYW1lID0gZGV2bV9rYXNwcmludGYoJmNvdW50ZXItPmRldiwgR0ZQ
X0tFUk5FTCwKPiArCQkJCQkJImNvdW50JXp1IiwgaSk7Cj4gKwkJaWYgKCFncm91cHNbaV0ubmFt
ZSkKPiArCQkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJCS8qIEFkZCBzeXNmcyBhdHRyaWJ1dGVz
IG9mIHRoZSBTeW5hcHNlcyAqLwo+ICsJCWVyciA9IGNvdW50ZXJfc3lzZnNfc3luYXBzZXNfYWRk
KGNvdW50ZXIsIGdyb3VwcyArIGksIGNvdW50KTsKPiArCQlpZiAoZXJyIDwgMCkKPiArCQkJcmV0
dXJuIGVycjsKPiArCj4gKwkJLyogQ3JlYXRlIGFsbCBhdHRyaWJ1dGVzIGFzc29jaWF0ZWQgd2l0
aCBDb3VudCAqLwo+ICsJCWVyciA9IGNvdW50ZXJfY291bnRfYXR0cnNfY3JlYXRlKGNvdW50ZXIs
IGdyb3VwcyArIGksIGNvdW50KTsKPiArCQlpZiAoZXJyIDwgMCkKPiArCQkJcmV0dXJuIGVycjsK
PiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiArfQo+ICsKPiArc3RhdGljIGludCBjb3VudGVyX251
bV9zaWduYWxzX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB1OCAqdmFsKQo+
ICt7Cj4gKwkqdmFsID0gY291bnRlci0+bnVtX3NpZ25hbHM7Cj4gKwlyZXR1cm4gMDsKPiArfQo+
ICsKPiArc3RhdGljIGludCBjb3VudGVyX251bV9jb3VudHNfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsIHU4ICp2YWwpCj4gK3sKPiArCSp2YWwgPSBjb3VudGVyLT5udW1fY291
bnRzOwo+ICsJcmV0dXJuIDA7Cj4gK30KPiArCj4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21w
IGNvdW50ZXJfbnVtX3NpZ25hbHNfY29tcCA9Cj4gKwlDT1VOVEVSX0NPTVBfREVWSUNFX1U4KCJu
dW1fc2lnbmFscyIsIGNvdW50ZXJfbnVtX3NpZ25hbHNfcmVhZCwgTlVMTCk7Cj4gKwo+ICtzdGF0
aWMgc3RydWN0IGNvdW50ZXJfY29tcCBjb3VudGVyX251bV9jb3VudHNfY29tcCA9Cj4gKwlDT1VO
VEVSX0NPTVBfREVWSUNFX1U4KCJudW1fY291bnRzIiwgY291bnRlcl9udW1fY291bnRzX3JlYWQs
IE5VTEwpOwo+ICsKPiArc3RhdGljIGludCBjb3VudGVyX3N5c2ZzX2F0dHJfYWRkKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciwKPiArCQkJCSAgc3RydWN0IGNvdW50ZXJfYXR0
cmlidXRlX2dyb3VwICpjYXR0cl9ncm91cCkKPiArewo+ICsJY29uc3QgZW51bSBjb3VudGVyX3Nj
b3BlIHNjb3BlID0gQ09VTlRFUl9TQ09QRV9ERVZJQ0U7Cj4gKwlzdHJ1Y3QgZGV2aWNlICpjb25z
dCBkZXYgPSAmY291bnRlci0+ZGV2Owo+ICsJaW50IGVycjsKPiArCXNpemVfdCBpOwo+ICsKPiAr
CS8qIEFkZCBTaWduYWxzIHN5c2ZzIGF0dHJpYnV0ZXMgKi8KPiArCWVyciA9IGNvdW50ZXJfc3lz
ZnNfc2lnbmFsc19hZGQoY291bnRlciwgY2F0dHJfZ3JvdXApOwo+ICsJaWYgKGVyciA8IDApCj4g
KwkJcmV0dXJuIGVycjsKPiArCWNhdHRyX2dyb3VwICs9IGNvdW50ZXItPm51bV9zaWduYWxzOwo+
ICsKPiArCS8qIEFkZCBDb3VudHMgc3lzZnMgYXR0cmlidXRlcyAqLwo+ICsJZXJyID0gY291bnRl
cl9zeXNmc19jb3VudHNfYWRkKGNvdW50ZXIsIGNhdHRyX2dyb3VwKTsKPiArCWlmIChlcnIgPCAw
KQo+ICsJCXJldHVybiBlcnI7Cj4gKwljYXR0cl9ncm91cCArPSBjb3VudGVyLT5udW1fY291bnRz
Owo+ICsKPiArCS8qIENyZWF0ZSBuYW1lIGF0dHJpYnV0ZSAqLwo+ICsJZXJyID0gY291bnRlcl9u
YW1lX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3JvdXAsIGNvdW50ZXItPm5hbWUpOwo+ICsJaWYg
KGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwkvKiBDcmVhdGUgbnVtX3NpZ25hbHMg
YXR0cmlidXRlICovCj4gKwllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJfZ3Jv
dXAsICZjb3VudGVyX251bV9zaWduYWxzX2NvbXAsCj4gKwkJCQkgIHNjb3BlLCBOVUxMKTsKPiAr
CWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJLyogQ3JlYXRlIG51bV9jb3Vu
dHMgYXR0cmlidXRlICovCj4gKwllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgY2F0dHJf
Z3JvdXAsICZjb3VudGVyX251bV9jb3VudHNfY29tcCwKPiArCQkJCSAgc2NvcGUsIE5VTEwpOwo+
ICsJaWYgKGVyciA8IDApCj4gKwkJcmV0dXJuIGVycjsKPiArCj4gKwkvKiBDcmVhdGUgYW4gYXR0
cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwo+ICsJZm9yIChpID0gMDsgaSA8IGNvdW50ZXIt
Pm51bV9leHQ7IGkrKykgewo+ICsJCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBjYXR0
cl9ncm91cCwgY291bnRlci0+ZXh0ICsgaSwKPiArCQkJCQkgIHNjb3BlLCBOVUxMKTsKPiArCQlp
ZiAoZXJyIDwgMCkKPiArCQkJcmV0dXJuIGVycjsKPiArCX0KPiArCj4gKwlyZXR1cm4gMDsKPiAr
fQo+ICsKPiArLyoqCj4gKyAqIGNvdW50ZXJfc3lzZnNfYWRkIC0gQWRkcyBDb3VudGVyIHN5c2Zz
IGF0dHJpYnV0ZXMgdG8gdGhlIGRldmljZSBzdHJ1Y3R1cmUKPiArICogQGNvdW50ZXI6CVBvaW50
ZXIgdG8gdGhlIENvdW50ZXIgZGV2aWNlIHN0cnVjdHVyZQo+ICsgKgo+ICsgKiBDb3VudGVyIHN5
c2ZzIGF0dHJpYnV0ZXMgYXJlIGNyZWF0ZWQgYW5kIGFkZGVkIHRvIHRoZSByZXNwZWN0aXZlIGRl
dmljZQo+ICsgKiBzdHJ1Y3R1cmUgZm9yIGxhdGVyIHJlZ2lzdHJhdGlvbiB0byB0aGUgc3lzdGVt
LiBSZXNvdXJjZS1tYW5hZ2VkIG1lbW9yeQo+ICsgKiBhbGxvY2F0aW9uIGlzIHBlcmZvcm1lZCBi
eSB0aGlzIGZ1bmN0aW9uLCBhbmQgdGhpcyBtZW1vcnkgc2hvdWxkIGJlIGZyZWVkCj4gKyAqIHdo
ZW4gbm8gbG9uZ2VyIG5lZWRlZCAoYXV0b21hdGljYWxseSBieSBhIGRldmljZV91bnJlZ2lzdGVy
IGNhbGwsIG9yCj4gKyAqIG1hbnVhbGx5IGJ5IGEgZGV2cmVzX3JlbGVhc2VfYWxsIGNhbGwpLgo+
ICsgKi8KPiAraW50IGNvdW50ZXJfc3lzZnNfYWRkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29u
c3QgY291bnRlcikKPiArewo+ICsJc3RydWN0IGRldmljZSAqY29uc3QgZGV2ID0gJmNvdW50ZXIt
PmRldjsKPiArCWNvbnN0IHNpemVfdCBudW1fZ3JvdXBzID0gY291bnRlci0+bnVtX3NpZ25hbHMg
KyBjb3VudGVyLT5udW1fY291bnRzICsgMTsKPiArCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9n
cm91cCAqY2F0dHJfZ3JvdXBzOwo+ICsJc2l6ZV90IGksIGo7Cj4gKwlpbnQgZXJyOwo+ICsJc3Ry
dWN0IGF0dHJpYnV0ZV9ncm91cCAqZ3JvdXBzOwo+ICsJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRl
ICpwOwo+ICsKPiArCS8qIEFsbG9jYXRlIHNwYWNlIGZvciBhdHRyaWJ1dGUgZ3JvdXBzIChzaWdu
YWxzLCBjb3VudHMsIGFuZCBleHQpICovCj4gKwljYXR0cl9ncm91cHMgPSBkZXZtX2tjYWxsb2Mo
ZGV2LCBudW1fZ3JvdXBzLCBzaXplb2YoKmNhdHRyX2dyb3VwcyksCj4gKwkJCQkgICAgR0ZQX0tF
Uk5FTCk7Cj4gKwlpZiAoIWNhdHRyX2dyb3VwcykKPiArCQlyZXR1cm4gLUVOT01FTTsKPiArCj4g
KwkvKiBJbml0aWFsaXplIGF0dHJpYnV0ZSBsaXN0cyAqLwo+ICsJZm9yIChpID0gMDsgaSA8IG51
bV9ncm91cHM7IGkrKykKPiArCQlJTklUX0xJU1RfSEVBRCgmY2F0dHJfZ3JvdXBzW2ldLmF0dHJf
bGlzdCk7Cj4gKwo+ICsJLyogQWRkIENvdW50ZXIgZGV2aWNlIHN5c2ZzIGF0dHJpYnV0ZXMgKi8K
PiArCWVyciA9IGNvdW50ZXJfc3lzZnNfYXR0cl9hZGQoY291bnRlciwgY2F0dHJfZ3JvdXBzKTsK
PiArCWlmIChlcnIgPCAwKQo+ICsJCXJldHVybiBlcnI7Cj4gKwo+ICsJLyogQWxsb2NhdGUgYXR0
cmlidXRlIGdyb3VwIHBvaW50ZXJzIGZvciBhc3NvY2lhdGlvbiB3aXRoIGRldmljZSAqLwo+ICsJ
ZGV2LT5ncm91cHMgPSBkZXZtX2tjYWxsb2MoZGV2LCBudW1fZ3JvdXBzICsgMSwgc2l6ZW9mKCpk
ZXYtPmdyb3VwcyksCj4gKwkJCQkgICBHRlBfS0VSTkVMKTsKPiArCWlmICghZGV2LT5ncm91cHMp
Cj4gKwkJcmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJLyogQWxsb2NhdGUgc3BhY2UgZm9yIGF0dHJp
YnV0ZSBncm91cHMgKi8KPiArCWdyb3VwcyA9IGRldm1fa2NhbGxvYyhkZXYsIG51bV9ncm91cHMs
IHNpemVvZigqZ3JvdXBzKSwgR0ZQX0tFUk5FTCk7Cj4gKwlpZiAoIWdyb3VwcykKPiArCQlyZXR1
cm4gLUVOT01FTTsKPiArCj4gKwkvKiBQcmVwYXJlIGVhY2ggZ3JvdXAgb2YgYXR0cmlidXRlcyBm
b3IgYXNzb2NpYXRpb24gKi8KPiArCWZvciAoaSA9IDA7IGkgPCBudW1fZ3JvdXBzOyBpKyspIHsK
PiArCQlncm91cHNbaV0ubmFtZSA9IGNhdHRyX2dyb3Vwc1tpXS5uYW1lOwo+ICsKPiArCQkvKiBB
bGxvY2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIHBvaW50ZXJzICovCj4gKwkJZ3JvdXBzW2ldLmF0
dHJzID0gZGV2bV9rY2FsbG9jKGRldiwKPiArCQkJCQkgICAgICAgY2F0dHJfZ3JvdXBzW2ldLm51
bV9hdHRyICsgMSwKPiArCQkJCQkgICAgICAgc2l6ZW9mKCpncm91cHNbaV0uYXR0cnMpLAo+ICsJ
CQkJCSAgICAgICBHRlBfS0VSTkVMKTsKPiArCQlpZiAoIWdyb3Vwc1tpXS5hdHRycykKPiArCQkJ
cmV0dXJuIC1FTk9NRU07Cj4gKwo+ICsJCS8qIEFkZCBhdHRyaWJ1dGUgcG9pbnRlcnMgdG8gYXR0
cmlidXRlIGdyb3VwICovCj4gKwkJaiA9IDA7Cj4gKwkJbGlzdF9mb3JfZWFjaF9lbnRyeShwLCAm
Y2F0dHJfZ3JvdXBzW2ldLmF0dHJfbGlzdCwgbCkKPiArCQkJZ3JvdXBzW2ldLmF0dHJzW2orK10g
PSAmcC0+ZGV2X2F0dHIuYXR0cjsKPiArCj4gKwkJLyogQXNzb2NpYXRlIGF0dHJpYnV0ZSBncm91
cCAqLwo+ICsJCWRldi0+Z3JvdXBzW2ldID0gJmdyb3Vwc1tpXTsKPiArCX0KPiArCj4gKwlyZXR1
cm4gMDsKPiArfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5o
IGIvZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuaAo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0
Cj4gaW5kZXggMDAwMDAwMDAwMDAwLi4xNGZlNTY2YWNhMGUKPiAtLS0gL2Rldi9udWxsCj4gKysr
IGIvZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuaAo+IEBAIC0wLDAgKzEsMTMgQEAKPiAr
LyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8KPiArLyoKPiArICogQ291bnRl
ciBzeXNmcyBpbnRlcmZhY2UKPiArICogQ29weXJpZ2h0IChDKSAyMDIwIFdpbGxpYW0gQnJlYXRo
aXR0IEdyYXkKPiArICovCj4gKyNpZm5kZWYgX0NPVU5URVJfU1lTRlNfSF8KPiArI2RlZmluZSBf
Q09VTlRFUl9TWVNGU19IXwo+ICsKPiArI2luY2x1ZGUgPGxpbnV4L2NvdW50ZXIuaD4KPiArCj4g
K2ludCBjb3VudGVyX3N5c2ZzX2FkZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50
ZXIpOwo+ICsKPiArI2VuZGlmIC8qIF9DT1VOVEVSX1NZU0ZTX0hfICovCj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvY291bnRlci9jb3VudGVyLmMgYi9kcml2ZXJzL2NvdW50ZXIvY291bnRlci5jCj4g
ZGVsZXRlZCBmaWxlIG1vZGUgMTAwNjQ0Cj4gaW5kZXggZGU5MjFlOGEzZjcyLi4wMDAwMDAwMDAw
MDAKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci5jCj4gKysrIC9kZXYvbnVsbAo+IEBA
IC0xLDE0OTYgKzAsMCBAQAo+IC0vLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMAo+
IC0vKgo+IC0gKiBHZW5lcmljIENvdW50ZXIgaW50ZXJmYWNlCj4gLSAqIENvcHlyaWdodCAoQykg
MjAxOCBXaWxsaWFtIEJyZWF0aGl0dCBHcmF5Cj4gLSAqLwo+IC0jaW5jbHVkZSA8bGludXgvY291
bnRlci5oPgo+IC0jaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9l
cnIuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L2V4cG9ydC5oPgo+IC0jaW5jbHVkZSA8bGludXgvZnMu
aD4KPiAtI2luY2x1ZGUgPGxpbnV4L2dmcC5oPgo+IC0jaW5jbHVkZSA8bGludXgvaWRyLmg+Cj4g
LSNpbmNsdWRlIDxsaW51eC9pbml0Lmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KPiAt
I2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgo+IC0j
aW5jbHVkZSA8bGludXgvcHJpbnRrLmg+Cj4gLSNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Cj4gLSNp
bmNsdWRlIDxsaW51eC9zdHJpbmcuaD4KPiAtI2luY2x1ZGUgPGxpbnV4L3N5c2ZzLmg+Cj4gLSNp
bmNsdWRlIDxsaW51eC90eXBlcy5oPgo+IC0KPiAtY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9j
b3VudF9kaXJlY3Rpb25fc3RyWzJdID0gewo+IC0JW0NPVU5URVJfQ09VTlRfRElSRUNUSU9OX0ZP
UldBUkRdID0gImZvcndhcmQiLAo+IC0JW0NPVU5URVJfQ09VTlRfRElSRUNUSU9OX0JBQ0tXQVJE
XSA9ICJiYWNrd2FyZCIKPiAtfTsKPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9jb3VudF9k
aXJlY3Rpb25fc3RyKTsKPiAtCj4gLWNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfY291bnRfbW9k
ZV9zdHJbNF0gPSB7Cj4gLQlbQ09VTlRFUl9DT1VOVF9NT0RFX05PUk1BTF0gPSAibm9ybWFsIiwK
PiAtCVtDT1VOVEVSX0NPVU5UX01PREVfUkFOR0VfTElNSVRdID0gInJhbmdlIGxpbWl0IiwKPiAt
CVtDT1VOVEVSX0NPVU5UX01PREVfTk9OX1JFQ1lDTEVdID0gIm5vbi1yZWN5Y2xlIiwKPiAtCVtD
T1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX05dID0gIm1vZHVsby1uIgo+IC19Owo+IC1FWFBPUlRf
U1lNQk9MX0dQTChjb3VudGVyX2NvdW50X21vZGVfc3RyKTsKPiAtCj4gLXNzaXplX3QgY291bnRl
cl9zaWduYWxfZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJ
CSBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdiwKPiAtCQkJCSBjaGFy
ICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCAqY29u
c3QgZSA9IHByaXY7Cj4gLQlpbnQgZXJyOwo+IC0Jc2l6ZV90IGluZGV4Owo+IC0KPiAtCWlmICgh
ZS0+Z2V0KQo+IC0JCXJldHVybiAtRUlOVkFMOwo+IC0KPiAtCWVyciA9IGUtPmdldChjb3VudGVy
LCBzaWduYWwsICZpbmRleCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBlcnI7Cj4gLQo+IC0J
aWYgKGluZGV4ID49IGUtPm51bV9pdGVtcykKPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4gLQly
ZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgZS0+aXRlbXNbaW5kZXhdKTsKPiAtfQo+IC1FWFBP
UlRfU1lNQk9MX0dQTChjb3VudGVyX3NpZ25hbF9lbnVtX3JlYWQpOwo+IC0KPiAtc3NpemVfdCBj
b3VudGVyX3NpZ25hbF9lbnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAtCQkJCSAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHZvaWQgKnByaXYsCj4gLQkJ
CQkgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNv
dW50ZXJfc2lnbmFsX2VudW1fZXh0ICpjb25zdCBlID0gcHJpdjsKPiAtCXNzaXplX3QgaW5kZXg7
Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCWlmICghZS0+c2V0KQo+IC0JCXJldHVybiAtRUlOVkFMOwo+
IC0KPiAtCWluZGV4ID0gX19zeXNmc19tYXRjaF9zdHJpbmcoZS0+aXRlbXMsIGUtPm51bV9pdGVt
cywgYnVmKTsKPiAtCWlmIChpbmRleCA8IDApCj4gLQkJcmV0dXJuIGluZGV4Owo+IC0KPiAtCWVy
ciA9IGUtPnNldChjb3VudGVyLCBzaWduYWwsIGluZGV4KTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0
dXJuIGVycjsKPiAtCj4gLQlyZXR1cm4gbGVuOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGNv
dW50ZXJfc2lnbmFsX2VudW1fd3JpdGUpOwo+IC0KPiAtc3NpemVfdCBjb3VudGVyX3NpZ25hbF9l
bnVtX2F2YWlsYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJ
CQkgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKPiAtCQkJCQkgICB2b2lkICpwcml2
LCBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4
dCAqY29uc3QgZSA9IHByaXY7Cj4gLQlzaXplX3QgaTsKPiAtCXNpemVfdCBsZW4gPSAwOwo+IC0K
PiAtCWlmICghZS0+bnVtX2l0ZW1zKQo+IC0JCXJldHVybiAwOwo+IC0KPiAtCWZvciAoaSA9IDA7
IGkgPCBlLT5udW1faXRlbXM7IGkrKykKPiAtCQlsZW4gKz0gc3ByaW50ZihidWYgKyBsZW4sICIl
c1xuIiwgZS0+aXRlbXNbaV0pOwo+IC0KPiAtCXJldHVybiBsZW47Cj4gLX0KPiAtRVhQT1JUX1NZ
TUJPTF9HUEwoY291bnRlcl9zaWduYWxfZW51bV9hdmFpbGFibGVfcmVhZCk7Cj4gLQo+IC1zc2l6
ZV90IGNvdW50ZXJfY291bnRfZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdiwKPiAtCQkJ
CWNoYXIgKmJ1ZikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZW51bV9leHQg
KmNvbnN0IGUgPSBwcml2Owo+IC0JaW50IGVycjsKPiAtCXNpemVfdCBpbmRleDsKPiAtCj4gLQlp
ZiAoIWUtPmdldCkKPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4gLQllcnIgPSBlLT5nZXQoY291
bnRlciwgY291bnQsICZpbmRleCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBlcnI7Cj4gLQo+
IC0JaWYgKGluZGV4ID49IGUtPm51bV9pdGVtcykKPiAtCQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4g
LQlyZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgZS0+aXRlbXNbaW5kZXhdKTsKPiAtfQo+IC1F
WFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX2NvdW50X2VudW1fcmVhZCk7Cj4gLQo+IC1zc2l6ZV90
IGNvdW50ZXJfY291bnRfZW51bV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gLQkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2LAo+IC0JCQkJ
IGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50
ZXJfY291bnRfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+IC0Jc3NpemVfdCBpbmRleDsKPiAt
CWludCBlcnI7Cj4gLQo+IC0JaWYgKCFlLT5zZXQpCj4gLQkJcmV0dXJuIC1FSU5WQUw7Cj4gLQo+
IC0JaW5kZXggPSBfX3N5c2ZzX21hdGNoX3N0cmluZyhlLT5pdGVtcywgZS0+bnVtX2l0ZW1zLCBi
dWYpOwo+IC0JaWYgKGluZGV4IDwgMCkKPiAtCQlyZXR1cm4gaW5kZXg7Cj4gLQo+IC0JZXJyID0g
ZS0+c2V0KGNvdW50ZXIsIGNvdW50LCBpbmRleCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBl
cnI7Cj4gLQo+IC0JcmV0dXJuIGxlbjsKPiAtfQo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVy
X2NvdW50X2VudW1fd3JpdGUpOwo+IC0KPiAtc3NpemVfdCBjb3VudGVyX2NvdW50X2VudW1fYXZh
aWxhYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCSAgdm9pZCAqcHJpdiwgY2hhciAqYnVm
KQo+IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4dCAqY29uc3QgZSA9
IHByaXY7Cj4gLQlzaXplX3QgaTsKPiAtCXNpemVfdCBsZW4gPSAwOwo+IC0KPiAtCWlmICghZS0+
bnVtX2l0ZW1zKQo+IC0JCXJldHVybiAwOwo+IC0KPiAtCWZvciAoaSA9IDA7IGkgPCBlLT5udW1f
aXRlbXM7IGkrKykKPiAtCQlsZW4gKz0gc3ByaW50ZihidWYgKyBsZW4sICIlc1xuIiwgZS0+aXRl
bXNbaV0pOwo+IC0KPiAtCXJldHVybiBsZW47Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291
bnRlcl9jb3VudF9lbnVtX2F2YWlsYWJsZV9yZWFkKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9k
ZXZpY2VfZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdm9pZCAqcHJp
diwKPiAtCQkJCSBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rldmlj
ZV9lbnVtX2V4dCAqY29uc3QgZSA9IHByaXY7Cj4gLQlpbnQgZXJyOwo+IC0Jc2l6ZV90IGluZGV4
Owo+IC0KPiAtCWlmICghZS0+Z2V0KQo+IC0JCXJldHVybiAtRUlOVkFMOwo+IC0KPiAtCWVyciA9
IGUtPmdldChjb3VudGVyLCAmaW5kZXgpOwo+IC0JaWYgKGVycikKPiAtCQlyZXR1cm4gZXJyOwo+
IC0KPiAtCWlmIChpbmRleCA+PSBlLT5udW1faXRlbXMpCj4gLQkJcmV0dXJuIC1FSU5WQUw7Cj4g
LQo+IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGUtPml0ZW1zW2luZGV4XSk7Cj4gLX0K
PiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9kZXZpY2VfZW51bV9yZWFkKTsKPiAtCj4gLXNz
aXplX3QgY291bnRlcl9kZXZpY2VfZW51bV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsIHZvaWQgKnByaXYsCj4gLQkJCQkgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikK
PiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2VudW1fZXh0ICpjb25zdCBlID0g
cHJpdjsKPiAtCXNzaXplX3QgaW5kZXg7Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCWlmICghZS0+c2V0
KQo+IC0JCXJldHVybiAtRUlOVkFMOwo+IC0KPiAtCWluZGV4ID0gX19zeXNmc19tYXRjaF9zdHJp
bmcoZS0+aXRlbXMsIGUtPm51bV9pdGVtcywgYnVmKTsKPiAtCWlmIChpbmRleCA8IDApCj4gLQkJ
cmV0dXJuIGluZGV4Owo+IC0KPiAtCWVyciA9IGUtPnNldChjb3VudGVyLCBpbmRleCk7Cj4gLQlp
ZiAoZXJyKQo+IC0JCXJldHVybiBlcnI7Cj4gLQo+IC0JcmV0dXJuIGxlbjsKPiAtfQo+IC1FWFBP
UlRfU1lNQk9MX0dQTChjb3VudGVyX2RldmljZV9lbnVtX3dyaXRlKTsKPiAtCj4gLXNzaXplX3Qg
Y291bnRlcl9kZXZpY2VfZW51bV9hdmFpbGFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gLQkJCQkJICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+IC17Cj4gLQljb25z
dCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2Owo+IC0Jc2l6
ZV90IGk7Cj4gLQlzaXplX3QgbGVuID0gMDsKPiAtCj4gLQlpZiAoIWUtPm51bV9pdGVtcykKPiAt
CQlyZXR1cm4gMDsKPiAtCj4gLQlmb3IgKGkgPSAwOyBpIDwgZS0+bnVtX2l0ZW1zOyBpKyspCj4g
LQkJbGVuICs9IHNwcmludGYoYnVmICsgbGVuLCAiJXNcbiIsIGUtPml0ZW1zW2ldKTsKPiAtCj4g
LQlyZXR1cm4gbGVuOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfZGV2aWNlX2Vu
dW1fYXZhaWxhYmxlX3JlYWQpOwo+IC0KPiAtc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHsKPiAt
CXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpncm91cDsKPiAtCWNvbnN0IGNoYXIg
KnByZWZpeDsKPiAtCWNvbnN0IGNoYXIgKm5hbWU7Cj4gLQlzc2l6ZV90ICgqc2hvdykoc3RydWN0
IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtCQkJY2hhciAq
YnVmKTsKPiAtCXNzaXplX3QgKCpzdG9yZSkoc3RydWN0IGRldmljZSAqZGV2LCBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtCQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7
Cj4gLQl2b2lkICpjb21wb25lbnQ7Cj4gLX07Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2Vf
YXR0ciB7Cj4gLQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSBkZXZfYXR0cjsKPiAtCXN0cnVjdCBs
aXN0X2hlYWQgbDsKPiAtCXZvaWQgKmNvbXBvbmVudDsKPiAtfTsKPiAtCj4gLXN0YXRpYyBpbnQg
Y291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKGNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJfcGFybSAq
Y29uc3QgcGFybSkKPiAtewo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvdW50ZXJf
YXR0cjsKPiAtCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICpkZXZfYXR0cjsKPiAtCWludCBlcnI7
Cj4gLQlzdHJ1Y3QgbGlzdF9oZWFkICpjb25zdCBhdHRyX2xpc3QgPSAmcGFybS0+Z3JvdXAtPmF0
dHJfbGlzdDsKPiAtCj4gLQkvKiBBbGxvY2F0ZSBhIENvdW50ZXIgZGV2aWNlIGF0dHJpYnV0ZSAq
Lwo+IC0JY291bnRlcl9hdHRyID0ga3phbGxvYyhzaXplb2YoKmNvdW50ZXJfYXR0ciksIEdGUF9L
RVJORUwpOwo+IC0JaWYgKCFjb3VudGVyX2F0dHIpCj4gLQkJcmV0dXJuIC1FTk9NRU07Cj4gLQlk
ZXZfYXR0ciA9ICZjb3VudGVyX2F0dHItPmRldl9hdHRyOwo+IC0KPiAtCXN5c2ZzX2F0dHJfaW5p
dCgmZGV2X2F0dHItPmF0dHIpOwo+IC0KPiAtCS8qIENvbmZpZ3VyZSBkZXZpY2UgYXR0cmlidXRl
ICovCj4gLQlkZXZfYXR0ci0+YXR0ci5uYW1lID0ga2FzcHJpbnRmKEdGUF9LRVJORUwsICIlcyVz
IiwgcGFybS0+cHJlZml4LAo+IC0JCQkJCXBhcm0tPm5hbWUpOwo+IC0JaWYgKCFkZXZfYXR0ci0+
YXR0ci5uYW1lKSB7Cj4gLQkJZXJyID0gLUVOT01FTTsKPiAtCQlnb3RvIGVycl9mcmVlX2NvdW50
ZXJfYXR0cjsKPiAtCX0KPiAtCWlmIChwYXJtLT5zaG93KSB7Cj4gLQkJZGV2X2F0dHItPmF0dHIu
bW9kZSB8PSAwNDQ0Owo+IC0JCWRldl9hdHRyLT5zaG93ID0gcGFybS0+c2hvdzsKPiAtCX0KPiAt
CWlmIChwYXJtLT5zdG9yZSkgewo+IC0JCWRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDIwMDsKPiAt
CQlkZXZfYXR0ci0+c3RvcmUgPSBwYXJtLT5zdG9yZTsKPiAtCX0KPiAtCj4gLQkvKiBTdG9yZSBh
c3NvY2lhdGVkIENvdW50ZXIgY29tcG9uZW50IHdpdGggYXR0cmlidXRlICovCj4gLQljb3VudGVy
X2F0dHItPmNvbXBvbmVudCA9IHBhcm0tPmNvbXBvbmVudDsKPiAtCj4gLQkvKiBLZWVwIHRyYWNr
IG9mIHRoZSBhdHRyaWJ1dGUgZm9yIGxhdGVyIGNsZWFudXAgKi8KPiAtCWxpc3RfYWRkKCZjb3Vu
dGVyX2F0dHItPmwsIGF0dHJfbGlzdCk7Cj4gLQlwYXJtLT5ncm91cC0+bnVtX2F0dHIrKzsKPiAt
Cj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2NvdW50ZXJfYXR0cjoKPiAtCWtmcmVlKGNv
dW50ZXJfYXR0cik7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC0jZGVmaW5lIHRvX2NvdW50
ZXJfYXR0cihfZGV2X2F0dHIpIFwKPiAtCWNvbnRhaW5lcl9vZihfZGV2X2F0dHIsIHN0cnVjdCBj
b3VudGVyX2RldmljZV9hdHRyLCBkZXZfYXR0cikKPiAtCj4gLXN0cnVjdCBjb3VudGVyX3NpZ25h
bF91bml0IHsKPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsOwo+IC19Owo+IC0KPiAt
c3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfc2lnbmFsX2xldmVsX3N0cltdID0gewo+
IC0JW0NPVU5URVJfU0lHTkFMX0xFVkVMX0xPV10gPSAibG93IiwKPiAtCVtDT1VOVEVSX1NJR05B
TF9MRVZFTF9ISUdIXSA9ICJoaWdoIgo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRl
cl9zaWduYWxfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLQkJCQkgICBzdHJ1Y3QgZGV2aWNl
X2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtCWNvbnN0IHN0cnVj
dCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0
dHIpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX3VuaXQgKmNvbnN0IGNvbXBvbmVu
dCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qg
c2lnbmFsID0gY29tcG9uZW50LT5zaWduYWw7Cj4gLQlpbnQgZXJyOwo+IC0JZW51bSBjb3VudGVy
X3NpZ25hbF9sZXZlbCBsZXZlbDsKPiAtCj4gLQllcnIgPSBjb3VudGVyLT5vcHMtPnNpZ25hbF9y
ZWFkKGNvdW50ZXIsIHNpZ25hbCwgJmxldmVsKTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVy
cjsKPiAtCj4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291bnRlcl9zaWduYWxfbGV2
ZWxfc3RyW2xldmVsXSk7Cj4gLX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX25hbWVfdW5pdCB7Cj4g
LQljb25zdCBjaGFyICpuYW1lOwo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9k
ZXZpY2VfYXR0cl9uYW1lX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJCSAgICAgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gLQkJCQkJICAgICBjaGFyICpidWYpCj4gLXsK
PiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX25hbWVfdW5pdCAqY29uc3QgY29tcCA9IHRvX2NvdW50
ZXJfYXR0cihhdHRyKS0+Y29tcG9uZW50Owo+IC0KPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVz
XG4iLCBjb21wLT5uYW1lKTsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBjb3VudGVyX25hbWVfYXR0
cmlidXRlX2NyZWF0ZSgKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25z
dCBncm91cCwKPiAtCWNvbnN0IGNoYXIgKmNvbnN0IG5hbWUpCj4gLXsKPiAtCXN0cnVjdCBjb3Vu
dGVyX25hbWVfdW5pdCAqbmFtZV9jb21wOwo+IC0Jc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBh
cm07Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCS8qIFNraXAgaWYgbm8gbmFtZSAqLwo+IC0JaWYgKCFu
YW1lKQo+IC0JCXJldHVybiAwOwo+IC0KPiAtCS8qIEFsbG9jYXRlIG5hbWUgYXR0cmlidXRlIGNv
bXBvbmVudCAqLwo+IC0JbmFtZV9jb21wID0ga21hbGxvYyhzaXplb2YoKm5hbWVfY29tcCksIEdG
UF9LRVJORUwpOwo+IC0JaWYgKCFuYW1lX2NvbXApCj4gLQkJcmV0dXJuIC1FTk9NRU07Cj4gLQlu
YW1lX2NvbXAtPm5hbWUgPSBuYW1lOwo+IC0KPiAtCS8qIEFsbG9jYXRlIFNpZ25hbCBuYW1lIGF0
dHJpYnV0ZSAqLwo+IC0JcGFybS5ncm91cCA9IGdyb3VwOwo+IC0JcGFybS5wcmVmaXggPSAiIjsK
PiAtCXBhcm0ubmFtZSA9ICJuYW1lIjsKPiAtCXBhcm0uc2hvdyA9IGNvdW50ZXJfZGV2aWNlX2F0
dHJfbmFtZV9zaG93Owo+IC0JcGFybS5zdG9yZSA9IE5VTEw7Cj4gLQlwYXJtLmNvbXBvbmVudCA9
IG5hbWVfY29tcDsKPiAtCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4g
LQlpZiAoZXJyKQo+IC0JCWdvdG8gZXJyX2ZyZWVfbmFtZV9jb21wOwo+IC0KPiAtCXJldHVybiAw
Owo+IC0KPiAtZXJyX2ZyZWVfbmFtZV9jb21wOgo+IC0Ja2ZyZWUobmFtZV9jb21wKTsKPiAtCXJl
dHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHRfdW5pdCB7Cj4g
LQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbDsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVy
X3NpZ25hbF9leHQgKmV4dDsKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfc2ln
bmFsX2V4dF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCQkJCSAgICAgICBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291
bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsK
PiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHRfdW5pdCAqY29uc3QgY29tcCA9IGRl
dmF0dHItPmNvbXBvbmVudDsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgKmNv
bnN0IGV4dCA9IGNvbXAtPmV4dDsKPiAtCj4gLQlyZXR1cm4gZXh0LT5yZWFkKGRldl9nZXRfZHJ2
ZGF0YShkZXYpLCBjb21wLT5zaWduYWwsIGV4dC0+cHJpdiwgYnVmKTsKPiAtfQo+IC0KPiAtc3Rh
dGljIHNzaXplX3QgY291bnRlcl9zaWduYWxfZXh0X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwK
PiAtCQkJCQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtCQkJCQljb25zdCBjaGFy
ICpidWYsIHNpemVfdCBsZW4pCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9h
dHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+IC0JY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsX2V4dF91bml0ICpjb25zdCBjb21wID0gZGV2YXR0ci0+Y29tcG9u
ZW50Owo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCAqY29uc3QgZXh0ID0gY29t
cC0+ZXh0Owo+IC0KPiAtCXJldHVybiBleHQtPndyaXRlKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBj
b21wLT5zaWduYWwsIGV4dC0+cHJpdiwgYnVmLAo+IC0JCWxlbik7Cj4gLX0KPiAtCj4gLXN0YXRp
YyB2b2lkIGNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKHN0cnVjdCBsaXN0X2hlYWQgKmF0
dHJfbGlzdCkKPiAtewo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKnAsICpuOwo+IC0K
PiAtCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShwLCBuLCBhdHRyX2xpc3QsIGwpIHsKPiAtCQkv
KiBmcmVlIGF0dHJpYnV0ZSBuYW1lIGFuZCBhc3NvY2lhdGVkIGNvbXBvbmVudCBtZW1vcnkgKi8K
PiAtCQlrZnJlZShwLT5kZXZfYXR0ci5hdHRyLm5hbWUpOwo+IC0JCWtmcmVlKHAtPmNvbXBvbmVu
dCk7Cj4gLQkJbGlzdF9kZWwoJnAtPmwpOwo+IC0JCWtmcmVlKHApOwo+IC0JfQo+IC19Cj4gLQo+
IC1zdGF0aWMgaW50IGNvdW50ZXJfc2lnbmFsX2V4dF9yZWdpc3RlcigKPiAtCXN0cnVjdCBjb3Vu
dGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiAtCXN0cnVjdCBjb3VudGVyX3Np
Z25hbCAqY29uc3Qgc2lnbmFsKQo+IC17Cj4gLQljb25zdCBzaXplX3QgbnVtX2V4dCA9IHNpZ25h
bC0+bnVtX2V4dDsKPiAtCXNpemVfdCBpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFs
X2V4dCAqZXh0Owo+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dF91bml0ICpzaWduYWxfZXh0
X2NvbXA7Cj4gLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiAtCWludCBlcnI7Cj4g
LQo+IC0JLyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBleHRlbnNpb24gKi8KPiAtCWZv
ciAoaSA9IDAgOyBpIDwgbnVtX2V4dDsgaSsrKSB7Cj4gLQkJZXh0ID0gc2lnbmFsLT5leHQgKyBp
Owo+IC0KPiAtCQkvKiBBbGxvY2F0ZSBzaWduYWxfZXh0IGF0dHJpYnV0ZSBjb21wb25lbnQgKi8K
PiAtCQlzaWduYWxfZXh0X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqc2lnbmFsX2V4dF9jb21wKSwg
R0ZQX0tFUk5FTCk7Cj4gLQkJaWYgKCFzaWduYWxfZXh0X2NvbXApIHsKPiAtCQkJZXJyID0gLUVO
T01FTTsKPiAtCQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQkJfQo+IC0JCXNpZ25hbF9l
eHRfY29tcC0+c2lnbmFsID0gc2lnbmFsOwo+IC0JCXNpZ25hbF9leHRfY29tcC0+ZXh0ID0gZXh0
Owo+IC0KPiAtCQkvKiBBbGxvY2F0ZSBhIENvdW50ZXIgZGV2aWNlIGF0dHJpYnV0ZSAqLwo+IC0J
CXBhcm0uZ3JvdXAgPSBncm91cDsKPiAtCQlwYXJtLnByZWZpeCA9ICIiOwo+IC0JCXBhcm0ubmFt
ZSA9IGV4dC0+bmFtZTsKPiAtCQlwYXJtLnNob3cgPSAoZXh0LT5yZWFkKSA/IGNvdW50ZXJfc2ln
bmFsX2V4dF9zaG93IDogTlVMTDsKPiAtCQlwYXJtLnN0b3JlID0gKGV4dC0+d3JpdGUpID8gY291
bnRlcl9zaWduYWxfZXh0X3N0b3JlIDogTlVMTDsKPiAtCQlwYXJtLmNvbXBvbmVudCA9IHNpZ25h
bF9leHRfY29tcDsKPiAtCQllcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+
IC0JCWlmIChlcnIpIHsKPiAtCQkJa2ZyZWUoc2lnbmFsX2V4dF9jb21wKTsKPiAtCQkJZ290byBl
cnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQkJfQo+IC0JfQo+IC0KPiAtCXJldHVybiAwOwo+IC0KPiAt
ZXJyX2ZyZWVfYXR0cl9saXN0Ogo+IC0JY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdy
b3VwLT5hdHRyX2xpc3QpOwo+IC0JcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBj
b3VudGVyX3NpZ25hbF9hdHRyaWJ1dGVzX2NyZWF0ZSgKPiAtCXN0cnVjdCBjb3VudGVyX2Rldmlj
ZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY29uc3QgY291bnRlciwKPiAtCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qgc2lnbmFs
KQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRlcl9zaWduYWxfdW5pdCAqc2lnbmFsX2NvbXA7Cj4gLQlz
dHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiAtCWludCBlcnI7Cj4gLQo+IC0JLyogQWxs
b2NhdGUgU2lnbmFsIGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KPiAtCXNpZ25hbF9jb21wID0ga21h
bGxvYyhzaXplb2YoKnNpZ25hbF9jb21wKSwgR0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIXNpZ25hbF9j
b21wKQo+IC0JCXJldHVybiAtRU5PTUVNOwo+IC0Jc2lnbmFsX2NvbXAtPnNpZ25hbCA9IHNpZ25h
bDsKPiAtCj4gLQkvKiBDcmVhdGUgbWFpbiBTaWduYWwgYXR0cmlidXRlICovCj4gLQlwYXJtLmdy
b3VwID0gZ3JvdXA7Cj4gLQlwYXJtLnByZWZpeCA9ICIiOwo+IC0JcGFybS5uYW1lID0gInNpZ25h
bCI7Cj4gLQlwYXJtLnNob3cgPSAoY291bnRlci0+b3BzLT5zaWduYWxfcmVhZCkgPyBjb3VudGVy
X3NpZ25hbF9zaG93IDogTlVMTDsKPiAtCXBhcm0uc3RvcmUgPSBOVUxMOwo+IC0JcGFybS5jb21w
b25lbnQgPSBzaWduYWxfY29tcDsKPiAtCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgm
cGFybSk7Cj4gLQlpZiAoZXJyKSB7Cj4gLQkJa2ZyZWUoc2lnbmFsX2NvbXApOwo+IC0JCXJldHVy
biBlcnI7Cj4gLQl9Cj4gLQo+IC0JLyogQ3JlYXRlIFNpZ25hbCBuYW1lIGF0dHJpYnV0ZSAqLwo+
IC0JZXJyID0gY291bnRlcl9uYW1lX2F0dHJpYnV0ZV9jcmVhdGUoZ3JvdXAsIHNpZ25hbC0+bmFt
ZSk7Cj4gLQlpZiAoZXJyKQo+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0KPiAtCS8q
IFJlZ2lzdGVyIFNpZ25hbCBleHRlbnNpb24gYXR0cmlidXRlcyAqLwo+IC0JZXJyID0gY291bnRl
cl9zaWduYWxfZXh0X3JlZ2lzdGVyKGdyb3VwLCBzaWduYWwpOwo+IC0JaWYgKGVycikKPiAtCQln
b3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVl
X2F0dHJfbGlzdDoKPiAtCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0
cl9saXN0KTsKPiAtCXJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0YXRpYyBpbnQgY291bnRlcl9z
aWduYWxzX3JlZ2lzdGVyKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNv
bnN0IGdyb3Vwc19saXN0LAo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBj
b3VudGVyKQo+IC17Cj4gLQljb25zdCBzaXplX3QgbnVtX3NpZ25hbHMgPSBjb3VudGVyLT5udW1f
c2lnbmFsczsKPiAtCXNpemVfdCBpOwo+IC0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWw7
Cj4gLQljb25zdCBjaGFyICpuYW1lOwo+IC0JaW50IGVycjsKPiAtCj4gLQkvKiBSZWdpc3RlciBl
YWNoIFNpZ25hbCAqLwo+IC0JZm9yIChpID0gMDsgaSA8IG51bV9zaWduYWxzOyBpKyspIHsKPiAt
CQlzaWduYWwgPSBjb3VudGVyLT5zaWduYWxzICsgaTsKPiAtCj4gLQkJLyogR2VuZXJhdGUgU2ln
bmFsIGF0dHJpYnV0ZSBkaXJlY3RvcnkgbmFtZSAqLwo+IC0JCW5hbWUgPSBrYXNwcmludGYoR0ZQ
X0tFUk5FTCwgInNpZ25hbCVkIiwgc2lnbmFsLT5pZCk7Cj4gLQkJaWYgKCFuYW1lKSB7Cj4gLQkJ
CWVyciA9IC1FTk9NRU07Cj4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9ncm91cHM7Cj4gLQkJfQo+
IC0JCWdyb3Vwc19saXN0W2ldLmF0dHJfZ3JvdXAubmFtZSA9IG5hbWU7Cj4gLQo+IC0JCS8qIENy
ZWF0ZSBhbGwgYXR0cmlidXRlcyBhc3NvY2lhdGVkIHdpdGggU2lnbmFsICovCj4gLQkJZXJyID0g
Y291bnRlcl9zaWduYWxfYXR0cmlidXRlc19jcmVhdGUoZ3JvdXBzX2xpc3QgKyBpLCBjb3VudGVy
LAo+IC0JCQkJCQkgICAgICAgc2lnbmFsKTsKPiAtCQlpZiAoZXJyKQo+IC0JCQlnb3RvIGVycl9m
cmVlX2F0dHJfZ3JvdXBzOwo+IC0JfQo+IC0KPiAtCXJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVf
YXR0cl9ncm91cHM6Cj4gLQlkbyB7Cj4gLQkJa2ZyZWUoZ3JvdXBzX2xpc3RbaV0uYXR0cl9ncm91
cC5uYW1lKTsKPiAtCQljb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXBzX2xpc3Rb
aV0uYXR0cl9saXN0KTsKPiAtCX0gd2hpbGUgKGktLSk7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4g
LQo+IC1zdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHJb
XSA9IHsKPiAtCVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkVdID0gIm5vbmUiLAo+IC0JW0NP
VU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0VdID0gInJpc2luZyBlZGdlIiwKPiAtCVtD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRV0gPSAiZmFsbGluZyBlZGdlIiwKPiAt
CVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVNdID0gImJvdGggZWRnZXMiCj4gLX07
Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9hY3Rpb25fdW5pdCB7Cj4gLQlzdHJ1Y3QgY291bnRlcl9z
eW5hcHNlICpzeW5hcHNlOwo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50Owo+IC19Owo+
IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9hY3Rpb25fc2hvdyhzdHJ1Y3QgZGV2aWNlICpk
ZXYsCj4gLQkJCQkgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+
IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9
IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiAtCWludCBlcnI7Cj4gLQlzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtCWNvbnN0IHN0
cnVjdCBjb3VudGVyX2FjdGlvbl91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZhdHRyLT5jb21w
b25lbnQ7Cj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBjb21wb25lbnQt
PmNvdW50Owo+IC0Jc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGNvbXBv
bmVudC0+c3luYXBzZTsKPiAtCXNpemVfdCBhY3Rpb25faW5kZXg7Cj4gLQllbnVtIGNvdW50ZXJf
c3luYXBzZV9hY3Rpb24gYWN0aW9uOwo+IC0KPiAtCWVyciA9IGNvdW50ZXItPm9wcy0+YWN0aW9u
X2dldChjb3VudGVyLCBjb3VudCwgc3luYXBzZSwgJmFjdGlvbl9pbmRleCk7Cj4gLQlpZiAoZXJy
KQo+IC0JCXJldHVybiBlcnI7Cj4gLQo+IC0Jc3luYXBzZS0+YWN0aW9uID0gYWN0aW9uX2luZGV4
Owo+IC0KPiAtCWFjdGlvbiA9IHN5bmFwc2UtPmFjdGlvbnNfbGlzdFthY3Rpb25faW5kZXhdOwo+
IC0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGNvdW50ZXJfc3luYXBzZV9hY3Rpb25fc3Ry
W2FjdGlvbl0pOwo+IC19Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2FjdGlvbl9zdG9y
ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLQkJCQkgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUg
KmF0dHIsCj4gLQkJCQkgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17Cj4gLQlj
b25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50
ZXJfYXR0cihhdHRyKTsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2FjdGlvbl91bml0ICpjb25z
dCBjb21wb25lbnQgPSBkZXZhdHRyLT5jb21wb25lbnQ7Cj4gLQlzdHJ1Y3QgY291bnRlcl9zeW5h
cHNlICpjb25zdCBzeW5hcHNlID0gY29tcG9uZW50LT5zeW5hcHNlOwo+IC0Jc2l6ZV90IGFjdGlv
bl9pbmRleDsKPiAtCWNvbnN0IHNpemVfdCBudW1fYWN0aW9ucyA9IHN5bmFwc2UtPm51bV9hY3Rp
b25zOwo+IC0JZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlvbjsKPiAtCWludCBlcnI7
Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRh
dGEoZGV2KTsKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGNvbXBvbmVu
dC0+Y291bnQ7Cj4gLQo+IC0JLyogRmluZCByZXF1ZXN0ZWQgYWN0aW9uIG1vZGUgKi8KPiAtCWZv
ciAoYWN0aW9uX2luZGV4ID0gMDsgYWN0aW9uX2luZGV4IDwgbnVtX2FjdGlvbnM7IGFjdGlvbl9p
bmRleCsrKSB7Cj4gLQkJYWN0aW9uID0gc3luYXBzZS0+YWN0aW9uc19saXN0W2FjdGlvbl9pbmRl
eF07Cj4gLQkJaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHJb
YWN0aW9uXSkpCj4gLQkJCWJyZWFrOwo+IC0JfQo+IC0JLyogSWYgcmVxdWVzdGVkIGFjdGlvbiBt
b2RlIG5vdCBmb3VuZCAqLwo+IC0JaWYgKGFjdGlvbl9pbmRleCA+PSBudW1fYWN0aW9ucykKPiAt
CQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4gLQllcnIgPSBjb3VudGVyLT5vcHMtPmFjdGlvbl9zZXQo
Y291bnRlciwgY291bnQsIHN5bmFwc2UsIGFjdGlvbl9pbmRleCk7Cj4gLQlpZiAoZXJyKQo+IC0J
CXJldHVybiBlcnI7Cj4gLQo+IC0Jc3luYXBzZS0+YWN0aW9uID0gYWN0aW9uX2luZGV4Owo+IC0K
PiAtCXJldHVybiBsZW47Cj4gLX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX2FjdGlvbl9hdmFpbF91
bml0IHsKPiAtCWNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uc19saXN0
Owo+IC0Jc2l6ZV90IG51bV9hY3Rpb25zOwo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291
bnRlcl9zeW5hcHNlX2FjdGlvbl9hdmFpbGFibGVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4g
LQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+IC17Cj4gLQljb25z
dCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJf
YXR0cihhdHRyKTsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2FjdGlvbl9hdmFpbF91bml0ICpj
b25zdCBjb21wb25lbnQgPSBkZXZhdHRyLT5jb21wb25lbnQ7Cj4gLQlzaXplX3QgaTsKPiAtCWVu
dW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rpb247Cj4gLQlzc2l6ZV90IGxlbiA9IDA7Cj4g
LQo+IC0JZm9yIChpID0gMDsgaSA8IGNvbXBvbmVudC0+bnVtX2FjdGlvbnM7IGkrKykgewo+IC0J
CWFjdGlvbiA9IGNvbXBvbmVudC0+YWN0aW9uc19saXN0W2ldOwo+IC0JCWxlbiArPSBzcHJpbnRm
KGJ1ZiArIGxlbiwgIiVzXG4iLAo+IC0JCQkgICAgICAgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9z
dHJbYWN0aW9uXSk7Cj4gLQl9Cj4gLQo+IC0JcmV0dXJuIGxlbjsKPiAtfQo+IC0KPiAtc3RhdGlj
IGludCBjb3VudGVyX3N5bmFwc2VzX3JlZ2lzdGVyKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNl
X2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3VwLAo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb25zdCBjb3VudGVyLAo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50LCBj
b25zdCBjaGFyICpjb25zdCBjb3VudF9hdHRyX25hbWUpCj4gLXsKPiAtCXNpemVfdCBpOwo+IC0J
c3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZTsKPiAtCWNvbnN0IGNoYXIgKnByZWZpeDsK
PiAtCXN0cnVjdCBjb3VudGVyX2FjdGlvbl91bml0ICphY3Rpb25fY29tcDsKPiAtCXN0cnVjdCBj
b3VudGVyX2F0dHJfcGFybSBwYXJtOwo+IC0JaW50IGVycjsKPiAtCXN0cnVjdCBjb3VudGVyX2Fj
dGlvbl9hdmFpbF91bml0ICphdmFpbF9jb21wOwo+IC0KPiAtCS8qIFJlZ2lzdGVyIGVhY2ggU3lu
YXBzZSAqLwo+IC0JZm9yIChpID0gMDsgaSA8IGNvdW50LT5udW1fc3luYXBzZXM7IGkrKykgewo+
IC0JCXN5bmFwc2UgPSBjb3VudC0+c3luYXBzZXMgKyBpOwo+IC0KPiAtCQkvKiBHZW5lcmF0ZSBh
dHRyaWJ1dGUgcHJlZml4ICovCj4gLQkJcHJlZml4ID0ga2FzcHJpbnRmKEdGUF9LRVJORUwsICJz
aWduYWwlZF8iLAo+IC0JCQkJICAgc3luYXBzZS0+c2lnbmFsLT5pZCk7Cj4gLQkJaWYgKCFwcmVm
aXgpIHsKPiAtCQkJZXJyID0gLUVOT01FTTsKPiAtCQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7
Cj4gLQkJfQo+IC0KPiAtCQkvKiBBbGxvY2F0ZSBhY3Rpb24gYXR0cmlidXRlIGNvbXBvbmVudCAq
Lwo+IC0JCWFjdGlvbl9jb21wID0ga21hbGxvYyhzaXplb2YoKmFjdGlvbl9jb21wKSwgR0ZQX0tF
Uk5FTCk7Cj4gLQkJaWYgKCFhY3Rpb25fY29tcCkgewo+IC0JCQllcnIgPSAtRU5PTUVNOwo+IC0J
CQlnb3RvIGVycl9mcmVlX3ByZWZpeDsKPiAtCQl9Cj4gLQkJYWN0aW9uX2NvbXAtPnN5bmFwc2Ug
PSBzeW5hcHNlOwo+IC0JCWFjdGlvbl9jb21wLT5jb3VudCA9IGNvdW50Owo+IC0KPiAtCQkvKiBD
cmVhdGUgYWN0aW9uIGF0dHJpYnV0ZSAqLwo+IC0JCXBhcm0uZ3JvdXAgPSBncm91cDsKPiAtCQlw
YXJtLnByZWZpeCA9IHByZWZpeDsKPiAtCQlwYXJtLm5hbWUgPSAiYWN0aW9uIjsKPiAtCQlwYXJt
LnNob3cgPSAoY291bnRlci0+b3BzLT5hY3Rpb25fZ2V0KSA/IGNvdW50ZXJfYWN0aW9uX3Nob3cg
OiBOVUxMOwo+IC0JCXBhcm0uc3RvcmUgPSAoY291bnRlci0+b3BzLT5hY3Rpb25fc2V0KSA/IGNv
dW50ZXJfYWN0aW9uX3N0b3JlIDogTlVMTDsKPiAtCQlwYXJtLmNvbXBvbmVudCA9IGFjdGlvbl9j
b21wOwo+IC0JCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLQkJaWYg
KGVycikgewo+IC0JCQlrZnJlZShhY3Rpb25fY29tcCk7Cj4gLQkJCWdvdG8gZXJyX2ZyZWVfcHJl
Zml4Owo+IC0JCX0KPiAtCj4gLQkJLyogQWxsb2NhdGUgYWN0aW9uIGF2YWlsYWJsZSBhdHRyaWJ1
dGUgY29tcG9uZW50ICovCj4gLQkJYXZhaWxfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCphdmFpbF9j
b21wKSwgR0ZQX0tFUk5FTCk7Cj4gLQkJaWYgKCFhdmFpbF9jb21wKSB7Cj4gLQkJCWVyciA9IC1F
Tk9NRU07Cj4gLQkJCWdvdG8gZXJyX2ZyZWVfcHJlZml4Owo+IC0JCX0KPiAtCQlhdmFpbF9jb21w
LT5hY3Rpb25zX2xpc3QgPSBzeW5hcHNlLT5hY3Rpb25zX2xpc3Q7Cj4gLQkJYXZhaWxfY29tcC0+
bnVtX2FjdGlvbnMgPSBzeW5hcHNlLT5udW1fYWN0aW9uczsKPiAtCj4gLQkJLyogQ3JlYXRlIGFj
dGlvbl9hdmFpbGFibGUgYXR0cmlidXRlICovCj4gLQkJcGFybS5ncm91cCA9IGdyb3VwOwo+IC0J
CXBhcm0ucHJlZml4ID0gcHJlZml4Owo+IC0JCXBhcm0ubmFtZSA9ICJhY3Rpb25fYXZhaWxhYmxl
IjsKPiAtCQlwYXJtLnNob3cgPSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uX2F2YWlsYWJsZV9zaG93
Owo+IC0JCXBhcm0uc3RvcmUgPSBOVUxMOwo+IC0JCXBhcm0uY29tcG9uZW50ID0gYXZhaWxfY29t
cDsKPiAtCQllcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+IC0JCWlmIChl
cnIpIHsKPiAtCQkJa2ZyZWUoYXZhaWxfY29tcCk7Cj4gLQkJCWdvdG8gZXJyX2ZyZWVfcHJlZml4
Owo+IC0JCX0KPiAtCj4gLQkJa2ZyZWUocHJlZml4KTsKPiAtCX0KPiAtCj4gLQlyZXR1cm4gMDsK
PiAtCj4gLWVycl9mcmVlX3ByZWZpeDoKPiAtCWtmcmVlKHByZWZpeCk7Cj4gLWVycl9mcmVlX2F0
dHJfbGlzdDoKPiAtCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9s
aXN0KTsKPiAtCXJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX2NvdW50X3Vu
aXQgewo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50Owo+IC19Owo+IC0KPiAtc3RhdGlj
IHNzaXplX3QgY291bnRlcl9jb3VudF9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCQkJCSAg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gLQkJCQkgIGNoYXIgKmJ1ZikKPiAtewo+
IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRh
KGRldik7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0
ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50
X3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtCXN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGNvbXBvbmVudC0+Y291bnQ7Cj4gLQlpbnQgZXJy
Owo+IC0JdW5zaWduZWQgbG9uZyB2YWw7Cj4gLQo+IC0JZXJyID0gY291bnRlci0+b3BzLT5jb3Vu
dF9yZWFkKGNvdW50ZXIsIGNvdW50LCAmdmFsKTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVy
cjsKPiAtCj4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIlbHVcbiIsIHZhbCk7Cj4gLX0KPiAtCj4g
LXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY291bnRfc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAo+
IC0JCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCj4gLQkJCQkgICBjb25zdCBj
aGFyICpidWYsIHNpemVfdCBsZW4pCj4gLXsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29u
c3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50
ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4g
LQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF91bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZh
dHRyLT5jb21wb25lbnQ7Cj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBj
b21wb25lbnQtPmNvdW50Owo+IC0JaW50IGVycjsKPiAtCXVuc2lnbmVkIGxvbmcgdmFsOwo+IC0K
PiAtCWVyciA9IGtzdHJ0b3VsKGJ1ZiwgMCwgJnZhbCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVy
biBlcnI7Cj4gLQo+IC0JZXJyID0gY291bnRlci0+b3BzLT5jb3VudF93cml0ZShjb3VudGVyLCBj
b3VudCwgdmFsKTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVycjsKPiAtCj4gLQlyZXR1cm4g
bGVuOwo+IC19Cj4gLQo+IC1zdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9mdW5jdGlv
bl9zdHJbXSA9IHsKPiAtCVtDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFXSA9ICJpbmNyZWFzZSIs
Cj4gLQlbQ09VTlRFUl9GVU5DVElPTl9ERUNSRUFTRV0gPSAiZGVjcmVhc2UiLAo+IC0JW0NPVU5U
RVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OXSA9ICJwdWxzZS1kaXJlY3Rpb24iLAo+IC0JW0NP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BXSA9ICJxdWFkcmF0dXJlIHgxIGEiLAo+IC0J
W0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9CXSA9ICJxdWFkcmF0dXJlIHgxIGIiLAo+
IC0JW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BXSA9ICJxdWFkcmF0dXJlIHgyIGEi
LAo+IC0JW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9CXSA9ICJxdWFkcmF0dXJlIHgy
IGIiLAo+IC0JW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNF0gPSAicXVhZHJhdHVyZSB4
NCIKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfZnVuY3Rpb25fc2hvdyhzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gLQkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LCBjaGFyICpidWYpCj4gLXsKPiAtCWludCBlcnI7Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKPiAtCWNvbnN0IHN0cnVjdCBj
b3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIp
Owo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqY29uc3QgY29tcG9uZW50ID0g
ZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50
ID0gY29tcG9uZW50LT5jb3VudDsKPiAtCXNpemVfdCBmdW5jX2luZGV4Owo+IC0JZW51bSBjb3Vu
dGVyX2Z1bmN0aW9uIGZ1bmN0aW9uOwo+IC0KPiAtCWVyciA9IGNvdW50ZXItPm9wcy0+ZnVuY3Rp
b25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY19pbmRleCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJl
dHVybiBlcnI7Cj4gLQo+IC0JY291bnQtPmZ1bmN0aW9uID0gZnVuY19pbmRleDsKPiAtCj4gLQlm
dW5jdGlvbiA9IGNvdW50LT5mdW5jdGlvbnNfbGlzdFtmdW5jX2luZGV4XTsKPiAtCXJldHVybiBz
cHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb3VudGVyX2Z1bmN0aW9uX3N0cltmdW5jdGlvbl0pOwo+IC19
Cj4gLQo+IC1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2Z1bmN0aW9uX3N0b3JlKHN0cnVjdCBkZXZp
Y2UgKmRldiwKPiAtCQkJCSAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAo+IC0J
CQkJICAgICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+IC17Cj4gLQljb25zdCBzdHJ1
Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihh
dHRyKTsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgKmNvbnN0IGNvbXBvbmVu
dCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBj
b3VudCA9IGNvbXBvbmVudC0+Y291bnQ7Cj4gLQljb25zdCBzaXplX3QgbnVtX2Z1bmN0aW9ucyA9
IGNvdW50LT5udW1fZnVuY3Rpb25zOwo+IC0Jc2l6ZV90IGZ1bmNfaW5kZXg7Cj4gLQllbnVtIGNv
dW50ZXJfZnVuY3Rpb24gZnVuY3Rpb247Cj4gLQlpbnQgZXJyOwo+IC0Jc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Cj4gLQo+IC0JLyog
RmluZCByZXF1ZXN0ZWQgQ291bnQgZnVuY3Rpb24gbW9kZSAqLwo+IC0JZm9yIChmdW5jX2luZGV4
ID0gMDsgZnVuY19pbmRleCA8IG51bV9mdW5jdGlvbnM7IGZ1bmNfaW5kZXgrKykgewo+IC0JCWZ1
bmN0aW9uID0gY291bnQtPmZ1bmN0aW9uc19saXN0W2Z1bmNfaW5kZXhdOwo+IC0JCWlmIChzeXNm
c19zdHJlcShidWYsIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSkpCj4gLQkJCWJyZWFr
Owo+IC0JfQo+IC0JLyogUmV0dXJuIGVycm9yIGlmIHJlcXVlc3RlZCBDb3VudCBmdW5jdGlvbiBt
b2RlIG5vdCBmb3VuZCAqLwo+IC0JaWYgKGZ1bmNfaW5kZXggPj0gbnVtX2Z1bmN0aW9ucykKPiAt
CQlyZXR1cm4gLUVJTlZBTDsKPiAtCj4gLQllcnIgPSBjb3VudGVyLT5vcHMtPmZ1bmN0aW9uX3Nl
dChjb3VudGVyLCBjb3VudCwgZnVuY19pbmRleCk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBl
cnI7Cj4gLQo+IC0JY291bnQtPmZ1bmN0aW9uID0gZnVuY19pbmRleDsKPiAtCj4gLQlyZXR1cm4g
bGVuOwo+IC19Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9jb3VudF9leHRfdW5pdCB7Cj4gLQlzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQ7Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9l
eHQgKmV4dDsKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY291bnRfZXh0X3No
b3coc3RydWN0IGRldmljZSAqZGV2LAo+IC0JCQkJICAgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1
dGUgKmF0dHIsIGNoYXIgKmJ1ZikKPiAtewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNl
X2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Cj4gLQljb25zdCBz
dHJ1Y3QgY291bnRlcl9jb3VudF9leHRfdW5pdCAqY29uc3QgY29tcCA9IGRldmF0dHItPmNvbXBv
bmVudDsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCAqY29uc3QgZXh0ID0gY29t
cC0+ZXh0Owo+IC0KPiAtCXJldHVybiBleHQtPnJlYWQoZGV2X2dldF9kcnZkYXRhKGRldiksIGNv
bXAtPmNvdW50LCBleHQtPnByaXYsIGJ1Zik7Cj4gLX0KPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNv
dW50ZXJfY291bnRfZXh0X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCQkJCSAgICAgICBz
dHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKPiAtCQkJCSAgICAgICBjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRy
ICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+IC0JY29uc3Qgc3RydWN0
IGNvdW50ZXJfY291bnRfZXh0X3VuaXQgKmNvbnN0IGNvbXAgPSBkZXZhdHRyLT5jb21wb25lbnQ7
Cj4gLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgKmNvbnN0IGV4dCA9IGNvbXAtPmV4
dDsKPiAtCj4gLQlyZXR1cm4gZXh0LT53cml0ZShkZXZfZ2V0X2RydmRhdGEoZGV2KSwgY29tcC0+
Y291bnQsIGV4dC0+cHJpdiwgYnVmLAo+IC0JCWxlbik7Cj4gLX0KPiAtCj4gLXN0YXRpYyBpbnQg
Y291bnRlcl9jb3VudF9leHRfcmVnaXN0ZXIoCj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0
cl9ncm91cCAqY29uc3QgZ3JvdXAsCj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291
bnQpCj4gLXsKPiAtCXNpemVfdCBpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0
ICpleHQ7Cj4gLQlzdHJ1Y3QgY291bnRlcl9jb3VudF9leHRfdW5pdCAqY291bnRfZXh0X2NvbXA7
Cj4gLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsKPiAtCWludCBlcnI7Cj4gLQo+IC0J
LyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBleHRlbnNpb24gKi8KPiAtCWZvciAoaSA9
IDAgOyBpIDwgY291bnQtPm51bV9leHQ7IGkrKykgewo+IC0JCWV4dCA9IGNvdW50LT5leHQgKyBp
Owo+IC0KPiAtCQkvKiBBbGxvY2F0ZSBjb3VudF9leHQgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+
IC0JCWNvdW50X2V4dF9jb21wID0ga21hbGxvYyhzaXplb2YoKmNvdW50X2V4dF9jb21wKSwgR0ZQ
X0tFUk5FTCk7Cj4gLQkJaWYgKCFjb3VudF9leHRfY29tcCkgewo+IC0JCQllcnIgPSAtRU5PTUVN
Owo+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCQl9Cj4gLQkJY291bnRfZXh0X2Nv
bXAtPmNvdW50ID0gY291bnQ7Cj4gLQkJY291bnRfZXh0X2NvbXAtPmV4dCA9IGV4dDsKPiAtCj4g
LQkJLyogQWxsb2NhdGUgY291bnRfZXh0IGF0dHJpYnV0ZSAqLwo+IC0JCXBhcm0uZ3JvdXAgPSBn
cm91cDsKPiAtCQlwYXJtLnByZWZpeCA9ICIiOwo+IC0JCXBhcm0ubmFtZSA9IGV4dC0+bmFtZTsK
PiAtCQlwYXJtLnNob3cgPSAoZXh0LT5yZWFkKSA/IGNvdW50ZXJfY291bnRfZXh0X3Nob3cgOiBO
VUxMOwo+IC0JCXBhcm0uc3RvcmUgPSAoZXh0LT53cml0ZSkgPyBjb3VudGVyX2NvdW50X2V4dF9z
dG9yZSA6IE5VTEw7Cj4gLQkJcGFybS5jb21wb25lbnQgPSBjb3VudF9leHRfY29tcDsKPiAtCQll
cnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwo+IC0JCWlmIChlcnIpIHsKPiAt
CQkJa2ZyZWUoY291bnRfZXh0X2NvbXApOwo+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsK
PiAtCQl9Cj4gLQl9Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6
Cj4gLQljb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlzdCk7Cj4g
LQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdHJ1Y3QgY291bnRlcl9mdW5jX2F2YWlsX3VuaXQg
ewo+IC0JY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbnNfbGlzdDsKPiAtCXNp
emVfdCBudW1fZnVuY3Rpb25zOwo+IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9m
dW5jdGlvbl9hdmFpbGFibGVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCj4gLQlzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQo+IC17Cj4gLQljb25zdCBzdHJ1Y3QgY291
bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsK
PiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Z1bmNfYXZhaWxfdW5pdCAqY29uc3QgY29tcG9uZW50
ID0gZGV2YXR0ci0+Y29tcG9uZW50Owo+IC0JY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpj
b25zdCBmdW5jX2xpc3QgPSBjb21wb25lbnQtPmZ1bmN0aW9uc19saXN0Owo+IC0JY29uc3Qgc2l6
ZV90IG51bV9mdW5jdGlvbnMgPSBjb21wb25lbnQtPm51bV9mdW5jdGlvbnM7Cj4gLQlzaXplX3Qg
aTsKPiAtCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiAtCXNzaXplX3QgbGVuID0g
MDsKPiAtCj4gLQlmb3IgKGkgPSAwOyBpIDwgbnVtX2Z1bmN0aW9uczsgaSsrKSB7Cj4gLQkJZnVu
Y3Rpb24gPSBmdW5jX2xpc3RbaV07Cj4gLQkJbGVuICs9IHNwcmludGYoYnVmICsgbGVuLCAiJXNc
biIsCj4gLQkJCSAgICAgICBjb3VudGVyX2Z1bmN0aW9uX3N0cltmdW5jdGlvbl0pOwo+IC0JfQo+
IC0KPiAtCXJldHVybiBsZW47Cj4gLX0KPiAtCj4gLXN0YXRpYyBpbnQgY291bnRlcl9jb3VudF9h
dHRyaWJ1dGVzX2NyZWF0ZSgKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpj
b25zdCBncm91cCwKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRl
ciwKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCkKPiAtewo+IC0Jc3RydWN0
IGNvdW50ZXJfY291bnRfdW5pdCAqY291bnRfY29tcDsKPiAtCXN0cnVjdCBjb3VudGVyX2F0dHJf
cGFybSBwYXJtOwo+IC0JaW50IGVycjsKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgKmZ1
bmNfY29tcDsKPiAtCXN0cnVjdCBjb3VudGVyX2Z1bmNfYXZhaWxfdW5pdCAqYXZhaWxfY29tcDsK
PiAtCj4gLQkvKiBBbGxvY2F0ZSBjb3VudCBhdHRyaWJ1dGUgY29tcG9uZW50ICovCj4gLQljb3Vu
dF9jb21wID0ga21hbGxvYyhzaXplb2YoKmNvdW50X2NvbXApLCBHRlBfS0VSTkVMKTsKPiAtCWlm
ICghY291bnRfY29tcCkKPiAtCQlyZXR1cm4gLUVOT01FTTsKPiAtCWNvdW50X2NvbXAtPmNvdW50
ID0gY291bnQ7Cj4gLQo+IC0JLyogQ3JlYXRlIG1haW4gQ291bnQgYXR0cmlidXRlICovCj4gLQlw
YXJtLmdyb3VwID0gZ3JvdXA7Cj4gLQlwYXJtLnByZWZpeCA9ICIiOwo+IC0JcGFybS5uYW1lID0g
ImNvdW50IjsKPiAtCXBhcm0uc2hvdyA9IChjb3VudGVyLT5vcHMtPmNvdW50X3JlYWQpID8gY291
bnRlcl9jb3VudF9zaG93IDogTlVMTDsKPiAtCXBhcm0uc3RvcmUgPSAoY291bnRlci0+b3BzLT5j
b3VudF93cml0ZSkgPyBjb3VudGVyX2NvdW50X3N0b3JlIDogTlVMTDsKPiAtCXBhcm0uY29tcG9u
ZW50ID0gY291bnRfY29tcDsKPiAtCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFy
bSk7Cj4gLQlpZiAoZXJyKSB7Cj4gLQkJa2ZyZWUoY291bnRfY29tcCk7Cj4gLQkJcmV0dXJuIGVy
cjsKPiAtCX0KPiAtCj4gLQkvKiBBbGxvY2F0ZSBmdW5jdGlvbiBhdHRyaWJ1dGUgY29tcG9uZW50
ICovCj4gLQlmdW5jX2NvbXAgPSBrbWFsbG9jKHNpemVvZigqZnVuY19jb21wKSwgR0ZQX0tFUk5F
TCk7Cj4gLQlpZiAoIWZ1bmNfY29tcCkgewo+IC0JCWVyciA9IC1FTk9NRU07Cj4gLQkJZ290byBl
cnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQl9Cj4gLQlmdW5jX2NvbXAtPmNvdW50ID0gY291bnQ7Cj4g
LQo+IC0JLyogQ3JlYXRlIENvdW50IGZ1bmN0aW9uIGF0dHJpYnV0ZSAqLwo+IC0JcGFybS5ncm91
cCA9IGdyb3VwOwo+IC0JcGFybS5wcmVmaXggPSAiIjsKPiAtCXBhcm0ubmFtZSA9ICJmdW5jdGlv
biI7Cj4gLQlwYXJtLnNob3cgPSAoY291bnRlci0+b3BzLT5mdW5jdGlvbl9nZXQpID8gY291bnRl
cl9mdW5jdGlvbl9zaG93IDogTlVMTDsKPiAtCXBhcm0uc3RvcmUgPSAoY291bnRlci0+b3BzLT5m
dW5jdGlvbl9zZXQpID8gY291bnRlcl9mdW5jdGlvbl9zdG9yZSA6IE5VTEw7Cj4gLQlwYXJtLmNv
bXBvbmVudCA9IGZ1bmNfY29tcDsKPiAtCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgm
cGFybSk7Cj4gLQlpZiAoZXJyKSB7Cj4gLQkJa2ZyZWUoZnVuY19jb21wKTsKPiAtCQlnb3RvIGVy
cl9mcmVlX2F0dHJfbGlzdDsKPiAtCX0KPiAtCj4gLQkvKiBBbGxvY2F0ZSBmdW5jdGlvbiBhdmFp
bGFibGUgYXR0cmlidXRlIGNvbXBvbmVudCAqLwo+IC0JYXZhaWxfY29tcCA9IGttYWxsb2Moc2l6
ZW9mKCphdmFpbF9jb21wKSwgR0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIWF2YWlsX2NvbXApIHsKPiAt
CQllcnIgPSAtRU5PTUVNOwo+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0Owo+IC0JfQo+IC0J
YXZhaWxfY29tcC0+ZnVuY3Rpb25zX2xpc3QgPSBjb3VudC0+ZnVuY3Rpb25zX2xpc3Q7Cj4gLQlh
dmFpbF9jb21wLT5udW1fZnVuY3Rpb25zID0gY291bnQtPm51bV9mdW5jdGlvbnM7Cj4gLQo+IC0J
LyogQ3JlYXRlIENvdW50IGZ1bmN0aW9uX2F2YWlsYWJsZSBhdHRyaWJ1dGUgKi8KPiAtCXBhcm0u
Z3JvdXAgPSBncm91cDsKPiAtCXBhcm0ucHJlZml4ID0gIiI7Cj4gLQlwYXJtLm5hbWUgPSAiZnVu
Y3Rpb25fYXZhaWxhYmxlIjsKPiAtCXBhcm0uc2hvdyA9IGNvdW50ZXJfZnVuY3Rpb25fYXZhaWxh
YmxlX3Nob3c7Cj4gLQlwYXJtLnN0b3JlID0gTlVMTDsKPiAtCXBhcm0uY29tcG9uZW50ID0gYXZh
aWxfY29tcDsKPiAtCWVyciA9IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Cj4gLQlp
ZiAoZXJyKSB7Cj4gLQkJa2ZyZWUoYXZhaWxfY29tcCk7Cj4gLQkJZ290byBlcnJfZnJlZV9hdHRy
X2xpc3Q7Cj4gLQl9Cj4gLQo+IC0JLyogQ3JlYXRlIENvdW50IG5hbWUgYXR0cmlidXRlICovCj4g
LQllcnIgPSBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0ZShncm91cCwgY291bnQtPm5hbWUp
Owo+IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCj4gLQkvKiBS
ZWdpc3RlciBDb3VudCBleHRlbnNpb24gYXR0cmlidXRlcyAqLwo+IC0JZXJyID0gY291bnRlcl9j
b3VudF9leHRfcmVnaXN0ZXIoZ3JvdXAsIGNvdW50KTsKPiAtCWlmIChlcnIpCj4gLQkJZ290byBl
cnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRy
X2xpc3Q6Cj4gLQljb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlz
dCk7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJfY291bnRz
X3JlZ2lzdGVyKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdy
b3Vwc19saXN0LAo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVy
KQo+IC17Cj4gLQlzaXplX3QgaTsKPiAtCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKPiAt
CWNvbnN0IGNoYXIgKm5hbWU7Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCS8qIFJlZ2lzdGVyIGVhY2gg
Q291bnQgKi8KPiAtCWZvciAoaSA9IDA7IGkgPCBjb3VudGVyLT5udW1fY291bnRzOyBpKyspIHsK
PiAtCQljb3VudCA9IGNvdW50ZXItPmNvdW50cyArIGk7Cj4gLQo+IC0JCS8qIEdlbmVyYXRlIENv
dW50IGF0dHJpYnV0ZSBkaXJlY3RvcnkgbmFtZSAqLwo+IC0JCW5hbWUgPSBrYXNwcmludGYoR0ZQ
X0tFUk5FTCwgImNvdW50JWQiLCBjb3VudC0+aWQpOwo+IC0JCWlmICghbmFtZSkgewo+IC0JCQll
cnIgPSAtRU5PTUVNOwo+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfZ3JvdXBzOwo+IC0JCX0KPiAt
CQlncm91cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUgPSBuYW1lOwo+IC0KPiAtCQkvKiBSZWdp
c3RlciB0aGUgU3luYXBzZXMgYXNzb2NpYXRlZCB3aXRoIGVhY2ggQ291bnQgKi8KPiAtCQllcnIg
PSBjb3VudGVyX3N5bmFwc2VzX3JlZ2lzdGVyKGdyb3Vwc19saXN0ICsgaSwgY291bnRlciwgY291
bnQsCj4gLQkJCQkJCW5hbWUpOwo+IC0JCWlmIChlcnIpCj4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0
cl9ncm91cHM7Cj4gLQo+IC0JCS8qIENyZWF0ZSBhbGwgYXR0cmlidXRlcyBhc3NvY2lhdGVkIHdp
dGggQ291bnQgKi8KPiAtCQllcnIgPSBjb3VudGVyX2NvdW50X2F0dHJpYnV0ZXNfY3JlYXRlKGdy
b3Vwc19saXN0ICsgaSwgY291bnRlciwKPiAtCQkJCQkJICAgICAgY291bnQpOwo+IC0JCWlmIChl
cnIpCj4gLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9ncm91cHM7Cj4gLQl9Cj4gLQo+IC0JcmV0dXJu
IDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRyX2dyb3VwczoKPiAtCWRvIHsKPiAtCQlrZnJlZShncm91
cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUpOwo+IC0JCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlz
dF9mcmVlKCZncm91cHNfbGlzdFtpXS5hdHRyX2xpc3QpOwo+IC0JfSB3aGlsZSAoaS0tKTsKPiAt
CXJldHVybiBlcnI7Cj4gLX0KPiAtCj4gLXN0cnVjdCBjb3VudGVyX3NpemVfdW5pdCB7Cj4gLQlz
aXplX3Qgc2l6ZTsKPiAtfTsKPiAtCj4gLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfZGV2aWNlX2F0
dHJfc2l6ZV9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCQkJCQkgICAgIHN0cnVjdCBkZXZp
Y2VfYXR0cmlidXRlICphdHRyLAo+IC0JCQkJCSAgICAgY2hhciAqYnVmKQo+IC17Cj4gLQljb25z
dCBzdHJ1Y3QgY291bnRlcl9zaXplX3VuaXQgKmNvbnN0IGNvbXAgPSB0b19jb3VudGVyX2F0dHIo
YXR0ciktPmNvbXBvbmVudDsKPiAtCj4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIlenVcbiIsIGNv
bXAtPnNpemUpOwo+IC19Cj4gLQo+IC1zdGF0aWMgaW50IGNvdW50ZXJfc2l6ZV9hdHRyaWJ1dGVf
Y3JlYXRlKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3Vw
LAo+IC0JY29uc3Qgc2l6ZV90IHNpemUsIGNvbnN0IGNoYXIgKmNvbnN0IG5hbWUpCj4gLXsKPiAt
CXN0cnVjdCBjb3VudGVyX3NpemVfdW5pdCAqc2l6ZV9jb21wOwo+IC0Jc3RydWN0IGNvdW50ZXJf
YXR0cl9wYXJtIHBhcm07Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCS8qIEFsbG9jYXRlIHNpemUgYXR0
cmlidXRlIGNvbXBvbmVudCAqLwo+IC0Jc2l6ZV9jb21wID0ga21hbGxvYyhzaXplb2YoKnNpemVf
Y29tcCksIEdGUF9LRVJORUwpOwo+IC0JaWYgKCFzaXplX2NvbXApCj4gLQkJcmV0dXJuIC1FTk9N
RU07Cj4gLQlzaXplX2NvbXAtPnNpemUgPSBzaXplOwo+IC0KPiAtCXBhcm0uZ3JvdXAgPSBncm91
cDsKPiAtCXBhcm0ucHJlZml4ID0gIiI7Cj4gLQlwYXJtLm5hbWUgPSBuYW1lOwo+IC0JcGFybS5z
aG93ID0gY291bnRlcl9kZXZpY2VfYXR0cl9zaXplX3Nob3c7Cj4gLQlwYXJtLnN0b3JlID0gTlVM
TDsKPiAtCXBhcm0uY29tcG9uZW50ID0gc2l6ZV9jb21wOwo+IC0JZXJyID0gY291bnRlcl9hdHRy
aWJ1dGVfY3JlYXRlKCZwYXJtKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290byBlcnJfZnJlZV9zaXpl
X2NvbXA7Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9zaXplX2NvbXA6Cj4gLQlr
ZnJlZShzaXplX2NvbXApOwo+IC0JcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3RydWN0IGNvdW50
ZXJfZXh0X3VuaXQgewo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4dCAqZXh0Owo+
IC19Owo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9kZXZpY2VfZXh0X3Nob3coc3RydWN0
IGRldmljZSAqZGV2LAo+IC0JCQkJICAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRy
LCBjaGFyICpidWYpCj4gLXsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpj
b25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwo+IC0JY29uc3Qgc3RydWN0IGNv
dW50ZXJfZXh0X3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAt
CWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9leHQgKmNvbnN0IGV4dCA9IGNvbXBvbmVudC0+
ZXh0Owo+IC0KPiAtCXJldHVybiBleHQtPnJlYWQoZGV2X2dldF9kcnZkYXRhKGRldiksIGV4dC0+
cHJpdiwgYnVmKTsKPiAtfQo+IC0KPiAtc3RhdGljIHNzaXplX3QgY291bnRlcl9kZXZpY2VfZXh0
X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKPiAtCQkJCQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwKPiAtCQkJCQljb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gLXsKPiAtCWNv
bnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRl
cl9hdHRyKGF0dHIpOwo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZXh0X3VuaXQgKmNvbnN0IGNv
bXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rl
dmljZV9leHQgKmNvbnN0IGV4dCA9IGNvbXBvbmVudC0+ZXh0Owo+IC0KPiAtCXJldHVybiBleHQt
PndyaXRlKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBleHQtPnByaXYsIGJ1ZiwgbGVuKTsKPiAtfQo+
IC0KPiAtc3RhdGljIGludCBjb3VudGVyX2RldmljZV9leHRfcmVnaXN0ZXIoCj4gLQlzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCj4gLQlzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gLXsKPiAtCXNpemVfdCBpOwo+IC0Jc3RydWN0IGNv
dW50ZXJfZXh0X3VuaXQgKmV4dF9jb21wOwo+IC0Jc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBh
cm07Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCS8qIENyZWF0ZSBhbiBhdHRyaWJ1dGUgZm9yIGVhY2gg
ZXh0ZW5zaW9uICovCj4gLQlmb3IgKGkgPSAwIDsgaSA8IGNvdW50ZXItPm51bV9leHQ7IGkrKykg
ewo+IC0JCS8qIEFsbG9jYXRlIGV4dGVuc2lvbiBhdHRyaWJ1dGUgY29tcG9uZW50ICovCj4gLQkJ
ZXh0X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqZXh0X2NvbXApLCBHRlBfS0VSTkVMKTsKPiAtCQlp
ZiAoIWV4dF9jb21wKSB7Cj4gLQkJCWVyciA9IC1FTk9NRU07Cj4gLQkJCWdvdG8gZXJyX2ZyZWVf
YXR0cl9saXN0Owo+IC0JCX0KPiAtCj4gLQkJZXh0X2NvbXAtPmV4dCA9IGNvdW50ZXItPmV4dCAr
IGk7Cj4gLQo+IC0JCS8qIEFsbG9jYXRlIGV4dGVuc2lvbiBhdHRyaWJ1dGUgKi8KPiAtCQlwYXJt
Lmdyb3VwID0gZ3JvdXA7Cj4gLQkJcGFybS5wcmVmaXggPSAiIjsKPiAtCQlwYXJtLm5hbWUgPSBj
b3VudGVyLT5leHRbaV0ubmFtZTsKPiAtCQlwYXJtLnNob3cgPSAoY291bnRlci0+ZXh0W2ldLnJl
YWQpID8gY291bnRlcl9kZXZpY2VfZXh0X3Nob3cgOiBOVUxMOwo+IC0JCXBhcm0uc3RvcmUgPSAo
Y291bnRlci0+ZXh0W2ldLndyaXRlKSA/IGNvdW50ZXJfZGV2aWNlX2V4dF9zdG9yZSA6IE5VTEw7
Cj4gLQkJcGFybS5jb21wb25lbnQgPSBleHRfY29tcDsKPiAtCQllcnIgPSBjb3VudGVyX2F0dHJp
YnV0ZV9jcmVhdGUoJnBhcm0pOwo+IC0JCWlmIChlcnIpIHsKPiAtCQkJa2ZyZWUoZXh0X2NvbXAp
Owo+IC0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKPiAtCQl9Cj4gLQl9Cj4gLQo+IC0JcmV0
dXJuIDA7Cj4gLQo+IC1lcnJfZnJlZV9hdHRyX2xpc3Q6Cj4gLQljb3VudGVyX2RldmljZV9hdHRy
X2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlzdCk7Cj4gLQlyZXR1cm4gZXJyOwo+IC19Cj4gLQo+
IC1zdGF0aWMgaW50IGNvdW50ZXJfZ2xvYmFsX2F0dHJfcmVnaXN0ZXIoCj4gLQlzdHJ1Y3QgY291
bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCj4gLQlzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvbnN0IGNvdW50ZXIpCj4gLXsKPiAtCWludCBlcnI7Cj4gLQo+IC0JLyogQ3JlYXRl
IG5hbWUgYXR0cmlidXRlICovCj4gLQllcnIgPSBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0
ZShncm91cCwgY291bnRlci0+bmFtZSk7Cj4gLQlpZiAoZXJyKQo+IC0JCXJldHVybiBlcnI7Cj4g
LQo+IC0JLyogQ3JlYXRlIG51bV9jb3VudHMgYXR0cmlidXRlICovCj4gLQllcnIgPSBjb3VudGVy
X3NpemVfYXR0cmlidXRlX2NyZWF0ZShncm91cCwgY291bnRlci0+bnVtX2NvdW50cywKPiAtCQkJ
CQkgICAgIm51bV9jb3VudHMiKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290byBlcnJfZnJlZV9hdHRy
X2xpc3Q7Cj4gLQo+IC0JLyogQ3JlYXRlIG51bV9zaWduYWxzIGF0dHJpYnV0ZSAqLwo+IC0JZXJy
ID0gY291bnRlcl9zaXplX2F0dHJpYnV0ZV9jcmVhdGUoZ3JvdXAsIGNvdW50ZXItPm51bV9zaWdu
YWxzLAo+IC0JCQkJCSAgICAibnVtX3NpZ25hbHMiKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290byBl
cnJfZnJlZV9hdHRyX2xpc3Q7Cj4gLQo+IC0JLyogUmVnaXN0ZXIgQ291bnRlciBkZXZpY2UgZXh0
ZW5zaW9uIGF0dHJpYnV0ZXMgKi8KPiAtCWVyciA9IGNvdW50ZXJfZGV2aWNlX2V4dF9yZWdpc3Rl
cihncm91cCwgY291bnRlcik7Cj4gLQlpZiAoZXJyKQo+IC0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9s
aXN0Owo+IC0KPiAtCXJldHVybiAwOwo+IC0KPiAtZXJyX2ZyZWVfYXR0cl9saXN0Ogo+IC0JY291
bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwo+IC0JcmV0dXJu
IGVycjsKPiAtfQo+IC0KPiAtc3RhdGljIHZvaWQgY291bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3Rf
ZnJlZSgKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cHNf
bGlzdCwKPiAtCWNvbnN0IHNpemVfdCBudW1fZ3JvdXBzKQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRl
cl9kZXZpY2VfYXR0cl9ncm91cCAqZ3JvdXA7Cj4gLQlzaXplX3QgaTsKPiAtCj4gLQkvKiBsb29w
IHRocm91Z2ggYWxsIGF0dHJpYnV0ZSBncm91cHMgKHNpZ25hbHMsIGNvdW50cywgZ2xvYmFsLCBl
dGMuKSAqLwo+IC0JZm9yIChpID0gMDsgaSA8IG51bV9ncm91cHM7IGkrKykgewo+IC0JCWdyb3Vw
ID0gZ3JvdXBzX2xpc3QgKyBpOwo+IC0KPiAtCQkvKiBmcmVlIGFsbCBhdHRyaWJ1dGUgZ3JvdXAg
YW5kIGFzc29jaWF0ZWQgYXR0cmlidXRlcyBtZW1vcnkgKi8KPiAtCQlrZnJlZShncm91cC0+YXR0
cl9ncm91cC5uYW1lKTsKPiAtCQlrZnJlZShncm91cC0+YXR0cl9ncm91cC5hdHRycyk7Cj4gLQkJ
Y291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwo+IC0JfQo+
IC0KPiAtCWtmcmVlKGdyb3Vwc19saXN0KTsKPiAtfQo+IC0KPiAtc3RhdGljIGludCBjb3VudGVy
X2RldmljZV9ncm91cHNfbGlzdF9wcmVwYXJlKAo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b25zdCBjb3VudGVyKQo+IC17Cj4gLQljb25zdCBzaXplX3QgdG90YWxfbnVtX2dyb3VwcyA9Cj4g
LQkJY291bnRlci0+bnVtX3NpZ25hbHMgKyBjb3VudGVyLT5udW1fY291bnRzICsgMTsKPiAtCXN0
cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpncm91cHNfbGlzdDsKPiAtCXNpemVfdCBp
Owo+IC0JaW50IGVycjsKPiAtCXNpemVfdCBudW1fZ3JvdXBzID0gMDsKPiAtCj4gLQkvKiBBbGxv
Y2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIGdyb3VwcyAoc2lnbmFscywgY291bnRzLCBhbmQgZXh0
KSAqLwo+IC0JZ3JvdXBzX2xpc3QgPSBrY2FsbG9jKHRvdGFsX251bV9ncm91cHMsIHNpemVvZigq
Z3JvdXBzX2xpc3QpLAo+IC0JCQkgICAgICBHRlBfS0VSTkVMKTsKPiAtCWlmICghZ3JvdXBzX2xp
c3QpCj4gLQkJcmV0dXJuIC1FTk9NRU07Cj4gLQo+IC0JLyogSW5pdGlhbGl6ZSBhdHRyaWJ1dGUg
bGlzdHMgKi8KPiAtCWZvciAoaSA9IDA7IGkgPCB0b3RhbF9udW1fZ3JvdXBzOyBpKyspCj4gLQkJ
SU5JVF9MSVNUX0hFQUQoJmdyb3Vwc19saXN0W2ldLmF0dHJfbGlzdCk7Cj4gLQo+IC0JLyogUmVn
aXN0ZXIgU2lnbmFscyAqLwo+IC0JZXJyID0gY291bnRlcl9zaWduYWxzX3JlZ2lzdGVyKGdyb3Vw
c19saXN0LCBjb3VudGVyKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290byBlcnJfZnJlZV9ncm91cHNf
bGlzdDsKPiAtCW51bV9ncm91cHMgKz0gY291bnRlci0+bnVtX3NpZ25hbHM7Cj4gLQo+IC0JLyog
UmVnaXN0ZXIgQ291bnRzIGFuZCByZXNwZWN0aXZlIFN5bmFwc2VzICovCj4gLQllcnIgPSBjb3Vu
dGVyX2NvdW50c19yZWdpc3Rlcihncm91cHNfbGlzdCArIG51bV9ncm91cHMsIGNvdW50ZXIpOwo+
IC0JaWYgKGVycikKPiAtCQlnb3RvIGVycl9mcmVlX2dyb3Vwc19saXN0Owo+IC0JbnVtX2dyb3Vw
cyArPSBjb3VudGVyLT5udW1fY291bnRzOwo+IC0KPiAtCS8qIFJlZ2lzdGVyIENvdW50ZXIgZ2xv
YmFsIGF0dHJpYnV0ZXMgKi8KPiAtCWVyciA9IGNvdW50ZXJfZ2xvYmFsX2F0dHJfcmVnaXN0ZXIo
Z3JvdXBzX2xpc3QgKyBudW1fZ3JvdXBzLCBjb3VudGVyKTsKPiAtCWlmIChlcnIpCj4gLQkJZ290
byBlcnJfZnJlZV9ncm91cHNfbGlzdDsKPiAtCW51bV9ncm91cHMrKzsKPiAtCj4gLQkvKiBTdG9y
ZSBncm91cHNfbGlzdCBpbiBkZXZpY2Vfc3RhdGUgKi8KPiAtCWNvdW50ZXItPmRldmljZV9zdGF0
ZS0+Z3JvdXBzX2xpc3QgPSBncm91cHNfbGlzdDsKPiAtCWNvdW50ZXItPmRldmljZV9zdGF0ZS0+
bnVtX2dyb3VwcyA9IG51bV9ncm91cHM7Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJl
ZV9ncm91cHNfbGlzdDoKPiAtCWNvdW50ZXJfZGV2aWNlX2dyb3Vwc19saXN0X2ZyZWUoZ3JvdXBz
X2xpc3QsIG51bV9ncm91cHMpOwo+IC0JcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtc3RhdGljIGlu
dCBjb3VudGVyX2RldmljZV9ncm91cHNfcHJlcGFyZSgKPiAtCXN0cnVjdCBjb3VudGVyX2Rldmlj
ZV9zdGF0ZSAqY29uc3QgZGV2aWNlX3N0YXRlKQo+IC17Cj4gLQlzaXplX3QgaSwgajsKPiAtCXN0
cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpncm91cDsKPiAtCWludCBlcnI7Cj4gLQlz
dHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqcDsKPiAtCj4gLQkvKiBBbGxvY2F0ZSBhdHRyaWJ1
dGUgZ3JvdXBzIGZvciBhc3NvY2lhdGlvbiB3aXRoIGRldmljZSAqLwo+IC0JZGV2aWNlX3N0YXRl
LT5ncm91cHMgPSBrY2FsbG9jKGRldmljZV9zdGF0ZS0+bnVtX2dyb3VwcyArIDEsCj4gLQkJCQkg
ICAgICAgc2l6ZW9mKCpkZXZpY2Vfc3RhdGUtPmdyb3VwcyksCj4gLQkJCQkgICAgICAgR0ZQX0tF
Uk5FTCk7Cj4gLQlpZiAoIWRldmljZV9zdGF0ZS0+Z3JvdXBzKQo+IC0JCXJldHVybiAtRU5PTUVN
Owo+IC0KPiAtCS8qIFByZXBhcmUgZWFjaCBncm91cCBvZiBhdHRyaWJ1dGVzIGZvciBhc3NvY2lh
dGlvbiAqLwo+IC0JZm9yIChpID0gMDsgaSA8IGRldmljZV9zdGF0ZS0+bnVtX2dyb3VwczsgaSsr
KSB7Cj4gLQkJZ3JvdXAgPSBkZXZpY2Vfc3RhdGUtPmdyb3Vwc19saXN0ICsgaTsKPiAtCj4gLQkJ
LyogQWxsb2NhdGUgc3BhY2UgZm9yIGF0dHJpYnV0ZSBwb2ludGVycyBpbiBhdHRyaWJ1dGUgZ3Jv
dXAgKi8KPiAtCQlncm91cC0+YXR0cl9ncm91cC5hdHRycyA9IGtjYWxsb2MoZ3JvdXAtPm51bV9h
dHRyICsgMSwKPiAtCQkJc2l6ZW9mKCpncm91cC0+YXR0cl9ncm91cC5hdHRycyksIEdGUF9LRVJO
RUwpOwo+IC0JCWlmICghZ3JvdXAtPmF0dHJfZ3JvdXAuYXR0cnMpIHsKPiAtCQkJZXJyID0gLUVO
T01FTTsKPiAtCQkJZ290byBlcnJfZnJlZV9ncm91cHM7Cj4gLQkJfQo+IC0KPiAtCQkvKiBBZGQg
YXR0cmlidXRlIHBvaW50ZXJzIHRvIGF0dHJpYnV0ZSBncm91cCAqLwo+IC0JCWogPSAwOwo+IC0J
CWxpc3RfZm9yX2VhY2hfZW50cnkocCwgJmdyb3VwLT5hdHRyX2xpc3QsIGwpCj4gLQkJCWdyb3Vw
LT5hdHRyX2dyb3VwLmF0dHJzW2orK10gPSAmcC0+ZGV2X2F0dHIuYXR0cjsKPiAtCj4gLQkJLyog
R3JvdXAgYXR0cmlidXRlcyBpbiBhdHRyaWJ1dGUgZ3JvdXAgKi8KPiAtCQlkZXZpY2Vfc3RhdGUt
Pmdyb3Vwc1tpXSA9ICZncm91cC0+YXR0cl9ncm91cDsKPiAtCX0KPiAtCS8qIEFzc29jaWF0ZSBh
dHRyaWJ1dGVzIHdpdGggZGV2aWNlICovCj4gLQlkZXZpY2Vfc3RhdGUtPmRldi5ncm91cHMgPSBk
ZXZpY2Vfc3RhdGUtPmdyb3VwczsKPiAtCj4gLQlyZXR1cm4gMDsKPiAtCj4gLWVycl9mcmVlX2dy
b3VwczoKPiAtCWRvIHsKPiAtCQlncm91cCA9IGRldmljZV9zdGF0ZS0+Z3JvdXBzX2xpc3QgKyBp
Owo+IC0JCWtmcmVlKGdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzKTsKPiAtCQlncm91cC0+YXR0cl9n
cm91cC5hdHRycyA9IE5VTEw7Cj4gLQl9IHdoaWxlIChpLS0pOwo+IC0Ja2ZyZWUoZGV2aWNlX3N0
YXRlLT5ncm91cHMpOwo+IC0JcmV0dXJuIGVycjsKPiAtfQo+IC0KPiAtLyogUHJvdmlkZXMgYSB1
bmlxdWUgSUQgZm9yIGVhY2ggY291bnRlciBkZXZpY2UgKi8KPiAtc3RhdGljIERFRklORV9JREEo
Y291bnRlcl9pZGEpOwo+IC0KPiAtc3RhdGljIHZvaWQgY291bnRlcl9kZXZpY2VfcmVsZWFzZShz
dHJ1Y3QgZGV2aWNlICpkZXYpCj4gLXsKPiAtCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3Qg
Y291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNl
X3N0YXRlICpjb25zdCBkZXZpY2Vfc3RhdGUgPSBjb3VudGVyLT5kZXZpY2Vfc3RhdGU7Cj4gLQo+
IC0Ja2ZyZWUoZGV2aWNlX3N0YXRlLT5ncm91cHMpOwo+IC0JY291bnRlcl9kZXZpY2VfZ3JvdXBz
X2xpc3RfZnJlZShkZXZpY2Vfc3RhdGUtPmdyb3Vwc19saXN0LAo+IC0JCQkJCWRldmljZV9zdGF0
ZS0+bnVtX2dyb3Vwcyk7Cj4gLQlpZGFfc2ltcGxlX3JlbW92ZSgmY291bnRlcl9pZGEsIGRldmlj
ZV9zdGF0ZS0+aWQpOwo+IC0Ja2ZyZWUoZGV2aWNlX3N0YXRlKTsKPiAtfQo+IC0KPiAtc3RhdGlj
IHN0cnVjdCBkZXZpY2VfdHlwZSBjb3VudGVyX2RldmljZV90eXBlID0gewo+IC0JLm5hbWUgPSAi
Y291bnRlcl9kZXZpY2UiLAo+IC0JLnJlbGVhc2UgPSBjb3VudGVyX2RldmljZV9yZWxlYXNlCj4g
LX07Cj4gLQo+IC1zdGF0aWMgc3RydWN0IGJ1c190eXBlIGNvdW50ZXJfYnVzX3R5cGUgPSB7Cj4g
LQkubmFtZSA9ICJjb3VudGVyIgo+IC19Owo+IC0KPiAtLyoqCj4gLSAqIGNvdW50ZXJfcmVnaXN0
ZXIgLSByZWdpc3RlciBDb3VudGVyIHRvIHRoZSBzeXN0ZW0KPiAtICogQGNvdW50ZXI6CXBvaW50
ZXIgdG8gQ291bnRlciB0byByZWdpc3Rlcgo+IC0gKgo+IC0gKiBUaGlzIGZ1bmN0aW9uIHJlZ2lz
dGVycyBhIENvdW50ZXIgdG8gdGhlIHN5c3RlbS4gQSBzeXNmcyAiY291bnRlciIgZGlyZWN0b3J5
Cj4gLSAqIHdpbGwgYmUgY3JlYXRlZCBhbmQgcG9wdWxhdGVkIHdpdGggc3lzZnMgYXR0cmlidXRl
cyBjb3JyZWxhdGluZyB3aXRoIHRoZQo+IC0gKiBDb3VudGVyIFNpZ25hbHMsIFN5bmFwc2VzLCBh
bmQgQ291bnRzIHJlc3BlY3RpdmVseS4KPiAtICovCj4gLWludCBjb3VudGVyX3JlZ2lzdGVyKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikKPiAtewo+IC0Jc3RydWN0IGNvdW50
ZXJfZGV2aWNlX3N0YXRlICpkZXZpY2Vfc3RhdGU7Cj4gLQlpbnQgZXJyOwo+IC0KPiAtCS8qIEFs
bG9jYXRlIGludGVybmFsIHN0YXRlIGNvbnRhaW5lciBmb3IgQ291bnRlciBkZXZpY2UgKi8KPiAt
CWRldmljZV9zdGF0ZSA9IGt6YWxsb2Moc2l6ZW9mKCpkZXZpY2Vfc3RhdGUpLCBHRlBfS0VSTkVM
KTsKPiAtCWlmICghZGV2aWNlX3N0YXRlKQo+IC0JCXJldHVybiAtRU5PTUVNOwo+IC0JY291bnRl
ci0+ZGV2aWNlX3N0YXRlID0gZGV2aWNlX3N0YXRlOwo+IC0KPiAtCS8qIEFjcXVpcmUgdW5pcXVl
IElEICovCj4gLQlkZXZpY2Vfc3RhdGUtPmlkID0gaWRhX3NpbXBsZV9nZXQoJmNvdW50ZXJfaWRh
LCAwLCAwLCBHRlBfS0VSTkVMKTsKPiAtCWlmIChkZXZpY2Vfc3RhdGUtPmlkIDwgMCkgewo+IC0J
CWVyciA9IGRldmljZV9zdGF0ZS0+aWQ7Cj4gLQkJZ290byBlcnJfZnJlZV9kZXZpY2Vfc3RhdGU7
Cj4gLQl9Cj4gLQo+IC0JLyogQ29uZmlndXJlIGRldmljZSBzdHJ1Y3R1cmUgZm9yIENvdW50ZXIg
Ki8KPiAtCWRldmljZV9zdGF0ZS0+ZGV2LnR5cGUgPSAmY291bnRlcl9kZXZpY2VfdHlwZTsKPiAt
CWRldmljZV9zdGF0ZS0+ZGV2LmJ1cyA9ICZjb3VudGVyX2J1c190eXBlOwo+IC0JaWYgKGNvdW50
ZXItPnBhcmVudCkgewo+IC0JCWRldmljZV9zdGF0ZS0+ZGV2LnBhcmVudCA9IGNvdW50ZXItPnBh
cmVudDsKPiAtCQlkZXZpY2Vfc3RhdGUtPmRldi5vZl9ub2RlID0gY291bnRlci0+cGFyZW50LT5v
Zl9ub2RlOwo+IC0JfQo+IC0JZGV2X3NldF9uYW1lKCZkZXZpY2Vfc3RhdGUtPmRldiwgImNvdW50
ZXIlZCIsIGRldmljZV9zdGF0ZS0+aWQpOwo+IC0JZGV2aWNlX2luaXRpYWxpemUoJmRldmljZV9z
dGF0ZS0+ZGV2KTsKPiAtCWRldl9zZXRfZHJ2ZGF0YSgmZGV2aWNlX3N0YXRlLT5kZXYsIGNvdW50
ZXIpOwo+IC0KPiAtCS8qIFByZXBhcmUgZGV2aWNlIGF0dHJpYnV0ZXMgKi8KPiAtCWVyciA9IGNv
dW50ZXJfZGV2aWNlX2dyb3Vwc19saXN0X3ByZXBhcmUoY291bnRlcik7Cj4gLQlpZiAoZXJyKQo+
IC0JCWdvdG8gZXJyX2ZyZWVfaWQ7Cj4gLQo+IC0JLyogT3JnYW5pemUgZGV2aWNlIGF0dHJpYnV0
ZXMgdG8gZ3JvdXBzIGFuZCBtYXRjaCB0byBkZXZpY2UgKi8KPiAtCWVyciA9IGNvdW50ZXJfZGV2
aWNlX2dyb3Vwc19wcmVwYXJlKGRldmljZV9zdGF0ZSk7Cj4gLQlpZiAoZXJyKQo+IC0JCWdvdG8g
ZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q7Cj4gLQo+IC0JLyogQWRkIGRldmljZSB0byBzeXN0ZW0gKi8K
PiAtCWVyciA9IGRldmljZV9hZGQoJmRldmljZV9zdGF0ZS0+ZGV2KTsKPiAtCWlmIChlcnIpCj4g
LQkJZ290byBlcnJfZnJlZV9ncm91cHM7Cj4gLQo+IC0JcmV0dXJuIDA7Cj4gLQo+IC1lcnJfZnJl
ZV9ncm91cHM6Cj4gLQlrZnJlZShkZXZpY2Vfc3RhdGUtPmdyb3Vwcyk7Cj4gLWVycl9mcmVlX2dy
b3Vwc19saXN0Ogo+IC0JY291bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3RfZnJlZShkZXZpY2Vfc3Rh
dGUtPmdyb3Vwc19saXN0LAo+IC0JCQkJCWRldmljZV9zdGF0ZS0+bnVtX2dyb3Vwcyk7Cj4gLWVy
cl9mcmVlX2lkOgo+IC0JaWRhX3NpbXBsZV9yZW1vdmUoJmNvdW50ZXJfaWRhLCBkZXZpY2Vfc3Rh
dGUtPmlkKTsKPiAtZXJyX2ZyZWVfZGV2aWNlX3N0YXRlOgo+IC0Ja2ZyZWUoZGV2aWNlX3N0YXRl
KTsKPiAtCXJldHVybiBlcnI7Cj4gLX0KPiAtRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9yZWdp
c3Rlcik7Cj4gLQo+IC0vKioKPiAtICogY291bnRlcl91bnJlZ2lzdGVyIC0gdW5yZWdpc3RlciBD
b3VudGVyIGZyb20gdGhlIHN5c3RlbQo+IC0gKiBAY291bnRlcjoJcG9pbnRlciB0byBDb3VudGVy
IHRvIHVucmVnaXN0ZXIKPiAtICoKPiAtICogVGhlIENvdW50ZXIgaXMgdW5yZWdpc3RlcmVkIGZy
b20gdGhlIHN5c3RlbTsgYWxsIGFsbG9jYXRlZCBtZW1vcnkgaXMgZnJlZWQuCj4gLSAqLwo+IC12
b2lkIGNvdW50ZXJfdW5yZWdpc3RlcihzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50
ZXIpCj4gLXsKPiAtCWlmIChjb3VudGVyKQo+IC0JCWRldmljZV9kZWwoJmNvdW50ZXItPmRldmlj
ZV9zdGF0ZS0+ZGV2KTsKPiAtfQo+IC1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3VucmVnaXN0
ZXIpOwo+IC0KPiAtc3RhdGljIHZvaWQgZGV2bV9jb3VudGVyX3VucmVnKHN0cnVjdCBkZXZpY2Ug
KmRldiwgdm9pZCAqcmVzKQo+IC17Cj4gLQljb3VudGVyX3VucmVnaXN0ZXIoKihzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKiopcmVzKTsKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIGRldm1fY291bnRlcl9y
ZWdpc3RlciAtIFJlc291cmNlLW1hbmFnZWQgY291bnRlcl9yZWdpc3Rlcgo+IC0gKiBAZGV2Oglk
ZXZpY2UgdG8gYWxsb2NhdGUgY291bnRlcl9kZXZpY2UgZm9yCj4gLSAqIEBjb3VudGVyOglwb2lu
dGVyIHRvIENvdW50ZXIgdG8gcmVnaXN0ZXIKPiAtICoKPiAtICogTWFuYWdlZCBjb3VudGVyX3Jl
Z2lzdGVyLiBUaGUgQ291bnRlciByZWdpc3RlcmVkIHdpdGggdGhpcyBmdW5jdGlvbiBpcwo+IC0g
KiBhdXRvbWF0aWNhbGx5IHVucmVnaXN0ZXJlZCBvbiBkcml2ZXIgZGV0YWNoLiBUaGlzIGZ1bmN0
aW9uIGNhbGxzCj4gLSAqIGNvdW50ZXJfcmVnaXN0ZXIgaW50ZXJuYWxseS4gUmVmZXIgdG8gdGhh
dCBmdW5jdGlvbiBmb3IgbW9yZSBpbmZvcm1hdGlvbi4KPiAtICoKPiAtICogSWYgYW4gQ291bnRl
ciByZWdpc3RlcmVkIHdpdGggdGhpcyBmdW5jdGlvbiBuZWVkcyB0byBiZSB1bnJlZ2lzdGVyZWQK
PiAtICogc2VwYXJhdGVseSwgZGV2bV9jb3VudGVyX3VucmVnaXN0ZXIgbXVzdCBiZSB1c2VkLgo+
IC0gKgo+IC0gKiBSRVRVUk5TOgo+IC0gKiAwIG9uIHN1Y2Nlc3MsIG5lZ2F0aXZlIGVycm9yIG51
bWJlciBvbiBmYWlsdXJlLgo+IC0gKi8KPiAtaW50IGRldm1fY291bnRlcl9yZWdpc3RlcihzdHJ1
Y3QgZGV2aWNlICpkZXYsCj4gLQkJCSAgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3Vu
dGVyKQo+IC17Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKipwdHI7Cj4gLQlpbnQgcmV0Owo+
IC0KPiAtCXB0ciA9IGRldnJlc19hbGxvYyhkZXZtX2NvdW50ZXJfdW5yZWcsIHNpemVvZigqcHRy
KSwgR0ZQX0tFUk5FTCk7Cj4gLQlpZiAoIXB0cikKPiAtCQlyZXR1cm4gLUVOT01FTTsKPiAtCj4g
LQlyZXQgPSBjb3VudGVyX3JlZ2lzdGVyKGNvdW50ZXIpOwo+IC0JaWYgKCFyZXQpIHsKPiAtCQkq
cHRyID0gY291bnRlcjsKPiAtCQlkZXZyZXNfYWRkKGRldiwgcHRyKTsKPiAtCX0gZWxzZSB7Cj4g
LQkJZGV2cmVzX2ZyZWUocHRyKTsKPiAtCX0KPiAtCj4gLQlyZXR1cm4gcmV0Owo+IC19Cj4gLUVY
UE9SVF9TWU1CT0xfR1BMKGRldm1fY291bnRlcl9yZWdpc3Rlcik7Cj4gLQo+IC1zdGF0aWMgaW50
IGRldm1fY291bnRlcl9tYXRjaChzdHJ1Y3QgZGV2aWNlICpkZXYsIHZvaWQgKnJlcywgdm9pZCAq
ZGF0YSkKPiAtewo+IC0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICoqciA9IHJlczsKPiAtCj4gLQlp
ZiAoIXIgfHwgISpyKSB7Cj4gLQkJV0FSTl9PTighciB8fCAhKnIpOwo+IC0JCXJldHVybiAwOwo+
IC0JfQo+IC0KPiAtCXJldHVybiAqciA9PSBkYXRhOwo+IC19Cj4gLQo+IC0vKioKPiAtICogZGV2
bV9jb3VudGVyX3VucmVnaXN0ZXIgLSBSZXNvdXJjZS1tYW5hZ2VkIGNvdW50ZXJfdW5yZWdpc3Rl
cgo+IC0gKiBAZGV2OglkZXZpY2UgdGhpcyBjb3VudGVyX2RldmljZSBiZWxvbmdzIHRvCj4gLSAq
IEBjb3VudGVyOglwb2ludGVyIHRvIENvdW50ZXIgYXNzb2NpYXRlZCB3aXRoIHRoZSBkZXZpY2UK
PiAtICoKPiAtICogVW5yZWdpc3RlciBDb3VudGVyIHJlZ2lzdGVyZWQgd2l0aCBkZXZtX2NvdW50
ZXJfcmVnaXN0ZXIuCj4gLSAqLwo+IC12b2lkIGRldm1fY291bnRlcl91bnJlZ2lzdGVyKHN0cnVj
dCBkZXZpY2UgKmRldiwKPiAtCQkJICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNv
dW50ZXIpCj4gLXsKPiAtCWludCByYzsKPiAtCj4gLQlyYyA9IGRldnJlc19yZWxlYXNlKGRldiwg
ZGV2bV9jb3VudGVyX3VucmVnLCBkZXZtX2NvdW50ZXJfbWF0Y2gsCj4gLQkJCSAgICBjb3VudGVy
KTsKPiAtCVdBUk5fT04ocmMpOwo+IC19Cj4gLUVYUE9SVF9TWU1CT0xfR1BMKGRldm1fY291bnRl
cl91bnJlZ2lzdGVyKTsKPiAtCj4gLXN0YXRpYyBpbnQgX19pbml0IGNvdW50ZXJfaW5pdCh2b2lk
KQo+IC17Cj4gLQlyZXR1cm4gYnVzX3JlZ2lzdGVyKCZjb3VudGVyX2J1c190eXBlKTsKPiAtfQo+
IC0KPiAtc3RhdGljIHZvaWQgX19leGl0IGNvdW50ZXJfZXhpdCh2b2lkKQo+IC17Cj4gLQlidXNf
dW5yZWdpc3RlcigmY291bnRlcl9idXNfdHlwZSk7Cj4gLX0KPiAtCj4gLXN1YnN5c19pbml0Y2Fs
bChjb3VudGVyX2luaXQpOwo+IC1tb2R1bGVfZXhpdChjb3VudGVyX2V4aXQpOwo+IC0KPiAtTU9E
VUxFX0FVVEhPUigiV2lsbGlhbSBCcmVhdGhpdHQgR3JheSA8dmlsaGVsbS5ncmF5QGdtYWlsLmNv
bT4iKTsKPiAtTU9EVUxFX0RFU0NSSVBUSU9OKCJHZW5lcmljIENvdW50ZXIgaW50ZXJmYWNlIik7
Cj4gLU1PRFVMRV9MSUNFTlNFKCJHUEwgdjIiKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3Vu
dGVyL2Z0bS1xdWFkZGVjLmMgYi9kcml2ZXJzL2NvdW50ZXIvZnRtLXF1YWRkZWMuYwo+IGluZGV4
IDUzYzE1Zjg0OTA5Yi4uNWVmMDQ3ODcwOWNkIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvY291bnRl
ci9mdG0tcXVhZGRlYy5jCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL2Z0bS1xdWFkZGVjLmMKPiBA
QCAtMTQsNiArMTQsNyBAQAo+ICAjaW5jbHVkZSA8bGludXgvbXV0ZXguaD4KPiAgI2luY2x1ZGUg
PGxpbnV4L2NvdW50ZXIuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L2JpdGZpZWxkLmg+Cj4gKyNpbmNs
dWRlIDxsaW51eC90eXBlcy5oPgo+ICAKPiAgI2RlZmluZSBGVE1fRklFTERfVVBEQVRFKGZ0bSwg
b2Zmc2V0LCBtYXNrLCB2YWwpCQkJXAo+ICAJKHsJCQkJCQkJCVwKPiBAQCAtMTE1LDggKzExNiw3
IEBAIHN0YXRpYyB2b2lkIGZ0bV9xdWFkZGVjX2Rpc2FibGUodm9pZCAqZnRtKQo+ICB9Cj4gIAo+
ICBzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2dldF9wcmVzY2FsZXIoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+IC0JCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4g
LQkJCQkgICAgIHNpemVfdCAqY250X21vZGUpCj4gKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwgdTMyICpjbnRfbW9kZSkKPiAgewo+ICAJc3RydWN0IGZ0bV9xdWFkZGVjICpm
dG0gPSBjb3VudGVyLT5wcml2Owo+ICAJdWludDMyX3Qgc2NmbGFnczsKPiBAQCAtMTI5LDggKzEy
OSw3IEBAIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfZ2V0X3ByZXNjYWxlcihzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfc2V0
X3ByZXNjYWxlcihzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAgICAgc2l6ZV90IGNudF9tb2RlKQo+
ICsJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHUzMiBjbnRfbW9kZSkKPiAg
ewo+ICAJc3RydWN0IGZ0bV9xdWFkZGVjICpmdG0gPSBjb3VudGVyLT5wcml2Owo+ICAKPiBAQCAt
MTUxLDMzICsxNTAsMTcgQEAgc3RhdGljIGNvbnN0IGNoYXIgKiBjb25zdCBmdG1fcXVhZGRlY19w
cmVzY2FsZXJbXSA9IHsKPiAgCSIxIiwgIjIiLCAiNCIsICI4IiwgIjE2IiwgIjMyIiwgIjY0Iiwg
IjEyOCIKPiAgfTsKPiAgCj4gLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4dCBm
dG1fcXVhZGRlY19wcmVzY2FsZXJfZW51bSA9IHsKPiAtCS5pdGVtcyA9IGZ0bV9xdWFkZGVjX3By
ZXNjYWxlciwKPiAtCS5udW1faXRlbXMgPSBBUlJBWV9TSVpFKGZ0bV9xdWFkZGVjX3ByZXNjYWxl
ciksCj4gLQkuZ2V0ID0gZnRtX3F1YWRkZWNfZ2V0X3ByZXNjYWxlciwKPiAtCS5zZXQgPSBmdG1f
cXVhZGRlY19zZXRfcHJlc2NhbGVyCj4gLX07Cj4gLQo+IC1lbnVtIGZ0bV9xdWFkZGVjX3N5bmFw
c2VfYWN0aW9uIHsKPiAtCUZUTV9RVUFEREVDX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCj4g
LX07Cj4gLQo+ICBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGZ0bV9x
dWFkZGVjX3N5bmFwc2VfYWN0aW9uc1tdID0gewo+IC0JW0ZUTV9RVUFEREVDX1NZTkFQU0VfQUNU
SU9OX0JPVEhfRURHRVNdID0KPiAgCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUwo+
ICB9Owo+ICAKPiAtZW51bSBmdG1fcXVhZGRlY19jb3VudF9mdW5jdGlvbiB7Cj4gLQlGVE1fUVVB
RERFQ19DT1VOVF9FTkNPREVSX01PREVfMSwKPiAtfTsKPiAtCj4gIHN0YXRpYyBjb25zdCBlbnVt
IGNvdW50ZXJfZnVuY3Rpb24gZnRtX3F1YWRkZWNfY291bnRfZnVuY3Rpb25zW10gPSB7Cj4gLQlb
RlRNX1FVQURERUNfQ09VTlRfRU5DT0RFUl9NT0RFXzFdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0Cj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQKPiAgfTsKPiAgCj4g
IHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gIAkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAg
dW5zaWduZWQgbG9uZyAqdmFsKQo+ICsJCQkJICB1NjQgKnZhbCkKPiAgewo+ICAJc3RydWN0IGZ0
bV9xdWFkZGVjICpjb25zdCBmdG0gPSBjb3VudGVyLT5wcml2Owo+ICAJdWludDMyX3QgY250dmFs
Owo+IEBAIC0xOTEsNyArMTc0LDcgQEAgc3RhdGljIGludCBmdG1fcXVhZGRlY19jb3VudF9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCj4gIHN0YXRpYyBpbnQgZnRtX3F1
YWRkZWNfY291bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJCQkJ
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJICAgY29uc3QgdW5zaWduZWQg
bG9uZyB2YWwpCj4gKwkJCQkgICBjb25zdCB1NjQgdmFsKQo+ICB7Cj4gIAlzdHJ1Y3QgZnRtX3F1
YWRkZWMgKmNvbnN0IGZ0bSA9IGNvdW50ZXItPnByaXY7Cj4gIAo+IEBAIC0yMDUsMjEgKzE4OCwy
MSBAQCBzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2NvdW50X3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgaW50IGZ0bV9x
dWFkZGVjX2NvdW50X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gLQkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkJICBzaXplX3Qg
KmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IGZ0bV9xdWFkZGVjX2NvdW50X2Z1bmN0aW9uX3JlYWQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCSAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiArCQkJCQkgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9u
KQo+ICB7Cj4gLQkqZnVuY3Rpb24gPSBGVE1fUVVBRERFQ19DT1VOVF9FTkNPREVSX01PREVfMTsK
PiArCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDsKPiAgCj4gIAly
ZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIGludCBmdG1fcXVhZGRlY19hY3Rpb25fZ2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAo+IC0JCQkJICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+IC0J
CQkJICBzaXplX3QgKmFjdGlvbikKPiArc3RhdGljIGludCBmdG1fcXVhZGRlY19hY3Rpb25fcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICBzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCj4gKwkJCQkgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNl
LAo+ICsJCQkJICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb24pCj4gIHsKPiAt
CSphY3Rpb24gPSBGVE1fUVVBRERFQ19TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsJKmFj
dGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiAgCj4gIAlyZXR1cm4g
MDsKPiAgfQo+IEBAIC0yMjcsOCArMjEwLDggQEAgc3RhdGljIGludCBmdG1fcXVhZGRlY19hY3Rp
b25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgc3RhdGljIGNvbnN0IHN0
cnVjdCBjb3VudGVyX29wcyBmdG1fcXVhZGRlY19jbnRfb3BzID0gewo+ICAJLmNvdW50X3JlYWQg
PSBmdG1fcXVhZGRlY19jb3VudF9yZWFkLAo+ICAJLmNvdW50X3dyaXRlID0gZnRtX3F1YWRkZWNf
Y291bnRfd3JpdGUsCj4gLQkuZnVuY3Rpb25fZ2V0ID0gZnRtX3F1YWRkZWNfY291bnRfZnVuY3Rp
b25fZ2V0LAo+IC0JLmFjdGlvbl9nZXQgPSBmdG1fcXVhZGRlY19hY3Rpb25fZ2V0LAo+ICsJLmZ1
bmN0aW9uX3JlYWQgPSBmdG1fcXVhZGRlY19jb3VudF9mdW5jdGlvbl9yZWFkLAo+ICsJLmFjdGlv
bl9yZWFkID0gZnRtX3F1YWRkZWNfYWN0aW9uX3JlYWQsCj4gIH07Cj4gIAo+ICBzdGF0aWMgc3Ry
dWN0IGNvdW50ZXJfc2lnbmFsIGZ0bV9xdWFkZGVjX3NpZ25hbHNbXSA9IHsKPiBAQCAtMjU1LDkg
KzIzOCwxMiBAQCBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc3luYXBzZSBmdG1fcXVhZGRlY19jb3Vu
dF9zeW5hcHNlc1tdID0gewo+ICAJfQo+ICB9Owo+ICAKPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBj
b3VudGVyX2NvdW50X2V4dCBmdG1fcXVhZGRlY19jb3VudF9leHRbXSA9IHsKPiAtCUNPVU5URVJf
Q09VTlRfRU5VTSgicHJlc2NhbGVyIiwgJmZ0bV9xdWFkZGVjX3ByZXNjYWxlcl9lbnVtKSwKPiAt
CUNPVU5URVJfQ09VTlRfRU5VTV9BVkFJTEFCTEUoInByZXNjYWxlciIsICZmdG1fcXVhZGRlY19w
cmVzY2FsZXJfZW51bSksCj4gK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9FTlVNKGZ0bV9xdWFkZGVj
X3ByZXNjYWxlcl9lbnVtLCBmdG1fcXVhZGRlY19wcmVzY2FsZXIpOwo+ICsKPiArc3RhdGljIHN0
cnVjdCBjb3VudGVyX2NvbXAgZnRtX3F1YWRkZWNfY291bnRfZXh0W10gPSB7Cj4gKwlDT1VOVEVS
X0NPTVBfQ09VTlRfRU5VTSgicHJlc2NhbGVyIiwgZnRtX3F1YWRkZWNfZ2V0X3ByZXNjYWxlciwK
PiArCQkJCWZ0bV9xdWFkZGVjX3NldF9wcmVzY2FsZXIsCj4gKwkJCQlmdG1fcXVhZGRlY19wcmVz
Y2FsZXJfZW51bSksCj4gIH07Cj4gIAo+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnQgZnRt
X3F1YWRkZWNfY291bnRzID0gewo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvaW50ZWwt
cWVwLmMgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMKPiBpbmRleCA4YTY4NDdkNWZiMmIu
LjY5NmY2OGJjOTNiYyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMK
PiArKysgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMKPiBAQCAtNjIsMTMgKzYyLDYgQEAK
PiAgCj4gICNkZWZpbmUgSU5URUxfUUVQX0NMS19QRVJJT0RfTlMJCTEwCj4gIAo+IC0jZGVmaW5l
IElOVEVMX1FFUF9DT1VOVEVSX0VYVF9SVyhfbmFtZSkJCQkJXAo+IC17CQkJCQkJCQlcCj4gLQku
bmFtZSA9ICNfbmFtZSwJCQkJCQlcCj4gLQkucmVhZCA9IF9uYW1lIyNfcmVhZCwJCQkJCVwKPiAt
CS53cml0ZSA9IF9uYW1lIyNfd3JpdGUsCQkJCQlcCj4gLX0KPiAtCj4gIHN0cnVjdCBpbnRlbF9x
ZXAgewo+ICAJc3RydWN0IGNvdW50ZXJfZGV2aWNlIGNvdW50ZXI7Cj4gIAlzdHJ1Y3QgbXV0ZXgg
bG9jazsKPiBAQCAtMTE0LDggKzEwNyw3IEBAIHN0YXRpYyB2b2lkIGludGVsX3FlcF9pbml0KHN0
cnVjdCBpbnRlbF9xZXAgKnFlcCkKPiAgfQo+ICAKPiAgc3RhdGljIGludCBpbnRlbF9xZXBfY291
bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQlzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQl1bnNpZ25lZCBsb25nICp2YWwpCj4gKwkJCQlzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsKQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxf
cWVwICpjb25zdCBxZXAgPSBjb3VudGVyLT5wcml2Owo+ICAKPiBAQCAtMTMwLDExICsxMjIsMTEg
QEAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiBpbnRlbF9xZXBfY291bnRfZnVu
Y3Rpb25zW10gPSB7Cj4gIAlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCj4gIH07Cj4g
IAo+IC1zdGF0aWMgaW50IGludGVsX3FlcF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAo+IC0JCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJ
CQkgIHNpemVfdCAqZnVuY3Rpb24pCj4gK3N0YXRpYyBpbnQgaW50ZWxfcWVwX2Z1bmN0aW9uX3Jl
YWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlv
bikKPiAgewo+IC0JKmZ1bmN0aW9uID0gMDsKPiArCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YNDsKPiAgCj4gIAlyZXR1cm4gMDsKPiAgfQo+IEBAIC0xNDMsMTkgKzEz
NSwxOSBAQCBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGludGVsX3Fl
cF9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAgCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUywKPiAgfTsKPiAgCj4gLXN0YXRpYyBpbnQgaW50ZWxfcWVwX2FjdGlvbl9nZXQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50LAo+IC0JCQkJc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtCQkJCXNpemVf
dCAqYWN0aW9uKQo+ICtzdGF0aWMgaW50IGludGVsX3FlcF9hY3Rpb25fcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+ICsJCQkJIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gKwkJCQkgZW51bSBj
b3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb24pCj4gIHsKPiAtCSphY3Rpb24gPSAwOwo+ICsJ
KmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiAgCXJldHVybiAw
Owo+ICB9Cj4gIAo+ICBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIGludGVsX3FlcF9j
b3VudGVyX29wcyA9IHsKPiAgCS5jb3VudF9yZWFkID0gaW50ZWxfcWVwX2NvdW50X3JlYWQsCj4g
LQkuZnVuY3Rpb25fZ2V0ID0gaW50ZWxfcWVwX2Z1bmN0aW9uX2dldCwKPiAtCS5hY3Rpb25fZ2V0
ID0gaW50ZWxfcWVwX2FjdGlvbl9nZXQsCj4gKwkuZnVuY3Rpb25fcmVhZCA9IGludGVsX3FlcF9m
dW5jdGlvbl9yZWFkLAo+ICsJLmFjdGlvbl9yZWFkID0gaW50ZWxfcWVwX2FjdGlvbl9yZWFkLAo+
ICB9Owo+ICAKPiAgI2RlZmluZSBJTlRFTF9RRVBfU0lHTkFMKF9pZCwgX25hbWUpIHsJCQkJXAo+
IEBAIC0xODEsMzEgKzE3MywyNyBAQCBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc3luYXBzZSBpbnRl
bF9xZXBfY291bnRfc3luYXBzZXNbXSA9IHsKPiAgCUlOVEVMX1FFUF9TWU5BUFNFKDIpLAo+ICB9
Owo+ICAKPiAtc3RhdGljIHNzaXplX3QgY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiAtCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJ
ICAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBpbnRlbF9xZXBfY2VpbGlu
Z19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1NjQgKmNlaWxpbmcpCj4gIHsKPiAgCXN0cnVjdCBpbnRlbF9x
ZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7Cj4gLQl1MzIgcmVnOwo+ICAKPiAgCXBtX3J1bnRpbWVf
Z2V0X3N5bmMocWVwLT5kZXYpOwo+IC0JcmVnID0gaW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5URUxf
UUVQTUFYKTsKPiArCSpjZWlsaW5nID0gaW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5URUxfUUVQTUFY
KTsKPiAgCXBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsKPiAgCj4gLQlyZXR1cm4gc3lzZnNfZW1p
dChidWYsICIldVxuIiwgcmVnKTsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3Np
emVfdCBjZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJ
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCSAgICAgdm9pZCAqcHJpdiwg
Y29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IGludGVsX3FlcF9jZWls
aW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IG1heCkKPiAgewo+ICAJc3RydWN0IGludGVsX3Fl
cCAqcWVwID0gY291bnRlci0+cHJpdjsKPiAtCXUzMiBtYXg7Cj4gLQlpbnQgcmV0Owo+ICsJaW50
IHJldCA9IDA7Cj4gIAo+IC0JcmV0ID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJm1heCk7Cj4gLQlpZiAo
cmV0IDwgMCkKPiAtCQlyZXR1cm4gcmV0Owo+ICsJLyogSW50ZWwgUUVQIGNlaWxpbmcgY29uZmln
dXJhdGlvbiBvbmx5IHN1cHBvcnRzIDMyLWJpdCB2YWx1ZXMgKi8KPiArCWlmIChtYXggIT0gKHUz
MiltYXgpCj4gKwkJcmV0dXJuIC1FUkFOR0U7Cj4gIAo+ICAJbXV0ZXhfbG9jaygmcWVwLT5sb2Nr
KTsKPiAgCWlmIChxZXAtPmVuYWJsZWQpIHsKPiBAQCAtMjE2LDM0ICsyMDQsMjggQEAgc3RhdGlj
IHNzaXplX3QgY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
IAlwbV9ydW50aW1lX2dldF9zeW5jKHFlcC0+ZGV2KTsKPiAgCWludGVsX3FlcF93cml0ZWwocWVw
LCBJTlRFTF9RRVBNQVgsIG1heCk7Cj4gIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7Cj4gLQly
ZXQgPSBsZW47Cj4gIAo+ICBvdXQ6Cj4gIAltdXRleF91bmxvY2soJnFlcC0+bG9jayk7Cj4gIAly
ZXR1cm4gcmV0Owo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBlbmFibGVfcmVhZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpj
b3VudCwKPiAtCQkJICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IGludGVs
X3FlcF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCAqZW5hYmxlKQo+ICB7Cj4gIAlzdHJ1Y3Qg
aW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owo+ICAKPiAtCXJldHVybiBzeXNmc19lbWl0
KGJ1ZiwgIiV1XG4iLCBxZXAtPmVuYWJsZWQpOwo+ICsJKmVuYWJsZSA9IHFlcC0+ZW5hYmxlZDsK
PiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgZW5hYmxlX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiAtCQkJICAgIHZvaWQgKnByaXYsIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6
ZV90IGxlbikKPiArc3RhdGljIGludCBpbnRlbF9xZXBfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1OCB2YWwpCj4gIHsKPiAgCXN0cnVjdCBpbnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7
Cj4gIAl1MzIgcmVnOwo+IC0JYm9vbCB2YWwsIGNoYW5nZWQ7Cj4gLQlpbnQgcmV0Owo+IC0KPiAt
CXJldCA9IGtzdHJ0b2Jvb2woYnVmLCAmdmFsKTsKPiAtCWlmIChyZXQpCj4gLQkJcmV0dXJuIHJl
dDsKPiArCWJvb2wgY2hhbmdlZDsKPiAgCj4gIAltdXRleF9sb2NrKCZxZXAtPmxvY2spOwo+ICAJ
Y2hhbmdlZCA9IHZhbCBeIHFlcC0+ZW5hYmxlZDsKPiBAQCAtMjY3LDEyICsyNDksMTIgQEAgc3Rh
dGljIHNzaXplX3QgZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAgCj4gIG91dDoKPiAgCW11dGV4X3VubG9jaygmcWVwLT5sb2NrKTsKPiAtCXJldHVybiBsZW47
Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3Qgc3Bpa2VfZmlsdGVyX25z
X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAgICB2b2lkICpwcml2LCBjaGFyICpidWYpCj4g
K3N0YXRpYyBpbnQgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc19yZWFkKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiArCQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiArCQkJCQkgIHU2NCAqbGVuZ3RoKQo+ICB7Cj4gIAlzdHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBj
b3VudGVyLT5wcml2Owo+ICAJdTMyIHJlZzsKPiBAQCAtMjgxLDI2ICsyNjMsMjQgQEAgc3RhdGlj
IHNzaXplX3Qgc3Bpa2VfZmlsdGVyX25zX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICAJcmVnID0gaW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5URUxfUUVQQ09OKTsKPiAgCWlm
ICghKHJlZyAmIElOVEVMX1FFUENPTl9GTFRfRU4pKSB7Cj4gIAkJcG1fcnVudGltZV9wdXQocWVw
LT5kZXYpOwo+IC0JCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIjBcbiIpOwo+ICsJCXJldHVybiAw
Owo+ICAJfQo+ICAJcmVnID0gSU5URUxfUUVQRkxUX01BWF9DT1VOVChpbnRlbF9xZXBfcmVhZGwo
cWVwLCBJTlRFTF9RRVBGTFQpKTsKPiAgCXBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsKPiAgCj4g
LQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIldVxuIiwgKHJlZyArIDIpICogSU5URUxfUUVQX0NM
S19QRVJJT0RfTlMpOwo+ICsJKmxlbmd0aCA9IChyZWcgKyAyKSAqIElOVEVMX1FFUF9DTEtfUEVS
SU9EX05TOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBzcGlr
ZV9maWx0ZXJfbnNfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJ
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgIHZvaWQgKnByaXYs
IGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGljIGludCBpbnRlbF9xZXBfc3Bp
a2VfZmlsdGVyX25zX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJ
CQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJICAgdTY0IGxlbmd0aCkK
PiAgewo+ICAJc3RydWN0IGludGVsX3FlcCAqcWVwID0gY291bnRlci0+cHJpdjsKPiAtCXUzMiBy
ZWcsIGxlbmd0aDsKPiArCXUzMiByZWc7Cj4gIAlib29sIGVuYWJsZTsKPiAtCWludCByZXQ7Cj4g
LQo+IC0JcmV0ID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJmxlbmd0aCk7Cj4gLQlpZiAocmV0IDwgMCkK
PiAtCQlyZXR1cm4gcmV0Owo+ICsJaW50IHJldCA9IDA7Cj4gIAo+ICAJLyoKPiAgCSAqIFNwaWtl
IGZpbHRlciBsZW5ndGggaXMgKE1BWF9DT1VOVCArIDIpIGNsb2NrIHBlcmlvZHMuCj4gQEAgLTMz
NiwxNiArMzE2LDE1IEBAIHN0YXRpYyBzc2l6ZV90IHNwaWtlX2ZpbHRlcl9uc193cml0ZShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlpbnRlbF9xZXBfd3JpdGVsKHFlcCwgSU5U
RUxfUUVQRkxULCBsZW5ndGgpOwo+ICAJaW50ZWxfcWVwX3dyaXRlbChxZXAsIElOVEVMX1FFUENP
TiwgcmVnKTsKPiAgCXBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsKPiAtCXJldCA9IGxlbjsKPiAg
Cj4gIG91dDoKPiAgCW11dGV4X3VubG9jaygmcWVwLT5sb2NrKTsKPiAgCXJldHVybiByZXQ7Cj4g
IH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiAtCQkJCSAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IGludGVsX3FlcF9w
cmVzZXRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJ
CXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQl1OCAqcHJlc2V0X2VuYWJsZSkK
PiAgewo+ICAJc3RydWN0IGludGVsX3FlcCAqcWVwID0gY291bnRlci0+cHJpdjsKPiAgCXUzMiBy
ZWc7Cj4gQEAgLTM1MywyMSArMzMyLDE4IEBAIHN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVf
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlwbV9ydW50aW1lX2dldF9z
eW5jKHFlcC0+ZGV2KTsKPiAgCXJlZyA9IGludGVsX3FlcF9yZWFkbChxZXAsIElOVEVMX1FFUENP
Tik7Cj4gIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7Cj4gLQlyZXR1cm4gc3lzZnNfZW1pdChi
dWYsICIldVxuIiwgIShyZWcgJiBJTlRFTF9RRVBDT05fQ09VTlRfUlNUX01PREUpKTsKPiArCj4g
KwkqcHJlc2V0X2VuYWJsZSA9ICEocmVnICYgSU5URUxfUUVQQ09OX0NPVU5UX1JTVF9NT0RFKTsK
PiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJs
ZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICB2b2lkICpwcml2LCBjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQgaW50ZWxfcWVwX3ByZXNldF9lbmFibGVfd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCSBzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsIHU4IHZhbCkKPiAgewo+ICAJc3RydWN0IGludGVsX3FlcCAqcWVwID0g
Y291bnRlci0+cHJpdjsKPiAgCXUzMiByZWc7Cj4gLQlib29sIHZhbDsKPiAtCWludCByZXQ7Cj4g
LQo+IC0JcmV0ID0ga3N0cnRvYm9vbChidWYsICZ2YWwpOwo+IC0JaWYgKHJldCkKPiAtCQlyZXR1
cm4gcmV0Owo+ICsJaW50IHJldCA9IDA7Cj4gIAo+ICAJbXV0ZXhfbG9jaygmcWVwLT5sb2NrKTsK
PiAgCWlmIChxZXAtPmVuYWJsZWQpIHsKPiBAQCAtMzg0LDcgKzM2MCw2IEBAIHN0YXRpYyBzc2l6
ZV90IHByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICAKPiAgCWludGVsX3FlcF93cml0ZWwocWVwLCBJTlRFTF9RRVBDT04sIHJlZyk7Cj4gIAlwbV9y
dW50aW1lX3B1dChxZXAtPmRldik7Cj4gLQlyZXQgPSBsZW47Cj4gIAo+ICBvdXQ6Cj4gIAltdXRl
eF91bmxvY2soJnFlcC0+bG9jayk7Cj4gQEAgLTM5MiwxMSArMzY3LDE0IEBAIHN0YXRpYyBzc2l6
ZV90IHByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICAJcmV0dXJuIHJldDsKPiAgfQo+ICAKPiAtc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX2Nv
dW50X2V4dCBpbnRlbF9xZXBfY291bnRfZXh0W10gPSB7Cj4gLQlJTlRFTF9RRVBfQ09VTlRFUl9F
WFRfUlcoY2VpbGluZyksCj4gLQlJTlRFTF9RRVBfQ09VTlRFUl9FWFRfUlcoZW5hYmxlKSwKPiAt
CUlOVEVMX1FFUF9DT1VOVEVSX0VYVF9SVyhzcGlrZV9maWx0ZXJfbnMpLAo+IC0JSU5URUxfUUVQ
X0NPVU5URVJfRVhUX1JXKHByZXNldF9lbmFibGUpCj4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9j
b21wIGludGVsX3FlcF9jb3VudF9leHRbXSA9IHsKPiArCUNPVU5URVJfQ09NUF9FTkFCTEUoaW50
ZWxfcWVwX2VuYWJsZV9yZWFkLCBpbnRlbF9xZXBfZW5hYmxlX3dyaXRlKSwKPiArCUNPVU5URVJf
Q09NUF9DRUlMSU5HKGludGVsX3FlcF9jZWlsaW5nX3JlYWQsIGludGVsX3FlcF9jZWlsaW5nX3dy
aXRlKSwKPiArCUNPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKGludGVsX3FlcF9wcmVzZXRfZW5h
YmxlX3JlYWQsCj4gKwkJCQkgICBpbnRlbF9xZXBfcHJlc2V0X2VuYWJsZV93cml0ZSksCj4gKwlD
T1VOVEVSX0NPTVBfQ09VTlRfVTY0KCJzcGlrZV9maWx0ZXJfbnMiLAo+ICsJCQkgICAgICAgaW50
ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc19yZWFkLAo+ICsJCQkgICAgICAgaW50ZWxfcWVwX3NwaWtl
X2ZpbHRlcl9uc193cml0ZSksCj4gIH07Cj4gIAo+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfY291
bnQgaW50ZWxfcWVwX2NvdW50ZXJfY291bnRbXSA9IHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9j
b3VudGVyL2ludGVycnVwdC1jbnQuYyBiL2RyaXZlcnMvY291bnRlci9pbnRlcnJ1cHQtY250LmMK
PiBpbmRleCAxZGU0MjQzZGI0ODguLjg1MTRhODdmY2JlZSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L2NvdW50ZXIvaW50ZXJydXB0LWNudC5jCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL2ludGVycnVw
dC1jbnQuYwo+IEBAIC0xMCw2ICsxMCw3IEBACj4gICNpbmNsdWRlIDxsaW51eC9tb2RfZGV2aWNl
dGFibGUuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5oPgo+ICAjaW5jbHVkZSA8bGludXgv
cGxhdGZvcm1fZGV2aWNlLmg+Cj4gKyNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgo+ICAKPiAgI2Rl
ZmluZSBJTlRFUlJVUFRfQ05UX05BTUUgImludGVycnVwdC1jbnQiCj4gIAo+IEBAIC0zMywzMCAr
MzQsMjMgQEAgc3RhdGljIGlycXJldHVybl90IGludGVycnVwdF9jbnRfaXNyKGludCBpcnEsIHZv
aWQgKmRldl9pZCkKPiAgCXJldHVybiBJUlFfSEFORExFRDsKPiAgfQo+ICAKPiAtc3RhdGljIHNz
aXplX3QgaW50ZXJydXB0X2NudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gLQkJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCQkgdm9p
ZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IGludGVycnVwdF9jbnRfZW5hYmxl
X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsIHU4ICplbmFibGUpCj4gIHsKPiAgCXN0cnVjdCBpbnRlcnJ1
cHRfY250X3ByaXYgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAKPiAtCXJldHVybiBzeXNmc19l
bWl0KGJ1ZiwgIiVkXG4iLCBwcml2LT5lbmFibGVkKTsKPiArCSplbmFibGUgPSBwcml2LT5lbmFi
bGVkOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBpbnRlcnJ1
cHRfY250X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJ
CQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkJICB2b2lkICpwcml2YXRl
LCBjb25zdCBjaGFyICpidWYsCj4gLQkJCQkJICBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IGlu
dGVycnVwdF9jbnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggZW5hYmxlKQo+ICB7
Cj4gIAlzdHJ1Y3QgaW50ZXJydXB0X2NudF9wcml2ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiAt
CWJvb2wgZW5hYmxlOwo+IC0Jc3NpemVfdCByZXQ7Cj4gLQo+IC0JcmV0ID0ga3N0cnRvYm9vbChi
dWYsICZlbmFibGUpOwo+IC0JaWYgKHJldCkKPiAtCQlyZXR1cm4gcmV0Owo+ICAKPiAgCWlmIChw
cml2LT5lbmFibGVkID09IGVuYWJsZSkKPiAtCQlyZXR1cm4gbGVuOwo+ICsJCXJldHVybiAwOwo+
ICAKPiAgCWlmIChlbmFibGUpIHsKPiAgCQlwcml2LT5lbmFibGVkID0gdHJ1ZTsKPiBAQCAtNjYs
MzMgKzYwLDMwIEBAIHN0YXRpYyBzc2l6ZV90IGludGVycnVwdF9jbnRfZW5hYmxlX3dyaXRlKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCQlwcml2LT5lbmFibGVkID0gZmFsc2U7
Cj4gIAl9Cj4gIAo+IC0JcmV0dXJuIGxlbjsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0
aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0IGludGVycnVwdF9jbnRfZXh0W10gPSB7
Cj4gLQl7Cj4gLQkJLm5hbWUgPSAiZW5hYmxlIiwKPiAtCQkucmVhZCA9IGludGVycnVwdF9jbnRf
ZW5hYmxlX3JlYWQsCj4gLQkJLndyaXRlID0gaW50ZXJydXB0X2NudF9lbmFibGVfd3JpdGUsCj4g
LQl9LAo+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBpbnRlcnJ1cHRfY250X2V4dFtdID0g
ewo+ICsJQ09VTlRFUl9DT01QX0VOQUJMRShpbnRlcnJ1cHRfY250X2VuYWJsZV9yZWFkLAo+ICsJ
CQkgICAgaW50ZXJydXB0X2NudF9lbmFibGVfd3JpdGUpLAo+ICB9Owo+ICAKPiAgc3RhdGljIGNv
bnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBpbnRlcnJ1cHRfY250X3N5bmFwc2VfYWN0
aW9uc1tdID0gewo+ICAJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiAgfTsK
PiAgCj4gLXN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAtCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
Cj4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtCQkJCSAgICBz
aXplX3QgKmFjdGlvbikKPiArc3RhdGljIGludCBpbnRlcnJ1cHRfY250X2FjdGlvbl9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAo+ICsJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNl
LAo+ICsJCQkJICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+
IC0JKmFjdGlvbiA9IDA7Cj4gKwkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJ
TkdfRURHRTsKPiAgCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAgc3RhdGljIGludCBpbnRlcnJ1
cHRfY250X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkgICAgICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHVuc2lnbmVkIGxvbmcgKnZhbCkKPiArCQkJICAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKPiAgewo+ICAJc3RydWN0
IGludGVycnVwdF9jbnRfcHJpdiAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAo+IEBAIC0xMDIs
OCArOTMsNyBAQCBzdGF0aWMgaW50IGludGVycnVwdF9jbnRfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF93cml0
ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCSAgICAgICBjb25zdCB1bnNpZ25lZCBsb25nIHZhbCkK
PiArCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgY29uc3QgdTY0IHZhbCkK
PiAgewo+ICAJc3RydWN0IGludGVycnVwdF9jbnRfcHJpdiAqcHJpdiA9IGNvdW50ZXItPnByaXY7
Cj4gIAo+IEBAIC0xMTksMTEgKzEwOSwxMSBAQCBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1
bmN0aW9uIGludGVycnVwdF9jbnRfZnVuY3Rpb25zW10gPSB7Cj4gIAlDT1VOVEVSX0ZVTkNUSU9O
X0lOQ1JFQVNFLAo+ICB9Owo+ICAKPiAtc3RhdGljIGludCBpbnRlcnJ1cHRfY250X2Z1bmN0aW9u
X2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICAgICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgICBzaXplX3QgKmZ1bmN0aW9uKQo+ICtz
dGF0aWMgaW50IGludGVycnVwdF9jbnRfZnVuY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+
ICsJCQkJICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb24pCj4gIHsKPiAtCSpm
dW5jdGlvbiA9IDA7Cj4gKwkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOwo+
ICAKPiAgCXJldHVybiAwOwo+ICB9Cj4gQEAgLTE0OCwxMCArMTM4LDEwIEBAIHN0YXRpYyBpbnQg
aW50ZXJydXB0X2NudF9zaWduYWxfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gIH0KPiAgCj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgaW50ZXJydXB0X2Nu
dF9vcHMgPSB7Cj4gLQkuYWN0aW9uX2dldCA9IGludGVycnVwdF9jbnRfYWN0aW9uX2dldCwKPiAr
CS5hY3Rpb25fcmVhZCA9IGludGVycnVwdF9jbnRfYWN0aW9uX3JlYWQsCj4gIAkuY291bnRfcmVh
ZCA9IGludGVycnVwdF9jbnRfcmVhZCwKPiAgCS5jb3VudF93cml0ZSA9IGludGVycnVwdF9jbnRf
d3JpdGUsCj4gLQkuZnVuY3Rpb25fZ2V0ID0gaW50ZXJydXB0X2NudF9mdW5jdGlvbl9nZXQsCj4g
KwkuZnVuY3Rpb25fcmVhZCA9IGludGVycnVwdF9jbnRfZnVuY3Rpb25fcmVhZCwKPiAgCS5zaWdu
YWxfcmVhZCAgPSBpbnRlcnJ1cHRfY250X3NpZ25hbF9yZWFkLAo+ICB9Owo+ICAKPiBkaWZmIC0t
Z2l0IGEvZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2FwdHVyZS5jIGIvZHJpdmVycy9j
b3VudGVyL21pY3JvY2hpcC10Y2ItY2FwdHVyZS5jCj4gaW5kZXggMWFhNzBiOWM0ODMzLi43OWUw
Yzg0YTNiODEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2Fw
dHVyZS5jCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2ItY2FwdHVyZS5jCj4g
QEAgLTMyLDI4ICszMiwxNiBAQCBzdHJ1Y3QgbWNocF90Y19kYXRhIHsKPiAgCWJvb2wgdHJpZ19p
bnZlcnRlZDsKPiAgfTsKPiAgCj4gLWVudW0gbWNocF90Y19jb3VudF9mdW5jdGlvbiB7Cj4gLQlN
Q0hQX1RDX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0JTUNIUF9UQ19GVU5DVElPTl9RVUFEUkFUVVJF
LAo+IC19Owo+IC0KPiAgc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiBtY2hwX3Rj
X2NvdW50X2Z1bmN0aW9uc1tdID0gewo+IC0JW01DSFBfVENfRlVOQ1RJT05fSU5DUkVBU0VdID0g
Q09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKPiAtCVtNQ0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRV
UkVdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0LAo+IC19Owo+IC0KPiAtZW51bSBt
Y2hwX3RjX3N5bmFwc2VfYWN0aW9uIHsKPiAtCU1DSFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORSA9
IDAsCj4gLQlNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAo+IC0JTUNIUF9UQ19T
WU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCj4gLQlNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRQo+ICsJQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKPiArCUNPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YNCwKPiAgfTsKPiAgCj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJf
c3luYXBzZV9hY3Rpb24gbWNocF90Y19zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAtCVtNQ0hQX1RD
X1NZTkFQU0VfQUNUSU9OX05PTkVdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+IC0J
W01DSFBfVENfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0VdID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9SSVNJTkdfRURHRSwKPiAtCVtNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURH
RV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiAtCVtNQ0hQX1RDX1NZ
TkFQU0VfQUNUSU9OX0JPVEhfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVMsCj4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gKwlDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX1JJU0lOR19FREdFLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VE
R0UsCj4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCj4gIH07Cj4gIAo+ICBz
dGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIG1jaHBfdGNfY291bnRfc2lnbmFsc1tdID0gewo+
IEBAIC04MCwyMyArNjgsMjMgQEAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgbWNocF90
Y19jb3VudF9zeW5hcHNlc1tdID0gewo+ICAJfQo+ICB9Owo+ICAKPiAtc3RhdGljIGludCBtY2hw
X3RjX2NvdW50X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
LQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgICBzaXpl
X3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVu
Y3Rpb24pCj4gIHsKPiAgCXN0cnVjdCBtY2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3VudGVy
LT5wcml2Owo+ICAKPiAgCWlmIChwcml2LT5xZGVjX21vZGUpCj4gLQkJKmZ1bmN0aW9uID0gTUNI
UF9UQ19GVU5DVElPTl9RVUFEUkFUVVJFOwo+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YNDsKPiAgCWVsc2UKPiAtCQkqZnVuY3Rpb24gPSBNQ0hQX1RDX0ZVTkNU
SU9OX0lOQ1JFQVNFOwo+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0U7
Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgbWNocF90Y19jb3VudF9m
dW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJICAgICAgc2l6ZV90IGZ1bmN0aW9u
KQo+ICtzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiArCQkJCQllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb24pCj4gIHsKPiAgCXN0cnVjdCBt
Y2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIGJtciwgY21y
Owo+IEBAIC0xMDgsNyArOTYsNyBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25f
c2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCWNtciAmPSB+QVRNRUxfVENf
V0FWRTsKPiAgCj4gIAlzd2l0Y2ggKGZ1bmN0aW9uKSB7Cj4gLQljYXNlIE1DSFBfVENfRlVOQ1RJ
T05fSU5DUkVBU0U6Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0U6Cj4gIAkJcHJp
di0+cWRlY19tb2RlID0gMDsKPiAgCQkvKiBTZXQgaGlnaGVzdCByYXRlIGJhc2VkIG9uIHdoZXRo
ZXIgc29jIGhhcyBnY2xrIG9yIG5vdCAqLwo+ICAJCWJtciAmPSB+KEFUTUVMX1RDX1FERU4gfCBB
VE1FTF9UQ19QT1NFTik7Cj4gQEAgLTEyMCw3ICsxMDgsNyBAQCBzdGF0aWMgaW50IG1jaHBfdGNf
Y291bnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCQlj
bXIgfD0gIEFUTUVMX1RDX0NNUl9NQVNLOwo+ICAJCWNtciAmPSB+KEFUTUVMX1RDX0FCRVRSRyB8
IEFUTUVMX1RDX1hDMCk7Cj4gIAkJYnJlYWs7Cj4gLQljYXNlIE1DSFBfVENfRlVOQ1RJT05fUVVB
RFJBVFVSRToKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Ogo+ICAJCWlm
ICghcHJpdi0+dGNfY2ZnLT5oYXNfcWRlYykKPiAgCQkJcmV0dXJuIC1FSU5WQUw7Cj4gIAkJLyog
SW4gUURFQyBtb2RlIHNldHRpbmdzIGJvdGggY2hhbm5lbHMgMCBhbmQgMSBhcmUgcmVxdWlyZWQg
Ki8KPiBAQCAtMTc2LDEwICsxNjQsMTAgQEAgc3RhdGljIGludCBtY2hwX3RjX2NvdW50X3NpZ25h
bF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCXJldHVybiAwOwo+ICB9
Cj4gIAo+IC1zdGF0aWMgaW50IG1jaHBfdGNfY291bnRfYWN0aW9uX2dldChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+IC0JCQkJICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gLQkJCQkgICAg
c2l6ZV90ICphY3Rpb24pCj4gK3N0YXRpYyBpbnQgbWNocF90Y19jb3VudF9hY3Rpb25fcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiArCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBz
ZSwKPiArCQkJCSAgICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb24pCj4gIHsK
PiAgCXN0cnVjdCBtY2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJ
dTMyIGNtcjsKPiBAQCAtMTg4LDI2ICsxNzYsMjYgQEAgc3RhdGljIGludCBtY2hwX3RjX2NvdW50
X2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAKPiAgCXN3aXRj
aCAoY21yICYgQVRNRUxfVENfRVRSR0VERykgewo+ICAJZGVmYXVsdDoKPiAtCQkqYWN0aW9uID0g
TUNIUF9UQ19TWU5BUFNFX0FDVElPTl9OT05FOwo+ICsJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX05PTkU7Cj4gIAkJYnJlYWs7Cj4gIAljYXNlIEFUTUVMX1RDX0VUUkdFREdfUklT
SU5HOgo+IC0JCSphY3Rpb24gPSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+
ICsJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ICAJCWJy
ZWFrOwo+ICAJY2FzZSBBVE1FTF9UQ19FVFJHRURHX0ZBTExJTkc6Cj4gLQkJKmFjdGlvbiA9IE1D
SFBfVENfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOwo+ICsJCSphY3Rpb24gPSBDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRTsKPiAgCQlicmVhazsKPiAgCWNhc2UgQVRNRUxf
VENfRVRSR0VER19CT1RIOgo+IC0JCSphY3Rpb24gPSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRTsKPiArCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VT
Owo+ICAJCWJyZWFrOwo+ICAJfQo+ICAKPiAgCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMg
aW50IG1jaHBfdGNfY291bnRfYWN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJICAgIHN0
cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gLQkJCQkgICAgc2l6ZV90IGFjdGlvbikK
PiArc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2FjdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
Cj4gKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ICsJCQkJICAg
ICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlvbikKPiAgewo+ICAJc3RydWN0IG1j
aHBfdGNfZGF0YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgZWRnZSA9IEFU
TUVMX1RDX0VUUkdFREdfTk9ORTsKPiBAQCAtMjE3LDE2ICsyMDUsMTYgQEAgc3RhdGljIGludCBt
Y2hwX3RjX2NvdW50X2FjdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICAJCXJldHVybiAtRUlOVkFMOwo+ICAKPiAgCXN3aXRjaCAoYWN0aW9uKSB7Cj4gLQljYXNlIE1D
SFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORToKPiArCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9OT05FOgo+ICAJCWVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX05PTkU7Cj4gIAkJYnJlYWs7Cj4g
LQljYXNlIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U6Cj4gKwljYXNlIENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U6Cj4gIAkJZWRnZSA9IEFUTUVMX1RDX0VUUkdF
REdfUklTSU5HOwo+ICAJCWJyZWFrOwo+IC0JY2FzZSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX0ZB
TExJTkdfRURHRToKPiArCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0U6
Cj4gIAkJZWRnZSA9IEFUTUVMX1RDX0VUUkdFREdfRkFMTElORzsKPiAgCQlicmVhazsKPiAtCWNh
c2UgTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9CT1RIX0VER0U6Cj4gKwljYXNlIENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fQk9USF9FREdFUzoKPiAgCQllZGdlID0gQVRNRUxfVENfRVRSR0VER19CT1RI
Owo+ICAJCWJyZWFrOwo+ICAJZGVmYXVsdDoKPiBAQCAtMjQwLDggKzIyOCw3IEBAIHN0YXRpYyBp
bnQgbWNocF90Y19jb3VudF9hY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAgfQo+ICAKPiAgc3RhdGljIGludCBtY2hwX3RjX2NvdW50X3JlYWQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gLQkJCSAgICAgIHVuc2lnbmVkIGxvbmcgKnZhbCkKPiArCQkJICAgICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKPiAgewo+ICAJc3RydWN0IG1jaHBfdGNfZGF0
YSAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgY250Owo+IEBAIC0yNjQsMTIg
KzI1MSwxMiBAQCBzdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnQgbWNocF90Y19jb3VudHNbXSA9
IHsKPiAgfTsKPiAgCj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgbWNocF90Y19v
cHMgPSB7Cj4gLQkuc2lnbmFsX3JlYWQgID0gbWNocF90Y19jb3VudF9zaWduYWxfcmVhZCwKPiAt
CS5jb3VudF9yZWFkICAgPSBtY2hwX3RjX2NvdW50X3JlYWQsCj4gLQkuZnVuY3Rpb25fZ2V0ID0g
bWNocF90Y19jb3VudF9mdW5jdGlvbl9nZXQsCj4gLQkuZnVuY3Rpb25fc2V0ID0gbWNocF90Y19j
b3VudF9mdW5jdGlvbl9zZXQsCj4gLQkuYWN0aW9uX2dldCAgID0gbWNocF90Y19jb3VudF9hY3Rp
b25fZ2V0LAo+IC0JLmFjdGlvbl9zZXQgICA9IG1jaHBfdGNfY291bnRfYWN0aW9uX3NldAo+ICsJ
LnNpZ25hbF9yZWFkICAgID0gbWNocF90Y19jb3VudF9zaWduYWxfcmVhZCwKPiArCS5jb3VudF9y
ZWFkICAgICA9IG1jaHBfdGNfY291bnRfcmVhZCwKPiArCS5mdW5jdGlvbl9yZWFkICA9IG1jaHBf
dGNfY291bnRfZnVuY3Rpb25fcmVhZCwKPiArCS5mdW5jdGlvbl93cml0ZSA9IG1jaHBfdGNfY291
bnRfZnVuY3Rpb25fd3JpdGUsCj4gKwkuYWN0aW9uX3JlYWQgICAgPSBtY2hwX3RjX2NvdW50X2Fj
dGlvbl9yZWFkLAo+ICsJLmFjdGlvbl93cml0ZSAgID0gbWNocF90Y19jb3VudF9hY3Rpb25fd3Jp
dGUKPiAgfTsKPiAgCj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYXRtZWxfdGNiX2NvbmZpZyB0Y2Jf
cm05MjAwX2NvbmZpZyA9IHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxw
dGltZXItY250LmMgYi9kcml2ZXJzL2NvdW50ZXIvc3RtMzItbHB0aW1lci1jbnQuYwo+IGluZGV4
IDczNjdmNDZjNmY5MS4uNTE2ODgzM2IxZmRmIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvY291bnRl
ci9zdG0zMi1scHRpbWVyLWNudC5jCj4gKysrIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGlt
ZXItY250LmMKPiBAQCAtMTcsNiArMTcsNyBAQAo+ICAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+
Cj4gICNpbmNsdWRlIDxsaW51eC9waW5jdHJsL2NvbnN1bWVyLmg+Cj4gICNpbmNsdWRlIDxsaW51
eC9wbGF0Zm9ybV9kZXZpY2UuaD4KPiArI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4gIAo+ICBz
dHJ1Y3Qgc3RtMzJfbHB0aW1fY250IHsKPiAgCXN0cnVjdCBjb3VudGVyX2RldmljZSBjb3VudGVy
Owo+IEBAIC0xMDcsMTEgKzEwOCw3IEBAIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fc2V0dXAoc3Ry
dWN0IHN0bTMyX2xwdGltX2NudCAqcHJpdiwgaW50IGVuYWJsZSkKPiAgCXJldHVybiByZWdtYXBf
dXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBTVE0zMl9MUFRJTV9DRkdSLCBtYXNrLCB2YWwpOwo+
ICB9Cj4gIAo+IC0vKioKPiAtICogZW51bSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb24gLSBlbnVt
ZXJhdGVzIExQVGltZXIgY291bnRlciAmIGVuY29kZXIgbW9kZXMKPiAtICogQFNUTTMyX0xQVElN
X0NPVU5URVJfSU5DUkVBU0U6IHVwIGNvdW50IG9uIElOMSByaXNpbmcsIGZhbGxpbmcgb3IgYm90
aCBlZGdlcwo+IC0gKiBAU1RNMzJfTFBUSU1fRU5DT0RFUl9CT1RIX0VER0U6IGNvdW50IG9uIGJv
dGggZWRnZXMgKElOMSAmIElOMiBxdWFkcmF0dXJlKQo+IC0gKgo+ICsvKgo+ICAgKiBJbiBub24t
cXVhZHJhdHVyZSBtb2RlLCBkZXZpY2UgY291bnRzIHVwIG9uIGFjdGl2ZSBlZGdlLgo+ICAgKiBJ
biBxdWFkcmF0dXJlIG1vZGUsIGVuY29kZXIgY291bnRpbmcgc2NlbmFyaW9zIGFyZSBhcyBmb2xs
b3dzOgo+ICAgKiArLS0tLS0tLS0tKy0tLS0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0t
LS0tLS0tLS0tLS0tLS0tLS0rCj4gQEAgLTEyOSwzMyArMTI2LDIwIEBAIHN0YXRpYyBpbnQgc3Rt
MzJfbHB0aW1fc2V0dXAoc3RydWN0IHN0bTMyX2xwdGltX2NudCAqcHJpdiwgaW50IGVuYWJsZSkK
PiAgICogfCBlZGdlcyAgIHwgTG93ICAtPiAgfCAgIFVwICAgICB8ICAgRG93biAgfCAgIERvd24g
ICB8ICAgVXAgICAgfAo+ICAgKiArLS0tLS0tLS0tKy0tLS0tLS0tLS0rLS0tLS0tLS0tLSstLS0t
LS0tLS0rLS0tLS0tLS0tLSstLS0tLS0tLS0rCj4gICAqLwo+IC1lbnVtIHN0bTMyX2xwdGltX2Nu
dF9mdW5jdGlvbiB7Cj4gLQlTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNFLAo+IC0JU1RNMzJf
TFBUSU1fRU5DT0RFUl9CT1RIX0VER0UsCj4gLX07Cj4gLQo+ICBzdGF0aWMgY29uc3QgZW51bSBj
b3VudGVyX2Z1bmN0aW9uIHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbnNbXSA9IHsKPiAtCVtTVE0z
Ml9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNFXSA9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCj4g
LQlbU1RNMzJfTFBUSU1fRU5DT0RFUl9CT1RIX0VER0VdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0LAo+IC19Owo+IC0KPiAtZW51bSBzdG0zMl9scHRpbV9zeW5hcHNlX2FjdGlvbiB7
Cj4gLQlTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSA9IFNUTTMyX0xQVElN
X0NLUE9MX1JJU0lOR19FREdFLAo+IC0JU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fRkFMTElO
R19FREdFID0gU1RNMzJfTFBUSU1fQ0tQT0xfRkFMTElOR19FREdFLAo+IC0JU1RNMzJfTFBUSU1f
U1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUyA9IFNUTTMyX0xQVElNX0NLUE9MX0JPVEhfRURHRVMs
Cj4gLQlTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9OT05FLAo+ICsJQ09VTlRFUl9GVU5DVElP
Tl9JTkNSRUFTRSwKPiArCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKPiAgfTsKPiAg
Cj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gc3RtMzJfbHB0aW1f
Y250X3N5bmFwc2VfYWN0aW9uc1tdID0gewo+IC0JLyogSW5kZXggbXVzdCBtYXRjaCB3aXRoIHN0
bTMyX2xwdGltX2NudF9wb2xhcml0eVtdIChwcml2LT5wb2xhcml0eSkgKi8KPiAtCVtTVE0zMl9M
UFRJTV9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X1JJU0lOR19FREdFLAo+IC0JW1NUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURH
RV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiAtCVtTVE0zMl9MUFRJ
TV9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTXSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9U
SF9FREdFUywKPiAtCVtTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9OT05FXSA9IENPVU5URVJf
U1lOQVBTRV9BQ1RJT05fTk9ORSwKPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VE
R0UsCj4gKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiArCUNPVU5URVJf
U1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9O
RSwKPiAgfTsKPiAgCj4gIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1bnNpZ25lZCBsb25nICp2YWwpCj4gKwkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
IHU2NCAqdmFsKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0g
Y291bnRlci0+cHJpdjsKPiAgCXUzMiBjbnQ7Cj4gQEAgLTE3MCwyOCArMTU0LDI4IEBAIHN0YXRp
YyBpbnQgc3RtMzJfbHB0aW1fY250X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2Z1
bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCXNpemVfdCAqZnVuY3Rpb24pCj4gK3N0YXRp
YyBpbnQgc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAo+ICsJCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJ
IGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb24pCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl9s
cHRpbV9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAKPiAgCWlmICghcHJpdi0+
cXVhZHJhdHVyZV9tb2RlKSB7Cj4gLQkJKmZ1bmN0aW9uID0gU1RNMzJfTFBUSU1fQ09VTlRFUl9J
TkNSRUFTRTsKPiArCQkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOwo+ICAJ
CXJldHVybiAwOwo+ICAJfQo+ICAKPiAtCWlmIChwcml2LT5wb2xhcml0eSA9PSBTVE0zMl9MUFRJ
TV9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTKSB7Cj4gLQkJKmZ1bmN0aW9uID0gU1RNMzJfTFBU
SU1fRU5DT0RFUl9CT1RIX0VER0U7Cj4gKwlpZiAocHJpdi0+cG9sYXJpdHkgPT0gU1RNMzJfTFBU
SU1fQ0tQT0xfQk9USF9FREdFUykgewo+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YNDsKPiAgCQlyZXR1cm4gMDsKPiAgCX0KPiAgCj4gIAlyZXR1cm4gLUVJTlZB
TDsKPiAgfQo+ICAKPiAtc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gLQkJCQkJc2l6ZV90IGZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IHN0bTMyX2xw
dGltX2NudF9mdW5jdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4g
KwkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJICBlbnVtIGNvdW50
ZXJfZnVuY3Rpb24gZnVuY3Rpb24pCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNv
bnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAKPiBAQCAtMTk5LDEyICsxODMsMTIgQEAgc3Rh
dGljIGludCBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiAgCQlyZXR1cm4gLUVCVVNZOwo+ICAKPiAgCXN3aXRjaCAoZnVuY3Rpb24p
IHsKPiAtCWNhc2UgU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRToKPiArCWNhc2UgQ09VTlRF
Ul9GVU5DVElPTl9JTkNSRUFTRToKPiAgCQlwcml2LT5xdWFkcmF0dXJlX21vZGUgPSAwOwo+ICAJ
CXJldHVybiAwOwo+IC0JY2FzZSBTVE0zMl9MUFRJTV9FTkNPREVSX0JPVEhfRURHRToKPiArCWNh
c2UgQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0Ogo+ICAJCXByaXYtPnF1YWRyYXR1cmVf
bW9kZSA9IDE7Cj4gLQkJcHJpdi0+cG9sYXJpdHkgPSBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElP
Tl9CT1RIX0VER0VTOwo+ICsJCXByaXYtPnBvbGFyaXR5ID0gU1RNMzJfTFBUSU1fQ0tQT0xfQk9U
SF9FREdFUzsKPiAgCQlyZXR1cm4gMDsKPiAgCWRlZmF1bHQ6Cj4gIAkJLyogc2hvdWxkIG5ldmVy
IHJlYWNoIHRoaXMgcGF0aCAqLwo+IEBAIC0yMTIsOSArMTk2LDkgQEAgc3RhdGljIGludCBzdG0z
Ml9scHRpbV9jbnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAgCX0KPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3Qgc3RtMzJfbHB0aW1fY250X2VuYWJsZV9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCQkgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkJICAgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+
ICtzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+ICsJCQkJICAgICAgIHU4ICplbmFibGUpCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl9scHRpbV9j
bnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJaW50IHJldDsKPiBAQCAtMjIzLDIy
ICsyMDcsMTggQEAgc3RhdGljIHNzaXplX3Qgc3RtMzJfbHB0aW1fY250X2VuYWJsZV9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCWlmIChyZXQgPCAwKQo+ICAJCXJldHVy
biByZXQ7Cj4gIAo+IC0JcmV0dXJuIHNjbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiV1XG4iLCBy
ZXQpOwo+ICsJKmVuYWJsZSA9IHJldDsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3Rh
dGljIHNzaXplX3Qgc3RtMzJfbHB0aW1fY250X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
PiAtCQkJCQkgICAgdm9pZCAqcHJpdmF0ZSwKPiAtCQkJCQkgICAgY29uc3QgY2hhciAqYnVmLCBz
aXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwKPiArCQkJCQl1OCBlbmFibGUpCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl9scHRpbV9j
bnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+IC0JYm9vbCBlbmFibGU7Cj4gIAlpbnQg
cmV0Owo+ICAKPiAtCXJldCA9IGtzdHJ0b2Jvb2woYnVmLCAmZW5hYmxlKTsKPiAtCWlmIChyZXQp
Cj4gLQkJcmV0dXJuIHJldDsKPiAtCj4gIAkvKiBDaGVjayBub2JvZHkgdXNlcyB0aGUgdGltZXIs
IG9yIGFscmVhZHkgZGlzYWJsZWQvZW5hYmxlZCAqLwo+ICAJcmV0ID0gc3RtMzJfbHB0aW1faXNf
ZW5hYmxlZChwcml2KTsKPiAgCWlmICgocmV0IDwgMCkgfHwgKCFyZXQgJiYgIWVuYWJsZSkpCj4g
QEAgLTI1NCw3OCArMjM0LDgxIEBAIHN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9lbmFi
bGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICAJaWYgKHJldCkKPiAg
CQlyZXR1cm4gcmV0Owo+ICAKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAK
PiAtc3RhdGljIHNzaXplX3Qgc3RtMzJfbHB0aW1fY250X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpj
b3VudCwKPiAtCQkJCQkgICAgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50
IHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAo+ICsJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQl1NjQgKmNl
aWxpbmcpCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHByaXYgPSBjb3Vu
dGVyLT5wcml2Owo+ICAKPiAtCXJldHVybiBzbnByaW50ZihidWYsIFBBR0VfU0laRSwgIiV1XG4i
LCBwcml2LT5jZWlsaW5nKTsKPiArCSpjZWlsaW5nID0gcHJpdi0+Y2VpbGluZzsKPiArCj4gKwly
ZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3Qgc3RtMzJfbHB0aW1fY250X2NlaWxp
bmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCSAgICAgdm9pZCAqcHJpdmF0ZSwKPiAt
CQkJCQkgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKPiArc3RhdGljIGludCBzdG0z
Ml9scHRpbV9jbnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gKwkJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCQkgdTY0IGNlaWxp
bmcpCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVy
LT5wcml2Owo+IC0JdW5zaWduZWQgaW50IGNlaWxpbmc7Cj4gLQlpbnQgcmV0Owo+ICAKPiAgCWlm
IChzdG0zMl9scHRpbV9pc19lbmFibGVkKHByaXYpKQo+ICAJCXJldHVybiAtRUJVU1k7Cj4gIAo+
IC0JcmV0ID0ga3N0cnRvdWludChidWYsIDAsICZjZWlsaW5nKTsKPiAtCWlmIChyZXQpCj4gLQkJ
cmV0dXJuIHJldDsKPiAtCj4gIAlpZiAoY2VpbGluZyA+IFNUTTMyX0xQVElNX01BWF9BUlIpCj4g
IAkJcmV0dXJuIC1FUkFOR0U7Cj4gIAo+ICAJcHJpdi0+Y2VpbGluZyA9IGNlaWxpbmc7Cj4gIAo+
IC0JcmV0dXJuIGxlbjsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfY291bnRfZXh0IHN0bTMyX2xwdGltX2NudF9leHRbXSA9IHsKPiAtCXsKPiAt
CQkubmFtZSA9ICJlbmFibGUiLAo+IC0JCS5yZWFkID0gc3RtMzJfbHB0aW1fY250X2VuYWJsZV9y
ZWFkLAo+IC0JCS53cml0ZSA9IHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUKPiAtCX0sCj4g
LQl7Cj4gLQkJLm5hbWUgPSAiY2VpbGluZyIsCj4gLQkJLnJlYWQgPSBzdG0zMl9scHRpbV9jbnRf
Y2VpbGluZ19yZWFkLAo+IC0JCS53cml0ZSA9IHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3dyaXRl
Cj4gLQl9LAo+ICtzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBzdG0zMl9scHRpbV9jbnRfZXh0
W10gPSB7Cj4gKwlDT1VOVEVSX0NPTVBfRU5BQkxFKHN0bTMyX2xwdGltX2NudF9lbmFibGVfcmVh
ZCwKPiArCQkJICAgIHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUpLAo+ICsJQ09VTlRFUl9D
T01QX0NFSUxJTkcoc3RtMzJfbHB0aW1fY250X2NlaWxpbmdfcmVhZCwKPiArCQkJICAgICBzdG0z
Ml9scHRpbV9jbnRfY2VpbGluZ193cml0ZSksCj4gIH07Cj4gIAo+IC1zdGF0aWMgaW50IHN0bTMy
X2xwdGltX2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAt
CQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAgICAgIHN0cnVj
dCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gLQkJCQkgICAgICBzaXplX3QgKmFjdGlvbikK
PiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwKPiArCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+ICsJCQkJ
ICAgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKQo+ICB7Cj4gIAlzdHJ1
Y3Qgc3RtMzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAtCXNpemVf
dCBmdW5jdGlvbjsKPiArCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiAgCWludCBl
cnI7Cj4gIAo+IC0JZXJyID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX2dldChjb3VudGVyLCBj
b3VudCwgJmZ1bmN0aW9uKTsKPiArCWVyciA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFk
KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICAJaWYgKGVycikKPiAgCQlyZXR1cm4gZXJy
Owo+ICAKPiAgCXN3aXRjaCAoZnVuY3Rpb24pIHsKPiAtCWNhc2UgU1RNMzJfTFBUSU1fQ09VTlRF
Ul9JTkNSRUFTRToKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKPiAgCQkvKiBM
UCBUaW1lciBhY3RzIGFzIHVwLWNvdW50ZXIgb24gaW5wdXQgMSAqLwo+IC0JCWlmIChzeW5hcHNl
LT5zaWduYWwtPmlkID09IGNvdW50LT5zeW5hcHNlc1swXS5zaWduYWwtPmlkKQo+IC0JCQkqYWN0
aW9uID0gcHJpdi0+cG9sYXJpdHk7Cj4gLQkJZWxzZQo+IC0JCQkqYWN0aW9uID0gU1RNMzJfTFBU
SU1fU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiAtCQlyZXR1cm4gMDsKPiAtCWNhc2UgU1RNMzJfTFBU
SU1fRU5DT0RFUl9CT1RIX0VER0U6Cj4gLQkJKmFjdGlvbiA9IHByaXYtPnBvbGFyaXR5Owo+ICsJ
CWlmIChzeW5hcHNlLT5zaWduYWwtPmlkICE9IGNvdW50LT5zeW5hcHNlc1swXS5zaWduYWwtPmlk
KSB7Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gKwkJCXJl
dHVybiAwOwo+ICsJCX0KPiArCj4gKwkJc3dpdGNoIChwcml2LT5wb2xhcml0eSkgewo+ICsJCWNh
c2UgU1RNMzJfTFBUSU1fQ0tQT0xfUklTSU5HX0VER0U6Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ICsJCQlyZXR1cm4gMDsKPiArCQljYXNlIFNU
TTMyX0xQVElNX0NLUE9MX0ZBTExJTkdfRURHRToKPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fRkFMTElOR19FREdFOwo+ICsJCQlyZXR1cm4gMDsKPiArCQljYXNlIFNUTTMy
X0xQVElNX0NLUE9MX0JPVEhfRURHRVM6Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX0JPVEhfRURHRVM7Cj4gKwkJCXJldHVybiAwOwo+ICsJCWRlZmF1bHQ6Cj4gKwkJCS8q
IHNob3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGggKi8KPiArCQkJcmV0dXJuIC1FSU5WQUw7Cj4g
KwkJfQo+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gKwkJKmFjdGlv
biA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKPiAgCQlyZXR1cm4gMDsKPiAg
CWRlZmF1bHQ6Cj4gIAkJLyogc2hvdWxkIG5ldmVyIHJlYWNoIHRoaXMgcGF0aCAqLwo+IEBAIC0z
MzMsNDMgKzMxNiw0OCBAQCBzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fZ2V0KHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCX0KPiAgfQo+ICAKPiAtc3RhdGljIGlu
dCBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAg
ICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAo+IC0JCQkJICAgICAgc2l6ZV90IGFj
dGlvbikKPiArc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfYWN0aW9uX3dyaXRlKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gKwkJCQkJc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiArCQkJCQllbnVt
IGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfbHB0
aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAtCXNpemVfdCBmdW5jdGlvbjsK
PiArCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiAgCWludCBlcnI7Cj4gIAo+ICAJ
aWYgKHN0bTMyX2xwdGltX2lzX2VuYWJsZWQocHJpdikpCj4gIAkJcmV0dXJuIC1FQlVTWTsKPiAg
Cj4gLQllcnIgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAm
ZnVuY3Rpb24pOwo+ICsJZXJyID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3JlYWQoY291bnRl
ciwgY291bnQsICZmdW5jdGlvbik7Cj4gIAlpZiAoZXJyKQo+ICAJCXJldHVybiBlcnI7Cj4gIAo+
ICAJLyogb25seSBzZXQgcG9sYXJpdHkgd2hlbiBpbiBjb3VudGVyIG1vZGUgKG9uIGlucHV0IDEp
ICovCj4gLQlpZiAoZnVuY3Rpb24gPT0gU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRQo+IC0J
ICAgICYmIHN5bmFwc2UtPnNpZ25hbC0+aWQgPT0gY291bnQtPnN5bmFwc2VzWzBdLnNpZ25hbC0+
aWQpIHsKPiAtCQlzd2l0Y2ggKGFjdGlvbikgewo+IC0JCWNhc2UgU1RNMzJfTFBUSU1fU1lOQVBT
RV9BQ1RJT05fUklTSU5HX0VER0U6Cj4gLQkJY2FzZSBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElP
Tl9GQUxMSU5HX0VER0U6Cj4gLQkJY2FzZSBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9CT1RI
X0VER0VTOgo+IC0JCQlwcml2LT5wb2xhcml0eSA9IGFjdGlvbjsKPiAtCQkJcmV0dXJuIDA7Cj4g
LQkJfQo+IC0JfQo+ICsJaWYgKGZ1bmN0aW9uICE9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UK
PiArCSAgICB8fCBzeW5hcHNlLT5zaWduYWwtPmlkICE9IGNvdW50LT5zeW5hcHNlc1swXS5zaWdu
YWwtPmlkKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICAKPiAtCXJldHVybiAtRUlOVkFMOwo+ICsJ
c3dpdGNoIChhY3Rpb24pIHsKPiArCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdf
RURHRToKPiArCQlwcml2LT5wb2xhcml0eSA9IFNUTTMyX0xQVElNX0NLUE9MX1JJU0lOR19FREdF
Owo+ICsJCXJldHVybiAwOwo+ICsJY2FzZSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdf
RURHRToKPiArCQlwcml2LT5wb2xhcml0eSA9IFNUTTMyX0xQVElNX0NLUE9MX0ZBTExJTkdfRURH
RTsKPiArCQlyZXR1cm4gMDsKPiArCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VE
R0VTOgo+ICsJCXByaXYtPnBvbGFyaXR5ID0gU1RNMzJfTFBUSU1fQ0tQT0xfQk9USF9FREdFUzsK
PiArCQlyZXR1cm4gMDsKPiArCWRlZmF1bHQ6Cj4gKwkJcmV0dXJuIC1FSU5WQUw7Cj4gKwl9Cj4g
IH0KPiAgCj4gIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgc3RtMzJfbHB0aW1fY250
X29wcyA9IHsKPiAgCS5jb3VudF9yZWFkID0gc3RtMzJfbHB0aW1fY250X3JlYWQsCj4gLQkuZnVu
Y3Rpb25fZ2V0ID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX2dldCwKPiAtCS5mdW5jdGlvbl9z
ZXQgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0LAo+IC0JLmFjdGlvbl9nZXQgPSBzdG0z
Ml9scHRpbV9jbnRfYWN0aW9uX2dldCwKPiAtCS5hY3Rpb25fc2V0ID0gc3RtMzJfbHB0aW1fY250
X2FjdGlvbl9zZXQsCj4gKwkuZnVuY3Rpb25fcmVhZCA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlv
bl9yZWFkLAo+ICsJLmZ1bmN0aW9uX3dyaXRlID0gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3dy
aXRlLAo+ICsJLmFjdGlvbl9yZWFkID0gc3RtMzJfbHB0aW1fY250X2FjdGlvbl9yZWFkLAo+ICsJ
LmFjdGlvbl93cml0ZSA9IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fd3JpdGUsCj4gIH07Cj4gIAo+
ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIHN0bTMyX2xwdGltX2NudF9zaWduYWxzW10g
PSB7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci9zdG0zMi10aW1lci1jbnQuYyBiL2Ry
aXZlcnMvY291bnRlci9zdG0zMi10aW1lci1jbnQuYwo+IGluZGV4IDFmYmM0NmY0ZWU2Ni4uMDU0
NmU5MzJkYjBjIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvY291bnRlci9zdG0zMi10aW1lci1jbnQu
Ywo+ICsrKyBiL2RyaXZlcnMvY291bnRlci9zdG0zMi10aW1lci1jbnQuYwo+IEBAIC0xMyw2ICsx
Myw3IEBACj4gICNpbmNsdWRlIDxsaW51eC9tb2R1bGUuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3Bp
bmN0cmwvY29uc3VtZXIuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5oPgo+
ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KPiAgCj4gICNkZWZpbmUgVElNX0NDTVJfQ0NYUwko
QklUKDgpIHwgQklUKDApKQo+ICAjZGVmaW5lIFRJTV9DQ01SX01BU0sJKFRJTV9DQ01SX0NDMVMg
fCBUSU1fQ0NNUl9DQzJTIHwgXAo+IEBAIC0zNiwyOSArMzcsMTUgQEAgc3RydWN0IHN0bTMyX3Rp
bWVyX2NudCB7Cj4gIAlzdHJ1Y3Qgc3RtMzJfdGltZXJfcmVncyBiYWs7Cj4gIH07Cj4gIAo+IC0v
KioKPiAtICogZW51bSBzdG0zMl9jb3VudF9mdW5jdGlvbiAtIGVudW1lcmF0ZXMgc3RtMzIgdGlt
ZXIgY291bnRlciBlbmNvZGVyIG1vZGVzCj4gLSAqIEBTVE0zMl9DT1VOVF9TTEFWRV9NT0RFX0RJ
U0FCTEVEOiBjb3VudHMgb24gaW50ZXJuYWwgY2xvY2sgd2hlbiBDRU49MQo+IC0gKiBAU1RNMzJf
Q09VTlRfRU5DT0RFUl9NT0RFXzE6IGNvdW50cyBUSTFGUDEgZWRnZXMsIGRlcGVuZGluZyBvbiBU
STJGUDIgbGV2ZWwKPiAtICogQFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yOiBjb3VudHMgVEky
RlAyIGVkZ2VzLCBkZXBlbmRpbmcgb24gVEkxRlAxIGxldmVsCj4gLSAqIEBTVE0zMl9DT1VOVF9F
TkNPREVSX01PREVfMzogY291bnRzIG9uIGJvdGggVEkxRlAxIGFuZCBUSTJGUDIgZWRnZXMKPiAt
ICovCj4gLWVudW0gc3RtMzJfY291bnRfZnVuY3Rpb24gewo+IC0JU1RNMzJfQ09VTlRfU0xBVkVf
TU9ERV9ESVNBQkxFRCwKPiAtCVNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8xLAo+IC0JU1RNMzJf
Q09VTlRfRU5DT0RFUl9NT0RFXzIsCj4gLQlTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMywKPiAt
fTsKPiAtCj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gc3RtMzJfY291bnRf
ZnVuY3Rpb25zW10gPSB7Cj4gLQlbU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxFRF0gPSBD
T1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+IC0JW1NUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8x
XSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BLAo+IC0JW1NUTTMyX0NPVU5UX0VO
Q09ERVJfTU9ERV8yXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9CLAo+IC0JW1NU
TTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
NCwKPiArCUNPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FV
QURSQVRVUkVfWDJfQSwKPiArCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9CLAo+ICsJ
Q09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0LAo+ICB9Owo+ICAKPiAgc3RhdGljIGludCBz
dG0zMl9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICAg
IHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyAqdmFsKQo+ICsJCQkg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKPiAgewo+ICAJc3RydWN0
IHN0bTMyX3RpbWVyX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgY250
Owo+IEBAIC03MCw4ICs1Nyw3IEBAIHN0YXRpYyBpbnQgc3RtMzJfY291bnRfcmVhZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0KPiAgCj4gIHN0YXRpYyBpbnQgc3RtMzJfY291
bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJICAgICBjb25zdCB1bnNpZ25lZCBsb25nIHZh
bCkKPiArCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIGNvbnN0IHU2NCB2YWwp
Cj4gIHsKPiAgCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5w
cml2Owo+ICAJdTMyIGNlaWxpbmc7Cj4gQEAgLTgzLDkgKzY5LDkgQEAgc3RhdGljIGludCBzdG0z
Ml9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1cm4g
cmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcCwgVElNX0NOVCwgdmFsKTsKPiAgfQo+ICAKPiAtc3Rh
dGljIGludCBzdG0zMl9jb3VudF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+IC0JCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCSAg
ICBzaXplX3QgKmZ1bmN0aW9uKQo+ICtzdGF0aWMgaW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3Jl
YWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVu
Y3Rpb24pCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3Vu
dGVyLT5wcml2Owo+ICAJdTMyIHNtY3I7Cj4gQEAgLTk0LDQwICs4MCw0MCBAQCBzdGF0aWMgaW50
IHN0bTMyX2NvdW50X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
Cj4gIAo+ICAJc3dpdGNoIChzbWNyICYgVElNX1NNQ1JfU01TKSB7Cj4gIAljYXNlIFRJTV9TTUNS
X1NNU19TTEFWRV9NT0RFX0RJU0FCTEVEOgo+IC0JCSpmdW5jdGlvbiA9IFNUTTMyX0NPVU5UX1NM
QVZFX01PREVfRElTQUJMRUQ7Cj4gKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9JTkNS
RUFTRTsKPiAgCQlyZXR1cm4gMDsKPiAgCWNhc2UgVElNX1NNQ1JfU01TX0VOQ09ERVJfTU9ERV8x
Ogo+IC0JCSpmdW5jdGlvbiA9IFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8xOwo+ICsJCSpmdW5j
dGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BOwo+ICAJCXJldHVybiAwOwo+
ICAJY2FzZSBUSU1fU01DUl9TTVNfRU5DT0RFUl9NT0RFXzI6Cj4gLQkJKmZ1bmN0aW9uID0gU1RN
MzJfQ09VTlRfRU5DT0RFUl9NT0RFXzI7Cj4gKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElP
Tl9RVUFEUkFUVVJFX1gyX0I7Cj4gIAkJcmV0dXJuIDA7Cj4gIAljYXNlIFRJTV9TTUNSX1NNU19F
TkNPREVSX01PREVfMzoKPiAtCQkqZnVuY3Rpb24gPSBTVE0zMl9DT1VOVF9FTkNPREVSX01PREVf
MzsKPiArCQkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ7Cj4gIAkJ
cmV0dXJuIDA7Cj4gIAlkZWZhdWx0Ogo+ICAJCXJldHVybiAtRUlOVkFMOwo+ICAJfQo+ICB9Cj4g
IAo+IC1zdGF0aWMgaW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+
IC0JCQkJICAgIHNpemVfdCBmdW5jdGlvbikKPiArc3RhdGljIGludCBzdG0zMl9jb3VudF9mdW5j
dGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkgICAgICBlbnVtIGNvdW50ZXJfZnVu
Y3Rpb24gZnVuY3Rpb24pCj4gIHsKPiAgCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIGNyMSwgc21zOwo+ICAKPiAgCXN3aXRjaCAoZnVu
Y3Rpb24pIHsKPiAtCWNhc2UgU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxFRDoKPiArCWNh
c2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKPiAgCQlzbXMgPSBUSU1fU01DUl9TTVNfU0xB
VkVfTU9ERV9ESVNBQkxFRDsKPiAgCQlicmVhazsKPiAtCWNhc2UgU1RNMzJfQ09VTlRfRU5DT0RF
Ul9NT0RFXzE6Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BOgo+ICAJ
CXNtcyA9IFRJTV9TTUNSX1NNU19FTkNPREVSX01PREVfMTsKPiAgCQlicmVhazsKPiAtCWNhc2Ug
U1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzI6Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YMl9COgo+ICAJCXNtcyA9IFRJTV9TTUNSX1NNU19FTkNPREVSX01PREVfMjsKPiAg
CQlicmVhazsKPiAtCWNhc2UgU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzM6Cj4gKwljYXNlIENP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKPiAgCQlzbXMgPSBUSU1fU01DUl9TTVNfRU5D
T0RFUl9NT0RFXzM7Cj4gIAkJYnJlYWs7Cj4gIAlkZWZhdWx0Ogo+IEBAIC0xNTAsNDQgKzEzNiwz
NyBAQCBzdGF0aWMgaW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGljIHNzaXplX3Qg
c3RtMzJfY291bnRfZGlyZWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICtzdGF0aWMgaW50IHN0bTMyX2NvdW50X2RpcmVjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAgCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwKPiAtCQkJCSAgICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArCQkJCSAgICAgIGVu
dW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gKmRpcmVjdGlvbikKPiAgewo+ICAJc3RydWN0IHN0
bTMyX3RpbWVyX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gLQljb25zdCBjaGFy
ICpkaXJlY3Rpb247Cj4gIAl1MzIgY3IxOwo+ICAKPiAgCXJlZ21hcF9yZWFkKHByaXYtPnJlZ21h
cCwgVElNX0NSMSwgJmNyMSk7Cj4gLQlkaXJlY3Rpb24gPSAoY3IxICYgVElNX0NSMV9ESVIpID8g
ImJhY2t3YXJkIiA6ICJmb3J3YXJkIjsKPiArCSpkaXJlY3Rpb24gPSAoY3IxICYgVElNX0NSMV9E
SVIpID8gQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fQkFDS1dBUkQgOgo+ICsJCUNPVU5URVJfQ09V
TlRfRElSRUNUSU9OX0ZPUldBUkQ7Cj4gIAo+IC0JcmV0dXJuIHNjbnByaW50ZihidWYsIFBBR0Vf
U0laRSwgIiVzXG4iLCBkaXJlY3Rpb24pOwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRp
YyBzc2l6ZV90IHN0bTMyX2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gLQkJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCXZv
aWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKPiArc3RhdGljIGludCBzdG0zMl9jb3VudF9jZWlsaW5n
X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICpjZWlsaW5nKQo+ICB7Cj4gIAlzdHJ1Y3Qgc3RtMzJf
dGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKPiAgCXUzMiBhcnI7Cj4gIAo+
ICAJcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fQVJSLCAmYXJyKTsKPiAgCj4gLQlyZXR1
cm4gc25wcmludGYoYnVmLCBQQUdFX1NJWkUsICIldVxuIiwgYXJyKTsKPiArCSpjZWlsaW5nID0g
YXJyOwo+ICsKPiArCXJldHVybiAwOwo+ICB9Cj4gIAo+IC1zdGF0aWMgc3NpemVfdCBzdG0zMl9j
b3VudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJ
CQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkJCSB2b2lkICpwcml2YXRlLAo+
IC0JCQkJCSBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRpYyBpbnQgc3RtMzJf
Y291bnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJ
CQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IGNlaWxpbmcpCj4gIHsKPiAg
CXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2Owo+IC0J
dW5zaWduZWQgaW50IGNlaWxpbmc7Cj4gLQlpbnQgcmV0Owo+IC0KPiAtCXJldCA9IGtzdHJ0b3Vp
bnQoYnVmLCAwLCAmY2VpbGluZyk7Cj4gLQlpZiAocmV0KQo+IC0JCXJldHVybiByZXQ7Cj4gIAo+
ICAJaWYgKGNlaWxpbmcgPiBwcml2LT5tYXhfYXJyKQo+ICAJCXJldHVybiAtRVJBTkdFOwo+IEBA
IC0xOTYsMzQgKzE3NSwyNyBAQCBzdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9jZWlsaW5nX3dy
aXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAgCXJlZ21hcF91cGRhdGVfYml0
cyhwcml2LT5yZWdtYXAsIFRJTV9DUjEsIFRJTV9DUjFfQVJQRSwgMCk7Cj4gIAlyZWdtYXBfd3Jp
dGUocHJpdi0+cmVnbWFwLCBUSU1fQVJSLCBjZWlsaW5nKTsKPiAgCj4gLQlyZXR1cm4gbGVuOwo+
ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2NvdW50X2VuYWJs
ZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCSAgICAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkgICAgICAgdm9pZCAqcHJpdmF0ZSwgY2hh
ciAqYnVmKQo+ICtzdGF0aWMgaW50IHN0bTMyX2NvdW50X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwgdTggKmVuYWJsZSkKPiAgewo+ICAJc3RydWN0IHN0bTMyX3RpbWVyX2NudCAqY29uc3QgcHJp
diA9IGNvdW50ZXItPnByaXY7Cj4gIAl1MzIgY3IxOwo+ICAKPiAgCXJlZ21hcF9yZWFkKHByaXYt
PnJlZ21hcCwgVElNX0NSMSwgJmNyMSk7Cj4gIAo+IC0JcmV0dXJuIHNjbnByaW50ZihidWYsIFBB
R0VfU0laRSwgIiVkXG4iLCAoYm9vbCkoY3IxICYgVElNX0NSMV9DRU4pKTsKPiArCSplbmFibGUg
PSBjcjEgJiBUSU1fQ1IxX0NFTjsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3RhdGlj
IHNzaXplX3Qgc3RtMzJfY291bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAtCQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCQkJdm9p
ZCAqcHJpdmF0ZSwKPiAtCQkJCQljb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCj4gK3N0YXRp
YyBpbnQgc3RtMzJfY291bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IGVuYWJsZSkK
PiAgewo+ICAJc3RydWN0IHN0bTMyX3RpbWVyX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnBy
aXY7Cj4gLQlpbnQgZXJyOwo+ICAJdTMyIGNyMTsKPiAtCWJvb2wgZW5hYmxlOwo+IC0KPiAtCWVy
ciA9IGtzdHJ0b2Jvb2woYnVmLCAmZW5hYmxlKTsKPiAtCWlmIChlcnIpCj4gLQkJcmV0dXJuIGVy
cjsKPiAgCj4gIAlpZiAoZW5hYmxlKSB7Cj4gIAkJcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwLCBU
SU1fQ1IxLCAmY3IxKTsKPiBAQCAtMjQyLDcwICsyMTQsNTUgQEAgc3RhdGljIHNzaXplX3Qgc3Rt
MzJfY291bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAg
CS8qIEtlZXAgZW5hYmxlZCBzdGF0ZSB0byBwcm9wZXJseSBoYW5kbGUgbG93IHBvd2VyIHN0YXRl
cyAqLwo+ICAJcHJpdi0+ZW5hYmxlZCA9IGVuYWJsZTsKPiAgCj4gLQlyZXR1cm4gbGVuOwo+ICsJ
cmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9l
eHQgc3RtMzJfY291bnRfZXh0W10gPSB7Cj4gLQl7Cj4gLQkJLm5hbWUgPSAiZGlyZWN0aW9uIiwK
PiAtCQkucmVhZCA9IHN0bTMyX2NvdW50X2RpcmVjdGlvbl9yZWFkLAo+IC0JfSwKPiAtCXsKPiAt
CQkubmFtZSA9ICJlbmFibGUiLAo+IC0JCS5yZWFkID0gc3RtMzJfY291bnRfZW5hYmxlX3JlYWQs
Cj4gLQkJLndyaXRlID0gc3RtMzJfY291bnRfZW5hYmxlX3dyaXRlCj4gLQl9LAo+IC0Jewo+IC0J
CS5uYW1lID0gImNlaWxpbmciLAo+IC0JCS5yZWFkID0gc3RtMzJfY291bnRfY2VpbGluZ19yZWFk
LAo+IC0JCS53cml0ZSA9IHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUKPiAtCX0sCj4gLX07Cj4g
LQo+IC1lbnVtIHN0bTMyX3N5bmFwc2VfYWN0aW9uIHsKPiAtCVNUTTMyX1NZTkFQU0VfQUNUSU9O
X05PTkUsCj4gLQlTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gK3N0YXRpYyBzdHJ1
Y3QgY291bnRlcl9jb21wIHN0bTMyX2NvdW50X2V4dFtdID0gewo+ICsJQ09VTlRFUl9DT01QX0RJ
UkVDVElPTihzdG0zMl9jb3VudF9kaXJlY3Rpb25fcmVhZCksCj4gKwlDT1VOVEVSX0NPTVBfRU5B
QkxFKHN0bTMyX2NvdW50X2VuYWJsZV9yZWFkLCBzdG0zMl9jb3VudF9lbmFibGVfd3JpdGUpLAo+
ICsJQ09VTlRFUl9DT01QX0NFSUxJTkcoc3RtMzJfY291bnRfY2VpbGluZ19yZWFkLAo+ICsJCQkg
ICAgIHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUpLAo+ICB9Owo+ICAKPiAgc3RhdGljIGNvbnN0
IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9zeW5hcHNlX2FjdGlvbnNbXSA9IHsK
PiAtCVtTVE0zMl9TWU5BUFNFX0FDVElPTl9OT05FXSA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05f
Tk9ORSwKPiAtCVtTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTXSA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fQk9USF9FREdFUwo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAo+
ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCj4gIH07Cj4gIAo+IC1zdGF0aWMg
aW50IHN0bTMyX2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0J
CQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkgICAgc3RydWN0IGNvdW50
ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAtCQkJICAgIHNpemVfdCAqYWN0aW9uKQo+ICtzdGF0aWMg
aW50IHN0bTMyX2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAr
CQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCSAgICAgc3RydWN0IGNv
dW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiArCQkJICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9h
Y3Rpb24gKmFjdGlvbikKPiAgewo+IC0Jc2l6ZV90IGZ1bmN0aW9uOwo+ICsJZW51bSBjb3VudGVy
X2Z1bmN0aW9uIGZ1bmN0aW9uOwo+ICAJaW50IGVycjsKPiAgCj4gLQllcnIgPSBzdG0zMl9jb3Vu
dF9mdW5jdGlvbl9nZXQoY291bnRlciwgY291bnQsICZmdW5jdGlvbik7Cj4gKwllcnIgPSBzdG0z
Ml9jb3VudF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOwo+ICAJaWYg
KGVycikKPiAgCQlyZXR1cm4gZXJyOwo+ICAKPiAgCXN3aXRjaCAoZnVuY3Rpb24pIHsKPiAtCWNh
c2UgU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxFRDoKPiArCWNhc2UgQ09VTlRFUl9GVU5D
VElPTl9JTkNSRUFTRToKPiAgCQkvKiBjb3VudHMgb24gaW50ZXJuYWwgY2xvY2sgd2hlbiBDRU49
MSAqLwo+IC0JCSphY3Rpb24gPSBTVE0zMl9TWU5BUFNFX0FDVElPTl9OT05FOwo+ICsJCSphY3Rp
b24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gIAkJcmV0dXJuIDA7Cj4gLQljYXNl
IFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8xOgo+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FV
QURSQVRVUkVfWDJfQToKPiAgCQkvKiBjb3VudHMgdXAvZG93biBvbiBUSTFGUDEgZWRnZSBkZXBl
bmRpbmcgb24gVEkyRlAyIGxldmVsICovCj4gIAkJaWYgKHN5bmFwc2UtPnNpZ25hbC0+aWQgPT0g
Y291bnQtPnN5bmFwc2VzWzBdLnNpZ25hbC0+aWQpCj4gLQkJCSphY3Rpb24gPSBTVE0zMl9TWU5B
UFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9CT1RIX0VER0VTOwo+ICAJCWVsc2UKPiAtCQkJKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0Vf
QUNUSU9OX05PTkU7Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7
Cj4gIAkJcmV0dXJuIDA7Cj4gLQljYXNlIFNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8yOgo+ICsJ
Y2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQjoKPiAgCQkvKiBjb3VudHMgdXAv
ZG93biBvbiBUSTJGUDIgZWRnZSBkZXBlbmRpbmcgb24gVEkxRlAxIGxldmVsICovCj4gIAkJaWYg
KHN5bmFwc2UtPnNpZ25hbC0+aWQgPT0gY291bnQtPnN5bmFwc2VzWzFdLnNpZ25hbC0+aWQpCj4g
LQkJCSphY3Rpb24gPSBTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsJCQkqYWN0
aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICAJCWVsc2UKPiAtCQkJ
KmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gKwkJCSphY3Rpb24gPSBDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7Cj4gIAkJcmV0dXJuIDA7Cj4gLQljYXNlIFNUTTMyX0NP
VU5UX0VOQ09ERVJfTU9ERV8zOgo+ICsJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDQ6Cj4gIAkJLyogY291bnRzIHVwL2Rvd24gb24gYm90aCBUSTFGUDEgYW5kIFRJMkZQMiBlZGdl
cyAqLwo+IC0JCSphY3Rpb24gPSBTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICsJ
CSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gIAkJcmV0dXJu
IDA7Cj4gIAlkZWZhdWx0Ogo+ICAJCXJldHVybiAtRUlOVkFMOwo+IEBAIC0zMTUsOSArMjcyLDkg
QEAgc3RhdGljIGludCBzdG0zMl9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX29wcyBzdG0zMl90aW1lcl9jbnRf
b3BzID0gewo+ICAJLmNvdW50X3JlYWQgPSBzdG0zMl9jb3VudF9yZWFkLAo+ICAJLmNvdW50X3dy
aXRlID0gc3RtMzJfY291bnRfd3JpdGUsCj4gLQkuZnVuY3Rpb25fZ2V0ID0gc3RtMzJfY291bnRf
ZnVuY3Rpb25fZ2V0LAo+IC0JLmZ1bmN0aW9uX3NldCA9IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3Nl
dCwKPiAtCS5hY3Rpb25fZ2V0ID0gc3RtMzJfYWN0aW9uX2dldCwKPiArCS5mdW5jdGlvbl9yZWFk
ID0gc3RtMzJfY291bnRfZnVuY3Rpb25fcmVhZCwKPiArCS5mdW5jdGlvbl93cml0ZSA9IHN0bTMy
X2NvdW50X2Z1bmN0aW9uX3dyaXRlLAo+ICsJLmFjdGlvbl9yZWFkID0gc3RtMzJfYWN0aW9uX3Jl
YWQsCj4gIH07Cj4gIAo+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIHN0bTMyX3NpZ25h
bHNbXSA9IHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL3RpLWVxZXAuYyBiL2RyaXZl
cnMvY291bnRlci90aS1lcWVwLmMKPiBpbmRleCA5NGZlNThiYjNlYWIuLjA5ODE3Yzk1M2Y5YSAx
MDA2NDQKPiAtLS0gYS9kcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5jCj4gKysrIGIvZHJpdmVycy9j
b3VudGVyL3RpLWVxZXAuYwo+IEBAIC0xMyw2ICsxMyw3IEBACj4gICNpbmNsdWRlIDxsaW51eC9w
bGF0Zm9ybV9kZXZpY2UuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3BtX3J1bnRpbWUuaD4KPiAgI2lu
Y2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgo+ICsjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KPiAgCj4g
IC8qIDMyLWJpdCByZWdpc3RlcnMgKi8KPiAgI2RlZmluZSBRUE9TQ05UCQkweDAKPiBAQCAtNzMs
MTkgKzc0LDEzIEBAIGVudW0gewo+ICB9Owo+ICAKPiAgLyogUG9zaXRpb24gQ291bnRlciBJbnB1
dCBNb2RlcyAqLwo+IC1lbnVtIHsKPiArZW51bSB0aV9lcWVwX2NvdW50X2Z1bmMgewo+ICAJVElf
RVFFUF9DT1VOVF9GVU5DX1FVQURfQ09VTlQsCj4gIAlUSV9FUUVQX0NPVU5UX0ZVTkNfRElSX0NP
VU5ULAo+ICAJVElfRVFFUF9DT1VOVF9GVU5DX1VQX0NPVU5ULAo+ICAJVElfRVFFUF9DT1VOVF9G
VU5DX0RPV05fQ09VTlQsCj4gIH07Cj4gIAo+IC1lbnVtIHsKPiAtCVRJX0VRRVBfU1lOQVBTRV9B
Q1RJT05fQk9USF9FREdFUywKPiAtCVRJX0VRRVBfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0Us
Cj4gLQlUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gLX07Cj4gLQo+ICBzdHJ1Y3QgdGlf
ZXFlcF9jbnQgewo+ICAJc3RydWN0IGNvdW50ZXJfZGV2aWNlIGNvdW50ZXI7Cj4gIAlzdHJ1Y3Qg
cmVnbWFwICpyZWdtYXAzMjsKPiBAQCAtOTMsNyArODgsNyBAQCBzdHJ1Y3QgdGlfZXFlcF9jbnQg
ewo+ICB9Owo+ICAKPiAgc3RhdGljIGludCB0aV9lcWVwX2NvdW50X3JlYWQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsIHVuc2lnbmVkIGxvbmcgKnZhbCkKPiArCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB1NjQgKnZhbCkKPiAgewo+ICAJc3RydWN0IHRpX2VxZXBfY250ICpwcml2ID0gY291
bnRlci0+cHJpdjsKPiAgCXUzMiBjbnQ7Cj4gQEAgLTEwNSw3ICsxMDAsNyBAQCBzdGF0aWMgaW50
IHRpX2VxZXBfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIH0K
PiAgCj4gIHN0YXRpYyBpbnQgdGlfZXFlcF9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCj4gLQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHVu
c2lnbmVkIGxvbmcgdmFsKQo+ICsJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1NjQgdmFsKQo+ICB7Cj4gIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5w
cml2Owo+ICAJdTMyIG1heDsKPiBAQCAtMTE3LDY0ICsxMTIsMTAwIEBAIHN0YXRpYyBpbnQgdGlf
ZXFlcF9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAlyZXR1
cm4gcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcDMyLCBRUE9TQ05ULCB2YWwpOwo+ICB9Cj4gIAo+
IC1zdGF0aWMgaW50IHRpX2VxZXBfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAtCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgc2l6ZV90ICpmdW5j
dGlvbikKPiArc3RhdGljIGludCB0aV9lcWVwX2Z1bmN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAr
CQkJCSBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKQo+ICB7Cj4gIAlzdHJ1Y3QgdGlf
ZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIHFkZWNjdGw7Cj4gIAo+ICAJ
cmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwMTYsIFFERUNDVEwsICZxZGVjY3RsKTsKPiAtCSpmdW5j
dGlvbiA9IChxZGVjY3RsICYgUURFQ0NUTF9RU1JDKSA+PiBRREVDQ1RMX1FTUkNfU0hJRlQ7Cj4g
Kwo+ICsJc3dpdGNoICgocWRlY2N0bCAmIFFERUNDVExfUVNSQykgPj4gUURFQ0NUTF9RU1JDX1NI
SUZUKSB7Cj4gKwljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UOgo+ICsJCSpmdW5j
dGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDsKPiArCQlicmVhazsKPiArCWNh
c2UgVElfRVFFUF9DT1VOVF9GVU5DX0RJUl9DT1VOVDoKPiArCQkqZnVuY3Rpb24gPSBDT1VOVEVS
X0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTjsKPiArCQlicmVhazsKPiArCWNhc2UgVElfRVFFUF9D
T1VOVF9GVU5DX1VQX0NPVU5UOgo+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fSU5D
UkVBU0U7Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19ET1dOX0NPVU5U
Ogo+ICsJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fREVDUkVBU0U7Cj4gKwkJYnJlYWs7
Cj4gKwl9Cj4gIAo+ICAJcmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBpbnQgdGlfZXFlcF9m
dW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgZnVuY3Rpb24pCj4gK3N0YXRpYyBpbnQgdGlf
ZXFlcF9mdW5jdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJ
CQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJCSAgZW51bSBjb3VudGVyX2Z1
bmN0aW9uIGZ1bmN0aW9uKQo+ICB7Cj4gIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3Vu
dGVyLT5wcml2Owo+ICsJZW51bSB0aV9lcWVwX2NvdW50X2Z1bmMgcXNyYzsKPiArCj4gKwlzd2l0
Y2ggKGZ1bmN0aW9uKSB7Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoK
PiArCQlxc3JjID0gVElfRVFFUF9DT1VOVF9GVU5DX1FVQURfQ09VTlQ7Cj4gKwkJYnJlYWs7Cj4g
KwljYXNlIENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOgo+ICsJCXFzcmMgPSBUSV9F
UUVQX0NPVU5UX0ZVTkNfRElSX0NPVU5UOwo+ICsJCWJyZWFrOwo+ICsJY2FzZSBDT1VOVEVSX0ZV
TkNUSU9OX0lOQ1JFQVNFOgo+ICsJCXFzcmMgPSBUSV9FUUVQX0NPVU5UX0ZVTkNfVVBfQ09VTlQ7
Cj4gKwkJYnJlYWs7Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fREVDUkVBU0U6Cj4gKwkJcXNy
YyA9IFRJX0VRRVBfQ09VTlRfRlVOQ19ET1dOX0NPVU5UOwo+ICsJCWJyZWFrOwo+ICsJZGVmYXVs
dDoKPiArCQkvKiBzaG91bGQgbmV2ZXIgcmVhY2ggdGhpcyBwYXRoICovCj4gKwkJcmV0dXJuIC1F
SU5WQUw7Cj4gKwl9Cj4gIAo+ICAJcmV0dXJuIHJlZ21hcF93cml0ZV9iaXRzKHByaXYtPnJlZ21h
cDE2LCBRREVDQ1RMLCBRREVDQ1RMX1FTUkMsCj4gLQkJCQkgZnVuY3Rpb24gPDwgUURFQ0NUTF9R
U1JDX1NISUZUKTsKPiArCQkJCSBxc3JjIDw8IFFERUNDVExfUVNSQ19TSElGVCk7Cj4gIH0KPiAg
Cj4gLXN0YXRpYyBpbnQgdGlfZXFlcF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAtCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCQkg
ICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLCBzaXplX3QgKmFjdGlvbikKPiAr
c3RhdGljIGludCB0aV9lcWVwX2FjdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiArCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJICAg
ICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCj4gKwkJCSAgICAgICBlbnVtIGNv
dW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKPiAgewo+ICAJc3RydWN0IHRpX2VxZXBfY250
ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiAtCXNpemVfdCBmdW5jdGlvbjsKPiArCWVudW0gY291
bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKPiAgCXUzMiBxZGVjY3RsOwo+ICAJaW50IGVycjsKPiAg
Cj4gLQllcnIgPSB0aV9lcWVwX2Z1bmN0aW9uX2dldChjb3VudGVyLCBjb3VudCwgJmZ1bmN0aW9u
KTsKPiArCWVyciA9IHRpX2VxZXBfZnVuY3Rpb25fcmVhZChjb3VudGVyLCBjb3VudCwgJmZ1bmN0
aW9uKTsKPiAgCWlmIChlcnIpCj4gIAkJcmV0dXJuIGVycjsKPiAgCj4gIAlzd2l0Y2ggKGZ1bmN0
aW9uKSB7Cj4gLQljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UOgo+ICsJY2FzZSBD
T1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6Cj4gIAkJLyogSW4gcXVhZHJhdHVyZSBtb2Rl
LCB0aGUgcmlzaW5nIGFuZCBmYWxsaW5nIGVkZ2Ugb2YgYm90aAo+ICAJCSAqIFFFUEEgYW5kIFFF
UEIgdHJpZ2dlciBRQ0xLLgo+ICAJCSAqLwo+IC0JCSphY3Rpb24gPSBUSV9FUUVQX1NZTkFQU0Vf
QUNUSU9OX0JPVEhfRURHRVM7Cj4gKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05f
Qk9USF9FREdFUzsKPiAgCQlyZXR1cm4gMDsKPiAtCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX0RJ
Ul9DT1VOVDoKPiArCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT046Cj4gIAkJ
LyogSW4gZGlyZWN0aW9uLWNvdW50IG1vZGUgb25seSByaXNpbmcgZWRnZSBvZiBRRVBBIGlzIGNv
dW50ZWQKPiAgCQkgKiBhbmQgUUVQQiBnaXZlcyBkaXJlY3Rpb24uCj4gIAkJICovCj4gIAkJc3dp
dGNoIChzeW5hcHNlLT5zaWduYWwtPmlkKSB7Cj4gIAkJY2FzZSBUSV9FUUVQX1NJR05BTF9RRVBB
Ogo+IC0JCQkqYWN0aW9uID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiAr
CQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7Cj4gIAkJCXJl
dHVybiAwOwo+ICAJCWNhc2UgVElfRVFFUF9TSUdOQUxfUUVQQjoKPiAtCQkJKmFjdGlvbiA9IFRJ
X0VRRVBfU1lOQVBTRV9BQ1RJT05fTk9ORTsKPiArCQkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBT
RV9BQ1RJT05fTk9ORTsKPiAgCQkJcmV0dXJuIDA7Cj4gIAkJZGVmYXVsdDoKPiAgCQkJLyogc2hv
dWxkIG5ldmVyIHJlYWNoIHRoaXMgcGF0aCAqLwo+ICAJCQlyZXR1cm4gLUVJTlZBTDsKPiAgCQl9
Cj4gLQljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19VUF9DT1VOVDoKPiAtCWNhc2UgVElfRVFFUF9D
T1VOVF9GVU5DX0RPV05fQ09VTlQ6Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0U6
Cj4gKwljYXNlIENPVU5URVJfRlVOQ1RJT05fREVDUkVBU0U6Cj4gIAkJLyogSW4gdXAvZG93bi1j
b3VudCBtb2RlcyBvbmx5IFFFUEEgaXMgY291bnRlZCBhbmQgUUVQQiBpcyBub3QKPiAgCQkgKiB1
c2VkLgo+ICAJCSAqLwo+IEBAIC0xODUsMTIgKzIxNiwxMiBAQCBzdGF0aWMgaW50IHRpX2VxZXBf
YWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gIAkJCQlyZXR1cm4g
ZXJyOwo+ICAKPiAgCQkJaWYgKHFkZWNjdGwgJiBRREVDQ1RMX1hDUikKPiAtCQkJCSphY3Rpb24g
PSBUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7Cj4gKwkJCQkqYWN0aW9uID0gQ09V
TlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwo+ICAJCQllbHNlCj4gLQkJCQkqYWN0aW9u
ID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKPiArCQkJCSphY3Rpb24gPSBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwo+ICAJCQlyZXR1cm4gMDsKPiAgCQlj
YXNlIFRJX0VRRVBfU0lHTkFMX1FFUEI6Cj4gLQkJCSphY3Rpb24gPSBUSV9FUUVQX1NZTkFQU0Vf
QUNUSU9OX05PTkU7Cj4gKwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7
Cj4gIAkJCXJldHVybiAwOwo+ICAJCWRlZmF1bHQ6Cj4gIAkJCS8qIHNob3VsZCBuZXZlciByZWFj
aCB0aGlzIHBhdGggKi8KPiBAQCAtMjA1LDgyICsyMzYsNjcgQEAgc3RhdGljIGludCB0aV9lcWVw
X2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICBzdGF0aWMgY29u
c3Qgc3RydWN0IGNvdW50ZXJfb3BzIHRpX2VxZXBfY291bnRlcl9vcHMgPSB7Cj4gIAkuY291bnRf
cmVhZAk9IHRpX2VxZXBfY291bnRfcmVhZCwKPiAgCS5jb3VudF93cml0ZQk9IHRpX2VxZXBfY291
bnRfd3JpdGUsCj4gLQkuZnVuY3Rpb25fZ2V0CT0gdGlfZXFlcF9mdW5jdGlvbl9nZXQsCj4gLQku
ZnVuY3Rpb25fc2V0CT0gdGlfZXFlcF9mdW5jdGlvbl9zZXQsCj4gLQkuYWN0aW9uX2dldAk9IHRp
X2VxZXBfYWN0aW9uX2dldCwKPiArCS5mdW5jdGlvbl9yZWFkCT0gdGlfZXFlcF9mdW5jdGlvbl9y
ZWFkLAo+ICsJLmZ1bmN0aW9uX3dyaXRlCT0gdGlfZXFlcF9mdW5jdGlvbl93cml0ZSwKPiArCS5h
Y3Rpb25fcmVhZAk9IHRpX2VxZXBfYWN0aW9uX3JlYWQsCj4gIH07Cj4gIAo+IC1zdGF0aWMgc3Np
emVfdCB0aV9lcWVwX3Bvc2l0aW9uX2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gLQkJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJ
CQkJICAgICB2b2lkICpleHRfcHJpdiwgY2hhciAqYnVmKQo+ICtzdGF0aWMgaW50IHRpX2VxZXBf
cG9zaXRpb25fY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAr
CQkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJCSB1NjQgKmNlaWxpbmcp
Cj4gIHsKPiAgCXN0cnVjdCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gIAl1
MzIgcXBvc21heDsKPiAgCj4gIAlyZWdtYXBfcmVhZChwcml2LT5yZWdtYXAzMiwgUVBPU01BWCwg
JnFwb3NtYXgpOwo+ICAKPiAtCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBxcG9zbWF4KTsK
PiArCSpjZWlsaW5nID0gcXBvc21heDsKPiArCj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAKPiAtc3Rh
dGljIHNzaXplX3QgdGlfZXFlcF9wb3NpdGlvbl9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKPiAtCQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gLQkJCQkJICAgICAgdm9pZCAqZXh0X3ByaXYsIGNvbnN0IGNoYXIgKmJ1ZiwKPiAtCQkJ
CQkgICAgICBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHRpX2VxZXBfcG9zaXRpb25fY2VpbGlu
Z193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkJICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCQkJICB1NjQgY2VpbGluZykKPiAgewo+ICAJc3Ry
dWN0IHRpX2VxZXBfY250ICpwcml2ID0gY291bnRlci0+cHJpdjsKPiAtCWludCBlcnI7Cj4gLQl1
MzIgcmVzOwo+ICAKPiAtCWVyciA9IGtzdHJ0b3VpbnQoYnVmLCAwLCAmcmVzKTsKPiAtCWlmIChl
cnIgPCAwKQo+IC0JCXJldHVybiBlcnI7Cj4gKwlpZiAoY2VpbGluZyAhPSAodTMyKWNlaWxpbmcp
Cj4gKwkJcmV0dXJuIC1FUkFOR0U7Cj4gIAo+IC0JcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcDMy
LCBRUE9TTUFYLCByZXMpOwo+ICsJcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcDMyLCBRUE9TTUFY
LCBjZWlsaW5nKTsKPiAgCj4gLQlyZXR1cm4gbGVuOwo+ICsJcmV0dXJuIDA7Cj4gIH0KPiAgCj4g
LXN0YXRpYyBzc2l6ZV90IHRpX2VxZXBfcG9zaXRpb25fZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsCj4gLQkJCQkJICAgIHZvaWQgKmV4dF9wcml2LCBjaGFyICpidWYpCj4gK3N0YXRpYyBpbnQg
dGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gKwkJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCAqZW5hYmxlKQo+ICB7
Cj4gIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owo+ICAJdTMyIHFl
cGN0bDsKPiAgCj4gIAlyZWdtYXBfcmVhZChwcml2LT5yZWdtYXAxNiwgUUVQQ1RMLCAmcWVwY3Rs
KTsKPiAgCj4gLQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgISEocWVwY3RsICYgUUVQQ1RM
X1BIRU4pKTsKPiArCSplbmFibGUgPSAhIShxZXBjdGwgJiBRRVBDVExfUEhFTik7Cj4gKwo+ICsJ
cmV0dXJuIDA7Cj4gIH0KPiAgCj4gLXN0YXRpYyBzc2l6ZV90IHRpX2VxZXBfcG9zaXRpb25fZW5h
YmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCQkgICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCQkgICAgIHZvaWQgKmV4dF9wcml2LCBj
b25zdCBjaGFyICpidWYsCj4gLQkJCQkJICAgICBzaXplX3QgbGVuKQo+ICtzdGF0aWMgaW50IHRp
X2VxZXBfcG9zaXRpb25fZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiArCQkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCBlbmFibGUpCj4gIHsK
PiAgCXN0cnVjdCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Cj4gLQlpbnQgZXJy
Owo+IC0JYm9vbCByZXM7Cj4gLQo+IC0JZXJyID0ga3N0cnRvYm9vbChidWYsICZyZXMpOwo+IC0J
aWYgKGVyciA8IDApCj4gLQkJcmV0dXJuIGVycjsKPiAgCj4gLQlyZWdtYXBfd3JpdGVfYml0cyhw
cml2LT5yZWdtYXAxNiwgUUVQQ1RMLCBRRVBDVExfUEhFTiwgcmVzID8gLTEgOiAwKTsKPiArCXJl
Z21hcF93cml0ZV9iaXRzKHByaXYtPnJlZ21hcDE2LCBRRVBDVEwsIFFFUENUTF9QSEVOLCBlbmFi
bGUgPyAtMSA6IDApOwo+ICAKPiAtCXJldHVybiBsZW47Cj4gKwlyZXR1cm4gMDsKPiAgfQo+ICAK
PiAtc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCB0aV9lcWVwX3Bvc2l0aW9uX2V4dFtd
ID0gewo+IC0Jewo+IC0JCS5uYW1lCT0gImNlaWxpbmciLAo+IC0JCS5yZWFkCT0gdGlfZXFlcF9w
b3NpdGlvbl9jZWlsaW5nX3JlYWQsCj4gLQkJLndyaXRlCT0gdGlfZXFlcF9wb3NpdGlvbl9jZWls
aW5nX3dyaXRlLAo+IC0JfSwKPiAtCXsKPiAtCQkubmFtZQk9ICJlbmFibGUiLAo+IC0JCS5yZWFk
CT0gdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfcmVhZCwKPiAtCQkud3JpdGUJPSB0aV9lcWVwX3Bv
c2l0aW9uX2VuYWJsZV93cml0ZSwKPiAtCX0sCj4gK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21w
IHRpX2VxZXBfcG9zaXRpb25fZXh0W10gPSB7Cj4gKwlDT1VOVEVSX0NPTVBfQ0VJTElORyh0aV9l
cWVwX3Bvc2l0aW9uX2NlaWxpbmdfcmVhZCwKPiArCQkJICAgICB0aV9lcWVwX3Bvc2l0aW9uX2Nl
aWxpbmdfd3JpdGUpLAo+ICsJQ09VTlRFUl9DT01QX0VOQUJMRSh0aV9lcWVwX3Bvc2l0aW9uX2Vu
YWJsZV9yZWFkLAo+ICsJCQkgICAgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfd3JpdGUpLAo+ICB9
Owo+ICAKPiAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbCB0aV9lcWVwX3NpZ25hbHNbXSA9
IHsKPiBAQCAtMjk1LDE2ICszMTEsMTYgQEAgc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbCB0
aV9lcWVwX3NpZ25hbHNbXSA9IHsKPiAgfTsKPiAgCj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50
ZXJfZnVuY3Rpb24gdGlfZXFlcF9wb3NpdGlvbl9mdW5jdGlvbnNbXSA9IHsKPiAtCVtUSV9FUUVQ
X0NPVU5UX0ZVTkNfUVVBRF9DT1VOVF0JPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQs
Cj4gLQlbVElfRVFFUF9DT1VOVF9GVU5DX0RJUl9DT1VOVF0JPSBDT1VOVEVSX0ZVTkNUSU9OX1BV
TFNFX0RJUkVDVElPTiwKPiAtCVtUSV9FUUVQX0NPVU5UX0ZVTkNfVVBfQ09VTlRdCT0gQ09VTlRF
Ul9GVU5DVElPTl9JTkNSRUFTRSwKPiAtCVtUSV9FUUVQX0NPVU5UX0ZVTkNfRE9XTl9DT1VOVF0J
PSBDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFU
VVJFX1g0LAo+ICsJQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04sCj4gKwlDT1VOVEVS
X0ZVTkNUSU9OX0lOQ1JFQVNFLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9ERUNSRUFTRSwKPiAgfTsK
PiAgCj4gIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gdGlfZXFlcF9w
b3NpdGlvbl9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKPiAtCVtUSV9FUUVQX1NZTkFQU0VfQUNUSU9O
X0JPVEhfRURHRVNdCT0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAo+IC0JW1RJ
X0VRRVBfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0VdCT0gQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9SSVNJTkdfRURHRSwKPiAtCVtUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX05PTkVdCQk9IENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fTk9ORSwKPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUywKPiArCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gKwlDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX05PTkUsCj4gIH07Cj4gIAo+ICBzdGF0aWMgc3RydWN0IGNvdW50ZXJf
c3luYXBzZSB0aV9lcWVwX3Bvc2l0aW9uX3N5bmFwc2VzW10gPSB7Cj4gZGlmZiAtLWdpdCBhL2lu
Y2x1ZGUvbGludXgvY291bnRlci5oIGIvaW5jbHVkZS9saW51eC9jb3VudGVyLmgKPiBpbmRleCBk
MTZjZTI4MTliNDguLmI2OTI3N2Y1YzRjNSAxMDA2NDQKPiAtLS0gYS9pbmNsdWRlL2xpbnV4L2Nv
dW50ZXIuaAo+ICsrKyBiL2luY2x1ZGUvbGludXgvY291bnRlci5oCj4gQEAgLTYsNDIgKzYsMTg0
IEBACj4gICNpZm5kZWYgX0NPVU5URVJfSF8KPiAgI2RlZmluZSBfQ09VTlRFUl9IXwo+ICAKPiAt
I2luY2x1ZGUgPGxpbnV4L2NvdW50ZXJfZW51bS5oPgo+ICAjaW5jbHVkZSA8bGludXgvZGV2aWNl
Lmg+Cj4gKyNpbmNsdWRlIDxsaW51eC9rZXJuZWwuaD4KPiAgI2luY2x1ZGUgPGxpbnV4L3R5cGVz
Lmg+Cj4gIAo+ICtzdHJ1Y3QgY291bnRlcl9kZXZpY2U7Cj4gK3N0cnVjdCBjb3VudGVyX2NvdW50
Owo+ICtzdHJ1Y3QgY291bnRlcl9zeW5hcHNlOwo+ICtzdHJ1Y3QgY291bnRlcl9zaWduYWw7Cj4g
Kwo+ICtlbnVtIGNvdW50ZXJfY29tcF90eXBlIHsKPiArCUNPVU5URVJfQ09NUF9VOCwKPiArCUNP
VU5URVJfQ09NUF9VNjQsCj4gKwlDT1VOVEVSX0NPTVBfQk9PTCwKPiArCUNPVU5URVJfQ09NUF9T
SUdOQUxfTEVWRUwsCj4gKwlDT1VOVEVSX0NPTVBfRlVOQ1RJT04sCj4gKwlDT1VOVEVSX0NPTVBf
U1lOQVBTRV9BQ1RJT04sCj4gKwlDT1VOVEVSX0NPTVBfRU5VTSwKPiArCUNPVU5URVJfQ09NUF9D
T1VOVF9ESVJFQ1RJT04sCj4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERSwKPiArfTsKPiArCj4g
K2VudW0gY291bnRlcl9zY29wZSB7Cj4gKwlDT1VOVEVSX1NDT1BFX0RFVklDRSwKPiArCUNPVU5U
RVJfU0NPUEVfU0lHTkFMLAo+ICsJQ09VTlRFUl9TQ09QRV9DT1VOVCwKPiArfTsKPiArCj4gIGVu
dW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gewo+IC0JQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05f
Rk9SV0FSRCA9IDAsCj4gLQlDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9CQUNLV0FSRAo+ICsJQ09V
TlRFUl9DT1VOVF9ESVJFQ1RJT05fRk9SV0FSRCwKPiArCUNPVU5URVJfQ09VTlRfRElSRUNUSU9O
X0JBQ0tXQVJELAo+ICB9Owo+IC1leHRlcm4gY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9jb3Vu
dF9kaXJlY3Rpb25fc3RyWzJdOwo+ICAKPiAgZW51bSBjb3VudGVyX2NvdW50X21vZGUgewo+IC0J
Q09VTlRFUl9DT1VOVF9NT0RFX05PUk1BTCA9IDAsCj4gKwlDT1VOVEVSX0NPVU5UX01PREVfTk9S
TUFMLAo+ICAJQ09VTlRFUl9DT1VOVF9NT0RFX1JBTkdFX0xJTUlULAo+ICAJQ09VTlRFUl9DT1VO
VF9NT0RFX05PTl9SRUNZQ0xFLAo+IC0JQ09VTlRFUl9DT1VOVF9NT0RFX01PRFVMT19OCj4gKwlD
T1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX04sCj4gIH07Cj4gLWV4dGVybiBjb25zdCBjaGFyICpj
b25zdCBjb3VudGVyX2NvdW50X21vZGVfc3RyWzRdOwo+ICAKPiAtc3RydWN0IGNvdW50ZXJfZGV2
aWNlOwo+IC1zdHJ1Y3QgY291bnRlcl9zaWduYWw7Cj4gK2VudW0gY291bnRlcl9mdW5jdGlvbiB7
Cj4gKwlDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAo+ICsJQ09VTlRFUl9GVU5DVElPTl9ERUNS
RUFTRSwKPiArCUNPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OLAo+ICsJQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1gxX0EsCj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDFfQiwKPiArCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BLAo+ICsJQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1gyX0IsCj4gKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDQsCj4gK307Cj4gKwo+ICtlbnVtIGNvdW50ZXJfc2lnbmFsX2xldmVsIHsKPiArCUNPVU5URVJf
U0lHTkFMX0xFVkVMX0xPVywKPiArCUNPVU5URVJfU0lHTkFMX0xFVkVMX0hJR0gsCj4gK307Cj4g
Kwo+ICtlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gewo+ICsJQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9OT05FLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKPiArCUNP
VU5URVJfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFLAo+ICsJQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9CT1RIX0VER0VTLAo+ICt9Owo+ICAKPiAgLyoqCj4gLSAqIHN0cnVjdCBjb3VudGVyX3Np
Z25hbF9leHQgLSBDb3VudGVyIFNpZ25hbCBleHRlbnNpb25zCj4gLSAqIEBuYW1lOglhdHRyaWJ1
dGUgbmFtZQo+IC0gKiBAcmVhZDoJcmVhZCBjYWxsYmFjayBmb3IgdGhpcyBhdHRyaWJ1dGU7IG1h
eSBiZSBOVUxMCj4gLSAqIEB3cml0ZToJd3JpdGUgY2FsbGJhY2sgZm9yIHRoaXMgYXR0cmlidXRl
OyBtYXkgYmUgTlVMTAo+IC0gKiBAcHJpdjoJZGF0YSBwcml2YXRlIHRvIHRoZSBkcml2ZXIKPiAr
ICogc3RydWN0IGNvdW50ZXJfY29tcCAtIENvdW50ZXIgY29tcG9uZW50IG5vZGUKPiArICogQHR5
cGU6CQlDb3VudGVyIGNvbXBvbmVudCBkYXRhIHR5cGUKPiArICogQG5hbWU6CQlkZXZpY2Utc3Bl
Y2lmaWMgY29tcG9uZW50IG5hbWUKPiArICogQHByaXY6CQljb21wb25lbnQtcmVsZXZhbnQgZGF0
YQo+ICsgKiBAYWN0aW9uX3JlYWQJCVN5bmFwc2UgYWN0aW9uIG1vZGUgcmVhZCBjYWxsYmFjay4g
VGhlIHJlYWQgdmFsdWUgb2YgdGhlCj4gKyAqCQkJcmVzcGVjdGl2ZSBTeW5hcHNlIGFjdGlvbiBt
b2RlIHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiArICoJCQl0aGUgYWN0aW9uIHBhcmFtZXRl
ci4KPiArICogQGRldmljZV91OF9yZWFkCURldmljZSB1OCBjb21wb25lbnQgcmVhZCBjYWxsYmFj
ay4gVGhlIHJlYWQgdmFsdWUgb2YgdGhlCj4gKyAqCQkJcmVzcGVjdGl2ZSBEZXZpY2UgdTggY29t
cG9uZW50IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiArICoJCQl0aGUgdmFsIHBhcmFtZXRl
ci4KPiArICogQGNvdW50X3U4X3JlYWQJQ291bnQgdTggY29tcG9uZW50IHJlYWQgY2FsbGJhY2su
IFRoZSByZWFkIHZhbHVlIG9mIHRoZQo+ICsgKgkJCXJlc3BlY3RpdmUgQ291bnQgdTggY29tcG9u
ZW50IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiArICoJCQl0aGUgdmFsIHBhcmFtZXRlci4K
PiArICogQHNpZ25hbF91OF9yZWFkCVNpZ25hbCB1OCBjb21wb25lbnQgcmVhZCBjYWxsYmFjay4g
VGhlIHJlYWQgdmFsdWUgb2YgdGhlCj4gKyAqCQkJcmVzcGVjdGl2ZSBTaWduYWwgdTggY29tcG9u
ZW50IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiArICoJCQl0aGUgdmFsIHBhcmFtZXRlci4K
PiArICogQGRldmljZV91MzJfcmVhZAlEZXZpY2UgdTMyIGNvbXBvbmVudCByZWFkIGNhbGxiYWNr
LiBUaGUgcmVhZCB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIERldmljZSB1MzIgY29t
cG9uZW50IHNob3VsZCBiZSBwYXNzZWQKPiArICoJCQliYWNrIHZpYSB0aGUgdmFsIHBhcmFtZXRl
ci4KPiArICogQGNvdW50X3UzMl9yZWFkCUNvdW50IHUzMiBjb21wb25lbnQgcmVhZCBjYWxsYmFj
ay4gVGhlIHJlYWQgdmFsdWUgb2YgdGhlCj4gKyAqCQkJcmVzcGVjdGl2ZSBDb3VudCB1MzIgY29t
cG9uZW50IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiArICoJCQl0aGUgdmFsIHBhcmFtZXRl
ci4KPiArICogQHNpZ25hbF91MzJfcmVhZAlTaWduYWwgdTMyIGNvbXBvbmVudCByZWFkIGNhbGxi
YWNrLiBUaGUgcmVhZCB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIFNpZ25hbCB1MzIg
Y29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQKPiArICoJCQliYWNrIHZpYSB0aGUgdmFsIHBhcmFt
ZXRlci4KPiArICogQGRldmljZV91NjRfcmVhZAlEZXZpY2UgdTY0IGNvbXBvbmVudCByZWFkIGNh
bGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIERldmljZSB1
NjQgY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQKPiArICoJCQliYWNrIHZpYSB0aGUgdmFsIHBh
cmFtZXRlci4KPiArICogQGNvdW50X3U2NF9yZWFkCUNvdW50IHU2NCBjb21wb25lbnQgcmVhZCBj
YWxsYmFjay4gVGhlIHJlYWQgdmFsdWUgb2YgdGhlCj4gKyAqCQkJcmVzcGVjdGl2ZSBDb3VudCB1
NjQgY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKPiArICoJCQl0aGUgdmFsIHBh
cmFtZXRlci4KPiArICogQHNpZ25hbF91NjRfcmVhZAlTaWduYWwgdTY0IGNvbXBvbmVudCByZWFk
IGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIFNpZ25h
bCB1NjQgY29tcG9uZW50IHNob3VsZCBiZSBwYXNzZWQKPiArICoJCQliYWNrIHZpYSB0aGUgdmFs
IHBhcmFtZXRlci4KPiArICogQGFjdGlvbl93cml0ZQlTeW5hcHNlIGFjdGlvbiBtb2RlIHdyaXRl
IGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiArICoJCQl0aGUgcmVzcGVjdGl2ZSBTeW5h
cHNlIGFjdGlvbiBtb2RlIGlzIHBhc3NlZCB2aWEgdGhlCj4gKyAqCQkJYWN0aW9uIHBhcmFtZXRl
ci4KPiArICogQGRldmljZV91OF93cml0ZQlEZXZpY2UgdTggY29tcG9uZW50IHdyaXRlIGNhbGxi
YWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiArICoJCQl0aGUgcmVzcGVjdGl2ZSBEZXZpY2UgdTgg
Y29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlIHZhbAo+ICsgKgkJCXBhcmFtZXRlci4KPiArICog
QGNvdW50X3U4X3dyaXRlCUNvdW50IHU4IGNvbXBvbmVudCB3cml0ZSBjYWxsYmFjay4gVGhlIHdy
aXRlIHZhbHVlIG9mCj4gKyAqCQkJdGhlIHJlc3BlY3RpdmUgQ291bnQgdTggY29tcG9uZW50IGlz
IHBhc3NlZCB2aWEgdGhlIHZhbAo+ICsgKgkJCXBhcmFtZXRlci4KPiArICogQHNpZ25hbF91OF93
cml0ZQlTaWduYWwgdTggY29tcG9uZW50IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUg
b2YKPiArICoJCQl0aGUgcmVzcGVjdGl2ZSBTaWduYWwgdTggY29tcG9uZW50IGlzIHBhc3NlZCB2
aWEgdGhlIHZhbAo+ICsgKgkJCXBhcmFtZXRlci4KPiArICogQGRldmljZV91MzJfd3JpdGUJRGV2
aWNlIHUzMiBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgo+ICsg
KgkJCXRoZSByZXNwZWN0aXZlIERldmljZSB1MzIgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhl
Cj4gKyAqCQkJdmFsIHBhcmFtZXRlci4KPiArICogQGNvdW50X3UzMl93cml0ZQlDb3VudCB1MzIg
Y29tcG9uZW50IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiArICoJCQl0aGUg
cmVzcGVjdGl2ZSBDb3VudCB1MzIgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlIHZhbAo+ICsg
KgkJCXBhcmFtZXRlci4KPiArICogQHNpZ25hbF91MzJfd3JpdGUJU2lnbmFsIHUzMiBjb21wb25l
bnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0
aXZlIFNpZ25hbCB1MzIgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlCj4gKyAqCQkJdmFsIHBh
cmFtZXRlci4KPiArICogQGRldmljZV91NjRfd3JpdGUJRGV2aWNlIHU2NCBjb21wb25lbnQgd3Jp
dGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIERl
dmljZSB1NjQgY29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlCj4gKyAqCQkJdmFsIHBhcmFtZXRl
ci4KPiArICogQGNvdW50X3U2NF93cml0ZQlDb3VudCB1NjQgY29tcG9uZW50IHdyaXRlIGNhbGxi
YWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKPiArICoJCQl0aGUgcmVzcGVjdGl2ZSBDb3VudCB1NjQg
Y29tcG9uZW50IGlzIHBhc3NlZCB2aWEgdGhlIHZhbAo+ICsgKgkJCXBhcmFtZXRlci4KPiArICog
QHNpZ25hbF91NjRfd3JpdGUJU2lnbmFsIHU2NCBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2suIFRo
ZSB3cml0ZSB2YWx1ZSBvZgo+ICsgKgkJCXRoZSByZXNwZWN0aXZlIFNpZ25hbCB1NjQgY29tcG9u
ZW50IGlzIHBhc3NlZCB2aWEgdGhlCj4gKyAqCQkJdmFsIHBhcmFtZXRlci4KPiAgICovCj4gLXN0
cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgewo+ICtzdHJ1Y3QgY291bnRlcl9jb21wIHsKPiArCWVu
dW0gY291bnRlcl9jb21wX3R5cGUgdHlwZTsKPiAgCWNvbnN0IGNoYXIgKm5hbWU7Cj4gLQlzc2l6
ZV90ICgqcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQlzdHJ1Y3Qg
Y291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdiwgY2hhciAqYnVmKTsKPiAtCXNzaXpl
X3QgKCp3cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCQkgc3RydWN0
IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHZvaWQgKnByaXYsCj4gLQkJCSBjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pOwo+ICAJdm9pZCAqcHJpdjsKPiArCXVuaW9uIHsKPiArCQlpbnQgKCph
Y3Rpb25fcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+ICsJCQkJICAgc3RydWN0IGNvdW50ZXJfc3luYXBz
ZSAqc3luYXBzZSwKPiArCQkJCSAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9u
KTsKPiArCQlpbnQgKCpkZXZpY2VfdThfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLCB1OCAqdmFsKTsKPiArCQlpbnQgKCpjb3VudF91OF9yZWFkKShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwg
dTggKnZhbCk7Cj4gKwkJaW50ICgqc2lnbmFsX3U4X3JlYWQpKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiArCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB1
OCAqdmFsKTsKPiArCQlpbnQgKCpkZXZpY2VfdTMyX3JlYWQpKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKPiArCQkJCSAgICAgICB1MzIgKnZhbCk7Cj4gKwkJaW50ICgqY291bnRfdTMy
X3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyICp2YWwpOwo+ICsJCWludCAoKnNpZ25hbF91MzJf
cmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgIHN0cnVj
dCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB1MzIgKnZhbCk7Cj4gKwkJaW50ICgqZGV2aWNlX3U2
NF9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCQkgICAgICAgdTY0
ICp2YWwpOwo+ICsJCWludCAoKmNvdW50X3U2NF9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCj4gKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAq
dmFsKTsKPiArCQlpbnQgKCpzaWduYWxfdTY0X3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiArCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdTY0
ICp2YWwpOwo+ICsJfTsKPiArCXVuaW9uIHsKPiArCQlpbnQgKCphY3Rpb25fd3JpdGUpKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCj4gKwkJCQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKPiAr
CQkJCSAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uKTsKPiArCQlpbnQgKCpk
ZXZpY2VfdThfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdTggdmFsKTsK
PiArCQlpbnQgKCpjb3VudF91OF93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+ICsJCQkJICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCB2YWwpOwo+ICsJ
CWludCAoKnNpZ25hbF91OF93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+
ICsJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB1OCB2YWwpOwo+ICsJ
CWludCAoKmRldmljZV91MzJfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiArCQkJCQl1MzIgdmFsKTsKPiArCQlpbnQgKCpjb3VudF91MzJfd3JpdGUpKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHUzMiB2YWwpOwo+ICsJCWludCAoKnNpZ25hbF91MzJfd3JpdGUpKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKPiArCQkJCQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25h
bCwgdTMyIHZhbCk7Cj4gKwkJaW50ICgqZGV2aWNlX3U2NF93cml0ZSkoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCXU2NCB2YWwpOwo+ICsJCWludCAoKmNvdW50X3U2NF93
cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IHZhbCk7Cj4gKwkJaW50ICgqc2lnbmFsX3U2NF93
cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkJCXN0cnVjdCBjb3Vu
dGVyX3NpZ25hbCAqc2lnbmFsLCB1NjQgdmFsKTsKPiArCX07Cj4gIH07Cj4gIAo+ICAvKioKPiBA
QCAtNTEsMjQ4ICsxOTMsNTIgQEAgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCB7Cj4gICAqCQlh
cyBpdCBhcHBlYXJzIGluIHRoZSBkYXRhc2hlZXQgZG9jdW1lbnRhdGlvbgo+ICAgKiBAZXh0Oglv
cHRpb25hbCBhcnJheSBvZiBDb3VudGVyIFNpZ25hbCBleHRlbnNpb25zCj4gICAqIEBudW1fZXh0
OgludW1iZXIgb2YgQ291bnRlciBTaWduYWwgZXh0ZW5zaW9ucyBzcGVjaWZpZWQgaW4gQGV4dAo+
IC0gKiBAcHJpdjoJb3B0aW9uYWwgcHJpdmF0ZSBkYXRhIHN1cHBsaWVkIGJ5IGRyaXZlcgo+ICAg
Ki8KPiAgc3RydWN0IGNvdW50ZXJfc2lnbmFsIHsKPiAgCWludCBpZDsKPiAgCWNvbnN0IGNoYXIg
Km5hbWU7Cj4gIAo+IC0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCAqZXh0Owo+ICsJ
c3RydWN0IGNvdW50ZXJfY29tcCAqZXh0Owo+ICAJc2l6ZV90IG51bV9leHQ7Cj4gLQo+IC0Jdm9p
ZCAqcHJpdjsKPiAtfTsKPiAtCj4gLS8qKgo+IC0gKiBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51
bV9leHQgLSBTaWduYWwgZW51bSBleHRlbnNpb24gYXR0cmlidXRlCj4gLSAqIEBpdGVtczoJQXJy
YXkgb2Ygc3RyaW5ncwo+IC0gKiBAbnVtX2l0ZW1zOglOdW1iZXIgb2YgaXRlbXMgc3BlY2lmaWVk
IGluIEBpdGVtcwo+IC0gKiBAc2V0OglTZXQgY2FsbGJhY2sgZnVuY3Rpb247IG1heSBiZSBOVUxM
Cj4gLSAqIEBnZXQ6CUdldCBjYWxsYmFjayBmdW5jdGlvbjsgbWF5IGJlIE5VTEwKPiAtICoKPiAt
ICogVGhlIGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0IHN0cnVjdHVyZSBjYW4gYmUgdXNlZCB0byBp
bXBsZW1lbnQgZW51bSBzdHlsZQo+IC0gKiBTaWduYWwgZXh0ZW5zaW9uIGF0dHJpYnV0ZXMuIEVu
dW0gc3R5bGUgYXR0cmlidXRlcyBhcmUgdGhvc2Ugd2hpY2ggaGF2ZSBhIHNldAo+IC0gKiBvZiBz
dHJpbmdzIHRoYXQgbWFwIHRvIHVuc2lnbmVkIGludGVnZXIgdmFsdWVzLiBUaGUgR2VuZXJpYyBD
b3VudGVyIFNpZ25hbAo+IC0gKiBlbnVtIGV4dGVuc2lvbiBoZWxwZXIgY29kZSB0YWtlcyBjYXJl
IG9mIG1hcHBpbmcgYmV0d2VlbiB2YWx1ZSBhbmQgc3RyaW5nLCBhcwo+IC0gKiB3ZWxsIGFzIGdl
bmVyYXRpbmcgYSAiX2F2YWlsYWJsZSIgZmlsZSB3aGljaCBjb250YWlucyBhIGxpc3Qgb2YgYWxs
IGF2YWlsYWJsZQo+IC0gKiBpdGVtcy4gVGhlIGdldCBjYWxsYmFjayBpcyB1c2VkIHRvIHF1ZXJ5
IHRoZSBjdXJyZW50bHkgYWN0aXZlIGl0ZW07IHRoZSBpbmRleAo+IC0gKiBvZiB0aGUgaXRlbSB3
aXRoaW4gdGhlIHJlc3BlY3RpdmUgaXRlbXMgYXJyYXkgaXMgcmV0dXJuZWQgdmlhIHRoZSAnaXRl
bScKPiAtICogcGFyYW1ldGVyLiBUaGUgc2V0IGNhbGxiYWNrIGlzIGNhbGxlZCB3aGVuIHRoZSBh
dHRyaWJ1dGUgaXMgdXBkYXRlZDsgdGhlCj4gLSAqICdpdGVtJyBwYXJhbWV0ZXIgY29udGFpbnMg
dGhlIGluZGV4IG9mIHRoZSBuZXdseSBhY3RpdmF0ZWQgaXRlbSB3aXRoaW4gdGhlCj4gLSAqIHJl
c3BlY3RpdmUgaXRlbXMgYXJyYXkuCj4gLSAqLwo+IC1zdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51
bV9leHQgewo+IC0JY29uc3QgY2hhciAqIGNvbnN0ICppdGVtczsKPiAtCXNpemVfdCBudW1faXRl
bXM7Cj4gLQlpbnQgKCpnZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkg
ICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90ICppdGVtKTsKPiAtCWludCAo
KnNldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+IC0JCSAgIHN0cnVjdCBjb3Vu
dGVyX3NpZ25hbCAqc2lnbmFsLCBzaXplX3QgaXRlbSk7Cj4gLX07Cj4gLQo+IC0vKioKPiAtICog
Q09VTlRFUl9TSUdOQUxfRU5VTSgpIC0gSW5pdGlhbGl6ZSBTaWduYWwgZW51bSBleHRlbnNpb24K
PiAtICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZQo+IC0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291
bnRlcl9zaWduYWxfZW51bV9leHQgc3RydWN0dXJlCj4gLSAqCj4gLSAqIFRoaXMgc2hvdWxkIHVz
dWFsbHkgYmUgdXNlZCB0b2dldGhlciB3aXRoIENPVU5URVJfU0lHTkFMX0VOVU1fQVZBSUxBQkxF
KCkKPiAtICovCj4gLSNkZWZpbmUgQ09VTlRFUl9TSUdOQUxfRU5VTShfbmFtZSwgX2UpIFwKPiAt
eyBcCj4gLQkubmFtZSA9IChfbmFtZSksIFwKPiAtCS5yZWFkID0gY291bnRlcl9zaWduYWxfZW51
bV9yZWFkLCBcCj4gLQkud3JpdGUgPSBjb3VudGVyX3NpZ25hbF9lbnVtX3dyaXRlLCBcCj4gLQku
cHJpdiA9IChfZSkgXAo+IC19Cj4gLQo+IC0vKioKPiAtICogQ09VTlRFUl9TSUdOQUxfRU5VTV9B
VkFJTEFCTEUoKSAtIEluaXRpYWxpemUgU2lnbmFsIGVudW0gYXZhaWxhYmxlIGV4dGVuc2lvbgo+
IC0gKiBAX25hbWU6CUF0dHJpYnV0ZSBuYW1lICgiX2F2YWlsYWJsZSIgd2lsbCBiZSBhcHBlbmRl
ZCB0byB0aGUgbmFtZSkKPiAtICogQF9lOgkJUG9pbnRlciB0byBhIGNvdW50ZXJfc2lnbmFsX2Vu
dW1fZXh0IHN0cnVjdHVyZQo+IC0gKgo+IC0gKiBDcmVhdGVzIGEgcmVhZCBvbmx5IGF0dHJpYnV0
ZSB0aGF0IGxpc3RzIGFsbCB0aGUgYXZhaWxhYmxlIGVudW0gaXRlbXMgaW4gYQo+IC0gKiBuZXds
aW5lIHNlcGFyYXRlZCBsaXN0LiBUaGlzIHNob3VsZCB1c3VhbGx5IGJlIHVzZWQgdG9nZXRoZXIg
d2l0aAo+IC0gKiBDT1VOVEVSX1NJR05BTF9FTlVNKCkKPiAtICovCj4gLSNkZWZpbmUgQ09VTlRF
Ul9TSUdOQUxfRU5VTV9BVkFJTEFCTEUoX25hbWUsIF9lKSBcCj4gLXsgXAo+IC0JLm5hbWUgPSAo
X25hbWUgIl9hdmFpbGFibGUiKSwgXAo+IC0JLnJlYWQgPSBjb3VudGVyX3NpZ25hbF9lbnVtX2F2
YWlsYWJsZV9yZWFkLCBcCj4gLQkucHJpdiA9IChfZSkgXAo+IC19Cj4gLQo+IC1lbnVtIGNvdW50
ZXJfc3luYXBzZV9hY3Rpb24gewo+IC0JQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FID0gMCwK
PiAtCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCj4gLQlDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKPiAtCUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9F
REdFUwo+ICB9Owo+ICAKPiAgLyoqCj4gICAqIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgLSBDb3Vu
dGVyIFN5bmFwc2Ugbm9kZQo+IC0gKiBAYWN0aW9uOgkJaW5kZXggb2YgY3VycmVudCBhY3Rpb24g
bW9kZQo+ICAgKiBAYWN0aW9uc19saXN0OglhcnJheSBvZiBhdmFpbGFibGUgYWN0aW9uIG1vZGVz
Cj4gICAqIEBudW1fYWN0aW9uczoJbnVtYmVyIG9mIGFjdGlvbiBtb2RlcyBzcGVjaWZpZWQgaW4g
QGFjdGlvbnNfbGlzdAo+ICAgKiBAc2lnbmFsOgkJcG9pbnRlciB0byBhc3NvY2lhdGVkIHNpZ25h
bAo+ICAgKi8KPiAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSB7Cj4gLQlzaXplX3QgYWN0aW9uOwo+
ICAJY29uc3QgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb25zX2xpc3Q7Cj4gIAlz
aXplX3QgbnVtX2FjdGlvbnM7Cj4gIAo+ICAJc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWw7
Cj4gIH07Cj4gIAo+IC1zdHJ1Y3QgY291bnRlcl9jb3VudDsKPiAtCj4gLS8qKgo+IC0gKiBzdHJ1
Y3QgY291bnRlcl9jb3VudF9leHQgLSBDb3VudGVyIENvdW50IGV4dGVuc2lvbgo+IC0gKiBAbmFt
ZToJYXR0cmlidXRlIG5hbWUKPiAtICogQHJlYWQ6CXJlYWQgY2FsbGJhY2sgZm9yIHRoaXMgYXR0
cmlidXRlOyBtYXkgYmUgTlVMTAo+IC0gKiBAd3JpdGU6CXdyaXRlIGNhbGxiYWNrIGZvciB0aGlz
IGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiAtICogQHByaXY6CWRhdGEgcHJpdmF0ZSB0byB0aGUg
ZHJpdmVyCj4gLSAqLwo+IC1zdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgewo+IC0JY29uc3QgY2hh
ciAqbmFtZTsKPiAtCXNzaXplX3QgKCpyZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCj4gLQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdiwgY2hhciAq
YnVmKTsKPiAtCXNzaXplX3QgKCp3cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAo+IC0JCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2LAo+IC0JCQkg
Y29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKTsKPiAtCXZvaWQgKnByaXY7Cj4gLX07Cj4gLQo+
IC1lbnVtIGNvdW50ZXJfZnVuY3Rpb24gewo+IC0JQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRSA9
IDAsCj4gLQlDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFLAo+IC0JQ09VTlRFUl9GVU5DVElPTl9Q
VUxTRV9ESVJFQ1RJT04sCj4gLQlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQSwKPiAt
CUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9CLAo+IC0JQ09VTlRFUl9GVU5DVElPTl9R
VUFEUkFUVVJFX1gyX0EsCj4gLQlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQiwKPiAt
CUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNAo+IC19Owo+IC0KPiAgLyoqCj4gICAqIHN0
cnVjdCBjb3VudGVyX2NvdW50IC0gQ291bnRlciBDb3VudCBub2RlCj4gICAqIEBpZDoJCQl1bmlx
dWUgSUQgdXNlZCB0byBpZGVudGlmeSBDb3VudAo+ICAgKiBAbmFtZToJCWRldmljZS1zcGVjaWZp
YyBDb3VudCBuYW1lOyBpZGVhbGx5LCB0aGlzIHNob3VsZCBtYXRjaAo+ICAgKgkJCXRoZSBuYW1l
IGFzIGl0IGFwcGVhcnMgaW4gdGhlIGRhdGFzaGVldCBkb2N1bWVudGF0aW9uCj4gLSAqIEBmdW5j
dGlvbjoJCWluZGV4IG9mIGN1cnJlbnQgZnVuY3Rpb24gbW9kZQo+ICAgKiBAZnVuY3Rpb25zX2xp
c3Q6CWFycmF5IGF2YWlsYWJsZSBmdW5jdGlvbiBtb2Rlcwo+ICAgKiBAbnVtX2Z1bmN0aW9uczoJ
bnVtYmVyIG9mIGZ1bmN0aW9uIG1vZGVzIHNwZWNpZmllZCBpbiBAZnVuY3Rpb25zX2xpc3QKPiAg
ICogQHN5bmFwc2VzOgkJYXJyYXkgb2Ygc3luYXBzZXMgZm9yIGluaXRpYWxpemF0aW9uCj4gICAq
IEBudW1fc3luYXBzZXM6CW51bWJlciBvZiBzeW5hcHNlcyBzcGVjaWZpZWQgaW4gQHN5bmFwc2Vz
Cj4gICAqIEBleHQ6CQlvcHRpb25hbCBhcnJheSBvZiBDb3VudGVyIENvdW50IGV4dGVuc2lvbnMK
PiAgICogQG51bV9leHQ6CQludW1iZXIgb2YgQ291bnRlciBDb3VudCBleHRlbnNpb25zIHNwZWNp
ZmllZCBpbiBAZXh0Cj4gLSAqIEBwcml2OgkJb3B0aW9uYWwgcHJpdmF0ZSBkYXRhIHN1cHBsaWVk
IGJ5IGRyaXZlcgo+ICAgKi8KPiAgc3RydWN0IGNvdW50ZXJfY291bnQgewo+ICAJaW50IGlkOwo+
ICAJY29uc3QgY2hhciAqbmFtZTsKPiAgCj4gLQlzaXplX3QgZnVuY3Rpb247Cj4gIAljb25zdCBl
bnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uc19saXN0Owo+ICAJc2l6ZV90IG51bV9mdW5j
dGlvbnM7Cj4gIAo+ICAJc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZXM7Cj4gIAlzaXpl
X3QgbnVtX3N5bmFwc2VzOwo+ICAKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCAq
ZXh0Owo+ICsJc3RydWN0IGNvdW50ZXJfY29tcCAqZXh0Owo+ICAJc2l6ZV90IG51bV9leHQ7Cj4g
LQo+IC0Jdm9pZCAqcHJpdjsKPiAtfTsKPiAtCj4gLS8qKgo+IC0gKiBzdHJ1Y3QgY291bnRlcl9j
b3VudF9lbnVtX2V4dCAtIENvdW50IGVudW0gZXh0ZW5zaW9uIGF0dHJpYnV0ZQo+IC0gKiBAaXRl
bXM6CUFycmF5IG9mIHN0cmluZ3MKPiAtICogQG51bV9pdGVtczoJTnVtYmVyIG9mIGl0ZW1zIHNw
ZWNpZmllZCBpbiBAaXRlbXMKPiAtICogQHNldDoJU2V0IGNhbGxiYWNrIGZ1bmN0aW9uOyBtYXkg
YmUgTlVMTAo+IC0gKiBAZ2V0OglHZXQgY2FsbGJhY2sgZnVuY3Rpb247IG1heSBiZSBOVUxMCj4g
LSAqCj4gLSAqIFRoZSBjb3VudGVyX2NvdW50X2VudW1fZXh0IHN0cnVjdHVyZSBjYW4gYmUgdXNl
ZCB0byBpbXBsZW1lbnQgZW51bSBzdHlsZQo+IC0gKiBDb3VudCBleHRlbnNpb24gYXR0cmlidXRl
cy4gRW51bSBzdHlsZSBhdHRyaWJ1dGVzIGFyZSB0aG9zZSB3aGljaCBoYXZlIGEgc2V0Cj4gLSAq
IG9mIHN0cmluZ3MgdGhhdCBtYXAgdG8gdW5zaWduZWQgaW50ZWdlciB2YWx1ZXMuIFRoZSBHZW5l
cmljIENvdW50ZXIgQ291bnQKPiAtICogZW51bSBleHRlbnNpb24gaGVscGVyIGNvZGUgdGFrZXMg
Y2FyZSBvZiBtYXBwaW5nIGJldHdlZW4gdmFsdWUgYW5kIHN0cmluZywgYXMKPiAtICogd2VsbCBh
cyBnZW5lcmF0aW5nIGEgIl9hdmFpbGFibGUiIGZpbGUgd2hpY2ggY29udGFpbnMgYSBsaXN0IG9m
IGFsbCBhdmFpbGFibGUKPiAtICogaXRlbXMuIFRoZSBnZXQgY2FsbGJhY2sgaXMgdXNlZCB0byBx
dWVyeSB0aGUgY3VycmVudGx5IGFjdGl2ZSBpdGVtOyB0aGUgaW5kZXgKPiAtICogb2YgdGhlIGl0
ZW0gd2l0aGluIHRoZSByZXNwZWN0aXZlIGl0ZW1zIGFycmF5IGlzIHJldHVybmVkIHZpYSB0aGUg
J2l0ZW0nCj4gLSAqIHBhcmFtZXRlci4gVGhlIHNldCBjYWxsYmFjayBpcyBjYWxsZWQgd2hlbiB0
aGUgYXR0cmlidXRlIGlzIHVwZGF0ZWQ7IHRoZQo+IC0gKiAnaXRlbScgcGFyYW1ldGVyIGNvbnRh
aW5zIHRoZSBpbmRleCBvZiB0aGUgbmV3bHkgYWN0aXZhdGVkIGl0ZW0gd2l0aGluIHRoZQo+IC0g
KiByZXNwZWN0aXZlIGl0ZW1zIGFycmF5Lgo+IC0gKi8KPiAtc3RydWN0IGNvdW50ZXJfY291bnRf
ZW51bV9leHQgewo+IC0JY29uc3QgY2hhciAqIGNvbnN0ICppdGVtczsKPiAtCXNpemVfdCBudW1f
aXRlbXM7Cj4gLQlpbnQgKCpnZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAo+IC0JCSAgIHNpemVfdCAqaXRlbSk7Cj4gLQlpbnQg
KCpzZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAo+IC0JCSAgIHNpemVfdCBpdGVtKTsKPiAtfTsKPiAtCj4gLS8qKgo+IC0gKiBD
T1VOVEVSX0NPVU5UX0VOVU0oKSAtIEluaXRpYWxpemUgQ291bnQgZW51bSBleHRlbnNpb24KPiAt
ICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZQo+IC0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRl
cl9jb3VudF9lbnVtX2V4dCBzdHJ1Y3R1cmUKPiAtICoKPiAtICogVGhpcyBzaG91bGQgdXN1YWxs
eSBiZSB1c2VkIHRvZ2V0aGVyIHdpdGggQ09VTlRFUl9DT1VOVF9FTlVNX0FWQUlMQUJMRSgpCj4g
LSAqLwo+IC0jZGVmaW5lIENPVU5URVJfQ09VTlRfRU5VTShfbmFtZSwgX2UpIFwKPiAteyBcCj4g
LQkubmFtZSA9IChfbmFtZSksIFwKPiAtCS5yZWFkID0gY291bnRlcl9jb3VudF9lbnVtX3JlYWQs
IFwKPiAtCS53cml0ZSA9IGNvdW50ZXJfY291bnRfZW51bV93cml0ZSwgXAo+IC0JLnByaXYgPSAo
X2UpIFwKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIENPVU5URVJfQ09VTlRfRU5VTV9BVkFJTEFCTEUo
KSAtIEluaXRpYWxpemUgQ291bnQgZW51bSBhdmFpbGFibGUgZXh0ZW5zaW9uCj4gLSAqIEBfbmFt
ZToJQXR0cmlidXRlIG5hbWUgKCJfYXZhaWxhYmxlIiB3aWxsIGJlIGFwcGVuZGVkIHRvIHRoZSBu
YW1lKQo+IC0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRlcl9jb3VudF9lbnVtX2V4dCBzdHJ1
Y3R1cmUKPiAtICoKPiAtICogQ3JlYXRlcyBhIHJlYWQgb25seSBhdHRyaWJ1dGUgdGhhdCBsaXN0
cyBhbGwgdGhlIGF2YWlsYWJsZSBlbnVtIGl0ZW1zIGluIGEKPiAtICogbmV3bGluZSBzZXBhcmF0
ZWQgbGlzdC4gVGhpcyBzaG91bGQgdXN1YWxseSBiZSB1c2VkIHRvZ2V0aGVyIHdpdGgKPiAtICog
Q09VTlRFUl9DT1VOVF9FTlVNKCkKPiAtICovCj4gLSNkZWZpbmUgQ09VTlRFUl9DT1VOVF9FTlVN
X0FWQUlMQUJMRShfbmFtZSwgX2UpIFwKPiAteyBcCj4gLQkubmFtZSA9IChfbmFtZSAiX2F2YWls
YWJsZSIpLCBcCj4gLQkucmVhZCA9IGNvdW50ZXJfY291bnRfZW51bV9hdmFpbGFibGVfcmVhZCwg
XAo+IC0JLnByaXYgPSAoX2UpIFwKPiAtfQo+IC0KPiAtLyoqCj4gLSAqIHN0cnVjdCBjb3VudGVy
X2RldmljZV9hdHRyX2dyb3VwIC0gaW50ZXJuYWwgY29udGFpbmVyIGZvciBhdHRyaWJ1dGUgZ3Jv
dXAKPiAtICogQGF0dHJfZ3JvdXA6CUNvdW50ZXIgc3lzZnMgYXR0cmlidXRlcyBncm91cAo+IC0g
KiBAYXR0cl9saXN0OglsaXN0IHRvIGtlZXAgdHJhY2sgb2YgY3JlYXRlZCBDb3VudGVyIHN5c2Zz
IGF0dHJpYnV0ZXMKPiAtICogQG51bV9hdHRyOgludW1iZXIgb2YgQ291bnRlciBzeXNmcyBhdHRy
aWJ1dGVzCj4gLSAqLwo+IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCB7Cj4gLQlz
dHJ1Y3QgYXR0cmlidXRlX2dyb3VwIGF0dHJfZ3JvdXA7Cj4gLQlzdHJ1Y3QgbGlzdF9oZWFkIGF0
dHJfbGlzdDsKPiAtCXNpemVfdCBudW1fYXR0cjsKPiAtfTsKPiAtCj4gLS8qKgo+IC0gKiBzdHJ1
Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgLSBpbnRlcm5hbCBzdGF0ZSBjb250YWluZXIgZm9yIGEg
Q291bnRlciBkZXZpY2UKPiAtICogQGlkOgkJCXVuaXF1ZSBJRCB1c2VkIHRvIGlkZW50aWZ5IHRo
ZSBDb3VudGVyCj4gLSAqIEBkZXY6CQlpbnRlcm5hbCBkZXZpY2Ugc3RydWN0dXJlCj4gLSAqIEBn
cm91cHNfbGlzdDoJYXR0cmlidXRlIGdyb3VwcyBsaXN0IChmb3IgU2lnbmFscywgQ291bnRzLCBh
bmQgZXh0KQo+IC0gKiBAbnVtX2dyb3VwczoJCW51bWJlciBvZiBhdHRyaWJ1dGUgZ3JvdXBzIGNv
bnRhaW5lcnMKPiAtICogQGdyb3VwczoJCUNvdW50ZXIgc3lzZnMgYXR0cmlidXRlIGdyb3VwcyAo
dG8gcG9wdWxhdGUgQGRldi5ncm91cHMpCj4gLSAqLwo+IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2Vf
c3RhdGUgewo+IC0JaW50IGlkOwo+IC0Jc3RydWN0IGRldmljZSBkZXY7Cj4gLQlzdHJ1Y3QgY291
bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqZ3JvdXBzX2xpc3Q7Cj4gLQlzaXplX3QgbnVtX2dyb3Vw
czsKPiAtCWNvbnN0IHN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgKipncm91cHM7Cj4gLX07Cj4gLQo+
IC1lbnVtIGNvdW50ZXJfc2lnbmFsX2xldmVsIHsKPiAtCUNPVU5URVJfU0lHTkFMX0xFVkVMX0xP
VywKPiAtCUNPVU5URVJfU0lHTkFMX0xFVkVMX0hJR0gsCj4gIH07Cj4gIAo+ICAvKioKPiBAQCAt
MzA2LDExNyArMjUyLDQ3IEBAIGVudW0gY291bnRlcl9zaWduYWxfbGV2ZWwgewo+ICAgKiBAY291
bnRfd3JpdGU6CW9wdGlvbmFsIHdyaXRlIGNhbGxiYWNrIGZvciBDb3VudCBhdHRyaWJ1dGUuIFRo
ZSB3cml0ZQo+ICAgKgkJCXZhbHVlIGZvciB0aGUgcmVzcGVjdGl2ZSBDb3VudCBpcyBwYXNzZWQg
aW4gdmlhIHRoZSB2YWwKPiAgICoJCQlwYXJhbWV0ZXIuCj4gLSAqIEBmdW5jdGlvbl9nZXQ6CWZ1
bmN0aW9uIHRvIGdldCB0aGUgY3VycmVudCBjb3VudCBmdW5jdGlvbiBtb2RlLiBSZXR1cm5zCj4g
LSAqCQkJMCBvbiBzdWNjZXNzIGFuZCBuZWdhdGl2ZSBlcnJvciBjb2RlIG9uIGVycm9yLiBUaGUg
aW5kZXgKPiAtICoJCQlvZiB0aGUgcmVzcGVjdGl2ZSBDb3VudCdzIHJldHVybmVkIGZ1bmN0aW9u
IG1vZGUgc2hvdWxkCj4gLSAqCQkJYmUgcGFzc2VkIGJhY2sgdmlhIHRoZSBmdW5jdGlvbiBwYXJh
bWV0ZXIuCj4gLSAqIEBmdW5jdGlvbl9zZXQ6CWZ1bmN0aW9uIHRvIHNldCB0aGUgY291bnQgZnVu
Y3Rpb24gbW9kZS4gZnVuY3Rpb24gaXMgdGhlCj4gLSAqCQkJaW5kZXggb2YgdGhlIHJlcXVlc3Rl
ZCBmdW5jdGlvbiBtb2RlIGZyb20gdGhlIHJlc3BlY3RpdmUKPiAtICoJCQlDb3VudCdzIGZ1bmN0
aW9uc19saXN0IGFycmF5Lgo+IC0gKiBAYWN0aW9uX2dldDoJCWZ1bmN0aW9uIHRvIGdldCB0aGUg
Y3VycmVudCBhY3Rpb24gbW9kZS4gUmV0dXJucyAwIG9uCj4gLSAqCQkJc3VjY2VzcyBhbmQgbmVn
YXRpdmUgZXJyb3IgY29kZSBvbiBlcnJvci4gVGhlIGluZGV4IG9mCj4gLSAqCQkJdGhlIHJlc3Bl
Y3RpdmUgU3luYXBzZSdzIHJldHVybmVkIGFjdGlvbiBtb2RlIHNob3VsZCBiZQo+IC0gKgkJCXBh
c3NlZCBiYWNrIHZpYSB0aGUgYWN0aW9uIHBhcmFtZXRlci4KPiAtICogQGFjdGlvbl9zZXQ6CQlm
dW5jdGlvbiB0byBzZXQgdGhlIGFjdGlvbiBtb2RlLiBhY3Rpb24gaXMgdGhlIGluZGV4IG9mCj4g
LSAqCQkJdGhlIHJlcXVlc3RlZCBhY3Rpb24gbW9kZSBmcm9tIHRoZSByZXNwZWN0aXZlIFN5bmFw
c2Uncwo+IC0gKgkJCWFjdGlvbnNfbGlzdCBhcnJheS4KPiArICogQGZ1bmN0aW9uX3JlYWQ6CXJl
YWQgY2FsbGJhY2sgdGhlIENvdW50IGZ1bmN0aW9uIG1vZGVzLiBUaGUgcmVhZAo+ICsgKgkJCWZ1
bmN0aW9uIG1vZGUgb2YgdGhlIHJlc3BlY3RpdmUgQ291bnQgc2hvdWxkIGJlIHBhc3NlZAo+ICsg
KgkJCWJhY2sgdmlhIHRoZSBmdW5jdGlvbiBwYXJhbWV0ZXIuCj4gKyAqIEBmdW5jdGlvbl93cml0
ZToJd3JpdGUgY2FsbGJhY2sgZm9yIENvdW50IGZ1bmN0aW9uIG1vZGVzLiBUaGUgZnVuY3Rpb24K
PiArICoJCQltb2RlIHRvIHdyaXRlIGZvciB0aGUgcmVzcGVjdGl2ZSBDb3VudCBpcyBwYXNzZWQg
aW4gdmlhCj4gKyAqCQkJdGhlIGZ1bmN0aW9uIHBhcmFtZXRlci4KPiArICogQGFjdGlvbl9yZWFk
OglyZWFkIGNhbGxiYWNrIHRoZSBTeW5hcHNlIGFjdGlvbiBtb2Rlcy4gVGhlIHJlYWQgYWN0aW9u
Cj4gKyAqCQkJbW9kZSBvZiB0aGUgcmVzcGVjdGl2ZSBTeW5hcHNlIHNob3VsZCBiZSBwYXNzZWQg
YmFjayB2aWEKPiArICoJCQl0aGUgYWN0aW9uIHBhcmFtZXRlci4KPiArICogQGFjdGlvbl93cml0
ZToJd3JpdGUgY2FsbGJhY2sgZm9yIFN5bmFwc2UgYWN0aW9uIG1vZGVzLiBUaGUgYWN0aW9uIG1v
ZGUKPiArICoJCQl0byB3cml0ZSBmb3IgdGhlIHJlc3BlY3RpdmUgU3luYXBzZSBpcyBwYXNzZWQg
aW4gdmlhIHRoZQo+ICsgKgkJCWFjdGlvbiBwYXJhbWV0ZXIuCj4gICAqLwo+ICBzdHJ1Y3QgY291
bnRlcl9vcHMgewo+ICAJaW50ICgqc2lnbmFsX3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKPiAgCQkJICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCj4gIAkJCSAg
IGVudW0gY291bnRlcl9zaWduYWxfbGV2ZWwgKmxldmVsKTsKPiAgCWludCAoKmNvdW50X3JlYWQp
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsIHVuc2lnbmVkIGxvbmcgKnZhbCk7Cj4gKwkJCSAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LCB1NjQgKnZhbHVlKTsKPiAgCWludCAoKmNvdW50X3dyaXRlKShzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpj
b3VudCwgdW5zaWduZWQgbG9uZyB2YWwpOwo+IC0JaW50ICgqZnVuY3Rpb25fZ2V0KShzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHNpemVfdCAqZnVuY3Rpb24pOwo+IC0JaW50ICgqZnVuY3Rpb25fc2V0KShzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHNpemVfdCBmdW5jdGlvbik7Cj4gLQlpbnQgKCphY3Rpb25fZ2V0KShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LAo+IC0JCQkgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsIHNpemVfdCAqYWN0aW9u
KTsKPiAtCWludCAoKmFjdGlvbl9zZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
PiAtCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gLQkJCSAgc3RydWN0IGNvdW50
ZXJfc3luYXBzZSAqc3luYXBzZSwgc2l6ZV90IGFjdGlvbik7Cj4gLX07Cj4gLQo+IC0vKioKPiAt
ICogc3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4dCAtIENvdW50ZXIgZGV2aWNlIGV4dGVuc2lvbgo+
IC0gKiBAbmFtZToJYXR0cmlidXRlIG5hbWUKPiAtICogQHJlYWQ6CXJlYWQgY2FsbGJhY2sgZm9y
IHRoaXMgYXR0cmlidXRlOyBtYXkgYmUgTlVMTAo+IC0gKiBAd3JpdGU6CXdyaXRlIGNhbGxiYWNr
IGZvciB0aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKPiAtICogQHByaXY6CWRhdGEgcHJpdmF0
ZSB0byB0aGUgZHJpdmVyCj4gLSAqLwo+IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2VfZXh0IHsKPiAt
CWNvbnN0IGNoYXIgKm5hbWU7Cj4gLQlzc2l6ZV90ICgqcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLCB2b2lkICpwcml2LCBjaGFyICpidWYpOwo+IC0Jc3NpemVfdCAoKndyaXRl
KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHZvaWQgKnByaXYsCj4gLQkJCSBjb25z
dCBjaGFyICpidWYsIHNpemVfdCBsZW4pOwo+IC0Jdm9pZCAqcHJpdjsKPiArCQkJICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgdmFsdWUpOwo+ICsJaW50ICgqZnVuY3Rpb25fcmVh
ZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAo+ICsJCQkgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKPiArCQkJICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0
aW9uKTsKPiArCWludCAoKmZ1bmN0aW9uX3dyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCj4gKwkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiArCQkJICAg
ICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uKTsKPiArCWludCAoKmFjdGlvbl9yZWFk
KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCSAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKPiArCQkJICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwK
PiArCQkJICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rpb24pOwo+ICsJaW50ICgq
YWN0aW9uX3dyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gKwkJCSAgICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCj4gKwkJCSAgICBzdHJ1Y3QgY291bnRlcl9zeW5h
cHNlICpzeW5hcHNlLAo+ICsJCQkgICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlv
bik7Cj4gIH07Cj4gIAo+IC0vKioKPiAtICogc3RydWN0IGNvdW50ZXJfZGV2aWNlX2VudW1fZXh0
IC0gQ291bnRlciBlbnVtIGV4dGVuc2lvbiBhdHRyaWJ1dGUKPiAtICogQGl0ZW1zOglBcnJheSBv
ZiBzdHJpbmdzCj4gLSAqIEBudW1faXRlbXM6CU51bWJlciBvZiBpdGVtcyBzcGVjaWZpZWQgaW4g
QGl0ZW1zCj4gLSAqIEBzZXQ6CVNldCBjYWxsYmFjayBmdW5jdGlvbjsgbWF5IGJlIE5VTEwKPiAt
ICogQGdldDoJR2V0IGNhbGxiYWNrIGZ1bmN0aW9uOyBtYXkgYmUgTlVMTAo+IC0gKgo+IC0gKiBU
aGUgY291bnRlcl9kZXZpY2VfZW51bV9leHQgc3RydWN0dXJlIGNhbiBiZSB1c2VkIHRvIGltcGxl
bWVudCBlbnVtIHN0eWxlCj4gLSAqIENvdW50ZXIgZXh0ZW5zaW9uIGF0dHJpYnV0ZXMuIEVudW0g
c3R5bGUgYXR0cmlidXRlcyBhcmUgdGhvc2Ugd2hpY2ggaGF2ZSBhCj4gLSAqIHNldCBvZiBzdHJp
bmdzIHRoYXQgbWFwIHRvIHVuc2lnbmVkIGludGVnZXIgdmFsdWVzLiBUaGUgR2VuZXJpYyBDb3Vu
dGVyIGVudW0KPiAtICogZXh0ZW5zaW9uIGhlbHBlciBjb2RlIHRha2VzIGNhcmUgb2YgbWFwcGlu
ZyBiZXR3ZWVuIHZhbHVlIGFuZCBzdHJpbmcsIGFzIHdlbGwKPiAtICogYXMgZ2VuZXJhdGluZyBh
ICJfYXZhaWxhYmxlIiBmaWxlIHdoaWNoIGNvbnRhaW5zIGEgbGlzdCBvZiBhbGwgYXZhaWxhYmxl
Cj4gLSAqIGl0ZW1zLiBUaGUgZ2V0IGNhbGxiYWNrIGlzIHVzZWQgdG8gcXVlcnkgdGhlIGN1cnJl
bnRseSBhY3RpdmUgaXRlbTsgdGhlIGluZGV4Cj4gLSAqIG9mIHRoZSBpdGVtIHdpdGhpbiB0aGUg
cmVzcGVjdGl2ZSBpdGVtcyBhcnJheSBpcyByZXR1cm5lZCB2aWEgdGhlICdpdGVtJwo+IC0gKiBw
YXJhbWV0ZXIuIFRoZSBzZXQgY2FsbGJhY2sgaXMgY2FsbGVkIHdoZW4gdGhlIGF0dHJpYnV0ZSBp
cyB1cGRhdGVkOyB0aGUKPiAtICogJ2l0ZW0nIHBhcmFtZXRlciBjb250YWlucyB0aGUgaW5kZXgg
b2YgdGhlIG5ld2x5IGFjdGl2YXRlZCBpdGVtIHdpdGhpbiB0aGUKPiAtICogcmVzcGVjdGl2ZSBp
dGVtcyBhcnJheS4KPiAtICovCj4gLXN0cnVjdCBjb3VudGVyX2RldmljZV9lbnVtX2V4dCB7Cj4g
LQljb25zdCBjaGFyICogY29uc3QgKml0ZW1zOwo+IC0Jc2l6ZV90IG51bV9pdGVtczsKPiAtCWlu
dCAoKmdldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCBzaXplX3QgKml0ZW0pOwo+
IC0JaW50ICgqc2V0KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHNpemVfdCBpdGVt
KTsKPiAtfTsKPiAtCj4gLS8qKgo+IC0gKiBDT1VOVEVSX0RFVklDRV9FTlVNKCkgLSBJbml0aWFs
aXplIENvdW50ZXIgZW51bSBleHRlbnNpb24KPiAtICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZQo+
IC0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRlcl9kZXZpY2VfZW51bV9leHQgc3RydWN0dXJl
Cj4gLSAqCj4gLSAqIFRoaXMgc2hvdWxkIHVzdWFsbHkgYmUgdXNlZCB0b2dldGhlciB3aXRoIENP
VU5URVJfREVWSUNFX0VOVU1fQVZBSUxBQkxFKCkKPiAtICovCj4gLSNkZWZpbmUgQ09VTlRFUl9E
RVZJQ0VfRU5VTShfbmFtZSwgX2UpIFwKPiAteyBcCj4gLQkubmFtZSA9IChfbmFtZSksIFwKPiAt
CS5yZWFkID0gY291bnRlcl9kZXZpY2VfZW51bV9yZWFkLCBcCj4gLQkud3JpdGUgPSBjb3VudGVy
X2RldmljZV9lbnVtX3dyaXRlLCBcCj4gLQkucHJpdiA9IChfZSkgXAo+IC19Cj4gLQo+IC0vKioK
PiAtICogQ09VTlRFUl9ERVZJQ0VfRU5VTV9BVkFJTEFCTEUoKSAtIEluaXRpYWxpemUgQ291bnRl
ciBlbnVtIGF2YWlsYWJsZSBleHRlbnNpb24KPiAtICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZSAo
Il9hdmFpbGFibGUiIHdpbGwgYmUgYXBwZW5kZWQgdG8gdGhlIG5hbWUpCj4gLSAqIEBfZToJCVBv
aW50ZXIgdG8gYSBjb3VudGVyX2RldmljZV9lbnVtX2V4dCBzdHJ1Y3R1cmUKPiAtICoKPiAtICog
Q3JlYXRlcyBhIHJlYWQgb25seSBhdHRyaWJ1dGUgdGhhdCBsaXN0cyBhbGwgdGhlIGF2YWlsYWJs
ZSBlbnVtIGl0ZW1zIGluIGEKPiAtICogbmV3bGluZSBzZXBhcmF0ZWQgbGlzdC4gVGhpcyBzaG91
bGQgdXN1YWxseSBiZSB1c2VkIHRvZ2V0aGVyIHdpdGgKPiAtICogQ09VTlRFUl9ERVZJQ0VfRU5V
TSgpCj4gLSAqLwo+IC0jZGVmaW5lIENPVU5URVJfREVWSUNFX0VOVU1fQVZBSUxBQkxFKF9uYW1l
LCBfZSkgXAo+IC17IFwKPiAtCS5uYW1lID0gKF9uYW1lICJfYXZhaWxhYmxlIiksIFwKPiAtCS5y
ZWFkID0gY291bnRlcl9kZXZpY2VfZW51bV9hdmFpbGFibGVfcmVhZCwgXAo+IC0JLnByaXYgPSAo
X2UpIFwKPiAtfQo+IC0KPiAgLyoqCj4gICAqIHN0cnVjdCBjb3VudGVyX2RldmljZSAtIENvdW50
ZXIgZGF0YSBzdHJ1Y3R1cmUKPiAgICogQG5hbWU6CQluYW1lIG9mIHRoZSBkZXZpY2UgYXMgaXQg
YXBwZWFycyBpbiB0aGUgZGF0YXNoZWV0Cj4gICAqIEBwYXJlbnQ6CQlvcHRpb25hbCBwYXJlbnQg
ZGV2aWNlIHByb3ZpZGluZyB0aGUgY291bnRlcnMKPiAtICogQGRldmljZV9zdGF0ZToJaW50ZXJu
YWwgZGV2aWNlIHN0YXRlIGNvbnRhaW5lcgo+ICAgKiBAb3BzOgkJY2FsbGJhY2tzIGZyb20gZHJp
dmVyCj4gICAqIEBzaWduYWxzOgkJYXJyYXkgb2YgU2lnbmFscwo+ICAgKiBAbnVtX3NpZ25hbHM6
CW51bWJlciBvZiBTaWduYWxzIHNwZWNpZmllZCBpbiBAc2lnbmFscwo+IEBAIC00MjUsMTEgKzMw
MSwxMSBAQCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfZW51bV9leHQgewo+ICAgKiBAZXh0OgkJb3B0
aW9uYWwgYXJyYXkgb2YgQ291bnRlciBkZXZpY2UgZXh0ZW5zaW9ucwo+ICAgKiBAbnVtX2V4dDoJ
CW51bWJlciBvZiBDb3VudGVyIGRldmljZSBleHRlbnNpb25zIHNwZWNpZmllZCBpbiBAZXh0Cj4g
ICAqIEBwcml2OgkJb3B0aW9uYWwgcHJpdmF0ZSBkYXRhIHN1cHBsaWVkIGJ5IGRyaXZlcgo+ICsg
KiBAZGV2OgkJaW50ZXJuYWwgZGV2aWNlIHN0cnVjdHVyZQo+ICAgKi8KPiAgc3RydWN0IGNvdW50
ZXJfZGV2aWNlIHsKPiAgCWNvbnN0IGNoYXIgKm5hbWU7Cj4gIAlzdHJ1Y3QgZGV2aWNlICpwYXJl
bnQ7Cj4gLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgKmRldmljZV9zdGF0ZTsKPiAgCj4g
IAljb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgKm9wczsKPiAgCj4gQEAgLTQzOCwxNyArMzE0LDE1
OSBAQCBzdHJ1Y3QgY291bnRlcl9kZXZpY2Ugewo+ICAJc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50czsKPiAgCXNpemVfdCBudW1fY291bnRzOwo+ICAKPiAtCWNvbnN0IHN0cnVjdCBjb3VudGVy
X2RldmljZV9leHQgKmV4dDsKPiArCXN0cnVjdCBjb3VudGVyX2NvbXAgKmV4dDsKPiAgCXNpemVf
dCBudW1fZXh0Owo+ICAKPiAgCXZvaWQgKnByaXY7Cj4gKwo+ICsJc3RydWN0IGRldmljZSBkZXY7
Cj4gIH07Cj4gIAo+ICBpbnQgY291bnRlcl9yZWdpc3RlcihzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvbnN0IGNvdW50ZXIpOwo+ICB2b2lkIGNvdW50ZXJfdW5yZWdpc3RlcihzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpOwo+ICBpbnQgZGV2bV9jb3VudGVyX3JlZ2lzdGVyKHN0
cnVjdCBkZXZpY2UgKmRldiwKPiAgCQkJICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNv
dW50ZXIpOwo+IC12b2lkIGRldm1fY291bnRlcl91bnJlZ2lzdGVyKHN0cnVjdCBkZXZpY2UgKmRl
diwKPiAtCQkJICAgICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpOwo+ICsK
PiArI2RlZmluZSBDT1VOVEVSX0NPTVBfREVWSUNFX1U4KF9uYW1lLCBfcmVhZCwgX3dyaXRlKSBc
Cj4gK3sgXAo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfVTgsIFwKPiArCS5uYW1lID0gKF9uYW1l
KSwgXAo+ICsJLmRldmljZV91OF9yZWFkID0gKF9yZWFkKSwgXAo+ICsJLmRldmljZV91OF93cml0
ZSA9IChfd3JpdGUpLCBcCj4gK30KPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfQ09VTlRfVTgoX25h
bWUsIF9yZWFkLCBfd3JpdGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9VOCwg
XAo+ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gKwkuY291bnRfdThfcmVhZCA9IChfcmVhZCksIFwK
PiArCS5jb3VudF91OF93cml0ZSA9IChfd3JpdGUpLCBcCj4gK30KPiArI2RlZmluZSBDT1VOVEVS
X0NPTVBfU0lHTkFMX1U4KF9uYW1lLCBfcmVhZCwgX3dyaXRlKSBcCj4gK3sgXAo+ICsJLnR5cGUg
PSBDT1VOVEVSX0NPTVBfVTgsIFwKPiArCS5uYW1lID0gKF9uYW1lKSwgXAo+ICsJLnNpZ25hbF91
OF9yZWFkID0gKF9yZWFkKSwgXAo+ICsJLnNpZ25hbF91OF93cml0ZSA9IChfd3JpdGUpLCBcCj4g
K30KPiArCj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX0RFVklDRV9VNjQoX25hbWUsIF9yZWFkLCBf
d3JpdGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9VNjQsIFwKPiArCS5uYW1l
ID0gKF9uYW1lKSwgXAo+ICsJLmRldmljZV91NjRfcmVhZCA9IChfcmVhZCksIFwKPiArCS5kZXZp
Y2VfdTY0X3dyaXRlID0gKF93cml0ZSksIFwKPiArfQo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9D
T1VOVF9VNjQoX25hbWUsIF9yZWFkLCBfd3JpdGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5U
RVJfQ09NUF9VNjQsIFwKPiArCS5uYW1lID0gKF9uYW1lKSwgXAo+ICsJLmNvdW50X3U2NF9yZWFk
ID0gKF9yZWFkKSwgXAo+ICsJLmNvdW50X3U2NF93cml0ZSA9IChfd3JpdGUpLCBcCj4gK30KPiAr
I2RlZmluZSBDT1VOVEVSX0NPTVBfU0lHTkFMX1U2NChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+
ICt7IFwKPiArCS50eXBlID0gQ09VTlRFUl9DT01QX1U2NCwgXAo+ICsJLm5hbWUgPSAoX25hbWUp
LCBcCj4gKwkuc2lnbmFsX3U2NF9yZWFkID0gKF9yZWFkKSwgXAo+ICsJLnNpZ25hbF91NjRfd3Jp
dGUgPSAoX3dyaXRlKSwgXAo+ICt9Cj4gKwo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9ERVZJQ0Vf
Qk9PTChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ICt7IFwKPiArCS50eXBlID0gQ09VTlRFUl9D
T01QX0JPT0wsIFwKPiArCS5uYW1lID0gKF9uYW1lKSwgXAo+ICsJLmRldmljZV91OF9yZWFkID0g
KF9yZWFkKSwgXAo+ICsJLmRldmljZV91OF93cml0ZSA9IChfd3JpdGUpLCBcCj4gK30KPiArI2Rl
ZmluZSBDT1VOVEVSX0NPTVBfQ09VTlRfQk9PTChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAo+ICt7
IFwKPiArCS50eXBlID0gQ09VTlRFUl9DT01QX0JPT0wsIFwKPiArCS5uYW1lID0gKF9uYW1lKSwg
XAo+ICsJLmNvdW50X3U4X3JlYWQgPSAoX3JlYWQpLCBcCj4gKwkuY291bnRfdThfd3JpdGUgPSAo
X3dyaXRlKSwgXAo+ICt9Cj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX1NJR05BTF9CT09MKF9uYW1l
LCBfcmVhZCwgX3dyaXRlKSBcCj4gK3sgXAo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfQk9PTCwg
XAo+ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gKwkuc2lnbmFsX3U4X3JlYWQgPSAoX3JlYWQpLCBc
Cj4gKwkuc2lnbmFsX3U4X3dyaXRlID0gKF93cml0ZSksIFwKPiArfQo+ICsKPiArc3RydWN0IGNv
dW50ZXJfYXZhaWxhYmxlIHsKPiArCXVuaW9uIHsKPiArCQljb25zdCB1MzIgKmVudW1zOwo+ICsJ
CWNvbnN0IGNoYXIgKmNvbnN0ICpzdHJzOwo+ICsJfTsKPiArCXNpemVfdCBudW1faXRlbXM7Cj4g
K307Cj4gKwo+ICsjZGVmaW5lIERFRklORV9DT1VOVEVSX0FWQUlMQUJMRShfbmFtZSwgX2VudW1z
KSBcCj4gKwlzdHJ1Y3QgY291bnRlcl9hdmFpbGFibGUgX25hbWUgPSB7IFwKPiArCQkuZW51bXMg
PSAoX2VudW1zKSwgXAo+ICsJCS5udW1faXRlbXMgPSBBUlJBWV9TSVpFKF9lbnVtcyksIFwKPiAr
CX0KPiArCj4gKyNkZWZpbmUgREVGSU5FX0NPVU5URVJfRU5VTShfbmFtZSwgX3N0cnMpIFwKPiAr
CXN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSBfbmFtZSA9IHsgXAo+ICsJCS5zdHJzID0gKF9zdHJz
KSwgXAo+ICsJCS5udW1faXRlbXMgPSBBUlJBWV9TSVpFKF9zdHJzKSwgXAo+ICsJfQo+ICsKPiAr
I2RlZmluZSBDT1VOVEVSX0NPTVBfREVWSUNFX0VOVU0oX25hbWUsIF9nZXQsIF9zZXQsIF9hdmFp
bGFibGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9FTlVNLCBcCj4gKwkubmFt
ZSA9IChfbmFtZSksIFwKPiArCS5kZXZpY2VfdTMyX3JlYWQgPSAoX2dldCksIFwKPiArCS5kZXZp
Y2VfdTMyX3dyaXRlID0gKF9zZXQpLCBcCj4gKwkucHJpdiA9ICYoX2F2YWlsYWJsZSksIFwKPiAr
fQo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9DT1VOVF9FTlVNKF9uYW1lLCBfZ2V0LCBfc2V0LCBf
YXZhaWxhYmxlKSBcCj4gK3sgXAo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfRU5VTSwgXAo+ICsJ
Lm5hbWUgPSAoX25hbWUpLCBcCj4gKwkuY291bnRfdTMyX3JlYWQgPSAoX2dldCksIFwKPiArCS5j
b3VudF91MzJfd3JpdGUgPSAoX3NldCksIFwKPiArCS5wcml2ID0gJihfYXZhaWxhYmxlKSwgXAo+
ICt9Cj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX1NJR05BTF9FTlVNKF9uYW1lLCBfZ2V0LCBfc2V0
LCBfYXZhaWxhYmxlKSBcCj4gK3sgXAo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfRU5VTSwgXAo+
ICsJLm5hbWUgPSAoX25hbWUpLCBcCj4gKwkuc2lnbmFsX3UzMl9yZWFkID0gKF9nZXQpLCBcCj4g
Kwkuc2lnbmFsX3UzMl93cml0ZSA9IChfc2V0KSwgXAo+ICsJLnByaXYgPSAmKF9hdmFpbGFibGUp
LCBcCj4gK30KPiArCj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX0NFSUxJTkcoX3JlYWQsIF93cml0
ZSkgXAo+ICsJQ09VTlRFUl9DT01QX0NPVU5UX1U2NCgiY2VpbGluZyIsIF9yZWFkLCBfd3JpdGUp
Cj4gKwo+ICsjZGVmaW5lIENPVU5URVJfQ09NUF9DT1VOVF9NT0RFKF9yZWFkLCBfd3JpdGUsIF9h
dmFpbGFibGUpIFwKPiAreyBcCj4gKwkudHlwZSA9IENPVU5URVJfQ09NUF9DT1VOVF9NT0RFLCBc
Cj4gKwkubmFtZSA9ICJjb3VudF9tb2RlIiwgXAo+ICsJLmNvdW50X3UzMl9yZWFkID0gKF9yZWFk
KSwgXAo+ICsJLmNvdW50X3UzMl93cml0ZSA9IChfd3JpdGUpLCBcCj4gKwkucHJpdiA9ICYoX2F2
YWlsYWJsZSksIFwKPiArfQo+ICsKPiArI2RlZmluZSBDT1VOVEVSX0NPTVBfRElSRUNUSU9OKF9y
ZWFkKSBcCj4gK3sgXAo+ICsJLnR5cGUgPSBDT1VOVEVSX0NPTVBfQ09VTlRfRElSRUNUSU9OLCBc
Cj4gKwkubmFtZSA9ICJkaXJlY3Rpb24iLCBcCj4gKwkuY291bnRfdTMyX3JlYWQgPSAoX3JlYWQp
LCBcCj4gK30KPiArCj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX0VOQUJMRShfcmVhZCwgX3dyaXRl
KSBcCj4gKwlDT1VOVEVSX0NPTVBfQ09VTlRfQk9PTCgiZW5hYmxlIiwgX3JlYWQsIF93cml0ZSkK
PiArCj4gKyNkZWZpbmUgQ09VTlRFUl9DT01QX0ZMT09SKF9yZWFkLCBfd3JpdGUpIFwKPiArCUNP
VU5URVJfQ09NUF9DT1VOVF9VNjQoImZsb29yIiwgX3JlYWQsIF93cml0ZSkKPiArCj4gKyNkZWZp
bmUgQ09VTlRFUl9DT01QX1BSRVNFVChfcmVhZCwgX3dyaXRlKSBcCj4gKwlDT1VOVEVSX0NPTVBf
Q09VTlRfVTY0KCJwcmVzZXQiLCBfcmVhZCwgX3dyaXRlKQo+ICsKPiArI2RlZmluZSBDT1VOVEVS
X0NPTVBfUFJFU0VUX0VOQUJMRShfcmVhZCwgX3dyaXRlKSBcCj4gKwlDT1VOVEVSX0NPTVBfQ09V
TlRfQk9PTCgicHJlc2V0X2VuYWJsZSIsIF9yZWFkLCBfd3JpdGUpCj4gIAo+ICAjZW5kaWYgLyog
X0NPVU5URVJfSF8gKi8KPiBkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9jb3VudGVyX2VudW0u
aCBiL2luY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmgKPiBkZWxldGVkIGZpbGUgbW9kZSAxMDA2
NDQKPiBpbmRleCA5ZjkxNzI5OGE4OGYuLjAwMDAwMDAwMDAwMAo+IC0tLSBhL2luY2x1ZGUvbGlu
dXgvY291bnRlcl9lbnVtLmgKPiArKysgL2Rldi9udWxsCj4gQEAgLTEsNDUgKzAsMCBAQAo+IC0v
KiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwo+IC0vKgo+IC0gKiBDb3VudGVy
IGludGVyZmFjZSBlbnVtIGZ1bmN0aW9ucwo+IC0gKiBDb3B5cmlnaHQgKEMpIDIwMTggV2lsbGlh
bSBCcmVhdGhpdHQgR3JheQo+IC0gKi8KPiAtI2lmbmRlZiBfQ09VTlRFUl9FTlVNX0hfCj4gLSNk
ZWZpbmUgX0NPVU5URVJfRU5VTV9IXwo+IC0KPiAtI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+Cj4g
LQo+IC1zdHJ1Y3QgY291bnRlcl9kZXZpY2U7Cj4gLXN0cnVjdCBjb3VudGVyX3NpZ25hbDsKPiAt
c3RydWN0IGNvdW50ZXJfY291bnQ7Cj4gLQo+IC1zc2l6ZV90IGNvdW50ZXJfc2lnbmFsX2VudW1f
cmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkgc3RydWN0IGNvdW50
ZXJfc2lnbmFsICpzaWduYWwsIHZvaWQgKnByaXYsCj4gLQkJCQkgY2hhciAqYnVmKTsKPiAtc3Np
emVfdCBjb3VudGVyX3NpZ25hbF9lbnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAtCQkJCSAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHZvaWQgKnByaXYs
Cj4gLQkJCQkgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7Cj4gLQo+IC1zc2l6ZV90IGNv
dW50ZXJfc2lnbmFsX2VudW1fYXZhaWxhYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAo+IC0JCQkJCSAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAo+IC0JCQkJ
CSAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1Zik7Cj4gLQo+IC1zc2l6ZV90IGNvdW50ZXJfY291bnRf
ZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKPiAtCQkJCXN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdiwKPiAtCQkJCWNoYXIgKmJ1Zik7Cj4gLXNz
aXplX3QgY291bnRlcl9jb3VudF9lbnVtX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKPiAtCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXYsCj4g
LQkJCQkgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKTsKPiAtCj4gLXNzaXplX3QgY291bnRl
cl9jb3VudF9lbnVtX2F2YWlsYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKPiAtCQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKPiAtCQkJCQkgIHZvaWQg
KnByaXYsIGNoYXIgKmJ1Zik7Cj4gLQo+IC1zc2l6ZV90IGNvdW50ZXJfZGV2aWNlX2VudW1fcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHZvaWQgKnByaXYsCj4gLQkJCQkgY2hh
ciAqYnVmKTsKPiAtc3NpemVfdCBjb3VudGVyX2RldmljZV9lbnVtX3dyaXRlKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwgdm9pZCAqcHJpdiwKPiAtCQkJCSAgY29uc3QgY2hhciAqYnVm
LCBzaXplX3QgbGVuKTsKPiAtCj4gLXNzaXplX3QgY291bnRlcl9kZXZpY2VfZW51bV9hdmFpbGFi
bGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCj4gLQkJCQkJICAgdm9pZCAq
cHJpdiwgY2hhciAqYnVmKTsKPiAtCj4gLSNlbmRpZiAvKiBfQ09VTlRFUl9FTlVNX0hfICovCj4g
Cl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkxpbnV4LXN0
bTMyIG1haWxpbmcgbGlzdApMaW51eC1zdG0zMkBzdC1tZC1tYWlsbWFuLnN0b3JtcmVwbHkuY29t
Cmh0dHBzOi8vc3QtbWQtbWFpbG1hbi5zdG9ybXJlcGx5LmNvbS9tYWlsbWFuL2xpc3RpbmZvL2xp
bnV4LXN0bTMyCg==
