Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id D4F806105ED
	for <lists+linux-stm32@lfdr.de>; Fri, 28 Oct 2022 00:50:42 +0200 (CEST)
Received: from ip-172-31-3-47.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 9412AC640F5;
	Thu, 27 Oct 2022 22:50:42 +0000 (UTC)
Received: from phobos.denx.de (phobos.denx.de [85.214.62.61])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 3E972C03FDA
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Thu, 27 Oct 2022 22:50:40 +0000 (UTC)
Received: from tr.lan (ip-86-49-120-218.bb.vodafone.cz [86.49.120.218])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits))
 (No client certificate requested)
 (Authenticated sender: marex@denx.de)
 by phobos.denx.de (Postfix) with ESMTPSA id 8436384ED8;
 Fri, 28 Oct 2022 00:50:39 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=denx.de;
 s=phobos-20191101; t=1666911039;
 bh=FezmuHUbp4qM4cANuPtktdM7Lye1talR43aqCigtsTI=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=sXG/DIaSVYlDInCgz87QBZ1AAfk7tEx/M5I647b3jU2ffatVEg6iPgANZnPpJDFm+
 LsUnPeqMcXr3cDzJFvnOqSQFPwYibspN7dO/Q6itPsZvsA9uOX9yBlMsPYjxTVNBqP
 2bGAk6EZh7qUbU8RcK3Qia1BJMJ/y1w939xPeNBsR0GjRUPHYI9rfmC2kIfa8yQQha
 7yuTF9Uv5ek3B220IFwjX6YE52ra8r8AghVL6pgvj6W7wo89Mj0ktNALPgJ8OYsI4n
 KbSNM4u1XtizqU8SQ1pLwOvEuiXxEdn4fem+l/pho3O29xP2M6zrCSXUTsswelcuZ/
 7Rp5ySI7B/8ww==
From: Marek Vasut <marex@denx.de>
To: linux-arm-kernel@lists.infradead.org
Date: Fri, 28 Oct 2022 00:50:19 +0200
Message-Id: <20221027225020.215149-2-marex@denx.de>
X-Mailer: git-send-email 2.35.1
In-Reply-To: <20221027225020.215149-1-marex@denx.de>
References: <20221027225020.215149-1-marex@denx.de>
MIME-Version: 1.0
X-Virus-Scanned: clamav-milter 0.103.6 at phobos.denx.de
X-Virus-Status: Clean
Cc: Marek Vasut <marex@denx.de>, devicetree@vger.kernel.org,
 Rob Herring <robh+dt@kernel.org>,
 Srinivas Kandagatla <srinivas.kandagatla@linaro.org>,
 =?UTF-8?q?Rafa=C5=82=20Mi=C5=82ecki?= <rafal@milecki.pl>,
 linux-stm32@st-md-mailman.stormreply.com
Subject: [Linux-stm32] [PATCH 2/3] [RFC] nvmem: syscon: Add syscon backed
	nvmem driver
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

QWRkIHRyaXZpYWwgZHJpdmVyIHdoaWNoIHBlcm1pdHMgZXhwb3Npbmcgc3lzY29uIGJhY2tlZCBy
ZWdpc3Rlcgp0byB1c2Vyc3BhY2UuIFRoaXMgaXMgdXNlZnVsIGUuZy4gdG8gZXhwb3NlIFUtQm9v
dCBib290IGNvdW50ZXIKb24gdmFyaW91cyBwbGF0Zm9ybXMgd2hlcmUgdGhlIGJvb3QgY291bnRl
ciBpcyBzdG9yZWQgaW4gcmFuZG9tCnZvbGF0aWxlIHJlZ2lzdGVyLCBsaWtlIFNUTTMyTVAxNXh4
IFRBTVBfQktQeFIgcmVnaXN0ZXIuCgpTaWduZWQtb2ZmLWJ5OiBNYXJlayBWYXN1dCA8bWFyZXhA
ZGVueC5kZT4KLS0tCkNjOiBBbGV4YW5kcmUgVG9yZ3VlIDxhbGV4YW5kcmUudG9yZ3VlQGZvc3Mu
c3QuY29tPgpDYzogUmFmYcWCIE1pxYJlY2tpIDxyYWZhbEBtaWxlY2tpLnBsPgpDYzogUm9iIEhl
cnJpbmcgPHJvYmgrZHRAa2VybmVsLm9yZz4KQ2M6IFNyaW5pdmFzIEthbmRhZ2F0bGEgPHNyaW5p
dmFzLmthbmRhZ2F0bGFAbGluYXJvLm9yZz4KQ2M6IGRldmljZXRyZWVAdmdlci5rZXJuZWwub3Jn
CkNjOiBsaW51eC1zdG0zMkBzdC1tZC1tYWlsbWFuLnN0b3JtcmVwbHkuY29tClRvOiBsaW51eC1h
cm0ta2VybmVsQGxpc3RzLmluZnJhZGVhZC5vcmcKLS0tCiBkcml2ZXJzL252bWVtL0tjb25maWcg
ICAgICAgIHwgIDEwICsrKysKIGRyaXZlcnMvbnZtZW0vTWFrZWZpbGUgICAgICAgfCAgIDIgKwog
ZHJpdmVycy9udm1lbS9udm1lbS1zeXNjb24uYyB8IDEwNSArKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKwogMyBmaWxlcyBjaGFuZ2VkLCAxMTcgaW5zZXJ0aW9ucygrKQogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvbnZtZW0vbnZtZW0tc3lzY29uLmMKCmRpZmYgLS1naXQgYS9k
cml2ZXJzL252bWVtL0tjb25maWcgYi9kcml2ZXJzL252bWVtL0tjb25maWcKaW5kZXggZWM4YTQ5
YzA0MDAzMS4uY2Q5YTdiMDBiYzFhYiAxMDA2NDQKLS0tIGEvZHJpdmVycy9udm1lbS9LY29uZmln
CisrKyBiL2RyaXZlcnMvbnZtZW0vS2NvbmZpZwpAQCAtMjkwLDYgKzI5MCwxNiBAQCBjb25maWcg
TlZNRU1fU1BSRF9FRlVTRQogCSAgVGhpcyBkcml2ZXIgY2FuIGFsc28gYmUgYnVpbHQgYXMgYSBt
b2R1bGUuIElmIHNvLCB0aGUgbW9kdWxlCiAJICB3aWxsIGJlIGNhbGxlZCBudm1lbS1zcHJkLWVm
dXNlLgogCitjb25maWcgTlZNRU1fU1lTQ09OCisJdHJpc3RhdGUgIkdlbmVyaWMgc3lzY29uIGJh
Y2tlZCBudm1lbSIKKwloZWxwCisJICBUaGlzIGlzIGEgZHJpdmVyIGZvciBnZW5lcmljIHN5c2Nv
biBiYWNrZWQgbnZtZW0uIFRoaXMgY2FuIGJlCisJICB1c2VkIHRvIGV4cG9zZSBhcmJpdHJhcnkg
c3lzY29uIGJhY2tlZCByZWdpc3RlciB0byB1c2VyIHNwYWNlCisJICB2aWEgbnZtZW0sIGxpa2Ug
dGhlIFUtQm9vdCBib290IGNvdW50ZXIuCisKKwkgIFRoaXMgZHJpdmVyIGNhbiBhbHNvIGJlIGJ1
aWx0IGFzIGEgbW9kdWxlLiBJZiBzbywgdGhlIG1vZHVsZQorCSAgd2lsbCBiZSBjYWxsZWQgbnZt
ZW0tc3lzY29uLgorCiBjb25maWcgTlZNRU1fU1RNMzJfUk9NRU0KIAl0cmlzdGF0ZSAiU1RNaWNy
b2VsZWN0cm9uaWNzIFNUTTMyIGZhY3RvcnktcHJvZ3JhbW1lZCBtZW1vcnkgc3VwcG9ydCIKIAlk
ZXBlbmRzIG9uIEFSQ0hfU1RNMzIgfHwgQ09NUElMRV9URVNUCmRpZmYgLS1naXQgYS9kcml2ZXJz
L252bWVtL01ha2VmaWxlIGIvZHJpdmVycy9udm1lbS9NYWtlZmlsZQppbmRleCBmYTgwZmUxN2U1
NjdlLi42ZTE3MGIzMGExZDFkIDEwMDY0NAotLS0gYS9kcml2ZXJzL252bWVtL01ha2VmaWxlCisr
KyBiL2RyaXZlcnMvbnZtZW0vTWFrZWZpbGUKQEAgLTU5LDYgKzU5LDggQEAgb2JqLSQoQ09ORklH
X05WTUVNX1NQTUlfU0RBTSkJCSs9IG52bWVtX3Fjb20tc3BtaS1zZGFtLm8KIG52bWVtX3Fjb20t
c3BtaS1zZGFtLXkJCQkrPSBxY29tLXNwbWktc2RhbS5vCiBvYmotJChDT05GSUdfTlZNRU1fU1BS
RF9FRlVTRSkJCSs9IG52bWVtX3NwcmRfZWZ1c2UubwogbnZtZW1fc3ByZF9lZnVzZS15CQkJOj0g
c3ByZC1lZnVzZS5vCitvYmotJChDT05GSUdfTlZNRU1fU1lTQ09OKQkJKz0gbnZtZW1fc3lzY29u
Lm8KK252bWVtX3N5c2Nvbi15CQkJCTo9IG52bWVtLXN5c2Nvbi5vCiBvYmotJChDT05GSUdfTlZN
RU1fU1RNMzJfUk9NRU0pCQkrPSBudm1lbV9zdG0zMl9yb21lbS5vCiBudm1lbV9zdG0zMl9yb21l
bS15IAkJCTo9IHN0bTMyLXJvbWVtLm8KIG9iai0kKENPTkZJR19OVk1FTV9TVU5QTFVTX09DT1RQ
KQkrPSBudm1lbV9zdW5wbHVzX29jb3RwLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvbnZtZW0vbnZt
ZW0tc3lzY29uLmMgYi9kcml2ZXJzL252bWVtL252bWVtLXN5c2Nvbi5jCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0CmluZGV4IDAwMDAwMDAwMDAwMDAuLjlhN2Y5YTVlMzc2MDkKLS0tIC9kZXYvbnVsbAor
KysgYi9kcml2ZXJzL252bWVtL252bWVtLXN5c2Nvbi5jCkBAIC0wLDAgKzEsMTA1IEBACisvLyBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5CisvKgorICogQ29weXJpZ2h0IChD
KSAyMDIyIE1hcmVrIFZhc3V0IDxtYXJleEBkZW54LmRlPgorICoKKyAqIEJhc2VkIG9uIHNudnNf
bHBncHIuYyAuCisgKi8KKworI2luY2x1ZGUgPGxpbnV4L21mZC9zeXNjb24uaD4KKyNpbmNsdWRl
IDxsaW51eC9tb2R1bGUuaD4KKyNpbmNsdWRlIDxsaW51eC9udm1lbS1wcm92aWRlci5oPgorI2lu
Y2x1ZGUgPGxpbnV4L29mX2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgorCitz
dHJ1Y3QgbnZtZW1fc3lzY29uX3ByaXYgeworCXN0cnVjdCBkZXZpY2VfZAkJKmRldjsKKwlzdHJ1
Y3QgcmVnbWFwCQkqcmVnbWFwOworCXN0cnVjdCBudm1lbV9jb25maWcJY2ZnOworCXVuc2lnbmVk
IGludAkJb2ZmOworfTsKKworc3RhdGljIGludCBudm1lbV9zeXNjb25fd3JpdGUodm9pZCAqY29u
dGV4dCwgdW5zaWduZWQgaW50IG9mZnNldCwgdm9pZCAqdmFsLAorCQkJICAgIHNpemVfdCBieXRl
cykKK3sKKwlzdHJ1Y3QgbnZtZW1fc3lzY29uX3ByaXYgKnByaXYgPSBjb250ZXh0OworCisJcmV0
dXJuIHJlZ21hcF9idWxrX3dyaXRlKHByaXYtPnJlZ21hcCwgcHJpdi0+b2ZmICsgb2Zmc2V0LAor
CQkJCSB2YWwsIGJ5dGVzIC8gNCk7Cit9CisKK3N0YXRpYyBpbnQgbnZtZW1fc3lzY29uX3JlYWQo
dm9pZCAqY29udGV4dCwgdW5zaWduZWQgaW50IG9mZnNldCwgdm9pZCAqdmFsLAorCQkJICAgc2l6
ZV90IGJ5dGVzKQoreworCXN0cnVjdCBudm1lbV9zeXNjb25fcHJpdiAqcHJpdiA9IGNvbnRleHQ7
CisKKwlyZXR1cm4gcmVnbWFwX2J1bGtfcmVhZChwcml2LT5yZWdtYXAsIHByaXYtPm9mZiArIG9m
ZnNldCwKKwkJCQl2YWwsIGJ5dGVzIC8gNCk7Cit9CisKK3N0YXRpYyBpbnQgbnZtZW1fc3lzY29u
X3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCit7CisJc3RydWN0IGRldmljZSAq
ZGV2ID0gJnBkZXYtPmRldjsKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5vZGUgPSBkZXYtPm9mX25v
ZGU7CisJc3RydWN0IGRldmljZV9ub2RlICpzeXNjb25fbm9kZTsKKwlzdHJ1Y3QgbnZtZW1fc3lz
Y29uX3ByaXYgKnByaXY7CisJc3RydWN0IG52bWVtX2RldmljZSAqbnZtZW07CisJc3RydWN0IG52
bWVtX2NvbmZpZyAqY2ZnOworCWludCByZXQ7CisKKwlpZiAoIW5vZGUpCisJCXJldHVybiAtRU5P
RU5UOworCisJcHJpdiA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqcHJpdiksIEdGUF9LRVJO
RUwpOworCWlmICghcHJpdikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlyZXQgPSBvZl9wcm9wZXJ0
eV9yZWFkX3UzMl9pbmRleChub2RlLCAicmVnIiwgMCwgJnByaXYtPm9mZik7CisJaWYgKHJldCkK
KwkJcmV0dXJuIHJldDsKKworCXJldCA9IG9mX3Byb3BlcnR5X3JlYWRfdTMyX2luZGV4KG5vZGUs
ICJyZWciLCAxLCAmcHJpdi0+Y2ZnLnNpemUpOworCWlmIChyZXQpCisJCXJldHVybiByZXQ7CisK
KwlzeXNjb25fbm9kZSA9IG9mX2dldF9wYXJlbnQobm9kZSk7CisJaWYgKCFzeXNjb25fbm9kZSkK
KwkJcmV0dXJuIC1FTk9ERVY7CisKKwlwcml2LT5yZWdtYXAgPSBzeXNjb25fbm9kZV90b19yZWdt
YXAoc3lzY29uX25vZGUpOworCW9mX25vZGVfcHV0KHN5c2Nvbl9ub2RlKTsKKwlpZiAoSVNfRVJS
KHByaXYtPnJlZ21hcCkpCisJCXJldHVybiBQVFJfRVJSKHByaXYtPnJlZ21hcCk7CisKKwljZmcg
PSAmcHJpdi0+Y2ZnOworCWNmZy0+cHJpdiA9IHByaXY7CisJY2ZnLT5uYW1lID0gZGV2X25hbWUo
ZGV2KTsKKwljZmctPmRldiA9IGRldjsKKwljZmctPnN0cmlkZSA9IDQ7CisJY2ZnLT53b3JkX3Np
emUgPSA0OworCWNmZy0+b3duZXIgPSBUSElTX01PRFVMRTsKKwljZmctPnJlZ19yZWFkICA9IG52
bWVtX3N5c2Nvbl9yZWFkOworCWNmZy0+cmVnX3dyaXRlID0gbnZtZW1fc3lzY29uX3dyaXRlOwor
CisJbnZtZW0gPSBkZXZtX252bWVtX3JlZ2lzdGVyKGRldiwgY2ZnKTsKKworCXJldHVybiBQVFJf
RVJSX09SX1pFUk8obnZtZW0pOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IG9mX2RldmljZV9p
ZCBudm1lbV9zeXNjb25fZHRfaWRzW10gPSB7CisJeyAuY29tcGF0aWJsZSA9ICJudm1lbS1zeXNj
b24iIH0sCisJeyB9LAorfTsKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIG52bWVtX3N5c2Nvbl9k
dF9pZHMpOworCitzdGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBudm1lbV9zeXNjb25fZHJp
dmVyID0geworCS5wcm9iZQk9IG52bWVtX3N5c2Nvbl9wcm9iZSwKKwkuZHJpdmVyID0geworCQku
bmFtZQk9ICJudm1lbS1zeXNjb24iLAorCQkub2ZfbWF0Y2hfdGFibGUgPSBudm1lbV9zeXNjb25f
ZHRfaWRzLAorCX0sCit9OworbW9kdWxlX3BsYXRmb3JtX2RyaXZlcihudm1lbV9zeXNjb25fZHJp
dmVyKTsKKworTU9EVUxFX0FVVEhPUigiTWFyZWsgVmFzdXQgPG1hcmV4QGRlbnguZGU+Iik7CitN
T0RVTEVfREVTQ1JJUFRJT04oIkdlbmVyaWMgc3lzY29uIG52bWVtIGRyaXZlciIpOworTU9EVUxF
X0xJQ0VOU0UoIkdQTCIpOwotLSAKMi4zNS4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpMaW51eC1zdG0zMiBtYWlsaW5nIGxpc3QKTGludXgtc3RtMzJA
c3QtbWQtbWFpbG1hbi5zdG9ybXJlcGx5LmNvbQpodHRwczovL3N0LW1kLW1haWxtYW4uc3Rvcm1y
ZXBseS5jb20vbWFpbG1hbi9saXN0aW5mby9saW51eC1zdG0zMgo=
