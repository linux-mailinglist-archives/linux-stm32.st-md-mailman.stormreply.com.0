Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 187CE3BB9DA
	for <lists+linux-stm32@lfdr.de>; Mon,  5 Jul 2021 11:07:16 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id B746CC57B53;
	Mon,  5 Jul 2021 09:07:15 +0000 (UTC)
Received: from mail-pf1-f169.google.com (mail-pf1-f169.google.com
 [209.85.210.169])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id B3CDCC57B53
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Mon,  5 Jul 2021 08:19:57 +0000 (UTC)
Received: by mail-pf1-f169.google.com with SMTP id i184so3065411pfc.12
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Mon, 05 Jul 2021 01:19:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=Vb1X8PnLtOJ57gJkh1lpxj5QTf4H98Dj/yGmJCsWzmQ=;
 b=qMujdDN7sHlrJyIo8IzsOh4OhjSfvPyVO5+QAHlBgnDl4hlCEbCmMfg77BhBfy5I9T
 f4Tx1rP0cI+DPqxqEBC4FFZH5w1D1XtgdWDmcRWQ0BDBjci2Qm803Ltk0paLJBMaA2PD
 qkHo5jPZK2s7b8biCUrCcYvOrpHy3SirdJm2tlxS/+LVgr1kT12vkcgR/gxRUckXMU58
 sTqtP51AeqWd74JYinPHb1BxGYg+ag7rF4zpgwd350lPzw8d7slcZrav8TjoF75r6lop
 U6a8ceaalvDj1B5WSm5ELJNdiOtF1vL61XDwM949bPlnt3UwbKQ67HJn8IDjd+lM2O35
 N1DA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=Vb1X8PnLtOJ57gJkh1lpxj5QTf4H98Dj/yGmJCsWzmQ=;
 b=mWgXUH6QxiRg4WgPRwXH6cnb2aDS1uyVBoy1JYVlLeUNqoGdo9sQo6jZOH4XAY4KIA
 BNZ+ys29o8hfcb6x6b2P39V6q4g4TLMhvGLnltEUU9UhE/Mk+G/PxljngckfYbYowZgH
 1VqiMxHt7gAdro/IHml8u7Z8ez8s2ZT2ogDn8XPmZksQpNNo0ITQycYLjboAfzoblD/n
 Cfg4fpOPBuAk1hM9fvLMLitoAVKhO64C0u7TlcXxuJqxVuf39hfU4rw7p34URSse+4st
 mCb+LURGnuCg3HwutZkGASnvvt66tUNi4knCnZebuf/bJoL4p0+/qE0GFzU3QWVvoznq
 mPOw==
X-Gm-Message-State: AOAM532VNG3a9F8RPSIklihn7WxTaHExR2ZkV/rQuZl4wdTsRkdA7D2t
 sn86Y4FwM4o083kXqkLLHTo=
X-Google-Smtp-Source: ABdhPJxskT9UiN7v3krVK32Mqj2gAM/oQ9tpPTJ73FEJm3wEWjVVbRzdvbjcxc9TZwz5iTP8KQ+xTg==
X-Received: by 2002:a63:4b23:: with SMTP id y35mr14514637pga.179.1625473195916; 
 Mon, 05 Jul 2021 01:19:55 -0700 (PDT)
Received: from localhost.localdomain ([156.146.35.76])
 by smtp.gmail.com with ESMTPSA id y11sm12209986pfo.160.2021.07.05.01.19.50
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Mon, 05 Jul 2021 01:19:55 -0700 (PDT)
From: William Breathitt Gray <vilhelm.gray@gmail.com>
To: jic23@kernel.org
Date: Mon,  5 Jul 2021 17:18:54 +0900
Message-Id: <834dadaa68af74c703f19f8ddcca5512dd1d177e.1625471640.git.vilhelm.gray@gmail.com>
X-Mailer: git-send-email 2.32.0
In-Reply-To: <cover.1625471640.git.vilhelm.gray@gmail.com>
References: <cover.1625471640.git.vilhelm.gray@gmail.com>
MIME-Version: 1.0
X-Mailman-Approved-At: Mon, 05 Jul 2021 09:07:13 +0000
Cc: kamel.bouhara@bootlin.com, gwendal@chromium.org, david@lechnology.com,
 linux-iio@vger.kernel.org, patrick.havelange@essensium.com,
 alexandre.belloni@bootlin.com, mcoquelin.stm32@gmail.com,
 linux-kernel@vger.kernel.org, o.rempel@pengutronix.de,
 jarkko.nikula@linux.intel.com, Dan Carpenter <dan.carpenter@oracle.com>,
 kernel@pengutronix.de, William Breathitt Gray <vilhelm.gray@gmail.com>,
 fabrice.gasnier@st.com, syednwaris@gmail.com,
 linux-stm32@st-md-mailman.stormreply.com, linux-arm-kernel@lists.infradead.org,
 alexandre.torgue@st.com
Subject: [Linux-stm32] [PATCH v12 06/17] counter: Internalize sysfs
	interface code
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

VGhpcyBpcyBhIHJlaW1wbGVtZW50YXRpb24gb2YgdGhlIEdlbmVyaWMgQ291bnRlciBkcml2ZXIg
aW50ZXJmYWNlLgpUaGVyZSBhcmUgbm8gbW9kaWZpY2F0aW9ucyB0byB0aGUgQ291bnRlciBzdWJz
eXN0ZW0gdXNlcnNwYWNlIGludGVyZmFjZSwKc28gZXhpc3RpbmcgdXNlcnNwYWNlIGFwcGxpY2F0
aW9ucyBzaG91bGQgY29udGludWUgdG8gcnVuIHNlYW1sZXNzbHkuCgpUaGUgcHVycG9zZSBvZiB0
aGlzIHBhdGNoIGlzIHRvIGludGVybmFsaXplIHRoZSBzeXNmcyBpbnRlcmZhY2UgY29kZQphbW9u
ZyB0aGUgdmFyaW91cyBjb3VudGVyIGRyaXZlcnMgaW50byBhIHNoYXJlZCBtb2R1bGUuIENvdW50
ZXIgZHJpdmVycwpwYXNzIGFuZCB0YWtlIGRhdGEgbmF0aXZlbHkgKGkuZS4gdTgsIHU2NCwgZXRj
LikgYW5kIHRoZSBzaGFyZWQgY291bnRlcgptb2R1bGUgaGFuZGxlcyB0aGUgdHJhbnNsYXRpb24g
YmV0d2VlbiB0aGUgc3lzZnMgaW50ZXJmYWNlIGFuZCB0aGUKZGV2aWNlIGRyaXZlcnMuIFRoaXMg
Z3VhcmFudGVlcyBhIHN0YW5kYXJkIHVzZXJzcGFjZSBpbnRlcmZhY2UgZm9yIGFsbApjb3VudGVy
IGRyaXZlcnMsIGFuZCBoZWxwcyBnZW5lcmFsaXplIHRoZSBHZW5lcmljIENvdW50ZXIgZHJpdmVy
IEFCSSBpbgpvcmRlciB0byBzdXBwb3J0IHRoZSBHZW5lcmljIENvdW50ZXIgY2hyZGV2IGludGVy
ZmFjZSAoaW50cm9kdWNlZCBpbiBhCnN1YnNlcXVlbnQgcGF0Y2gpIHdpdGhvdXQgc2lnbmlmaWNh
bnQgY2hhbmdlcyB0byB0aGUgZXhpc3RpbmcgY291bnRlcgpkcml2ZXJzLgoKTm90ZSwgQ291bnRl
ciBkZXZpY2UgcmVnaXN0cmF0aW9uIGlzIHRoZSBzYW1lIGFzIGJlZm9yZTogZHJpdmVycwpwb3B1
bGF0ZSBhIHN0cnVjdCBjb3VudGVyX2RldmljZSB3aXRoIGNvbXBvbmVudHMgYW5kIGNhbGxiYWNr
cywgdGhlbgpwYXNzIHRoZSBzdHJ1Y3R1cmUgdG8gdGhlIGRldm1fY291bnRlcl9yZWdpc3RlciBm
dW5jdGlvbi4gSG93ZXZlciwKd2hhdCdzIGRpZmZlcmVudCBub3cgaXMgaG93IHRoZSBDb3VudGVy
IHN1YnN5c3RlbSBjb2RlIGhhbmRsZXMgdGhpcwpyZWdpc3RyYXRpb24gaW50ZXJuYWxseS4KCldo
ZXJlYXMgYmVmb3JlIGNhbGxiYWNrcyB3b3VsZCBpbnRlcmFjdCBkaXJlY3RseSB3aXRoIHN5c2Zz
IGRhdGEsIHRoaXMKaW50ZXJhY3Rpb24gaXMgbm93IGFic3RyYWN0ZWQgYW5kIGluc3RlYWQgY2Fs
bGJhY2tzIGludGVyYWN0IHdpdGggbmF0aXZlCkMgZGF0YSB0eXBlcy4gVGhlIGNvdW50ZXJfY29t
cCBzdHJ1Y3R1cmUgZm9ybXMgdGhlIGJhc2lzIGZvciBDb3VudGVyCmV4dGVuc2lvbnMuCgpUaGUg
Y291bnRlci1zeXNmcy5jIGZpbGUgY29udGFpbnMgdGhlIGNvZGUgdG8gcGFyc2UgdGhyb3VnaCB0
aGUKY291bnRlcl9kZXZpY2Ugc3RydWN0dXJlIGFuZCByZWdpc3RlciB0aGUgcmVxdWVzdGVkIGNv
bXBvbmVudHMgYW5kCmV4dGVuc2lvbnMuIEF0dHJpYnV0ZXMgYXJlIGNyZWF0ZWQgYW5kIHBvcHVs
YXRlZCBiYXNlZCBvbiB0eXBlLCB3aXRoCnJlc3BlY3RpdmUgdHJhbnNsYXRpb24gZnVuY3Rpb25z
IHRvIGhhbmRsZSB0aGUgbWFwcGluZyBiZXR3ZWVuIHN5c2ZzIGFuZAp0aGUgY291bnRlciBkcml2
ZXIgY2FsbGJhY2tzLgoKVGhlIHRyYW5zbGF0aW9uIHBlcmZvcm1lZCBmb3IgZWFjaCBhdHRyaWJ1
dGUgaXMgc3RyYWlnaHRmb3J3YXJkOiB0aGUKYXR0cmlidXRlIHR5cGUgYW5kIGRhdGEgaXMgcGFy
c2VkIGZyb20gdGhlIGNvdW50ZXJfYXR0cmlidXRlIHN0cnVjdHVyZSwKdGhlIHJlc3BlY3RpdmUg
Y291bnRlciBkcml2ZXIgcmVhZC93cml0ZSBjYWxsYmFjayBpcyBjYWxsZWQsIGFuZCBzeXNmcwpJ
L08gaXMgaGFuZGxlZCBiZWZvcmUgb3IgYWZ0ZXIgdGhlIGRyaXZlciByZWFkL3dyaXRlIGZ1bmN0
aW9uIGlzIGNhbGxlZC4KCkNjOiBTeWVkIE5heXlhciBXYXJpcyA8c3llZG53YXJpc0BnbWFpbC5j
b20+CkNjOiBKYXJra28gTmlrdWxhIDxqYXJra28ubmlrdWxhQGxpbnV4LmludGVsLmNvbT4KQ2M6
IFBhdHJpY2sgSGF2ZWxhbmdlIDxwYXRyaWNrLmhhdmVsYW5nZUBlc3NlbnNpdW0uY29tPgpDYzog
S2FtZWwgQm91aGFyYSA8a2FtZWwuYm91aGFyYUBib290bGluLmNvbT4KQ2M6IEZhYnJpY2UgR2Fz
bmllciA8ZmFicmljZS5nYXNuaWVyQHN0LmNvbT4KQ2M6IE1heGltZSBDb3F1ZWxpbiA8bWNvcXVl
bGluLnN0bTMyQGdtYWlsLmNvbT4KQ2M6IEFsZXhhbmRyZSBUb3JndWUgPGFsZXhhbmRyZS50b3Jn
dWVAc3QuY29tPgpDYzogRGFuIENhcnBlbnRlciA8ZGFuLmNhcnBlbnRlckBvcmFjbGUuY29tPgpS
ZXZpZXdlZC1ieTogRGF2aWQgTGVjaG5lciA8ZGF2aWRAbGVjaG5vbG9neS5jb20+ClRlc3RlZC1i
eTogRGF2aWQgTGVjaG5lciA8ZGF2aWRAbGVjaG5vbG9neS5jb20+ClNpZ25lZC1vZmYtYnk6IFdp
bGxpYW0gQnJlYXRoaXR0IEdyYXkgPHZpbGhlbG0uZ3JheUBnbWFpbC5jb20+Ci0tLQogTUFJTlRB
SU5FUlMgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgMSAtCiBkcml2ZXJzL2NvdW50
ZXIvMTA0LXF1YWQtOC5jICAgICAgICAgICAgfCAgNDQ5ICsrKy0tLS0KIGRyaXZlcnMvY291bnRl
ci9NYWtlZmlsZSAgICAgICAgICAgICAgICB8ICAgIDEgKwogZHJpdmVycy9jb3VudGVyL2NvdW50
ZXItY29yZS5jICAgICAgICAgIHwgIDE0NSArKysKIGRyaXZlcnMvY291bnRlci9jb3VudGVyLXN5
c2ZzLmMgICAgICAgICB8ICA4NDYgKysrKysrKysrKysrKwogZHJpdmVycy9jb3VudGVyL2NvdW50
ZXItc3lzZnMuaCAgICAgICAgIHwgICAxMyArCiBkcml2ZXJzL2NvdW50ZXIvY291bnRlci5jICAg
ICAgICAgICAgICAgfCAxNDk2IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBkcml2ZXJzL2NvdW50
ZXIvZnRtLXF1YWRkZWMuYyAgICAgICAgICAgfCAgIDU2ICstCiBkcml2ZXJzL2NvdW50ZXIvaW50
ZWwtcWVwLmMgICAgICAgICAgICAgfCAgMTQ0ICstLQogZHJpdmVycy9jb3VudGVyL2ludGVycnVw
dC1jbnQuYyAgICAgICAgIHwgICA2MiArLQogZHJpdmVycy9jb3VudGVyL21pY3JvY2hpcC10Y2It
Y2FwdHVyZS5jIHwgICA5MyArLQogZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmMg
ICAgIHwgIDE2MiArKy0KIGRyaXZlcnMvY291bnRlci9zdG0zMi10aW1lci1jbnQuYyAgICAgICB8
ICAxNDcgKy0tCiBkcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5jICAgICAgICAgICAgICAgfCAgMTgw
ICstLQogaW5jbHVkZS9saW51eC9jb3VudGVyLmggICAgICAgICAgICAgICAgIHwgIDY1OCArKysr
Ky0tLS0tCiBpbmNsdWRlL2xpbnV4L2NvdW50ZXJfZW51bS5oICAgICAgICAgICAgfCAgIDQ1IC0K
IDE2IGZpbGVzIGNoYW5nZWQsIDE5MjAgaW5zZXJ0aW9ucygrKSwgMjU3OCBkZWxldGlvbnMoLSkK
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2NvdW50ZXIvY291bnRlci1jb3JlLmMKIGNyZWF0
ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5jCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuaAogZGVsZXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvY291bnRlci9jb3VudGVyLmMKIGRlbGV0ZSBtb2RlIDEwMDY0NCBpbmNsdWRl
L2xpbnV4L2NvdW50ZXJfZW51bS5oCgpkaWZmIC0tZ2l0IGEvTUFJTlRBSU5FUlMgYi9NQUlOVEFJ
TkVSUwppbmRleCA5YmY1NTNlNTNmMGYuLjJjYWMxNTIxNmJhOSAxMDA2NDQKLS0tIGEvTUFJTlRB
SU5FUlMKKysrIGIvTUFJTlRBSU5FUlMKQEAgLTQ2ODcsNyArNDY4Nyw2IEBAIEY6CURvY3VtZW50
YXRpb24vQUJJL3Rlc3Rpbmcvc3lzZnMtYnVzLWNvdW50ZXIKIEY6CURvY3VtZW50YXRpb24vZHJp
dmVyLWFwaS9nZW5lcmljLWNvdW50ZXIucnN0CiBGOglkcml2ZXJzL2NvdW50ZXIvCiBGOglpbmNs
dWRlL2xpbnV4L2NvdW50ZXIuaAotRjoJaW5jbHVkZS9saW51eC9jb3VudGVyX2VudW0uaAogCiBD
UDI2MTUgSTJDIERSSVZFUgogTToJQmVuY2UgQ3PDs2vDoXMgPGJlbmNlOThAc2NoLmJtZS5odT4K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci8xMDQtcXVhZC04LmMgYi9kcml2ZXJzL2NvdW50
ZXIvMTA0LXF1YWQtOC5jCmluZGV4IDUyODNmZjEyOGMxNy4uZDExNjFjMjdjNDg4IDEwMDY0NAot
LS0gYS9kcml2ZXJzL2NvdW50ZXIvMTA0LXF1YWQtOC5jCisrKyBiL2RyaXZlcnMvY291bnRlci8x
MDQtcXVhZC04LmMKQEAgLTExNiw3ICsxMTYsNyBAQCBzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIH0KIAogc3RhdGljIGludCBxdWFk
OF9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsIHVuc2lnbmVkIGxvbmcgKnZhbCkKKwkJCSAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsIHU2NCAqdmFsKQogewogCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJp
diA9IGNvdW50ZXItPnByaXY7CiAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFzZSAr
IDIgKiBjb3VudC0+aWQ7CkBAIC0xNDcsNyArMTQ3LDcgQEAgc3RhdGljIGludCBxdWFkOF9jb3Vu
dF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIH0KIAogc3RhdGljIGludCBx
dWFkOF9jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0Jc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nIHZhbCkKKwkJCSAgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgdmFsKQogewogCXN0cnVjdCBxdWFkOCAqY29uc3Qg
cHJpdiA9IGNvdW50ZXItPnByaXY7CiAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJpdi0+YmFz
ZSArIDIgKiBjb3VudC0+aWQ7CkBAIC0xODcsMjIgKzE4NywxNiBAQCBzdGF0aWMgaW50IHF1YWQ4
X2NvdW50X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAlyZXR1cm4gMDsK
IH0KIAotZW51bSBxdWFkOF9jb3VudF9mdW5jdGlvbiB7Ci0JUVVBRDhfQ09VTlRfRlVOQ1RJT05f
UFVMU0VfRElSRUNUSU9OID0gMCwKLQlRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1gx
LAotCVFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDIsCi0JUVVBRDhfQ09VTlRfRlVO
Q1RJT05fUVVBRFJBVFVSRV9YNAotfTsKLQogc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9mdW5j
dGlvbiBxdWFkOF9jb3VudF9mdW5jdGlvbnNfbGlzdFtdID0gewotCVtRVUFEOF9DT1VOVF9GVU5D
VElPTl9QVUxTRV9ESVJFQ1RJT05dID0gQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04s
Ci0JW1FVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFdID0gQ09VTlRFUl9GVU5DVElP
Tl9RVUFEUkFUVVJFX1gxX0EsCi0JW1FVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJd
ID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0EsCi0JW1FVQUQ4X0NPVU5UX0ZVTkNU
SU9OX1FVQURSQVRVUkVfWDRdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0CisJQ09V
TlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT04sCisJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFU
VVJFX1gxX0EsCisJQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0EsCisJQ09VTlRFUl9G
VU5DVElPTl9RVUFEUkFUVVJFX1g0LAogfTsKIAotc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl9n
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCXN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb3VudCwgc2l6ZV90ICpmdW5jdGlvbikKK3N0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25fcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkgICAgICAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAorCQkJICAgICAgIGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rp
b24pCiB7CiAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAljb25z
dCBpbnQgaWQgPSBjb3VudC0+aWQ7CkBAIC0yMTIsMjUgKzIwNiwyNiBAQCBzdGF0aWMgaW50IHF1
YWQ4X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAJaWYgKHBy
aXYtPnF1YWRyYXR1cmVfbW9kZVtpZF0pCiAJCXN3aXRjaCAocHJpdi0+cXVhZHJhdHVyZV9zY2Fs
ZVtpZF0pIHsKIAkJY2FzZSAwOgotCQkJKmZ1bmN0aW9uID0gUVVBRDhfQ09VTlRfRlVOQ1RJT05f
UVVBRFJBVFVSRV9YMTsKKwkJCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVS
RV9YMV9BOwogCQkJYnJlYWs7CiAJCWNhc2UgMToKLQkJCSpmdW5jdGlvbiA9IFFVQUQ4X0NPVU5U
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDI7CisJCQkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9O
X1FVQURSQVRVUkVfWDJfQTsKIAkJCWJyZWFrOwogCQljYXNlIDI6Ci0JCQkqZnVuY3Rpb24gPSBR
VUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1g0OworCQkJKmZ1bmN0aW9uID0gQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1g0OwogCQkJYnJlYWs7CiAJCX0KIAllbHNlCi0JCSpmdW5j
dGlvbiA9IFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTjsKKwkJKmZ1bmN0aW9u
ID0gQ09VTlRFUl9GVU5DVElPTl9QVUxTRV9ESVJFQ1RJT047CiAKIAltdXRleF91bmxvY2soJnBy
aXYtPmxvY2spOwogCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25f
c2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsIHNpemVfdCBmdW5jdGlvbikKK3N0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25fd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCXN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKKwkJCQllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb24pCiB7CiAJc3Ry
dWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAljb25zdCBpbnQgaWQgPSBj
b3VudC0+aWQ7CkBAIC0yNDYsNyArMjQxLDcgQEAgc3RhdGljIGludCBxdWFkOF9mdW5jdGlvbl9z
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAogCW1vZGVfY2ZnID0gcHJpdi0+Y291
bnRfbW9kZVtpZF0gPDwgMTsKIAlpZHJfY2ZnID0gcHJpdi0+aW5kZXhfcG9sYXJpdHlbaWRdIDw8
IDE7CiAKLQlpZiAoZnVuY3Rpb24gPT0gUVVBRDhfQ09VTlRfRlVOQ1RJT05fUFVMU0VfRElSRUNU
SU9OKSB7CisJaWYgKGZ1bmN0aW9uID09IENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9O
KSB7CiAJCSpxdWFkcmF0dXJlX21vZGUgPSAwOwogCiAJCS8qIFF1YWRyYXR1cmUgc2NhbGluZyBv
bmx5IGF2YWlsYWJsZSBpbiBxdWFkcmF0dXJlIG1vZGUgKi8KQEAgLTI2MiwxNSArMjU3LDE1IEBA
IHN0YXRpYyBpbnQgcXVhZDhfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKIAkJKnF1YWRyYXR1cmVfbW9kZSA9IDE7CiAKIAkJc3dpdGNoIChmdW5jdGlvbikgewot
CQljYXNlIFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDE6CisJCWNhc2UgQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0E6CiAJCQkqc2NhbGUgPSAwOwogCQkJbW9kZV9jZmcg
fD0gUVVBRDhfQ01SX1FVQURSQVRVUkVfWDE7CiAJCQlicmVhazsKLQkJY2FzZSBRVUFEOF9DT1VO
VF9GVU5DVElPTl9RVUFEUkFUVVJFX1gyOgorCQljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJB
VFVSRV9YMl9BOgogCQkJKnNjYWxlID0gMTsKIAkJCW1vZGVfY2ZnIHw9IFFVQUQ4X0NNUl9RVUFE
UkFUVVJFX1gyOwogCQkJYnJlYWs7Ci0JCWNhc2UgUVVBRDhfQ09VTlRfRlVOQ1RJT05fUVVBRFJB
VFVSRV9YNDoKKwkJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6CiAJCQkqc2Nh
bGUgPSAyOwogCQkJbW9kZV9jZmcgfD0gUVVBRDhfQ01SX1FVQURSQVRVUkVfWDQ7CiAJCQlicmVh
azsKQEAgLTI4OSw4ICsyODQsOSBAQCBzdGF0aWMgaW50IHF1YWQ4X2Z1bmN0aW9uX3NldChzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyB2b2lk
IHF1YWQ4X2RpcmVjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCXN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlvbiAq
ZGlyZWN0aW9uKQorc3RhdGljIGludCBxdWFkOF9kaXJlY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAorCQkJ
CWVudW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gKmRpcmVjdGlvbikKIHsKIAljb25zdCBzdHJ1
Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2OwogCXVuc2lnbmVkIGludCB1ZF9m
bGFnOwpAQCAtMzAxLDc2ICsyOTcsNzQgQEAgc3RhdGljIHZvaWQgcXVhZDhfZGlyZWN0aW9uX2dl
dChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAKIAkqZGlyZWN0aW9uID0gKHVkX2Zs
YWcpID8gQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fRk9SV0FSRCA6CiAJCUNPVU5URVJfQ09VTlRf
RElSRUNUSU9OX0JBQ0tXQVJEOwotfQogCi1lbnVtIHF1YWQ4X3N5bmFwc2VfYWN0aW9uIHsKLQlR
VUFEOF9TWU5BUFNFX0FDVElPTl9OT05FID0gMCwKLQlRVUFEOF9TWU5BUFNFX0FDVElPTl9SSVNJ
TkdfRURHRSwKLQlRVUFEOF9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCi0JUVVBRDhfU1lO
QVBTRV9BQ1RJT05fQk9USF9FREdFUwotfTsKKwlyZXR1cm4gMDsKK30KIAogc3RhdGljIGNvbnN0
IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBxdWFkOF9pbmRleF9hY3Rpb25zX2xpc3RbXSA9
IHsKLQlbUVVBRDhfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X05PTkUsCi0JW1FVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0UKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCisJ
Q09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKIH07CiAKIHN0YXRpYyBjb25zdCBl
bnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gcXVhZDhfc3luYXBzZV9hY3Rpb25zX2xpc3RbXSA9
IHsKLQlbUVVBRDhfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X05PTkUsCi0JW1FVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCi0JW1FVQUQ4X1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdf
RURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKLQlbUVVBRDhfU1lO
QVBTRV9BQ1RJT05fQk9USF9FREdFU10gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVMKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCisJQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9SSVNJTkdfRURHRSwKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKKwlD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCiB9OwogCi1zdGF0aWMgaW50IHF1YWQ4
X2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCXN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKLQlzaXpl
X3QgKmFjdGlvbikKK3N0YXRpYyBpbnQgcXVhZDhfYWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAorCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCisJ
CQkgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCisJCQkgICAgIGVudW0gY291
bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKQogewogCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJp
diA9IGNvdW50ZXItPnByaXY7CiAJaW50IGVycjsKLQlzaXplX3QgZnVuY3Rpb24gPSAwOworCWVu
dW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKIAljb25zdCBzaXplX3Qgc2lnbmFsX2FfaWQg
PSBjb3VudC0+c3luYXBzZXNbMF0uc2lnbmFsLT5pZDsKIAllbnVtIGNvdW50ZXJfY291bnRfZGly
ZWN0aW9uIGRpcmVjdGlvbjsKIAogCS8qIEhhbmRsZSBJbmRleCBzaWduYWxzICovCiAJaWYgKHN5
bmFwc2UtPnNpZ25hbC0+aWQgPj0gMTYpIHsKIAkJaWYgKHByaXYtPnByZXNldF9lbmFibGVbY291
bnQtPmlkXSkKLQkJCSphY3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsK
KwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwogCQllbHNl
Ci0JCQkqYWN0aW9uID0gUVVBRDhfU1lOQVBTRV9BQ1RJT05fTk9ORTsKKwkJCSphY3Rpb24gPSBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7CiAKIAkJcmV0dXJuIDA7CiAJfQogCi0JZXJyID0g
cXVhZDhfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24pOworCWVyciA9IHF1
YWQ4X2Z1bmN0aW9uX3JlYWQoY291bnRlciwgY291bnQsICZmdW5jdGlvbik7CiAJaWYgKGVycikK
IAkJcmV0dXJuIGVycjsKIAogCS8qIERlZmF1bHQgYWN0aW9uIG1vZGUgKi8KLQkqYWN0aW9uID0g
UVVBRDhfU1lOQVBTRV9BQ1RJT05fTk9ORTsKKwkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9OT05FOwogCiAJLyogRGV0ZXJtaW5lIGFjdGlvbiBtb2RlIGJhc2VkIG9uIGN1cnJlbnQg
Y291bnQgZnVuY3Rpb24gbW9kZSAqLwogCXN3aXRjaCAoZnVuY3Rpb24pIHsKLQljYXNlIFFVQUQ4
X0NPVU5UX0ZVTkNUSU9OX1BVTFNFX0RJUkVDVElPTjoKKwljYXNlIENPVU5URVJfRlVOQ1RJT05f
UFVMU0VfRElSRUNUSU9OOgogCQlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9PSBzaWduYWxfYV9p
ZCkKLQkJCSphY3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRTsKKwkJCSph
Y3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwogCQlyZXR1cm4gMDsK
LQljYXNlIFFVQUQ4X0NPVU5UX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDE6CisJY2FzZSBDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQToKIAkJaWYgKHN5bmFwc2UtPnNpZ25hbC0+aWQgPT0g
c2lnbmFsX2FfaWQpIHsKLQkJCXF1YWQ4X2RpcmVjdGlvbl9nZXQoY291bnRlciwgY291bnQsICZk
aXJlY3Rpb24pOworCQkJZXJyID0gcXVhZDhfZGlyZWN0aW9uX3JlYWQoY291bnRlciwgY291bnQs
ICZkaXJlY3Rpb24pOworCQkJaWYgKGVycikKKwkJCQlyZXR1cm4gZXJyOwogCiAJCQlpZiAoZGly
ZWN0aW9uID09IENPVU5URVJfQ09VTlRfRElSRUNUSU9OX0ZPUldBUkQpCi0JCQkJKmFjdGlvbiA9
IFFVQUQ4X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOworCQkJCSphY3Rpb24gPSBDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwogCQkJZWxzZQotCQkJCSphY3Rpb24gPSBRVUFE
OF9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0U7CisJCQkJKmFjdGlvbiA9IENPVU5URVJfU1lO
QVBTRV9BQ1RJT05fRkFMTElOR19FREdFOwogCQl9CiAJCXJldHVybiAwOwotCWNhc2UgUVVBRDhf
Q09VTlRfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMjoKKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YMl9BOgogCQlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9PSBzaWduYWxfYV9pZCkK
LQkJCSphY3Rpb24gPSBRVUFEOF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOworCQkJKmFjdGlv
biA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKIAkJcmV0dXJuIDA7Ci0JY2Fz
ZSBRVUFEOF9DT1VOVF9GVU5DVElPTl9RVUFEUkFUVVJFX1g0OgotCQkqYWN0aW9uID0gUVVBRDhf
U1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKKwljYXNlIENPVU5URVJfRlVOQ1RJT05fUVVBRFJB
VFVSRV9YNDoKKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsK
IAkJcmV0dXJuIDA7CiAJZGVmYXVsdDoKIAkJLyogc2hvdWxkIG5ldmVyIHJlYWNoIHRoaXMgcGF0
aCAqLwpAQCAtMzgyLDkgKzM3Niw5IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9vcHMg
cXVhZDhfb3BzID0gewogCS5zaWduYWxfcmVhZCA9IHF1YWQ4X3NpZ25hbF9yZWFkLAogCS5jb3Vu
dF9yZWFkID0gcXVhZDhfY291bnRfcmVhZCwKIAkuY291bnRfd3JpdGUgPSBxdWFkOF9jb3VudF93
cml0ZSwKLQkuZnVuY3Rpb25fZ2V0ID0gcXVhZDhfZnVuY3Rpb25fZ2V0LAotCS5mdW5jdGlvbl9z
ZXQgPSBxdWFkOF9mdW5jdGlvbl9zZXQsCi0JLmFjdGlvbl9nZXQgPSBxdWFkOF9hY3Rpb25fZ2V0
CisJLmZ1bmN0aW9uX3JlYWQgPSBxdWFkOF9mdW5jdGlvbl9yZWFkLAorCS5mdW5jdGlvbl93cml0
ZSA9IHF1YWQ4X2Z1bmN0aW9uX3dyaXRlLAorCS5hY3Rpb25fcmVhZCA9IHF1YWQ4X2FjdGlvbl9y
ZWFkCiB9OwogCiBzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgcXVhZDhfaW5kZXhfcG9sYXJpdHlf
bW9kZXNbXSA9IHsKQEAgLTM5Myw3ICszODcsOCBAQCBzdGF0aWMgY29uc3QgY2hhciAqY29uc3Qg
cXVhZDhfaW5kZXhfcG9sYXJpdHlfbW9kZXNbXSA9IHsKIH07CiAKIHN0YXRpYyBpbnQgcXVhZDhf
aW5kZXhfcG9sYXJpdHlfZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1
Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90ICppbmRleF9wb2xhcml0eSkKKwkJCQkg
ICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCisJCQkJICAgIHUzMiAqaW5kZXhfcG9s
YXJpdHkpCiB7CiAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJp
djsKIAljb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLSAxNjsKQEAgLTQwNCw3
ICszOTksOCBAQCBzdGF0aWMgaW50IHF1YWQ4X2luZGV4X3BvbGFyaXR5X2dldChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiB9CiAKIHN0YXRpYyBpbnQgcXVhZDhfaW5kZXhfcG9sYXJp
dHlfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1Y3QgY291bnRlcl9z
aWduYWwgKnNpZ25hbCwgc2l6ZV90IGluZGV4X3BvbGFyaXR5KQorCQkJCSAgICBzdHJ1Y3QgY291
bnRlcl9zaWduYWwgKnNpZ25hbCwKKwkJCQkgICAgdTMyIGluZGV4X3BvbGFyaXR5KQogewogCXN0
cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAJY29uc3Qgc2l6ZV90IGNo
YW5uZWxfaWQgPSBzaWduYWwtPmlkIC0gMTY7CkBAIC00MjUsMjAgKzQyMSwxNCBAQCBzdGF0aWMg
aW50IHF1YWQ4X2luZGV4X3BvbGFyaXR5X3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51bV9l
eHQgcXVhZDhfaW5kZXhfcG9sX2VudW0gPSB7Ci0JLml0ZW1zID0gcXVhZDhfaW5kZXhfcG9sYXJp
dHlfbW9kZXMsCi0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUocXVhZDhfaW5kZXhfcG9sYXJpdHlf
bW9kZXMpLAotCS5nZXQgPSBxdWFkOF9pbmRleF9wb2xhcml0eV9nZXQsCi0JLnNldCA9IHF1YWQ4
X2luZGV4X3BvbGFyaXR5X3NldAotfTsKLQogc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IHF1YWQ4
X3N5bmNocm9ub3VzX21vZGVzW10gPSB7CiAJIm5vbi1zeW5jaHJvbm91cyIsCiAJInN5bmNocm9u
b3VzIgogfTsKIAogc3RhdGljIGludCBxdWFkOF9zeW5jaHJvbm91c19tb2RlX2dldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWws
IHNpemVfdCAqc3luY2hyb25vdXNfbW9kZSkKKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9zaWdu
YWwgKnNpZ25hbCwKKwkJCQkgICAgICB1MzIgKnN5bmNocm9ub3VzX21vZGUpCiB7CiAJY29uc3Qg
c3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAljb25zdCBzaXplX3Qg
Y2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLSAxNjsKQEAgLTQ0OSw3ICs0MzksOCBAQCBzdGF0aWMg
aW50IHF1YWQ4X3N5bmNocm9ub3VzX21vZGVfZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKIH0KIAogc3RhdGljIGludCBxdWFkOF9zeW5jaHJvbm91c19tb2RlX3NldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWws
IHNpemVfdCBzeW5jaHJvbm91c19tb2RlKQorCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCAqc2lnbmFsLAorCQkJCSAgICAgIHUzMiBzeW5jaHJvbm91c19tb2RlKQogewogCXN0cnVjdCBx
dWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAJY29uc3Qgc2l6ZV90IGNoYW5uZWxf
aWQgPSBzaWduYWwtPmlkIC0gMTY7CkBAIC00NzYsMjIgKzQ2NywxOCBAQCBzdGF0aWMgaW50IHF1
YWQ4X3N5bmNocm9ub3VzX21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
IAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCBx
dWFkOF9zeW5fbW9kZV9lbnVtID0gewotCS5pdGVtcyA9IHF1YWQ4X3N5bmNocm9ub3VzX21vZGVz
LAotCS5udW1faXRlbXMgPSBBUlJBWV9TSVpFKHF1YWQ4X3N5bmNocm9ub3VzX21vZGVzKSwKLQku
Z2V0ID0gcXVhZDhfc3luY2hyb25vdXNfbW9kZV9nZXQsCi0JLnNldCA9IHF1YWQ4X3N5bmNocm9u
b3VzX21vZGVfc2V0Ci19OwotCi1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9mbG9vcl9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKK3N0YXRpYyBpbnQgcXVhZDhfY291bnRf
Zmxvb3JfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqZmxvb3IpCiB7CiAJLyogT25seSBhIGZsb29yIG9m
IDAgaXMgc3VwcG9ydGVkICovCi0JcmV0dXJuIHNwcmludGYoYnVmLCAiMFxuIik7CisJKmZsb29y
ID0gMDsKKworCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfZ2V0
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHNpemVfdCAqY250X21vZGUpCitzdGF0aWMgaW50IHF1YWQ4X2NvdW50X21vZGVfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKKwkJCQkgZW51bSBjb3VudGVyX2NvdW50X21vZGUgKmNudF9tb2RlKQogewog
CWNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAKQEAgLTUx
NCwyNiArNTAxLDI4IEBAIHN0YXRpYyBpbnQgcXVhZDhfY291bnRfbW9kZV9nZXQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHF1YWQ4
X2NvdW50X21vZGVfc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCBjbnRfbW9kZSkKK3N0YXRpYyBpbnQgcXVhZDhf
Y291bnRfbW9kZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCisJCQkJICBlbnVtIGNvdW50ZXJfY291bnRfbW9k
ZSBjbnRfbW9kZSkKIHsKIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2
OworCXVuc2lnbmVkIGludCBjb3VudF9tb2RlOwogCXVuc2lnbmVkIGludCBtb2RlX2NmZzsKIAlj
b25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5iYXNlICsgMiAqIGNvdW50LT5pZCArIDE7CiAK
IAkvKiBNYXAgR2VuZXJpYyBDb3VudGVyIGNvdW50IG1vZGUgdG8gMTA0LVFVQUQtOCBjb3VudCBt
b2RlICovCiAJc3dpdGNoIChjbnRfbW9kZSkgewogCWNhc2UgQ09VTlRFUl9DT1VOVF9NT0RFX05P
Uk1BTDoKLQkJY250X21vZGUgPSAwOworCQljb3VudF9tb2RlID0gMDsKIAkJYnJlYWs7CiAJY2Fz
ZSBDT1VOVEVSX0NPVU5UX01PREVfUkFOR0VfTElNSVQ6Ci0JCWNudF9tb2RlID0gMTsKKwkJY291
bnRfbW9kZSA9IDE7CiAJCWJyZWFrOwogCWNhc2UgQ09VTlRFUl9DT1VOVF9NT0RFX05PTl9SRUNZ
Q0xFOgotCQljbnRfbW9kZSA9IDI7CisJCWNvdW50X21vZGUgPSAyOwogCQlicmVhazsKIAljYXNl
IENPVU5URVJfQ09VTlRfTU9ERV9NT0RVTE9fTjoKLQkJY250X21vZGUgPSAzOworCQljb3VudF9t
b2RlID0gMzsKIAkJYnJlYWs7CiAJZGVmYXVsdDoKIAkJLyogc2hvdWxkIG5ldmVyIHJlYWNoIHRo
aXMgcGF0aCAqLwpAQCAtNTQyLDEwICs1MzEsMTAgQEAgc3RhdGljIGludCBxdWFkOF9jb3VudF9t
b2RlX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAKIAltdXRleF9sb2NrKCZw
cml2LT5sb2NrKTsKIAotCXByaXYtPmNvdW50X21vZGVbY291bnQtPmlkXSA9IGNudF9tb2RlOwor
CXByaXYtPmNvdW50X21vZGVbY291bnQtPmlkXSA9IGNvdW50X21vZGU7CiAKIAkvKiBTZXQgY291
bnQgbW9kZSBjb25maWd1cmF0aW9uIHZhbHVlICovCi0JbW9kZV9jZmcgPSBjbnRfbW9kZSA8PCAx
OworCW1vZGVfY2ZnID0gY291bnRfbW9kZSA8PCAxOwogCiAJLyogQWRkIHF1YWRyYXR1cmUgbW9k
ZSBjb25maWd1cmF0aW9uICovCiAJaWYgKHByaXYtPnF1YWRyYXR1cmVfbW9kZVtjb3VudC0+aWRd
KQpAQCAtNTU5LDU2ICs1NDgsMzUgQEAgc3RhdGljIGludCBxdWFkOF9jb3VudF9tb2RlX3NldChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBz
dHJ1Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4dCBxdWFkOF9jbnRfbW9kZV9lbnVtID0gewotCS5p
dGVtcyA9IGNvdW50ZXJfY291bnRfbW9kZV9zdHIsCi0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUo
Y291bnRlcl9jb3VudF9tb2RlX3N0ciksCi0JLmdldCA9IHF1YWQ4X2NvdW50X21vZGVfZ2V0LAot
CS5zZXQgPSBxdWFkOF9jb3VudF9tb2RlX3NldAotfTsKLQotc3RhdGljIHNzaXplX3QgcXVhZDhf
Y291bnRfZGlyZWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCXN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQotewotCWVu
dW0gY291bnRlcl9jb3VudF9kaXJlY3Rpb24gZGlyOwotCi0JcXVhZDhfZGlyZWN0aW9uX2dldChj
b3VudGVyLCBjb3VudCwgJmRpcik7Ci0KLQlyZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291
bnRlcl9jb3VudF9kaXJlY3Rpb25fc3RyW2Rpcl0pOwotfQotCi1zdGF0aWMgc3NpemVfdCBxdWFk
OF9jb3VudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0Jc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCitzdGF0
aWMgaW50IHF1YWQ4X2NvdW50X2VuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKKwkJCQkgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4ICplbmFibGUpCiB7
CiAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAotCXJl
dHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBwcml2LT5hYl9lbmFibGVbY291bnQtPmlkXSk7CisJ
KmVuYWJsZSA9IHByaXYtPmFiX2VuYWJsZVtjb3VudC0+aWRdOworCisJcmV0dXJuIDA7CiB9CiAK
LXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCi0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2
YXRlLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCitzdGF0aWMgaW50IHF1YWQ4X2NvdW50
X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggZW5hYmxlKQogewogCXN0cnVjdCBxdWFkOCAq
Y29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAJY29uc3QgaW50IGJhc2Vfb2Zmc2V0ID0gcHJp
di0+YmFzZSArIDIgKiBjb3VudC0+aWQ7Ci0JaW50IGVycjsKLQlib29sIGFiX2VuYWJsZTsKIAl1
bnNpZ25lZCBpbnQgaW9yX2NmZzsKIAotCWVyciA9IGtzdHJ0b2Jvb2woYnVmLCAmYWJfZW5hYmxl
KTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJyOwotCiAJbXV0ZXhfbG9jaygmcHJpdi0+bG9jayk7
CiAKLQlwcml2LT5hYl9lbmFibGVbY291bnQtPmlkXSA9IGFiX2VuYWJsZTsKKwlwcml2LT5hYl9l
bmFibGVbY291bnQtPmlkXSA9IGVuYWJsZTsKIAotCWlvcl9jZmcgPSBhYl9lbmFibGUgfCBwcml2
LT5wcmVzZXRfZW5hYmxlW2NvdW50LT5pZF0gPDwgMTsKKwlpb3JfY2ZnID0gZW5hYmxlIHwgcHJp
di0+cHJlc2V0X2VuYWJsZVtjb3VudC0+aWRdIDw8IDE7CiAKIAkvKiBMb2FkIEkvTyBjb250cm9s
IGNvbmZpZ3VyYXRpb24gKi8KIAlvdXRiKFFVQUQ4X0NUUl9JT1IgfCBpb3JfY2ZnLCBiYXNlX29m
ZnNldCArIDEpOwogCiAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKIAotCXJldHVybiBsZW47
CisJcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBjb25zdCBjaGFyICpjb25zdCBxdWFkOF9ub2lzZV9l
cnJvcl9zdGF0ZXNbXSA9IHsKQEAgLTYxNyw3ICs1ODUsNyBAQCBzdGF0aWMgY29uc3QgY2hhciAq
Y29uc3QgcXVhZDhfbm9pc2VfZXJyb3Jfc3RhdGVzW10gPSB7CiB9OwogCiBzdGF0aWMgaW50IHF1
YWQ4X2Vycm9yX25vaXNlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0Jc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCBzaXplX3QgKm5vaXNlX2Vycm9yKQorCQkJCSBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHUzMiAqbm9pc2VfZXJyb3IpCiB7CiAJY29uc3Qgc3Ry
dWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAljb25zdCBpbnQgYmFzZV9v
ZmZzZXQgPSBwcml2LT5iYXNlICsgMiAqIGNvdW50LT5pZCArIDE7CkBAIC02MjcsMTggKzU5NSwx
NCBAQCBzdGF0aWMgaW50IHF1YWQ4X2Vycm9yX25vaXNlX2dldChzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb3Vu
dF9lbnVtX2V4dCBxdWFkOF9lcnJvcl9ub2lzZV9lbnVtID0gewotCS5pdGVtcyA9IHF1YWQ4X25v
aXNlX2Vycm9yX3N0YXRlcywKLQkubnVtX2l0ZW1zID0gQVJSQVlfU0laRShxdWFkOF9ub2lzZV9l
cnJvcl9zdGF0ZXMpLAotCS5nZXQgPSBxdWFkOF9lcnJvcl9ub2lzZV9nZXQKLX07Ci0KLXN0YXRp
YyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNo
YXIgKmJ1ZikKK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfcHJlc2V0X3JlYWQoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwg
dTY0ICpwcmVzZXQpCiB7CiAJY29uc3Qgc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRl
ci0+cHJpdjsKIAotCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBwcml2LT5wcmVzZXRbY291
bnQtPmlkXSk7CisJKnByZXNldCA9IHByaXYtPnByZXNldFtjb3VudC0+aWRdOworCisJcmV0dXJu
IDA7CiB9CiAKIHN0YXRpYyB2b2lkIHF1YWQ4X3ByZXNldF9yZWdpc3Rlcl9zZXQoc3RydWN0IHF1
YWQ4ICpjb25zdCBwcml2LCBjb25zdCBpbnQgaWQsCkBAIC02NTcsMTYgKzYyMSwxMCBAQCBzdGF0
aWMgdm9pZCBxdWFkOF9wcmVzZXRfcmVnaXN0ZXJfc2V0KHN0cnVjdCBxdWFkOCAqY29uc3QgcHJp
diwgY29uc3QgaW50IGlkLAogCQlvdXRiKHByZXNldCA+PiAoOCAqIGkpLCBiYXNlX29mZnNldCk7
CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X3ByZXNldF93cml0ZShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lk
ICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCitzdGF0aWMgaW50IHF1YWQ4
X2NvdW50X3ByZXNldF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJ
ICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IHByZXNldCkKIHsKIAlzdHJ1Y3Qg
cXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2OwotCXVuc2lnbmVkIGludCBwcmVzZXQ7
Ci0JaW50IHJldDsKLQotCXJldCA9IGtzdHJ0b3VpbnQoYnVmLCAwLCAmcHJlc2V0KTsKLQlpZiAo
cmV0KQotCQlyZXR1cm4gcmV0OwogCiAJLyogT25seSAyNC1iaXQgdmFsdWVzIGFyZSBzdXBwb3J0
ZWQgKi8KIAlpZiAocHJlc2V0ID4gMHhGRkZGRkYpCkBAIC02NzgsMTEgKzYzNiwxMSBAQCBzdGF0
aWMgc3NpemVfdCBxdWFkOF9jb3VudF9wcmVzZXRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAogCiAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKIAotCXJldHVybiBsZW47
CisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2NlaWxpbmdfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0Jc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LCB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCitzdGF0aWMgaW50IHF1YWQ4X2NvdW50
X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICpjZWlsaW5nKQogewogCXN0cnVjdCBxdWFk
OCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAKQEAgLTY5MiwyNiArNjUwLDIzIEBAIHN0
YXRpYyBzc2l6ZV90IHF1YWQ4X2NvdW50X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCiAJc3dpdGNoIChwcml2LT5jb3VudF9tb2RlW2NvdW50LT5pZF0pIHsKIAlj
YXNlIDE6CiAJY2FzZSAzOgotCQltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwotCQlyZXR1cm4g
c3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+cHJlc2V0W2NvdW50LT5pZF0pOworCQkqY2VpbGlu
ZyA9IHByaXYtPnByZXNldFtjb3VudC0+aWRdOworCQlicmVhazsKKwlkZWZhdWx0OgorCQkvKiBC
eSBkZWZhdWx0IDB4MUZGRkZGRiAoMjUgYml0cyB1bnNpZ25lZCkgaXMgbWF4aW11bSBjb3VudCAq
LworCQkqY2VpbGluZyA9IDB4MUZGRkZGRjsKKwkJYnJlYWs7CiAJfQogCiAJbXV0ZXhfdW5sb2Nr
KCZwcml2LT5sb2NrKTsKIAotCS8qIEJ5IGRlZmF1bHQgMHgxRkZGRkZGICgyNSBiaXRzIHVuc2ln
bmVkKSBpcyBtYXhpbXVtIGNvdW50ICovCi0JcmV0dXJuIHNwcmludGYoYnVmLCAiMzM1NTQ0MzFc
biIpOworCXJldHVybiAwOwogfQogCi1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9jZWlsaW5n
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikK
K3N0YXRpYyBpbnQgcXVhZDhfY291bnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvdW50ZXIsCisJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCBj
ZWlsaW5nKQogewogCXN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Ci0J
dW5zaWduZWQgaW50IGNlaWxpbmc7Ci0JaW50IHJldDsKLQotCXJldCA9IGtzdHJ0b3VpbnQoYnVm
LCAwLCAmY2VpbGluZyk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKIAogCS8qIE9ubHkgMjQt
Yml0IHZhbHVlcyBhcmUgc3VwcG9ydGVkICovCiAJaWYgKGNlaWxpbmcgPiAweEZGRkZGRikKQEAg
LTcyNSw3ICs2ODAsNyBAQCBzdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9jZWlsaW5nX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAljYXNlIDM6CiAJCXF1YWQ4X3ByZXNl
dF9yZWdpc3Rlcl9zZXQocHJpdiwgY291bnQtPmlkLCBjZWlsaW5nKTsKIAkJbXV0ZXhfdW5sb2Nr
KCZwcml2LT5sb2NrKTsKLQkJcmV0dXJuIGxlbjsKKwkJcmV0dXJuIDA7CiAJfQogCiAJbXV0ZXhf
dW5sb2NrKCZwcml2LT5sb2NrKTsKQEAgLTczMywyNyArNjg4LDI1IEBAIHN0YXRpYyBzc2l6ZV90
IHF1YWQ4X2NvdW50X2NlaWxpbmdfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgc3NpemVfdCBxdWFkOF9jb3VudF9wcmVz
ZXRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCXN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQorc3RhdGljIGlu
dCBxdWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAorCQkJCQkgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkJICB1OCAq
cHJlc2V0X2VuYWJsZSkKIHsKIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHByaXYgPSBjb3Vu
dGVyLT5wcml2OwogCi0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsICFwcml2LT5wcmVzZXRf
ZW5hYmxlW2NvdW50LT5pZF0pOworCSpwcmVzZXRfZW5hYmxlID0gIXByaXYtPnByZXNldF9lbmFi
bGVbY291bnQtPmlkXTsKKworCXJldHVybiAwOwogfQogCi1zdGF0aWMgc3NpemVfdCBxdWFkOF9j
b3VudF9wcmVzZXRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
LQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHZvaWQgKnByaXZhdGUsIGNvbnN0IGNoYXIg
KmJ1Ziwgc2l6ZV90IGxlbikKK3N0YXRpYyBpbnQgcXVhZDhfY291bnRfcHJlc2V0X2VuYWJsZV93
cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJCSAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKKwkJCQkJICAgdTggcHJlc2V0X2VuYWJsZSkKIHsKIAlzdHJ1Y3Qg
cXVhZDggKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2OwogCWNvbnN0IGludCBiYXNlX29mZnNl
dCA9IHByaXYtPmJhc2UgKyAyICogY291bnQtPmlkICsgMTsKLQlib29sIHByZXNldF9lbmFibGU7
Ci0JaW50IHJldDsKIAl1bnNpZ25lZCBpbnQgaW9yX2NmZzsKIAotCXJldCA9IGtzdHJ0b2Jvb2wo
YnVmLCAmcHJlc2V0X2VuYWJsZSk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKLQogCS8qIFBy
ZXNldCBlbmFibGUgaXMgYWN0aXZlIGxvdyBpbiBJbnB1dC9PdXRwdXQgQ29udHJvbCByZWdpc3Rl
ciAqLwogCXByZXNldF9lbmFibGUgPSAhcHJlc2V0X2VuYWJsZTsKIApAQCAtNzYxLDI1ICs3MTQs
MjQgQEAgc3RhdGljIHNzaXplX3QgcXVhZDhfY291bnRfcHJlc2V0X2VuYWJsZV93cml0ZShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAKIAlwcml2LT5wcmVzZXRfZW5hYmxlW2NvdW50
LT5pZF0gPSBwcmVzZXRfZW5hYmxlOwogCi0JaW9yX2NmZyA9IHByaXYtPmFiX2VuYWJsZVtjb3Vu
dC0+aWRdIHwgKHVuc2lnbmVkIGludClwcmVzZXRfZW5hYmxlIDw8IDE7CisJaW9yX2NmZyA9IHBy
aXYtPmFiX2VuYWJsZVtjb3VudC0+aWRdIHwgcHJlc2V0X2VuYWJsZSA8PCAxOwogCiAJLyogTG9h
ZCBJL08gY29udHJvbCBjb25maWd1cmF0aW9uIHRvIElucHV0IC8gT3V0cHV0IENvbnRyb2wgUmVn
aXN0ZXIgKi8KIAlvdXRiKFFVQUQ4X0NUUl9JT1IgfCBpb3JfY2ZnLCBiYXNlX29mZnNldCk7CiAK
IAltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwogCi0JcmV0dXJuIGxlbjsKKwlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCQkgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCAqc2lnbmFsLAotCQkJCQkgICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKK3N0YXRpYyBp
bnQgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAorCQkJCQkgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCisJCQkJCSB1OCAq
Y2FibGVfZmF1bHQpCiB7CiAJc3RydWN0IHF1YWQ4ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJp
djsKIAljb25zdCBzaXplX3QgY2hhbm5lbF9pZCA9IHNpZ25hbC0+aWQgLyAyOwogCWJvb2wgZGlz
YWJsZWQ7CiAJdW5zaWduZWQgaW50IHN0YXR1czsKLQl1bnNpZ25lZCBpbnQgZmF1bHQ7CiAKIAlt
dXRleF9sb2NrKCZwcml2LT5sb2NrKTsKIApAQCAtNzk2LDM2ICs3NDgsMzEgQEAgc3RhdGljIHNz
aXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAogCW11dGV4X3VubG9jaygmcHJpdi0+bG9jayk7CiAKIAkvKiBNYXNrIHJlc3Bl
Y3RpdmUgY2hhbm5lbCBhbmQgaW52ZXJ0IGxvZ2ljICovCi0JZmF1bHQgPSAhKHN0YXR1cyAmIEJJ
VChjaGFubmVsX2lkKSk7CisJKmNhYmxlX2ZhdWx0ID0gIShzdGF0dXMgJiBCSVQoY2hhbm5lbF9p
ZCkpOwogCi0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsIGZhdWx0KTsKKwlyZXR1cm4gMDsK
IH0KIAotc3RhdGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV9yZWFk
KAotCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgc3RydWN0IGNvdW50ZXJfc2lnbmFs
ICpzaWduYWwsCi0Jdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQorc3RhdGljIGludCBxdWFkOF9z
aWduYWxfY2FibGVfZmF1bHRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAorCQkJCQkJc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsCisJCQkJCQl1OCAqZW5h
YmxlKQogewogCWNvbnN0IHN0cnVjdCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7
CiAJY29uc3Qgc2l6ZV90IGNoYW5uZWxfaWQgPSBzaWduYWwtPmlkIC8gMjsKLQljb25zdCB1bnNp
Z25lZCBpbnQgZW5iID0gISEocHJpdi0+Y2FibGVfZmF1bHRfZW5hYmxlICYgQklUKGNoYW5uZWxf
aWQpKTsKIAotCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCBlbmIpOworCSplbmFibGUgPSAh
IShwcml2LT5jYWJsZV9mYXVsdF9lbmFibGUgJiBCSVQoY2hhbm5lbF9pZCkpOworCisJcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFibGVf
d3JpdGUoCi0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCBzdHJ1Y3QgY291bnRlcl9z
aWduYWwgKnNpZ25hbCwKLQl2b2lkICpwcml2YXRlLCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBs
ZW4pCitzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9jYWJsZV9mYXVsdF9lbmFibGVfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCQkJIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCAqc2lnbmFsLAorCQkJCQkJIHU4IGVuYWJsZSkKIHsKIAlzdHJ1Y3QgcXVhZDggKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2OwogCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5p
ZCAvIDI7Ci0JYm9vbCBlbmFibGU7Ci0JaW50IHJldDsKIAl1bnNpZ25lZCBpbnQgY2FibGVfZmF1
bHRfZW5hYmxlOwogCi0JcmV0ID0ga3N0cnRvYm9vbChidWYsICZlbmFibGUpOwotCWlmIChyZXQp
Ci0JCXJldHVybiByZXQ7Ci0KIAltdXRleF9sb2NrKCZwcml2LT5sb2NrKTsKIAogCWlmIChlbmFi
bGUpCkBAIC04NDAsMzEgKzc4NywyNyBAQCBzdGF0aWMgc3NpemVfdCBxdWFkOF9zaWduYWxfY2Fi
bGVfZmF1bHRfZW5hYmxlX3dyaXRlKAogCiAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKIAot
CXJldHVybiBsZW47CisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25h
bF9mY2tfcHJlc2NhbGVyX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCXN0
cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLCB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCitz
dGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAorCQkJCQkgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwK
KwkJCQkJICAgdTggKnByZXNjYWxlcikKIHsKIAljb25zdCBzdHJ1Y3QgcXVhZDggKmNvbnN0IHBy
aXYgPSBjb3VudGVyLT5wcml2OwotCWNvbnN0IHNpemVfdCBjaGFubmVsX2lkID0gc2lnbmFsLT5p
ZCAvIDI7CiAKLQlyZXR1cm4gc3ByaW50ZihidWYsICIldVxuIiwgcHJpdi0+ZmNrX3ByZXNjYWxl
cltjaGFubmVsX2lkXSk7CisJKnByZXNjYWxlciA9IHByaXYtPmZja19wcmVzY2FsZXJbc2lnbmFs
LT5pZCAvIDJdOworCisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHF1YWQ4X3NpZ25h
bF9mY2tfcHJlc2NhbGVyX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQlz
dHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdmF0ZSwgY29uc3QgY2hhciAq
YnVmLAotCXNpemVfdCBsZW4pCitzdGF0aWMgaW50IHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVy
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkJICAgIHN0cnVjdCBj
b3VudGVyX3NpZ25hbCAqc2lnbmFsLAorCQkJCQkgICAgdTggcHJlc2NhbGVyKQogewogCXN0cnVj
dCBxdWFkOCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAJY29uc3Qgc2l6ZV90IGNoYW5u
ZWxfaWQgPSBzaWduYWwtPmlkIC8gMjsKIAljb25zdCBpbnQgYmFzZV9vZmZzZXQgPSBwcml2LT5i
YXNlICsgMiAqIGNoYW5uZWxfaWQ7Ci0JdTggcHJlc2NhbGVyOwotCWludCByZXQ7Ci0KLQlyZXQg
PSBrc3RydG91OChidWYsIDAsICZwcmVzY2FsZXIpOwotCWlmIChyZXQpCi0JCXJldHVybiByZXQ7
CiAKIAltdXRleF9sb2NrKCZwcml2LT5sb2NrKTsKIApAQCAtODgwLDMxICs4MjMsMzAgQEAgc3Rh
dGljIHNzaXplX3QgcXVhZDhfc2lnbmFsX2Zja19wcmVzY2FsZXJfd3JpdGUoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAogCiAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKIAotCXJl
dHVybiBsZW47CisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9z
aWduYWxfZXh0IHF1YWQ4X3NpZ25hbF9leHRbXSA9IHsKLQl7Ci0JCS5uYW1lID0gImNhYmxlX2Zh
dWx0IiwKLQkJLnJlYWQgPSBxdWFkOF9zaWduYWxfY2FibGVfZmF1bHRfcmVhZAotCX0sCi0Jewot
CQkubmFtZSA9ICJjYWJsZV9mYXVsdF9lbmFibGUiLAotCQkucmVhZCA9IHF1YWQ4X3NpZ25hbF9j
YWJsZV9mYXVsdF9lbmFibGVfcmVhZCwKLQkJLndyaXRlID0gcXVhZDhfc2lnbmFsX2NhYmxlX2Zh
dWx0X2VuYWJsZV93cml0ZQotCX0sCi0JewotCQkubmFtZSA9ICJmaWx0ZXJfY2xvY2tfcHJlc2Nh
bGVyIiwKLQkJLnJlYWQgPSBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl9yZWFkLAotCQkud3Jp
dGUgPSBxdWFkOF9zaWduYWxfZmNrX3ByZXNjYWxlcl93cml0ZQotCX0KK3N0YXRpYyBzdHJ1Y3Qg
Y291bnRlcl9jb21wIHF1YWQ4X3NpZ25hbF9leHRbXSA9IHsKKwlDT1VOVEVSX0NPTVBfU0lHTkFM
X0JPT0woImNhYmxlX2ZhdWx0IiwgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X3JlYWQsCisJCQkJ
IE5VTEwpLAorCUNPVU5URVJfQ09NUF9TSUdOQUxfQk9PTCgiY2FibGVfZmF1bHRfZW5hYmxlIiwK
KwkJCQkgcXVhZDhfc2lnbmFsX2NhYmxlX2ZhdWx0X2VuYWJsZV9yZWFkLAorCQkJCSBxdWFkOF9z
aWduYWxfY2FibGVfZmF1bHRfZW5hYmxlX3dyaXRlKSwKKwlDT1VOVEVSX0NPTVBfU0lHTkFMX1U4
KCJmaWx0ZXJfY2xvY2tfcHJlc2NhbGVyIiwKKwkJCSAgICAgICBxdWFkOF9zaWduYWxfZmNrX3By
ZXNjYWxlcl9yZWFkLAorCQkJICAgICAgIHF1YWQ4X3NpZ25hbF9mY2tfcHJlc2NhbGVyX3dyaXRl
KQogfTsKIAotc3RhdGljIGNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgcXVhZDhfaW5k
ZXhfZXh0W10gPSB7Ci0JQ09VTlRFUl9TSUdOQUxfRU5VTSgiaW5kZXhfcG9sYXJpdHkiLCAmcXVh
ZDhfaW5kZXhfcG9sX2VudW0pLAotCUNPVU5URVJfU0lHTkFMX0VOVU1fQVZBSUxBQkxFKCJpbmRl
eF9wb2xhcml0eSIsCSZxdWFkOF9pbmRleF9wb2xfZW51bSksCi0JQ09VTlRFUl9TSUdOQUxfRU5V
TSgic3luY2hyb25vdXNfbW9kZSIsICZxdWFkOF9zeW5fbW9kZV9lbnVtKSwKLQlDT1VOVEVSX1NJ
R05BTF9FTlVNX0FWQUlMQUJMRSgic3luY2hyb25vdXNfbW9kZSIsICZxdWFkOF9zeW5fbW9kZV9l
bnVtKQorc3RhdGljIERFRklORV9DT1VOVEVSX0VOVU0ocXVhZDhfaW5kZXhfcG9sX2VudW0sIHF1
YWQ4X2luZGV4X3BvbGFyaXR5X21vZGVzKTsKK3N0YXRpYyBERUZJTkVfQ09VTlRFUl9FTlVNKHF1
YWQ4X3N5bmNoX21vZGVfZW51bSwgcXVhZDhfc3luY2hyb25vdXNfbW9kZXMpOworCitzdGF0aWMg
c3RydWN0IGNvdW50ZXJfY29tcCBxdWFkOF9pbmRleF9leHRbXSA9IHsKKwlDT1VOVEVSX0NPTVBf
U0lHTkFMX0VOVU0oImluZGV4X3BvbGFyaXR5IiwgcXVhZDhfaW5kZXhfcG9sYXJpdHlfZ2V0LAor
CQkJCSBxdWFkOF9pbmRleF9wb2xhcml0eV9zZXQsCisJCQkJIHF1YWQ4X2luZGV4X3BvbF9lbnVt
KSwKKwlDT1VOVEVSX0NPTVBfU0lHTkFMX0VOVU0oInN5bmNocm9ub3VzX21vZGUiLCBxdWFkOF9z
eW5jaHJvbm91c19tb2RlX2dldCwKKwkJCQkgcXVhZDhfc3luY2hyb25vdXNfbW9kZV9zZXQsCisJ
CQkJIHF1YWQ4X3N5bmNoX21vZGVfZW51bSksCiB9OwogCiAjZGVmaW5lIFFVQUQ4X1FVQURfU0lH
TkFMKF9pZCwgX25hbWUpIHsJCVwKQEAgLTk3MywzOSArOTE1LDMwIEBAIHN0YXRpYyBzdHJ1Y3Qg
Y291bnRlcl9zeW5hcHNlIHF1YWQ4X2NvdW50X3N5bmFwc2VzW11bM10gPSB7CiAJUVVBRDhfQ09V
TlRfU1lOQVBTRVMoNiksIFFVQUQ4X0NPVU5UX1NZTkFQU0VTKDcpCiB9OwogCi1zdGF0aWMgY29u
c3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0IHF1YWQ4X2NvdW50X2V4dFtdID0gewotCXsKLQkJ
Lm5hbWUgPSAiY2VpbGluZyIsCi0JCS5yZWFkID0gcXVhZDhfY291bnRfY2VpbGluZ19yZWFkLAot
CQkud3JpdGUgPSBxdWFkOF9jb3VudF9jZWlsaW5nX3dyaXRlCi0JfSwKLQl7Ci0JCS5uYW1lID0g
ImZsb29yIiwKLQkJLnJlYWQgPSBxdWFkOF9jb3VudF9mbG9vcl9yZWFkCi0JfSwKLQlDT1VOVEVS
X0NPVU5UX0VOVU0oImNvdW50X21vZGUiLCAmcXVhZDhfY250X21vZGVfZW51bSksCi0JQ09VTlRF
Ul9DT1VOVF9FTlVNX0FWQUlMQUJMRSgiY291bnRfbW9kZSIsICZxdWFkOF9jbnRfbW9kZV9lbnVt
KSwKLQl7Ci0JCS5uYW1lID0gImRpcmVjdGlvbiIsCi0JCS5yZWFkID0gcXVhZDhfY291bnRfZGly
ZWN0aW9uX3JlYWQKLQl9LAotCXsKLQkJLm5hbWUgPSAiZW5hYmxlIiwKLQkJLnJlYWQgPSBxdWFk
OF9jb3VudF9lbmFibGVfcmVhZCwKLQkJLndyaXRlID0gcXVhZDhfY291bnRfZW5hYmxlX3dyaXRl
Ci0JfSwKLQlDT1VOVEVSX0NPVU5UX0VOVU0oImVycm9yX25vaXNlIiwgJnF1YWQ4X2Vycm9yX25v
aXNlX2VudW0pLAotCUNPVU5URVJfQ09VTlRfRU5VTV9BVkFJTEFCTEUoImVycm9yX25vaXNlIiwg
JnF1YWQ4X2Vycm9yX25vaXNlX2VudW0pLAotCXsKLQkJLm5hbWUgPSAicHJlc2V0IiwKLQkJLnJl
YWQgPSBxdWFkOF9jb3VudF9wcmVzZXRfcmVhZCwKLQkJLndyaXRlID0gcXVhZDhfY291bnRfcHJl
c2V0X3dyaXRlCi0JfSwKLQl7Ci0JCS5uYW1lID0gInByZXNldF9lbmFibGUiLAotCQkucmVhZCA9
IHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVfcmVhZCwKLQkJLndyaXRlID0gcXVhZDhfY291bnRf
cHJlc2V0X2VuYWJsZV93cml0ZQotCX0KK3N0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfY291bnRf
bW9kZSBxdWFkOF9jbnRfbW9kZXNbXSA9IHsKKwlDT1VOVEVSX0NPVU5UX01PREVfTk9STUFMLAor
CUNPVU5URVJfQ09VTlRfTU9ERV9SQU5HRV9MSU1JVCwKKwlDT1VOVEVSX0NPVU5UX01PREVfTk9O
X1JFQ1lDTEUsCisJQ09VTlRFUl9DT1VOVF9NT0RFX01PRFVMT19OLAorfTsKKworc3RhdGljIERF
RklORV9DT1VOVEVSX0FWQUlMQUJMRShxdWFkOF9jb3VudF9tb2RlX2F2YWlsYWJsZSwgcXVhZDhf
Y250X21vZGVzKTsKKworc3RhdGljIERFRklORV9DT1VOVEVSX0VOVU0ocXVhZDhfZXJyb3Jfbm9p
c2VfZW51bSwgcXVhZDhfbm9pc2VfZXJyb3Jfc3RhdGVzKTsKKworc3RhdGljIHN0cnVjdCBjb3Vu
dGVyX2NvbXAgcXVhZDhfY291bnRfZXh0W10gPSB7CisJQ09VTlRFUl9DT01QX0NFSUxJTkcocXVh
ZDhfY291bnRfY2VpbGluZ19yZWFkLAorCQkJICAgICBxdWFkOF9jb3VudF9jZWlsaW5nX3dyaXRl
KSwKKwlDT1VOVEVSX0NPTVBfRkxPT1IocXVhZDhfY291bnRfZmxvb3JfcmVhZCwgTlVMTCksCisJ
Q09VTlRFUl9DT01QX0NPVU5UX01PREUocXVhZDhfY291bnRfbW9kZV9yZWFkLCBxdWFkOF9jb3Vu
dF9tb2RlX3dyaXRlLAorCQkJCXF1YWQ4X2NvdW50X21vZGVfYXZhaWxhYmxlKSwKKwlDT1VOVEVS
X0NPTVBfRElSRUNUSU9OKHF1YWQ4X2RpcmVjdGlvbl9yZWFkKSwKKwlDT1VOVEVSX0NPTVBfRU5B
QkxFKHF1YWQ4X2NvdW50X2VuYWJsZV9yZWFkLCBxdWFkOF9jb3VudF9lbmFibGVfd3JpdGUpLAor
CUNPVU5URVJfQ09NUF9DT1VOVF9FTlVNKCJlcnJvcl9ub2lzZSIsIHF1YWQ4X2Vycm9yX25vaXNl
X2dldCwgTlVMTCwKKwkJCQlxdWFkOF9lcnJvcl9ub2lzZV9lbnVtKSwKKwlDT1VOVEVSX0NPTVBf
UFJFU0VUKHF1YWQ4X2NvdW50X3ByZXNldF9yZWFkLCBxdWFkOF9jb3VudF9wcmVzZXRfd3JpdGUp
LAorCUNPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKHF1YWQ4X2NvdW50X3ByZXNldF9lbmFibGVf
cmVhZCwKKwkJCQkgICBxdWFkOF9jb3VudF9wcmVzZXRfZW5hYmxlX3dyaXRlKSwKIH07CiAKICNk
ZWZpbmUgUVVBRDhfQ09VTlQoX2lkLCBfY250bmFtZSkgewkJCQkJXApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9jb3VudGVyL01ha2VmaWxlIGIvZHJpdmVycy9jb3VudGVyL01ha2VmaWxlCmluZGV4IDE5
NzQyZTZmNWUzZS4uMWFiN2UwODdmZGMyIDEwMDY0NAotLS0gYS9kcml2ZXJzL2NvdW50ZXIvTWFr
ZWZpbGUKKysrIGIvZHJpdmVycy9jb3VudGVyL01ha2VmaWxlCkBAIC00LDYgKzQsNyBAQAogIwog
CiBvYmotJChDT05GSUdfQ09VTlRFUikgKz0gY291bnRlci5vCitjb3VudGVyLXkgOj0gY291bnRl
ci1jb3JlLm8gY291bnRlci1zeXNmcy5vCiAKIG9iai0kKENPTkZJR18xMDRfUVVBRF84KQkrPSAx
MDQtcXVhZC04Lm8KIG9iai0kKENPTkZJR19JTlRFUlJVUFRfQ05UKQkJKz0gaW50ZXJydXB0LWNu
dC5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci1jb3JlLmMgYi9kcml2ZXJz
L2NvdW50ZXIvY291bnRlci1jb3JlLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAw
MDAwMDAwLi4xNWY3MzVlZjI5NmUKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2NvdW50ZXIv
Y291bnRlci1jb3JlLmMKQEAgLTAsMCArMSwxNDUgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wCisvKgorICogR2VuZXJpYyBDb3VudGVyIGludGVyZmFjZQorICogQ29weXJp
Z2h0IChDKSAyMDIwIFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkKKyAqLworI2luY2x1ZGUgPGxpbnV4
L2NvdW50ZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KKyNpbmNsdWRlIDxsaW51eC9l
eHBvcnQuaD4KKyNpbmNsdWRlIDxsaW51eC9nZnAuaD4KKyNpbmNsdWRlIDxsaW51eC9pZHIuaD4K
KyNpbmNsdWRlIDxsaW51eC9pbml0Lmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CisKKyNp
bmNsdWRlICJjb3VudGVyLXN5c2ZzLmgiCisKKy8qIFByb3ZpZGVzIGEgdW5pcXVlIElEIGZvciBl
YWNoIGNvdW50ZXIgZGV2aWNlICovCitzdGF0aWMgREVGSU5FX0lEQShjb3VudGVyX2lkYSk7CisK
K3N0YXRpYyB2b2lkIGNvdW50ZXJfZGV2aWNlX3JlbGVhc2Uoc3RydWN0IGRldmljZSAqZGV2KQor
eworCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0
YShkZXYpOworCisJY291bnRlcl9jaHJkZXZfcmVtb3ZlKGNvdW50ZXIpOworCWlkYV9mcmVlKCZj
b3VudGVyX2lkYSwgZGV2LT5pZCk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgZGV2aWNlX3R5cGUgY291
bnRlcl9kZXZpY2VfdHlwZSA9IHsKKwkubmFtZSA9ICJjb3VudGVyX2RldmljZSIsCisJLnJlbGVh
c2UgPSBjb3VudGVyX2RldmljZV9yZWxlYXNlLAorfTsKKworc3RhdGljIHN0cnVjdCBidXNfdHlw
ZSBjb3VudGVyX2J1c190eXBlID0geworCS5uYW1lID0gImNvdW50ZXIiLAorCS5kZXZfbmFtZSA9
ICJjb3VudGVyIiwKK307CisKKy8qKgorICogY291bnRlcl9yZWdpc3RlciAtIHJlZ2lzdGVyIENv
dW50ZXIgdG8gdGhlIHN5c3RlbQorICogQGNvdW50ZXI6CXBvaW50ZXIgdG8gQ291bnRlciB0byBy
ZWdpc3RlcgorICoKKyAqIFRoaXMgZnVuY3Rpb24gcmVnaXN0ZXJzIGEgQ291bnRlciB0byB0aGUg
c3lzdGVtLiBBIHN5c2ZzICJjb3VudGVyIiBkaXJlY3RvcnkKKyAqIHdpbGwgYmUgY3JlYXRlZCBh
bmQgcG9wdWxhdGVkIHdpdGggc3lzZnMgYXR0cmlidXRlcyBjb3JyZWxhdGluZyB3aXRoIHRoZQor
ICogQ291bnRlciBTaWduYWxzLCBTeW5hcHNlcywgYW5kIENvdW50cyByZXNwZWN0aXZlbHkuCisg
Ki8KK2ludCBjb3VudGVyX3JlZ2lzdGVyKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291
bnRlcikKK3sKKwlzdHJ1Y3QgZGV2aWNlICpjb25zdCBkZXYgPSAmY291bnRlci0+ZGV2OworCWlu
dCBpZDsKKwlpbnQgZXJyOworCisJLyogQWNxdWlyZSB1bmlxdWUgSUQgKi8KKwlpZCA9IGlkYV9h
bGxvYygmY291bnRlcl9pZGEsIEdGUF9LRVJORUwpOworCWlmIChpZCA8IDApCisJCXJldHVybiBp
ZDsKKworCS8qIENvbmZpZ3VyZSBkZXZpY2Ugc3RydWN0dXJlIGZvciBDb3VudGVyICovCisJZGV2
LT5pZCA9IGlkOworCWRldi0+dHlwZSA9ICZjb3VudGVyX2RldmljZV90eXBlOworCWRldi0+YnVz
ID0gJmNvdW50ZXJfYnVzX3R5cGU7CisJaWYgKGNvdW50ZXItPnBhcmVudCkgeworCQlkZXYtPnBh
cmVudCA9IGNvdW50ZXItPnBhcmVudDsKKwkJZGV2LT5vZl9ub2RlID0gY291bnRlci0+cGFyZW50
LT5vZl9ub2RlOworCX0KKwlkZXZpY2VfaW5pdGlhbGl6ZShkZXYpOworCWRldl9zZXRfZHJ2ZGF0
YShkZXYsIGNvdW50ZXIpOworCisJLyogQWRkIENvdW50ZXIgc3lzZnMgYXR0cmlidXRlcyAqLwor
CWVyciA9IGNvdW50ZXJfc3lzZnNfYWRkKGNvdW50ZXIpOworCWlmIChlcnIgPCAwKQorCQlnb3Rv
IGVycl9mcmVlX2lkOworCisJLyogQWRkIGRldmljZSB0byBzeXN0ZW0gKi8KKwllcnIgPSBkZXZp
Y2VfYWRkKGRldik7CisJaWYgKGVyciA8IDApCisJCWdvdG8gZXJyX2ZyZWVfaWQ7CisKKwlyZXR1
cm4gMDsKKworZXJyX2ZyZWVfaWQ6CisJcHV0X2RldmljZShkZXYpOworCXJldHVybiBlcnI7Cit9
CitFWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3JlZ2lzdGVyKTsKKworLyoqCisgKiBjb3VudGVy
X3VucmVnaXN0ZXIgLSB1bnJlZ2lzdGVyIENvdW50ZXIgZnJvbSB0aGUgc3lzdGVtCisgKiBAY291
bnRlcjoJcG9pbnRlciB0byBDb3VudGVyIHRvIHVucmVnaXN0ZXIKKyAqCisgKiBUaGUgQ291bnRl
ciBpcyB1bnJlZ2lzdGVyZWQgZnJvbSB0aGUgc3lzdGVtLgorICovCit2b2lkIGNvdW50ZXJfdW5y
ZWdpc3RlcihzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCit7CisJaWYgKCFj
b3VudGVyKQorCQlyZXR1cm47CisKKwlkZXZpY2VfdW5yZWdpc3RlcigmY291bnRlci0+ZGV2KTsK
K30KK0VYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfdW5yZWdpc3Rlcik7CisKK3N0YXRpYyB2b2lk
IGRldm1fY291bnRlcl9yZWxlYXNlKHZvaWQgKmNvdW50ZXIpCit7CisJY291bnRlcl91bnJlZ2lz
dGVyKGNvdW50ZXIpOworfQorCisvKioKKyAqIGRldm1fY291bnRlcl9yZWdpc3RlciAtIFJlc291
cmNlLW1hbmFnZWQgY291bnRlcl9yZWdpc3RlcgorICogQGRldjoJZGV2aWNlIHRvIGFsbG9jYXRl
IGNvdW50ZXJfZGV2aWNlIGZvcgorICogQGNvdW50ZXI6CXBvaW50ZXIgdG8gQ291bnRlciB0byBy
ZWdpc3RlcgorICoKKyAqIE1hbmFnZWQgY291bnRlcl9yZWdpc3Rlci4gVGhlIENvdW50ZXIgcmVn
aXN0ZXJlZCB3aXRoIHRoaXMgZnVuY3Rpb24gaXMKKyAqIGF1dG9tYXRpY2FsbHkgdW5yZWdpc3Rl
cmVkIG9uIGRyaXZlciBkZXRhY2guIFRoaXMgZnVuY3Rpb24gY2FsbHMKKyAqIGNvdW50ZXJfcmVn
aXN0ZXIgaW50ZXJuYWxseS4gUmVmZXIgdG8gdGhhdCBmdW5jdGlvbiBmb3IgbW9yZSBpbmZvcm1h
dGlvbi4KKyAqCisgKiBSRVRVUk5TOgorICogMCBvbiBzdWNjZXNzLCBuZWdhdGl2ZSBlcnJvciBu
dW1iZXIgb24gZmFpbHVyZS4KKyAqLworaW50IGRldm1fY291bnRlcl9yZWdpc3RlcihzdHJ1Y3Qg
ZGV2aWNlICpkZXYsCisJCQkgIHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikK
K3sKKwlpbnQgZXJyOworCisJZXJyID0gY291bnRlcl9yZWdpc3Rlcihjb3VudGVyKTsKKwlpZiAo
ZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKworCXJldHVybiBkZXZtX2FkZF9hY3Rpb25fb3JfcmVz
ZXQoZGV2LCBkZXZtX2NvdW50ZXJfcmVsZWFzZSwgY291bnRlcik7Cit9CitFWFBPUlRfU1lNQk9M
X0dQTChkZXZtX2NvdW50ZXJfcmVnaXN0ZXIpOworCitzdGF0aWMgaW50IF9faW5pdCBjb3VudGVy
X2luaXQodm9pZCkKK3sKKwlyZXR1cm4gYnVzX3JlZ2lzdGVyKCZjb3VudGVyX2J1c190eXBlKTsK
K30KKworc3RhdGljIHZvaWQgX19leGl0IGNvdW50ZXJfZXhpdCh2b2lkKQoreworCWJ1c191bnJl
Z2lzdGVyKCZjb3VudGVyX2J1c190eXBlKTsKK30KKworc3Vic3lzX2luaXRjYWxsKGNvdW50ZXJf
aW5pdCk7Cittb2R1bGVfZXhpdChjb3VudGVyX2V4aXQpOworCitNT0RVTEVfQVVUSE9SKCJXaWxs
aWFtIEJyZWF0aGl0dCBHcmF5IDx2aWxoZWxtLmdyYXlAZ21haWwuY29tPiIpOworTU9EVUxFX0RF
U0NSSVBUSU9OKCJHZW5lcmljIENvdW50ZXIgaW50ZXJmYWNlIik7CitNT0RVTEVfTElDRU5TRSgi
R1BMIHYyIik7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5jIGIv
ZHJpdmVycy9jb3VudGVyL2NvdW50ZXItc3lzZnMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRl
eCAwMDAwMDAwMDAwMDAuLjA3NTg4MTMwNjAwYQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMv
Y291bnRlci9jb3VudGVyLXN5c2ZzLmMKQEAgLTAsMCArMSw4NDYgQEAKKy8vIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wCisvKgorICogR2VuZXJpYyBDb3VudGVyIHN5c2ZzIGludGVy
ZmFjZQorICogQ29weXJpZ2h0IChDKSAyMDIwIFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkKKyAqLwor
I2luY2x1ZGUgPGxpbnV4L2NvdW50ZXIuaD4KKyNpbmNsdWRlIDxsaW51eC9kZXZpY2UuaD4KKyNp
bmNsdWRlIDxsaW51eC9lcnIuaD4KKyNpbmNsdWRlIDxsaW51eC9nZnAuaD4KKyNpbmNsdWRlIDxs
aW51eC9rZXJuZWwuaD4KKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+CisjaW5jbHVkZSA8bGludXgv
c3RyaW5nLmg+CisjaW5jbHVkZSA8bGludXgvc3lzZnMuaD4KKyNpbmNsdWRlIDxsaW51eC90eXBl
cy5oPgorCisjaW5jbHVkZSAiY291bnRlci1zeXNmcy5oIgorCisvKioKKyAqIHN0cnVjdCBjb3Vu
dGVyX2F0dHJpYnV0ZSAtIENvdW50ZXIgc3lzZnMgYXR0cmlidXRlCisgKiBAZGV2X2F0dHI6CWRl
dmljZSBhdHRyaWJ1dGUgZm9yIHN5c2ZzCisgKiBAbDoJCW5vZGUgdG8gYWRkIENvdW50ZXIgYXR0
cmlidXRlIHRvIGF0dHJpYnV0ZSBncm91cCBsaXN0CisgKiBAY29tcDoJQ291bnRlciBjb21wb25l
bnQgY2FsbGJhY2tzIGFuZCBkYXRhCisgKiBAc2NvcGU6CUNvdW50ZXIgc2NvcGUgb2YgdGhlIGF0
dHJpYnV0ZQorICogQHBhcmVudDoJcG9pbnRlciB0byB0aGUgcGFyZW50IGNvbXBvbmVudAorICov
CitzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgeworCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlIGRl
dl9hdHRyOworCXN0cnVjdCBsaXN0X2hlYWQgbDsKKworCXN0cnVjdCBjb3VudGVyX2NvbXAgY29t
cDsKKwllbnVtIGNvdW50ZXJfc2NvcGUgc2NvcGU7CisJdm9pZCAqcGFyZW50OworfTsKKworI2Rl
ZmluZSB0b19jb3VudGVyX2F0dHJpYnV0ZShfZGV2X2F0dHIpIFwKKwljb250YWluZXJfb2YoX2Rl
dl9hdHRyLCBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUsIGRldl9hdHRyKQorCisvKioKKyAqIHN0
cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAtIGNvbnRhaW5lciBmb3IgYXR0cmlidXRlIGdy
b3VwCisgKiBAbmFtZToJbmFtZSBvZiB0aGUgYXR0cmlidXRlIGdyb3VwCisgKiBAYXR0cl9saXN0
OglsaXN0IHRvIGtlZXAgdHJhY2sgb2YgY3JlYXRlZCBhdHRyaWJ1dGVzCisgKiBAbnVtX2F0dHI6
CW51bWJlciBvZiBhdHRyaWJ1dGVzCisgKi8KK3N0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91
cCB7CisJY29uc3QgY2hhciAqbmFtZTsKKwlzdHJ1Y3QgbGlzdF9oZWFkIGF0dHJfbGlzdDsKKwlz
aXplX3QgbnVtX2F0dHI7Cit9OworCitzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9m
dW5jdGlvbl9zdHJbXSA9IHsKKwlbQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRV0gPSAiaW5jcmVh
c2UiLAorCVtDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFXSA9ICJkZWNyZWFzZSIsCisJW0NPVU5U
RVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OXSA9ICJwdWxzZS1kaXJlY3Rpb24iLAorCVtDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQV0gPSAicXVhZHJhdHVyZSB4MSBhIiwKKwlbQ09V
TlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gxX0JdID0gInF1YWRyYXR1cmUgeDEgYiIsCisJW0NP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9BXSA9ICJxdWFkcmF0dXJlIHgyIGEiLAorCVtD
T1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQl0gPSAicXVhZHJhdHVyZSB4MiBiIiwKKwlb
Q09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0XSA9ICJxdWFkcmF0dXJlIHg0IgorfTsKKwor
c3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfc2lnbmFsX3ZhbHVlX3N0cltdID0gewor
CVtDT1VOVEVSX1NJR05BTF9MRVZFTF9MT1ddID0gImxvdyIsCisJW0NPVU5URVJfU0lHTkFMX0xF
VkVMX0hJR0hdID0gImhpZ2giCit9OworCitzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRl
cl9zeW5hcHNlX2FjdGlvbl9zdHJbXSA9IHsKKwlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05F
XSA9ICJub25lIiwKKwlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRV0gPSAicmlz
aW5nIGVkZ2UiLAorCVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRV0gPSAiZmFs
bGluZyBlZGdlIiwKKwlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTXSA9ICJib3Ro
IGVkZ2VzIgorfTsKKworc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfY291bnRfZGly
ZWN0aW9uX3N0cltdID0geworCVtDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9GT1JXQVJEXSA9ICJm
b3J3YXJkIiwKKwlbQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fQkFDS1dBUkRdID0gImJhY2t3YXJk
IgorfTsKKworc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfY291bnRfbW9kZV9zdHJb
XSA9IHsKKwlbQ09VTlRFUl9DT1VOVF9NT0RFX05PUk1BTF0gPSAibm9ybWFsIiwKKwlbQ09VTlRF
Ul9DT1VOVF9NT0RFX1JBTkdFX0xJTUlUXSA9ICJyYW5nZSBsaW1pdCIsCisJW0NPVU5URVJfQ09V
TlRfTU9ERV9OT05fUkVDWUNMRV0gPSAibm9uLXJlY3ljbGUiLAorCVtDT1VOVEVSX0NPVU5UX01P
REVfTU9EVUxPX05dID0gIm1vZHVsby1uIgorfTsKKworc3RhdGljIHNzaXplX3QgY291bnRlcl9j
b21wX3U4X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAorCQkJCSAgICBzdHJ1Y3QgZGV2aWNlX2F0
dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0dHJp
YnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOworCXN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOworCWludCBl
cnI7CisJdTggZGF0YSA9IDA7CisKKwlzd2l0Y2ggKGEtPnNjb3BlKSB7CisJY2FzZSBDT1VOVEVS
X1NDT1BFX0RFVklDRToKKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdThfcmVhZChjb3VudGVyLCAm
ZGF0YSk7CisJCWJyZWFrOworCWNhc2UgQ09VTlRFUl9TQ09QRV9TSUdOQUw6CisJCWVyciA9IGEt
PmNvbXAuc2lnbmFsX3U4X3JlYWQoY291bnRlciwgYS0+cGFyZW50LCAmZGF0YSk7CisJCWJyZWFr
OworCWNhc2UgQ09VTlRFUl9TQ09QRV9DT1VOVDoKKwkJZXJyID0gYS0+Y29tcC5jb3VudF91OF9y
ZWFkKGNvdW50ZXIsIGEtPnBhcmVudCwgJmRhdGEpOworCQlicmVhazsKKwlkZWZhdWx0OgorCQly
ZXR1cm4gLUVJTlZBTDsKKwl9CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwlpZiAo
YS0+Y29tcC50eXBlID09IENPVU5URVJfQ09NUF9CT09MKQorCQlkYXRhID0gISFkYXRhOworCisJ
cmV0dXJuIHNwcmludGYoYnVmLCAiJXVcbiIsICh1bnNpZ25lZCBpbnQpZGF0YSk7Cit9CisKK3N0
YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91OF9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCisJ
CQkJICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwKKwkJCQkgICAgIGNvbnN0IGNo
YXIgKmJ1Ziwgc2l6ZV90IGxlbikKK3sKKwljb25zdCBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUg
KmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKKwlzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwlpbnQgZXJyOwor
CWJvb2wgYm9vbF9kYXRhID0gMDsKKwl1OCBkYXRhID0gMDsKKworCWlmIChhLT5jb21wLnR5cGUg
PT0gQ09VTlRFUl9DT01QX0JPT0wpIHsKKwkJZXJyID0ga3N0cnRvYm9vbChidWYsICZib29sX2Rh
dGEpOworCQlkYXRhID0gYm9vbF9kYXRhOworCX0gZWxzZQorCQllcnIgPSBrc3RydG91OChidWYs
IDAsICZkYXRhKTsKKwlpZiAoZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKworCXN3aXRjaCAoYS0+
c2NvcGUpIHsKKwljYXNlIENPVU5URVJfU0NPUEVfREVWSUNFOgorCQllcnIgPSBhLT5jb21wLmRl
dmljZV91OF93cml0ZShjb3VudGVyLCBkYXRhKTsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX1ND
T1BFX1NJR05BTDoKKwkJZXJyID0gYS0+Y29tcC5zaWduYWxfdThfd3JpdGUoY291bnRlciwgYS0+
cGFyZW50LCBkYXRhKTsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX1NDT1BFX0NPVU5UOgorCQll
cnIgPSBhLT5jb21wLmNvdW50X3U4X3dyaXRlKGNvdW50ZXIsIGEtPnBhcmVudCwgZGF0YSk7CisJ
CWJyZWFrOworCWRlZmF1bHQ6CisJCXJldHVybiAtRUlOVkFMOworCX0KKwlpZiAoZXJyIDwgMCkK
KwkJcmV0dXJuIGVycjsKKworCXJldHVybiBsZW47Cit9CisKK3N0YXRpYyBzc2l6ZV90IGNvdW50
ZXJfY29tcF91MzJfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCisJCQkJICAgICBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCWNvbnN0IHN0cnVjdCBjb3VudGVy
X2F0dHJpYnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOworCXN0cnVj
dCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwor
CWNvbnN0IHN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSAqY29uc3QgYXZhaWwgPSBhLT5jb21wLnBy
aXY7CisJaW50IGVycjsKKwl1MzIgZGF0YSA9IDA7CisKKwlzd2l0Y2ggKGEtPnNjb3BlKSB7CisJ
Y2FzZSBDT1VOVEVSX1NDT1BFX0RFVklDRToKKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdTMyX3Jl
YWQoY291bnRlciwgJmRhdGEpOworCQlicmVhazsKKwljYXNlIENPVU5URVJfU0NPUEVfU0lHTkFM
OgorCQllcnIgPSBhLT5jb21wLnNpZ25hbF91MzJfcmVhZChjb3VudGVyLCBhLT5wYXJlbnQsICZk
YXRhKTsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX1NDT1BFX0NPVU5UOgorCQlpZiAoYS0+Y29t
cC50eXBlID09IENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTikKKwkJCWVyciA9IGEtPmNvbXAu
YWN0aW9uX3JlYWQoY291bnRlciwgYS0+cGFyZW50LAorCQkJCQkJICBhLT5jb21wLnByaXYsICZk
YXRhKTsKKwkJZWxzZQorCQkJZXJyID0gYS0+Y29tcC5jb3VudF91MzJfcmVhZChjb3VudGVyLCBh
LT5wYXJlbnQsICZkYXRhKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5WQUw7
CisJfQorCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJc3dpdGNoIChhLT5jb21wLnR5
cGUpIHsKKwljYXNlIENPVU5URVJfQ09NUF9GVU5DVElPTjoKKwkJcmV0dXJuIHN5c2ZzX2VtaXQo
YnVmLCAiJXNcbiIsIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2RhdGFdKTsKKwljYXNlIENPVU5URVJf
Q09NUF9TSUdOQUxfTEVWRUw6CisJCXJldHVybiBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBjb3Vu
dGVyX3NpZ25hbF92YWx1ZV9zdHJbZGF0YV0pOworCWNhc2UgQ09VTlRFUl9DT01QX1NZTkFQU0Vf
QUNUSU9OOgorCQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwgY291bnRlcl9zeW5hcHNl
X2FjdGlvbl9zdHJbZGF0YV0pOworCWNhc2UgQ09VTlRFUl9DT01QX0VOVU06CisJCXJldHVybiBz
eXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCBhdmFpbC0+c3Ryc1tkYXRhXSk7CisJY2FzZSBDT1VOVEVS
X0NPTVBfQ09VTlRfRElSRUNUSU9OOgorCQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwg
Y291bnRlcl9jb3VudF9kaXJlY3Rpb25fc3RyW2RhdGFdKTsKKwljYXNlIENPVU5URVJfQ09NUF9D
T1VOVF9NT0RFOgorCQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIlc1xuIiwgY291bnRlcl9jb3Vu
dF9tb2RlX3N0cltkYXRhXSk7CisJZGVmYXVsdDoKKwkJcmV0dXJuIHNwcmludGYoYnVmLCAiJXVc
biIsICh1bnNpZ25lZCBpbnQpZGF0YSk7CisJfQorfQorCitzdGF0aWMgaW50IGNvdW50ZXJfZmlu
ZF9lbnVtKHUzMiAqY29uc3QgZW51bV9pdGVtLCBjb25zdCB1MzIgKmNvbnN0IGVudW1zLAorCQkJ
ICAgICBjb25zdCBzaXplX3QgbnVtX2VudW1zLCBjb25zdCBjaGFyICpjb25zdCBidWYsCisJCQkg
ICAgIGNvbnN0IGNoYXIgKmNvbnN0IHN0cmluZ19hcnJheVtdKQoreworCXNpemVfdCBpbmRleDsK
KworCWZvciAoaW5kZXggPSAwOyBpbmRleCA8IG51bV9lbnVtczsgaW5kZXgrKykgeworCQkqZW51
bV9pdGVtID0gZW51bXNbaW5kZXhdOworCQlpZiAoc3lzZnNfc3RyZXEoYnVmLCBzdHJpbmdfYXJy
YXlbKmVudW1faXRlbV0pKQorCQkJcmV0dXJuIDA7CisJfQorCisJcmV0dXJuIC1FSU5WQUw7Cit9
CisKK3N0YXRpYyBzc2l6ZV90IGNvdW50ZXJfY29tcF91MzJfc3RvcmUoc3RydWN0IGRldmljZSAq
ZGV2LAorCQkJCSAgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAorCQkJCSAgICAg
IGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKK3sKKwljb25zdCBzdHJ1Y3QgY291bnRlcl9h
dHRyaWJ1dGUgKmNvbnN0IGEgPSB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKTsKKwlzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKKwlz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQgPSBhLT5wYXJlbnQ7CisJc3RydWN0IGNv
dW50ZXJfc3luYXBzZSAqY29uc3Qgc3luYXBzZSA9IGEtPmNvbXAucHJpdjsKKwljb25zdCBzdHJ1
Y3QgY291bnRlcl9hdmFpbGFibGUgKmNvbnN0IGF2YWlsID0gYS0+Y29tcC5wcml2OworCWludCBl
cnI7CisJdTMyIGRhdGEgPSAwOworCisJc3dpdGNoIChhLT5jb21wLnR5cGUpIHsKKwljYXNlIENP
VU5URVJfQ09NUF9GVU5DVElPTjoKKwkJZXJyID0gY291bnRlcl9maW5kX2VudW0oJmRhdGEsIGNv
dW50LT5mdW5jdGlvbnNfbGlzdCwKKwkJCQkJY291bnQtPm51bV9mdW5jdGlvbnMsIGJ1ZiwKKwkJ
CQkJY291bnRlcl9mdW5jdGlvbl9zdHIpOworCQlicmVhazsKKwljYXNlIENPVU5URVJfQ09NUF9T
WU5BUFNFX0FDVElPTjoKKwkJZXJyID0gY291bnRlcl9maW5kX2VudW0oJmRhdGEsIHN5bmFwc2Ut
PmFjdGlvbnNfbGlzdCwKKwkJCQkJc3luYXBzZS0+bnVtX2FjdGlvbnMsIGJ1ZiwKKwkJCQkJY291
bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHIpOworCQlicmVhazsKKwljYXNlIENPVU5URVJfQ09NUF9F
TlVNOgorCQllcnIgPSBfX3N5c2ZzX21hdGNoX3N0cmluZyhhdmFpbC0+c3RycywgYXZhaWwtPm51
bV9pdGVtcywgYnVmKTsKKwkJZGF0YSA9IGVycjsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX0NP
TVBfQ09VTlRfTU9ERToKKwkJZXJyID0gY291bnRlcl9maW5kX2VudW0oJmRhdGEsIGF2YWlsLT5l
bnVtcywgYXZhaWwtPm51bV9pdGVtcywKKwkJCQkJYnVmLCBjb3VudGVyX2NvdW50X21vZGVfc3Ry
KTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJZXJyID0ga3N0cnRvdTMyKGJ1ZiwgMCwgJmRhdGEp
OworCQlicmVhazsKKwl9CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwlzd2l0Y2gg
KGEtPnNjb3BlKSB7CisJY2FzZSBDT1VOVEVSX1NDT1BFX0RFVklDRToKKwkJZXJyID0gYS0+Y29t
cC5kZXZpY2VfdTMyX3dyaXRlKGNvdW50ZXIsIGRhdGEpOworCQlicmVhazsKKwljYXNlIENPVU5U
RVJfU0NPUEVfU0lHTkFMOgorCQllcnIgPSBhLT5jb21wLnNpZ25hbF91MzJfd3JpdGUoY291bnRl
ciwgYS0+cGFyZW50LCBkYXRhKTsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX1NDT1BFX0NPVU5U
OgorCQlpZiAoYS0+Y29tcC50eXBlID09IENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTikKKwkJ
CWVyciA9IGEtPmNvbXAuYWN0aW9uX3dyaXRlKGNvdW50ZXIsIGNvdW50LCBzeW5hcHNlLAorCQkJ
CQkJICAgZGF0YSk7CisJCWVsc2UKKwkJCWVyciA9IGEtPmNvbXAuY291bnRfdTMyX3dyaXRlKGNv
dW50ZXIsIGNvdW50LCBkYXRhKTsKKwkJYnJlYWs7CisJZGVmYXVsdDoKKwkJcmV0dXJuIC1FSU5W
QUw7CisJfQorCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJcmV0dXJuIGxlbjsKK30K
Kworc3RhdGljIHNzaXplX3QgY291bnRlcl9jb21wX3U2NF9zaG93KHN0cnVjdCBkZXZpY2UgKmRl
diwKKwkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCit7
CisJY29uc3Qgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlICpjb25zdCBhID0gdG9fY291bnRlcl9h
dHRyaWJ1dGUoYXR0cik7CisJc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0g
ZGV2X2dldF9kcnZkYXRhKGRldik7CisJaW50IGVycjsKKwl1NjQgZGF0YSA9IDA7CisKKwlzd2l0
Y2ggKGEtPnNjb3BlKSB7CisJY2FzZSBDT1VOVEVSX1NDT1BFX0RFVklDRToKKwkJZXJyID0gYS0+
Y29tcC5kZXZpY2VfdTY0X3JlYWQoY291bnRlciwgJmRhdGEpOworCQlicmVhazsKKwljYXNlIENP
VU5URVJfU0NPUEVfU0lHTkFMOgorCQllcnIgPSBhLT5jb21wLnNpZ25hbF91NjRfcmVhZChjb3Vu
dGVyLCBhLT5wYXJlbnQsICZkYXRhKTsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX1NDT1BFX0NP
VU5UOgorCQllcnIgPSBhLT5jb21wLmNvdW50X3U2NF9yZWFkKGNvdW50ZXIsIGEtPnBhcmVudCwg
JmRhdGEpOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJTlZBTDsKKwl9CisJaWYg
KGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwlyZXR1cm4gc3ByaW50ZihidWYsICIlbGx1XG4i
LCAodW5zaWduZWQgbG9uZyBsb25nKWRhdGEpOworfQorCitzdGF0aWMgc3NpemVfdCBjb3VudGVy
X2NvbXBfdTY0X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkgICAgICBzdHJ1Y3QgZGV2
aWNlX2F0dHJpYnV0ZSAqYXR0ciwKKwkJCQkgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBs
ZW4pCit7CisJY29uc3Qgc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlICpjb25zdCBhID0gdG9fY291
bnRlcl9hdHRyaWJ1dGUoYXR0cik7CisJc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3Vu
dGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7CisJaW50IGVycjsKKwl1NjQgZGF0YSA9IDA7CisK
KwllcnIgPSBrc3RydG91NjQoYnVmLCAwLCAmZGF0YSk7CisJaWYgKGVyciA8IDApCisJCXJldHVy
biBlcnI7CisKKwlzd2l0Y2ggKGEtPnNjb3BlKSB7CisJY2FzZSBDT1VOVEVSX1NDT1BFX0RFVklD
RToKKwkJZXJyID0gYS0+Y29tcC5kZXZpY2VfdTY0X3dyaXRlKGNvdW50ZXIsIGRhdGEpOworCQli
cmVhazsKKwljYXNlIENPVU5URVJfU0NPUEVfU0lHTkFMOgorCQllcnIgPSBhLT5jb21wLnNpZ25h
bF91NjRfd3JpdGUoY291bnRlciwgYS0+cGFyZW50LCBkYXRhKTsKKwkJYnJlYWs7CisJY2FzZSBD
T1VOVEVSX1NDT1BFX0NPVU5UOgorCQllcnIgPSBhLT5jb21wLmNvdW50X3U2NF93cml0ZShjb3Vu
dGVyLCBhLT5wYXJlbnQsIGRhdGEpOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlyZXR1cm4gLUVJ
TlZBTDsKKwl9CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwlyZXR1cm4gbGVuOwor
fQorCitzdGF0aWMgc3NpemVfdCBlbnVtc19hdmFpbGFibGVfc2hvdyhjb25zdCB1MzIgKmNvbnN0
IGVudW1zLAorCQkJCSAgICBjb25zdCBzaXplX3QgbnVtX2VudW1zLAorCQkJCSAgICBjb25zdCBj
aGFyICpjb25zdCBzdHJzW10sIGNoYXIgKmJ1ZikKK3sKKwlzaXplX3QgbGVuID0gMDsKKwlzaXpl
X3QgaW5kZXg7CisKKwlmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBudW1fZW51bXM7IGluZGV4Kysp
CisJCWxlbiArPSBzeXNmc19lbWl0X2F0KGJ1ZiwgbGVuLCAiJXNcbiIsIHN0cnNbZW51bXNbaW5k
ZXhdXSk7CisKKwlyZXR1cm4gbGVuOworfQorCitzdGF0aWMgc3NpemVfdCBzdHJzX2F2YWlsYWJs
ZV9zaG93KGNvbnN0IHN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSAqY29uc3QgYXZhaWwsCisJCQkJ
ICAgY2hhciAqYnVmKQoreworCXNpemVfdCBsZW4gPSAwOworCXNpemVfdCBpbmRleDsKKworCWZv
ciAoaW5kZXggPSAwOyBpbmRleCA8IGF2YWlsLT5udW1faXRlbXM7IGluZGV4KyspCisJCWxlbiAr
PSBzeXNmc19lbWl0X2F0KGJ1ZiwgbGVuLCAiJXNcbiIsIGF2YWlsLT5zdHJzW2luZGV4XSk7CisK
KwlyZXR1cm4gbGVuOworfQorCitzdGF0aWMgc3NpemVfdCBjb3VudGVyX2NvbXBfYXZhaWxhYmxl
X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAorCQkJCQkgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0
ZSAqYXR0ciwKKwkJCQkJICAgY2hhciAqYnVmKQoreworCWNvbnN0IHN0cnVjdCBjb3VudGVyX2F0
dHJpYnV0ZSAqY29uc3QgYSA9IHRvX2NvdW50ZXJfYXR0cmlidXRlKGF0dHIpOworCWNvbnN0IHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCA9IGEtPnBhcmVudDsKKwljb25zdCBzdHJ1
Y3QgY291bnRlcl9zeW5hcHNlICpjb25zdCBzeW5hcHNlID0gYS0+Y29tcC5wcml2OworCWNvbnN0
IHN0cnVjdCBjb3VudGVyX2F2YWlsYWJsZSAqY29uc3QgYXZhaWwgPSBhLT5jb21wLnByaXY7CisK
Kwlzd2l0Y2ggKGEtPmNvbXAudHlwZSkgeworCWNhc2UgQ09VTlRFUl9DT01QX0ZVTkNUSU9OOgor
CQlyZXR1cm4gZW51bXNfYXZhaWxhYmxlX3Nob3coY291bnQtPmZ1bmN0aW9uc19saXN0LAorCQkJ
CQkgICAgY291bnQtPm51bV9mdW5jdGlvbnMsCisJCQkJCSAgICBjb3VudGVyX2Z1bmN0aW9uX3N0
ciwgYnVmKTsKKwljYXNlIENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjoKKwkJcmV0dXJuIGVu
dW1zX2F2YWlsYWJsZV9zaG93KHN5bmFwc2UtPmFjdGlvbnNfbGlzdCwKKwkJCQkJICAgIHN5bmFw
c2UtPm51bV9hY3Rpb25zLAorCQkJCQkgICAgY291bnRlcl9zeW5hcHNlX2FjdGlvbl9zdHIsIGJ1
Zik7CisJY2FzZSBDT1VOVEVSX0NPTVBfRU5VTToKKwkJcmV0dXJuIHN0cnNfYXZhaWxhYmxlX3No
b3coYXZhaWwsIGJ1Zik7CisJY2FzZSBDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERToKKwkJcmV0dXJu
IGVudW1zX2F2YWlsYWJsZV9zaG93KGF2YWlsLT5lbnVtcywgYXZhaWwtPm51bV9pdGVtcywKKwkJ
CQkJICAgIGNvdW50ZXJfY291bnRfbW9kZV9zdHIsIGJ1Zik7CisJZGVmYXVsdDoKKwkJcmV0dXJu
IC1FSU5WQUw7CisJfQorfQorCitzdGF0aWMgaW50IGNvdW50ZXJfYXZhaWxfYXR0cl9jcmVhdGUo
c3RydWN0IGRldmljZSAqY29uc3QgZGV2LAorCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91
cCAqY29uc3QgZ3JvdXAsCisJY29uc3Qgc3RydWN0IGNvdW50ZXJfY29tcCAqY29uc3QgY29tcCwg
dm9pZCAqY29uc3QgcGFyZW50KQoreworCXN0cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY291bnRl
cl9hdHRyOworCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICpkZXZfYXR0cjsKKworCS8qIEFsbG9j
YXRlIENvdW50ZXIgYXR0cmlidXRlICovCisJY291bnRlcl9hdHRyID0gZGV2bV9remFsbG9jKGRl
diwgc2l6ZW9mKCpjb3VudGVyX2F0dHIpLCBHRlBfS0VSTkVMKTsKKwlpZiAoIWNvdW50ZXJfYXR0
cikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwkvKiBDb25maWd1cmUgQ291bnRlciBhdHRyaWJ1dGUg
Ki8KKwljb3VudGVyX2F0dHItPmNvbXAudHlwZSA9IGNvbXAtPnR5cGU7CisJY291bnRlcl9hdHRy
LT5jb21wLnByaXYgPSBjb21wLT5wcml2OworCWNvdW50ZXJfYXR0ci0+cGFyZW50ID0gcGFyZW50
OworCisJLyogSW5pdGlhbGl6ZSBzeXNmcyBhdHRyaWJ1dGUgKi8KKwlkZXZfYXR0ciA9ICZjb3Vu
dGVyX2F0dHItPmRldl9hdHRyOworCXN5c2ZzX2F0dHJfaW5pdCgmZGV2X2F0dHItPmF0dHIpOwor
CisJLyogQ29uZmlndXJlIGRldmljZSBhdHRyaWJ1dGUgKi8KKwlkZXZfYXR0ci0+YXR0ci5uYW1l
ID0gZGV2bV9rYXNwcmludGYoZGV2LCBHRlBfS0VSTkVMLCAiJXNfYXZhaWxhYmxlIiwKKwkJCQkJ
ICAgICBjb21wLT5uYW1lKTsKKwlpZiAoIWRldl9hdHRyLT5hdHRyLm5hbWUpCisJCXJldHVybiAt
RU5PTUVNOworCWRldl9hdHRyLT5hdHRyLm1vZGUgPSAwNDQ0OworCWRldl9hdHRyLT5zaG93ID0g
Y291bnRlcl9jb21wX2F2YWlsYWJsZV9zaG93OworCisJLyogU3RvcmUgbGlzdCBub2RlICovCisJ
bGlzdF9hZGQoJmNvdW50ZXJfYXR0ci0+bCwgJmdyb3VwLT5hdHRyX2xpc3QpOworCWdyb3VwLT5u
dW1fYXR0cisrOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgY291bnRlcl9hdHRyX2Ny
ZWF0ZShzdHJ1Y3QgZGV2aWNlICpjb25zdCBkZXYsCisJCQkgICAgICAgc3RydWN0IGNvdW50ZXJf
YXR0cmlidXRlX2dyb3VwICpjb25zdCBncm91cCwKKwkJCSAgICAgICBjb25zdCBzdHJ1Y3QgY291
bnRlcl9jb21wICpjb25zdCBjb21wLAorCQkJICAgICAgIGNvbnN0IGVudW0gY291bnRlcl9zY29w
ZSBzY29wZSwKKwkJCSAgICAgICB2b2lkICpjb25zdCBwYXJlbnQpCit7CisJc3RydWN0IGNvdW50
ZXJfYXR0cmlidXRlICpjb3VudGVyX2F0dHI7CisJc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmRl
dl9hdHRyOworCisJLyogQWxsb2NhdGUgQ291bnRlciBhdHRyaWJ1dGUgKi8KKwljb3VudGVyX2F0
dHIgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmNvdW50ZXJfYXR0ciksIEdGUF9LRVJORUwp
OworCWlmICghY291bnRlcl9hdHRyKQorCQlyZXR1cm4gLUVOT01FTTsKKworCS8qIENvbmZpZ3Vy
ZSBDb3VudGVyIGF0dHJpYnV0ZSAqLworCWNvdW50ZXJfYXR0ci0+Y29tcCA9ICpjb21wOworCWNv
dW50ZXJfYXR0ci0+c2NvcGUgPSBzY29wZTsKKwljb3VudGVyX2F0dHItPnBhcmVudCA9IHBhcmVu
dDsKKworCS8qIENvbmZpZ3VyZSBkZXZpY2UgYXR0cmlidXRlICovCisJZGV2X2F0dHIgPSAmY291
bnRlcl9hdHRyLT5kZXZfYXR0cjsKKwlzeXNmc19hdHRyX2luaXQoJmRldl9hdHRyLT5hdHRyKTsK
KwlkZXZfYXR0ci0+YXR0ci5uYW1lID0gY29tcC0+bmFtZTsKKwlzd2l0Y2ggKGNvbXAtPnR5cGUp
IHsKKwljYXNlIENPVU5URVJfQ09NUF9VODoKKwljYXNlIENPVU5URVJfQ09NUF9CT09MOgorCQlp
ZiAoY29tcC0+ZGV2aWNlX3U4X3JlYWQpIHsKKwkJCWRldl9hdHRyLT5hdHRyLm1vZGUgfD0gMDQ0
NDsKKwkJCWRldl9hdHRyLT5zaG93ID0gY291bnRlcl9jb21wX3U4X3Nob3c7CisJCX0KKwkJaWYg
KGNvbXAtPmRldmljZV91OF93cml0ZSkgeworCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAw
OworCQkJZGV2X2F0dHItPnN0b3JlID0gY291bnRlcl9jb21wX3U4X3N0b3JlOworCQl9CisJCWJy
ZWFrOworCWNhc2UgQ09VTlRFUl9DT01QX1NJR05BTF9MRVZFTDoKKwljYXNlIENPVU5URVJfQ09N
UF9GVU5DVElPTjoKKwljYXNlIENPVU5URVJfQ09NUF9TWU5BUFNFX0FDVElPTjoKKwljYXNlIENP
VU5URVJfQ09NUF9FTlVNOgorCWNhc2UgQ09VTlRFUl9DT01QX0NPVU5UX0RJUkVDVElPTjoKKwlj
YXNlIENPVU5URVJfQ09NUF9DT1VOVF9NT0RFOgorCQlpZiAoY29tcC0+ZGV2aWNlX3UzMl9yZWFk
KSB7CisJCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDA0NDQ7CisJCQlkZXZfYXR0ci0+c2hvdyA9
IGNvdW50ZXJfY29tcF91MzJfc2hvdzsKKwkJfQorCQlpZiAoY29tcC0+ZGV2aWNlX3UzMl93cml0
ZSkgeworCQkJZGV2X2F0dHItPmF0dHIubW9kZSB8PSAwMjAwOworCQkJZGV2X2F0dHItPnN0b3Jl
ID0gY291bnRlcl9jb21wX3UzMl9zdG9yZTsKKwkJfQorCQlicmVhazsKKwljYXNlIENPVU5URVJf
Q09NUF9VNjQ6CisJCWlmIChjb21wLT5kZXZpY2VfdTY0X3JlYWQpIHsKKwkJCWRldl9hdHRyLT5h
dHRyLm1vZGUgfD0gMDQ0NDsKKwkJCWRldl9hdHRyLT5zaG93ID0gY291bnRlcl9jb21wX3U2NF9z
aG93OworCQl9CisJCWlmIChjb21wLT5kZXZpY2VfdTY0X3dyaXRlKSB7CisJCQlkZXZfYXR0ci0+
YXR0ci5tb2RlIHw9IDAyMDA7CisJCQlkZXZfYXR0ci0+c3RvcmUgPSBjb3VudGVyX2NvbXBfdTY0
X3N0b3JlOworCQl9CisJCWJyZWFrOworCWRlZmF1bHQ6CisJCXJldHVybiAtRUlOVkFMOworCX0K
KworCS8qIFN0b3JlIGxpc3Qgbm9kZSAqLworCWxpc3RfYWRkKCZjb3VudGVyX2F0dHItPmwsICZn
cm91cC0+YXR0cl9saXN0KTsKKwlncm91cC0+bnVtX2F0dHIrKzsKKworCS8qIENyZWF0ZSAiKl9h
dmFpbGFibGUiIGF0dHJpYnV0ZSBpZiBuZWVkZWQgKi8KKwlzd2l0Y2ggKGNvbXAtPnR5cGUpIHsK
KwljYXNlIENPVU5URVJfQ09NUF9GVU5DVElPTjoKKwljYXNlIENPVU5URVJfQ09NUF9TWU5BUFNF
X0FDVElPTjoKKwljYXNlIENPVU5URVJfQ09NUF9FTlVNOgorCWNhc2UgQ09VTlRFUl9DT01QX0NP
VU5UX01PREU6CisJCXJldHVybiBjb3VudGVyX2F2YWlsX2F0dHJfY3JlYXRlKGRldiwgZ3JvdXAs
IGNvbXAsIHBhcmVudCk7CisJZGVmYXVsdDoKKwkJcmV0dXJuIDA7CisJfQorfQorCitzdGF0aWMg
c3NpemVfdCBjb3VudGVyX2NvbXBfbmFtZV9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKKwkJCQkg
ICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQoreworCXJldHVy
biBzeXNmc19lbWl0KGJ1ZiwgIiVzXG4iLCB0b19jb3VudGVyX2F0dHJpYnV0ZShhdHRyKS0+Y29t
cC5uYW1lKTsKK30KKworc3RhdGljIGludCBjb3VudGVyX25hbWVfYXR0cl9jcmVhdGUoc3RydWN0
IGRldmljZSAqY29uc3QgZGV2LAorCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3Jv
dXAgKmNvbnN0IGdyb3VwLAorCQkJCSAgICBjb25zdCBjaGFyICpjb25zdCBuYW1lKQoreworCXN0
cnVjdCBjb3VudGVyX2F0dHJpYnV0ZSAqY291bnRlcl9hdHRyOworCisJLyogQWxsb2NhdGUgQ291
bnRlciBhdHRyaWJ1dGUgKi8KKwljb3VudGVyX2F0dHIgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXpl
b2YoKmNvdW50ZXJfYXR0ciksIEdGUF9LRVJORUwpOworCWlmICghY291bnRlcl9hdHRyKQorCQly
ZXR1cm4gLUVOT01FTTsKKworCS8qIENvbmZpZ3VyZSBDb3VudGVyIGF0dHJpYnV0ZSAqLworCWNv
dW50ZXJfYXR0ci0+Y29tcC5uYW1lID0gbmFtZTsKKworCS8qIENvbmZpZ3VyZSBkZXZpY2UgYXR0
cmlidXRlICovCisJc3lzZnNfYXR0cl9pbml0KCZjb3VudGVyX2F0dHItPmRldl9hdHRyLmF0dHIp
OworCWNvdW50ZXJfYXR0ci0+ZGV2X2F0dHIuYXR0ci5uYW1lID0gIm5hbWUiOworCWNvdW50ZXJf
YXR0ci0+ZGV2X2F0dHIuYXR0ci5tb2RlID0gMDQ0NDsKKwljb3VudGVyX2F0dHItPmRldl9hdHRy
LnNob3cgPSBjb3VudGVyX2NvbXBfbmFtZV9zaG93OworCisJLyogU3RvcmUgbGlzdCBub2RlICov
CisJbGlzdF9hZGQoJmNvdW50ZXJfYXR0ci0+bCwgJmdyb3VwLT5hdHRyX2xpc3QpOworCWdyb3Vw
LT5udW1fYXR0cisrOworCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgY291bnRlcl9j
b21wIGNvdW50ZXJfc2lnbmFsX2NvbXAgPSB7CisJLnR5cGUgPSBDT1VOVEVSX0NPTVBfU0lHTkFM
X0xFVkVMLAorCS5uYW1lID0gInNpZ25hbCIsCit9OworCitzdGF0aWMgaW50IGNvdW50ZXJfc2ln
bmFsX2F0dHJzX2NyZWF0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIsCisJ
c3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dyb3VwICpjb25zdCBncm91cCwKKwlzdHJ1Y3QgY291
bnRlcl9zaWduYWwgKmNvbnN0IHNpZ25hbCkKK3sKKwljb25zdCBlbnVtIGNvdW50ZXJfc2NvcGUg
c2NvcGUgPSBDT1VOVEVSX1NDT1BFX1NJR05BTDsKKwlzdHJ1Y3QgZGV2aWNlICpjb25zdCBkZXYg
PSAmY291bnRlci0+ZGV2OworCWludCBlcnI7CisJc3RydWN0IGNvdW50ZXJfY29tcCBjb21wOwor
CXNpemVfdCBpOworCisJLyogQ3JlYXRlIG1haW4gU2lnbmFsIGF0dHJpYnV0ZSAqLworCWNvbXAg
PSBjb3VudGVyX3NpZ25hbF9jb21wOworCWNvbXAuc2lnbmFsX3UzMl9yZWFkID0gY291bnRlci0+
b3BzLT5zaWduYWxfcmVhZDsKKwllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgZ3JvdXAs
ICZjb21wLCBzY29wZSwgc2lnbmFsKTsKKwlpZiAoZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKwor
CS8qIENyZWF0ZSBTaWduYWwgbmFtZSBhdHRyaWJ1dGUgKi8KKwllcnIgPSBjb3VudGVyX25hbWVf
YXR0cl9jcmVhdGUoZGV2LCBncm91cCwgc2lnbmFsLT5uYW1lKTsKKwlpZiAoZXJyIDwgMCkKKwkJ
cmV0dXJuIGVycjsKKworCS8qIENyZWF0ZSBhbiBhdHRyaWJ1dGUgZm9yIGVhY2ggZXh0ZW5zaW9u
ICovCisJZm9yIChpID0gMDsgaSA8IHNpZ25hbC0+bnVtX2V4dDsgaSsrKSB7CisJCWVyciA9IGNv
dW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBncm91cCwgc2lnbmFsLT5leHQgKyBpLCBzY29wZSwKKwkJ
CQkJICBzaWduYWwpOworCQlpZiAoZXJyIDwgMCkKKwkJCXJldHVybiBlcnI7CisJfQorCisJcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgY291bnRlcl9zeXNmc19zaWduYWxzX2FkZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIsCisJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRl
X2dyb3VwICpjb25zdCBncm91cHMpCit7CisJc2l6ZV90IGk7CisJaW50IGVycjsKKworCS8qIEFk
ZCBlYWNoIFNpZ25hbCAqLworCWZvciAoaSA9IDA7IGkgPCBjb3VudGVyLT5udW1fc2lnbmFsczsg
aSsrKSB7CisJCS8qIEdlbmVyYXRlIFNpZ25hbCBhdHRyaWJ1dGUgZGlyZWN0b3J5IG5hbWUgKi8K
KwkJZ3JvdXBzW2ldLm5hbWUgPSBkZXZtX2thc3ByaW50ZigmY291bnRlci0+ZGV2LCBHRlBfS0VS
TkVMLAorCQkJCQkJInNpZ25hbCV6dSIsIGkpOworCQlpZiAoIWdyb3Vwc1tpXS5uYW1lKQorCQkJ
cmV0dXJuIC1FTk9NRU07CisKKwkJLyogQ3JlYXRlIGFsbCBhdHRyaWJ1dGVzIGFzc29jaWF0ZWQg
d2l0aCBTaWduYWwgKi8KKwkJZXJyID0gY291bnRlcl9zaWduYWxfYXR0cnNfY3JlYXRlKGNvdW50
ZXIsIGdyb3VwcyArIGksCisJCQkJCQkgIGNvdW50ZXItPnNpZ25hbHMgKyBpKTsKKwkJaWYgKGVy
ciA8IDApCisJCQlyZXR1cm4gZXJyOworCX0KKworCXJldHVybiAwOworfQorCitzdGF0aWMgaW50
IGNvdW50ZXJfc3lzZnNfc3luYXBzZXNfYWRkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3Qg
Y291bnRlciwKKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGVfZ3JvdXAgKmNvbnN0IGdyb3VwLAor
CXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCkKK3sKKwlzaXplX3QgaTsKKworCS8q
IEFkZCBlYWNoIFN5bmFwc2UgKi8KKwlmb3IgKGkgPSAwOyBpIDwgY291bnQtPm51bV9zeW5hcHNl
czsgaSsrKSB7CisJCXN0cnVjdCBkZXZpY2UgKmNvbnN0IGRldiA9ICZjb3VudGVyLT5kZXY7CisJ
CXN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2U7CisJCXNpemVfdCBpZDsKKwkJc3RydWN0
IGNvdW50ZXJfY29tcCBjb21wOworCQlpbnQgZXJyOworCisJCXN5bmFwc2UgPSBjb3VudC0+c3lu
YXBzZXMgKyBpOworCisJCS8qIEdlbmVyYXRlIFN5bmFwc2UgYWN0aW9uIG5hbWUgKi8KKwkJaWQg
PSBzeW5hcHNlLT5zaWduYWwgLSBjb3VudGVyLT5zaWduYWxzOworCQljb21wLm5hbWUgPSBkZXZt
X2thc3ByaW50ZihkZXYsIEdGUF9LRVJORUwsICJzaWduYWwlenVfYWN0aW9uIiwKKwkJCQkJICAg
aWQpOworCQlpZiAoIWNvbXAubmFtZSkKKwkJCXJldHVybiAtRU5PTUVNOworCisJCS8qIENyZWF0
ZSBhY3Rpb24gYXR0cmlidXRlICovCisJCWNvbXAudHlwZSA9IENPVU5URVJfQ09NUF9TWU5BUFNF
X0FDVElPTjsKKwkJY29tcC5hY3Rpb25fcmVhZCA9IGNvdW50ZXItPm9wcy0+YWN0aW9uX3JlYWQ7
CisJCWNvbXAuYWN0aW9uX3dyaXRlID0gY291bnRlci0+b3BzLT5hY3Rpb25fd3JpdGU7CisJCWNv
bXAucHJpdiA9IHN5bmFwc2U7CisJCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBncm91
cCwgJmNvbXAsCisJCQkJCSAgQ09VTlRFUl9TQ09QRV9DT1VOVCwgY291bnQpOworCQlpZiAoZXJy
IDwgMCkKKwkJCXJldHVybiBlcnI7CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBzdHJ1
Y3QgY291bnRlcl9jb21wIGNvdW50ZXJfY291bnRfY29tcCA9CisJQ09VTlRFUl9DT01QX0NPVU5U
X1U2NCgiY291bnQiLCBOVUxMLCBOVUxMKTsKKworc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAg
Y291bnRlcl9mdW5jdGlvbl9jb21wID0geworCS50eXBlID0gQ09VTlRFUl9DT01QX0ZVTkNUSU9O
LAorCS5uYW1lID0gImZ1bmN0aW9uIiwKK307CisKK3N0YXRpYyBpbnQgY291bnRlcl9jb3VudF9h
dHRyc19jcmVhdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyLAorCXN0cnVj
dCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqY29uc3QgZ3JvdXAsCisJc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvbnN0IGNvdW50KQoreworCWNvbnN0IGVudW0gY291bnRlcl9zY29wZSBzY29wZSA9
IENPVU5URVJfU0NPUEVfQ09VTlQ7CisJc3RydWN0IGRldmljZSAqY29uc3QgZGV2ID0gJmNvdW50
ZXItPmRldjsKKwlpbnQgZXJyOworCXN0cnVjdCBjb3VudGVyX2NvbXAgY29tcDsKKwlzaXplX3Qg
aTsKKworCS8qIENyZWF0ZSBtYWluIENvdW50IGF0dHJpYnV0ZSAqLworCWNvbXAgPSBjb3VudGVy
X2NvdW50X2NvbXA7CisJY29tcC5jb3VudF91NjRfcmVhZCA9IGNvdW50ZXItPm9wcy0+Y291bnRf
cmVhZDsKKwljb21wLmNvdW50X3U2NF93cml0ZSA9IGNvdW50ZXItPm9wcy0+Y291bnRfd3JpdGU7
CisJZXJyID0gY291bnRlcl9hdHRyX2NyZWF0ZShkZXYsIGdyb3VwLCAmY29tcCwgc2NvcGUsIGNv
dW50KTsKKwlpZiAoZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKworCS8qIENyZWF0ZSBDb3VudCBu
YW1lIGF0dHJpYnV0ZSAqLworCWVyciA9IGNvdW50ZXJfbmFtZV9hdHRyX2NyZWF0ZShkZXYsIGdy
b3VwLCBjb3VudC0+bmFtZSk7CisJaWYgKGVyciA8IDApCisJCXJldHVybiBlcnI7CisKKwkvKiBD
cmVhdGUgQ291bnQgZnVuY3Rpb24gYXR0cmlidXRlICovCisJY29tcCA9IGNvdW50ZXJfZnVuY3Rp
b25fY29tcDsKKwljb21wLmNvdW50X3UzMl9yZWFkID0gY291bnRlci0+b3BzLT5mdW5jdGlvbl9y
ZWFkOworCWNvbXAuY291bnRfdTMyX3dyaXRlID0gY291bnRlci0+b3BzLT5mdW5jdGlvbl93cml0
ZTsKKwllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgZ3JvdXAsICZjb21wLCBzY29wZSwg
Y291bnQpOworCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJLyogQ3JlYXRlIGFuIGF0
dHJpYnV0ZSBmb3IgZWFjaCBleHRlbnNpb24gKi8KKwlmb3IgKGkgPSAwOyBpIDwgY291bnQtPm51
bV9leHQ7IGkrKykgeworCQllcnIgPSBjb3VudGVyX2F0dHJfY3JlYXRlKGRldiwgZ3JvdXAsIGNv
dW50LT5leHQgKyBpLCBzY29wZSwKKwkJCQkJICBjb3VudCk7CisJCWlmIChlcnIgPCAwKQorCQkJ
cmV0dXJuIGVycjsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBjb3VudGVyX3N5
c2ZzX2NvdW50c19hZGQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyLAorCXN0
cnVjdCBjb3VudGVyX2F0dHJpYnV0ZV9ncm91cCAqY29uc3QgZ3JvdXBzKQoreworCXNpemVfdCBp
OworCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKKwlpbnQgZXJyOworCisJLyogQWRkIGVh
Y2ggQ291bnQgKi8KKwlmb3IgKGkgPSAwOyBpIDwgY291bnRlci0+bnVtX2NvdW50czsgaSsrKSB7
CisJCWNvdW50ID0gY291bnRlci0+Y291bnRzICsgaTsKKworCQkvKiBHZW5lcmF0ZSBDb3VudCBh
dHRyaWJ1dGUgZGlyZWN0b3J5IG5hbWUgKi8KKwkJZ3JvdXBzW2ldLm5hbWUgPSBkZXZtX2thc3By
aW50ZigmY291bnRlci0+ZGV2LCBHRlBfS0VSTkVMLAorCQkJCQkJImNvdW50JXp1IiwgaSk7CisJ
CWlmICghZ3JvdXBzW2ldLm5hbWUpCisJCQlyZXR1cm4gLUVOT01FTTsKKworCQkvKiBBZGQgc3lz
ZnMgYXR0cmlidXRlcyBvZiB0aGUgU3luYXBzZXMgKi8KKwkJZXJyID0gY291bnRlcl9zeXNmc19z
eW5hcHNlc19hZGQoY291bnRlciwgZ3JvdXBzICsgaSwgY291bnQpOworCQlpZiAoZXJyIDwgMCkK
KwkJCXJldHVybiBlcnI7CisKKwkJLyogQ3JlYXRlIGFsbCBhdHRyaWJ1dGVzIGFzc29jaWF0ZWQg
d2l0aCBDb3VudCAqLworCQllcnIgPSBjb3VudGVyX2NvdW50X2F0dHJzX2NyZWF0ZShjb3VudGVy
LCBncm91cHMgKyBpLCBjb3VudCk7CisJCWlmIChlcnIgPCAwKQorCQkJcmV0dXJuIGVycjsKKwl9
CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBjb3VudGVyX251bV9zaWduYWxzX3JlYWQo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB1OCAqdmFsKQoreworCSp2YWwgPSBjb3Vu
dGVyLT5udW1fc2lnbmFsczsKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGludCBjb3VudGVyX251
bV9jb3VudHNfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHU4ICp2YWwpCit7
CisJKnZhbCA9IGNvdW50ZXItPm51bV9jb3VudHM7CisJcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBz
dHJ1Y3QgY291bnRlcl9jb21wIGNvdW50ZXJfbnVtX3NpZ25hbHNfY29tcCA9CisJQ09VTlRFUl9D
T01QX0RFVklDRV9VOCgibnVtX3NpZ25hbHMiLCBjb3VudGVyX251bV9zaWduYWxzX3JlYWQsIE5V
TEwpOworCitzdGF0aWMgc3RydWN0IGNvdW50ZXJfY29tcCBjb3VudGVyX251bV9jb3VudHNfY29t
cCA9CisJQ09VTlRFUl9DT01QX0RFVklDRV9VOCgibnVtX2NvdW50cyIsIGNvdW50ZXJfbnVtX2Nv
dW50c19yZWFkLCBOVUxMKTsKKworc3RhdGljIGludCBjb3VudGVyX3N5c2ZzX2F0dHJfYWRkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciwKKwkJCQkgIHN0cnVjdCBjb3VudGVy
X2F0dHJpYnV0ZV9ncm91cCAqZ3JvdXApCit7CisJY29uc3QgZW51bSBjb3VudGVyX3Njb3BlIHNj
b3BlID0gQ09VTlRFUl9TQ09QRV9ERVZJQ0U7CisJc3RydWN0IGRldmljZSAqY29uc3QgZGV2ID0g
JmNvdW50ZXItPmRldjsKKwlpbnQgZXJyOworCXNpemVfdCBpOworCisJLyogQWRkIFNpZ25hbHMg
c3lzZnMgYXR0cmlidXRlcyAqLworCWVyciA9IGNvdW50ZXJfc3lzZnNfc2lnbmFsc19hZGQoY291
bnRlciwgZ3JvdXApOworCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCWdyb3VwICs9IGNv
dW50ZXItPm51bV9zaWduYWxzOworCisJLyogQWRkIENvdW50cyBzeXNmcyBhdHRyaWJ1dGVzICov
CisJZXJyID0gY291bnRlcl9zeXNmc19jb3VudHNfYWRkKGNvdW50ZXIsIGdyb3VwKTsKKwlpZiAo
ZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKwlncm91cCArPSBjb3VudGVyLT5udW1fY291bnRzOwor
CisJLyogQ3JlYXRlIG5hbWUgYXR0cmlidXRlICovCisJZXJyID0gY291bnRlcl9uYW1lX2F0dHJf
Y3JlYXRlKGRldiwgZ3JvdXAsIGNvdW50ZXItPm5hbWUpOworCWlmIChlcnIgPCAwKQorCQlyZXR1
cm4gZXJyOworCisJLyogQ3JlYXRlIG51bV9zaWduYWxzIGF0dHJpYnV0ZSAqLworCWVyciA9IGNv
dW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBncm91cCwgJmNvdW50ZXJfbnVtX3NpZ25hbHNfY29tcCwg
c2NvcGUsCisJCQkJICBOVUxMKTsKKwlpZiAoZXJyIDwgMCkKKwkJcmV0dXJuIGVycjsKKworCS8q
IENyZWF0ZSBudW1fY291bnRzIGF0dHJpYnV0ZSAqLworCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVh
dGUoZGV2LCBncm91cCwgJmNvdW50ZXJfbnVtX2NvdW50c19jb21wLCBzY29wZSwKKwkJCQkgIE5V
TEwpOworCWlmIChlcnIgPCAwKQorCQlyZXR1cm4gZXJyOworCisJLyogQ3JlYXRlIGFuIGF0dHJp
YnV0ZSBmb3IgZWFjaCBleHRlbnNpb24gKi8KKwlmb3IgKGkgPSAwOyBpIDwgY291bnRlci0+bnVt
X2V4dDsgaSsrKSB7CisJCWVyciA9IGNvdW50ZXJfYXR0cl9jcmVhdGUoZGV2LCBncm91cCwgY291
bnRlci0+ZXh0ICsgaSwgc2NvcGUsCisJCQkJCSAgTlVMTCk7CisJCWlmIChlcnIgPCAwKQorCQkJ
cmV0dXJuIGVycjsKKwl9CisKKwlyZXR1cm4gMDsKK30KKworLyoqCisgKiBjb3VudGVyX3N5c2Zz
X2FkZCAtIEFkZHMgQ291bnRlciBzeXNmcyBhdHRyaWJ1dGVzIHRvIHRoZSBkZXZpY2Ugc3RydWN0
dXJlCisgKiBAY291bnRlcjoJUG9pbnRlciB0byB0aGUgQ291bnRlciBkZXZpY2Ugc3RydWN0dXJl
CisgKgorICogQ291bnRlciBzeXNmcyBhdHRyaWJ1dGVzIGFyZSBjcmVhdGVkIGFuZCBhZGRlZCB0
byB0aGUgcmVzcGVjdGl2ZSBkZXZpY2UKKyAqIHN0cnVjdHVyZSBmb3IgbGF0ZXIgcmVnaXN0cmF0
aW9uIHRvIHRoZSBzeXN0ZW0uIFJlc291cmNlLW1hbmFnZWQgbWVtb3J5CisgKiBhbGxvY2F0aW9u
IGlzIHBlcmZvcm1lZCBieSB0aGlzIGZ1bmN0aW9uLCBhbmQgdGhpcyBtZW1vcnkgc2hvdWxkIGJl
IGZyZWVkCisgKiB3aGVuIG5vIGxvbmdlciBuZWVkZWQgKGF1dG9tYXRpY2FsbHkgYnkgYSBkZXZp
Y2VfdW5yZWdpc3RlciBjYWxsLCBvcgorICogbWFudWFsbHkgYnkgYSBkZXZyZXNfcmVsZWFzZV9h
bGwgY2FsbCkuCisgKi8KK2ludCBjb3VudGVyX3N5c2ZzX2FkZChzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvbnN0IGNvdW50ZXIpCit7CisJc3RydWN0IGRldmljZSAqY29uc3QgZGV2ID0gJmNvdW50
ZXItPmRldjsKKwljb25zdCBzaXplX3QgbnVtX2dyb3VwcyA9IGNvdW50ZXItPm51bV9zaWduYWxz
ICsgY291bnRlci0+bnVtX2NvdW50cyArIDE7CisJc3RydWN0IGNvdW50ZXJfYXR0cmlidXRlX2dy
b3VwICpncm91cHM7CisJc2l6ZV90IGksIGo7CisJaW50IGVycjsKKwlzdHJ1Y3QgYXR0cmlidXRl
X2dyb3VwICpncm91cDsKKwlzdHJ1Y3QgY291bnRlcl9hdHRyaWJ1dGUgKnA7CisKKwkvKiBBbGxv
Y2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIGdyb3VwcyAoc2lnbmFscywgY291bnRzLCBhbmQgZXh0
KSAqLworCWdyb3VwcyA9IGRldm1fa2NhbGxvYyhkZXYsIG51bV9ncm91cHMsIHNpemVvZigqZ3Jv
dXBzKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFncm91cHMpCisJCXJldHVybiAtRU5PTUVNOworCisJ
LyogSW5pdGlhbGl6ZSBhdHRyaWJ1dGUgbGlzdHMgKi8KKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2dy
b3VwczsgaSsrKQorCQlJTklUX0xJU1RfSEVBRCgmZ3JvdXBzW2ldLmF0dHJfbGlzdCk7CisKKwkv
KiBBZGQgQ291bnRlciBkZXZpY2Ugc3lzZnMgYXR0cmlidXRlcyAqLworCWVyciA9IGNvdW50ZXJf
c3lzZnNfYXR0cl9hZGQoY291bnRlciwgZ3JvdXBzKTsKKwlpZiAoZXJyIDwgMCkKKwkJcmV0dXJu
IGVycjsKKworCS8qIEFsbG9jYXRlIGF0dHJpYnV0ZSBncm91cHMgZm9yIGFzc29jaWF0aW9uIHdp
dGggZGV2aWNlICovCisJZGV2LT5ncm91cHMgPSBkZXZtX2tjYWxsb2MoZGV2LCBudW1fZ3JvdXBz
ICsgMSwgc2l6ZW9mKCpkZXYtPmdyb3VwcyksCisJCQkJICAgR0ZQX0tFUk5FTCk7CisJaWYgKCFk
ZXYtPmdyb3VwcykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwkvKiBQcmVwYXJlIGVhY2ggZ3JvdXAg
b2YgYXR0cmlidXRlcyBmb3IgYXNzb2NpYXRpb24gKi8KKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2dy
b3VwczsgaSsrKSB7CisJCS8qIEFsbG9jYXRlIHNwYWNlIGZvciBhdHRyaWJ1dGUgZ3JvdXAgKi8K
KwkJZ3JvdXAgPSBkZXZtX2t6YWxsb2MoZGV2LCBzaXplb2YoKmdyb3VwKSwgR0ZQX0tFUk5FTCk7
CisJCWlmICghZ3JvdXApCisJCQlyZXR1cm4gLUVOT01FTTsKKwkJZ3JvdXAtPm5hbWUgPSBncm91
cHNbaV0ubmFtZTsKKworCQkvKiBBbGxvY2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIHBvaW50ZXJz
ICovCisJCWdyb3VwLT5hdHRycyA9IGRldm1fa2NhbGxvYyhkZXYsIGdyb3Vwc1tpXS5udW1fYXR0
ciArIDEsCisJCQkJCSAgICBzaXplb2YoKmdyb3VwLT5hdHRycyksIEdGUF9LRVJORUwpOworCQlp
ZiAoIWdyb3VwLT5hdHRycykKKwkJCXJldHVybiAtRU5PTUVNOworCisJCS8qIEFkZCBhdHRyaWJ1
dGUgcG9pbnRlcnMgdG8gYXR0cmlidXRlIGdyb3VwICovCisJCWogPSAwOworCQlsaXN0X2Zvcl9l
YWNoX2VudHJ5KHAsICZncm91cHNbaV0uYXR0cl9saXN0LCBsKQorCQkJZ3JvdXAtPmF0dHJzW2or
K10gPSAmcC0+ZGV2X2F0dHIuYXR0cjsKKworCQkvKiBBc3NvY2lhdGUgYXR0cmlidXRlIGdyb3Vw
ICovCisJCWRldi0+Z3JvdXBzW2ldID0gZ3JvdXA7CisJfQorCisJcmV0dXJuIDA7Cit9CmRpZmYg
LS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci1zeXNmcy5oIGIvZHJpdmVycy9jb3VudGVy
L2NvdW50ZXItc3lzZnMuaApuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAu
LjE0ZmU1NjZhY2EwZQotLS0gL2Rldi9udWxsCisrKyBiL2RyaXZlcnMvY291bnRlci9jb3VudGVy
LXN5c2ZzLmgKQEAgLTAsMCArMSwxMyBAQAorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjAgKi8KKy8qCisgKiBDb3VudGVyIHN5c2ZzIGludGVyZmFjZQorICogQ29weXJpZ2h0IChD
KSAyMDIwIFdpbGxpYW0gQnJlYXRoaXR0IEdyYXkKKyAqLworI2lmbmRlZiBfQ09VTlRFUl9TWVNG
U19IXworI2RlZmluZSBfQ09VTlRFUl9TWVNGU19IXworCisjaW5jbHVkZSA8bGludXgvY291bnRl
ci5oPgorCitpbnQgY291bnRlcl9zeXNmc19hZGQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25z
dCBjb3VudGVyKTsKKworI2VuZGlmIC8qIF9DT1VOVEVSX1NZU0ZTX0hfICovCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2NvdW50ZXIvY291bnRlci5jIGIvZHJpdmVycy9jb3VudGVyL2NvdW50ZXIuYwpk
ZWxldGVkIGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggZGU5MjFlOGEzZjcyLi4wMDAwMDAwMDAwMDAK
LS0tIGEvZHJpdmVycy9jb3VudGVyL2NvdW50ZXIuYworKysgL2Rldi9udWxsCkBAIC0xLDE0OTYg
KzAsMCBAQAotLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAKLS8qCi0gKiBHZW5l
cmljIENvdW50ZXIgaW50ZXJmYWNlCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTggV2lsbGlhbSBCcmVh
dGhpdHQgR3JheQotICovCi0jaW5jbHVkZSA8bGludXgvY291bnRlci5oPgotI2luY2x1ZGUgPGxp
bnV4L2RldmljZS5oPgotI2luY2x1ZGUgPGxpbnV4L2Vyci5oPgotI2luY2x1ZGUgPGxpbnV4L2V4
cG9ydC5oPgotI2luY2x1ZGUgPGxpbnV4L2ZzLmg+Ci0jaW5jbHVkZSA8bGludXgvZ2ZwLmg+Ci0j
aW5jbHVkZSA8bGludXgvaWRyLmg+Ci0jaW5jbHVkZSA8bGludXgvaW5pdC5oPgotI2luY2x1ZGUg
PGxpbnV4L2tlcm5lbC5oPgotI2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4KLSNpbmNsdWRlIDxsaW51
eC9tb2R1bGUuaD4KLSNpbmNsdWRlIDxsaW51eC9wcmludGsuaD4KLSNpbmNsdWRlIDxsaW51eC9z
bGFiLmg+Ci0jaW5jbHVkZSA8bGludXgvc3RyaW5nLmg+Ci0jaW5jbHVkZSA8bGludXgvc3lzZnMu
aD4KLSNpbmNsdWRlIDxsaW51eC90eXBlcy5oPgotCi1jb25zdCBjaGFyICpjb25zdCBjb3VudGVy
X2NvdW50X2RpcmVjdGlvbl9zdHJbMl0gPSB7Ci0JW0NPVU5URVJfQ09VTlRfRElSRUNUSU9OX0ZP
UldBUkRdID0gImZvcndhcmQiLAotCVtDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9CQUNLV0FSRF0g
PSAiYmFja3dhcmQiCi19OwotRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9jb3VudF9kaXJlY3Rp
b25fc3RyKTsKLQotY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9jb3VudF9tb2RlX3N0cls0XSA9
IHsKLQlbQ09VTlRFUl9DT1VOVF9NT0RFX05PUk1BTF0gPSAibm9ybWFsIiwKLQlbQ09VTlRFUl9D
T1VOVF9NT0RFX1JBTkdFX0xJTUlUXSA9ICJyYW5nZSBsaW1pdCIsCi0JW0NPVU5URVJfQ09VTlRf
TU9ERV9OT05fUkVDWUNMRV0gPSAibm9uLXJlY3ljbGUiLAotCVtDT1VOVEVSX0NPVU5UX01PREVf
TU9EVUxPX05dID0gIm1vZHVsby1uIgotfTsKLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfY291
bnRfbW9kZV9zdHIpOwotCi1zc2l6ZV90IGNvdW50ZXJfc2lnbmFsX2VudW1fcmVhZChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2ln
bmFsLCB2b2lkICpwcml2LAotCQkJCSBjaGFyICpidWYpCi17Ci0JY29uc3Qgc3RydWN0IGNvdW50
ZXJfc2lnbmFsX2VudW1fZXh0ICpjb25zdCBlID0gcHJpdjsKLQlpbnQgZXJyOwotCXNpemVfdCBp
bmRleDsKLQotCWlmICghZS0+Z2V0KQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCWVyciA9IGUtPmdl
dChjb3VudGVyLCBzaWduYWwsICZpbmRleCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQot
CWlmIChpbmRleCA+PSBlLT5udW1faXRlbXMpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JcmV0dXJu
IHNwcmludGYoYnVmLCAiJXNcbiIsIGUtPml0ZW1zW2luZGV4XSk7Ci19Ci1FWFBPUlRfU1lNQk9M
X0dQTChjb3VudGVyX3NpZ25hbF9lbnVtX3JlYWQpOwotCi1zc2l6ZV90IGNvdW50ZXJfc2lnbmFs
X2VudW1fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCSAgc3RydWN0
IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHZvaWQgKnByaXYsCi0JCQkJICBjb25zdCBjaGFyICpi
dWYsIHNpemVfdCBsZW4pCi17Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0
ICpjb25zdCBlID0gcHJpdjsKLQlzc2l6ZV90IGluZGV4OwotCWludCBlcnI7Ci0KLQlpZiAoIWUt
PnNldCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQlpbmRleCA9IF9fc3lzZnNfbWF0Y2hfc3RyaW5n
KGUtPml0ZW1zLCBlLT5udW1faXRlbXMsIGJ1Zik7Ci0JaWYgKGluZGV4IDwgMCkKLQkJcmV0dXJu
IGluZGV4OwotCi0JZXJyID0gZS0+c2V0KGNvdW50ZXIsIHNpZ25hbCwgaW5kZXgpOwotCWlmIChl
cnIpCi0JCXJldHVybiBlcnI7Ci0KLQlyZXR1cm4gbGVuOwotfQotRVhQT1JUX1NZTUJPTF9HUEwo
Y291bnRlcl9zaWduYWxfZW51bV93cml0ZSk7Ci0KLXNzaXplX3QgY291bnRlcl9zaWduYWxfZW51
bV9hdmFpbGFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJCSAg
IHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsLAotCQkJCQkgICB2b2lkICpwcml2LCBjaGFy
ICpidWYpCi17Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0ICpjb25zdCBl
ID0gcHJpdjsKLQlzaXplX3QgaTsKLQlzaXplX3QgbGVuID0gMDsKLQotCWlmICghZS0+bnVtX2l0
ZW1zKQotCQlyZXR1cm4gMDsKLQotCWZvciAoaSA9IDA7IGkgPCBlLT5udW1faXRlbXM7IGkrKykK
LQkJbGVuICs9IHNwcmludGYoYnVmICsgbGVuLCAiJXNcbiIsIGUtPml0ZW1zW2ldKTsKLQotCXJl
dHVybiBsZW47Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3NpZ25hbF9lbnVtX2F2YWls
YWJsZV9yZWFkKTsKLQotc3NpemVfdCBjb3VudGVyX2NvdW50X2VudW1fcmVhZChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2
b2lkICpwcml2LAotCQkJCWNoYXIgKmJ1ZikKLXsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3Vu
dF9lbnVtX2V4dCAqY29uc3QgZSA9IHByaXY7Ci0JaW50IGVycjsKLQlzaXplX3QgaW5kZXg7Ci0K
LQlpZiAoIWUtPmdldCkKLQkJcmV0dXJuIC1FSU5WQUw7Ci0KLQllcnIgPSBlLT5nZXQoY291bnRl
ciwgY291bnQsICZpbmRleCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCWlmIChpbmRl
eCA+PSBlLT5udW1faXRlbXMpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JcmV0dXJuIHNwcmludGYo
YnVmLCAiJXNcbiIsIGUtPml0ZW1zW2luZGV4XSk7Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChjb3Vu
dGVyX2NvdW50X2VudW1fcmVhZCk7Ci0KLXNzaXplX3QgY291bnRlcl9jb3VudF9lbnVtX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LCB2b2lkICpwcml2LAotCQkJCSBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4p
Ci17Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2
OwotCXNzaXplX3QgaW5kZXg7Ci0JaW50IGVycjsKLQotCWlmICghZS0+c2V0KQotCQlyZXR1cm4g
LUVJTlZBTDsKLQotCWluZGV4ID0gX19zeXNmc19tYXRjaF9zdHJpbmcoZS0+aXRlbXMsIGUtPm51
bV9pdGVtcywgYnVmKTsKLQlpZiAoaW5kZXggPCAwKQotCQlyZXR1cm4gaW5kZXg7Ci0KLQllcnIg
PSBlLT5zZXQoY291bnRlciwgY291bnQsIGluZGV4KTsKLQlpZiAoZXJyKQotCQlyZXR1cm4gZXJy
OwotCi0JcmV0dXJuIGxlbjsKLX0KLUVYUE9SVF9TWU1CT0xfR1BMKGNvdW50ZXJfY291bnRfZW51
bV93cml0ZSk7Ci0KLXNzaXplX3QgY291bnRlcl9jb3VudF9lbnVtX2F2YWlsYWJsZV9yZWFkKHN0
cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCi0JCQkJCSAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKQotewotCWNvbnN0IHN0cnVj
dCBjb3VudGVyX2NvdW50X2VudW1fZXh0ICpjb25zdCBlID0gcHJpdjsKLQlzaXplX3QgaTsKLQlz
aXplX3QgbGVuID0gMDsKLQotCWlmICghZS0+bnVtX2l0ZW1zKQotCQlyZXR1cm4gMDsKLQotCWZv
ciAoaSA9IDA7IGkgPCBlLT5udW1faXRlbXM7IGkrKykKLQkJbGVuICs9IHNwcmludGYoYnVmICsg
bGVuLCAiJXNcbiIsIGUtPml0ZW1zW2ldKTsKLQotCXJldHVybiBsZW47Ci19Ci1FWFBPUlRfU1lN
Qk9MX0dQTChjb3VudGVyX2NvdW50X2VudW1fYXZhaWxhYmxlX3JlYWQpOwotCi1zc2l6ZV90IGNv
dW50ZXJfZGV2aWNlX2VudW1fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsIHZv
aWQgKnByaXYsCi0JCQkJIGNoYXIgKmJ1ZikKLXsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZp
Y2VfZW51bV9leHQgKmNvbnN0IGUgPSBwcml2OwotCWludCBlcnI7Ci0Jc2l6ZV90IGluZGV4Owot
Ci0JaWYgKCFlLT5nZXQpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JZXJyID0gZS0+Z2V0KGNvdW50
ZXIsICZpbmRleCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCWlmIChpbmRleCA+PSBl
LT5udW1faXRlbXMpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JcmV0dXJuIHNwcmludGYoYnVmLCAi
JXNcbiIsIGUtPml0ZW1zW2luZGV4XSk7Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX2Rl
dmljZV9lbnVtX3JlYWQpOwotCi1zc2l6ZV90IGNvdW50ZXJfZGV2aWNlX2VudW1fd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LAotCQkJCSAgY29uc3QgY2hh
ciAqYnVmLCBzaXplX3QgbGVuKQotewotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9lbnVt
X2V4dCAqY29uc3QgZSA9IHByaXY7Ci0Jc3NpemVfdCBpbmRleDsKLQlpbnQgZXJyOwotCi0JaWYg
KCFlLT5zZXQpCi0JCXJldHVybiAtRUlOVkFMOwotCi0JaW5kZXggPSBfX3N5c2ZzX21hdGNoX3N0
cmluZyhlLT5pdGVtcywgZS0+bnVtX2l0ZW1zLCBidWYpOwotCWlmIChpbmRleCA8IDApCi0JCXJl
dHVybiBpbmRleDsKLQotCWVyciA9IGUtPnNldChjb3VudGVyLCBpbmRleCk7Ci0JaWYgKGVycikK
LQkJcmV0dXJuIGVycjsKLQotCXJldHVybiBsZW47Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChjb3Vu
dGVyX2RldmljZV9lbnVtX3dyaXRlKTsKLQotc3NpemVfdCBjb3VudGVyX2RldmljZV9lbnVtX2F2
YWlsYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkJICAgdm9p
ZCAqcHJpdiwgY2hhciAqYnVmKQotewotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9lbnVt
X2V4dCAqY29uc3QgZSA9IHByaXY7Ci0Jc2l6ZV90IGk7Ci0Jc2l6ZV90IGxlbiA9IDA7Ci0KLQlp
ZiAoIWUtPm51bV9pdGVtcykKLQkJcmV0dXJuIDA7Ci0KLQlmb3IgKGkgPSAwOyBpIDwgZS0+bnVt
X2l0ZW1zOyBpKyspCi0JCWxlbiArPSBzcHJpbnRmKGJ1ZiArIGxlbiwgIiVzXG4iLCBlLT5pdGVt
c1tpXSk7Ci0KLQlyZXR1cm4gbGVuOwotfQotRVhQT1JUX1NZTUJPTF9HUEwoY291bnRlcl9kZXZp
Y2VfZW51bV9hdmFpbGFibGVfcmVhZCk7Ci0KLXN0cnVjdCBjb3VudGVyX2F0dHJfcGFybSB7Ci0J
c3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmdyb3VwOwotCWNvbnN0IGNoYXIgKnBy
ZWZpeDsKLQljb25zdCBjaGFyICpuYW1lOwotCXNzaXplX3QgKCpzaG93KShzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLAotCQkJY2hhciAqYnVmKTsKLQlz
c2l6ZV90ICgqc3RvcmUpKHN0cnVjdCBkZXZpY2UgKmRldiwgc3RydWN0IGRldmljZV9hdHRyaWJ1
dGUgKmF0dHIsCi0JCQkgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKTsKLQl2b2lkICpjb21w
b25lbnQ7Ci19OwotCi1zdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciB7Ci0Jc3RydWN0IGRldmlj
ZV9hdHRyaWJ1dGUgZGV2X2F0dHI7Ci0Jc3RydWN0IGxpc3RfaGVhZCBsOwotCXZvaWQgKmNvbXBv
bmVudDsKLX07Ci0KLXN0YXRpYyBpbnQgY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKGNvbnN0IHN0
cnVjdCBjb3VudGVyX2F0dHJfcGFybSAqY29uc3QgcGFybSkKLXsKLQlzdHJ1Y3QgY291bnRlcl9k
ZXZpY2VfYXR0ciAqY291bnRlcl9hdHRyOwotCXN0cnVjdCBkZXZpY2VfYXR0cmlidXRlICpkZXZf
YXR0cjsKLQlpbnQgZXJyOwotCXN0cnVjdCBsaXN0X2hlYWQgKmNvbnN0IGF0dHJfbGlzdCA9ICZw
YXJtLT5ncm91cC0+YXR0cl9saXN0OwotCi0JLyogQWxsb2NhdGUgYSBDb3VudGVyIGRldmljZSBh
dHRyaWJ1dGUgKi8KLQljb3VudGVyX2F0dHIgPSBremFsbG9jKHNpemVvZigqY291bnRlcl9hdHRy
KSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFjb3VudGVyX2F0dHIpCi0JCXJldHVybiAtRU5PTUVNOwot
CWRldl9hdHRyID0gJmNvdW50ZXJfYXR0ci0+ZGV2X2F0dHI7Ci0KLQlzeXNmc19hdHRyX2luaXQo
JmRldl9hdHRyLT5hdHRyKTsKLQotCS8qIENvbmZpZ3VyZSBkZXZpY2UgYXR0cmlidXRlICovCi0J
ZGV2X2F0dHItPmF0dHIubmFtZSA9IGthc3ByaW50ZihHRlBfS0VSTkVMLCAiJXMlcyIsIHBhcm0t
PnByZWZpeCwKLQkJCQkJcGFybS0+bmFtZSk7Ci0JaWYgKCFkZXZfYXR0ci0+YXR0ci5uYW1lKSB7
Ci0JCWVyciA9IC1FTk9NRU07Ci0JCWdvdG8gZXJyX2ZyZWVfY291bnRlcl9hdHRyOwotCX0KLQlp
ZiAocGFybS0+c2hvdykgewotCQlkZXZfYXR0ci0+YXR0ci5tb2RlIHw9IDA0NDQ7Ci0JCWRldl9h
dHRyLT5zaG93ID0gcGFybS0+c2hvdzsKLQl9Ci0JaWYgKHBhcm0tPnN0b3JlKSB7Ci0JCWRldl9h
dHRyLT5hdHRyLm1vZGUgfD0gMDIwMDsKLQkJZGV2X2F0dHItPnN0b3JlID0gcGFybS0+c3RvcmU7
Ci0JfQotCi0JLyogU3RvcmUgYXNzb2NpYXRlZCBDb3VudGVyIGNvbXBvbmVudCB3aXRoIGF0dHJp
YnV0ZSAqLwotCWNvdW50ZXJfYXR0ci0+Y29tcG9uZW50ID0gcGFybS0+Y29tcG9uZW50OwotCi0J
LyogS2VlcCB0cmFjayBvZiB0aGUgYXR0cmlidXRlIGZvciBsYXRlciBjbGVhbnVwICovCi0JbGlz
dF9hZGQoJmNvdW50ZXJfYXR0ci0+bCwgYXR0cl9saXN0KTsKLQlwYXJtLT5ncm91cC0+bnVtX2F0
dHIrKzsKLQotCXJldHVybiAwOwotCi1lcnJfZnJlZV9jb3VudGVyX2F0dHI6Ci0Ja2ZyZWUoY291
bnRlcl9hdHRyKTsKLQlyZXR1cm4gZXJyOwotfQotCi0jZGVmaW5lIHRvX2NvdW50ZXJfYXR0cihf
ZGV2X2F0dHIpIFwKLQljb250YWluZXJfb2YoX2Rldl9hdHRyLCBzdHJ1Y3QgY291bnRlcl9kZXZp
Y2VfYXR0ciwgZGV2X2F0dHIpCi0KLXN0cnVjdCBjb3VudGVyX3NpZ25hbF91bml0IHsKLQlzdHJ1
Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbDsKLX07Ci0KLXN0YXRpYyBjb25zdCBjaGFyICpjb25z
dCBjb3VudGVyX3NpZ25hbF9sZXZlbF9zdHJbXSA9IHsKLQlbQ09VTlRFUl9TSUdOQUxfTEVWRUxf
TE9XXSA9ICJsb3ciLAotCVtDT1VOVEVSX1NJR05BTF9MRVZFTF9ISUdIXSA9ICJoaWdoIgotfTsK
LQotc3RhdGljIHNzaXplX3QgY291bnRlcl9zaWduYWxfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYs
Ci0JCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsIGNoYXIgKmJ1ZikKLXsKLQlz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2
KTsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRv
X2NvdW50ZXJfYXR0cihhdHRyKTsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfdW5pdCAq
Y29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50OwotCXN0cnVjdCBjb3VudGVyX3Np
Z25hbCAqY29uc3Qgc2lnbmFsID0gY29tcG9uZW50LT5zaWduYWw7Ci0JaW50IGVycjsKLQllbnVt
IGNvdW50ZXJfc2lnbmFsX2xldmVsIGxldmVsOwotCi0JZXJyID0gY291bnRlci0+b3BzLT5zaWdu
YWxfcmVhZChjb3VudGVyLCBzaWduYWwsICZsZXZlbCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVy
cjsKLQotCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb3VudGVyX3NpZ25hbF9sZXZlbF9z
dHJbbGV2ZWxdKTsKLX0KLQotc3RydWN0IGNvdW50ZXJfbmFtZV91bml0IHsKLQljb25zdCBjaGFy
ICpuYW1lOwotfTsKLQotc3RhdGljIHNzaXplX3QgY291bnRlcl9kZXZpY2VfYXR0cl9uYW1lX3No
b3coc3RydWN0IGRldmljZSAqZGV2LAotCQkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0cmlidXRl
ICphdHRyLAotCQkJCQkgICAgIGNoYXIgKmJ1ZikKLXsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9u
YW1lX3VuaXQgKmNvbnN0IGNvbXAgPSB0b19jb3VudGVyX2F0dHIoYXR0ciktPmNvbXBvbmVudDsK
LQotCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiVzXG4iLCBjb21wLT5uYW1lKTsKLX0KLQotc3RhdGlj
IGludCBjb3VudGVyX25hbWVfYXR0cmlidXRlX2NyZWF0ZSgKLQlzdHJ1Y3QgY291bnRlcl9kZXZp
Y2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCi0JY29uc3QgY2hhciAqY29uc3QgbmFtZSkKLXsK
LQlzdHJ1Y3QgY291bnRlcl9uYW1lX3VuaXQgKm5hbWVfY29tcDsKLQlzdHJ1Y3QgY291bnRlcl9h
dHRyX3Bhcm0gcGFybTsKLQlpbnQgZXJyOwotCi0JLyogU2tpcCBpZiBubyBuYW1lICovCi0JaWYg
KCFuYW1lKQotCQlyZXR1cm4gMDsKLQotCS8qIEFsbG9jYXRlIG5hbWUgYXR0cmlidXRlIGNvbXBv
bmVudCAqLwotCW5hbWVfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpuYW1lX2NvbXApLCBHRlBfS0VS
TkVMKTsKLQlpZiAoIW5hbWVfY29tcCkKLQkJcmV0dXJuIC1FTk9NRU07Ci0JbmFtZV9jb21wLT5u
YW1lID0gbmFtZTsKLQotCS8qIEFsbG9jYXRlIFNpZ25hbCBuYW1lIGF0dHJpYnV0ZSAqLwotCXBh
cm0uZ3JvdXAgPSBncm91cDsKLQlwYXJtLnByZWZpeCA9ICIiOwotCXBhcm0ubmFtZSA9ICJuYW1l
IjsKLQlwYXJtLnNob3cgPSBjb3VudGVyX2RldmljZV9hdHRyX25hbWVfc2hvdzsKLQlwYXJtLnN0
b3JlID0gTlVMTDsKLQlwYXJtLmNvbXBvbmVudCA9IG5hbWVfY29tcDsKLQllcnIgPSBjb3VudGVy
X2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX2ZyZWVfbmFt
ZV9jb21wOwotCi0JcmV0dXJuIDA7Ci0KLWVycl9mcmVlX25hbWVfY29tcDoKLQlrZnJlZShuYW1l
X2NvbXApOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHRfdW5p
dCB7Ci0Jc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWw7Ci0JY29uc3Qgc3RydWN0IGNvdW50
ZXJfc2lnbmFsX2V4dCAqZXh0OwotfTsKLQotc3RhdGljIHNzaXplX3QgY291bnRlcl9zaWduYWxf
ZXh0X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAotCQkJCSAgICAgICBzdHJ1Y3QgZGV2aWNlX2F0
dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQotewotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rldmlj
ZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwotCWNvbnN0IHN0
cnVjdCBjb3VudGVyX3NpZ25hbF9leHRfdW5pdCAqY29uc3QgY29tcCA9IGRldmF0dHItPmNvbXBv
bmVudDsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0ICpjb25zdCBleHQgPSBjb21w
LT5leHQ7Ci0KLQlyZXR1cm4gZXh0LT5yZWFkKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBjb21wLT5z
aWduYWwsIGV4dC0+cHJpdiwgYnVmKTsKLX0KLQotc3RhdGljIHNzaXplX3QgY291bnRlcl9zaWdu
YWxfZXh0X3N0b3JlKHN0cnVjdCBkZXZpY2UgKmRldiwKLQkJCQkJc3RydWN0IGRldmljZV9hdHRy
aWJ1dGUgKmF0dHIsCi0JCQkJCWNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKLXsKLQljb25z
dCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJf
YXR0cihhdHRyKTsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0X3VuaXQgKmNvbnN0
IGNvbXAgPSBkZXZhdHRyLT5jb21wb25lbnQ7Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfc2lnbmFs
X2V4dCAqY29uc3QgZXh0ID0gY29tcC0+ZXh0OwotCi0JcmV0dXJuIGV4dC0+d3JpdGUoZGV2X2dl
dF9kcnZkYXRhKGRldiksIGNvbXAtPnNpZ25hbCwgZXh0LT5wcml2LCBidWYsCi0JCWxlbik7Ci19
Ci0KLXN0YXRpYyB2b2lkIGNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKHN0cnVjdCBsaXN0
X2hlYWQgKmF0dHJfbGlzdCkKLXsKLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqcCwgKm47
Ci0KLQlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUocCwgbiwgYXR0cl9saXN0LCBsKSB7Ci0JCS8q
IGZyZWUgYXR0cmlidXRlIG5hbWUgYW5kIGFzc29jaWF0ZWQgY29tcG9uZW50IG1lbW9yeSAqLwot
CQlrZnJlZShwLT5kZXZfYXR0ci5hdHRyLm5hbWUpOwotCQlrZnJlZShwLT5jb21wb25lbnQpOwot
CQlsaXN0X2RlbCgmcC0+bCk7Ci0JCWtmcmVlKHApOwotCX0KLX0KLQotc3RhdGljIGludCBjb3Vu
dGVyX3NpZ25hbF9leHRfcmVnaXN0ZXIoCi0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3Jv
dXAgKmNvbnN0IGdyb3VwLAotCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqY29uc3Qgc2lnbmFsKQot
ewotCWNvbnN0IHNpemVfdCBudW1fZXh0ID0gc2lnbmFsLT5udW1fZXh0OwotCXNpemVfdCBpOwot
CWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgKmV4dDsKLQlzdHJ1Y3QgY291bnRlcl9z
aWduYWxfZXh0X3VuaXQgKnNpZ25hbF9leHRfY29tcDsKLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bh
cm0gcGFybTsKLQlpbnQgZXJyOwotCi0JLyogQ3JlYXRlIGFuIGF0dHJpYnV0ZSBmb3IgZWFjaCBl
eHRlbnNpb24gKi8KLQlmb3IgKGkgPSAwIDsgaSA8IG51bV9leHQ7IGkrKykgewotCQlleHQgPSBz
aWduYWwtPmV4dCArIGk7Ci0KLQkJLyogQWxsb2NhdGUgc2lnbmFsX2V4dCBhdHRyaWJ1dGUgY29t
cG9uZW50ICovCi0JCXNpZ25hbF9leHRfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpzaWduYWxfZXh0
X2NvbXApLCBHRlBfS0VSTkVMKTsKLQkJaWYgKCFzaWduYWxfZXh0X2NvbXApIHsKLQkJCWVyciA9
IC1FTk9NRU07Ci0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKLQkJfQotCQlzaWduYWxfZXh0
X2NvbXAtPnNpZ25hbCA9IHNpZ25hbDsKLQkJc2lnbmFsX2V4dF9jb21wLT5leHQgPSBleHQ7Ci0K
LQkJLyogQWxsb2NhdGUgYSBDb3VudGVyIGRldmljZSBhdHRyaWJ1dGUgKi8KLQkJcGFybS5ncm91
cCA9IGdyb3VwOwotCQlwYXJtLnByZWZpeCA9ICIiOwotCQlwYXJtLm5hbWUgPSBleHQtPm5hbWU7
Ci0JCXBhcm0uc2hvdyA9IChleHQtPnJlYWQpID8gY291bnRlcl9zaWduYWxfZXh0X3Nob3cgOiBO
VUxMOwotCQlwYXJtLnN0b3JlID0gKGV4dC0+d3JpdGUpID8gY291bnRlcl9zaWduYWxfZXh0X3N0
b3JlIDogTlVMTDsKLQkJcGFybS5jb21wb25lbnQgPSBzaWduYWxfZXh0X2NvbXA7Ci0JCWVyciA9
IGNvdW50ZXJfYXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Ci0JCWlmIChlcnIpIHsKLQkJCWtmcmVl
KHNpZ25hbF9leHRfY29tcCk7Ci0JCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKLQkJfQotCX0K
LQotCXJldHVybiAwOwotCi1lcnJfZnJlZV9hdHRyX2xpc3Q6Ci0JY291bnRlcl9kZXZpY2VfYXR0
cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRp
YyBpbnQgY291bnRlcl9zaWduYWxfYXR0cmlidXRlc19jcmVhdGUoCi0Jc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3VwLAotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY29uc3QgY291bnRlciwKLQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKmNvbnN0IHNpZ25h
bCkKLXsKLQlzdHJ1Y3QgY291bnRlcl9zaWduYWxfdW5pdCAqc2lnbmFsX2NvbXA7Ci0Jc3RydWN0
IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Ci0JaW50IGVycjsKLQotCS8qIEFsbG9jYXRlIFNpZ25h
bCBhdHRyaWJ1dGUgY29tcG9uZW50ICovCi0Jc2lnbmFsX2NvbXAgPSBrbWFsbG9jKHNpemVvZigq
c2lnbmFsX2NvbXApLCBHRlBfS0VSTkVMKTsKLQlpZiAoIXNpZ25hbF9jb21wKQotCQlyZXR1cm4g
LUVOT01FTTsKLQlzaWduYWxfY29tcC0+c2lnbmFsID0gc2lnbmFsOwotCi0JLyogQ3JlYXRlIG1h
aW4gU2lnbmFsIGF0dHJpYnV0ZSAqLwotCXBhcm0uZ3JvdXAgPSBncm91cDsKLQlwYXJtLnByZWZp
eCA9ICIiOwotCXBhcm0ubmFtZSA9ICJzaWduYWwiOwotCXBhcm0uc2hvdyA9IChjb3VudGVyLT5v
cHMtPnNpZ25hbF9yZWFkKSA/IGNvdW50ZXJfc2lnbmFsX3Nob3cgOiBOVUxMOwotCXBhcm0uc3Rv
cmUgPSBOVUxMOwotCXBhcm0uY29tcG9uZW50ID0gc2lnbmFsX2NvbXA7Ci0JZXJyID0gY291bnRl
cl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKLQlpZiAoZXJyKSB7Ci0JCWtmcmVlKHNpZ25hbF9j
b21wKTsKLQkJcmV0dXJuIGVycjsKLQl9Ci0KLQkvKiBDcmVhdGUgU2lnbmFsIG5hbWUgYXR0cmli
dXRlICovCi0JZXJyID0gY291bnRlcl9uYW1lX2F0dHJpYnV0ZV9jcmVhdGUoZ3JvdXAsIHNpZ25h
bC0+bmFtZSk7Ci0JaWYgKGVycikKLQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Ci0KLQkvKiBS
ZWdpc3RlciBTaWduYWwgZXh0ZW5zaW9uIGF0dHJpYnV0ZXMgKi8KLQllcnIgPSBjb3VudGVyX3Np
Z25hbF9leHRfcmVnaXN0ZXIoZ3JvdXAsIHNpZ25hbCk7Ci0JaWYgKGVycikKLQkJZ290byBlcnJf
ZnJlZV9hdHRyX2xpc3Q7Ci0KLQlyZXR1cm4gMDsKLQotZXJyX2ZyZWVfYXR0cl9saXN0OgotCWNv
dW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsKLQlyZXR1cm4g
ZXJyOwotfQotCi1zdGF0aWMgaW50IGNvdW50ZXJfc2lnbmFsc19yZWdpc3RlcigKLQlzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXBzX2xpc3QsCi0JY29uc3Qgc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQotewotCWNvbnN0IHNpemVfdCBudW1f
c2lnbmFscyA9IGNvdW50ZXItPm51bV9zaWduYWxzOwotCXNpemVfdCBpOwotCXN0cnVjdCBjb3Vu
dGVyX3NpZ25hbCAqc2lnbmFsOwotCWNvbnN0IGNoYXIgKm5hbWU7Ci0JaW50IGVycjsKLQotCS8q
IFJlZ2lzdGVyIGVhY2ggU2lnbmFsICovCi0JZm9yIChpID0gMDsgaSA8IG51bV9zaWduYWxzOyBp
KyspIHsKLQkJc2lnbmFsID0gY291bnRlci0+c2lnbmFscyArIGk7Ci0KLQkJLyogR2VuZXJhdGUg
U2lnbmFsIGF0dHJpYnV0ZSBkaXJlY3RvcnkgbmFtZSAqLwotCQluYW1lID0ga2FzcHJpbnRmKEdG
UF9LRVJORUwsICJzaWduYWwlZCIsIHNpZ25hbC0+aWQpOwotCQlpZiAoIW5hbWUpIHsKLQkJCWVy
ciA9IC1FTk9NRU07Ci0JCQlnb3RvIGVycl9mcmVlX2F0dHJfZ3JvdXBzOwotCQl9Ci0JCWdyb3Vw
c19saXN0W2ldLmF0dHJfZ3JvdXAubmFtZSA9IG5hbWU7Ci0KLQkJLyogQ3JlYXRlIGFsbCBhdHRy
aWJ1dGVzIGFzc29jaWF0ZWQgd2l0aCBTaWduYWwgKi8KLQkJZXJyID0gY291bnRlcl9zaWduYWxf
YXR0cmlidXRlc19jcmVhdGUoZ3JvdXBzX2xpc3QgKyBpLCBjb3VudGVyLAotCQkJCQkJICAgICAg
IHNpZ25hbCk7Ci0JCWlmIChlcnIpCi0JCQlnb3RvIGVycl9mcmVlX2F0dHJfZ3JvdXBzOwotCX0K
LQotCXJldHVybiAwOwotCi1lcnJfZnJlZV9hdHRyX2dyb3VwczoKLQlkbyB7Ci0JCWtmcmVlKGdy
b3Vwc19saXN0W2ldLmF0dHJfZ3JvdXAubmFtZSk7Ci0JCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlz
dF9mcmVlKCZncm91cHNfbGlzdFtpXS5hdHRyX2xpc3QpOwotCX0gd2hpbGUgKGktLSk7Ci0JcmV0
dXJuIGVycjsKLX0KLQotc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfc3luYXBzZV9h
Y3Rpb25fc3RyW10gPSB7Ci0JW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSAibm9uZSIs
Ci0JW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0VdID0gInJpc2luZyBlZGdlIiwK
LQlbQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0VdID0gImZhbGxpbmcgZWRnZSIs
Ci0JW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFU10gPSAiYm90aCBlZGdlcyIKLX07
Ci0KLXN0cnVjdCBjb3VudGVyX2FjdGlvbl91bml0IHsKLQlzdHJ1Y3QgY291bnRlcl9zeW5hcHNl
ICpzeW5hcHNlOwotCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKLX07Ci0KLXN0YXRpYyBz
c2l6ZV90IGNvdW50ZXJfYWN0aW9uX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAotCQkJCSAgIHN0
cnVjdCBkZXZpY2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCi17Ci0JY29uc3Qgc3RydWN0
IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0
cik7Ci0JaW50IGVycjsKLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBk
ZXZfZ2V0X2RydmRhdGEoZGV2KTsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9hY3Rpb25fdW5pdCAq
Y29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50OwotCXN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb25zdCBjb3VudCA9IGNvbXBvbmVudC0+Y291bnQ7Ci0Jc3RydWN0IGNvdW50ZXJfc3lu
YXBzZSAqY29uc3Qgc3luYXBzZSA9IGNvbXBvbmVudC0+c3luYXBzZTsKLQlzaXplX3QgYWN0aW9u
X2luZGV4OwotCWVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rpb247Ci0KLQllcnIgPSBj
b3VudGVyLT5vcHMtPmFjdGlvbl9nZXQoY291bnRlciwgY291bnQsIHN5bmFwc2UsICZhY3Rpb25f
aW5kZXgpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0KLQlzeW5hcHNlLT5hY3Rpb24gPSBh
Y3Rpb25faW5kZXg7Ci0KLQlhY3Rpb24gPSBzeW5hcHNlLT5hY3Rpb25zX2xpc3RbYWN0aW9uX2lu
ZGV4XTsKLQlyZXR1cm4gc3ByaW50ZihidWYsICIlc1xuIiwgY291bnRlcl9zeW5hcHNlX2FjdGlv
bl9zdHJbYWN0aW9uXSk7Ci19Ci0KLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfYWN0aW9uX3N0b3Jl
KHN0cnVjdCBkZXZpY2UgKmRldiwKLQkJCQkgICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0
dHIsCi0JCQkJICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKLXsKLQljb25zdCBzdHJ1
Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihh
dHRyKTsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9hY3Rpb25fdW5pdCAqY29uc3QgY29tcG9uZW50
ID0gZGV2YXR0ci0+Y29tcG9uZW50OwotCXN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKmNvbnN0IHN5
bmFwc2UgPSBjb21wb25lbnQtPnN5bmFwc2U7Ci0Jc2l6ZV90IGFjdGlvbl9pbmRleDsKLQljb25z
dCBzaXplX3QgbnVtX2FjdGlvbnMgPSBzeW5hcHNlLT5udW1fYWN0aW9uczsKLQllbnVtIGNvdW50
ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9uOwotCWludCBlcnI7Ci0Jc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7Ci0Jc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gY29tcG9uZW50LT5jb3VudDsKLQotCS8qIEZpbmQgcmVx
dWVzdGVkIGFjdGlvbiBtb2RlICovCi0JZm9yIChhY3Rpb25faW5kZXggPSAwOyBhY3Rpb25faW5k
ZXggPCBudW1fYWN0aW9uczsgYWN0aW9uX2luZGV4KyspIHsKLQkJYWN0aW9uID0gc3luYXBzZS0+
YWN0aW9uc19saXN0W2FjdGlvbl9pbmRleF07Ci0JCWlmIChzeXNmc19zdHJlcShidWYsIGNvdW50
ZXJfc3luYXBzZV9hY3Rpb25fc3RyW2FjdGlvbl0pKQotCQkJYnJlYWs7Ci0JfQotCS8qIElmIHJl
cXVlc3RlZCBhY3Rpb24gbW9kZSBub3QgZm91bmQgKi8KLQlpZiAoYWN0aW9uX2luZGV4ID49IG51
bV9hY3Rpb25zKQotCQlyZXR1cm4gLUVJTlZBTDsKLQotCWVyciA9IGNvdW50ZXItPm9wcy0+YWN0
aW9uX3NldChjb3VudGVyLCBjb3VudCwgc3luYXBzZSwgYWN0aW9uX2luZGV4KTsKLQlpZiAoZXJy
KQotCQlyZXR1cm4gZXJyOwotCi0Jc3luYXBzZS0+YWN0aW9uID0gYWN0aW9uX2luZGV4OwotCi0J
cmV0dXJuIGxlbjsKLX0KLQotc3RydWN0IGNvdW50ZXJfYWN0aW9uX2F2YWlsX3VuaXQgewotCWNv
bnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uc19saXN0OwotCXNpemVfdCBu
dW1fYWN0aW9uczsKLX07Ci0KLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJfc3luYXBzZV9hY3Rpb25f
YXZhaWxhYmxlX3Nob3coc3RydWN0IGRldmljZSAqZGV2LAotCXN0cnVjdCBkZXZpY2VfYXR0cmli
dXRlICphdHRyLCBjaGFyICpidWYpCi17Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0
dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Ci0JY29uc3Qgc3RydWN0
IGNvdW50ZXJfYWN0aW9uX2F2YWlsX3VuaXQgKmNvbnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNv
bXBvbmVudDsKLQlzaXplX3QgaTsKLQllbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gYWN0aW9u
OwotCXNzaXplX3QgbGVuID0gMDsKLQotCWZvciAoaSA9IDA7IGkgPCBjb21wb25lbnQtPm51bV9h
Y3Rpb25zOyBpKyspIHsKLQkJYWN0aW9uID0gY29tcG9uZW50LT5hY3Rpb25zX2xpc3RbaV07Ci0J
CWxlbiArPSBzcHJpbnRmKGJ1ZiArIGxlbiwgIiVzXG4iLAotCQkJICAgICAgIGNvdW50ZXJfc3lu
YXBzZV9hY3Rpb25fc3RyW2FjdGlvbl0pOwotCX0KLQotCXJldHVybiBsZW47Ci19Ci0KLXN0YXRp
YyBpbnQgY291bnRlcl9zeW5hcHNlc19yZWdpc3RlcigKLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2Vf
YXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCi0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b25zdCBjb3VudGVyLAotCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb25zdCBjb3VudCwgY29uc3Qg
Y2hhciAqY29uc3QgY291bnRfYXR0cl9uYW1lKQotewotCXNpemVfdCBpOwotCXN0cnVjdCBjb3Vu
dGVyX3N5bmFwc2UgKnN5bmFwc2U7Ci0JY29uc3QgY2hhciAqcHJlZml4OwotCXN0cnVjdCBjb3Vu
dGVyX2FjdGlvbl91bml0ICphY3Rpb25fY29tcDsKLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0g
cGFybTsKLQlpbnQgZXJyOwotCXN0cnVjdCBjb3VudGVyX2FjdGlvbl9hdmFpbF91bml0ICphdmFp
bF9jb21wOwotCi0JLyogUmVnaXN0ZXIgZWFjaCBTeW5hcHNlICovCi0JZm9yIChpID0gMDsgaSA8
IGNvdW50LT5udW1fc3luYXBzZXM7IGkrKykgewotCQlzeW5hcHNlID0gY291bnQtPnN5bmFwc2Vz
ICsgaTsKLQotCQkvKiBHZW5lcmF0ZSBhdHRyaWJ1dGUgcHJlZml4ICovCi0JCXByZWZpeCA9IGth
c3ByaW50ZihHRlBfS0VSTkVMLCAic2lnbmFsJWRfIiwKLQkJCQkgICBzeW5hcHNlLT5zaWduYWwt
PmlkKTsKLQkJaWYgKCFwcmVmaXgpIHsKLQkJCWVyciA9IC1FTk9NRU07Ci0JCQlnb3RvIGVycl9m
cmVlX2F0dHJfbGlzdDsKLQkJfQotCi0JCS8qIEFsbG9jYXRlIGFjdGlvbiBhdHRyaWJ1dGUgY29t
cG9uZW50ICovCi0JCWFjdGlvbl9jb21wID0ga21hbGxvYyhzaXplb2YoKmFjdGlvbl9jb21wKSwg
R0ZQX0tFUk5FTCk7Ci0JCWlmICghYWN0aW9uX2NvbXApIHsKLQkJCWVyciA9IC1FTk9NRU07Ci0J
CQlnb3RvIGVycl9mcmVlX3ByZWZpeDsKLQkJfQotCQlhY3Rpb25fY29tcC0+c3luYXBzZSA9IHN5
bmFwc2U7Ci0JCWFjdGlvbl9jb21wLT5jb3VudCA9IGNvdW50OwotCi0JCS8qIENyZWF0ZSBhY3Rp
b24gYXR0cmlidXRlICovCi0JCXBhcm0uZ3JvdXAgPSBncm91cDsKLQkJcGFybS5wcmVmaXggPSBw
cmVmaXg7Ci0JCXBhcm0ubmFtZSA9ICJhY3Rpb24iOwotCQlwYXJtLnNob3cgPSAoY291bnRlci0+
b3BzLT5hY3Rpb25fZ2V0KSA/IGNvdW50ZXJfYWN0aW9uX3Nob3cgOiBOVUxMOwotCQlwYXJtLnN0
b3JlID0gKGNvdW50ZXItPm9wcy0+YWN0aW9uX3NldCkgPyBjb3VudGVyX2FjdGlvbl9zdG9yZSA6
IE5VTEw7Ci0JCXBhcm0uY29tcG9uZW50ID0gYWN0aW9uX2NvbXA7Ci0JCWVyciA9IGNvdW50ZXJf
YXR0cmlidXRlX2NyZWF0ZSgmcGFybSk7Ci0JCWlmIChlcnIpIHsKLQkJCWtmcmVlKGFjdGlvbl9j
b21wKTsKLQkJCWdvdG8gZXJyX2ZyZWVfcHJlZml4OwotCQl9Ci0KLQkJLyogQWxsb2NhdGUgYWN0
aW9uIGF2YWlsYWJsZSBhdHRyaWJ1dGUgY29tcG9uZW50ICovCi0JCWF2YWlsX2NvbXAgPSBrbWFs
bG9jKHNpemVvZigqYXZhaWxfY29tcCksIEdGUF9LRVJORUwpOwotCQlpZiAoIWF2YWlsX2NvbXAp
IHsKLQkJCWVyciA9IC1FTk9NRU07Ci0JCQlnb3RvIGVycl9mcmVlX3ByZWZpeDsKLQkJfQotCQlh
dmFpbF9jb21wLT5hY3Rpb25zX2xpc3QgPSBzeW5hcHNlLT5hY3Rpb25zX2xpc3Q7Ci0JCWF2YWls
X2NvbXAtPm51bV9hY3Rpb25zID0gc3luYXBzZS0+bnVtX2FjdGlvbnM7Ci0KLQkJLyogQ3JlYXRl
IGFjdGlvbl9hdmFpbGFibGUgYXR0cmlidXRlICovCi0JCXBhcm0uZ3JvdXAgPSBncm91cDsKLQkJ
cGFybS5wcmVmaXggPSBwcmVmaXg7Ci0JCXBhcm0ubmFtZSA9ICJhY3Rpb25fYXZhaWxhYmxlIjsK
LQkJcGFybS5zaG93ID0gY291bnRlcl9zeW5hcHNlX2FjdGlvbl9hdmFpbGFibGVfc2hvdzsKLQkJ
cGFybS5zdG9yZSA9IE5VTEw7Ci0JCXBhcm0uY29tcG9uZW50ID0gYXZhaWxfY29tcDsKLQkJZXJy
ID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKLQkJaWYgKGVycikgewotCQkJa2Zy
ZWUoYXZhaWxfY29tcCk7Ci0JCQlnb3RvIGVycl9mcmVlX3ByZWZpeDsKLQkJfQotCi0JCWtmcmVl
KHByZWZpeCk7Ci0JfQotCi0JcmV0dXJuIDA7Ci0KLWVycl9mcmVlX3ByZWZpeDoKLQlrZnJlZShw
cmVmaXgpOwotZXJyX2ZyZWVfYXR0cl9saXN0OgotCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9m
cmVlKCZncm91cC0+YXR0cl9saXN0KTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdHJ1Y3QgY291bnRl
cl9jb3VudF91bml0IHsKLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQ7Ci19OwotCi1zdGF0
aWMgc3NpemVfdCBjb3VudGVyX2NvdW50X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAotCQkJCSAg
c3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCi0JCQkJICBjaGFyICpidWYpCi17Ci0Jc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyID0gZGV2X2dldF9kcnZkYXRhKGRldik7
Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19j
b3VudGVyX2F0dHIoYXR0cik7Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfdW5pdCAqY29u
c3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50OwotCXN0cnVjdCBjb3VudGVyX2NvdW50
ICpjb25zdCBjb3VudCA9IGNvbXBvbmVudC0+Y291bnQ7Ci0JaW50IGVycjsKLQl1bnNpZ25lZCBs
b25nIHZhbDsKLQotCWVyciA9IGNvdW50ZXItPm9wcy0+Y291bnRfcmVhZChjb3VudGVyLCBjb3Vu
dCwgJnZhbCk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKLQotCXJldHVybiBzcHJpbnRmKGJ1
ZiwgIiVsdVxuIiwgdmFsKTsKLX0KLQotc3RhdGljIHNzaXplX3QgY291bnRlcl9jb3VudF9zdG9y
ZShzdHJ1Y3QgZGV2aWNlICpkZXYsCi0JCQkJICAgc3RydWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0
dHIsCi0JCQkJICAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQotewotCXN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwotCWNvbnN0
IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9h
dHRyKGF0dHIpOwotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgKmNvbnN0IGNvbXBv
bmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKLQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3Qg
Y291bnQgPSBjb21wb25lbnQtPmNvdW50OwotCWludCBlcnI7Ci0JdW5zaWduZWQgbG9uZyB2YWw7
Ci0KLQllcnIgPSBrc3RydG91bChidWYsIDAsICZ2YWwpOwotCWlmIChlcnIpCi0JCXJldHVybiBl
cnI7Ci0KLQllcnIgPSBjb3VudGVyLT5vcHMtPmNvdW50X3dyaXRlKGNvdW50ZXIsIGNvdW50LCB2
YWwpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0KLQlyZXR1cm4gbGVuOwotfQotCi1zdGF0
aWMgY29uc3QgY2hhciAqY29uc3QgY291bnRlcl9mdW5jdGlvbl9zdHJbXSA9IHsKLQlbQ09VTlRF
Ul9GVU5DVElPTl9JTkNSRUFTRV0gPSAiaW5jcmVhc2UiLAotCVtDT1VOVEVSX0ZVTkNUSU9OX0RF
Q1JFQVNFXSA9ICJkZWNyZWFzZSIsCi0JW0NPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9O
XSA9ICJwdWxzZS1kaXJlY3Rpb24iLAotCVtDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFf
QV0gPSAicXVhZHJhdHVyZSB4MSBhIiwKLQlbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gx
X0JdID0gInF1YWRyYXR1cmUgeDEgYiIsCi0JW0NPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
Ml9BXSA9ICJxdWFkcmF0dXJlIHgyIGEiLAotCVtDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVf
WDJfQl0gPSAicXVhZHJhdHVyZSB4MiBiIiwKLQlbQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJF
X1g0XSA9ICJxdWFkcmF0dXJlIHg0IgotfTsKLQotc3RhdGljIHNzaXplX3QgY291bnRlcl9mdW5j
dGlvbl9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKLQkJCQkgICAgIHN0cnVjdCBkZXZpY2VfYXR0
cmlidXRlICphdHRyLCBjaGFyICpidWYpCi17Ci0JaW50IGVycjsKLQlzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvbnN0IGNvdW50ZXIgPSBkZXZfZ2V0X2RydmRhdGEoZGV2KTsKLQljb25zdCBzdHJ1
Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0ciA9IHRvX2NvdW50ZXJfYXR0cihh
dHRyKTsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF91bml0ICpjb25zdCBjb21wb25lbnQg
PSBkZXZhdHRyLT5jb21wb25lbnQ7Ci0Jc3RydWN0IGNvdW50ZXJfY291bnQgKmNvbnN0IGNvdW50
ID0gY29tcG9uZW50LT5jb3VudDsKLQlzaXplX3QgZnVuY19pbmRleDsKLQllbnVtIGNvdW50ZXJf
ZnVuY3Rpb24gZnVuY3Rpb247Ci0KLQllcnIgPSBjb3VudGVyLT5vcHMtPmZ1bmN0aW9uX2dldChj
b3VudGVyLCBjb3VudCwgJmZ1bmNfaW5kZXgpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0K
LQljb3VudC0+ZnVuY3Rpb24gPSBmdW5jX2luZGV4OwotCi0JZnVuY3Rpb24gPSBjb3VudC0+ZnVu
Y3Rpb25zX2xpc3RbZnVuY19pbmRleF07Ci0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXNcbiIsIGNv
dW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSk7Ci19Ci0KLXN0YXRpYyBzc2l6ZV90IGNvdW50
ZXJfZnVuY3Rpb25fc3RvcmUoc3RydWN0IGRldmljZSAqZGV2LAotCQkJCSAgICAgIHN0cnVjdCBk
ZXZpY2VfYXR0cmlidXRlICphdHRyLAotCQkJCSAgICAgIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90
IGxlbikKLXsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0ciAqY29uc3QgZGV2YXR0
ciA9IHRvX2NvdW50ZXJfYXR0cihhdHRyKTsKLQljb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF91
bml0ICpjb25zdCBjb21wb25lbnQgPSBkZXZhdHRyLT5jb21wb25lbnQ7Ci0Jc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvbnN0IGNvdW50ID0gY29tcG9uZW50LT5jb3VudDsKLQljb25zdCBzaXplX3Qg
bnVtX2Z1bmN0aW9ucyA9IGNvdW50LT5udW1fZnVuY3Rpb25zOwotCXNpemVfdCBmdW5jX2luZGV4
OwotCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKLQlpbnQgZXJyOwotCXN0cnVjdCBj
b3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciA9IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwotCi0J
LyogRmluZCByZXF1ZXN0ZWQgQ291bnQgZnVuY3Rpb24gbW9kZSAqLwotCWZvciAoZnVuY19pbmRl
eCA9IDA7IGZ1bmNfaW5kZXggPCBudW1fZnVuY3Rpb25zOyBmdW5jX2luZGV4KyspIHsKLQkJZnVu
Y3Rpb24gPSBjb3VudC0+ZnVuY3Rpb25zX2xpc3RbZnVuY19pbmRleF07Ci0JCWlmIChzeXNmc19z
dHJlcShidWYsIGNvdW50ZXJfZnVuY3Rpb25fc3RyW2Z1bmN0aW9uXSkpCi0JCQlicmVhazsKLQl9
Ci0JLyogUmV0dXJuIGVycm9yIGlmIHJlcXVlc3RlZCBDb3VudCBmdW5jdGlvbiBtb2RlIG5vdCBm
b3VuZCAqLwotCWlmIChmdW5jX2luZGV4ID49IG51bV9mdW5jdGlvbnMpCi0JCXJldHVybiAtRUlO
VkFMOwotCi0JZXJyID0gY291bnRlci0+b3BzLT5mdW5jdGlvbl9zZXQoY291bnRlciwgY291bnQs
IGZ1bmNfaW5kZXgpOwotCWlmIChlcnIpCi0JCXJldHVybiBlcnI7Ci0KLQljb3VudC0+ZnVuY3Rp
b24gPSBmdW5jX2luZGV4OwotCi0JcmV0dXJuIGxlbjsKLX0KLQotc3RydWN0IGNvdW50ZXJfY291
bnRfZXh0X3VuaXQgewotCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKLQljb25zdCBzdHJ1
Y3QgY291bnRlcl9jb3VudF9leHQgKmV4dDsKLX07Ci0KLXN0YXRpYyBzc2l6ZV90IGNvdW50ZXJf
Y291bnRfZXh0X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAotCQkJCSAgICAgIHN0cnVjdCBkZXZp
Y2VfYXR0cmlidXRlICphdHRyLCBjaGFyICpidWYpCi17Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0b19jb3VudGVyX2F0dHIoYXR0cik7Ci0JY29u
c3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0X3VuaXQgKmNvbnN0IGNvbXAgPSBkZXZhdHRyLT5j
b21wb25lbnQ7Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0ICpjb25zdCBleHQgPSBj
b21wLT5leHQ7Ci0KLQlyZXR1cm4gZXh0LT5yZWFkKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBjb21w
LT5jb3VudCwgZXh0LT5wcml2LCBidWYpOwotfQotCi1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2Nv
dW50X2V4dF9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCi0JCQkJICAgICAgIHN0cnVjdCBkZXZp
Y2VfYXR0cmlidXRlICphdHRyLAotCQkJCSAgICAgICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBs
ZW4pCi17Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIg
PSB0b19jb3VudGVyX2F0dHIoYXR0cik7Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0
X3VuaXQgKmNvbnN0IGNvbXAgPSBkZXZhdHRyLT5jb21wb25lbnQ7Ci0JY29uc3Qgc3RydWN0IGNv
dW50ZXJfY291bnRfZXh0ICpjb25zdCBleHQgPSBjb21wLT5leHQ7Ci0KLQlyZXR1cm4gZXh0LT53
cml0ZShkZXZfZ2V0X2RydmRhdGEoZGV2KSwgY29tcC0+Y291bnQsIGV4dC0+cHJpdiwgYnVmLAot
CQlsZW4pOwotfQotCi1zdGF0aWMgaW50IGNvdW50ZXJfY291bnRfZXh0X3JlZ2lzdGVyKAotCXN0
cnVjdCBjb3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpjb25zdCBncm91cCwKLQlzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY29uc3QgY291bnQpCi17Ci0Jc2l6ZV90IGk7Ci0JY29uc3Qgc3RydWN0IGNv
dW50ZXJfY291bnRfZXh0ICpleHQ7Ci0Jc3RydWN0IGNvdW50ZXJfY291bnRfZXh0X3VuaXQgKmNv
dW50X2V4dF9jb21wOwotCXN0cnVjdCBjb3VudGVyX2F0dHJfcGFybSBwYXJtOwotCWludCBlcnI7
Ci0KLQkvKiBDcmVhdGUgYW4gYXR0cmlidXRlIGZvciBlYWNoIGV4dGVuc2lvbiAqLwotCWZvciAo
aSA9IDAgOyBpIDwgY291bnQtPm51bV9leHQ7IGkrKykgewotCQlleHQgPSBjb3VudC0+ZXh0ICsg
aTsKLQotCQkvKiBBbGxvY2F0ZSBjb3VudF9leHQgYXR0cmlidXRlIGNvbXBvbmVudCAqLwotCQlj
b3VudF9leHRfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpjb3VudF9leHRfY29tcCksIEdGUF9LRVJO
RUwpOwotCQlpZiAoIWNvdW50X2V4dF9jb21wKSB7Ci0JCQllcnIgPSAtRU5PTUVNOwotCQkJZ290
byBlcnJfZnJlZV9hdHRyX2xpc3Q7Ci0JCX0KLQkJY291bnRfZXh0X2NvbXAtPmNvdW50ID0gY291
bnQ7Ci0JCWNvdW50X2V4dF9jb21wLT5leHQgPSBleHQ7Ci0KLQkJLyogQWxsb2NhdGUgY291bnRf
ZXh0IGF0dHJpYnV0ZSAqLwotCQlwYXJtLmdyb3VwID0gZ3JvdXA7Ci0JCXBhcm0ucHJlZml4ID0g
IiI7Ci0JCXBhcm0ubmFtZSA9IGV4dC0+bmFtZTsKLQkJcGFybS5zaG93ID0gKGV4dC0+cmVhZCkg
PyBjb3VudGVyX2NvdW50X2V4dF9zaG93IDogTlVMTDsKLQkJcGFybS5zdG9yZSA9IChleHQtPndy
aXRlKSA/IGNvdW50ZXJfY291bnRfZXh0X3N0b3JlIDogTlVMTDsKLQkJcGFybS5jb21wb25lbnQg
PSBjb3VudF9leHRfY29tcDsKLQkJZXJyID0gY291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJt
KTsKLQkJaWYgKGVycikgewotCQkJa2ZyZWUoY291bnRfZXh0X2NvbXApOwotCQkJZ290byBlcnJf
ZnJlZV9hdHRyX2xpc3Q7Ci0JCX0KLQl9Ci0KLQlyZXR1cm4gMDsKLQotZXJyX2ZyZWVfYXR0cl9s
aXN0OgotCWNvdW50ZXJfZGV2aWNlX2F0dHJfbGlzdF9mcmVlKCZncm91cC0+YXR0cl9saXN0KTsK
LQlyZXR1cm4gZXJyOwotfQotCi1zdHJ1Y3QgY291bnRlcl9mdW5jX2F2YWlsX3VuaXQgewotCWNv
bnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb25zX2xpc3Q7Ci0Jc2l6ZV90IG51bV9m
dW5jdGlvbnM7Ci19OwotCi1zdGF0aWMgc3NpemVfdCBjb3VudGVyX2Z1bmN0aW9uX2F2YWlsYWJs
ZV9zaG93KHN0cnVjdCBkZXZpY2UgKmRldiwKLQlzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0
ciwgY2hhciAqYnVmKQotewotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25z
dCBkZXZhdHRyID0gdG9fY291bnRlcl9hdHRyKGF0dHIpOwotCWNvbnN0IHN0cnVjdCBjb3VudGVy
X2Z1bmNfYXZhaWxfdW5pdCAqY29uc3QgY29tcG9uZW50ID0gZGV2YXR0ci0+Y29tcG9uZW50Owot
CWNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiAqY29uc3QgZnVuY19saXN0ID0gY29tcG9uZW50
LT5mdW5jdGlvbnNfbGlzdDsKLQljb25zdCBzaXplX3QgbnVtX2Z1bmN0aW9ucyA9IGNvbXBvbmVu
dC0+bnVtX2Z1bmN0aW9uczsKLQlzaXplX3QgaTsKLQllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVu
Y3Rpb247Ci0Jc3NpemVfdCBsZW4gPSAwOwotCi0JZm9yIChpID0gMDsgaSA8IG51bV9mdW5jdGlv
bnM7IGkrKykgewotCQlmdW5jdGlvbiA9IGZ1bmNfbGlzdFtpXTsKLQkJbGVuICs9IHNwcmludGYo
YnVmICsgbGVuLCAiJXNcbiIsCi0JCQkgICAgICAgY291bnRlcl9mdW5jdGlvbl9zdHJbZnVuY3Rp
b25dKTsKLQl9Ci0KLQlyZXR1cm4gbGVuOwotfQotCi1zdGF0aWMgaW50IGNvdW50ZXJfY291bnRf
YXR0cmlidXRlc19jcmVhdGUoCi0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNv
bnN0IGdyb3VwLAotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlciwK
LQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY29uc3QgY291bnQpCi17Ci0Jc3RydWN0IGNvdW50ZXJf
Y291bnRfdW5pdCAqY291bnRfY29tcDsKLQlzdHJ1Y3QgY291bnRlcl9hdHRyX3Bhcm0gcGFybTsK
LQlpbnQgZXJyOwotCXN0cnVjdCBjb3VudGVyX2NvdW50X3VuaXQgKmZ1bmNfY29tcDsKLQlzdHJ1
Y3QgY291bnRlcl9mdW5jX2F2YWlsX3VuaXQgKmF2YWlsX2NvbXA7Ci0KLQkvKiBBbGxvY2F0ZSBj
b3VudCBhdHRyaWJ1dGUgY29tcG9uZW50ICovCi0JY291bnRfY29tcCA9IGttYWxsb2Moc2l6ZW9m
KCpjb3VudF9jb21wKSwgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFjb3VudF9jb21wKQotCQlyZXR1cm4g
LUVOT01FTTsKLQljb3VudF9jb21wLT5jb3VudCA9IGNvdW50OwotCi0JLyogQ3JlYXRlIG1haW4g
Q291bnQgYXR0cmlidXRlICovCi0JcGFybS5ncm91cCA9IGdyb3VwOwotCXBhcm0ucHJlZml4ID0g
IiI7Ci0JcGFybS5uYW1lID0gImNvdW50IjsKLQlwYXJtLnNob3cgPSAoY291bnRlci0+b3BzLT5j
b3VudF9yZWFkKSA/IGNvdW50ZXJfY291bnRfc2hvdyA6IE5VTEw7Ci0JcGFybS5zdG9yZSA9IChj
b3VudGVyLT5vcHMtPmNvdW50X3dyaXRlKSA/IGNvdW50ZXJfY291bnRfc3RvcmUgOiBOVUxMOwot
CXBhcm0uY29tcG9uZW50ID0gY291bnRfY29tcDsKLQllcnIgPSBjb3VudGVyX2F0dHJpYnV0ZV9j
cmVhdGUoJnBhcm0pOwotCWlmIChlcnIpIHsKLQkJa2ZyZWUoY291bnRfY29tcCk7Ci0JCXJldHVy
biBlcnI7Ci0JfQotCi0JLyogQWxsb2NhdGUgZnVuY3Rpb24gYXR0cmlidXRlIGNvbXBvbmVudCAq
LwotCWZ1bmNfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpmdW5jX2NvbXApLCBHRlBfS0VSTkVMKTsK
LQlpZiAoIWZ1bmNfY29tcCkgewotCQllcnIgPSAtRU5PTUVNOwotCQlnb3RvIGVycl9mcmVlX2F0
dHJfbGlzdDsKLQl9Ci0JZnVuY19jb21wLT5jb3VudCA9IGNvdW50OwotCi0JLyogQ3JlYXRlIENv
dW50IGZ1bmN0aW9uIGF0dHJpYnV0ZSAqLwotCXBhcm0uZ3JvdXAgPSBncm91cDsKLQlwYXJtLnBy
ZWZpeCA9ICIiOwotCXBhcm0ubmFtZSA9ICJmdW5jdGlvbiI7Ci0JcGFybS5zaG93ID0gKGNvdW50
ZXItPm9wcy0+ZnVuY3Rpb25fZ2V0KSA/IGNvdW50ZXJfZnVuY3Rpb25fc2hvdyA6IE5VTEw7Ci0J
cGFybS5zdG9yZSA9IChjb3VudGVyLT5vcHMtPmZ1bmN0aW9uX3NldCkgPyBjb3VudGVyX2Z1bmN0
aW9uX3N0b3JlIDogTlVMTDsKLQlwYXJtLmNvbXBvbmVudCA9IGZ1bmNfY29tcDsKLQllcnIgPSBj
b3VudGVyX2F0dHJpYnV0ZV9jcmVhdGUoJnBhcm0pOwotCWlmIChlcnIpIHsKLQkJa2ZyZWUoZnVu
Y19jb21wKTsKLQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Ci0JfQotCi0JLyogQWxsb2NhdGUg
ZnVuY3Rpb24gYXZhaWxhYmxlIGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KLQlhdmFpbF9jb21wID0g
a21hbGxvYyhzaXplb2YoKmF2YWlsX2NvbXApLCBHRlBfS0VSTkVMKTsKLQlpZiAoIWF2YWlsX2Nv
bXApIHsKLQkJZXJyID0gLUVOT01FTTsKLQkJZ290byBlcnJfZnJlZV9hdHRyX2xpc3Q7Ci0JfQot
CWF2YWlsX2NvbXAtPmZ1bmN0aW9uc19saXN0ID0gY291bnQtPmZ1bmN0aW9uc19saXN0OwotCWF2
YWlsX2NvbXAtPm51bV9mdW5jdGlvbnMgPSBjb3VudC0+bnVtX2Z1bmN0aW9uczsKLQotCS8qIENy
ZWF0ZSBDb3VudCBmdW5jdGlvbl9hdmFpbGFibGUgYXR0cmlidXRlICovCi0JcGFybS5ncm91cCA9
IGdyb3VwOwotCXBhcm0ucHJlZml4ID0gIiI7Ci0JcGFybS5uYW1lID0gImZ1bmN0aW9uX2F2YWls
YWJsZSI7Ci0JcGFybS5zaG93ID0gY291bnRlcl9mdW5jdGlvbl9hdmFpbGFibGVfc2hvdzsKLQlw
YXJtLnN0b3JlID0gTlVMTDsKLQlwYXJtLmNvbXBvbmVudCA9IGF2YWlsX2NvbXA7Ci0JZXJyID0g
Y291bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKLQlpZiAoZXJyKSB7Ci0JCWtmcmVlKGF2
YWlsX2NvbXApOwotCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKLQl9Ci0KLQkvKiBDcmVhdGUg
Q291bnQgbmFtZSBhdHRyaWJ1dGUgKi8KLQllcnIgPSBjb3VudGVyX25hbWVfYXR0cmlidXRlX2Ny
ZWF0ZShncm91cCwgY291bnQtPm5hbWUpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX2ZyZWVfYXR0
cl9saXN0OwotCi0JLyogUmVnaXN0ZXIgQ291bnQgZXh0ZW5zaW9uIGF0dHJpYnV0ZXMgKi8KLQll
cnIgPSBjb3VudGVyX2NvdW50X2V4dF9yZWdpc3Rlcihncm91cCwgY291bnQpOwotCWlmIChlcnIp
Ci0JCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0OwotCi0JcmV0dXJuIDA7Ci0KLWVycl9mcmVlX2F0
dHJfbGlzdDoKLQljb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXAtPmF0dHJfbGlz
dCk7Ci0JcmV0dXJuIGVycjsKLX0KLQotc3RhdGljIGludCBjb3VudGVyX2NvdW50c19yZWdpc3Rl
cigKLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXBzX2xpc3Qs
Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQotewotCXNpemVf
dCBpOwotCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudDsKLQljb25zdCBjaGFyICpuYW1lOwot
CWludCBlcnI7Ci0KLQkvKiBSZWdpc3RlciBlYWNoIENvdW50ICovCi0JZm9yIChpID0gMDsgaSA8
IGNvdW50ZXItPm51bV9jb3VudHM7IGkrKykgewotCQljb3VudCA9IGNvdW50ZXItPmNvdW50cyAr
IGk7Ci0KLQkJLyogR2VuZXJhdGUgQ291bnQgYXR0cmlidXRlIGRpcmVjdG9yeSBuYW1lICovCi0J
CW5hbWUgPSBrYXNwcmludGYoR0ZQX0tFUk5FTCwgImNvdW50JWQiLCBjb3VudC0+aWQpOwotCQlp
ZiAoIW5hbWUpIHsKLQkJCWVyciA9IC1FTk9NRU07Ci0JCQlnb3RvIGVycl9mcmVlX2F0dHJfZ3Jv
dXBzOwotCQl9Ci0JCWdyb3Vwc19saXN0W2ldLmF0dHJfZ3JvdXAubmFtZSA9IG5hbWU7Ci0KLQkJ
LyogUmVnaXN0ZXIgdGhlIFN5bmFwc2VzIGFzc29jaWF0ZWQgd2l0aCBlYWNoIENvdW50ICovCi0J
CWVyciA9IGNvdW50ZXJfc3luYXBzZXNfcmVnaXN0ZXIoZ3JvdXBzX2xpc3QgKyBpLCBjb3VudGVy
LCBjb3VudCwKLQkJCQkJCW5hbWUpOwotCQlpZiAoZXJyKQotCQkJZ290byBlcnJfZnJlZV9hdHRy
X2dyb3VwczsKLQotCQkvKiBDcmVhdGUgYWxsIGF0dHJpYnV0ZXMgYXNzb2NpYXRlZCB3aXRoIENv
dW50ICovCi0JCWVyciA9IGNvdW50ZXJfY291bnRfYXR0cmlidXRlc19jcmVhdGUoZ3JvdXBzX2xp
c3QgKyBpLCBjb3VudGVyLAotCQkJCQkJICAgICAgY291bnQpOwotCQlpZiAoZXJyKQotCQkJZ290
byBlcnJfZnJlZV9hdHRyX2dyb3VwczsKLQl9Ci0KLQlyZXR1cm4gMDsKLQotZXJyX2ZyZWVfYXR0
cl9ncm91cHM6Ci0JZG8gewotCQlrZnJlZShncm91cHNfbGlzdFtpXS5hdHRyX2dyb3VwLm5hbWUp
OwotCQljb3VudGVyX2RldmljZV9hdHRyX2xpc3RfZnJlZSgmZ3JvdXBzX2xpc3RbaV0uYXR0cl9s
aXN0KTsKLQl9IHdoaWxlIChpLS0pOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0cnVjdCBjb3VudGVy
X3NpemVfdW5pdCB7Ci0Jc2l6ZV90IHNpemU7Ci19OwotCi1zdGF0aWMgc3NpemVfdCBjb3VudGVy
X2RldmljZV9hdHRyX3NpemVfc2hvdyhzdHJ1Y3QgZGV2aWNlICpkZXYsCi0JCQkJCSAgICAgc3Ry
dWN0IGRldmljZV9hdHRyaWJ1dGUgKmF0dHIsCi0JCQkJCSAgICAgY2hhciAqYnVmKQotewotCWNv
bnN0IHN0cnVjdCBjb3VudGVyX3NpemVfdW5pdCAqY29uc3QgY29tcCA9IHRvX2NvdW50ZXJfYXR0
cihhdHRyKS0+Y29tcG9uZW50OwotCi0JcmV0dXJuIHNwcmludGYoYnVmLCAiJXp1XG4iLCBjb21w
LT5zaXplKTsKLX0KLQotc3RhdGljIGludCBjb3VudGVyX3NpemVfYXR0cmlidXRlX2NyZWF0ZSgK
LQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3JvdXAsCi0JY29uc3Qg
c2l6ZV90IHNpemUsIGNvbnN0IGNoYXIgKmNvbnN0IG5hbWUpCi17Ci0Jc3RydWN0IGNvdW50ZXJf
c2l6ZV91bml0ICpzaXplX2NvbXA7Ci0Jc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Ci0J
aW50IGVycjsKLQotCS8qIEFsbG9jYXRlIHNpemUgYXR0cmlidXRlIGNvbXBvbmVudCAqLwotCXNp
emVfY29tcCA9IGttYWxsb2Moc2l6ZW9mKCpzaXplX2NvbXApLCBHRlBfS0VSTkVMKTsKLQlpZiAo
IXNpemVfY29tcCkKLQkJcmV0dXJuIC1FTk9NRU07Ci0Jc2l6ZV9jb21wLT5zaXplID0gc2l6ZTsK
LQotCXBhcm0uZ3JvdXAgPSBncm91cDsKLQlwYXJtLnByZWZpeCA9ICIiOwotCXBhcm0ubmFtZSA9
IG5hbWU7Ci0JcGFybS5zaG93ID0gY291bnRlcl9kZXZpY2VfYXR0cl9zaXplX3Nob3c7Ci0JcGFy
bS5zdG9yZSA9IE5VTEw7Ci0JcGFybS5jb21wb25lbnQgPSBzaXplX2NvbXA7Ci0JZXJyID0gY291
bnRlcl9hdHRyaWJ1dGVfY3JlYXRlKCZwYXJtKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9mcmVl
X3NpemVfY29tcDsKLQotCXJldHVybiAwOwotCi1lcnJfZnJlZV9zaXplX2NvbXA6Ci0Ja2ZyZWUo
c2l6ZV9jb21wKTsKLQlyZXR1cm4gZXJyOwotfQotCi1zdHJ1Y3QgY291bnRlcl9leHRfdW5pdCB7
Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4dCAqZXh0OwotfTsKLQotc3RhdGljIHNz
aXplX3QgY291bnRlcl9kZXZpY2VfZXh0X3Nob3coc3RydWN0IGRldmljZSAqZGV2LAotCQkJCSAg
ICAgICBzdHJ1Y3QgZGV2aWNlX2F0dHJpYnV0ZSAqYXR0ciwgY2hhciAqYnVmKQotewotCWNvbnN0
IHN0cnVjdCBjb3VudGVyX2RldmljZV9hdHRyICpjb25zdCBkZXZhdHRyID0gdG9fY291bnRlcl9h
dHRyKGF0dHIpOwotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2V4dF91bml0ICpjb25zdCBjb21wb25l
bnQgPSBkZXZhdHRyLT5jb21wb25lbnQ7Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2V4
dCAqY29uc3QgZXh0ID0gY29tcG9uZW50LT5leHQ7Ci0KLQlyZXR1cm4gZXh0LT5yZWFkKGRldl9n
ZXRfZHJ2ZGF0YShkZXYpLCBleHQtPnByaXYsIGJ1Zik7Ci19Ci0KLXN0YXRpYyBzc2l6ZV90IGNv
dW50ZXJfZGV2aWNlX2V4dF9zdG9yZShzdHJ1Y3QgZGV2aWNlICpkZXYsCi0JCQkJCXN0cnVjdCBk
ZXZpY2VfYXR0cmlidXRlICphdHRyLAotCQkJCQljb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4p
Ci17Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHIgKmNvbnN0IGRldmF0dHIgPSB0
b19jb3VudGVyX2F0dHIoYXR0cik7Ci0JY29uc3Qgc3RydWN0IGNvdW50ZXJfZXh0X3VuaXQgKmNv
bnN0IGNvbXBvbmVudCA9IGRldmF0dHItPmNvbXBvbmVudDsKLQljb25zdCBzdHJ1Y3QgY291bnRl
cl9kZXZpY2VfZXh0ICpjb25zdCBleHQgPSBjb21wb25lbnQtPmV4dDsKLQotCXJldHVybiBleHQt
PndyaXRlKGRldl9nZXRfZHJ2ZGF0YShkZXYpLCBleHQtPnByaXYsIGJ1ZiwgbGVuKTsKLX0KLQot
c3RhdGljIGludCBjb3VudGVyX2RldmljZV9leHRfcmVnaXN0ZXIoCi0Jc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2F0dHJfZ3JvdXAgKmNvbnN0IGdyb3VwLAotCXN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y29uc3QgY291bnRlcikKLXsKLQlzaXplX3QgaTsKLQlzdHJ1Y3QgY291bnRlcl9leHRfdW5pdCAq
ZXh0X2NvbXA7Ci0Jc3RydWN0IGNvdW50ZXJfYXR0cl9wYXJtIHBhcm07Ci0JaW50IGVycjsKLQot
CS8qIENyZWF0ZSBhbiBhdHRyaWJ1dGUgZm9yIGVhY2ggZXh0ZW5zaW9uICovCi0JZm9yIChpID0g
MCA7IGkgPCBjb3VudGVyLT5udW1fZXh0OyBpKyspIHsKLQkJLyogQWxsb2NhdGUgZXh0ZW5zaW9u
IGF0dHJpYnV0ZSBjb21wb25lbnQgKi8KLQkJZXh0X2NvbXAgPSBrbWFsbG9jKHNpemVvZigqZXh0
X2NvbXApLCBHRlBfS0VSTkVMKTsKLQkJaWYgKCFleHRfY29tcCkgewotCQkJZXJyID0gLUVOT01F
TTsKLQkJCWdvdG8gZXJyX2ZyZWVfYXR0cl9saXN0OwotCQl9Ci0KLQkJZXh0X2NvbXAtPmV4dCA9
IGNvdW50ZXItPmV4dCArIGk7Ci0KLQkJLyogQWxsb2NhdGUgZXh0ZW5zaW9uIGF0dHJpYnV0ZSAq
LwotCQlwYXJtLmdyb3VwID0gZ3JvdXA7Ci0JCXBhcm0ucHJlZml4ID0gIiI7Ci0JCXBhcm0ubmFt
ZSA9IGNvdW50ZXItPmV4dFtpXS5uYW1lOwotCQlwYXJtLnNob3cgPSAoY291bnRlci0+ZXh0W2ld
LnJlYWQpID8gY291bnRlcl9kZXZpY2VfZXh0X3Nob3cgOiBOVUxMOwotCQlwYXJtLnN0b3JlID0g
KGNvdW50ZXItPmV4dFtpXS53cml0ZSkgPyBjb3VudGVyX2RldmljZV9leHRfc3RvcmUgOiBOVUxM
OwotCQlwYXJtLmNvbXBvbmVudCA9IGV4dF9jb21wOwotCQllcnIgPSBjb3VudGVyX2F0dHJpYnV0
ZV9jcmVhdGUoJnBhcm0pOwotCQlpZiAoZXJyKSB7Ci0JCQlrZnJlZShleHRfY29tcCk7Ci0JCQln
b3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKLQkJfQotCX0KLQotCXJldHVybiAwOwotCi1lcnJfZnJl
ZV9hdHRyX2xpc3Q6Ci0JY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRy
X2xpc3QpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgY291bnRlcl9nbG9iYWxfYXR0
cl9yZWdpc3RlcigKLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0cl9ncm91cCAqY29uc3QgZ3Jv
dXAsCi0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQotewotCWludCBlcnI7
Ci0KLQkvKiBDcmVhdGUgbmFtZSBhdHRyaWJ1dGUgKi8KLQllcnIgPSBjb3VudGVyX25hbWVfYXR0
cmlidXRlX2NyZWF0ZShncm91cCwgY291bnRlci0+bmFtZSk7Ci0JaWYgKGVycikKLQkJcmV0dXJu
IGVycjsKLQotCS8qIENyZWF0ZSBudW1fY291bnRzIGF0dHJpYnV0ZSAqLwotCWVyciA9IGNvdW50
ZXJfc2l6ZV9hdHRyaWJ1dGVfY3JlYXRlKGdyb3VwLCBjb3VudGVyLT5udW1fY291bnRzLAotCQkJ
CQkgICAgIm51bV9jb3VudHMiKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlz
dDsKLQotCS8qIENyZWF0ZSBudW1fc2lnbmFscyBhdHRyaWJ1dGUgKi8KLQllcnIgPSBjb3VudGVy
X3NpemVfYXR0cmlidXRlX2NyZWF0ZShncm91cCwgY291bnRlci0+bnVtX3NpZ25hbHMsCi0JCQkJ
CSAgICAibnVtX3NpZ25hbHMiKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlz
dDsKLQotCS8qIFJlZ2lzdGVyIENvdW50ZXIgZGV2aWNlIGV4dGVuc2lvbiBhdHRyaWJ1dGVzICov
Ci0JZXJyID0gY291bnRlcl9kZXZpY2VfZXh0X3JlZ2lzdGVyKGdyb3VwLCBjb3VudGVyKTsKLQlp
ZiAoZXJyKQotCQlnb3RvIGVycl9mcmVlX2F0dHJfbGlzdDsKLQotCXJldHVybiAwOwotCi1lcnJf
ZnJlZV9hdHRyX2xpc3Q6Ci0JY291bnRlcl9kZXZpY2VfYXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5h
dHRyX2xpc3QpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyB2b2lkIGNvdW50ZXJfZGV2aWNl
X2dyb3Vwc19saXN0X2ZyZWUoCi0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmNv
bnN0IGdyb3Vwc19saXN0LAotCWNvbnN0IHNpemVfdCBudW1fZ3JvdXBzKQotewotCXN0cnVjdCBj
b3VudGVyX2RldmljZV9hdHRyX2dyb3VwICpncm91cDsKLQlzaXplX3QgaTsKLQotCS8qIGxvb3Ag
dGhyb3VnaCBhbGwgYXR0cmlidXRlIGdyb3VwcyAoc2lnbmFscywgY291bnRzLCBnbG9iYWwsIGV0
Yy4pICovCi0JZm9yIChpID0gMDsgaSA8IG51bV9ncm91cHM7IGkrKykgewotCQlncm91cCA9IGdy
b3Vwc19saXN0ICsgaTsKLQotCQkvKiBmcmVlIGFsbCBhdHRyaWJ1dGUgZ3JvdXAgYW5kIGFzc29j
aWF0ZWQgYXR0cmlidXRlcyBtZW1vcnkgKi8KLQkJa2ZyZWUoZ3JvdXAtPmF0dHJfZ3JvdXAubmFt
ZSk7Ci0JCWtmcmVlKGdyb3VwLT5hdHRyX2dyb3VwLmF0dHJzKTsKLQkJY291bnRlcl9kZXZpY2Vf
YXR0cl9saXN0X2ZyZWUoJmdyb3VwLT5hdHRyX2xpc3QpOwotCX0KLQotCWtmcmVlKGdyb3Vwc19s
aXN0KTsKLX0KLQotc3RhdGljIGludCBjb3VudGVyX2RldmljZV9ncm91cHNfbGlzdF9wcmVwYXJl
KAotCXN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRlcikKLXsKLQljb25zdCBzaXpl
X3QgdG90YWxfbnVtX2dyb3VwcyA9Ci0JCWNvdW50ZXItPm51bV9zaWduYWxzICsgY291bnRlci0+
bnVtX2NvdW50cyArIDE7Ci0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgKmdyb3Vw
c19saXN0OwotCXNpemVfdCBpOwotCWludCBlcnI7Ci0Jc2l6ZV90IG51bV9ncm91cHMgPSAwOwot
Ci0JLyogQWxsb2NhdGUgc3BhY2UgZm9yIGF0dHJpYnV0ZSBncm91cHMgKHNpZ25hbHMsIGNvdW50
cywgYW5kIGV4dCkgKi8KLQlncm91cHNfbGlzdCA9IGtjYWxsb2ModG90YWxfbnVtX2dyb3Vwcywg
c2l6ZW9mKCpncm91cHNfbGlzdCksCi0JCQkgICAgICBHRlBfS0VSTkVMKTsKLQlpZiAoIWdyb3Vw
c19saXN0KQotCQlyZXR1cm4gLUVOT01FTTsKLQotCS8qIEluaXRpYWxpemUgYXR0cmlidXRlIGxp
c3RzICovCi0JZm9yIChpID0gMDsgaSA8IHRvdGFsX251bV9ncm91cHM7IGkrKykKLQkJSU5JVF9M
SVNUX0hFQUQoJmdyb3Vwc19saXN0W2ldLmF0dHJfbGlzdCk7Ci0KLQkvKiBSZWdpc3RlciBTaWdu
YWxzICovCi0JZXJyID0gY291bnRlcl9zaWduYWxzX3JlZ2lzdGVyKGdyb3Vwc19saXN0LCBjb3Vu
dGVyKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9mcmVlX2dyb3Vwc19saXN0OwotCW51bV9ncm91
cHMgKz0gY291bnRlci0+bnVtX3NpZ25hbHM7Ci0KLQkvKiBSZWdpc3RlciBDb3VudHMgYW5kIHJl
c3BlY3RpdmUgU3luYXBzZXMgKi8KLQllcnIgPSBjb3VudGVyX2NvdW50c19yZWdpc3Rlcihncm91
cHNfbGlzdCArIG51bV9ncm91cHMsIGNvdW50ZXIpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX2Zy
ZWVfZ3JvdXBzX2xpc3Q7Ci0JbnVtX2dyb3VwcyArPSBjb3VudGVyLT5udW1fY291bnRzOwotCi0J
LyogUmVnaXN0ZXIgQ291bnRlciBnbG9iYWwgYXR0cmlidXRlcyAqLwotCWVyciA9IGNvdW50ZXJf
Z2xvYmFsX2F0dHJfcmVnaXN0ZXIoZ3JvdXBzX2xpc3QgKyBudW1fZ3JvdXBzLCBjb3VudGVyKTsK
LQlpZiAoZXJyKQotCQlnb3RvIGVycl9mcmVlX2dyb3Vwc19saXN0OwotCW51bV9ncm91cHMrKzsK
LQotCS8qIFN0b3JlIGdyb3Vwc19saXN0IGluIGRldmljZV9zdGF0ZSAqLwotCWNvdW50ZXItPmRl
dmljZV9zdGF0ZS0+Z3JvdXBzX2xpc3QgPSBncm91cHNfbGlzdDsKLQljb3VudGVyLT5kZXZpY2Vf
c3RhdGUtPm51bV9ncm91cHMgPSBudW1fZ3JvdXBzOwotCi0JcmV0dXJuIDA7Ci0KLWVycl9mcmVl
X2dyb3Vwc19saXN0OgotCWNvdW50ZXJfZGV2aWNlX2dyb3Vwc19saXN0X2ZyZWUoZ3JvdXBzX2xp
c3QsIG51bV9ncm91cHMpOwotCXJldHVybiBlcnI7Ci19Ci0KLXN0YXRpYyBpbnQgY291bnRlcl9k
ZXZpY2VfZ3JvdXBzX3ByZXBhcmUoCi0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX3N0YXRlICpjb25z
dCBkZXZpY2Vfc3RhdGUpCi17Ci0Jc2l6ZV90IGksIGo7Ci0Jc3RydWN0IGNvdW50ZXJfZGV2aWNl
X2F0dHJfZ3JvdXAgKmdyb3VwOwotCWludCBlcnI7Ci0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0
dHIgKnA7Ci0KLQkvKiBBbGxvY2F0ZSBhdHRyaWJ1dGUgZ3JvdXBzIGZvciBhc3NvY2lhdGlvbiB3
aXRoIGRldmljZSAqLwotCWRldmljZV9zdGF0ZS0+Z3JvdXBzID0ga2NhbGxvYyhkZXZpY2Vfc3Rh
dGUtPm51bV9ncm91cHMgKyAxLAotCQkJCSAgICAgICBzaXplb2YoKmRldmljZV9zdGF0ZS0+Z3Jv
dXBzKSwKLQkJCQkgICAgICAgR0ZQX0tFUk5FTCk7Ci0JaWYgKCFkZXZpY2Vfc3RhdGUtPmdyb3Vw
cykKLQkJcmV0dXJuIC1FTk9NRU07Ci0KLQkvKiBQcmVwYXJlIGVhY2ggZ3JvdXAgb2YgYXR0cmli
dXRlcyBmb3IgYXNzb2NpYXRpb24gKi8KLQlmb3IgKGkgPSAwOyBpIDwgZGV2aWNlX3N0YXRlLT5u
dW1fZ3JvdXBzOyBpKyspIHsKLQkJZ3JvdXAgPSBkZXZpY2Vfc3RhdGUtPmdyb3Vwc19saXN0ICsg
aTsKLQotCQkvKiBBbGxvY2F0ZSBzcGFjZSBmb3IgYXR0cmlidXRlIHBvaW50ZXJzIGluIGF0dHJp
YnV0ZSBncm91cCAqLwotCQlncm91cC0+YXR0cl9ncm91cC5hdHRycyA9IGtjYWxsb2MoZ3JvdXAt
Pm51bV9hdHRyICsgMSwKLQkJCXNpemVvZigqZ3JvdXAtPmF0dHJfZ3JvdXAuYXR0cnMpLCBHRlBf
S0VSTkVMKTsKLQkJaWYgKCFncm91cC0+YXR0cl9ncm91cC5hdHRycykgewotCQkJZXJyID0gLUVO
T01FTTsKLQkJCWdvdG8gZXJyX2ZyZWVfZ3JvdXBzOwotCQl9Ci0KLQkJLyogQWRkIGF0dHJpYnV0
ZSBwb2ludGVycyB0byBhdHRyaWJ1dGUgZ3JvdXAgKi8KLQkJaiA9IDA7Ci0JCWxpc3RfZm9yX2Vh
Y2hfZW50cnkocCwgJmdyb3VwLT5hdHRyX2xpc3QsIGwpCi0JCQlncm91cC0+YXR0cl9ncm91cC5h
dHRyc1tqKytdID0gJnAtPmRldl9hdHRyLmF0dHI7Ci0KLQkJLyogR3JvdXAgYXR0cmlidXRlcyBp
biBhdHRyaWJ1dGUgZ3JvdXAgKi8KLQkJZGV2aWNlX3N0YXRlLT5ncm91cHNbaV0gPSAmZ3JvdXAt
PmF0dHJfZ3JvdXA7Ci0JfQotCS8qIEFzc29jaWF0ZSBhdHRyaWJ1dGVzIHdpdGggZGV2aWNlICov
Ci0JZGV2aWNlX3N0YXRlLT5kZXYuZ3JvdXBzID0gZGV2aWNlX3N0YXRlLT5ncm91cHM7Ci0KLQly
ZXR1cm4gMDsKLQotZXJyX2ZyZWVfZ3JvdXBzOgotCWRvIHsKLQkJZ3JvdXAgPSBkZXZpY2Vfc3Rh
dGUtPmdyb3Vwc19saXN0ICsgaTsKLQkJa2ZyZWUoZ3JvdXAtPmF0dHJfZ3JvdXAuYXR0cnMpOwot
CQlncm91cC0+YXR0cl9ncm91cC5hdHRycyA9IE5VTEw7Ci0JfSB3aGlsZSAoaS0tKTsKLQlrZnJl
ZShkZXZpY2Vfc3RhdGUtPmdyb3Vwcyk7Ci0JcmV0dXJuIGVycjsKLX0KLQotLyogUHJvdmlkZXMg
YSB1bmlxdWUgSUQgZm9yIGVhY2ggY291bnRlciBkZXZpY2UgKi8KLXN0YXRpYyBERUZJTkVfSURB
KGNvdW50ZXJfaWRhKTsKLQotc3RhdGljIHZvaWQgY291bnRlcl9kZXZpY2VfcmVsZWFzZShzdHJ1
Y3QgZGV2aWNlICpkZXYpCi17Ci0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVy
ID0gZGV2X2dldF9kcnZkYXRhKGRldik7Ci0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX3N0YXRlICpj
b25zdCBkZXZpY2Vfc3RhdGUgPSBjb3VudGVyLT5kZXZpY2Vfc3RhdGU7Ci0KLQlrZnJlZShkZXZp
Y2Vfc3RhdGUtPmdyb3Vwcyk7Ci0JY291bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3RfZnJlZShkZXZp
Y2Vfc3RhdGUtPmdyb3Vwc19saXN0LAotCQkJCQlkZXZpY2Vfc3RhdGUtPm51bV9ncm91cHMpOwot
CWlkYV9zaW1wbGVfcmVtb3ZlKCZjb3VudGVyX2lkYSwgZGV2aWNlX3N0YXRlLT5pZCk7Ci0Ja2Zy
ZWUoZGV2aWNlX3N0YXRlKTsKLX0KLQotc3RhdGljIHN0cnVjdCBkZXZpY2VfdHlwZSBjb3VudGVy
X2RldmljZV90eXBlID0gewotCS5uYW1lID0gImNvdW50ZXJfZGV2aWNlIiwKLQkucmVsZWFzZSA9
IGNvdW50ZXJfZGV2aWNlX3JlbGVhc2UKLX07Ci0KLXN0YXRpYyBzdHJ1Y3QgYnVzX3R5cGUgY291
bnRlcl9idXNfdHlwZSA9IHsKLQkubmFtZSA9ICJjb3VudGVyIgotfTsKLQotLyoqCi0gKiBjb3Vu
dGVyX3JlZ2lzdGVyIC0gcmVnaXN0ZXIgQ291bnRlciB0byB0aGUgc3lzdGVtCi0gKiBAY291bnRl
cjoJcG9pbnRlciB0byBDb3VudGVyIHRvIHJlZ2lzdGVyCi0gKgotICogVGhpcyBmdW5jdGlvbiBy
ZWdpc3RlcnMgYSBDb3VudGVyIHRvIHRoZSBzeXN0ZW0uIEEgc3lzZnMgImNvdW50ZXIiIGRpcmVj
dG9yeQotICogd2lsbCBiZSBjcmVhdGVkIGFuZCBwb3B1bGF0ZWQgd2l0aCBzeXNmcyBhdHRyaWJ1
dGVzIGNvcnJlbGF0aW5nIHdpdGggdGhlCi0gKiBDb3VudGVyIFNpZ25hbHMsIFN5bmFwc2VzLCBh
bmQgQ291bnRzIHJlc3BlY3RpdmVseS4KLSAqLwotaW50IGNvdW50ZXJfcmVnaXN0ZXIoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQotewotCXN0cnVjdCBjb3VudGVyX2Rldmlj
ZV9zdGF0ZSAqZGV2aWNlX3N0YXRlOwotCWludCBlcnI7Ci0KLQkvKiBBbGxvY2F0ZSBpbnRlcm5h
bCBzdGF0ZSBjb250YWluZXIgZm9yIENvdW50ZXIgZGV2aWNlICovCi0JZGV2aWNlX3N0YXRlID0g
a3phbGxvYyhzaXplb2YoKmRldmljZV9zdGF0ZSksIEdGUF9LRVJORUwpOwotCWlmICghZGV2aWNl
X3N0YXRlKQotCQlyZXR1cm4gLUVOT01FTTsKLQljb3VudGVyLT5kZXZpY2Vfc3RhdGUgPSBkZXZp
Y2Vfc3RhdGU7Ci0KLQkvKiBBY3F1aXJlIHVuaXF1ZSBJRCAqLwotCWRldmljZV9zdGF0ZS0+aWQg
PSBpZGFfc2ltcGxlX2dldCgmY291bnRlcl9pZGEsIDAsIDAsIEdGUF9LRVJORUwpOwotCWlmIChk
ZXZpY2Vfc3RhdGUtPmlkIDwgMCkgewotCQllcnIgPSBkZXZpY2Vfc3RhdGUtPmlkOwotCQlnb3Rv
IGVycl9mcmVlX2RldmljZV9zdGF0ZTsKLQl9Ci0KLQkvKiBDb25maWd1cmUgZGV2aWNlIHN0cnVj
dHVyZSBmb3IgQ291bnRlciAqLwotCWRldmljZV9zdGF0ZS0+ZGV2LnR5cGUgPSAmY291bnRlcl9k
ZXZpY2VfdHlwZTsKLQlkZXZpY2Vfc3RhdGUtPmRldi5idXMgPSAmY291bnRlcl9idXNfdHlwZTsK
LQlpZiAoY291bnRlci0+cGFyZW50KSB7Ci0JCWRldmljZV9zdGF0ZS0+ZGV2LnBhcmVudCA9IGNv
dW50ZXItPnBhcmVudDsKLQkJZGV2aWNlX3N0YXRlLT5kZXYub2Zfbm9kZSA9IGNvdW50ZXItPnBh
cmVudC0+b2Zfbm9kZTsKLQl9Ci0JZGV2X3NldF9uYW1lKCZkZXZpY2Vfc3RhdGUtPmRldiwgImNv
dW50ZXIlZCIsIGRldmljZV9zdGF0ZS0+aWQpOwotCWRldmljZV9pbml0aWFsaXplKCZkZXZpY2Vf
c3RhdGUtPmRldik7Ci0JZGV2X3NldF9kcnZkYXRhKCZkZXZpY2Vfc3RhdGUtPmRldiwgY291bnRl
cik7Ci0KLQkvKiBQcmVwYXJlIGRldmljZSBhdHRyaWJ1dGVzICovCi0JZXJyID0gY291bnRlcl9k
ZXZpY2VfZ3JvdXBzX2xpc3RfcHJlcGFyZShjb3VudGVyKTsKLQlpZiAoZXJyKQotCQlnb3RvIGVy
cl9mcmVlX2lkOwotCi0JLyogT3JnYW5pemUgZGV2aWNlIGF0dHJpYnV0ZXMgdG8gZ3JvdXBzIGFu
ZCBtYXRjaCB0byBkZXZpY2UgKi8KLQllcnIgPSBjb3VudGVyX2RldmljZV9ncm91cHNfcHJlcGFy
ZShkZXZpY2Vfc3RhdGUpOwotCWlmIChlcnIpCi0JCWdvdG8gZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q7
Ci0KLQkvKiBBZGQgZGV2aWNlIHRvIHN5c3RlbSAqLwotCWVyciA9IGRldmljZV9hZGQoJmRldmlj
ZV9zdGF0ZS0+ZGV2KTsKLQlpZiAoZXJyKQotCQlnb3RvIGVycl9mcmVlX2dyb3VwczsKLQotCXJl
dHVybiAwOwotCi1lcnJfZnJlZV9ncm91cHM6Ci0Ja2ZyZWUoZGV2aWNlX3N0YXRlLT5ncm91cHMp
OwotZXJyX2ZyZWVfZ3JvdXBzX2xpc3Q6Ci0JY291bnRlcl9kZXZpY2VfZ3JvdXBzX2xpc3RfZnJl
ZShkZXZpY2Vfc3RhdGUtPmdyb3Vwc19saXN0LAotCQkJCQlkZXZpY2Vfc3RhdGUtPm51bV9ncm91
cHMpOwotZXJyX2ZyZWVfaWQ6Ci0JaWRhX3NpbXBsZV9yZW1vdmUoJmNvdW50ZXJfaWRhLCBkZXZp
Y2Vfc3RhdGUtPmlkKTsKLWVycl9mcmVlX2RldmljZV9zdGF0ZToKLQlrZnJlZShkZXZpY2Vfc3Rh
dGUpOwotCXJldHVybiBlcnI7Ci19Ci1FWFBPUlRfU1lNQk9MX0dQTChjb3VudGVyX3JlZ2lzdGVy
KTsKLQotLyoqCi0gKiBjb3VudGVyX3VucmVnaXN0ZXIgLSB1bnJlZ2lzdGVyIENvdW50ZXIgZnJv
bSB0aGUgc3lzdGVtCi0gKiBAY291bnRlcjoJcG9pbnRlciB0byBDb3VudGVyIHRvIHVucmVnaXN0
ZXIKLSAqCi0gKiBUaGUgQ291bnRlciBpcyB1bnJlZ2lzdGVyZWQgZnJvbSB0aGUgc3lzdGVtOyBh
bGwgYWxsb2NhdGVkIG1lbW9yeSBpcyBmcmVlZC4KLSAqLwotdm9pZCBjb3VudGVyX3VucmVnaXN0
ZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKQotewotCWlmIChjb3VudGVy
KQotCQlkZXZpY2VfZGVsKCZjb3VudGVyLT5kZXZpY2Vfc3RhdGUtPmRldik7Ci19Ci1FWFBPUlRf
U1lNQk9MX0dQTChjb3VudGVyX3VucmVnaXN0ZXIpOwotCi1zdGF0aWMgdm9pZCBkZXZtX2NvdW50
ZXJfdW5yZWcoc3RydWN0IGRldmljZSAqZGV2LCB2b2lkICpyZXMpCi17Ci0JY291bnRlcl91bnJl
Z2lzdGVyKCooc3RydWN0IGNvdW50ZXJfZGV2aWNlICoqKXJlcyk7Ci19Ci0KLS8qKgotICogZGV2
bV9jb3VudGVyX3JlZ2lzdGVyIC0gUmVzb3VyY2UtbWFuYWdlZCBjb3VudGVyX3JlZ2lzdGVyCi0g
KiBAZGV2OglkZXZpY2UgdG8gYWxsb2NhdGUgY291bnRlcl9kZXZpY2UgZm9yCi0gKiBAY291bnRl
cjoJcG9pbnRlciB0byBDb3VudGVyIHRvIHJlZ2lzdGVyCi0gKgotICogTWFuYWdlZCBjb3VudGVy
X3JlZ2lzdGVyLiBUaGUgQ291bnRlciByZWdpc3RlcmVkIHdpdGggdGhpcyBmdW5jdGlvbiBpcwot
ICogYXV0b21hdGljYWxseSB1bnJlZ2lzdGVyZWQgb24gZHJpdmVyIGRldGFjaC4gVGhpcyBmdW5j
dGlvbiBjYWxscwotICogY291bnRlcl9yZWdpc3RlciBpbnRlcm5hbGx5LiBSZWZlciB0byB0aGF0
IGZ1bmN0aW9uIGZvciBtb3JlIGluZm9ybWF0aW9uLgotICoKLSAqIElmIGFuIENvdW50ZXIgcmVn
aXN0ZXJlZCB3aXRoIHRoaXMgZnVuY3Rpb24gbmVlZHMgdG8gYmUgdW5yZWdpc3RlcmVkCi0gKiBz
ZXBhcmF0ZWx5LCBkZXZtX2NvdW50ZXJfdW5yZWdpc3RlciBtdXN0IGJlIHVzZWQuCi0gKgotICog
UkVUVVJOUzoKLSAqIDAgb24gc3VjY2VzcywgbmVnYXRpdmUgZXJyb3IgbnVtYmVyIG9uIGZhaWx1
cmUuCi0gKi8KLWludCBkZXZtX2NvdW50ZXJfcmVnaXN0ZXIoc3RydWN0IGRldmljZSAqZGV2LAot
CQkJICBzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpCi17Ci0Jc3RydWN0IGNv
dW50ZXJfZGV2aWNlICoqcHRyOwotCWludCByZXQ7Ci0KLQlwdHIgPSBkZXZyZXNfYWxsb2MoZGV2
bV9jb3VudGVyX3VucmVnLCBzaXplb2YoKnB0ciksIEdGUF9LRVJORUwpOwotCWlmICghcHRyKQot
CQlyZXR1cm4gLUVOT01FTTsKLQotCXJldCA9IGNvdW50ZXJfcmVnaXN0ZXIoY291bnRlcik7Ci0J
aWYgKCFyZXQpIHsKLQkJKnB0ciA9IGNvdW50ZXI7Ci0JCWRldnJlc19hZGQoZGV2LCBwdHIpOwot
CX0gZWxzZSB7Ci0JCWRldnJlc19mcmVlKHB0cik7Ci0JfQotCi0JcmV0dXJuIHJldDsKLX0KLUVY
UE9SVF9TWU1CT0xfR1BMKGRldm1fY291bnRlcl9yZWdpc3Rlcik7Ci0KLXN0YXRpYyBpbnQgZGV2
bV9jb3VudGVyX21hdGNoKHN0cnVjdCBkZXZpY2UgKmRldiwgdm9pZCAqcmVzLCB2b2lkICpkYXRh
KQotewotCXN0cnVjdCBjb3VudGVyX2RldmljZSAqKnIgPSByZXM7Ci0KLQlpZiAoIXIgfHwgISpy
KSB7Ci0JCVdBUk5fT04oIXIgfHwgISpyKTsKLQkJcmV0dXJuIDA7Ci0JfQotCi0JcmV0dXJuICpy
ID09IGRhdGE7Ci19Ci0KLS8qKgotICogZGV2bV9jb3VudGVyX3VucmVnaXN0ZXIgLSBSZXNvdXJj
ZS1tYW5hZ2VkIGNvdW50ZXJfdW5yZWdpc3RlcgotICogQGRldjoJZGV2aWNlIHRoaXMgY291bnRl
cl9kZXZpY2UgYmVsb25ncyB0bwotICogQGNvdW50ZXI6CXBvaW50ZXIgdG8gQ291bnRlciBhc3Nv
Y2lhdGVkIHdpdGggdGhlIGRldmljZQotICoKLSAqIFVucmVnaXN0ZXIgQ291bnRlciByZWdpc3Rl
cmVkIHdpdGggZGV2bV9jb3VudGVyX3JlZ2lzdGVyLgotICovCi12b2lkIGRldm1fY291bnRlcl91
bnJlZ2lzdGVyKHN0cnVjdCBkZXZpY2UgKmRldiwKLQkJCSAgICAgc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb25zdCBjb3VudGVyKQotewotCWludCByYzsKLQotCXJjID0gZGV2cmVzX3JlbGVhc2Uo
ZGV2LCBkZXZtX2NvdW50ZXJfdW5yZWcsIGRldm1fY291bnRlcl9tYXRjaCwKLQkJCSAgICBjb3Vu
dGVyKTsKLQlXQVJOX09OKHJjKTsKLX0KLUVYUE9SVF9TWU1CT0xfR1BMKGRldm1fY291bnRlcl91
bnJlZ2lzdGVyKTsKLQotc3RhdGljIGludCBfX2luaXQgY291bnRlcl9pbml0KHZvaWQpCi17Ci0J
cmV0dXJuIGJ1c19yZWdpc3RlcigmY291bnRlcl9idXNfdHlwZSk7Ci19Ci0KLXN0YXRpYyB2b2lk
IF9fZXhpdCBjb3VudGVyX2V4aXQodm9pZCkKLXsKLQlidXNfdW5yZWdpc3RlcigmY291bnRlcl9i
dXNfdHlwZSk7Ci19Ci0KLXN1YnN5c19pbml0Y2FsbChjb3VudGVyX2luaXQpOwotbW9kdWxlX2V4
aXQoY291bnRlcl9leGl0KTsKLQotTU9EVUxFX0FVVEhPUigiV2lsbGlhbSBCcmVhdGhpdHQgR3Jh
eSA8dmlsaGVsbS5ncmF5QGdtYWlsLmNvbT4iKTsKLU1PRFVMRV9ERVNDUklQVElPTigiR2VuZXJp
YyBDb3VudGVyIGludGVyZmFjZSIpOwotTU9EVUxFX0xJQ0VOU0UoIkdQTCB2MiIpOwpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9jb3VudGVyL2Z0bS1xdWFkZGVjLmMgYi9kcml2ZXJzL2NvdW50ZXIvZnRt
LXF1YWRkZWMuYwppbmRleCA1M2MxNWY4NDkwOWIuLjA5MmE4MDZhNDZkOCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9jb3VudGVyL2Z0bS1xdWFkZGVjLmMKKysrIGIvZHJpdmVycy9jb3VudGVyL2Z0bS1x
dWFkZGVjLmMKQEAgLTE0LDYgKzE0LDcgQEAKICNpbmNsdWRlIDxsaW51eC9tdXRleC5oPgogI2lu
Y2x1ZGUgPGxpbnV4L2NvdW50ZXIuaD4KICNpbmNsdWRlIDxsaW51eC9iaXRmaWVsZC5oPgorI2lu
Y2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKICNkZWZpbmUgRlRNX0ZJRUxEX1VQREFURShmdG0sIG9m
ZnNldCwgbWFzaywgdmFsKQkJCVwKIAkoewkJCQkJCQkJXApAQCAtMTE1LDggKzExNiw3IEBAIHN0
YXRpYyB2b2lkIGZ0bV9xdWFkZGVjX2Rpc2FibGUodm9pZCAqZnRtKQogfQogCiBzdGF0aWMgaW50
IGZ0bV9xdWFkZGVjX2dldF9wcmVzY2FsZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAotCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJCSAgICAgc2l6ZV90
ICpjbnRfbW9kZSkKKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyICpj
bnRfbW9kZSkKIHsKIAlzdHJ1Y3QgZnRtX3F1YWRkZWMgKmZ0bSA9IGNvdW50ZXItPnByaXY7CiAJ
dWludDMyX3Qgc2NmbGFnczsKQEAgLTEyOSw4ICsxMjksNyBAQCBzdGF0aWMgaW50IGZ0bV9xdWFk
ZGVjX2dldF9wcmVzY2FsZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAogfQogCiBz
dGF0aWMgaW50IGZ0bV9xdWFkZGVjX3NldF9wcmVzY2FsZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAotCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJCSAg
ICAgc2l6ZV90IGNudF9tb2RlKQorCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1MzIgY250X21vZGUpCiB7CiAJc3RydWN0IGZ0bV9xdWFkZGVjICpmdG0gPSBjb3VudGVyLT5w
cml2OwogCkBAIC0xNTEsMzMgKzE1MCwyMSBAQCBzdGF0aWMgY29uc3QgY2hhciAqIGNvbnN0IGZ0
bV9xdWFkZGVjX3ByZXNjYWxlcltdID0gewogCSIxIiwgIjIiLCAiNCIsICI4IiwgIjE2IiwgIjMy
IiwgIjY0IiwgIjEyOCIKIH07CiAKLXN0YXRpYyBzdHJ1Y3QgY291bnRlcl9jb3VudF9lbnVtX2V4
dCBmdG1fcXVhZGRlY19wcmVzY2FsZXJfZW51bSA9IHsKLQkuaXRlbXMgPSBmdG1fcXVhZGRlY19w
cmVzY2FsZXIsCi0JLm51bV9pdGVtcyA9IEFSUkFZX1NJWkUoZnRtX3F1YWRkZWNfcHJlc2NhbGVy
KSwKLQkuZ2V0ID0gZnRtX3F1YWRkZWNfZ2V0X3ByZXNjYWxlciwKLQkuc2V0ID0gZnRtX3F1YWRk
ZWNfc2V0X3ByZXNjYWxlcgotfTsKLQotZW51bSBmdG1fcXVhZGRlY19zeW5hcHNlX2FjdGlvbiB7
Ci0JRlRNX1FVQURERUNfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKLX07Ci0KIHN0YXRpYyBj
b25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gZnRtX3F1YWRkZWNfc3luYXBzZV9hY3Rp
b25zW10gPSB7Ci0JW0ZUTV9RVUFEREVDX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVNdID0KIAlD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMKIH07CiAKIGVudW0gZnRtX3F1YWRkZWNf
Y291bnRfZnVuY3Rpb24gewotCUZUTV9RVUFEREVDX0NPVU5UX0VOQ09ERVJfTU9ERV8xLAorCUZU
TV9RVUFEREVDX0NPVU5UX0VOQ09ERVJfTU9ERV8xID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFU
VVJFX1g0LAogfTsKIAogc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiBmdG1fcXVh
ZGRlY19jb3VudF9mdW5jdGlvbnNbXSA9IHsKLQlbRlRNX1FVQURERUNfQ09VTlRfRU5DT0RFUl9N
T0RFXzFdID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0CisJRlRNX1FVQURERUNfQ09V
TlRfRU5DT0RFUl9NT0RFXzEKIH07CiAKIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfY291bnRfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAJCQkJICBzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCi0JCQkJICB1bnNpZ25lZCBsb25nICp2YWwpCisJCQkJICB1NjQgKnZhbCkK
IHsKIAlzdHJ1Y3QgZnRtX3F1YWRkZWMgKmNvbnN0IGZ0bSA9IGNvdW50ZXItPnByaXY7CiAJdWlu
dDMyX3QgY250dmFsOwpAQCAtMTkxLDcgKzE3OCw3IEBAIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNf
Y291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAKIHN0YXRpYyBpbnQg
ZnRtX3F1YWRkZWNfY291bnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAog
CQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkgICBjb25zdCB1bnNpZ25l
ZCBsb25nIHZhbCkKKwkJCQkgICBjb25zdCB1NjQgdmFsKQogewogCXN0cnVjdCBmdG1fcXVhZGRl
YyAqY29uc3QgZnRtID0gY291bnRlci0+cHJpdjsKIApAQCAtMjA1LDIxICsxOTIsMjEgQEAgc3Rh
dGljIGludCBmdG1fcXVhZGRlY19jb3VudF93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfY291bnRfZnVu
Y3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkJICBzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJCSAgc2l6ZV90ICpmdW5jdGlvbikKK3N0YXRpYyBp
bnQgZnRtX3F1YWRkZWNfY291bnRfZnVuY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCisJCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkJICAg
ZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKIHsKIAkqZnVuY3Rpb24gPSBGVE1fUVVB
RERFQ19DT1VOVF9FTkNPREVSX01PREVfMTsKIAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50
IGZ0bV9xdWFkZGVjX2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAot
CQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJCSAgc3RydWN0IGNvdW50ZXJf
c3luYXBzZSAqc3luYXBzZSwKLQkJCQkgIHNpemVfdCAqYWN0aW9uKQorc3RhdGljIGludCBmdG1f
cXVhZGRlY19hY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJ
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAorCQkJCSAgIHN0cnVjdCBjb3VudGVyX3N5
bmFwc2UgKnN5bmFwc2UsCisJCQkJICAgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uICphY3Rp
b24pCiB7Ci0JKmFjdGlvbiA9IEZUTV9RVUFEREVDX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7
CisJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKIAogCXJldHVy
biAwOwogfQpAQCAtMjI3LDggKzIxNCw4IEBAIHN0YXRpYyBpbnQgZnRtX3F1YWRkZWNfYWN0aW9u
X2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiBzdGF0aWMgY29uc3Qgc3RydWN0
IGNvdW50ZXJfb3BzIGZ0bV9xdWFkZGVjX2NudF9vcHMgPSB7CiAJLmNvdW50X3JlYWQgPSBmdG1f
cXVhZGRlY19jb3VudF9yZWFkLAogCS5jb3VudF93cml0ZSA9IGZ0bV9xdWFkZGVjX2NvdW50X3dy
aXRlLAotCS5mdW5jdGlvbl9nZXQgPSBmdG1fcXVhZGRlY19jb3VudF9mdW5jdGlvbl9nZXQsCi0J
LmFjdGlvbl9nZXQgPSBmdG1fcXVhZGRlY19hY3Rpb25fZ2V0LAorCS5mdW5jdGlvbl9yZWFkID0g
ZnRtX3F1YWRkZWNfY291bnRfZnVuY3Rpb25fcmVhZCwKKwkuYWN0aW9uX3JlYWQgPSBmdG1fcXVh
ZGRlY19hY3Rpb25fcmVhZCwKIH07CiAKIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zaWduYWwgZnRt
X3F1YWRkZWNfc2lnbmFsc1tdID0gewpAQCAtMjU1LDkgKzI0MiwxMiBAQCBzdGF0aWMgc3RydWN0
IGNvdW50ZXJfc3luYXBzZSBmdG1fcXVhZGRlY19jb3VudF9zeW5hcHNlc1tdID0gewogCX0KIH07
CiAKLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgZnRtX3F1YWRkZWNfY291
bnRfZXh0W10gPSB7Ci0JQ09VTlRFUl9DT1VOVF9FTlVNKCJwcmVzY2FsZXIiLCAmZnRtX3F1YWRk
ZWNfcHJlc2NhbGVyX2VudW0pLAotCUNPVU5URVJfQ09VTlRfRU5VTV9BVkFJTEFCTEUoInByZXNj
YWxlciIsICZmdG1fcXVhZGRlY19wcmVzY2FsZXJfZW51bSksCitzdGF0aWMgREVGSU5FX0NPVU5U
RVJfRU5VTShmdG1fcXVhZGRlY19wcmVzY2FsZXJfZW51bSwgZnRtX3F1YWRkZWNfcHJlc2NhbGVy
KTsKKworc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgZnRtX3F1YWRkZWNfY291bnRfZXh0W10g
PSB7CisJQ09VTlRFUl9DT01QX0NPVU5UX0VOVU0oInByZXNjYWxlciIsIGZ0bV9xdWFkZGVjX2dl
dF9wcmVzY2FsZXIsCisJCQkJZnRtX3F1YWRkZWNfc2V0X3ByZXNjYWxlciwKKwkJCQlmdG1fcXVh
ZGRlY19wcmVzY2FsZXJfZW51bSksCiB9OwogCiBzdGF0aWMgc3RydWN0IGNvdW50ZXJfY291bnQg
ZnRtX3F1YWRkZWNfY291bnRzID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL2ludGVs
LXFlcC5jIGIvZHJpdmVycy9jb3VudGVyL2ludGVsLXFlcC5jCmluZGV4IGY0YmU5ZDc4Yzg0Yy4u
ZWMwNTZmMzFmYTU1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2NvdW50ZXIvaW50ZWwtcWVwLmMKKysr
IGIvZHJpdmVycy9jb3VudGVyL2ludGVsLXFlcC5jCkBAIC02MywxMyArNjMsNiBAQAogCiAjZGVm
aW5lIElOVEVMX1FFUF9DTEtfUEVSSU9EX05TCQkxMAogCi0jZGVmaW5lIElOVEVMX1FFUF9DT1VO
VEVSX0VYVF9SVyhfbmFtZSkJCQkJXAotewkJCQkJCQkJXAotCS5uYW1lID0gI19uYW1lLAkJCQkJ
CVwKLQkucmVhZCA9IF9uYW1lIyNfcmVhZCwJCQkJCVwKLQkud3JpdGUgPSBfbmFtZSMjX3dyaXRl
LAkJCQkJXAotfQotCiBzdHJ1Y3QgaW50ZWxfcWVwIHsKIAlzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
Y291bnRlcjsKIAlzdHJ1Y3QgbXV0ZXggbG9jazsKQEAgLTExNSw4ICsxMDgsNyBAQCBzdGF0aWMg
dm9pZCBpbnRlbF9xZXBfaW5pdChzdHJ1Y3QgaW50ZWxfcWVwICpxZXApCiB9CiAKIHN0YXRpYyBp
bnQgaW50ZWxfcWVwX2NvdW50X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAot
CQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQl1bnNpZ25lZCBsb25nICp2YWwp
CisJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKIHsKIAlzdHJ1Y3Qg
aW50ZWxfcWVwICpjb25zdCBxZXAgPSBjb3VudGVyLT5wcml2OwogCkBAIC0xMzEsMTEgKzEyMywx
MSBAQCBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uIGludGVsX3FlcF9jb3VudF9m
dW5jdGlvbnNbXSA9IHsKIAlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQsCiB9OwogCi1z
dGF0aWMgaW50IGludGVsX3FlcF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAotCQkJCSAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJCSAgc2l6ZV90
ICpmdW5jdGlvbikKK3N0YXRpYyBpbnQgaW50ZWxfcWVwX2Z1bmN0aW9uX3JlYWQoc3RydWN0IGNv
dW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwKKwkJCQkgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKQogewotCSpmdW5jdGlv
biA9IDA7CisJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1g0OwogCiAJ
cmV0dXJuIDA7CiB9CkBAIC0xNDQsMTkgKzEzNiwxOSBAQCBzdGF0aWMgY29uc3QgZW51bSBjb3Vu
dGVyX3N5bmFwc2VfYWN0aW9uIGludGVsX3FlcF9zeW5hcHNlX2FjdGlvbnNbXSA9IHsKIAlDT1VO
VEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCiB9OwogCi1zdGF0aWMgaW50IGludGVsX3Fl
cF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQlzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBz
ZSwKLQkJCQlzaXplX3QgKmFjdGlvbikKK3N0YXRpYyBpbnQgaW50ZWxfcWVwX2FjdGlvbl9yZWFk
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAorCQkJCSBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAorCQkJCSBl
bnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKIHsKLQkqYWN0aW9uID0gMDsKKwkq
YWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOwogCXJldHVybiAwOwog
fQogCiBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIGludGVsX3FlcF9jb3VudGVyX29w
cyA9IHsKIAkuY291bnRfcmVhZCA9IGludGVsX3FlcF9jb3VudF9yZWFkLAotCS5mdW5jdGlvbl9n
ZXQgPSBpbnRlbF9xZXBfZnVuY3Rpb25fZ2V0LAotCS5hY3Rpb25fZ2V0ID0gaW50ZWxfcWVwX2Fj
dGlvbl9nZXQsCisJLmZ1bmN0aW9uX3JlYWQgPSBpbnRlbF9xZXBfZnVuY3Rpb25fcmVhZCwKKwku
YWN0aW9uX3JlYWQgPSBpbnRlbF9xZXBfYWN0aW9uX3JlYWQsCiB9OwogCiAjZGVmaW5lIElOVEVM
X1FFUF9TSUdOQUwoX2lkLCBfbmFtZSkgewkJCQlcCkBAIC0xODIsMzEgKzE3NCwyNyBAQCBzdGF0
aWMgc3RydWN0IGNvdW50ZXJfc3luYXBzZSBpbnRlbF9xZXBfY291bnRfc3luYXBzZXNbXSA9IHsK
IAlJTlRFTF9RRVBfU1lOQVBTRSgyKSwKIH07CiAKLXN0YXRpYyBzc2l6ZV90IGNlaWxpbmdfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAotCQkJICAgIHZvaWQgKnByaXYsIGNoYXIgKmJ1ZikKK3N0YXRpYyBpbnQg
aW50ZWxfcWVwX2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJ
CQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU2NCAqY2VpbGluZykKIHsKIAlzdHJ1
Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2OwotCXUzMiByZWc7CiAKIAlwbV9ydW50
aW1lX2dldF9zeW5jKHFlcC0+ZGV2KTsKLQlyZWcgPSBpbnRlbF9xZXBfcmVhZGwocWVwLCBJTlRF
TF9RRVBNQVgpOworCSpjZWlsaW5nID0gaW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5URUxfUUVQTUFY
KTsKIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7CiAKLQlyZXR1cm4gc3lzZnNfZW1pdChidWYs
ICIldVxuIiwgcmVnKTsKKwlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHNzaXplX3QgY2VpbGluZ193
cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKLQkJCSAgICAgdm9pZCAqcHJpdiwgY29uc3QgY2hhciAqYnVmLCBz
aXplX3QgbGVuKQorc3RhdGljIGludCBpbnRlbF9xZXBfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1NjQgbWF4KQogewogCXN0cnVjdCBpbnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7Ci0J
dTMyIG1heDsKLQlpbnQgcmV0OworCWludCByZXQgPSAwOwogCi0JcmV0ID0ga3N0cnRvdTMyKGJ1
ZiwgMCwgJm1heCk7Ci0JaWYgKHJldCA8IDApCi0JCXJldHVybiByZXQ7CisJLyogSW50ZWwgUUVQ
IGNlaWxpbmcgY29uZmlndXJhdGlvbiBvbmx5IHN1cHBvcnRzIDMyLWJpdCB2YWx1ZXMgKi8KKwlp
ZiAobWF4ICE9ICh1MzIpbWF4KQorCQlyZXR1cm4gLUVSQU5HRTsKIAogCW11dGV4X2xvY2soJnFl
cC0+bG9jayk7CiAJaWYgKHFlcC0+ZW5hYmxlZCkgewpAQCAtMjE3LDM0ICsyMDUsMjggQEAgc3Rh
dGljIHNzaXplX3QgY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
CiAJcG1fcnVudGltZV9nZXRfc3luYyhxZXAtPmRldik7CiAJaW50ZWxfcWVwX3dyaXRlbChxZXAs
IElOVEVMX1FFUE1BWCwgbWF4KTsKIAlwbV9ydW50aW1lX3B1dChxZXAtPmRldik7Ci0JcmV0ID0g
bGVuOwogCiBvdXQ6CiAJbXV0ZXhfdW5sb2NrKCZxZXAtPmxvY2spOwogCXJldHVybiByZXQ7CiB9
CiAKLXN0YXRpYyBzc2l6ZV90IGVuYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKLQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCSAgIHZvaWQgKnBy
aXYsIGNoYXIgKmJ1ZikKK3N0YXRpYyBpbnQgaW50ZWxfcWVwX2VuYWJsZV9yZWFkKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCB1OCAqZW5hYmxlKQogewogCXN0cnVjdCBpbnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7
CiAKLQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIldVxuIiwgcWVwLT5lbmFibGVkKTsKKwkqZW5h
YmxlID0gcWVwLT5lbmFibGVkOworCisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IGVu
YWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJICAgIHZvaWQgKnByaXYsIGNvbnN0IGNoYXIgKmJ1
Ziwgc2l6ZV90IGxlbikKK3N0YXRpYyBpbnQgaW50ZWxfcWVwX2VuYWJsZV93cml0ZShzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsIHU4IHZhbCkKIHsKIAlzdHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owog
CXUzMiByZWc7Ci0JYm9vbCB2YWwsIGNoYW5nZWQ7Ci0JaW50IHJldDsKLQotCXJldCA9IGtzdHJ0
b2Jvb2woYnVmLCAmdmFsKTsKLQlpZiAocmV0KQotCQlyZXR1cm4gcmV0OworCWJvb2wgY2hhbmdl
ZDsKIAogCW11dGV4X2xvY2soJnFlcC0+bG9jayk7CiAJY2hhbmdlZCA9IHZhbCBeIHFlcC0+ZW5h
YmxlZDsKQEAgLTI2OCwxMiArMjUwLDEyIEBAIHN0YXRpYyBzc2l6ZV90IGVuYWJsZV93cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAKIG91dDoKIAltdXRleF91bmxvY2soJnFl
cC0+bG9jayk7Ci0JcmV0dXJuIGxlbjsKKwlyZXR1cm4gMDsKIH0KIAotc3RhdGljIHNzaXplX3Qg
c3Bpa2VfZmlsdGVyX25zX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJ
CSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJICAgIHZvaWQgKnByaXYsIGNo
YXIgKmJ1ZikKK3N0YXRpYyBpbnQgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc19yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsCisJCQkJCSAgdTY0ICpsZW5ndGgpCiB7CiAJc3RydWN0IGludGVsX3FlcCAqcWVwID0g
Y291bnRlci0+cHJpdjsKIAl1MzIgcmVnOwpAQCAtMjgyLDI2ICsyNjQsMjQgQEAgc3RhdGljIHNz
aXplX3Qgc3Bpa2VfZmlsdGVyX25zX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAogCXJlZyA9IGludGVsX3FlcF9yZWFkbChxZXAsIElOVEVMX1FFUENPTik7CiAJaWYgKCEocmVn
ICYgSU5URUxfUUVQQ09OX0ZMVF9FTikpIHsKIAkJcG1fcnVudGltZV9wdXQocWVwLT5kZXYpOwot
CQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIwXG4iKTsKKwkJcmV0dXJuIDA7CiAJfQogCXJlZyA9
IElOVEVMX1FFUEZMVF9NQVhfQ09VTlQoaW50ZWxfcWVwX3JlYWRsKHFlcCwgSU5URUxfUUVQRkxU
KSk7CiAJcG1fcnVudGltZV9wdXQocWVwLT5kZXYpOwogCi0JcmV0dXJuIHN5c2ZzX2VtaXQoYnVm
LCAiJXVcbiIsIChyZWcgKyAyKSAqIElOVEVMX1FFUF9DTEtfUEVSSU9EX05TKTsKKwkqbGVuZ3Ro
ID0gKHJlZyArIDIpICogSU5URUxfUUVQX0NMS19QRVJJT0RfTlM7CisKKwlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIHNzaXplX3Qgc3Bpa2VfZmlsdGVyX25zX3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKLQkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJ
CQkgICAgIHZvaWQgKnByaXYsIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbikKK3N0YXRpYyBp
bnQgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCisJCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkJICAg
dTY0IGxlbmd0aCkKIHsKIAlzdHJ1Y3QgaW50ZWxfcWVwICpxZXAgPSBjb3VudGVyLT5wcml2Owot
CXUzMiByZWcsIGxlbmd0aDsKKwl1MzIgcmVnOwogCWJvb2wgZW5hYmxlOwotCWludCByZXQ7Ci0K
LQlyZXQgPSBrc3RydG91MzIoYnVmLCAwLCAmbGVuZ3RoKTsKLQlpZiAocmV0IDwgMCkKLQkJcmV0
dXJuIHJldDsKKwlpbnQgcmV0ID0gMDsKIAogCS8qCiAJICogU3Bpa2UgZmlsdGVyIGxlbmd0aCBp
cyAoTUFYX0NPVU5UICsgMikgY2xvY2sgcGVyaW9kcy4KQEAgLTMzNywxNiArMzE3LDE1IEBAIHN0
YXRpYyBzc2l6ZV90IHNwaWtlX2ZpbHRlcl9uc193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCiAJaW50ZWxfcWVwX3dyaXRlbChxZXAsIElOVEVMX1FFUEZMVCwgbGVuZ3RoKTsK
IAlpbnRlbF9xZXBfd3JpdGVsKHFlcCwgSU5URUxfUUVQQ09OLCByZWcpOwogCXBtX3J1bnRpbWVf
cHV0KHFlcC0+ZGV2KTsKLQlyZXQgPSBsZW47CiAKIG91dDoKIAltdXRleF91bmxvY2soJnFlcC0+
bG9jayk7CiAJcmV0dXJuIHJldDsKIH0KIAotc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKLQkJCQkgIHZvaWQgKnByaXYsIGNoYXIgKmJ1ZikKK3N0YXRpYyBpbnQg
aW50ZWxfcWVwX3ByZXNldF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCisJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkJdTggKnByZXNldF9l
bmFibGUpCiB7CiAJc3RydWN0IGludGVsX3FlcCAqcWVwID0gY291bnRlci0+cHJpdjsKIAl1MzIg
cmVnOwpAQCAtMzU0LDIxICszMzMsMTggQEAgc3RhdGljIHNzaXplX3QgcHJlc2V0X2VuYWJsZV9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAlwbV9ydW50aW1lX2dldF9zeW5j
KHFlcC0+ZGV2KTsKIAlyZWcgPSBpbnRlbF9xZXBfcmVhZGwocWVwLCBJTlRFTF9RRVBDT04pOwog
CXBtX3J1bnRpbWVfcHV0KHFlcC0+ZGV2KTsKLQlyZXR1cm4gc3lzZnNfZW1pdChidWYsICIldVxu
IiwgIShyZWcgJiBJTlRFTF9RRVBDT05fQ09VTlRfUlNUX01PREUpKTsKKworCSpwcmVzZXRfZW5h
YmxlID0gIShyZWcgJiBJTlRFTF9RRVBDT05fQ09VTlRfUlNUX01PREUpOworCisJcmV0dXJuIDA7
CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAotCQkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJ
CQkgICB2b2lkICpwcml2LCBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pCitzdGF0aWMgaW50
IGludGVsX3FlcF9wcmVzZXRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKKwkJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggdmFsKQogewogCXN0
cnVjdCBpbnRlbF9xZXAgKnFlcCA9IGNvdW50ZXItPnByaXY7CiAJdTMyIHJlZzsKLQlib29sIHZh
bDsKLQlpbnQgcmV0OwotCi0JcmV0ID0ga3N0cnRvYm9vbChidWYsICZ2YWwpOwotCWlmIChyZXQp
Ci0JCXJldHVybiByZXQ7CisJaW50IHJldCA9IDA7CiAKIAltdXRleF9sb2NrKCZxZXAtPmxvY2sp
OwogCWlmIChxZXAtPmVuYWJsZWQpIHsKQEAgLTM4NSw3ICszNjEsNiBAQCBzdGF0aWMgc3NpemVf
dCBwcmVzZXRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAog
CWludGVsX3FlcF93cml0ZWwocWVwLCBJTlRFTF9RRVBDT04sIHJlZyk7CiAJcG1fcnVudGltZV9w
dXQocWVwLT5kZXYpOwotCXJldCA9IGxlbjsKIAogb3V0OgogCW11dGV4X3VubG9jaygmcWVwLT5s
b2NrKTsKQEAgLTM5MywxMSArMzY4LDE0IEBAIHN0YXRpYyBzc2l6ZV90IHByZXNldF9lbmFibGVf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAogCXJldHVybiByZXQ7CiB9CiAK
LXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3VudF9leHQgaW50ZWxfcWVwX2NvdW50X2V4
dFtdID0gewotCUlOVEVMX1FFUF9DT1VOVEVSX0VYVF9SVyhjZWlsaW5nKSwKLQlJTlRFTF9RRVBf
Q09VTlRFUl9FWFRfUlcoZW5hYmxlKSwKLQlJTlRFTF9RRVBfQ09VTlRFUl9FWFRfUlcoc3Bpa2Vf
ZmlsdGVyX25zKSwKLQlJTlRFTF9RRVBfQ09VTlRFUl9FWFRfUlcocHJlc2V0X2VuYWJsZSkKK3N0
YXRpYyBzdHJ1Y3QgY291bnRlcl9jb21wIGludGVsX3FlcF9jb3VudF9leHRbXSA9IHsKKwlDT1VO
VEVSX0NPTVBfRU5BQkxFKGludGVsX3FlcF9lbmFibGVfcmVhZCwgaW50ZWxfcWVwX2VuYWJsZV93
cml0ZSksCisJQ09VTlRFUl9DT01QX0NFSUxJTkcoaW50ZWxfcWVwX2NlaWxpbmdfcmVhZCwgaW50
ZWxfcWVwX2NlaWxpbmdfd3JpdGUpLAorCUNPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKGludGVs
X3FlcF9wcmVzZXRfZW5hYmxlX3JlYWQsCisJCQkJICAgaW50ZWxfcWVwX3ByZXNldF9lbmFibGVf
d3JpdGUpLAorCUNPVU5URVJfQ09NUF9DT1VOVF9VNjQoInNwaWtlX2ZpbHRlcl9ucyIsCisJCQkg
ICAgICAgaW50ZWxfcWVwX3NwaWtlX2ZpbHRlcl9uc19yZWFkLAorCQkJICAgICAgIGludGVsX3Fl
cF9zcGlrZV9maWx0ZXJfbnNfd3JpdGUpLAogfTsKIAogc3RhdGljIHN0cnVjdCBjb3VudGVyX2Nv
dW50IGludGVsX3FlcF9jb3VudGVyX2NvdW50W10gPSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2Nv
dW50ZXIvaW50ZXJydXB0LWNudC5jIGIvZHJpdmVycy9jb3VudGVyL2ludGVycnVwdC1jbnQuYwpp
bmRleCAxZGU0MjQzZGI0ODguLjg1MTRhODdmY2JlZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9jb3Vu
dGVyL2ludGVycnVwdC1jbnQuYworKysgYi9kcml2ZXJzL2NvdW50ZXIvaW50ZXJydXB0LWNudC5j
CkBAIC0xMCw2ICsxMCw3IEBACiAjaW5jbHVkZSA8bGludXgvbW9kX2RldmljZXRhYmxlLmg+CiAj
aW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CiAjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNl
Lmg+CisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KIAogI2RlZmluZSBJTlRFUlJVUFRfQ05UX05B
TUUgImludGVycnVwdC1jbnQiCiAKQEAgLTMzLDMwICszNCwyMyBAQCBzdGF0aWMgaXJxcmV0dXJu
X3QgaW50ZXJydXB0X2NudF9pc3IoaW50IGlycSwgdm9pZCAqZGV2X2lkKQogCXJldHVybiBJUlFf
SEFORExFRDsKIH0KIAotc3RhdGljIHNzaXplX3QgaW50ZXJydXB0X2NudF9lbmFibGVfcmVhZChz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCi0JCQkJCSB2b2lkICpwcml2YXRlLCBjaGFyICpidWYpCitzdGF0aWMgaW50IGlu
dGVycnVwdF9jbnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAor
CQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1OCAqZW5hYmxlKQogewogCXN0
cnVjdCBpbnRlcnJ1cHRfY250X3ByaXYgKnByaXYgPSBjb3VudGVyLT5wcml2OwogCi0JcmV0dXJu
IHN5c2ZzX2VtaXQoYnVmLCAiJWRcbiIsIHByaXYtPmVuYWJsZWQpOworCSplbmFibGUgPSBwcml2
LT5lbmFibGVkOworCisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IGludGVycnVwdF9j
bnRfZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkJICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJCSAgdm9pZCAqcHJpdmF0ZSwgY29uc3Qg
Y2hhciAqYnVmLAotCQkJCQkgIHNpemVfdCBsZW4pCitzdGF0aWMgaW50IGludGVycnVwdF9jbnRf
ZW5hYmxlX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgICAgICBz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IGVuYWJsZSkKIHsKIAlzdHJ1Y3QgaW50ZXJy
dXB0X2NudF9wcml2ICpwcml2ID0gY291bnRlci0+cHJpdjsKLQlib29sIGVuYWJsZTsKLQlzc2l6
ZV90IHJldDsKLQotCXJldCA9IGtzdHJ0b2Jvb2woYnVmLCAmZW5hYmxlKTsKLQlpZiAocmV0KQot
CQlyZXR1cm4gcmV0OwogCiAJaWYgKHByaXYtPmVuYWJsZWQgPT0gZW5hYmxlKQotCQlyZXR1cm4g
bGVuOworCQlyZXR1cm4gMDsKIAogCWlmIChlbmFibGUpIHsKIAkJcHJpdi0+ZW5hYmxlZCA9IHRy
dWU7CkBAIC02NiwzMyArNjAsMzAgQEAgc3RhdGljIHNzaXplX3QgaW50ZXJydXB0X2NudF9lbmFi
bGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAogCQlwcml2LT5lbmFibGVk
ID0gZmFsc2U7CiAJfQogCi0JcmV0dXJuIGxlbjsKKwlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGNv
bnN0IHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCBpbnRlcnJ1cHRfY250X2V4dFtdID0gewotCXsK
LQkJLm5hbWUgPSAiZW5hYmxlIiwKLQkJLnJlYWQgPSBpbnRlcnJ1cHRfY250X2VuYWJsZV9yZWFk
LAotCQkud3JpdGUgPSBpbnRlcnJ1cHRfY250X2VuYWJsZV93cml0ZSwKLQl9LAorc3RhdGljIHN0
cnVjdCBjb3VudGVyX2NvbXAgaW50ZXJydXB0X2NudF9leHRbXSA9IHsKKwlDT1VOVEVSX0NPTVBf
RU5BQkxFKGludGVycnVwdF9jbnRfZW5hYmxlX3JlYWQsCisJCQkgICAgaW50ZXJydXB0X2NudF9l
bmFibGVfd3JpdGUpLAogfTsKIAogc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2Fj
dGlvbiBpbnRlcnJ1cHRfY250X3N5bmFwc2VfYWN0aW9uc1tdID0gewogCUNPVU5URVJfU1lOQVBT
RV9BQ1RJT05fUklTSU5HX0VER0UsCiB9OwogCi1zdGF0aWMgaW50IGludGVycnVwdF9jbnRfYWN0
aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3lu
YXBzZSwKLQkJCQkgICAgc2l6ZV90ICphY3Rpb24pCitzdGF0aWMgaW50IGludGVycnVwdF9jbnRf
YWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAgICAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAorCQkJCSAgICAgc3RydWN0IGNvdW50ZXJfc3luYXBz
ZSAqc3luYXBzZSwKKwkJCQkgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9u
KQogewotCSphY3Rpb24gPSAwOworCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJ
U0lOR19FREdFOwogCiAJcmV0dXJuIDA7CiB9CiAKIHN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9y
ZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCSAgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyAqdmFsKQorCQkJICAgICAgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKIHsKIAlzdHJ1Y3QgaW50ZXJydXB0X2NudF9w
cml2ICpwcml2ID0gY291bnRlci0+cHJpdjsKIApAQCAtMTAyLDggKzkzLDcgQEAgc3RhdGljIGlu
dCBpbnRlcnJ1cHRfY250X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAogfQog
CiBzdGF0aWMgaW50IGludGVycnVwdF9jbnRfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAotCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCSAgICAg
ICBjb25zdCB1bnNpZ25lZCBsb25nIHZhbCkKKwkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsIGNvbnN0IHU2NCB2YWwpCiB7CiAJc3RydWN0IGludGVycnVwdF9jbnRfcHJpdiAq
cHJpdiA9IGNvdW50ZXItPnByaXY7CiAKQEAgLTExOSwxMSArMTA5LDExIEBAIHN0YXRpYyBjb25z
dCBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gaW50ZXJydXB0X2NudF9mdW5jdGlvbnNbXSA9IHsKIAlD
T1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFLAogfTsKIAotc3RhdGljIGludCBpbnRlcnJ1cHRfY250
X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJCSAgICAgIHNpemVfdCAqZnVuY3Rpb24p
CitzdGF0aWMgaW50IGludGVycnVwdF9jbnRfZnVuY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwK
KwkJCQkgICAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKIHsKLQkqZnVuY3Rp
b24gPSAwOworCSpmdW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0U7CiAKIAlyZXR1
cm4gMDsKIH0KQEAgLTE0OCwxMCArMTM4LDEwIEBAIHN0YXRpYyBpbnQgaW50ZXJydXB0X2NudF9z
aWduYWxfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiB9CiAKIHN0YXRpYyBj
b25zdCBzdHJ1Y3QgY291bnRlcl9vcHMgaW50ZXJydXB0X2NudF9vcHMgPSB7Ci0JLmFjdGlvbl9n
ZXQgPSBpbnRlcnJ1cHRfY250X2FjdGlvbl9nZXQsCisJLmFjdGlvbl9yZWFkID0gaW50ZXJydXB0
X2NudF9hY3Rpb25fcmVhZCwKIAkuY291bnRfcmVhZCA9IGludGVycnVwdF9jbnRfcmVhZCwKIAku
Y291bnRfd3JpdGUgPSBpbnRlcnJ1cHRfY250X3dyaXRlLAotCS5mdW5jdGlvbl9nZXQgPSBpbnRl
cnJ1cHRfY250X2Z1bmN0aW9uX2dldCwKKwkuZnVuY3Rpb25fcmVhZCA9IGludGVycnVwdF9jbnRf
ZnVuY3Rpb25fcmVhZCwKIAkuc2lnbmFsX3JlYWQgID0gaW50ZXJydXB0X2NudF9zaWduYWxfcmVh
ZCwKIH07CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci9taWNyb2NoaXAtdGNiLWNhcHR1
cmUuYyBiL2RyaXZlcnMvY291bnRlci9taWNyb2NoaXAtdGNiLWNhcHR1cmUuYwppbmRleCA0YzU3
ZDQzZTdkNjYuLjc5ZTBjODRhM2I4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9jb3VudGVyL21pY3Jv
Y2hpcC10Y2ItY2FwdHVyZS5jCisrKyBiL2RyaXZlcnMvY291bnRlci9taWNyb2NoaXAtdGNiLWNh
cHR1cmUuYwpAQCAtMzIsMjggKzMyLDE2IEBAIHN0cnVjdCBtY2hwX3RjX2RhdGEgewogCWJvb2wg
dHJpZ19pbnZlcnRlZDsKIH07CiAKLWVudW0gbWNocF90Y19jb3VudF9mdW5jdGlvbiB7Ci0JTUNI
UF9UQ19GVU5DVElPTl9JTkNSRUFTRSwKLQlNQ0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRVUkUsCi19
OwotCi1zdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX2NvdW50X2Z1bmN0aW9uIG1jaHBfdGNfY291
bnRfZnVuY3Rpb25zW10gPSB7Ci0JW01DSFBfVENfRlVOQ1RJT05fSU5DUkVBU0VdID0gQ09VTlRF
Ul9GVU5DVElPTl9JTkNSRUFTRSwKLQlbTUNIUF9UQ19GVU5DVElPTl9RVUFEUkFUVVJFXSA9IENP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKLX07Ci0KLWVudW0gbWNocF90Y19zeW5hcHNl
X2FjdGlvbiB7Ci0JTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9OT05FID0gMCwKLQlNQ0hQX1RDX1NZ
TkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAotCU1DSFBfVENfU1lOQVBTRV9BQ1RJT05fRkFMTElO
R19FREdFLAotCU1DSFBfVENfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFCitzdGF0aWMgY29uc3Qg
ZW51bSBjb3VudGVyX2Z1bmN0aW9uIG1jaHBfdGNfY291bnRfZnVuY3Rpb25zW10gPSB7CisJQ09V
TlRFUl9GVU5DVElPTl9JTkNSRUFTRSwKKwlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQs
CiB9OwogCiBzdGF0aWMgY29uc3QgZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIG1jaHBfdGNf
c3luYXBzZV9hY3Rpb25zW10gPSB7Ci0JW01DSFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBD
T1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUsCi0JW01DSFBfVENfU1lOQVBTRV9BQ1RJT05fUklT
SU5HX0VER0VdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKLQlbTUNIUF9U
Q19TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0VdID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9G
QUxMSU5HX0VER0UsCi0JW01DSFBfVENfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFXSA9IENPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05P
TkUsCisJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKKwlDT1VOVEVSX1NZTkFQ
U0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURH
RVMsCiB9OwogCiBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc2lnbmFsIG1jaHBfdGNfY291bnRfc2ln
bmFsc1tdID0gewpAQCAtODAsMjMgKzY4LDIzIEBAIHN0YXRpYyBzdHJ1Y3QgY291bnRlcl9zeW5h
cHNlIG1jaHBfdGNfY291bnRfc3luYXBzZXNbXSA9IHsKIAl9CiB9OwogCi1zdGF0aWMgaW50IG1j
aHBfdGNfY291bnRfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
LQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJICAgICAgc2l6ZV90
ICpmdW5jdGlvbikKK3N0YXRpYyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9yZWFkKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291
bnQgKmNvdW50LAorCQkJCSAgICAgICBlbnVtIGNvdW50ZXJfZnVuY3Rpb24gKmZ1bmN0aW9uKQog
ewogCXN0cnVjdCBtY2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2OwogCiAJ
aWYgKHByaXYtPnFkZWNfbW9kZSkKLQkJKmZ1bmN0aW9uID0gTUNIUF9UQ19GVU5DVElPTl9RVUFE
UkFUVVJFOworCQkqZnVuY3Rpb24gPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ7CiAJ
ZWxzZQotCQkqZnVuY3Rpb24gPSBNQ0hQX1RDX0ZVTkNUSU9OX0lOQ1JFQVNFOworCQkqZnVuY3Rp
b24gPSBDT1VOVEVSX0ZVTkNUSU9OX0lOQ1JFQVNFOwogCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRp
YyBpbnQgbWNocF90Y19jb3VudF9mdW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAotCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkgICAg
ICBzaXplX3QgZnVuY3Rpb24pCitzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fd3Jp
dGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCQlzdHJ1Y3QgY291bnRlcl9j
b3VudCAqY291bnQsCisJCQkJCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbikKIHsKIAlz
dHJ1Y3QgbWNocF90Y19kYXRhICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAl1MzIgYm1y
LCBjbXI7CkBAIC0xMDgsNyArOTYsNyBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rp
b25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAljbXIgJj0gfkFUTUVMX1RD
X1dBVkU7CiAKIAlzd2l0Y2ggKGZ1bmN0aW9uKSB7Ci0JY2FzZSBNQ0hQX1RDX0ZVTkNUSU9OX0lO
Q1JFQVNFOgorCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKIAkJcHJpdi0+cWRlY19t
b2RlID0gMDsKIAkJLyogU2V0IGhpZ2hlc3QgcmF0ZSBiYXNlZCBvbiB3aGV0aGVyIHNvYyBoYXMg
Z2NsayBvciBub3QgKi8KIAkJYm1yICY9IH4oQVRNRUxfVENfUURFTiB8IEFUTUVMX1RDX1BPU0VO
KTsKQEAgLTEyMCw3ICsxMDgsNyBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfZnVuY3Rpb25f
c2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAkJY21yIHw9ICBBVE1FTF9UQ19D
TVJfTUFTSzsKIAkJY21yICY9IH4oQVRNRUxfVENfQUJFVFJHIHwgQVRNRUxfVENfWEMwKTsKIAkJ
YnJlYWs7Ci0JY2FzZSBNQ0hQX1RDX0ZVTkNUSU9OX1FVQURSQVRVUkU6CisJY2FzZSBDT1VOVEVS
X0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6CiAJCWlmICghcHJpdi0+dGNfY2ZnLT5oYXNfcWRlYykK
IAkJCXJldHVybiAtRUlOVkFMOwogCQkvKiBJbiBRREVDIG1vZGUgc2V0dGluZ3MgYm90aCBjaGFu
bmVscyAwIGFuZCAxIGFyZSByZXF1aXJlZCAqLwpAQCAtMTc2LDEwICsxNjQsMTAgQEAgc3RhdGlj
IGludCBtY2hwX3RjX2NvdW50X3NpZ25hbF9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2FjdGlvbl9n
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCSAgICBzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCi0JCQkJICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2Us
Ci0JCQkJICAgIHNpemVfdCAqYWN0aW9uKQorc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2FjdGlv
bl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5
bmFwc2UsCisJCQkJICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKIHsK
IAlzdHJ1Y3QgbWNocF90Y19kYXRhICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAl1MzIg
Y21yOwpAQCAtMTg4LDI2ICsxNzYsMjYgQEAgc3RhdGljIGludCBtY2hwX3RjX2NvdW50X2FjdGlv
bl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAogCiAJc3dpdGNoIChjbXIgJiBB
VE1FTF9UQ19FVFJHRURHKSB7CiAJZGVmYXVsdDoKLQkJKmFjdGlvbiA9IE1DSFBfVENfU1lOQVBT
RV9BQ1RJT05fTk9ORTsKKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsK
IAkJYnJlYWs7CiAJY2FzZSBBVE1FTF9UQ19FVFJHRURHX1JJU0lORzoKLQkJKmFjdGlvbiA9IE1D
SFBfVENfU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0U7CisJCSphY3Rpb24gPSBDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX1JJU0lOR19FREdFOwogCQlicmVhazsKIAljYXNlIEFUTUVMX1RDX0VUUkdF
REdfRkFMTElORzoKLQkJKmFjdGlvbiA9IE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fRkFMTElOR19F
REdFOworCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0U7CiAJ
CWJyZWFrOwogCWNhc2UgQVRNRUxfVENfRVRSR0VER19CT1RIOgotCQkqYWN0aW9uID0gTUNIUF9U
Q19TWU5BUFNFX0FDVElPTl9CT1RIX0VER0U7CisJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX0JPVEhfRURHRVM7CiAJCWJyZWFrOwogCX0KIAogCXJldHVybiAwOwogfQogCi1zdGF0
aWMgaW50IG1jaHBfdGNfY291bnRfYWN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCi0JCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkgICAgc3Ry
dWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKLQkJCQkgICAgc2l6ZV90IGFjdGlvbikKK3N0
YXRpYyBpbnQgbWNocF90Y19jb3VudF9hY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAorCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkg
ICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAorCQkJCSAgICAgIGVudW0gY291
bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rpb24pCiB7CiAJc3RydWN0IG1jaHBfdGNfZGF0YSAqY29u
c3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAJdTMyIGVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX05P
TkU7CkBAIC0yMTcsMTYgKzIwNSwxNiBAQCBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfYWN0aW9u
X3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAJCXJldHVybiAtRUlOVkFMOwog
CiAJc3dpdGNoIChhY3Rpb24pIHsKLQljYXNlIE1DSFBfVENfU1lOQVBTRV9BQ1RJT05fTk9ORToK
KwljYXNlIENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORToKIAkJZWRnZSA9IEFUTUVMX1RDX0VU
UkdFREdfTk9ORTsKIAkJYnJlYWs7Ci0JY2FzZSBNQ0hQX1RDX1NZTkFQU0VfQUNUSU9OX1JJU0lO
R19FREdFOgorCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRToKIAkJZWRn
ZSA9IEFUTUVMX1RDX0VUUkdFREdfUklTSU5HOwogCQlicmVhazsKLQljYXNlIE1DSFBfVENfU1lO
QVBTRV9BQ1RJT05fRkFMTElOR19FREdFOgorCWNhc2UgQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9G
QUxMSU5HX0VER0U6CiAJCWVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX0ZBTExJTkc7CiAJCWJyZWFr
OwotCWNhc2UgTUNIUF9UQ19TWU5BUFNFX0FDVElPTl9CT1RIX0VER0U6CisJY2FzZSBDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM6CiAJCWVkZ2UgPSBBVE1FTF9UQ19FVFJHRURHX0JP
VEg7CiAJCWJyZWFrOwogCWRlZmF1bHQ6CkBAIC0yNDAsOCArMjI4LDcgQEAgc3RhdGljIGludCBt
Y2hwX3RjX2NvdW50X2FjdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAog
fQogCiBzdGF0aWMgaW50IG1jaHBfdGNfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCi0JCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkgICAg
ICB1bnNpZ25lZCBsb25nICp2YWwpCisJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291
bnQsIHU2NCAqdmFsKQogewogCXN0cnVjdCBtY2hwX3RjX2RhdGEgKmNvbnN0IHByaXYgPSBjb3Vu
dGVyLT5wcml2OwogCXUzMiBjbnQ7CkBAIC0yNjQsMTIgKzI1MSwxMiBAQCBzdGF0aWMgc3RydWN0
IGNvdW50ZXJfY291bnQgbWNocF90Y19jb3VudHNbXSA9IHsKIH07CiAKIHN0YXRpYyBjb25zdCBz
dHJ1Y3QgY291bnRlcl9vcHMgbWNocF90Y19vcHMgPSB7Ci0JLnNpZ25hbF9yZWFkICA9IG1jaHBf
dGNfY291bnRfc2lnbmFsX3JlYWQsCi0JLmNvdW50X3JlYWQgICA9IG1jaHBfdGNfY291bnRfcmVh
ZCwKLQkuZnVuY3Rpb25fZ2V0ID0gbWNocF90Y19jb3VudF9mdW5jdGlvbl9nZXQsCi0JLmZ1bmN0
aW9uX3NldCA9IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fc2V0LAotCS5hY3Rpb25fZ2V0ICAgPSBt
Y2hwX3RjX2NvdW50X2FjdGlvbl9nZXQsCi0JLmFjdGlvbl9zZXQgICA9IG1jaHBfdGNfY291bnRf
YWN0aW9uX3NldAorCS5zaWduYWxfcmVhZCAgICA9IG1jaHBfdGNfY291bnRfc2lnbmFsX3JlYWQs
CisJLmNvdW50X3JlYWQgICAgID0gbWNocF90Y19jb3VudF9yZWFkLAorCS5mdW5jdGlvbl9yZWFk
ICA9IG1jaHBfdGNfY291bnRfZnVuY3Rpb25fcmVhZCwKKwkuZnVuY3Rpb25fd3JpdGUgPSBtY2hw
X3RjX2NvdW50X2Z1bmN0aW9uX3dyaXRlLAorCS5hY3Rpb25fcmVhZCAgICA9IG1jaHBfdGNfY291
bnRfYWN0aW9uX3JlYWQsCisJLmFjdGlvbl93cml0ZSAgID0gbWNocF90Y19jb3VudF9hY3Rpb25f
d3JpdGUKIH07CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYXRtZWxfdGNiX2NvbmZpZyB0Y2Jfcm05
MjAwX2NvbmZpZyA9IHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvY291bnRlci9zdG0zMi1scHRpbWVy
LWNudC5jIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLWxwdGltZXItY250LmMKaW5kZXggMTM2NTY5
NTdjNDVmLi5hZWY3OGE0MjE3YjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvY291bnRlci9zdG0zMi1s
cHRpbWVyLWNudC5jCisrKyBiL2RyaXZlcnMvY291bnRlci9zdG0zMi1scHRpbWVyLWNudC5jCkBA
IC0xNyw2ICsxNyw3IEBACiAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CiAjaW5jbHVkZSA8bGlu
dXgvcGluY3RybC9jb25zdW1lci5oPgogI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2RldmljZS5o
PgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKIHN0cnVjdCBzdG0zMl9scHRpbV9jbnQgewog
CXN0cnVjdCBjb3VudGVyX2RldmljZSBjb3VudGVyOwpAQCAtMTMwLDMyICsxMzEsNDYgQEAgc3Rh
dGljIGludCBzdG0zMl9scHRpbV9zZXR1cChzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250ICpwcml2LCBp
bnQgZW5hYmxlKQogICogKy0tLS0tLS0tLSstLS0tLS0tLS0tKy0tLS0tLS0tLS0rLS0tLS0tLS0t
Ky0tLS0tLS0tLS0rLS0tLS0tLS0tKwogICovCiBlbnVtIHN0bTMyX2xwdGltX2NudF9mdW5jdGlv
biB7Ci0JU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRSwKLQlTVE0zMl9MUFRJTV9FTkNPREVS
X0JPVEhfRURHRSwKKwlTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNFID0gQ09VTlRFUl9GVU5D
VElPTl9JTkNSRUFTRSwKKwlTVE0zMl9MUFRJTV9FTkNPREVSX0JPVEhfRURHRSA9IENPVU5URVJf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKIH07CiAKIHN0YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJf
ZnVuY3Rpb24gc3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uc1tdID0gewotCVtTVE0zMl9MUFRJTV9D
T1VOVEVSX0lOQ1JFQVNFXSA9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCi0JW1NUTTMyX0xQ
VElNX0VOQ09ERVJfQk9USF9FREdFXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwK
KwlTVE0zMl9MUFRJTV9DT1VOVEVSX0lOQ1JFQVNFLAorCVNUTTMyX0xQVElNX0VOQ09ERVJfQk9U
SF9FREdFLAogfTsKIAogZW51bSBzdG0zMl9scHRpbV9zeW5hcHNlX2FjdGlvbiB7CisJLyogSW5k
ZXggbXVzdCBtYXRjaCB3aXRoIHN0bTMyX2xwdGltX2NudF9wb2xhcml0eVtdIChwcml2LT5wb2xh
cml0eSkgKi8KIAlTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKIAlTVE0z
Ml9MUFRJTV9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VER0UsCiAJU1RNMzJfTFBUSU1fU1lOQVBT
RV9BQ1RJT05fQk9USF9FREdFUywKIAlTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9OT05FLAog
fTsKIAotc3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9scHRp
bV9jbnRfc3luYXBzZV9hY3Rpb25zW10gPSB7Ci0JLyogSW5kZXggbXVzdCBtYXRjaCB3aXRoIHN0
bTMyX2xwdGltX2NudF9wb2xhcml0eVtdIChwcml2LT5wb2xhcml0eSkgKi8KK3N0YXRpYyBjb25z
dCBlbnVtIHN0bTMyX2xwdGltX3N5bmFwc2VfYWN0aW9uIHN0bTMyX2xwdGltX2MybF9hY3Rpb25z
X21hcFtdID0geworCVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IFNUTTMy
X0xQVElNX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAorCVtDT1VOVEVSX1NZTkFQU0VfQUNU
SU9OX0ZBTExJTkdfRURHRV0gPSBTVE0zMl9MUFRJTV9TWU5BUFNFX0FDVElPTl9GQUxMSU5HX0VE
R0UsCisJW0NPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFU10gPSBTVE0zMl9MUFRJTV9T
WU5BUFNFX0FDVElPTl9CT1RIX0VER0VTLAorCVtDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkVd
ID0gU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fTk9ORSwKK307CisKK3N0YXRpYyBjb25zdCBl
bnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gc3RtMzJfbHB0aW1fbDJjX2FjdGlvbnNfbWFwW10g
PSB7CiAJW1NUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFXSA9IENPVU5URVJf
U1lOQVBTRV9BQ1RJT05fUklTSU5HX0VER0UsCiAJW1NUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9O
X0ZBTExJTkdfRURHRV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKIAlb
U1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFU10gPSBDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX0JPVEhfRURHRVMsCiAJW1NUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX05PTkVdID0g
Q09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAogfTsKIAorc3RhdGljIGNvbnN0IGVudW0gY291
bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9scHRpbV9jbnRfc3luYXBzZV9hY3Rpb25zW10gPSB7
CisJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKKwlDT1VOVEVSX1NZTkFQU0Vf
QUNUSU9OX0ZBTExJTkdfRURHRSwKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMs
CisJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAorfTsKKwogc3RhdGljIGludCBzdG0zMl9s
cHRpbV9jbnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nICp2YWwpCisJCQkJc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKIHsKIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1fY250
ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAl1MzIgY250OwpAQCAtMTcwLDkgKzE4NSw5
IEBAIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAogCXJldHVybiAwOwogfQogCi1zdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9m
dW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCQlzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJCXNpemVfdCAqZnVuY3Rpb24pCitzdGF0aWMgaW50
IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKKwkJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkJIGVudW0gY291
bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb24pCiB7CiAJc3RydWN0IHN0bTMyX2xwdGltX2NudCAqY29u
c3QgcHJpdiA9IGNvdW50ZXItPnByaXY7CiAKQEAgLTE4OSw5ICsyMDQsOSBAQCBzdGF0aWMgaW50
IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3Vu
dGVyLAogCXJldHVybiAtRUlOVkFMOwogfQogCi1zdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9m
dW5jdGlvbl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCQlzdHJ1Y3Qg
Y291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJCXNpemVfdCBmdW5jdGlvbikKK3N0YXRpYyBpbnQg
c3RtMzJfbHB0aW1fY250X2Z1bmN0aW9uX3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKKwkJCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCisJCQkJCSAgZW51bSBj
b3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uKQogewogCXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNv
bnN0IHByaXYgPSBjb3VudGVyLT5wcml2OwogCkBAIC0yMTIsOSArMjI3LDkgQEAgc3RhdGljIGlu
dCBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fc2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKIAl9CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9lbmFibGVfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJCSAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKLQkJCQkJICAgdm9pZCAqcHJpdmF0ZSwgY2hhciAqYnVmKQorc3RhdGlj
IGludCBzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAorCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCisJCQkJICAg
ICAgIHU4ICplbmFibGUpCiB7CiAJc3RydWN0IHN0bTMyX2xwdGltX2NudCAqY29uc3QgcHJpdiA9
IGNvdW50ZXItPnByaXY7CiAJaW50IHJldDsKQEAgLTIyMywyMiArMjM4LDE4IEBAIHN0YXRpYyBz
c2l6ZV90IHN0bTMyX2xwdGltX2NudF9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsCiAJaWYgKHJldCA8IDApCiAJCXJldHVybiByZXQ7CiAKLQlyZXR1cm4gc2NucHJp
bnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVcbiIsIHJldCk7CisJKmVuYWJsZSA9IHJldDsKKworCXJl
dHVybiAwOwogfQogCi1zdGF0aWMgc3NpemVfdCBzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3dyaXRl
KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkJICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKLQkJCQkJICAgIHZvaWQgKnByaXZhdGUsCi0JCQkJCSAgICBjb25zdCBj
aGFyICpidWYsIHNpemVfdCBsZW4pCitzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9lbmFibGVf
d3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCQlzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCisJCQkJCXU4IGVuYWJsZSkKIHsKIAlzdHJ1Y3Qgc3RtMzJfbHB0aW1f
Y250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKLQlib29sIGVuYWJsZTsKIAlpbnQgcmV0
OwogCi0JcmV0ID0ga3N0cnRvYm9vbChidWYsICZlbmFibGUpOwotCWlmIChyZXQpCi0JCXJldHVy
biByZXQ7Ci0KIAkvKiBDaGVjayBub2JvZHkgdXNlcyB0aGUgdGltZXIsIG9yIGFscmVhZHkgZGlz
YWJsZWQvZW5hYmxlZCAqLwogCXJldCA9IHN0bTMyX2xwdGltX2lzX2VuYWJsZWQocHJpdik7CiAJ
aWYgKChyZXQgPCAwKSB8fCAoIXJldCAmJiAhZW5hYmxlKSkKQEAgLTI1NCw2NSArMjY1LDU0IEBA
IHN0YXRpYyBzc2l6ZV90IHN0bTMyX2xwdGltX2NudF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlyZXR1cm4g
bGVuOworCXJldHVybiAwOwogfQogCi1zdGF0aWMgc3NpemVfdCBzdG0zMl9scHRpbV9jbnRfY2Vp
bGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCQkJICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkJICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1
ZikKK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2NlaWxpbmdfcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJ
CQkJdTY0ICpjZWlsaW5nKQogewogCXN0cnVjdCBzdG0zMl9scHRpbV9jbnQgKmNvbnN0IHByaXYg
PSBjb3VudGVyLT5wcml2OwogCi0JcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFHRV9TSVpFLCAiJXVc
biIsIHByaXYtPmNlaWxpbmcpOworCSpjZWlsaW5nID0gcHJpdi0+Y2VpbGluZzsKKworCXJldHVy
biAwOwogfQogCi1zdGF0aWMgc3NpemVfdCBzdG0zMl9scHRpbV9jbnRfY2VpbGluZ193cml0ZShz
dHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJCSAgICAgc3RydWN0IGNvdW50ZXJf
Y291bnQgKmNvdW50LAotCQkJCQkgICAgIHZvaWQgKnByaXZhdGUsCi0JCQkJCSAgICAgY29uc3Qg
Y2hhciAqYnVmLCBzaXplX3QgbGVuKQorc3RhdGljIGludCBzdG0zMl9scHRpbV9jbnRfY2VpbGlu
Z193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJCSBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCisJCQkJCSB1NjQgY2VpbGluZykKIHsKIAlzdHJ1Y3Qgc3RtMzJf
bHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKLQl1bnNpZ25lZCBpbnQgY2Vp
bGluZzsKLQlpbnQgcmV0OwogCiAJaWYgKHN0bTMyX2xwdGltX2lzX2VuYWJsZWQocHJpdikpCiAJ
CXJldHVybiAtRUJVU1k7CiAKLQlyZXQgPSBrc3RydG91aW50KGJ1ZiwgMCwgJmNlaWxpbmcpOwot
CWlmIChyZXQpCi0JCXJldHVybiByZXQ7Ci0KIAlpZiAoY2VpbGluZyA+IFNUTTMyX0xQVElNX01B
WF9BUlIpCiAJCXJldHVybiAtRVJBTkdFOwogCiAJcHJpdi0+Y2VpbGluZyA9IGNlaWxpbmc7CiAK
LQlyZXR1cm4gbGVuOworCXJldHVybiAwOwogfQogCi1zdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50
ZXJfY291bnRfZXh0IHN0bTMyX2xwdGltX2NudF9leHRbXSA9IHsKLQl7Ci0JCS5uYW1lID0gImVu
YWJsZSIsCi0JCS5yZWFkID0gc3RtMzJfbHB0aW1fY250X2VuYWJsZV9yZWFkLAotCQkud3JpdGUg
PSBzdG0zMl9scHRpbV9jbnRfZW5hYmxlX3dyaXRlCi0JfSwKLQl7Ci0JCS5uYW1lID0gImNlaWxp
bmciLAotCQkucmVhZCA9IHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3JlYWQsCi0JCS53cml0ZSA9
IHN0bTMyX2xwdGltX2NudF9jZWlsaW5nX3dyaXRlCi0JfSwKK3N0YXRpYyBzdHJ1Y3QgY291bnRl
cl9jb21wIHN0bTMyX2xwdGltX2NudF9leHRbXSA9IHsKKwlDT1VOVEVSX0NPTVBfRU5BQkxFKHN0
bTMyX2xwdGltX2NudF9lbmFibGVfcmVhZCwKKwkJCSAgICBzdG0zMl9scHRpbV9jbnRfZW5hYmxl
X3dyaXRlKSwKKwlDT1VOVEVSX0NPTVBfQ0VJTElORyhzdG0zMl9scHRpbV9jbnRfY2VpbGluZ19y
ZWFkLAorCQkJICAgICBzdG0zMl9scHRpbV9jbnRfY2VpbGluZ193cml0ZSksCiB9OwogCi1zdGF0
aWMgaW50IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAq
Y291bnRlciwKLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJICAg
ICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwKLQkJCQkgICAgICBzaXplX3QgKmFj
dGlvbikKK3N0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2FjdGlvbl9yZWFkKHN0cnVjdCBjb3Vu
dGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50LAorCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAorCQkJCSAg
ICAgICBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbikKIHsKIAlzdHJ1Y3Qgc3Rt
MzJfbHB0aW1fY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKLQlzaXplX3QgZnVuY3Rp
b247CisJZW51bSBjb3VudGVyX2Z1bmN0aW9uIGZ1bmN0aW9uOwogCWludCBlcnI7CiAKLQllcnIg
PSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAmZnVuY3Rpb24p
OworCWVyciA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50LCAm
ZnVuY3Rpb24pOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKQEAgLTMyMCwxMiArMzIwLDEy
IEBAIHN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAogCWNhc2UgU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRToKIAkJ
LyogTFAgVGltZXIgYWN0cyBhcyB1cC1jb3VudGVyIG9uIGlucHV0IDEgKi8KIAkJaWYgKHN5bmFw
c2UtPnNpZ25hbC0+aWQgPT0gY291bnQtPnN5bmFwc2VzWzBdLnNpZ25hbC0+aWQpCi0JCQkqYWN0
aW9uID0gcHJpdi0+cG9sYXJpdHk7CisJCQkqYWN0aW9uID0gc3RtMzJfbHB0aW1fbDJjX2FjdGlv
bnNfbWFwW3ByaXYtPnBvbGFyaXR5XTsKIAkJZWxzZQotCQkJKmFjdGlvbiA9IFNUTTMyX0xQVElN
X1NZTkFQU0VfQUNUSU9OX05PTkU7CisJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9OT05FOwogCQlyZXR1cm4gMDsKIAljYXNlIFNUTTMyX0xQVElNX0VOQ09ERVJfQk9USF9FREdF
OgotCQkqYWN0aW9uID0gcHJpdi0+cG9sYXJpdHk7CisJCSphY3Rpb24gPSBzdG0zMl9scHRpbV9s
MmNfYWN0aW9uc19tYXBbcHJpdi0+cG9sYXJpdHldOwogCQlyZXR1cm4gMDsKIAlkZWZhdWx0Ogog
CQkvKiBzaG91bGQgbmV2ZXIgcmVhY2ggdGhpcyBwYXRoICovCkBAIC0zMzMsNDMgKzMzMywzOSBA
QCBzdGF0aWMgaW50IHN0bTMyX2xwdGltX2NudF9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKIAl9CiB9CiAKLXN0YXRpYyBpbnQgc3RtMzJfbHB0aW1fY250X2FjdGlv
bl9zZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCSAgICAgIHN0cnVjdCBj
b3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpz
eW5hcHNlLAotCQkJCSAgICAgIHNpemVfdCBhY3Rpb24pCitzdGF0aWMgaW50IHN0bTMyX2xwdGlt
X2NudF9hY3Rpb25fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCQlz
dHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCisJCQkJCXN0cnVjdCBjb3VudGVyX3N5bmFwc2Ug
KnN5bmFwc2UsCisJCQkJCWVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rpb24pCiB7CiAJ
c3RydWN0IHN0bTMyX2xwdGltX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXItPnByaXY7Ci0Jc2l6
ZV90IGZ1bmN0aW9uOworCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKIAlpbnQgZXJy
OwogCiAJaWYgKHN0bTMyX2xwdGltX2lzX2VuYWJsZWQocHJpdikpCiAJCXJldHVybiAtRUJVU1k7
CiAKLQllcnIgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fZ2V0KGNvdW50ZXIsIGNvdW50LCAm
ZnVuY3Rpb24pOworCWVyciA9IHN0bTMyX2xwdGltX2NudF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIs
IGNvdW50LCAmZnVuY3Rpb24pOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKIAkvKiBvbmx5
IHNldCBwb2xhcml0eSB3aGVuIGluIGNvdW50ZXIgbW9kZSAob24gaW5wdXQgMSkgKi8KLQlpZiAo
ZnVuY3Rpb24gPT0gU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFTRQotCSAgICAmJiBzeW5hcHNl
LT5zaWduYWwtPmlkID09IGNvdW50LT5zeW5hcHNlc1swXS5zaWduYWwtPmlkKSB7Ci0JCXN3aXRj
aCAoYWN0aW9uKSB7Ci0JCWNhc2UgU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fUklTSU5HX0VE
R0U6Ci0JCWNhc2UgU1RNMzJfTFBUSU1fU1lOQVBTRV9BQ1RJT05fRkFMTElOR19FREdFOgotCQlj
YXNlIFNUTTMyX0xQVElNX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM6Ci0JCQlwcml2LT5wb2xh
cml0eSA9IGFjdGlvbjsKLQkJCXJldHVybiAwOwotCQl9Ci0JfQorCWlmICgoZW51bSBzdG0zMl9s
cHRpbV9jbnRfZnVuY3Rpb24pZnVuY3Rpb24gIT0gU1RNMzJfTFBUSU1fQ09VTlRFUl9JTkNSRUFT
RQorCSAgICB8fCBzeW5hcHNlLT5zaWduYWwtPmlkICE9IGNvdW50LT5zeW5hcHNlc1swXS5zaWdu
YWwtPmlkCisJICAgIHx8IGFjdGlvbiA9PSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUpCisJ
CXJldHVybiAtRUlOVkFMOwogCi0JcmV0dXJuIC1FSU5WQUw7CisJcHJpdi0+cG9sYXJpdHkgPSBz
dG0zMl9scHRpbV9jMmxfYWN0aW9uc19tYXBbYWN0aW9uXTsKKworCXJldHVybiAwOwogfQogCiBz
dGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIHN0bTMyX2xwdGltX2NudF9vcHMgPSB7CiAJ
LmNvdW50X3JlYWQgPSBzdG0zMl9scHRpbV9jbnRfcmVhZCwKLQkuZnVuY3Rpb25fZ2V0ID0gc3Rt
MzJfbHB0aW1fY250X2Z1bmN0aW9uX2dldCwKLQkuZnVuY3Rpb25fc2V0ID0gc3RtMzJfbHB0aW1f
Y250X2Z1bmN0aW9uX3NldCwKLQkuYWN0aW9uX2dldCA9IHN0bTMyX2xwdGltX2NudF9hY3Rpb25f
Z2V0LAotCS5hY3Rpb25fc2V0ID0gc3RtMzJfbHB0aW1fY250X2FjdGlvbl9zZXQsCisJLmZ1bmN0
aW9uX3JlYWQgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fcmVhZCwKKwkuZnVuY3Rpb25fd3Jp
dGUgPSBzdG0zMl9scHRpbV9jbnRfZnVuY3Rpb25fd3JpdGUsCisJLmFjdGlvbl9yZWFkID0gc3Rt
MzJfbHB0aW1fY250X2FjdGlvbl9yZWFkLAorCS5hY3Rpb25fd3JpdGUgPSBzdG0zMl9scHRpbV9j
bnRfYWN0aW9uX3dyaXRlLAogfTsKIAogc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbCBzdG0z
Ml9scHRpbV9jbnRfc2lnbmFsc1tdID0gewpkaWZmIC0tZ2l0IGEvZHJpdmVycy9jb3VudGVyL3N0
bTMyLXRpbWVyLWNudC5jIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5jCmluZGV4
IDNmYjBkZWJkNzQyNS4uYzY5MGI3NmU1ZGFiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2NvdW50ZXIv
c3RtMzItdGltZXItY250LmMKKysrIGIvZHJpdmVycy9jb3VudGVyL3N0bTMyLXRpbWVyLWNudC5j
CkBAIC0xMyw2ICsxMyw3IEBACiAjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+CiAjaW5jbHVkZSA8
bGludXgvcGluY3RybC9jb25zdW1lci5oPgogI2luY2x1ZGUgPGxpbnV4L3BsYXRmb3JtX2Rldmlj
ZS5oPgorI2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKICNkZWZpbmUgVElNX0NDTVJfQ0NYUwko
QklUKDgpIHwgQklUKDApKQogI2RlZmluZSBUSU1fQ0NNUl9NQVNLCShUSU1fQ0NNUl9DQzFTIHwg
VElNX0NDTVJfQ0MyUyB8IFwKQEAgLTQ0LDIxICs0NSwyMSBAQCBzdHJ1Y3Qgc3RtMzJfdGltZXJf
Y250IHsKICAqIEBTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMzogY291bnRzIG9uIGJvdGggVEkx
RlAxIGFuZCBUSTJGUDIgZWRnZXMKICAqLwogZW51bSBzdG0zMl9jb3VudF9mdW5jdGlvbiB7CisJ
U1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxFRCA9IENPVU5URVJfRlVOQ1RJT05fSU5DUkVB
U0UsCisJU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzEgPSBDT1VOVEVSX0ZVTkNUSU9OX1FVQURS
QVRVUkVfWDJfQSwKKwlTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMiA9IENPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YMl9CLAorCVNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zID0gQ09VTlRF
Ul9GVU5DVElPTl9RVUFEUkFUVVJFX1g0LAorfTsKKworc3RhdGljIGNvbnN0IGVudW0gY291bnRl
cl9mdW5jdGlvbiBzdG0zMl9jb3VudF9mdW5jdGlvbnNbXSA9IHsKIAlTVE0zMl9DT1VOVF9TTEFW
RV9NT0RFX0RJU0FCTEVELAogCVNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8xLAogCVNUTTMyX0NP
VU5UX0VOQ09ERVJfTU9ERV8yLAogCVNUTTMyX0NPVU5UX0VOQ09ERVJfTU9ERV8zLAogfTsKIAot
c3RhdGljIGNvbnN0IGVudW0gY291bnRlcl9mdW5jdGlvbiBzdG0zMl9jb3VudF9mdW5jdGlvbnNb
XSA9IHsKLQlbU1RNMzJfQ09VTlRfU0xBVkVfTU9ERV9ESVNBQkxFRF0gPSBDT1VOVEVSX0ZVTkNU
SU9OX0lOQ1JFQVNFLAotCVtTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMV0gPSBDT1VOVEVSX0ZV
TkNUSU9OX1FVQURSQVRVUkVfWDJfQSwKLQlbU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzJdID0g
Q09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJFX1gyX0IsCi0JW1NUTTMyX0NPVU5UX0VOQ09ERVJf
TU9ERV8zXSA9IENPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNCwKLX07Ci0KIHN0YXRpYyBp
bnQgc3RtMzJfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1bnNpZ25lZCBsb25nICp2YWwpCisJCQkg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbCkKIHsKIAlzdHJ1Y3Qgc3Rt
MzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAl1MzIgY250OwpAQCAt
NzAsOCArNzEsNyBAQCBzdGF0aWMgaW50IHN0bTMyX2NvdW50X3JlYWQoc3RydWN0IGNvdW50ZXJf
ZGV2aWNlICpjb3VudGVyLAogfQogCiBzdGF0aWMgaW50IHN0bTMyX2NvdW50X3dyaXRlKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCSAgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LAotCQkJICAgICBjb25zdCB1bnNpZ25lZCBsb25nIHZhbCkKKwkJCSAgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LCBjb25zdCB1NjQgdmFsKQogewogCXN0cnVjdCBzdG0zMl90
aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2OwogCXUzMiBjZWlsaW5nOwpAQCAt
ODMsOSArODMsOSBAQCBzdGF0aWMgaW50IHN0bTMyX2NvdW50X3dyaXRlKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKIAlyZXR1cm4gcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcCwgVElN
X0NOVCwgdmFsKTsKIH0KIAotc3RhdGljIGludCBzdG0zMl9jb3VudF9mdW5jdGlvbl9nZXQoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCi0JCQkJICAgIHNpemVfdCAqZnVuY3Rpb24pCitzdGF0aWMgaW50IHN0bTMyX2Nv
dW50X2Z1bmN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAorCQkJCSAgICAgZW51bSBjb3VudGVyX2Z1
bmN0aW9uICpmdW5jdGlvbikKIHsKIAlzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2
ID0gY291bnRlci0+cHJpdjsKIAl1MzIgc21jcjsKQEAgLTExMCw5ICsxMTAsOSBAQCBzdGF0aWMg
aW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCiAJfQogfQogCi1zdGF0aWMgaW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpj
b3VudCwKLQkJCQkgICAgc2l6ZV90IGZ1bmN0aW9uKQorc3RhdGljIGludCBzdG0zMl9jb3VudF9m
dW5jdGlvbl93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgICAg
c3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAorCQkJCSAgICAgIGVudW0gY291bnRlcl9mdW5j
dGlvbiBmdW5jdGlvbikKIHsKIAlzdHJ1Y3Qgc3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0g
Y291bnRlci0+cHJpdjsKIAl1MzIgY3IxLCBzbXM7CkBAIC0xNTAsNDQgKzE1MCwzNyBAQCBzdGF0
aWMgaW50IHN0bTMyX2NvdW50X2Z1bmN0aW9uX3NldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHN0bTMyX2NvdW50X2RpcmVj
dGlvbl9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKK3N0YXRpYyBpbnQgc3Rt
MzJfY291bnRfZGlyZWN0aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAog
CQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkgICAgICB2b2lkICpw
cml2YXRlLCBjaGFyICpidWYpCisJCQkJICAgICAgZW51bSBjb3VudGVyX2NvdW50X2RpcmVjdGlv
biAqZGlyZWN0aW9uKQogewogCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQgKmNvbnN0IHByaXYgPSBj
b3VudGVyLT5wcml2OwotCWNvbnN0IGNoYXIgKmRpcmVjdGlvbjsKIAl1MzIgY3IxOwogCiAJcmVn
bWFwX3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fQ1IxLCAmY3IxKTsKLQlkaXJlY3Rpb24gPSAoY3Ix
ICYgVElNX0NSMV9ESVIpID8gImJhY2t3YXJkIiA6ICJmb3J3YXJkIjsKKwkqZGlyZWN0aW9uID0g
KGNyMSAmIFRJTV9DUjFfRElSKSA/IENPVU5URVJfQ09VTlRfRElSRUNUSU9OX0JBQ0tXQVJEIDoK
KwkJQ09VTlRFUl9DT1VOVF9ESVJFQ1RJT05fRk9SV0FSRDsKIAotCXJldHVybiBzY25wcmludGYo
YnVmLCBQQUdFX1NJWkUsICIlc1xuIiwgZGlyZWN0aW9uKTsKKwlyZXR1cm4gMDsKIH0KIAotc3Rh
dGljIHNzaXplX3Qgc3RtMzJfY291bnRfY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKLQkJCQkJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJCQl2b2lk
ICpwcml2YXRlLCBjaGFyICpidWYpCitzdGF0aWMgaW50IHN0bTMyX2NvdW50X2NlaWxpbmdfcmVh
ZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwgdTY0ICpjZWlsaW5nKQogewogCXN0cnVjdCBzdG0zMl90aW1lcl9jbnQg
KmNvbnN0IHByaXYgPSBjb3VudGVyLT5wcml2OwogCXUzMiBhcnI7CiAKIAlyZWdtYXBfcmVhZChw
cml2LT5yZWdtYXAsIFRJTV9BUlIsICZhcnIpOwogCi0JcmV0dXJuIHNucHJpbnRmKGJ1ZiwgUEFH
RV9TSVpFLCAiJXVcbiIsIGFycik7CisJKmNlaWxpbmcgPSBhcnI7CisKKwlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIHNzaXplX3Qgc3RtMzJfY291bnRfY2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJCSBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0J
CQkJCSB2b2lkICpwcml2YXRlLAotCQkJCQkgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQor
c3RhdGljIGludCBzdG0zMl9jb3VudF9jZWlsaW5nX3dyaXRlKHN0cnVjdCBjb3VudGVyX2Rldmlj
ZSAqY291bnRlciwKKwkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IGNl
aWxpbmcpCiB7CiAJc3RydWN0IHN0bTMyX3RpbWVyX2NudCAqY29uc3QgcHJpdiA9IGNvdW50ZXIt
PnByaXY7Ci0JdW5zaWduZWQgaW50IGNlaWxpbmc7Ci0JaW50IHJldDsKLQotCXJldCA9IGtzdHJ0
b3VpbnQoYnVmLCAwLCAmY2VpbGluZyk7Ci0JaWYgKHJldCkKLQkJcmV0dXJuIHJldDsKIAogCWlm
IChjZWlsaW5nID4gcHJpdi0+bWF4X2FycikKIAkJcmV0dXJuIC1FUkFOR0U7CkBAIC0xOTYsMzQg
KzE4OSwyNyBAQCBzdGF0aWMgc3NpemVfdCBzdG0zMl9jb3VudF9jZWlsaW5nX3dyaXRlKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVn
bWFwLCBUSU1fQ1IxLCBUSU1fQ1IxX0FSUEUsIDApOwogCXJlZ21hcF93cml0ZShwcml2LT5yZWdt
YXAsIFRJTV9BUlIsIGNlaWxpbmcpOwogCi0JcmV0dXJuIGxlbjsKKwlyZXR1cm4gMDsKIH0KIAot
c3RhdGljIHNzaXplX3Qgc3RtMzJfY291bnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAotCQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0J
CQkJICAgICAgIHZvaWQgKnByaXZhdGUsIGNoYXIgKmJ1ZikKK3N0YXRpYyBpbnQgc3RtMzJfY291
bnRfZW5hYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggKmVuYWJsZSkKIHsKIAlzdHJ1Y3Qgc3RtMzJf
dGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKIAl1MzIgY3IxOwogCiAJcmVn
bWFwX3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fQ1IxLCAmY3IxKTsKIAotCXJldHVybiBzY25wcmlu
dGYoYnVmLCBQQUdFX1NJWkUsICIlZFxuIiwgKGJvb2wpKGNyMSAmIFRJTV9DUjFfQ0VOKSk7CisJ
KmVuYWJsZSA9IGNyMSAmIFRJTV9DUjFfQ0VOOworCisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBz
c2l6ZV90IHN0bTMyX2NvdW50X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCi0JCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkJdm9pZCAqcHJp
dmF0ZSwKLQkJCQkJY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKQorc3RhdGljIGludCBzdG0z
Ml9jb3VudF9lbmFibGVfd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJ
CSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IGVuYWJsZSkKIHsKIAlzdHJ1Y3Qg
c3RtMzJfdGltZXJfY250ICpjb25zdCBwcml2ID0gY291bnRlci0+cHJpdjsKLQlpbnQgZXJyOwog
CXUzMiBjcjE7Ci0JYm9vbCBlbmFibGU7Ci0KLQllcnIgPSBrc3RydG9ib29sKGJ1ZiwgJmVuYWJs
ZSk7Ci0JaWYgKGVycikKLQkJcmV0dXJuIGVycjsKIAogCWlmIChlbmFibGUpIHsKIAkJcmVnbWFw
X3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fQ1IxLCAmY3IxKTsKQEAgLTI0Miw3MCArMjI4LDU1IEBA
IHN0YXRpYyBzc2l6ZV90IHN0bTMyX2NvdW50X2VuYWJsZV93cml0ZShzdHJ1Y3QgY291bnRlcl9k
ZXZpY2UgKmNvdW50ZXIsCiAJLyogS2VlcCBlbmFibGVkIHN0YXRlIHRvIHByb3Blcmx5IGhhbmRs
ZSBsb3cgcG93ZXIgc3RhdGVzICovCiAJcHJpdi0+ZW5hYmxlZCA9IGVuYWJsZTsKIAotCXJldHVy
biBsZW47CisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBjb25zdCBzdHJ1Y3QgY291bnRlcl9jb3Vu
dF9leHQgc3RtMzJfY291bnRfZXh0W10gPSB7Ci0JewotCQkubmFtZSA9ICJkaXJlY3Rpb24iLAot
CQkucmVhZCA9IHN0bTMyX2NvdW50X2RpcmVjdGlvbl9yZWFkLAotCX0sCi0JewotCQkubmFtZSA9
ICJlbmFibGUiLAotCQkucmVhZCA9IHN0bTMyX2NvdW50X2VuYWJsZV9yZWFkLAotCQkud3JpdGUg
PSBzdG0zMl9jb3VudF9lbmFibGVfd3JpdGUKLQl9LAotCXsKLQkJLm5hbWUgPSAiY2VpbGluZyIs
Ci0JCS5yZWFkID0gc3RtMzJfY291bnRfY2VpbGluZ19yZWFkLAotCQkud3JpdGUgPSBzdG0zMl9j
b3VudF9jZWlsaW5nX3dyaXRlCi0JfSwKLX07Ci0KLWVudW0gc3RtMzJfc3luYXBzZV9hY3Rpb24g
ewotCVNUTTMyX1NZTkFQU0VfQUNUSU9OX05PTkUsCi0JU1RNMzJfU1lOQVBTRV9BQ1RJT05fQk9U
SF9FREdFUworc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgc3RtMzJfY291bnRfZXh0W10gPSB7
CisJQ09VTlRFUl9DT01QX0RJUkVDVElPTihzdG0zMl9jb3VudF9kaXJlY3Rpb25fcmVhZCksCisJ
Q09VTlRFUl9DT01QX0VOQUJMRShzdG0zMl9jb3VudF9lbmFibGVfcmVhZCwgc3RtMzJfY291bnRf
ZW5hYmxlX3dyaXRlKSwKKwlDT1VOVEVSX0NPTVBfQ0VJTElORyhzdG0zMl9jb3VudF9jZWlsaW5n
X3JlYWQsCisJCQkgICAgIHN0bTMyX2NvdW50X2NlaWxpbmdfd3JpdGUpLAogfTsKIAogc3RhdGlj
IGNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBzdG0zMl9zeW5hcHNlX2FjdGlvbnNb
XSA9IHsKLQlbU1RNMzJfU1lOQVBTRV9BQ1RJT05fTk9ORV0gPSBDT1VOVEVSX1NZTkFQU0VfQUNU
SU9OX05PTkUsCi0JW1NUTTMyX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVNdID0gQ09VTlRFUl9T
WU5BUFNFX0FDVElPTl9CT1RIX0VER0VTCisJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9OT05FLAor
CUNPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUwogfTsKIAotc3RhdGljIGludCBzdG0z
Ml9hY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCSAgICBzdHJ1
Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkgICAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAq
c3luYXBzZSwKLQkJCSAgICBzaXplX3QgKmFjdGlvbikKK3N0YXRpYyBpbnQgc3RtMzJfYWN0aW9u
X3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJICAgICBzdHJ1Y3QgY291
bnRlcl9jb3VudCAqY291bnQsCisJCQkgICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFw
c2UsCisJCQkgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKQogewotCXNp
emVfdCBmdW5jdGlvbjsKKwllbnVtIGNvdW50ZXJfZnVuY3Rpb24gZnVuY3Rpb247CiAJaW50IGVy
cjsKIAotCWVyciA9IHN0bTMyX2NvdW50X2Z1bmN0aW9uX2dldChjb3VudGVyLCBjb3VudCwgJmZ1
bmN0aW9uKTsKKwllcnIgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNvdW50
LCAmZnVuY3Rpb24pOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKIAlzd2l0Y2ggKGZ1bmN0
aW9uKSB7CiAJY2FzZSBTVE0zMl9DT1VOVF9TTEFWRV9NT0RFX0RJU0FCTEVEOgogCQkvKiBjb3Vu
dHMgb24gaW50ZXJuYWwgY2xvY2sgd2hlbiBDRU49MSAqLwotCQkqYWN0aW9uID0gU1RNMzJfU1lO
QVBTRV9BQ1RJT05fTk9ORTsKKwkJKmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9O
RTsKIAkJcmV0dXJuIDA7CiAJY2FzZSBTVE0zMl9DT1VOVF9FTkNPREVSX01PREVfMToKIAkJLyog
Y291bnRzIHVwL2Rvd24gb24gVEkxRlAxIGVkZ2UgZGVwZW5kaW5nIG9uIFRJMkZQMiBsZXZlbCAq
LwogCQlpZiAoc3luYXBzZS0+c2lnbmFsLT5pZCA9PSBjb3VudC0+c3luYXBzZXNbMF0uc2lnbmFs
LT5pZCkKLQkJCSphY3Rpb24gPSBTVE0zMl9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VTOworCQkJ
KmFjdGlvbiA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUzsKIAkJZWxzZQotCQkJ
KmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNUSU9OX05PTkU7CisJCQkqYWN0aW9uID0gQ09VTlRF
Ul9TWU5BUFNFX0FDVElPTl9OT05FOwogCQlyZXR1cm4gMDsKIAljYXNlIFNUTTMyX0NPVU5UX0VO
Q09ERVJfTU9ERV8yOgogCQkvKiBjb3VudHMgdXAvZG93biBvbiBUSTJGUDIgZWRnZSBkZXBlbmRp
bmcgb24gVEkxRlAxIGxldmVsICovCiAJCWlmIChzeW5hcHNlLT5zaWduYWwtPmlkID09IGNvdW50
LT5zeW5hcHNlc1sxXS5zaWduYWwtPmlkKQotCQkJKmFjdGlvbiA9IFNUTTMyX1NZTkFQU0VfQUNU
SU9OX0JPVEhfRURHRVM7CisJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9CT1RI
X0VER0VTOwogCQllbHNlCi0JCQkqYWN0aW9uID0gU1RNMzJfU1lOQVBTRV9BQ1RJT05fTk9ORTsK
KwkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkU7CiAJCXJldHVybiAwOwog
CWNhc2UgU1RNMzJfQ09VTlRfRU5DT0RFUl9NT0RFXzM6CiAJCS8qIGNvdW50cyB1cC9kb3duIG9u
IGJvdGggVEkxRlAxIGFuZCBUSTJGUDIgZWRnZXMgKi8KLQkJKmFjdGlvbiA9IFNUTTMyX1NZTkFQ
U0VfQUNUSU9OX0JPVEhfRURHRVM7CisJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X0JPVEhfRURHRVM7CiAJCXJldHVybiAwOwogCWRlZmF1bHQ6CiAJCXJldHVybiAtRUlOVkFMOwpA
QCAtMzE1LDkgKzI4Niw5IEBAIHN0YXRpYyBpbnQgc3RtMzJfYWN0aW9uX2dldChzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIHN0
bTMyX3RpbWVyX2NudF9vcHMgPSB7CiAJLmNvdW50X3JlYWQgPSBzdG0zMl9jb3VudF9yZWFkLAog
CS5jb3VudF93cml0ZSA9IHN0bTMyX2NvdW50X3dyaXRlLAotCS5mdW5jdGlvbl9nZXQgPSBzdG0z
Ml9jb3VudF9mdW5jdGlvbl9nZXQsCi0JLmZ1bmN0aW9uX3NldCA9IHN0bTMyX2NvdW50X2Z1bmN0
aW9uX3NldCwKLQkuYWN0aW9uX2dldCA9IHN0bTMyX2FjdGlvbl9nZXQsCisJLmZ1bmN0aW9uX3Jl
YWQgPSBzdG0zMl9jb3VudF9mdW5jdGlvbl9yZWFkLAorCS5mdW5jdGlvbl93cml0ZSA9IHN0bTMy
X2NvdW50X2Z1bmN0aW9uX3dyaXRlLAorCS5hY3Rpb25fcmVhZCA9IHN0bTMyX2FjdGlvbl9yZWFk
LAogfTsKIAogc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25hbCBzdG0zMl9zaWduYWxzW10gPSB7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5jIGIvZHJpdmVycy9jb3VudGVy
L3RpLWVxZXAuYwppbmRleCA5NGZlNThiYjNlYWIuLjA5ODE3Yzk1M2Y5YSAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9jb3VudGVyL3RpLWVxZXAuYworKysgYi9kcml2ZXJzL2NvdW50ZXIvdGktZXFlcC5j
CkBAIC0xMyw2ICsxMyw3IEBACiAjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+CiAj
aW5jbHVkZSA8bGludXgvcG1fcnVudGltZS5oPgogI2luY2x1ZGUgPGxpbnV4L3JlZ21hcC5oPgor
I2luY2x1ZGUgPGxpbnV4L3R5cGVzLmg+CiAKIC8qIDMyLWJpdCByZWdpc3RlcnMgKi8KICNkZWZp
bmUgUVBPU0NOVAkJMHgwCkBAIC03MywxOSArNzQsMTMgQEAgZW51bSB7CiB9OwogCiAvKiBQb3Np
dGlvbiBDb3VudGVyIElucHV0IE1vZGVzICovCi1lbnVtIHsKK2VudW0gdGlfZXFlcF9jb3VudF9m
dW5jIHsKIAlUSV9FUUVQX0NPVU5UX0ZVTkNfUVVBRF9DT1VOVCwKIAlUSV9FUUVQX0NPVU5UX0ZV
TkNfRElSX0NPVU5ULAogCVRJX0VRRVBfQ09VTlRfRlVOQ19VUF9DT1VOVCwKIAlUSV9FUUVQX0NP
VU5UX0ZVTkNfRE9XTl9DT1VOVCwKIH07CiAKLWVudW0gewotCVRJX0VRRVBfU1lOQVBTRV9BQ1RJ
T05fQk9USF9FREdFUywKLQlUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdFLAotCVRJ
X0VRRVBfU1lOQVBTRV9BQ1RJT05fTk9ORSwKLX07Ci0KIHN0cnVjdCB0aV9lcWVwX2NudCB7CiAJ
c3RydWN0IGNvdW50ZXJfZGV2aWNlIGNvdW50ZXI7CiAJc3RydWN0IHJlZ21hcCAqcmVnbWFwMzI7
CkBAIC05Myw3ICs4OCw3IEBAIHN0cnVjdCB0aV9lcWVwX2NudCB7CiB9OwogCiBzdGF0aWMgaW50
IHRpX2VxZXBfY291bnRfcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHVuc2lnbmVkIGxvbmcgKnZhbCkKKwkJ
CSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0ICp2YWwpCiB7CiAJc3RydWN0
IHRpX2VxZXBfY250ICpwcml2ID0gY291bnRlci0+cHJpdjsKIAl1MzIgY250OwpAQCAtMTA1LDcg
KzEwMCw3IEBAIHN0YXRpYyBpbnQgdGlfZXFlcF9jb3VudF9yZWFkKHN0cnVjdCBjb3VudGVyX2Rl
dmljZSAqY291bnRlciwKIH0KIAogc3RhdGljIGludCB0aV9lcWVwX2NvdW50X3dyaXRlKHN0cnVj
dCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsIHVuc2lnbmVkIGxvbmcgdmFsKQorCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwgdTY0IHZhbCkKIHsKIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3Vu
dGVyLT5wcml2OwogCXUzMiBtYXg7CkBAIC0xMTcsNjQgKzExMiwxMDAgQEAgc3RhdGljIGludCB0
aV9lcWVwX2NvdW50X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKIAlyZXR1
cm4gcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcDMyLCBRUE9TQ05ULCB2YWwpOwogfQogCi1zdGF0
aWMgaW50IHRpX2VxZXBfZnVuY3Rpb25fZ2V0KHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKLQkJCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNpemVfdCAqZnVuY3Rpb24pCitz
dGF0aWMgaW50IHRpX2VxZXBfZnVuY3Rpb25fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNv
dW50ZXIsCisJCQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCQkgZW51bSBjb3Vu
dGVyX2Z1bmN0aW9uICpmdW5jdGlvbikKIHsKIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBj
b3VudGVyLT5wcml2OwogCXUzMiBxZGVjY3RsOwogCiAJcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFw
MTYsIFFERUNDVEwsICZxZGVjY3RsKTsKLQkqZnVuY3Rpb24gPSAocWRlY2N0bCAmIFFERUNDVExf
UVNSQykgPj4gUURFQ0NUTF9RU1JDX1NISUZUOworCisJc3dpdGNoICgocWRlY2N0bCAmIFFERUND
VExfUVNSQykgPj4gUURFQ0NUTF9RU1JDX1NISUZUKSB7CisJY2FzZSBUSV9FUUVQX0NPVU5UX0ZV
TkNfUVVBRF9DT1VOVDoKKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9RVUFEUkFUVVJF
X1g0OworCQlicmVhazsKKwljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19ESVJfQ09VTlQ6CisJCSpm
dW5jdGlvbiA9IENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOworCQlicmVhazsKKwlj
YXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19VUF9DT1VOVDoKKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9G
VU5DVElPTl9JTkNSRUFTRTsKKwkJYnJlYWs7CisJY2FzZSBUSV9FUUVQX0NPVU5UX0ZVTkNfRE9X
Tl9DT1VOVDoKKwkJKmZ1bmN0aW9uID0gQ09VTlRFUl9GVU5DVElPTl9ERUNSRUFTRTsKKwkJYnJl
YWs7CisJfQogCiAJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBpbnQgdGlfZXFlcF9mdW5jdGlvbl9z
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCXN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwgc2l6ZV90IGZ1bmN0aW9uKQorc3RhdGljIGludCB0aV9lcWVwX2Z1bmN0aW9u
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKKwkJCQkgIGVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbikK
IHsKIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2OworCWVudW0gdGlf
ZXFlcF9jb3VudF9mdW5jIHFzcmM7CisKKwlzd2l0Y2ggKGZ1bmN0aW9uKSB7CisJY2FzZSBDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDQ6CisJCXFzcmMgPSBUSV9FUUVQX0NPVU5UX0ZVTkNf
UVVBRF9DT1VOVDsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX1BVTFNFX0RJUkVD
VElPTjoKKwkJcXNyYyA9IFRJX0VRRVBfQ09VTlRfRlVOQ19ESVJfQ09VTlQ7CisJCWJyZWFrOwor
CWNhc2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFTRToKKwkJcXNyYyA9IFRJX0VRRVBfQ09VTlRf
RlVOQ19VUF9DT1VOVDsKKwkJYnJlYWs7CisJY2FzZSBDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNF
OgorCQlxc3JjID0gVElfRVFFUF9DT1VOVF9GVU5DX0RPV05fQ09VTlQ7CisJCWJyZWFrOworCWRl
ZmF1bHQ6CisJCS8qIHNob3VsZCBuZXZlciByZWFjaCB0aGlzIHBhdGggKi8KKwkJcmV0dXJuIC1F
SU5WQUw7CisJfQogCiAJcmV0dXJuIHJlZ21hcF93cml0ZV9iaXRzKHByaXYtPnJlZ21hcDE2LCBR
REVDQ1RMLCBRREVDQ1RMX1FTUkMsCi0JCQkJIGZ1bmN0aW9uIDw8IFFERUNDVExfUVNSQ19TSElG
VCk7CisJCQkJIHFzcmMgPDwgUURFQ0NUTF9RU1JDX1NISUZUKTsKIH0KIAotc3RhdGljIGludCB0
aV9lcWVwX2FjdGlvbl9nZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJICAg
ICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJICAgICAgc3RydWN0IGNvdW50ZXJf
c3luYXBzZSAqc3luYXBzZSwgc2l6ZV90ICphY3Rpb24pCitzdGF0aWMgaW50IHRpX2VxZXBfYWN0
aW9uX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJICAgICAgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCSAgICAgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNl
ICpzeW5hcHNlLAorCQkJICAgICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9u
KQogewogCXN0cnVjdCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Ci0Jc2l6ZV90
IGZ1bmN0aW9uOworCWVudW0gY291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbjsKIAl1MzIgcWRlY2N0
bDsKIAlpbnQgZXJyOwogCi0JZXJyID0gdGlfZXFlcF9mdW5jdGlvbl9nZXQoY291bnRlciwgY291
bnQsICZmdW5jdGlvbik7CisJZXJyID0gdGlfZXFlcF9mdW5jdGlvbl9yZWFkKGNvdW50ZXIsIGNv
dW50LCAmZnVuY3Rpb24pOwogCWlmIChlcnIpCiAJCXJldHVybiBlcnI7CiAKIAlzd2l0Y2ggKGZ1
bmN0aW9uKSB7Ci0JY2FzZSBUSV9FUUVQX0NPVU5UX0ZVTkNfUVVBRF9DT1VOVDoKKwljYXNlIENP
VU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YNDoKIAkJLyogSW4gcXVhZHJhdHVyZSBtb2RlLCB0
aGUgcmlzaW5nIGFuZCBmYWxsaW5nIGVkZ2Ugb2YgYm90aAogCQkgKiBRRVBBIGFuZCBRRVBCIHRy
aWdnZXIgUUNMSy4KIAkJICovCi0JCSphY3Rpb24gPSBUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX0JP
VEhfRURHRVM7CisJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVM7
CiAJCXJldHVybiAwOwotCWNhc2UgVElfRVFFUF9DT1VOVF9GVU5DX0RJUl9DT1VOVDoKKwljYXNl
IENPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OOgogCQkvKiBJbiBkaXJlY3Rpb24tY291
bnQgbW9kZSBvbmx5IHJpc2luZyBlZGdlIG9mIFFFUEEgaXMgY291bnRlZAogCQkgKiBhbmQgUUVQ
QiBnaXZlcyBkaXJlY3Rpb24uCiAJCSAqLwogCQlzd2l0Y2ggKHN5bmFwc2UtPnNpZ25hbC0+aWQp
IHsKIAkJY2FzZSBUSV9FUUVQX1NJR05BTF9RRVBBOgotCQkJKmFjdGlvbiA9IFRJX0VRRVBfU1lO
QVBTRV9BQ1RJT05fUklTSU5HX0VER0U7CisJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FD
VElPTl9SSVNJTkdfRURHRTsKIAkJCXJldHVybiAwOwogCQljYXNlIFRJX0VRRVBfU0lHTkFMX1FF
UEI6Ci0JCQkqYWN0aW9uID0gVElfRVFFUF9TWU5BUFNFX0FDVElPTl9OT05FOworCQkJKmFjdGlv
biA9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fTk9ORTsKIAkJCXJldHVybiAwOwogCQlkZWZhdWx0
OgogCQkJLyogc2hvdWxkIG5ldmVyIHJlYWNoIHRoaXMgcGF0aCAqLwogCQkJcmV0dXJuIC1FSU5W
QUw7CiAJCX0KLQljYXNlIFRJX0VRRVBfQ09VTlRfRlVOQ19VUF9DT1VOVDoKLQljYXNlIFRJX0VR
RVBfQ09VTlRfRlVOQ19ET1dOX0NPVU5UOgorCWNhc2UgQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFT
RToKKwljYXNlIENPVU5URVJfRlVOQ1RJT05fREVDUkVBU0U6CiAJCS8qIEluIHVwL2Rvd24tY291
bnQgbW9kZXMgb25seSBRRVBBIGlzIGNvdW50ZWQgYW5kIFFFUEIgaXMgbm90CiAJCSAqIHVzZWQu
CiAJCSAqLwpAQCAtMTg1LDEyICsyMTYsMTIgQEAgc3RhdGljIGludCB0aV9lcWVwX2FjdGlvbl9n
ZXQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAogCQkJCXJldHVybiBlcnI7CiAKIAkJ
CWlmIChxZGVjY3RsICYgUURFQ0NUTF9YQ1IpCi0JCQkJKmFjdGlvbiA9IFRJX0VRRVBfU1lOQVBT
RV9BQ1RJT05fQk9USF9FREdFUzsKKwkJCQkqYWN0aW9uID0gQ09VTlRFUl9TWU5BUFNFX0FDVElP
Tl9CT1RIX0VER0VTOwogCQkJZWxzZQotCQkJCSphY3Rpb24gPSBUSV9FUUVQX1NZTkFQU0VfQUNU
SU9OX1JJU0lOR19FREdFOworCQkJCSphY3Rpb24gPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJ
U0lOR19FREdFOwogCQkJcmV0dXJuIDA7CiAJCWNhc2UgVElfRVFFUF9TSUdOQUxfUUVQQjoKLQkJ
CSphY3Rpb24gPSBUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX05PTkU7CisJCQkqYWN0aW9uID0gQ09V
TlRFUl9TWU5BUFNFX0FDVElPTl9OT05FOwogCQkJcmV0dXJuIDA7CiAJCWRlZmF1bHQ6CiAJCQkv
KiBzaG91bGQgbmV2ZXIgcmVhY2ggdGhpcyBwYXRoICovCkBAIC0yMDUsODIgKzIzNiw2NyBAQCBz
dGF0aWMgaW50IHRpX2VxZXBfYWN0aW9uX2dldChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50
ZXIsCiBzdGF0aWMgY29uc3Qgc3RydWN0IGNvdW50ZXJfb3BzIHRpX2VxZXBfY291bnRlcl9vcHMg
PSB7CiAJLmNvdW50X3JlYWQJPSB0aV9lcWVwX2NvdW50X3JlYWQsCiAJLmNvdW50X3dyaXRlCT0g
dGlfZXFlcF9jb3VudF93cml0ZSwKLQkuZnVuY3Rpb25fZ2V0CT0gdGlfZXFlcF9mdW5jdGlvbl9n
ZXQsCi0JLmZ1bmN0aW9uX3NldAk9IHRpX2VxZXBfZnVuY3Rpb25fc2V0LAotCS5hY3Rpb25fZ2V0
CT0gdGlfZXFlcF9hY3Rpb25fZ2V0LAorCS5mdW5jdGlvbl9yZWFkCT0gdGlfZXFlcF9mdW5jdGlv
bl9yZWFkLAorCS5mdW5jdGlvbl93cml0ZQk9IHRpX2VxZXBfZnVuY3Rpb25fd3JpdGUsCisJLmFj
dGlvbl9yZWFkCT0gdGlfZXFlcF9hY3Rpb25fcmVhZCwKIH07CiAKLXN0YXRpYyBzc2l6ZV90IHRp
X2VxZXBfcG9zaXRpb25fY2VpbGluZ19yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKLQkJCQkJICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkJCSAgICAgdm9p
ZCAqZXh0X3ByaXYsIGNoYXIgKmJ1ZikKK3N0YXRpYyBpbnQgdGlfZXFlcF9wb3NpdGlvbl9jZWls
aW5nX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCQkgc3RydWN0IGNv
dW50ZXJfY291bnQgKmNvdW50LAorCQkJCQkgdTY0ICpjZWlsaW5nKQogewogCXN0cnVjdCB0aV9l
cWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7CiAJdTMyIHFwb3NtYXg7CiAKIAlyZWdtYXBf
cmVhZChwcml2LT5yZWdtYXAzMiwgUVBPU01BWCwgJnFwb3NtYXgpOwogCi0JcmV0dXJuIHNwcmlu
dGYoYnVmLCAiJXVcbiIsIHFwb3NtYXgpOworCSpjZWlsaW5nID0gcXBvc21heDsKKworCXJldHVy
biAwOwogfQogCi1zdGF0aWMgc3NpemVfdCB0aV9lcWVwX3Bvc2l0aW9uX2NlaWxpbmdfd3JpdGUo
c3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCQkgICAgICBzdHJ1Y3QgY291bnRl
cl9jb3VudCAqY291bnQsCi0JCQkJCSAgICAgIHZvaWQgKmV4dF9wcml2LCBjb25zdCBjaGFyICpi
dWYsCi0JCQkJCSAgICAgIHNpemVfdCBsZW4pCitzdGF0aWMgaW50IHRpX2VxZXBfcG9zaXRpb25f
Y2VpbGluZ193cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJCSAgc3Ry
dWN0IGNvdW50ZXJfY291bnQgKmNvdW50LAorCQkJCQkgIHU2NCBjZWlsaW5nKQogewogCXN0cnVj
dCB0aV9lcWVwX2NudCAqcHJpdiA9IGNvdW50ZXItPnByaXY7Ci0JaW50IGVycjsKLQl1MzIgcmVz
OwogCi0JZXJyID0ga3N0cnRvdWludChidWYsIDAsICZyZXMpOwotCWlmIChlcnIgPCAwKQotCQly
ZXR1cm4gZXJyOworCWlmIChjZWlsaW5nICE9ICh1MzIpY2VpbGluZykKKwkJcmV0dXJuIC1FUkFO
R0U7CiAKLQlyZWdtYXBfd3JpdGUocHJpdi0+cmVnbWFwMzIsIFFQT1NNQVgsIHJlcyk7CisJcmVn
bWFwX3dyaXRlKHByaXYtPnJlZ21hcDMyLCBRUE9TTUFYLCBjZWlsaW5nKTsKIAotCXJldHVybiBs
ZW47CisJcmV0dXJuIDA7CiB9CiAKLXN0YXRpYyBzc2l6ZV90IHRpX2VxZXBfcG9zaXRpb25fZW5h
YmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCQkgICAgc3RydWN0
IGNvdW50ZXJfY291bnQgKmNvdW50LAotCQkJCQkgICAgdm9pZCAqZXh0X3ByaXYsIGNoYXIgKmJ1
ZikKK3N0YXRpYyBpbnQgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfcmVhZChzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJCXN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTgg
KmVuYWJsZSkKIHsKIAlzdHJ1Y3QgdGlfZXFlcF9jbnQgKnByaXYgPSBjb3VudGVyLT5wcml2Owog
CXUzMiBxZXBjdGw7CiAKIAlyZWdtYXBfcmVhZChwcml2LT5yZWdtYXAxNiwgUUVQQ1RMLCAmcWVw
Y3RsKTsKIAotCXJldHVybiBzcHJpbnRmKGJ1ZiwgIiV1XG4iLCAhIShxZXBjdGwgJiBRRVBDVExf
UEhFTikpOworCSplbmFibGUgPSAhIShxZXBjdGwgJiBRRVBDVExfUEhFTik7CisKKwlyZXR1cm4g
MDsKIH0KIAotc3RhdGljIHNzaXplX3QgdGlfZXFlcF9wb3NpdGlvbl9lbmFibGVfd3JpdGUoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCQkgICAgIHN0cnVjdCBjb3VudGVyX2Nv
dW50ICpjb3VudCwKLQkJCQkJICAgICB2b2lkICpleHRfcHJpdiwgY29uc3QgY2hhciAqYnVmLAot
CQkJCQkgICAgIHNpemVfdCBsZW4pCitzdGF0aWMgaW50IHRpX2VxZXBfcG9zaXRpb25fZW5hYmxl
X3dyaXRlKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkJIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdTggZW5hYmxlKQogewogCXN0cnVjdCB0aV9lcWVwX2NudCAqcHJp
diA9IGNvdW50ZXItPnByaXY7Ci0JaW50IGVycjsKLQlib29sIHJlczsKLQotCWVyciA9IGtzdHJ0
b2Jvb2woYnVmLCAmcmVzKTsKLQlpZiAoZXJyIDwgMCkKLQkJcmV0dXJuIGVycjsKIAotCXJlZ21h
cF93cml0ZV9iaXRzKHByaXYtPnJlZ21hcDE2LCBRRVBDVEwsIFFFUENUTF9QSEVOLCByZXMgPyAt
MSA6IDApOworCXJlZ21hcF93cml0ZV9iaXRzKHByaXYtPnJlZ21hcDE2LCBRRVBDVEwsIFFFUENU
TF9QSEVOLCBlbmFibGUgPyAtMSA6IDApOwogCi0JcmV0dXJuIGxlbjsKKwlyZXR1cm4gMDsKIH0K
IAotc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvdW50X2V4dCB0aV9lcWVwX3Bvc2l0aW9uX2V4dFtd
ID0gewotCXsKLQkJLm5hbWUJPSAiY2VpbGluZyIsCi0JCS5yZWFkCT0gdGlfZXFlcF9wb3NpdGlv
bl9jZWlsaW5nX3JlYWQsCi0JCS53cml0ZQk9IHRpX2VxZXBfcG9zaXRpb25fY2VpbGluZ193cml0
ZSwKLQl9LAotCXsKLQkJLm5hbWUJPSAiZW5hYmxlIiwKLQkJLnJlYWQJPSB0aV9lcWVwX3Bvc2l0
aW9uX2VuYWJsZV9yZWFkLAotCQkud3JpdGUJPSB0aV9lcWVwX3Bvc2l0aW9uX2VuYWJsZV93cml0
ZSwKLQl9LAorc3RhdGljIHN0cnVjdCBjb3VudGVyX2NvbXAgdGlfZXFlcF9wb3NpdGlvbl9leHRb
XSA9IHsKKwlDT1VOVEVSX0NPTVBfQ0VJTElORyh0aV9lcWVwX3Bvc2l0aW9uX2NlaWxpbmdfcmVh
ZCwKKwkJCSAgICAgdGlfZXFlcF9wb3NpdGlvbl9jZWlsaW5nX3dyaXRlKSwKKwlDT1VOVEVSX0NP
TVBfRU5BQkxFKHRpX2VxZXBfcG9zaXRpb25fZW5hYmxlX3JlYWQsCisJCQkgICAgdGlfZXFlcF9w
b3NpdGlvbl9lbmFibGVfd3JpdGUpLAogfTsKIAogc3RhdGljIHN0cnVjdCBjb3VudGVyX3NpZ25h
bCB0aV9lcWVwX3NpZ25hbHNbXSA9IHsKQEAgLTI5NSwxNiArMzExLDE2IEBAIHN0YXRpYyBzdHJ1
Y3QgY291bnRlcl9zaWduYWwgdGlfZXFlcF9zaWduYWxzW10gPSB7CiB9OwogCiBzdGF0aWMgY29u
c3QgZW51bSBjb3VudGVyX2Z1bmN0aW9uIHRpX2VxZXBfcG9zaXRpb25fZnVuY3Rpb25zW10gPSB7
Ci0JW1RJX0VRRVBfQ09VTlRfRlVOQ19RVUFEX0NPVU5UXQk9IENPVU5URVJfRlVOQ1RJT05fUVVB
RFJBVFVSRV9YNCwKLQlbVElfRVFFUF9DT1VOVF9GVU5DX0RJUl9DT1VOVF0JPSBDT1VOVEVSX0ZV
TkNUSU9OX1BVTFNFX0RJUkVDVElPTiwKLQlbVElfRVFFUF9DT1VOVF9GVU5DX1VQX0NPVU5UXQk9
IENPVU5URVJfRlVOQ1RJT05fSU5DUkVBU0UsCi0JW1RJX0VRRVBfQ09VTlRfRlVOQ19ET1dOX0NP
VU5UXQk9IENPVU5URVJfRlVOQ1RJT05fREVDUkVBU0UsCisJQ09VTlRFUl9GVU5DVElPTl9RVUFE
UkFUVVJFX1g0LAorCUNPVU5URVJfRlVOQ1RJT05fUFVMU0VfRElSRUNUSU9OLAorCUNPVU5URVJf
RlVOQ1RJT05fSU5DUkVBU0UsCisJQ09VTlRFUl9GVU5DVElPTl9ERUNSRUFTRSwKIH07CiAKIHN0
YXRpYyBjb25zdCBlbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gdGlfZXFlcF9wb3NpdGlvbl9z
eW5hcHNlX2FjdGlvbnNbXSA9IHsKLQlbVElfRVFFUF9TWU5BUFNFX0FDVElPTl9CT1RIX0VER0VT
XQk9IENPVU5URVJfU1lOQVBTRV9BQ1RJT05fQk9USF9FREdFUywKLQlbVElfRVFFUF9TWU5BUFNF
X0FDVElPTl9SSVNJTkdfRURHRV0JPSBDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX1JJU0lOR19FREdF
LAotCVtUSV9FUUVQX1NZTkFQU0VfQUNUSU9OX05PTkVdCQk9IENPVU5URVJfU1lOQVBTRV9BQ1RJ
T05fTk9ORSwKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMsCisJQ09VTlRFUl9T
WU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX05PTkUs
CiB9OwogCiBzdGF0aWMgc3RydWN0IGNvdW50ZXJfc3luYXBzZSB0aV9lcWVwX3Bvc2l0aW9uX3N5
bmFwc2VzW10gPSB7CmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2NvdW50ZXIuaCBiL2luY2x1
ZGUvbGludXgvY291bnRlci5oCmluZGV4IGQxNmNlMjgxOWI0OC4uYjY5Mjc3ZjVjNGM1IDEwMDY0
NAotLS0gYS9pbmNsdWRlL2xpbnV4L2NvdW50ZXIuaAorKysgYi9pbmNsdWRlL2xpbnV4L2NvdW50
ZXIuaApAQCAtNiw0MiArNiwxODQgQEAKICNpZm5kZWYgX0NPVU5URVJfSF8KICNkZWZpbmUgX0NP
VU5URVJfSF8KIAotI2luY2x1ZGUgPGxpbnV4L2NvdW50ZXJfZW51bS5oPgogI2luY2x1ZGUgPGxp
bnV4L2RldmljZS5oPgorI2luY2x1ZGUgPGxpbnV4L2tlcm5lbC5oPgogI2luY2x1ZGUgPGxpbnV4
L3R5cGVzLmg+CiAKK3N0cnVjdCBjb3VudGVyX2RldmljZTsKK3N0cnVjdCBjb3VudGVyX2NvdW50
Oworc3RydWN0IGNvdW50ZXJfc3luYXBzZTsKK3N0cnVjdCBjb3VudGVyX3NpZ25hbDsKKworZW51
bSBjb3VudGVyX2NvbXBfdHlwZSB7CisJQ09VTlRFUl9DT01QX1U4LAorCUNPVU5URVJfQ09NUF9V
NjQsCisJQ09VTlRFUl9DT01QX0JPT0wsCisJQ09VTlRFUl9DT01QX1NJR05BTF9MRVZFTCwKKwlD
T1VOVEVSX0NPTVBfRlVOQ1RJT04sCisJQ09VTlRFUl9DT01QX1NZTkFQU0VfQUNUSU9OLAorCUNP
VU5URVJfQ09NUF9FTlVNLAorCUNPVU5URVJfQ09NUF9DT1VOVF9ESVJFQ1RJT04sCisJQ09VTlRF
Ul9DT01QX0NPVU5UX01PREUsCit9OworCitlbnVtIGNvdW50ZXJfc2NvcGUgeworCUNPVU5URVJf
U0NPUEVfREVWSUNFLAorCUNPVU5URVJfU0NPUEVfU0lHTkFMLAorCUNPVU5URVJfU0NPUEVfQ09V
TlQsCit9OworCiBlbnVtIGNvdW50ZXJfY291bnRfZGlyZWN0aW9uIHsKLQlDT1VOVEVSX0NPVU5U
X0RJUkVDVElPTl9GT1JXQVJEID0gMCwKLQlDT1VOVEVSX0NPVU5UX0RJUkVDVElPTl9CQUNLV0FS
RAorCUNPVU5URVJfQ09VTlRfRElSRUNUSU9OX0ZPUldBUkQsCisJQ09VTlRFUl9DT1VOVF9ESVJF
Q1RJT05fQkFDS1dBUkQsCiB9OwotZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfY291
bnRfZGlyZWN0aW9uX3N0clsyXTsKIAogZW51bSBjb3VudGVyX2NvdW50X21vZGUgewotCUNPVU5U
RVJfQ09VTlRfTU9ERV9OT1JNQUwgPSAwLAorCUNPVU5URVJfQ09VTlRfTU9ERV9OT1JNQUwsCiAJ
Q09VTlRFUl9DT1VOVF9NT0RFX1JBTkdFX0xJTUlULAogCUNPVU5URVJfQ09VTlRfTU9ERV9OT05f
UkVDWUNMRSwKLQlDT1VOVEVSX0NPVU5UX01PREVfTU9EVUxPX04KKwlDT1VOVEVSX0NPVU5UX01P
REVfTU9EVUxPX04sCiB9OwotZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbnN0IGNvdW50ZXJfY291bnRf
bW9kZV9zdHJbNF07CiAKLXN0cnVjdCBjb3VudGVyX2RldmljZTsKLXN0cnVjdCBjb3VudGVyX3Np
Z25hbDsKK2VudW0gY291bnRlcl9mdW5jdGlvbiB7CisJQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFT
RSwKKwlDT1VOVEVSX0ZVTkNUSU9OX0RFQ1JFQVNFLAorCUNPVU5URVJfRlVOQ1RJT05fUFVMU0Vf
RElSRUNUSU9OLAorCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9BLAorCUNPVU5URVJf
RlVOQ1RJT05fUVVBRFJBVFVSRV9YMV9CLAorCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9Y
Ml9BLAorCUNPVU5URVJfRlVOQ1RJT05fUVVBRFJBVFVSRV9YMl9CLAorCUNPVU5URVJfRlVOQ1RJ
T05fUVVBRFJBVFVSRV9YNCwKK307CisKK2VudW0gY291bnRlcl9zaWduYWxfbGV2ZWwgeworCUNP
VU5URVJfU0lHTkFMX0xFVkVMX0xPVywKKwlDT1VOVEVSX1NJR05BTF9MRVZFTF9ISUdILAorfTsK
KworZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIHsKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9O
X05PTkUsCisJQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJTkdfRURHRSwKKwlDT1VOVEVSX1NZ
TkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKKwlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0JPVEhf
RURHRVMsCit9OwogCiAvKioKLSAqIHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgLSBDb3VudGVy
IFNpZ25hbCBleHRlbnNpb25zCi0gKiBAbmFtZToJYXR0cmlidXRlIG5hbWUKLSAqIEByZWFkOgly
ZWFkIGNhbGxiYWNrIGZvciB0aGlzIGF0dHJpYnV0ZTsgbWF5IGJlIE5VTEwKLSAqIEB3cml0ZToJ
d3JpdGUgY2FsbGJhY2sgZm9yIHRoaXMgYXR0cmlidXRlOyBtYXkgYmUgTlVMTAotICogQHByaXY6
CWRhdGEgcHJpdmF0ZSB0byB0aGUgZHJpdmVyCisgKiBzdHJ1Y3QgY291bnRlcl9jb21wIC0gQ291
bnRlciBjb21wb25lbnQgbm9kZQorICogQHR5cGU6CQlDb3VudGVyIGNvbXBvbmVudCBkYXRhIHR5
cGUKKyAqIEBuYW1lOgkJZGV2aWNlLXNwZWNpZmljIGNvbXBvbmVudCBuYW1lCisgKiBAcHJpdjoJ
CWNvbXBvbmVudC1yZWxldmFudCBkYXRhCisgKiBAYWN0aW9uX3JlYWQJCVN5bmFwc2UgYWN0aW9u
IG1vZGUgcmVhZCBjYWxsYmFjay4gVGhlIHJlYWQgdmFsdWUgb2YgdGhlCisgKgkJCXJlc3BlY3Rp
dmUgU3luYXBzZSBhY3Rpb24gbW9kZSBzaG91bGQgYmUgcGFzc2VkIGJhY2sgdmlhCisgKgkJCXRo
ZSBhY3Rpb24gcGFyYW1ldGVyLgorICogQGRldmljZV91OF9yZWFkCURldmljZSB1OCBjb21wb25l
bnQgcmVhZCBjYWxsYmFjay4gVGhlIHJlYWQgdmFsdWUgb2YgdGhlCisgKgkJCXJlc3BlY3RpdmUg
RGV2aWNlIHU4IGNvbXBvbmVudCBzaG91bGQgYmUgcGFzc2VkIGJhY2sgdmlhCisgKgkJCXRoZSB2
YWwgcGFyYW1ldGVyLgorICogQGNvdW50X3U4X3JlYWQJQ291bnQgdTggY29tcG9uZW50IHJlYWQg
Y2FsbGJhY2suIFRoZSByZWFkIHZhbHVlIG9mIHRoZQorICoJCQlyZXNwZWN0aXZlIENvdW50IHU4
IGNvbXBvbmVudCBzaG91bGQgYmUgcGFzc2VkIGJhY2sgdmlhCisgKgkJCXRoZSB2YWwgcGFyYW1l
dGVyLgorICogQHNpZ25hbF91OF9yZWFkCVNpZ25hbCB1OCBjb21wb25lbnQgcmVhZCBjYWxsYmFj
ay4gVGhlIHJlYWQgdmFsdWUgb2YgdGhlCisgKgkJCXJlc3BlY3RpdmUgU2lnbmFsIHU4IGNvbXBv
bmVudCBzaG91bGQgYmUgcGFzc2VkIGJhY2sgdmlhCisgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgor
ICogQGRldmljZV91MzJfcmVhZAlEZXZpY2UgdTMyIGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBU
aGUgcmVhZCB2YWx1ZSBvZgorICoJCQl0aGUgcmVzcGVjdGl2ZSBEZXZpY2UgdTMyIGNvbXBvbmVu
dCBzaG91bGQgYmUgcGFzc2VkCisgKgkJCWJhY2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgorICog
QGNvdW50X3UzMl9yZWFkCUNvdW50IHUzMiBjb21wb25lbnQgcmVhZCBjYWxsYmFjay4gVGhlIHJl
YWQgdmFsdWUgb2YgdGhlCisgKgkJCXJlc3BlY3RpdmUgQ291bnQgdTMyIGNvbXBvbmVudCBzaG91
bGQgYmUgcGFzc2VkIGJhY2sgdmlhCisgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgorICogQHNpZ25h
bF91MzJfcmVhZAlTaWduYWwgdTMyIGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2
YWx1ZSBvZgorICoJCQl0aGUgcmVzcGVjdGl2ZSBTaWduYWwgdTMyIGNvbXBvbmVudCBzaG91bGQg
YmUgcGFzc2VkCisgKgkJCWJhY2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgorICogQGRldmljZV91
NjRfcmVhZAlEZXZpY2UgdTY0IGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1
ZSBvZgorICoJCQl0aGUgcmVzcGVjdGl2ZSBEZXZpY2UgdTY0IGNvbXBvbmVudCBzaG91bGQgYmUg
cGFzc2VkCisgKgkJCWJhY2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgorICogQGNvdW50X3U2NF9y
ZWFkCUNvdW50IHU2NCBjb21wb25lbnQgcmVhZCBjYWxsYmFjay4gVGhlIHJlYWQgdmFsdWUgb2Yg
dGhlCisgKgkJCXJlc3BlY3RpdmUgQ291bnQgdTY0IGNvbXBvbmVudCBzaG91bGQgYmUgcGFzc2Vk
IGJhY2sgdmlhCisgKgkJCXRoZSB2YWwgcGFyYW1ldGVyLgorICogQHNpZ25hbF91NjRfcmVhZAlT
aWduYWwgdTY0IGNvbXBvbmVudCByZWFkIGNhbGxiYWNrLiBUaGUgcmVhZCB2YWx1ZSBvZgorICoJ
CQl0aGUgcmVzcGVjdGl2ZSBTaWduYWwgdTY0IGNvbXBvbmVudCBzaG91bGQgYmUgcGFzc2VkCisg
KgkJCWJhY2sgdmlhIHRoZSB2YWwgcGFyYW1ldGVyLgorICogQGFjdGlvbl93cml0ZQlTeW5hcHNl
IGFjdGlvbiBtb2RlIHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKKyAqCQkJdGhl
IHJlc3BlY3RpdmUgU3luYXBzZSBhY3Rpb24gbW9kZSBpcyBwYXNzZWQgdmlhIHRoZQorICoJCQlh
Y3Rpb24gcGFyYW1ldGVyLgorICogQGRldmljZV91OF93cml0ZQlEZXZpY2UgdTggY29tcG9uZW50
IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKKyAqCQkJdGhlIHJlc3BlY3RpdmUg
RGV2aWNlIHU4IGNvbXBvbmVudCBpcyBwYXNzZWQgdmlhIHRoZSB2YWwKKyAqCQkJcGFyYW1ldGVy
LgorICogQGNvdW50X3U4X3dyaXRlCUNvdW50IHU4IGNvbXBvbmVudCB3cml0ZSBjYWxsYmFjay4g
VGhlIHdyaXRlIHZhbHVlIG9mCisgKgkJCXRoZSByZXNwZWN0aXZlIENvdW50IHU4IGNvbXBvbmVu
dCBpcyBwYXNzZWQgdmlhIHRoZSB2YWwKKyAqCQkJcGFyYW1ldGVyLgorICogQHNpZ25hbF91OF93
cml0ZQlTaWduYWwgdTggY29tcG9uZW50IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUg
b2YKKyAqCQkJdGhlIHJlc3BlY3RpdmUgU2lnbmFsIHU4IGNvbXBvbmVudCBpcyBwYXNzZWQgdmlh
IHRoZSB2YWwKKyAqCQkJcGFyYW1ldGVyLgorICogQGRldmljZV91MzJfd3JpdGUJRGV2aWNlIHUz
MiBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgorICoJCQl0aGUg
cmVzcGVjdGl2ZSBEZXZpY2UgdTMyIGNvbXBvbmVudCBpcyBwYXNzZWQgdmlhIHRoZQorICoJCQl2
YWwgcGFyYW1ldGVyLgorICogQGNvdW50X3UzMl93cml0ZQlDb3VudCB1MzIgY29tcG9uZW50IHdy
aXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKKyAqCQkJdGhlIHJlc3BlY3RpdmUgQ291
bnQgdTMyIGNvbXBvbmVudCBpcyBwYXNzZWQgdmlhIHRoZSB2YWwKKyAqCQkJcGFyYW1ldGVyLgor
ICogQHNpZ25hbF91MzJfd3JpdGUJU2lnbmFsIHUzMiBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2su
IFRoZSB3cml0ZSB2YWx1ZSBvZgorICoJCQl0aGUgcmVzcGVjdGl2ZSBTaWduYWwgdTMyIGNvbXBv
bmVudCBpcyBwYXNzZWQgdmlhIHRoZQorICoJCQl2YWwgcGFyYW1ldGVyLgorICogQGRldmljZV91
NjRfd3JpdGUJRGV2aWNlIHU2NCBjb21wb25lbnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2
YWx1ZSBvZgorICoJCQl0aGUgcmVzcGVjdGl2ZSBEZXZpY2UgdTY0IGNvbXBvbmVudCBpcyBwYXNz
ZWQgdmlhIHRoZQorICoJCQl2YWwgcGFyYW1ldGVyLgorICogQGNvdW50X3U2NF93cml0ZQlDb3Vu
dCB1NjQgY29tcG9uZW50IHdyaXRlIGNhbGxiYWNrLiBUaGUgd3JpdGUgdmFsdWUgb2YKKyAqCQkJ
dGhlIHJlc3BlY3RpdmUgQ291bnQgdTY0IGNvbXBvbmVudCBpcyBwYXNzZWQgdmlhIHRoZSB2YWwK
KyAqCQkJcGFyYW1ldGVyLgorICogQHNpZ25hbF91NjRfd3JpdGUJU2lnbmFsIHU2NCBjb21wb25l
bnQgd3JpdGUgY2FsbGJhY2suIFRoZSB3cml0ZSB2YWx1ZSBvZgorICoJCQl0aGUgcmVzcGVjdGl2
ZSBTaWduYWwgdTY0IGNvbXBvbmVudCBpcyBwYXNzZWQgdmlhIHRoZQorICoJCQl2YWwgcGFyYW1l
dGVyLgogICovCi1zdHJ1Y3QgY291bnRlcl9zaWduYWxfZXh0IHsKK3N0cnVjdCBjb3VudGVyX2Nv
bXAgeworCWVudW0gY291bnRlcl9jb21wX3R5cGUgdHlwZTsKIAljb25zdCBjaGFyICpuYW1lOwot
CXNzaXplX3QgKCpyZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQlzdHJ1
Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdiwgY2hhciAqYnVmKTsKLQlzc2l6
ZV90ICgqd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKLQkJCSBzdHJ1Y3Qg
Y291bnRlcl9zaWduYWwgKnNpZ25hbCwgdm9pZCAqcHJpdiwKLQkJCSBjb25zdCBjaGFyICpidWYs
IHNpemVfdCBsZW4pOwogCXZvaWQgKnByaXY7CisJdW5pb24geworCQlpbnQgKCphY3Rpb25fcmVh
ZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAgIHN0cnVjdCBjb3VudGVy
X2NvdW50ICpjb3VudCwKKwkJCQkgICBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlLAor
CQkJCSAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uKTsKKwkJaW50ICgqZGV2
aWNlX3U4X3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdTggKnZhbCk7CisJ
CWludCAoKmNvdW50X3U4X3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJ
CQkgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTggKnZhbCk7CisJCWludCAoKnNp
Z25hbF91OF9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgICAg
c3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHU4ICp2YWwpOworCQlpbnQgKCpkZXZpY2Vf
dTMyX3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgICAgICAgdTMy
ICp2YWwpOworCQlpbnQgKCpjb3VudF91MzJfcmVhZCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpj
b3VudGVyLAorCQkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyICp2YWwp
OworCQlpbnQgKCpzaWduYWxfdTMyX3JlYWQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHUzMiAqdmFsKTsK
KwkJaW50ICgqZGV2aWNlX3U2NF9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
CisJCQkJICAgICAgIHU2NCAqdmFsKTsKKwkJaW50ICgqY291bnRfdTY0X3JlYWQpKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkgICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAq
Y291bnQsIHU2NCAqdmFsKTsKKwkJaW50ICgqc2lnbmFsX3U2NF9yZWFkKShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2ln
bmFsLCB1NjQgKnZhbCk7CisJfTsKKwl1bmlvbiB7CisJCWludCAoKmFjdGlvbl93cml0ZSkoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3Vu
dCAqY291bnQsCisJCQkJICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCisJCQkJ
ICAgIGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiBhY3Rpb24pOworCQlpbnQgKCpkZXZpY2Vf
dThfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgdTggdmFsKTsKKwkJaW50
ICgqY291bnRfdThfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCQkg
ICAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHU4IHZhbCk7CisJCWludCAoKnNpZ25h
bF91OF93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCSAgICAgICBz
dHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdTggdmFsKTsKKwkJaW50ICgqZGV2aWNlX3Uz
Ml93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAorCQkJCQl1MzIgdmFsKTsK
KwkJaW50ICgqY291bnRfdTMyX3dyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIs
CisJCQkJICAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTMyIHZhbCk7CisJCWlu
dCAoKnNpZ25hbF91MzJfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwKKwkJ
CQkJc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHUzMiB2YWwpOworCQlpbnQgKCpkZXZp
Y2VfdTY0X3dyaXRlKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkJCXU2NCB2
YWwpOworCQlpbnQgKCpjb3VudF91NjRfd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKKwkJCQkgICAgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB1NjQgdmFsKTsK
KwkJaW50ICgqc2lnbmFsX3U2NF93cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVy
LAorCQkJCQlzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwgdTY0IHZhbCk7CisJfTsKIH07
CiAKIC8qKgpAQCAtNTEsMjQ4ICsxOTMsNTIgQEAgc3RydWN0IGNvdW50ZXJfc2lnbmFsX2V4dCB7
CiAgKgkJYXMgaXQgYXBwZWFycyBpbiB0aGUgZGF0YXNoZWV0IGRvY3VtZW50YXRpb24KICAqIEBl
eHQ6CW9wdGlvbmFsIGFycmF5IG9mIENvdW50ZXIgU2lnbmFsIGV4dGVuc2lvbnMKICAqIEBudW1f
ZXh0OgludW1iZXIgb2YgQ291bnRlciBTaWduYWwgZXh0ZW5zaW9ucyBzcGVjaWZpZWQgaW4gQGV4
dAotICogQHByaXY6CW9wdGlvbmFsIHByaXZhdGUgZGF0YSBzdXBwbGllZCBieSBkcml2ZXIKICAq
Lwogc3RydWN0IGNvdW50ZXJfc2lnbmFsIHsKIAlpbnQgaWQ7CiAJY29uc3QgY2hhciAqbmFtZTsK
IAotCWNvbnN0IHN0cnVjdCBjb3VudGVyX3NpZ25hbF9leHQgKmV4dDsKKwlzdHJ1Y3QgY291bnRl
cl9jb21wICpleHQ7CiAJc2l6ZV90IG51bV9leHQ7Ci0KLQl2b2lkICpwcml2OwotfTsKLQotLyoq
Ci0gKiBzdHJ1Y3QgY291bnRlcl9zaWduYWxfZW51bV9leHQgLSBTaWduYWwgZW51bSBleHRlbnNp
b24gYXR0cmlidXRlCi0gKiBAaXRlbXM6CUFycmF5IG9mIHN0cmluZ3MKLSAqIEBudW1faXRlbXM6
CU51bWJlciBvZiBpdGVtcyBzcGVjaWZpZWQgaW4gQGl0ZW1zCi0gKiBAc2V0OglTZXQgY2FsbGJh
Y2sgZnVuY3Rpb247IG1heSBiZSBOVUxMCi0gKiBAZ2V0OglHZXQgY2FsbGJhY2sgZnVuY3Rpb247
IG1heSBiZSBOVUxMCi0gKgotICogVGhlIGNvdW50ZXJfc2lnbmFsX2VudW1fZXh0IHN0cnVjdHVy
ZSBjYW4gYmUgdXNlZCB0byBpbXBsZW1lbnQgZW51bSBzdHlsZQotICogU2lnbmFsIGV4dGVuc2lv
biBhdHRyaWJ1dGVzLiBFbnVtIHN0eWxlIGF0dHJpYnV0ZXMgYXJlIHRob3NlIHdoaWNoIGhhdmUg
YSBzZXQKLSAqIG9mIHN0cmluZ3MgdGhhdCBtYXAgdG8gdW5zaWduZWQgaW50ZWdlciB2YWx1ZXMu
IFRoZSBHZW5lcmljIENvdW50ZXIgU2lnbmFsCi0gKiBlbnVtIGV4dGVuc2lvbiBoZWxwZXIgY29k
ZSB0YWtlcyBjYXJlIG9mIG1hcHBpbmcgYmV0d2VlbiB2YWx1ZSBhbmQgc3RyaW5nLCBhcwotICog
d2VsbCBhcyBnZW5lcmF0aW5nIGEgIl9hdmFpbGFibGUiIGZpbGUgd2hpY2ggY29udGFpbnMgYSBs
aXN0IG9mIGFsbCBhdmFpbGFibGUKLSAqIGl0ZW1zLiBUaGUgZ2V0IGNhbGxiYWNrIGlzIHVzZWQg
dG8gcXVlcnkgdGhlIGN1cnJlbnRseSBhY3RpdmUgaXRlbTsgdGhlIGluZGV4Ci0gKiBvZiB0aGUg
aXRlbSB3aXRoaW4gdGhlIHJlc3BlY3RpdmUgaXRlbXMgYXJyYXkgaXMgcmV0dXJuZWQgdmlhIHRo
ZSAnaXRlbScKLSAqIHBhcmFtZXRlci4gVGhlIHNldCBjYWxsYmFjayBpcyBjYWxsZWQgd2hlbiB0
aGUgYXR0cmlidXRlIGlzIHVwZGF0ZWQ7IHRoZQotICogJ2l0ZW0nIHBhcmFtZXRlciBjb250YWlu
cyB0aGUgaW5kZXggb2YgdGhlIG5ld2x5IGFjdGl2YXRlZCBpdGVtIHdpdGhpbiB0aGUKLSAqIHJl
c3BlY3RpdmUgaXRlbXMgYXJyYXkuCi0gKi8KLXN0cnVjdCBjb3VudGVyX3NpZ25hbF9lbnVtX2V4
dCB7Ci0JY29uc3QgY2hhciAqIGNvbnN0ICppdGVtczsKLQlzaXplX3QgbnVtX2l0ZW1zOwotCWlu
dCAoKmdldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkgICBzdHJ1Y3QgY291
bnRlcl9zaWduYWwgKnNpZ25hbCwgc2l6ZV90ICppdGVtKTsKLQlpbnQgKCpzZXQpKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKLQkJICAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWdu
YWwsIHNpemVfdCBpdGVtKTsKLX07Ci0KLS8qKgotICogQ09VTlRFUl9TSUdOQUxfRU5VTSgpIC0g
SW5pdGlhbGl6ZSBTaWduYWwgZW51bSBleHRlbnNpb24KLSAqIEBfbmFtZToJQXR0cmlidXRlIG5h
bWUKLSAqIEBfZToJCVBvaW50ZXIgdG8gYSBjb3VudGVyX3NpZ25hbF9lbnVtX2V4dCBzdHJ1Y3R1
cmUKLSAqCi0gKiBUaGlzIHNob3VsZCB1c3VhbGx5IGJlIHVzZWQgdG9nZXRoZXIgd2l0aCBDT1VO
VEVSX1NJR05BTF9FTlVNX0FWQUlMQUJMRSgpCi0gKi8KLSNkZWZpbmUgQ09VTlRFUl9TSUdOQUxf
RU5VTShfbmFtZSwgX2UpIFwKLXsgXAotCS5uYW1lID0gKF9uYW1lKSwgXAotCS5yZWFkID0gY291
bnRlcl9zaWduYWxfZW51bV9yZWFkLCBcCi0JLndyaXRlID0gY291bnRlcl9zaWduYWxfZW51bV93
cml0ZSwgXAotCS5wcml2ID0gKF9lKSBcCi19Ci0KLS8qKgotICogQ09VTlRFUl9TSUdOQUxfRU5V
TV9BVkFJTEFCTEUoKSAtIEluaXRpYWxpemUgU2lnbmFsIGVudW0gYXZhaWxhYmxlIGV4dGVuc2lv
bgotICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZSAoIl9hdmFpbGFibGUiIHdpbGwgYmUgYXBwZW5k
ZWQgdG8gdGhlIG5hbWUpCi0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRlcl9zaWduYWxfZW51
bV9leHQgc3RydWN0dXJlCi0gKgotICogQ3JlYXRlcyBhIHJlYWQgb25seSBhdHRyaWJ1dGUgdGhh
dCBsaXN0cyBhbGwgdGhlIGF2YWlsYWJsZSBlbnVtIGl0ZW1zIGluIGEKLSAqIG5ld2xpbmUgc2Vw
YXJhdGVkIGxpc3QuIFRoaXMgc2hvdWxkIHVzdWFsbHkgYmUgdXNlZCB0b2dldGhlciB3aXRoCi0g
KiBDT1VOVEVSX1NJR05BTF9FTlVNKCkKLSAqLwotI2RlZmluZSBDT1VOVEVSX1NJR05BTF9FTlVN
X0FWQUlMQUJMRShfbmFtZSwgX2UpIFwKLXsgXAotCS5uYW1lID0gKF9uYW1lICJfYXZhaWxhYmxl
IiksIFwKLQkucmVhZCA9IGNvdW50ZXJfc2lnbmFsX2VudW1fYXZhaWxhYmxlX3JlYWQsIFwKLQku
cHJpdiA9IChfZSkgXAotfQotCi1lbnVtIGNvdW50ZXJfc3luYXBzZV9hY3Rpb24gewotCUNPVU5U
RVJfU1lOQVBTRV9BQ1RJT05fTk9ORSA9IDAsCi0JQ09VTlRFUl9TWU5BUFNFX0FDVElPTl9SSVNJ
TkdfRURHRSwKLQlDT1VOVEVSX1NZTkFQU0VfQUNUSU9OX0ZBTExJTkdfRURHRSwKLQlDT1VOVEVS
X1NZTkFQU0VfQUNUSU9OX0JPVEhfRURHRVMKIH07CiAKIC8qKgogICogc3RydWN0IGNvdW50ZXJf
c3luYXBzZSAtIENvdW50ZXIgU3luYXBzZSBub2RlCi0gKiBAYWN0aW9uOgkJaW5kZXggb2YgY3Vy
cmVudCBhY3Rpb24gbW9kZQogICogQGFjdGlvbnNfbGlzdDoJYXJyYXkgb2YgYXZhaWxhYmxlIGFj
dGlvbiBtb2RlcwogICogQG51bV9hY3Rpb25zOgludW1iZXIgb2YgYWN0aW9uIG1vZGVzIHNwZWNp
ZmllZCBpbiBAYWN0aW9uc19saXN0CiAgKiBAc2lnbmFsOgkJcG9pbnRlciB0byBhc3NvY2lhdGVk
IHNpZ25hbAogICovCiBzdHJ1Y3QgY291bnRlcl9zeW5hcHNlIHsKLQlzaXplX3QgYWN0aW9uOwog
CWNvbnN0IGVudW0gY291bnRlcl9zeW5hcHNlX2FjdGlvbiAqYWN0aW9uc19saXN0OwogCXNpemVf
dCBudW1fYWN0aW9uczsKIAogCXN0cnVjdCBjb3VudGVyX3NpZ25hbCAqc2lnbmFsOwogfTsKIAot
c3RydWN0IGNvdW50ZXJfY291bnQ7Ci0KLS8qKgotICogc3RydWN0IGNvdW50ZXJfY291bnRfZXh0
IC0gQ291bnRlciBDb3VudCBleHRlbnNpb24KLSAqIEBuYW1lOglhdHRyaWJ1dGUgbmFtZQotICog
QHJlYWQ6CXJlYWQgY2FsbGJhY2sgZm9yIHRoaXMgYXR0cmlidXRlOyBtYXkgYmUgTlVMTAotICog
QHdyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3IgdGhpcyBhdHRyaWJ1dGU7IG1heSBiZSBOVUxMCi0g
KiBAcHJpdjoJZGF0YSBwcml2YXRlIHRvIHRoZSBkcml2ZXIKLSAqLwotc3RydWN0IGNvdW50ZXJf
Y291bnRfZXh0IHsKLQljb25zdCBjaGFyICpuYW1lOwotCXNzaXplX3QgKCpyZWFkKShzdHJ1Y3Qg
Y291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQlzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQs
IHZvaWQgKnByaXYsIGNoYXIgKmJ1Zik7Ci0Jc3NpemVfdCAoKndyaXRlKShzdHJ1Y3QgY291bnRl
cl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50LCB2b2lk
ICpwcml2LAotCQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7Ci0Jdm9pZCAqcHJpdjsK
LX07Ci0KLWVudW0gY291bnRlcl9mdW5jdGlvbiB7Ci0JQ09VTlRFUl9GVU5DVElPTl9JTkNSRUFT
RSA9IDAsCi0JQ09VTlRFUl9GVU5DVElPTl9ERUNSRUFTRSwKLQlDT1VOVEVSX0ZVTkNUSU9OX1BV
TFNFX0RJUkVDVElPTiwKLQlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQSwKLQlDT1VO
VEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDFfQiwKLQlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRV
UkVfWDJfQSwKLQlDT1VOVEVSX0ZVTkNUSU9OX1FVQURSQVRVUkVfWDJfQiwKLQlDT1VOVEVSX0ZV
TkNUSU9OX1FVQURSQVRVUkVfWDQKLX07Ci0KIC8qKgogICogc3RydWN0IGNvdW50ZXJfY291bnQg
LSBDb3VudGVyIENvdW50IG5vZGUKICAqIEBpZDoJCQl1bmlxdWUgSUQgdXNlZCB0byBpZGVudGlm
eSBDb3VudAogICogQG5hbWU6CQlkZXZpY2Utc3BlY2lmaWMgQ291bnQgbmFtZTsgaWRlYWxseSwg
dGhpcyBzaG91bGQgbWF0Y2gKICAqCQkJdGhlIG5hbWUgYXMgaXQgYXBwZWFycyBpbiB0aGUgZGF0
YXNoZWV0IGRvY3VtZW50YXRpb24KLSAqIEBmdW5jdGlvbjoJCWluZGV4IG9mIGN1cnJlbnQgZnVu
Y3Rpb24gbW9kZQogICogQGZ1bmN0aW9uc19saXN0OglhcnJheSBhdmFpbGFibGUgZnVuY3Rpb24g
bW9kZXMKICAqIEBudW1fZnVuY3Rpb25zOgludW1iZXIgb2YgZnVuY3Rpb24gbW9kZXMgc3BlY2lm
aWVkIGluIEBmdW5jdGlvbnNfbGlzdAogICogQHN5bmFwc2VzOgkJYXJyYXkgb2Ygc3luYXBzZXMg
Zm9yIGluaXRpYWxpemF0aW9uCiAgKiBAbnVtX3N5bmFwc2VzOgludW1iZXIgb2Ygc3luYXBzZXMg
c3BlY2lmaWVkIGluIEBzeW5hcHNlcwogICogQGV4dDoJCW9wdGlvbmFsIGFycmF5IG9mIENvdW50
ZXIgQ291bnQgZXh0ZW5zaW9ucwogICogQG51bV9leHQ6CQludW1iZXIgb2YgQ291bnRlciBDb3Vu
dCBleHRlbnNpb25zIHNwZWNpZmllZCBpbiBAZXh0Ci0gKiBAcHJpdjoJCW9wdGlvbmFsIHByaXZh
dGUgZGF0YSBzdXBwbGllZCBieSBkcml2ZXIKICAqLwogc3RydWN0IGNvdW50ZXJfY291bnQgewog
CWludCBpZDsKIAljb25zdCBjaGFyICpuYW1lOwogCi0Jc2l6ZV90IGZ1bmN0aW9uOwogCWNvbnN0
IGVudW0gY291bnRlcl9mdW5jdGlvbiAqZnVuY3Rpb25zX2xpc3Q7CiAJc2l6ZV90IG51bV9mdW5j
dGlvbnM7CiAKIAlzdHJ1Y3QgY291bnRlcl9zeW5hcHNlICpzeW5hcHNlczsKIAlzaXplX3QgbnVt
X3N5bmFwc2VzOwogCi0JY29uc3Qgc3RydWN0IGNvdW50ZXJfY291bnRfZXh0ICpleHQ7CisJc3Ry
dWN0IGNvdW50ZXJfY29tcCAqZXh0OwogCXNpemVfdCBudW1fZXh0OwotCi0Jdm9pZCAqcHJpdjsK
LX07Ci0KLS8qKgotICogc3RydWN0IGNvdW50ZXJfY291bnRfZW51bV9leHQgLSBDb3VudCBlbnVt
IGV4dGVuc2lvbiBhdHRyaWJ1dGUKLSAqIEBpdGVtczoJQXJyYXkgb2Ygc3RyaW5ncwotICogQG51
bV9pdGVtczoJTnVtYmVyIG9mIGl0ZW1zIHNwZWNpZmllZCBpbiBAaXRlbXMKLSAqIEBzZXQ6CVNl
dCBjYWxsYmFjayBmdW5jdGlvbjsgbWF5IGJlIE5VTEwKLSAqIEBnZXQ6CUdldCBjYWxsYmFjayBm
dW5jdGlvbjsgbWF5IGJlIE5VTEwKLSAqCi0gKiBUaGUgY291bnRlcl9jb3VudF9lbnVtX2V4dCBz
dHJ1Y3R1cmUgY2FuIGJlIHVzZWQgdG8gaW1wbGVtZW50IGVudW0gc3R5bGUKLSAqIENvdW50IGV4
dGVuc2lvbiBhdHRyaWJ1dGVzLiBFbnVtIHN0eWxlIGF0dHJpYnV0ZXMgYXJlIHRob3NlIHdoaWNo
IGhhdmUgYSBzZXQKLSAqIG9mIHN0cmluZ3MgdGhhdCBtYXAgdG8gdW5zaWduZWQgaW50ZWdlciB2
YWx1ZXMuIFRoZSBHZW5lcmljIENvdW50ZXIgQ291bnQKLSAqIGVudW0gZXh0ZW5zaW9uIGhlbHBl
ciBjb2RlIHRha2VzIGNhcmUgb2YgbWFwcGluZyBiZXR3ZWVuIHZhbHVlIGFuZCBzdHJpbmcsIGFz
Ci0gKiB3ZWxsIGFzIGdlbmVyYXRpbmcgYSAiX2F2YWlsYWJsZSIgZmlsZSB3aGljaCBjb250YWlu
cyBhIGxpc3Qgb2YgYWxsIGF2YWlsYWJsZQotICogaXRlbXMuIFRoZSBnZXQgY2FsbGJhY2sgaXMg
dXNlZCB0byBxdWVyeSB0aGUgY3VycmVudGx5IGFjdGl2ZSBpdGVtOyB0aGUgaW5kZXgKLSAqIG9m
IHRoZSBpdGVtIHdpdGhpbiB0aGUgcmVzcGVjdGl2ZSBpdGVtcyBhcnJheSBpcyByZXR1cm5lZCB2
aWEgdGhlICdpdGVtJwotICogcGFyYW1ldGVyLiBUaGUgc2V0IGNhbGxiYWNrIGlzIGNhbGxlZCB3
aGVuIHRoZSBhdHRyaWJ1dGUgaXMgdXBkYXRlZDsgdGhlCi0gKiAnaXRlbScgcGFyYW1ldGVyIGNv
bnRhaW5zIHRoZSBpbmRleCBvZiB0aGUgbmV3bHkgYWN0aXZhdGVkIGl0ZW0gd2l0aGluIHRoZQot
ICogcmVzcGVjdGl2ZSBpdGVtcyBhcnJheS4KLSAqLwotc3RydWN0IGNvdW50ZXJfY291bnRfZW51
bV9leHQgewotCWNvbnN0IGNoYXIgKiBjb25zdCAqaXRlbXM7Ci0Jc2l6ZV90IG51bV9pdGVtczsK
LQlpbnQgKCpnZXQpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LAotCQkgICBzaXplX3QgKml0ZW0pOwotCWludCAoKnNldCkoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0J
CSAgIHNpemVfdCBpdGVtKTsKLX07Ci0KLS8qKgotICogQ09VTlRFUl9DT1VOVF9FTlVNKCkgLSBJ
bml0aWFsaXplIENvdW50IGVudW0gZXh0ZW5zaW9uCi0gKiBAX25hbWU6CUF0dHJpYnV0ZSBuYW1l
Ci0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRlcl9jb3VudF9lbnVtX2V4dCBzdHJ1Y3R1cmUK
LSAqCi0gKiBUaGlzIHNob3VsZCB1c3VhbGx5IGJlIHVzZWQgdG9nZXRoZXIgd2l0aCBDT1VOVEVS
X0NPVU5UX0VOVU1fQVZBSUxBQkxFKCkKLSAqLwotI2RlZmluZSBDT1VOVEVSX0NPVU5UX0VOVU0o
X25hbWUsIF9lKSBcCi17IFwKLQkubmFtZSA9IChfbmFtZSksIFwKLQkucmVhZCA9IGNvdW50ZXJf
Y291bnRfZW51bV9yZWFkLCBcCi0JLndyaXRlID0gY291bnRlcl9jb3VudF9lbnVtX3dyaXRlLCBc
Ci0JLnByaXYgPSAoX2UpIFwKLX0KLQotLyoqCi0gKiBDT1VOVEVSX0NPVU5UX0VOVU1fQVZBSUxB
QkxFKCkgLSBJbml0aWFsaXplIENvdW50IGVudW0gYXZhaWxhYmxlIGV4dGVuc2lvbgotICogQF9u
YW1lOglBdHRyaWJ1dGUgbmFtZSAoIl9hdmFpbGFibGUiIHdpbGwgYmUgYXBwZW5kZWQgdG8gdGhl
IG5hbWUpCi0gKiBAX2U6CQlQb2ludGVyIHRvIGEgY291bnRlcl9jb3VudF9lbnVtX2V4dCBzdHJ1
Y3R1cmUKLSAqCi0gKiBDcmVhdGVzIGEgcmVhZCBvbmx5IGF0dHJpYnV0ZSB0aGF0IGxpc3RzIGFs
bCB0aGUgYXZhaWxhYmxlIGVudW0gaXRlbXMgaW4gYQotICogbmV3bGluZSBzZXBhcmF0ZWQgbGlz
dC4gVGhpcyBzaG91bGQgdXN1YWxseSBiZSB1c2VkIHRvZ2V0aGVyIHdpdGgKLSAqIENPVU5URVJf
Q09VTlRfRU5VTSgpCi0gKi8KLSNkZWZpbmUgQ09VTlRFUl9DT1VOVF9FTlVNX0FWQUlMQUJMRShf
bmFtZSwgX2UpIFwKLXsgXAotCS5uYW1lID0gKF9uYW1lICJfYXZhaWxhYmxlIiksIFwKLQkucmVh
ZCA9IGNvdW50ZXJfY291bnRfZW51bV9hdmFpbGFibGVfcmVhZCwgXAotCS5wcml2ID0gKF9lKSBc
Ci19Ci0KLS8qKgotICogc3RydWN0IGNvdW50ZXJfZGV2aWNlX2F0dHJfZ3JvdXAgLSBpbnRlcm5h
bCBjb250YWluZXIgZm9yIGF0dHJpYnV0ZSBncm91cAotICogQGF0dHJfZ3JvdXA6CUNvdW50ZXIg
c3lzZnMgYXR0cmlidXRlcyBncm91cAotICogQGF0dHJfbGlzdDoJbGlzdCB0byBrZWVwIHRyYWNr
IG9mIGNyZWF0ZWQgQ291bnRlciBzeXNmcyBhdHRyaWJ1dGVzCi0gKiBAbnVtX2F0dHI6CW51bWJl
ciBvZiBDb3VudGVyIHN5c2ZzIGF0dHJpYnV0ZXMKLSAqLwotc3RydWN0IGNvdW50ZXJfZGV2aWNl
X2F0dHJfZ3JvdXAgewotCXN0cnVjdCBhdHRyaWJ1dGVfZ3JvdXAgYXR0cl9ncm91cDsKLQlzdHJ1
Y3QgbGlzdF9oZWFkIGF0dHJfbGlzdDsKLQlzaXplX3QgbnVtX2F0dHI7Ci19OwotCi0vKioKLSAq
IHN0cnVjdCBjb3VudGVyX2RldmljZV9zdGF0ZSAtIGludGVybmFsIHN0YXRlIGNvbnRhaW5lciBm
b3IgYSBDb3VudGVyIGRldmljZQotICogQGlkOgkJCXVuaXF1ZSBJRCB1c2VkIHRvIGlkZW50aWZ5
IHRoZSBDb3VudGVyCi0gKiBAZGV2OgkJaW50ZXJuYWwgZGV2aWNlIHN0cnVjdHVyZQotICogQGdy
b3Vwc19saXN0OglhdHRyaWJ1dGUgZ3JvdXBzIGxpc3QgKGZvciBTaWduYWxzLCBDb3VudHMsIGFu
ZCBleHQpCi0gKiBAbnVtX2dyb3VwczoJCW51bWJlciBvZiBhdHRyaWJ1dGUgZ3JvdXBzIGNvbnRh
aW5lcnMKLSAqIEBncm91cHM6CQlDb3VudGVyIHN5c2ZzIGF0dHJpYnV0ZSBncm91cHMgKHRvIHBv
cHVsYXRlIEBkZXYuZ3JvdXBzKQotICovCi1zdHJ1Y3QgY291bnRlcl9kZXZpY2Vfc3RhdGUgewot
CWludCBpZDsKLQlzdHJ1Y3QgZGV2aWNlIGRldjsKLQlzdHJ1Y3QgY291bnRlcl9kZXZpY2VfYXR0
cl9ncm91cCAqZ3JvdXBzX2xpc3Q7Ci0Jc2l6ZV90IG51bV9ncm91cHM7Ci0JY29uc3Qgc3RydWN0
IGF0dHJpYnV0ZV9ncm91cCAqKmdyb3VwczsKLX07Ci0KLWVudW0gY291bnRlcl9zaWduYWxfbGV2
ZWwgewotCUNPVU5URVJfU0lHTkFMX0xFVkVMX0xPVywKLQlDT1VOVEVSX1NJR05BTF9MRVZFTF9I
SUdILAogfTsKIAogLyoqCkBAIC0zMDYsMTE3ICsyNTIsNDcgQEAgZW51bSBjb3VudGVyX3NpZ25h
bF9sZXZlbCB7CiAgKiBAY291bnRfd3JpdGU6CW9wdGlvbmFsIHdyaXRlIGNhbGxiYWNrIGZvciBD
b3VudCBhdHRyaWJ1dGUuIFRoZSB3cml0ZQogICoJCQl2YWx1ZSBmb3IgdGhlIHJlc3BlY3RpdmUg
Q291bnQgaXMgcGFzc2VkIGluIHZpYSB0aGUgdmFsCiAgKgkJCXBhcmFtZXRlci4KLSAqIEBmdW5j
dGlvbl9nZXQ6CWZ1bmN0aW9uIHRvIGdldCB0aGUgY3VycmVudCBjb3VudCBmdW5jdGlvbiBtb2Rl
LiBSZXR1cm5zCi0gKgkJCTAgb24gc3VjY2VzcyBhbmQgbmVnYXRpdmUgZXJyb3IgY29kZSBvbiBl
cnJvci4gVGhlIGluZGV4Ci0gKgkJCW9mIHRoZSByZXNwZWN0aXZlIENvdW50J3MgcmV0dXJuZWQg
ZnVuY3Rpb24gbW9kZSBzaG91bGQKLSAqCQkJYmUgcGFzc2VkIGJhY2sgdmlhIHRoZSBmdW5jdGlv
biBwYXJhbWV0ZXIuCi0gKiBAZnVuY3Rpb25fc2V0OglmdW5jdGlvbiB0byBzZXQgdGhlIGNvdW50
IGZ1bmN0aW9uIG1vZGUuIGZ1bmN0aW9uIGlzIHRoZQotICoJCQlpbmRleCBvZiB0aGUgcmVxdWVz
dGVkIGZ1bmN0aW9uIG1vZGUgZnJvbSB0aGUgcmVzcGVjdGl2ZQotICoJCQlDb3VudCdzIGZ1bmN0
aW9uc19saXN0IGFycmF5LgotICogQGFjdGlvbl9nZXQ6CQlmdW5jdGlvbiB0byBnZXQgdGhlIGN1
cnJlbnQgYWN0aW9uIG1vZGUuIFJldHVybnMgMCBvbgotICoJCQlzdWNjZXNzIGFuZCBuZWdhdGl2
ZSBlcnJvciBjb2RlIG9uIGVycm9yLiBUaGUgaW5kZXggb2YKLSAqCQkJdGhlIHJlc3BlY3RpdmUg
U3luYXBzZSdzIHJldHVybmVkIGFjdGlvbiBtb2RlIHNob3VsZCBiZQotICoJCQlwYXNzZWQgYmFj
ayB2aWEgdGhlIGFjdGlvbiBwYXJhbWV0ZXIuCi0gKiBAYWN0aW9uX3NldDoJCWZ1bmN0aW9uIHRv
IHNldCB0aGUgYWN0aW9uIG1vZGUuIGFjdGlvbiBpcyB0aGUgaW5kZXggb2YKLSAqCQkJdGhlIHJl
cXVlc3RlZCBhY3Rpb24gbW9kZSBmcm9tIHRoZSByZXNwZWN0aXZlIFN5bmFwc2UncwotICoJCQlh
Y3Rpb25zX2xpc3QgYXJyYXkuCisgKiBAZnVuY3Rpb25fcmVhZDoJcmVhZCBjYWxsYmFjayB0aGUg
Q291bnQgZnVuY3Rpb24gbW9kZXMuIFRoZSByZWFkCisgKgkJCWZ1bmN0aW9uIG1vZGUgb2YgdGhl
IHJlc3BlY3RpdmUgQ291bnQgc2hvdWxkIGJlIHBhc3NlZAorICoJCQliYWNrIHZpYSB0aGUgZnVu
Y3Rpb24gcGFyYW1ldGVyLgorICogQGZ1bmN0aW9uX3dyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3Ig
Q291bnQgZnVuY3Rpb24gbW9kZXMuIFRoZSBmdW5jdGlvbgorICoJCQltb2RlIHRvIHdyaXRlIGZv
ciB0aGUgcmVzcGVjdGl2ZSBDb3VudCBpcyBwYXNzZWQgaW4gdmlhCisgKgkJCXRoZSBmdW5jdGlv
biBwYXJhbWV0ZXIuCisgKiBAYWN0aW9uX3JlYWQ6CXJlYWQgY2FsbGJhY2sgdGhlIFN5bmFwc2Ug
YWN0aW9uIG1vZGVzLiBUaGUgcmVhZCBhY3Rpb24KKyAqCQkJbW9kZSBvZiB0aGUgcmVzcGVjdGl2
ZSBTeW5hcHNlIHNob3VsZCBiZSBwYXNzZWQgYmFjayB2aWEKKyAqCQkJdGhlIGFjdGlvbiBwYXJh
bWV0ZXIuCisgKiBAYWN0aW9uX3dyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3IgU3luYXBzZSBhY3Rp
b24gbW9kZXMuIFRoZSBhY3Rpb24gbW9kZQorICoJCQl0byB3cml0ZSBmb3IgdGhlIHJlc3BlY3Rp
dmUgU3luYXBzZSBpcyBwYXNzZWQgaW4gdmlhIHRoZQorICoJCQlhY3Rpb24gcGFyYW1ldGVyLgog
ICovCiBzdHJ1Y3QgY291bnRlcl9vcHMgewogCWludCAoKnNpZ25hbF9yZWFkKShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCiAJCQkgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25h
bCwKIAkJCSAgIGVudW0gY291bnRlcl9zaWduYWxfbGV2ZWwgKmxldmVsKTsKIAlpbnQgKCpjb3Vu
dF9yZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwgdW5zaWduZWQgbG9uZyAqdmFsKTsKKwkJCSAgc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCB1NjQgKnZhbHVlKTsKIAlpbnQgKCpjb3VudF93cml0ZSkoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNv
dW50LCB1bnNpZ25lZCBsb25nIHZhbCk7Ci0JaW50ICgqZnVuY3Rpb25fZ2V0KShzdHJ1Y3QgY291
bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50
LCBzaXplX3QgKmZ1bmN0aW9uKTsKLQlpbnQgKCpmdW5jdGlvbl9zZXQpKHN0cnVjdCBjb3VudGVy
X2RldmljZSAqY291bnRlciwKLQkJCSAgICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsIHNp
emVfdCBmdW5jdGlvbik7Ci0JaW50ICgqYWN0aW9uX2dldCkoc3RydWN0IGNvdW50ZXJfZGV2aWNl
ICpjb3VudGVyLAotCQkJICBzdHJ1Y3QgY291bnRlcl9jb3VudCAqY291bnQsCi0JCQkgIHN0cnVj
dCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsIHNpemVfdCAqYWN0aW9uKTsKLQlpbnQgKCphY3Rp
b25fc2V0KShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKLQkJCSAgc3RydWN0IGNvdW50ZXJfc3luYXBzZSAqc3luYXBzZSwg
c2l6ZV90IGFjdGlvbik7Ci19OwotCi0vKioKLSAqIHN0cnVjdCBjb3VudGVyX2RldmljZV9leHQg
LSBDb3VudGVyIGRldmljZSBleHRlbnNpb24KLSAqIEBuYW1lOglhdHRyaWJ1dGUgbmFtZQotICog
QHJlYWQ6CXJlYWQgY2FsbGJhY2sgZm9yIHRoaXMgYXR0cmlidXRlOyBtYXkgYmUgTlVMTAotICog
QHdyaXRlOgl3cml0ZSBjYWxsYmFjayBmb3IgdGhpcyBhdHRyaWJ1dGU7IG1heSBiZSBOVUxMCi0g
KiBAcHJpdjoJZGF0YSBwcml2YXRlIHRvIHRoZSBkcml2ZXIKLSAqLwotc3RydWN0IGNvdW50ZXJf
ZGV2aWNlX2V4dCB7Ci0JY29uc3QgY2hhciAqbmFtZTsKLQlzc2l6ZV90ICgqcmVhZCkoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LCBjaGFyICpidWYpOwotCXNzaXpl
X3QgKCp3cml0ZSkoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpwcml2LAot
CQkJIGNvbnN0IGNoYXIgKmJ1Ziwgc2l6ZV90IGxlbik7Ci0Jdm9pZCAqcHJpdjsKKwkJCSAgIHN0
cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdTY0IHZhbHVlKTsKKwlpbnQgKCpmdW5jdGlvbl9y
ZWFkKShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkgICAgIHN0cnVjdCBjb3Vu
dGVyX2NvdW50ICpjb3VudCwKKwkJCSAgICAgZW51bSBjb3VudGVyX2Z1bmN0aW9uICpmdW5jdGlv
bik7CisJaW50ICgqZnVuY3Rpb25fd3JpdGUpKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRl
ciwKKwkJCSAgICAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwKKwkJCSAgICAgIGVudW0g
Y291bnRlcl9mdW5jdGlvbiBmdW5jdGlvbik7CisJaW50ICgqYWN0aW9uX3JlYWQpKHN0cnVjdCBj
b3VudGVyX2RldmljZSAqY291bnRlciwKKwkJCSAgIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3Vu
dCwKKwkJCSAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCisJCQkgICBlbnVtIGNv
dW50ZXJfc3luYXBzZV9hY3Rpb24gKmFjdGlvbik7CisJaW50ICgqYWN0aW9uX3dyaXRlKShzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCisJCQkgICAgc3RydWN0IGNvdW50ZXJfY291bnQg
KmNvdW50LAorCQkJICAgIHN0cnVjdCBjb3VudGVyX3N5bmFwc2UgKnN5bmFwc2UsCisJCQkgICAg
ZW51bSBjb3VudGVyX3N5bmFwc2VfYWN0aW9uIGFjdGlvbik7CiB9OwogCi0vKioKLSAqIHN0cnVj
dCBjb3VudGVyX2RldmljZV9lbnVtX2V4dCAtIENvdW50ZXIgZW51bSBleHRlbnNpb24gYXR0cmli
dXRlCi0gKiBAaXRlbXM6CUFycmF5IG9mIHN0cmluZ3MKLSAqIEBudW1faXRlbXM6CU51bWJlciBv
ZiBpdGVtcyBzcGVjaWZpZWQgaW4gQGl0ZW1zCi0gKiBAc2V0OglTZXQgY2FsbGJhY2sgZnVuY3Rp
b247IG1heSBiZSBOVUxMCi0gKiBAZ2V0OglHZXQgY2FsbGJhY2sgZnVuY3Rpb247IG1heSBiZSBO
VUxMCi0gKgotICogVGhlIGNvdW50ZXJfZGV2aWNlX2VudW1fZXh0IHN0cnVjdHVyZSBjYW4gYmUg
dXNlZCB0byBpbXBsZW1lbnQgZW51bSBzdHlsZQotICogQ291bnRlciBleHRlbnNpb24gYXR0cmli
dXRlcy4gRW51bSBzdHlsZSBhdHRyaWJ1dGVzIGFyZSB0aG9zZSB3aGljaCBoYXZlIGEKLSAqIHNl
dCBvZiBzdHJpbmdzIHRoYXQgbWFwIHRvIHVuc2lnbmVkIGludGVnZXIgdmFsdWVzLiBUaGUgR2Vu
ZXJpYyBDb3VudGVyIGVudW0KLSAqIGV4dGVuc2lvbiBoZWxwZXIgY29kZSB0YWtlcyBjYXJlIG9m
IG1hcHBpbmcgYmV0d2VlbiB2YWx1ZSBhbmQgc3RyaW5nLCBhcyB3ZWxsCi0gKiBhcyBnZW5lcmF0
aW5nIGEgIl9hdmFpbGFibGUiIGZpbGUgd2hpY2ggY29udGFpbnMgYSBsaXN0IG9mIGFsbCBhdmFp
bGFibGUKLSAqIGl0ZW1zLiBUaGUgZ2V0IGNhbGxiYWNrIGlzIHVzZWQgdG8gcXVlcnkgdGhlIGN1
cnJlbnRseSBhY3RpdmUgaXRlbTsgdGhlIGluZGV4Ci0gKiBvZiB0aGUgaXRlbSB3aXRoaW4gdGhl
IHJlc3BlY3RpdmUgaXRlbXMgYXJyYXkgaXMgcmV0dXJuZWQgdmlhIHRoZSAnaXRlbScKLSAqIHBh
cmFtZXRlci4gVGhlIHNldCBjYWxsYmFjayBpcyBjYWxsZWQgd2hlbiB0aGUgYXR0cmlidXRlIGlz
IHVwZGF0ZWQ7IHRoZQotICogJ2l0ZW0nIHBhcmFtZXRlciBjb250YWlucyB0aGUgaW5kZXggb2Yg
dGhlIG5ld2x5IGFjdGl2YXRlZCBpdGVtIHdpdGhpbiB0aGUKLSAqIHJlc3BlY3RpdmUgaXRlbXMg
YXJyYXkuCi0gKi8KLXN0cnVjdCBjb3VudGVyX2RldmljZV9lbnVtX2V4dCB7Ci0JY29uc3QgY2hh
ciAqIGNvbnN0ICppdGVtczsKLQlzaXplX3QgbnVtX2l0ZW1zOwotCWludCAoKmdldCkoc3RydWN0
IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCBzaXplX3QgKml0ZW0pOwotCWludCAoKnNldCkoc3Ry
dWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCBzaXplX3QgaXRlbSk7Ci19OwotCi0vKioKLSAq
IENPVU5URVJfREVWSUNFX0VOVU0oKSAtIEluaXRpYWxpemUgQ291bnRlciBlbnVtIGV4dGVuc2lv
bgotICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZQotICogQF9lOgkJUG9pbnRlciB0byBhIGNvdW50
ZXJfZGV2aWNlX2VudW1fZXh0IHN0cnVjdHVyZQotICoKLSAqIFRoaXMgc2hvdWxkIHVzdWFsbHkg
YmUgdXNlZCB0b2dldGhlciB3aXRoIENPVU5URVJfREVWSUNFX0VOVU1fQVZBSUxBQkxFKCkKLSAq
LwotI2RlZmluZSBDT1VOVEVSX0RFVklDRV9FTlVNKF9uYW1lLCBfZSkgXAoteyBcCi0JLm5hbWUg
PSAoX25hbWUpLCBcCi0JLnJlYWQgPSBjb3VudGVyX2RldmljZV9lbnVtX3JlYWQsIFwKLQkud3Jp
dGUgPSBjb3VudGVyX2RldmljZV9lbnVtX3dyaXRlLCBcCi0JLnByaXYgPSAoX2UpIFwKLX0KLQot
LyoqCi0gKiBDT1VOVEVSX0RFVklDRV9FTlVNX0FWQUlMQUJMRSgpIC0gSW5pdGlhbGl6ZSBDb3Vu
dGVyIGVudW0gYXZhaWxhYmxlIGV4dGVuc2lvbgotICogQF9uYW1lOglBdHRyaWJ1dGUgbmFtZSAo
Il9hdmFpbGFibGUiIHdpbGwgYmUgYXBwZW5kZWQgdG8gdGhlIG5hbWUpCi0gKiBAX2U6CQlQb2lu
dGVyIHRvIGEgY291bnRlcl9kZXZpY2VfZW51bV9leHQgc3RydWN0dXJlCi0gKgotICogQ3JlYXRl
cyBhIHJlYWQgb25seSBhdHRyaWJ1dGUgdGhhdCBsaXN0cyBhbGwgdGhlIGF2YWlsYWJsZSBlbnVt
IGl0ZW1zIGluIGEKLSAqIG5ld2xpbmUgc2VwYXJhdGVkIGxpc3QuIFRoaXMgc2hvdWxkIHVzdWFs
bHkgYmUgdXNlZCB0b2dldGhlciB3aXRoCi0gKiBDT1VOVEVSX0RFVklDRV9FTlVNKCkKLSAqLwot
I2RlZmluZSBDT1VOVEVSX0RFVklDRV9FTlVNX0FWQUlMQUJMRShfbmFtZSwgX2UpIFwKLXsgXAot
CS5uYW1lID0gKF9uYW1lICJfYXZhaWxhYmxlIiksIFwKLQkucmVhZCA9IGNvdW50ZXJfZGV2aWNl
X2VudW1fYXZhaWxhYmxlX3JlYWQsIFwKLQkucHJpdiA9IChfZSkgXAotfQotCiAvKioKICAqIHN0
cnVjdCBjb3VudGVyX2RldmljZSAtIENvdW50ZXIgZGF0YSBzdHJ1Y3R1cmUKICAqIEBuYW1lOgkJ
bmFtZSBvZiB0aGUgZGV2aWNlIGFzIGl0IGFwcGVhcnMgaW4gdGhlIGRhdGFzaGVldAogICogQHBh
cmVudDoJCW9wdGlvbmFsIHBhcmVudCBkZXZpY2UgcHJvdmlkaW5nIHRoZSBjb3VudGVycwotICog
QGRldmljZV9zdGF0ZToJaW50ZXJuYWwgZGV2aWNlIHN0YXRlIGNvbnRhaW5lcgogICogQG9wczoJ
CWNhbGxiYWNrcyBmcm9tIGRyaXZlcgogICogQHNpZ25hbHM6CQlhcnJheSBvZiBTaWduYWxzCiAg
KiBAbnVtX3NpZ25hbHM6CW51bWJlciBvZiBTaWduYWxzIHNwZWNpZmllZCBpbiBAc2lnbmFscwpA
QCAtNDI1LDExICszMDEsMTEgQEAgc3RydWN0IGNvdW50ZXJfZGV2aWNlX2VudW1fZXh0IHsKICAq
IEBleHQ6CQlvcHRpb25hbCBhcnJheSBvZiBDb3VudGVyIGRldmljZSBleHRlbnNpb25zCiAgKiBA
bnVtX2V4dDoJCW51bWJlciBvZiBDb3VudGVyIGRldmljZSBleHRlbnNpb25zIHNwZWNpZmllZCBp
biBAZXh0CiAgKiBAcHJpdjoJCW9wdGlvbmFsIHByaXZhdGUgZGF0YSBzdXBwbGllZCBieSBkcml2
ZXIKKyAqIEBkZXY6CQlpbnRlcm5hbCBkZXZpY2Ugc3RydWN0dXJlCiAgKi8KIHN0cnVjdCBjb3Vu
dGVyX2RldmljZSB7CiAJY29uc3QgY2hhciAqbmFtZTsKIAlzdHJ1Y3QgZGV2aWNlICpwYXJlbnQ7
Ci0Jc3RydWN0IGNvdW50ZXJfZGV2aWNlX3N0YXRlICpkZXZpY2Vfc3RhdGU7CiAKIAljb25zdCBz
dHJ1Y3QgY291bnRlcl9vcHMgKm9wczsKIApAQCAtNDM4LDE3ICszMTQsMTU5IEBAIHN0cnVjdCBj
b3VudGVyX2RldmljZSB7CiAJc3RydWN0IGNvdW50ZXJfY291bnQgKmNvdW50czsKIAlzaXplX3Qg
bnVtX2NvdW50czsKIAotCWNvbnN0IHN0cnVjdCBjb3VudGVyX2RldmljZV9leHQgKmV4dDsKKwlz
dHJ1Y3QgY291bnRlcl9jb21wICpleHQ7CiAJc2l6ZV90IG51bV9leHQ7CiAKIAl2b2lkICpwcml2
OworCisJc3RydWN0IGRldmljZSBkZXY7CiB9OwogCiBpbnQgY291bnRlcl9yZWdpc3RlcihzdHJ1
Y3QgY291bnRlcl9kZXZpY2UgKmNvbnN0IGNvdW50ZXIpOwogdm9pZCBjb3VudGVyX3VucmVnaXN0
ZXIoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb25zdCBjb3VudGVyKTsKIGludCBkZXZtX2NvdW50
ZXJfcmVnaXN0ZXIoc3RydWN0IGRldmljZSAqZGV2LAogCQkJICBzdHJ1Y3QgY291bnRlcl9kZXZp
Y2UgKmNvbnN0IGNvdW50ZXIpOwotdm9pZCBkZXZtX2NvdW50ZXJfdW5yZWdpc3RlcihzdHJ1Y3Qg
ZGV2aWNlICpkZXYsCi0JCQkgICAgIHN0cnVjdCBjb3VudGVyX2RldmljZSAqY29uc3QgY291bnRl
cik7CisKKyNkZWZpbmUgQ09VTlRFUl9DT01QX0RFVklDRV9VOChfbmFtZSwgX3JlYWQsIF93cml0
ZSkgXAoreyBcCisJLnR5cGUgPSBDT1VOVEVSX0NPTVBfVTgsIFwKKwkubmFtZSA9IChfbmFtZSks
IFwKKwkuZGV2aWNlX3U4X3JlYWQgPSAoX3JlYWQpLCBcCisJLmRldmljZV91OF93cml0ZSA9IChf
d3JpdGUpLCBcCit9CisjZGVmaW5lIENPVU5URVJfQ09NUF9DT1VOVF9VOChfbmFtZSwgX3JlYWQs
IF93cml0ZSkgXAoreyBcCisJLnR5cGUgPSBDT1VOVEVSX0NPTVBfVTgsIFwKKwkubmFtZSA9IChf
bmFtZSksIFwKKwkuY291bnRfdThfcmVhZCA9IChfcmVhZCksIFwKKwkuY291bnRfdThfd3JpdGUg
PSAoX3dyaXRlKSwgXAorfQorI2RlZmluZSBDT1VOVEVSX0NPTVBfU0lHTkFMX1U4KF9uYW1lLCBf
cmVhZCwgX3dyaXRlKSBcCit7IFwKKwkudHlwZSA9IENPVU5URVJfQ09NUF9VOCwgXAorCS5uYW1l
ID0gKF9uYW1lKSwgXAorCS5zaWduYWxfdThfcmVhZCA9IChfcmVhZCksIFwKKwkuc2lnbmFsX3U4
X3dyaXRlID0gKF93cml0ZSksIFwKK30KKworI2RlZmluZSBDT1VOVEVSX0NPTVBfREVWSUNFX1U2
NChfbmFtZSwgX3JlYWQsIF93cml0ZSkgXAoreyBcCisJLnR5cGUgPSBDT1VOVEVSX0NPTVBfVTY0
LCBcCisJLm5hbWUgPSAoX25hbWUpLCBcCisJLmRldmljZV91NjRfcmVhZCA9IChfcmVhZCksIFwK
KwkuZGV2aWNlX3U2NF93cml0ZSA9IChfd3JpdGUpLCBcCit9CisjZGVmaW5lIENPVU5URVJfQ09N
UF9DT1VOVF9VNjQoX25hbWUsIF9yZWFkLCBfd3JpdGUpIFwKK3sgXAorCS50eXBlID0gQ09VTlRF
Ul9DT01QX1U2NCwgXAorCS5uYW1lID0gKF9uYW1lKSwgXAorCS5jb3VudF91NjRfcmVhZCA9IChf
cmVhZCksIFwKKwkuY291bnRfdTY0X3dyaXRlID0gKF93cml0ZSksIFwKK30KKyNkZWZpbmUgQ09V
TlRFUl9DT01QX1NJR05BTF9VNjQoX25hbWUsIF9yZWFkLCBfd3JpdGUpIFwKK3sgXAorCS50eXBl
ID0gQ09VTlRFUl9DT01QX1U2NCwgXAorCS5uYW1lID0gKF9uYW1lKSwgXAorCS5zaWduYWxfdTY0
X3JlYWQgPSAoX3JlYWQpLCBcCisJLnNpZ25hbF91NjRfd3JpdGUgPSAoX3dyaXRlKSwgXAorfQor
CisjZGVmaW5lIENPVU5URVJfQ09NUF9ERVZJQ0VfQk9PTChfbmFtZSwgX3JlYWQsIF93cml0ZSkg
XAoreyBcCisJLnR5cGUgPSBDT1VOVEVSX0NPTVBfQk9PTCwgXAorCS5uYW1lID0gKF9uYW1lKSwg
XAorCS5kZXZpY2VfdThfcmVhZCA9IChfcmVhZCksIFwKKwkuZGV2aWNlX3U4X3dyaXRlID0gKF93
cml0ZSksIFwKK30KKyNkZWZpbmUgQ09VTlRFUl9DT01QX0NPVU5UX0JPT0woX25hbWUsIF9yZWFk
LCBfd3JpdGUpIFwKK3sgXAorCS50eXBlID0gQ09VTlRFUl9DT01QX0JPT0wsIFwKKwkubmFtZSA9
IChfbmFtZSksIFwKKwkuY291bnRfdThfcmVhZCA9IChfcmVhZCksIFwKKwkuY291bnRfdThfd3Jp
dGUgPSAoX3dyaXRlKSwgXAorfQorI2RlZmluZSBDT1VOVEVSX0NPTVBfU0lHTkFMX0JPT0woX25h
bWUsIF9yZWFkLCBfd3JpdGUpIFwKK3sgXAorCS50eXBlID0gQ09VTlRFUl9DT01QX0JPT0wsIFwK
KwkubmFtZSA9IChfbmFtZSksIFwKKwkuc2lnbmFsX3U4X3JlYWQgPSAoX3JlYWQpLCBcCisJLnNp
Z25hbF91OF93cml0ZSA9IChfd3JpdGUpLCBcCit9CisKK3N0cnVjdCBjb3VudGVyX2F2YWlsYWJs
ZSB7CisJdW5pb24geworCQljb25zdCB1MzIgKmVudW1zOworCQljb25zdCBjaGFyICpjb25zdCAq
c3RyczsKKwl9OworCXNpemVfdCBudW1faXRlbXM7Cit9OworCisjZGVmaW5lIERFRklORV9DT1VO
VEVSX0FWQUlMQUJMRShfbmFtZSwgX2VudW1zKSBcCisJc3RydWN0IGNvdW50ZXJfYXZhaWxhYmxl
IF9uYW1lID0geyBcCisJCS5lbnVtcyA9IChfZW51bXMpLCBcCisJCS5udW1faXRlbXMgPSBBUlJB
WV9TSVpFKF9lbnVtcyksIFwKKwl9CisKKyNkZWZpbmUgREVGSU5FX0NPVU5URVJfRU5VTShfbmFt
ZSwgX3N0cnMpIFwKKwlzdHJ1Y3QgY291bnRlcl9hdmFpbGFibGUgX25hbWUgPSB7IFwKKwkJLnN0
cnMgPSAoX3N0cnMpLCBcCisJCS5udW1faXRlbXMgPSBBUlJBWV9TSVpFKF9zdHJzKSwgXAorCX0K
KworI2RlZmluZSBDT1VOVEVSX0NPTVBfREVWSUNFX0VOVU0oX25hbWUsIF9nZXQsIF9zZXQsIF9h
dmFpbGFibGUpIFwKK3sgXAorCS50eXBlID0gQ09VTlRFUl9DT01QX0VOVU0sIFwKKwkubmFtZSA9
IChfbmFtZSksIFwKKwkuZGV2aWNlX3UzMl9yZWFkID0gKF9nZXQpLCBcCisJLmRldmljZV91MzJf
d3JpdGUgPSAoX3NldCksIFwKKwkucHJpdiA9ICYoX2F2YWlsYWJsZSksIFwKK30KKyNkZWZpbmUg
Q09VTlRFUl9DT01QX0NPVU5UX0VOVU0oX25hbWUsIF9nZXQsIF9zZXQsIF9hdmFpbGFibGUpIFwK
K3sgXAorCS50eXBlID0gQ09VTlRFUl9DT01QX0VOVU0sIFwKKwkubmFtZSA9IChfbmFtZSksIFwK
KwkuY291bnRfdTMyX3JlYWQgPSAoX2dldCksIFwKKwkuY291bnRfdTMyX3dyaXRlID0gKF9zZXQp
LCBcCisJLnByaXYgPSAmKF9hdmFpbGFibGUpLCBcCit9CisjZGVmaW5lIENPVU5URVJfQ09NUF9T
SUdOQUxfRU5VTShfbmFtZSwgX2dldCwgX3NldCwgX2F2YWlsYWJsZSkgXAoreyBcCisJLnR5cGUg
PSBDT1VOVEVSX0NPTVBfRU5VTSwgXAorCS5uYW1lID0gKF9uYW1lKSwgXAorCS5zaWduYWxfdTMy
X3JlYWQgPSAoX2dldCksIFwKKwkuc2lnbmFsX3UzMl93cml0ZSA9IChfc2V0KSwgXAorCS5wcml2
ID0gJihfYXZhaWxhYmxlKSwgXAorfQorCisjZGVmaW5lIENPVU5URVJfQ09NUF9DRUlMSU5HKF9y
ZWFkLCBfd3JpdGUpIFwKKwlDT1VOVEVSX0NPTVBfQ09VTlRfVTY0KCJjZWlsaW5nIiwgX3JlYWQs
IF93cml0ZSkKKworI2RlZmluZSBDT1VOVEVSX0NPTVBfQ09VTlRfTU9ERShfcmVhZCwgX3dyaXRl
LCBfYXZhaWxhYmxlKSBcCit7IFwKKwkudHlwZSA9IENPVU5URVJfQ09NUF9DT1VOVF9NT0RFLCBc
CisJLm5hbWUgPSAiY291bnRfbW9kZSIsIFwKKwkuY291bnRfdTMyX3JlYWQgPSAoX3JlYWQpLCBc
CisJLmNvdW50X3UzMl93cml0ZSA9IChfd3JpdGUpLCBcCisJLnByaXYgPSAmKF9hdmFpbGFibGUp
LCBcCit9CisKKyNkZWZpbmUgQ09VTlRFUl9DT01QX0RJUkVDVElPTihfcmVhZCkgXAoreyBcCisJ
LnR5cGUgPSBDT1VOVEVSX0NPTVBfQ09VTlRfRElSRUNUSU9OLCBcCisJLm5hbWUgPSAiZGlyZWN0
aW9uIiwgXAorCS5jb3VudF91MzJfcmVhZCA9IChfcmVhZCksIFwKK30KKworI2RlZmluZSBDT1VO
VEVSX0NPTVBfRU5BQkxFKF9yZWFkLCBfd3JpdGUpIFwKKwlDT1VOVEVSX0NPTVBfQ09VTlRfQk9P
TCgiZW5hYmxlIiwgX3JlYWQsIF93cml0ZSkKKworI2RlZmluZSBDT1VOVEVSX0NPTVBfRkxPT1Io
X3JlYWQsIF93cml0ZSkgXAorCUNPVU5URVJfQ09NUF9DT1VOVF9VNjQoImZsb29yIiwgX3JlYWQs
IF93cml0ZSkKKworI2RlZmluZSBDT1VOVEVSX0NPTVBfUFJFU0VUKF9yZWFkLCBfd3JpdGUpIFwK
KwlDT1VOVEVSX0NPTVBfQ09VTlRfVTY0KCJwcmVzZXQiLCBfcmVhZCwgX3dyaXRlKQorCisjZGVm
aW5lIENPVU5URVJfQ09NUF9QUkVTRVRfRU5BQkxFKF9yZWFkLCBfd3JpdGUpIFwKKwlDT1VOVEVS
X0NPTVBfQ09VTlRfQk9PTCgicHJlc2V0X2VuYWJsZSIsIF9yZWFkLCBfd3JpdGUpCiAKICNlbmRp
ZiAvKiBfQ09VTlRFUl9IXyAqLwpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9jb3VudGVyX2Vu
dW0uaCBiL2luY2x1ZGUvbGludXgvY291bnRlcl9lbnVtLmgKZGVsZXRlZCBmaWxlIG1vZGUgMTAw
NjQ0CmluZGV4IDlmOTE3Mjk4YTg4Zi4uMDAwMDAwMDAwMDAwCi0tLSBhL2luY2x1ZGUvbGludXgv
Y291bnRlcl9lbnVtLmgKKysrIC9kZXYvbnVsbApAQCAtMSw0NSArMCwwIEBACi0vKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLwotLyoKLSAqIENvdW50ZXIgaW50ZXJmYWNlIGVu
dW0gZnVuY3Rpb25zCi0gKiBDb3B5cmlnaHQgKEMpIDIwMTggV2lsbGlhbSBCcmVhdGhpdHQgR3Jh
eQotICovCi0jaWZuZGVmIF9DT1VOVEVSX0VOVU1fSF8KLSNkZWZpbmUgX0NPVU5URVJfRU5VTV9I
XwotCi0jaW5jbHVkZSA8bGludXgvdHlwZXMuaD4KLQotc3RydWN0IGNvdW50ZXJfZGV2aWNlOwot
c3RydWN0IGNvdW50ZXJfc2lnbmFsOwotc3RydWN0IGNvdW50ZXJfY291bnQ7Ci0KLXNzaXplX3Qg
Y291bnRlcl9zaWduYWxfZW51bV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291bnRlciwK
LQkJCQkgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWwsIHZvaWQgKnByaXYsCi0JCQkJIGNo
YXIgKmJ1Zik7Ci1zc2l6ZV90IGNvdW50ZXJfc2lnbmFsX2VudW1fd3JpdGUoc3RydWN0IGNvdW50
ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCSAgc3RydWN0IGNvdW50ZXJfc2lnbmFsICpzaWduYWws
IHZvaWQgKnByaXYsCi0JCQkJICBjb25zdCBjaGFyICpidWYsIHNpemVfdCBsZW4pOwotCi1zc2l6
ZV90IGNvdW50ZXJfc2lnbmFsX2VudW1fYXZhaWxhYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2
aWNlICpjb3VudGVyLAotCQkJCQkgICBzdHJ1Y3QgY291bnRlcl9zaWduYWwgKnNpZ25hbCwKLQkJ
CQkJICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKTsKLQotc3NpemVfdCBjb3VudGVyX2NvdW50X2Vu
dW1fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0JCQkJc3RydWN0IGNvdW50
ZXJfY291bnQgKmNvdW50LCB2b2lkICpwcml2LAotCQkJCWNoYXIgKmJ1Zik7Ci1zc2l6ZV90IGNv
dW50ZXJfY291bnRfZW51bV93cml0ZShzdHJ1Y3QgY291bnRlcl9kZXZpY2UgKmNvdW50ZXIsCi0J
CQkJIHN0cnVjdCBjb3VudGVyX2NvdW50ICpjb3VudCwgdm9pZCAqcHJpdiwKLQkJCQkgY29uc3Qg
Y2hhciAqYnVmLCBzaXplX3QgbGVuKTsKLQotc3NpemVfdCBjb3VudGVyX2NvdW50X2VudW1fYXZh
aWxhYmxlX3JlYWQoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLAotCQkJCQkgIHN0cnVj
dCBjb3VudGVyX2NvdW50ICpjb3VudCwKLQkJCQkJICB2b2lkICpwcml2LCBjaGFyICpidWYpOwot
Ci1zc2l6ZV90IGNvdW50ZXJfZGV2aWNlX2VudW1fcmVhZChzdHJ1Y3QgY291bnRlcl9kZXZpY2Ug
KmNvdW50ZXIsIHZvaWQgKnByaXYsCi0JCQkJIGNoYXIgKmJ1Zik7Ci1zc2l6ZV90IGNvdW50ZXJf
ZGV2aWNlX2VudW1fd3JpdGUoc3RydWN0IGNvdW50ZXJfZGV2aWNlICpjb3VudGVyLCB2b2lkICpw
cml2LAotCQkJCSAgY29uc3QgY2hhciAqYnVmLCBzaXplX3QgbGVuKTsKLQotc3NpemVfdCBjb3Vu
dGVyX2RldmljZV9lbnVtX2F2YWlsYWJsZV9yZWFkKHN0cnVjdCBjb3VudGVyX2RldmljZSAqY291
bnRlciwKLQkJCQkJICAgdm9pZCAqcHJpdiwgY2hhciAqYnVmKTsKLQotI2VuZGlmIC8qIF9DT1VO
VEVSX0VOVU1fSF8gKi8KLS0gCjIuMzIuMAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX18KTGludXgtc3RtMzIgbWFpbGluZyBsaXN0CkxpbnV4LXN0bTMyQHN0
LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5jb20KaHR0cHM6Ly9zdC1tZC1tYWlsbWFuLnN0b3JtcmVw
bHkuY29tL21haWxtYW4vbGlzdGluZm8vbGludXgtc3RtMzIK
