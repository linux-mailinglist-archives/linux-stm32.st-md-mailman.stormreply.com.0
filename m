Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 01D4D9073F0
	for <lists+linux-stm32@lfdr.de>; Thu, 13 Jun 2024 15:39:42 +0200 (CEST)
Received: from ip-172-31-3-47.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 9BD29C712A1;
	Thu, 13 Jun 2024 13:39:41 +0000 (UTC)
Received: from mail-qt1-f178.google.com (mail-qt1-f178.google.com
 [209.85.160.178])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id D95B5C71290
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Thu, 13 Jun 2024 13:39:33 +0000 (UTC)
Received: by mail-qt1-f178.google.com with SMTP id
 d75a77b69052e-440556a5cbdso7017261cf.0
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Thu, 13 Jun 2024 06:39:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=baylibre-com.20230601.gappssmtp.com; s=20230601; t=1718285973; x=1718890773;
 darn=st-md-mailman.stormreply.com; 
 h=content-transfer-encoding:mime-version:message-id:date:subject:cc
 :to:from:from:to:cc:subject:date:message-id:reply-to;
 bh=5OJMzoxi38g+YNP8jHjxqEC8F9xFdkI1SKEce/3tu5A=;
 b=ah1ctyxUdSScZTJ+2e/edJoAC/oduni5N/fji9ERv2dag6f9BKPMlVnIJ1vHmwmvB+
 uCHvsT6M8WqXMRo0EIDoGzoiNOc730U111thdAIMcXw81bSFVH7P0rwMid7kgDw4CeNM
 dETxcaEPPqTDPl2YF2TNIbPvEw/eabZypjNLcOz1m87MC5cd6Eqfw8DU5XeMRCsOa6X4
 J3NzJuyCdqLgTlxR16hupLeX3EaFKFg0qcsN/2woIYMmNVetYQjkl4L6tXocZC5pdas2
 uAMZP0U0Kzcl6xO/42N8CVhlM+IeicluWqOFbelrN7LwQb4WAe4XISB4pagK96c96Nvs
 cYjw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1718285973; x=1718890773;
 h=content-transfer-encoding:mime-version:message-id:date:subject:cc
 :to:from:x-gm-message-state:from:to:cc:subject:date:message-id
 :reply-to;
 bh=5OJMzoxi38g+YNP8jHjxqEC8F9xFdkI1SKEce/3tu5A=;
 b=iO+mT+J0Rd+yawzZ/Wpv7jP8KurH81GnaFDzVsfQeftN2IvYl4rhbBV6kmRtMQHY0G
 O4PiywF0E+uSDUURetaUS3p68iitGh43FIS9TZjhFc0aziPB6emCH+7/7SZ82c6NXose
 USb+6Mhx9Mg6AOHMLQEHXVU6jTsb3Ze+SjROjfPZhVr9h3pNF7TmzxYoZysKg7Ss4+dN
 2LMddAb2QHtAUhF1iUGW4rsmpG5lnAN5GJt7WNAndSMgDD9UqkYQ6vZx1WiFcoe9XAt3
 pFLMrFNzLuC4GlG3+TUnhphQh3CCC01OdePEPTo5Za02ilxC1nIDcVILpjdS0ZL8zGNL
 ZGQQ==
X-Forwarded-Encrypted: i=1;
 AJvYcCWk6ymnt6Kz9IAEb5nDhjSgB5eoyx7zx2eB8E8X7bRnW/F0t8iDlKjkbuYYOKI82PbS+LA9W7z1O0zGz3RKKqi4vYjLzb8PIRu8/ksdL/xSUEMhl3X3zCJ8
X-Gm-Message-State: AOJu0YxQNOfWrf2Fj34dChoK2kkCco3RwJAkc8bNh+ZIUB9eKsKV+NYr
 RoWhrCkaCo3B16whGThJfticXSSUK/lBx7ZLvJUZDMJ5yoJwGrk3p3K7s9bwo8w=
X-Google-Smtp-Source: AGHT+IGAX7MY/JeXE6ECrB5TzNpxVgRDig6GrdeJjtFvUzJp2vHja8Rh7Yclfe6fsnZCVLdkYFVszA==
X-Received: by 2002:ac8:5841:0:b0:441:5629:86c with SMTP id
 d75a77b69052e-4415abccb52mr50658651cf.9.1718285972042; 
 Thu, 13 Jun 2024 06:39:32 -0700 (PDT)
Received: from megalith.oryx-coho.ts.net (d24-150-219-207.home.cgocable.net.
 [24.150.219.207]) by smtp.gmail.com with ESMTPSA id
 d75a77b69052e-44213eb4b53sm1772961cf.42.2024.06.13.06.39.29
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 13 Jun 2024 06:39:31 -0700 (PDT)
From: Trevor Gamblin <tgamblin@baylibre.com>
To: Lucas Stankus <lucas.p.stankus@gmail.com>,
 Lars-Peter Clausen <lars@metafoo.de>,
 Michael Hennerich <Michael.Hennerich@analog.com>,
 Jonathan Cameron <jic23@kernel.org>,
 Dmitry Rokosov <ddrokosov@sberdevices.ru>,
 Cosmin Tanislav <cosmin.tanislav@analog.com>, Chen-Yu Tsai <wens@csie.org>,
 Hans de Goede <hdegoede@redhat.com>, Ray Jui <rjui@broadcom.com>,
 Scott Branden <sbranden@broadcom.com>,
 Broadcom internal kernel review list <bcm-kernel-feedback-list@broadcom.com>, 
 Shawn Guo <shawnguo@kernel.org>, Sascha Hauer <s.hauer@pengutronix.de>,
 Pengutronix Kernel Team <kernel@pengutronix.de>,
 Fabio Estevam <festevam@gmail.com>,
 Neil Armstrong <neil.armstrong@linaro.org>,
 Kevin Hilman <khilman@baylibre.com>, Jerome Brunet <jbrunet@baylibre.com>,
 Martin Blumenstingl <martin.blumenstingl@googlemail.com>,
 Saravanan Sekar <sravanhome@gmail.com>, Orson Zhai <orsonzhai@gmail.com>,
 Baolin Wang <baolin.wang@linux.alibaba.com>,
 Chunyan Zhang <zhang.lyra@gmail.com>,
 Maxime Coquelin <mcoquelin.stm32@gmail.com>,
 Alexandre Torgue <alexandre.torgue@foss.st.com>,
 =?UTF-8?q?Nuno=20S=C3=A1?= <nuno.sa@analog.com>,
 Linus Walleij <linus.walleij@linaro.org>,
 Jean-Baptiste Maneyrol <jmaneyrol@invensense.com>,
 Crt Mori <cmo@melexis.com>
Date: Thu, 13 Jun 2024 09:39:19 -0400
Message-ID: <20240613133927.3851344-1-tgamblin@baylibre.com>
X-Mailer: git-send-email 2.45.2
MIME-Version: 1.0
Cc: Trevor Gamblin <tgamblin@baylibre.com>, imx@lists.linux.dev,
 linux-iio@vger.kernel.org, linux-arm-msm@vger.kernel.org,
 linux-kernel@vger.kernel.org,
 =?UTF-8?q?Uwe=20Kleine-K=C3=B6nig?= <u.kleine-koenig@baylibre.com>,
 linux-amlogic@lists.infradead.org, linux-stm32@st-md-mailman.stormreply.com,
 linux-arm-kernel@lists.infradead.org
Subject: [Linux-stm32] [PATCH v2] iio: simplify with regmap_set_bits(),
	regmap_clear_bits()
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

U2ltcGxpZnkgdGhlIHdheSByZWdtYXAgaXMgYWNjZXNzZWQgaW4gaWlvIGRyaXZlcnMuCgpJbnN0
ZWFkIG9mIHVzaW5nIHJlZ21hcF91cGRhdGVfYml0cygpIGFuZCBwYXNzaW5nIHRoZSBtYXNrIHR3
aWNlLCB1c2UKcmVnbWFwX3NldF9iaXRzKCkuCgpJbnN0ZWFkIG9mIHVzaW5nIHJlZ21hcF91cGRh
dGVfYml0cygpIGFuZCBwYXNzaW5nIHZhbCA9IDAsIHVzZQpyZWdtYXBfY2xlYXJfYml0cygpLgoK
U3VnZ2VzdGVkLWJ5OiBVd2UgS2xlaW5lLUvDtm5pZyA8dS5rbGVpbmUta29lbmlnQGJheWxpYnJl
LmNvbT4KQWNrZWQtYnk6IFV3ZSBLbGVpbmUtS8O2bmlnIDx1LmtsZWluZS1rb2VuaWdAYmF5bGli
cmUuY29tPgpBY2tlZC1ieTogQ3J0IE1vcmkgPGNtb0BtZWxleGlzLmNvbT4KUmV2aWV3ZWQtYnk6
IExpbnVzIFdhbGxlaWogPGxpbnVzLndhbGxlaWpAbGluYXJvLm9yZz4KUmV2aWV3ZWQtYnk6IEJh
b2xpbiBXYW5nIDxiYW9saW4ud2FuZ0BsaW51eC5hbGliYWJhLmNvbT4KU2lnbmVkLW9mZi1ieTog
VHJldm9yIEdhbWJsaW4gPHRnYW1ibGluQGJheWxpYnJlLmNvbT4KLS0tCnYyIGNoYW5nZXM6Ciog
QWRkcmVzcyBmZWVkYmFjayBmb3IgZHJpdmVyIGluIHYxOgogICogRml4IHN0eWxpbmcgaXNzdWVz
IHRvIGJlIHVuZGVyIDgwLWNoYXJhY3RlciBsaW5lIGxlbmd0aCBsaW1pdCwKICByZXBsYWNlIGV4
dHJhIHNwYWNlcyB3aXRoIHRhYnMKKiBBbHNvIGFkZCB0cmFpbGVyIGZyb20gcmV2aWV3cyBvZiB0
aGUgaW5pdGlhbCBjb3B5IG9mIHYxLCB3aGljaCBkaWRuJ3QKICBoYXZlIGFsbCBvZiB0aGUgcHJv
cGVyIENDcyBpbmNsdWRlZAotLS0KIGRyaXZlcnMvaWlvL2FjY2VsL2FkeGwzMTNfY29yZS5jICAg
ICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9paW8vYWNjZWwvYWR4bDMxM19zcGkuYyAgICAg
ICAgICAgICAgIHwgICA0ICstCiBkcml2ZXJzL2lpby9hY2NlbC9meGxzODk2MmFmLWNvcmUuYyAg
ICAgICAgICAgfCAgMTggKystLQogZHJpdmVycy9paW8vYWNjZWwva3hzZDkuYyAgICAgICAgICAg
ICAgICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2lpby9hY2NlbC9tc2EzMTEuYyAgICAgICAgICAg
ICAgICAgICAgfCAgIDggKy0KIGRyaXZlcnMvaWlvL2FkYy9hZDQxMzAuYyAgICAgICAgICAgICAg
ICAgICAgICB8ICAgNCArLQogZHJpdmVycy9paW8vYWRjL2F4cDIweF9hZGMuYyAgICAgICAgICAg
ICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2lpby9hZGMvYXhwMjg4X2FkYy5jICAgICAgICAgICAg
ICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvaWlvL2FkYy9iY21faXByb2NfYWRjLmMgICAgICAgICAg
ICAgICB8ICAgOCArLQogZHJpdmVycy9paW8vYWRjL2JlcmxpbjItYWRjLmMgICAgICAgICAgICAg
ICAgIHwgIDI0ICsrLS0tCiBkcml2ZXJzL2lpby9hZGMvY3BjYXAtYWRjLmMgICAgICAgICAgICAg
ICAgICAgfCAgNDYgKysrKy0tLS0KIGRyaXZlcnMvaWlvL2FkYy9mc2wtaW14MjUtZ2NxLmMgICAg
ICAgICAgICAgICB8ICAxNiArKy0KIGRyaXZlcnMvaWlvL2FkYy9pbmEyeHgtYWRjLmMgICAgICAg
ICAgICAgICAgICB8ICAgMyArLQogZHJpdmVycy9paW8vYWRjL2ludGVsX21yZmxkX2FkYy5jICAg
ICAgICAgICAgIHwgICA0ICstCiBkcml2ZXJzL2lpby9hZGMvbWVzb25fc2FyYWRjLmMgICAgICAg
ICAgICAgICAgfCAxMDEgKysrKysrKystLS0tLS0tLS0tCiBkcml2ZXJzL2lpby9hZGMvbXAyNjI5
X2FkYy5jICAgICAgICAgICAgICAgICAgfCAgMTkgKystLQogZHJpdmVycy9paW8vYWRjL3Fjb20t
c3BtaS1ycmFkYy5jICAgICAgICAgICAgIHwgIDUwICsrKysrLS0tLQogZHJpdmVycy9paW8vYWRj
L3JuNXQ2MTgtYWRjLmMgICAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2lpby9hZGMv
c2MyN3h4X2FkYy5jICAgICAgICAgICAgICAgICAgfCAgNDEgKysrKy0tLQogZHJpdmVycy9paW8v
YWRjL3N0bTMyLWRmc2RtLWFkYy5jICAgICAgICAgICAgIHwgIDI5ICsrKy0tCiBkcml2ZXJzL2lp
by9kYWMvbHRjMjY4OC5jICAgICAgICAgICAgICAgICAgICAgfCAgIDUgKy0KIGRyaXZlcnMvaWlv
L2RhYy9zdG0zMi1kYWMtY29yZS5jICAgICAgICAgICAgICB8ICAgNSArLQogZHJpdmVycy9paW8v
Z3lyby9ibWcxNjBfY29yZS5jICAgICAgICAgICAgICAgIHwgICA0ICstCiBkcml2ZXJzL2lpby9n
eXJvL21wdTMwNTAtY29yZS5jICAgICAgICAgICAgICAgfCAgMzMgKysrLS0tCiBkcml2ZXJzL2lp
by9oZWFsdGgvYWZlNDQwMy5jICAgICAgICAgICAgICAgICAgfCAgIDkgKy0KIGRyaXZlcnMvaWlv
L2hlYWx0aC9hZmU0NDA0LmMgICAgICAgICAgICAgICAgICB8ICAgOSArLQogZHJpdmVycy9paW8v
aGVhbHRoL21heDMwMTAwLmMgICAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2lpby9o
ZWFsdGgvbWF4MzAxMDIuYyAgICAgICAgICAgICAgICAgfCAgIDUgKy0KIC4uLi9pbXUvaW52X2lj
bTQyNjAwL2ludl9pY200MjYwMF9idWZmZXIuYyAgICB8ICAxNCArKy0KIC4uLi9paW8vaW11L2lu
dl9pY200MjYwMC9pbnZfaWNtNDI2MDBfY29yZS5jICB8ICAgOSArLQogLi4uL2lpby9pbXUvaW52
X2ljbTQyNjAwL2ludl9pY200MjYwMF9pMmMuYyAgIHwgICA0ICstCiAuLi4vaWlvL2ltdS9pbnZf
aWNtNDI2MDAvaW52X2ljbTQyNjAwX3NwaS5jICAgfCAgIDQgKy0KIGRyaXZlcnMvaWlvL2xpZ2h0
L2FkdXgxMDIwLmMgICAgICAgICAgICAgICAgICB8ICAxMyArKy0KIGRyaXZlcnMvaWlvL2xpZ2h0
L2lxczYyMS1hbHMuYyAgICAgICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9paW8vbGlnaHQv
aXNsMjkwMTguYyAgICAgICAgICAgICAgICAgIHwgICA2ICstCiBkcml2ZXJzL2lpby9saWdodC9z
dF91dmlzMjVfY29yZS5jICAgICAgICAgICAgfCAgIDQgKy0KIGRyaXZlcnMvaWlvL2xpZ2h0L3Zl
bWw2MDMwLmMgICAgICAgICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9paW8vbWFnbmV0b21l
dGVyL2FrODk3NC5jICAgICAgICAgICAgIHwgIDExICstCiBkcml2ZXJzL2lpby9tYWduZXRvbWV0
ZXIvbW1jMzUyNDAuYyAgICAgICAgICAgfCAgIDggKy0KIGRyaXZlcnMvaWlvL3ByZXNzdXJlL2Jt
cDI4MC1jb3JlLmMgICAgICAgICAgICB8ICAgNCArLQogZHJpdmVycy9paW8vcHJveGltaXR5L3N4
OTMyNC5jICAgICAgICAgICAgICAgIHwgICA1ICstCiBkcml2ZXJzL2lpby9wcm94aW1pdHkvc3g5
MzYwLmMgICAgICAgICAgICAgICAgfCAgIDUgKy0KIGRyaXZlcnMvaWlvL3Byb3hpbWl0eS9zeDk1
MDAuYyAgICAgICAgICAgICAgICB8ICAxMiArLS0KIGRyaXZlcnMvaWlvL3Byb3hpbWl0eS9zeF9j
b21tb24uYyAgICAgICAgICAgICB8ICAgOSArLQogZHJpdmVycy9paW8vdGVtcGVyYXR1cmUvbWx4
OTA2MzIuYyAgICAgICAgICAgIHwgICA0ICstCiBkcml2ZXJzL2lpby90cmlnZ2VyL3N0bTMyLXRp
bWVyLXRyaWdnZXIuYyAgICAgfCAgMzQgKysrLS0tCiA0NiBmaWxlcyBjaGFuZ2VkLCAyNzcgaW5z
ZXJ0aW9ucygrKSwgMzUxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlvL2Fj
Y2VsL2FkeGwzMTNfY29yZS5jIGIvZHJpdmVycy9paW8vYWNjZWwvYWR4bDMxM19jb3JlLmMKaW5k
ZXggNGRlMGE0MWJkNjc5Li4xZGFkM2E4ZDBjMjkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2Fj
Y2VsL2FkeGwzMTNfY29yZS5jCisrKyBiL2RyaXZlcnMvaWlvL2FjY2VsL2FkeGwzMTNfY29yZS5j
CkBAIC0zNjIsOCArMzYyLDggQEAgc3RhdGljIGludCBhZHhsMzEzX3NldHVwKHN0cnVjdCBkZXZp
Y2UgKmRldiwgc3RydWN0IGFkeGwzMTNfZGF0YSAqZGF0YSwKIAkJCXJldHVybiByZXQ7CiAKIAkJ
LyogRW5hYmxlcyBmdWxsIHJlc29sdXRpb24gKi8KLQkJcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRz
KGRhdGEtPnJlZ21hcCwgQURYTDMxM19SRUdfREFUQV9GT1JNQVQsCi0JCQkJCSBBRFhMMzEzX0ZV
TExfUkVTLCBBRFhMMzEzX0ZVTExfUkVTKTsKKwkJcmV0ID0gcmVnbWFwX3NldF9iaXRzKGRhdGEt
PnJlZ21hcCwgQURYTDMxM19SRUdfREFUQV9GT1JNQVQsCisJCQkJICAgICAgQURYTDMxM19GVUxM
X1JFUyk7CiAJCWlmIChyZXQpCiAJCQlyZXR1cm4gcmV0OwogCX0KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvaWlvL2FjY2VsL2FkeGwzMTNfc3BpLmMgYi9kcml2ZXJzL2lpby9hY2NlbC9hZHhsMzEzX3Nw
aS5jCmluZGV4IGI3Y2MxNTY3OGEyYi4uOTdlYmU1NWFjYjJlIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2lpby9hY2NlbC9hZHhsMzEzX3NwaS5jCisrKyBiL2RyaXZlcnMvaWlvL2FjY2VsL2FkeGwzMTNf
c3BpLmMKQEAgLTU3LDggKzU3LDggQEAgc3RhdGljIGludCBhZHhsMzEzX3NwaV9zZXR1cChzdHJ1
Y3QgZGV2aWNlICpkZXYsIHN0cnVjdCByZWdtYXAgKnJlZ21hcCkKIAkJCXJldHVybiByZXQ7CiAJ
fQogCi0JcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0cyhyZWdtYXAsIEFEWEwzMTNfUkVHX1BPV0VS
X0NUTCwKLQkJCQkgIEFEWEwzMTNfSTJDX0RJU0FCTEUsIEFEWEwzMTNfSTJDX0RJU0FCTEUpOwor
CXJldHVybiByZWdtYXBfc2V0X2JpdHMocmVnbWFwLCBBRFhMMzEzX1JFR19QT1dFUl9DVEwsCisJ
CQkgICAgICAgQURYTDMxM19JMkNfRElTQUJMRSk7CiB9CiAKIHN0YXRpYyBpbnQgYWR4bDMxM19z
cGlfcHJvYmUoc3RydWN0IHNwaV9kZXZpY2UgKnNwaSkKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlv
L2FjY2VsL2Z4bHM4OTYyYWYtY29yZS5jIGIvZHJpdmVycy9paW8vYWNjZWwvZnhsczg5NjJhZi1j
b3JlLmMKaW5kZXggNGZiYzAxYmRhNjJlLi5kMjVlMzE2MTM0MTMgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvaWlvL2FjY2VsL2Z4bHM4OTYyYWYtY29yZS5jCisrKyBiL2RyaXZlcnMvaWlvL2FjY2VsL2Z4
bHM4OTYyYWYtY29yZS5jCkBAIC0yMjgsOCArMjI4LDggQEAgc3RhdGljIGludCBmeGxzODk2MmFm
X3Bvd2VyX29mZihzdHJ1Y3QgZnhsczg5NjJhZl9kYXRhICpkYXRhKQogCiBzdGF0aWMgaW50IGZ4
bHM4OTYyYWZfc3RhbmRieShzdHJ1Y3QgZnhsczg5NjJhZl9kYXRhICpkYXRhKQogewotCXJldHVy
biByZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBGWExTODk2MkFGX1NFTlNfQ09ORklH
MSwKLQkJCQkgIEZYTFM4OTYyQUZfU0VOU19DT05GSUcxX0FDVElWRSwgMCk7CisJcmV0dXJuIHJl
Z21hcF9jbGVhcl9iaXRzKGRhdGEtPnJlZ21hcCwgRlhMUzg5NjJBRl9TRU5TX0NPTkZJRzEsCisJ
CQkJIEZYTFM4OTYyQUZfU0VOU19DT05GSUcxX0FDVElWRSk7CiB9CiAKIHN0YXRpYyBpbnQgZnhs
czg5NjJhZl9hY3RpdmUoc3RydWN0IGZ4bHM4OTYyYWZfZGF0YSAqZGF0YSkKQEAgLTc4NSw5ICs3
ODUsOCBAQCBzdGF0aWMgaW50IGZ4bHM4OTYyYWZfcmVzZXQoc3RydWN0IGZ4bHM4OTYyYWZfZGF0
YSAqZGF0YSkKIAl1bnNpZ25lZCBpbnQgcmVnOwogCWludCByZXQ7CiAKLQlyZXQgPSByZWdtYXBf
dXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBGWExTODk2MkFGX1NFTlNfQ09ORklHMSwKLQkJCQkg
RlhMUzg5NjJBRl9TRU5TX0NPTkZJRzFfUlNULAotCQkJCSBGWExTODk2MkFGX1NFTlNfQ09ORklH
MV9SU1QpOworCXJldCA9IHJlZ21hcF9zZXRfYml0cyhkYXRhLT5yZWdtYXAsIEZYTFM4OTYyQUZf
U0VOU19DT05GSUcxLAorCQkJICAgICAgRlhMUzg5NjJBRl9TRU5TX0NPTkZJRzFfUlNUKTsKIAlp
ZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC04MzAsOSArODI5LDggQEAgc3RhdGljIGludCBm
eGxzODk2MmFmX2J1ZmZlcl9wb3N0ZW5hYmxlKHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYpCiAJ
Znhsczg5NjJhZl9zdGFuZGJ5KGRhdGEpOwogCiAJLyogRW5hYmxlIGJ1ZmZlciBpbnRlcnJ1cHQg
Ki8KLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBGWExTODk2MkFGX0lO
VF9FTiwKLQkJCQkgRlhMUzg5NjJBRl9JTlRfRU5fQlVGX0VOLAotCQkJCSBGWExTODk2MkFGX0lO
VF9FTl9CVUZfRU4pOworCXJldCA9IHJlZ21hcF9zZXRfYml0cyhkYXRhLT5yZWdtYXAsIEZYTFM4
OTYyQUZfSU5UX0VOLAorCQkJICAgICAgRlhMUzg5NjJBRl9JTlRfRU5fQlVGX0VOKTsKIAlpZiAo
cmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC04NTEsOCArODQ5LDggQEAgc3RhdGljIGludCBmeGxz
ODk2MmFmX2J1ZmZlcl9wcmVkaXNhYmxlKHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYpCiAJZnhs
czg5NjJhZl9zdGFuZGJ5KGRhdGEpOwogCiAJLyogRGlzYWJsZSBidWZmZXIgaW50ZXJydXB0ICov
Ci0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgRlhMUzg5NjJBRl9JTlRf
RU4sCi0JCQkJIEZYTFM4OTYyQUZfSU5UX0VOX0JVRl9FTiwgMCk7CisJcmV0ID0gcmVnbWFwX2Ns
ZWFyX2JpdHMoZGF0YS0+cmVnbWFwLCBGWExTODk2MkFGX0lOVF9FTiwKKwkJCQlGWExTODk2MkFG
X0lOVF9FTl9CVUZfRU4pOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvaWlvL2FjY2VsL2t4c2Q5LmMgYi9kcml2ZXJzL2lpby9hY2NlbC9reHNkOS5jCmlu
ZGV4IGJhOTk2NDlmZTE5NS4uMDNjZTAzMmUwNmZmIDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9h
Y2NlbC9reHNkOS5jCisrKyBiL2RyaXZlcnMvaWlvL2FjY2VsL2t4c2Q5LmMKQEAgLTM3MCwxMCAr
MzcwLDggQEAgc3RhdGljIGludCBreHNkOV9wb3dlcl9kb3duKHN0cnVjdCBreHNkOV9zdGF0ZSAq
c3QpCiAJICogbWFrZSBzdXJlIHdlIGNvbnNlcnZlIHBvd2VyIGV2ZW4gaWYgdGhlcmUgYXJlIG90
aGVycyB1c2VycyBvbiB0aGUKIAkgKiByZWd1bGF0b3JzLgogCSAqLwotCXJldCA9IHJlZ21hcF91
cGRhdGVfYml0cyhzdC0+bWFwLAotCQkJCSBLWFNEOV9SRUdfQ1RSTF9CLAotCQkJCSBLWFNEOV9D
VFJMX0JfRU5BQkxFLAotCQkJCSAwKTsKKwlyZXQgPSByZWdtYXBfY2xlYXJfYml0cyhzdC0+bWFw
LCBLWFNEOV9SRUdfQ1RSTF9CLAorCQkJCUtYU0Q5X0NUUkxfQl9FTkFCTEUpOwogCWlmIChyZXQp
CiAJCXJldHVybiByZXQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlvL2FjY2VsL21zYTMxMS5j
IGIvZHJpdmVycy9paW8vYWNjZWwvbXNhMzExLmMKaW5kZXggYjhkZGJmZDk4ZjExLi40Y2RiZjU0
MjRhNTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2FjY2VsL21zYTMxMS5jCisrKyBiL2RyaXZl
cnMvaWlvL2FjY2VsL21zYTMxMS5jCkBAIC0xMDM0LDEwICsxMDM0LDEwIEBAIHN0YXRpYyBpbnQg
bXNhMzExX2NoaXBfaW5pdChzdHJ1Y3QgbXNhMzExX3ByaXYgKm1zYTMxMSkKIAkJCQkgICAgICJm
YWlsZWQgdG8gdW5tYXAgbWFwMC9tYXAxIGludGVycnVwdHNcbiIpOwogCiAJLyogRGlzYWJsZSBh
bGwgYXhlcyBieSBkZWZhdWx0ICovCi0JZXJyID0gcmVnbWFwX3VwZGF0ZV9iaXRzKG1zYTMxMS0+
cmVncywgTVNBMzExX09EUl9SRUcsCi0JCQkJIE1TQTMxMV9HRU5NQVNLKEZfWF9BWElTX0RJUykg
fAotCQkJCSBNU0EzMTFfR0VOTUFTSyhGX1lfQVhJU19ESVMpIHwKLQkJCQkgTVNBMzExX0dFTk1B
U0soRl9aX0FYSVNfRElTKSwgMCk7CisJZXJyID0gcmVnbWFwX2NsZWFyX2JpdHMobXNhMzExLT5y
ZWdzLCBNU0EzMTFfT0RSX1JFRywKKwkJCQlNU0EzMTFfR0VOTUFTSyhGX1hfQVhJU19ESVMpIHwK
KwkJCQlNU0EzMTFfR0VOTUFTSyhGX1lfQVhJU19ESVMpIHwKKwkJCQlNU0EzMTFfR0VOTUFTSyhG
X1pfQVhJU19ESVMpKTsKIAlpZiAoZXJyKQogCQlyZXR1cm4gZGV2X2Vycl9wcm9iZShkZXYsIGVy
ciwgImNhbid0IGVuYWJsZSBhbGwgYXhlc1xuIik7CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlv
L2FkYy9hZDQxMzAuYyBiL2RyaXZlcnMvaWlvL2FkYy9hZDQxMzAuYwppbmRleCBhYWYxZmIwYWM0
NDcuLmUxMzRkNjQ5NzgyNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vYWRjL2FkNDEzMC5jCisr
KyBiL2RyaXZlcnMvaWlvL2FkYy9hZDQxMzAuYwpAQCAtMTg4Myw4ICsxODgzLDggQEAgc3RhdGlj
IGludCBhZDQxMzBfc2V0dXAoc3RydWN0IGlpb19kZXYgKmluZGlvX2RldikKIAlpZiAocmV0KQog
CQlyZXR1cm4gcmV0OwogCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHN0LT5yZWdtYXAsIEFE
NDEzMF9GSUZPX0NPTlRST0xfUkVHLAotCQkJCSBBRDQxMzBfRklGT19DT05UUk9MX0hFQURFUl9N
QVNLLCAwKTsKKwlyZXQgPSByZWdtYXBfY2xlYXJfYml0cyhzdC0+cmVnbWFwLCBBRDQxMzBfRklG
T19DT05UUk9MX1JFRywKKwkJCQlBRDQxMzBfRklGT19DT05UUk9MX0hFQURFUl9NQVNLKTsKIAlp
ZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9hZGMvYXhw
MjB4X2FkYy5jIGIvZHJpdmVycy9paW8vYWRjL2F4cDIweF9hZGMuYwppbmRleCBkNmM1MWIwZjQ4
ZTMuLjAwYzFhMDFjYWM2MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vYWRjL2F4cDIweF9hZGMu
YworKysgYi9kcml2ZXJzL2lpby9hZGMvYXhwMjB4X2FkYy5jCkBAIC03MTIsOSArNzEyLDggQEAg
c3RhdGljIGludCBheHAyMHhfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKIAly
ZWdtYXBfd3JpdGUoaW5mby0+cmVnbWFwLCBBWFAyMFhfQURDX0VOMSwgaW5mby0+ZGF0YS0+YWRj
X2VuMV9tYXNrKTsKIAogCWlmIChpbmZvLT5kYXRhLT5hZGNfZW4yX21hc2spCi0JCXJlZ21hcF91
cGRhdGVfYml0cyhpbmZvLT5yZWdtYXAsIEFYUDIwWF9BRENfRU4yLAotCQkJCSAgIGluZm8tPmRh
dGEtPmFkY19lbjJfbWFzaywKLQkJCQkgICBpbmZvLT5kYXRhLT5hZGNfZW4yX21hc2spOworCQly
ZWdtYXBfc2V0X2JpdHMoaW5mby0+cmVnbWFwLCBBWFAyMFhfQURDX0VOMiwKKwkJCQlpbmZvLT5k
YXRhLT5hZGNfZW4yX21hc2spOwogCiAJLyogQ29uZmlndXJlIEFEQ3MgcmF0ZSAqLwogCWluZm8t
PmRhdGEtPmFkY19yYXRlKGluZm8sIDEwMCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9hZGMv
YXhwMjg4X2FkYy5jIGIvZHJpdmVycy9paW8vYWRjL2F4cDI4OF9hZGMuYwppbmRleCA0OWZmZjFj
YWJkMGQuLmYxMzVjZjIzNjJkZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vYWRjL2F4cDI4OF9h
ZGMuYworKysgYi9kcml2ZXJzL2lpby9hZGMvYXhwMjg4X2FkYy5jCkBAIC0yNDcsOCArMjQ3LDgg
QEAgc3RhdGljIGludCBheHAyODhfYWRjX2luaXRpYWxpemUoc3RydWN0IGF4cDI4OF9hZGNfaW5m
byAqaW5mbykKIAkJcmV0dXJuIHJldDsKIAogCS8qIFR1cm4gb24gdGhlIEFEQyBmb3IgYWxsIGNo
YW5uZWxzIGV4Y2VwdCBUUywgbGVhdmUgVFMgYXMgaXMgKi8KLQlyZXR1cm4gcmVnbWFwX3VwZGF0
ZV9iaXRzKGluZm8tPnJlZ21hcCwgQVhQMjBYX0FEQ19FTjEsCi0JCQkJICBBWFAyODhfQURDX0VO
X01BU0ssIEFYUDI4OF9BRENfRU5fTUFTSyk7CisJcmV0dXJuIHJlZ21hcF9zZXRfYml0cyhpbmZv
LT5yZWdtYXAsIEFYUDIwWF9BRENfRU4xLAorCQkJICAgICAgIEFYUDI4OF9BRENfRU5fTUFTSyk7
CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3QgaWlvX2luZm8gYXhwMjg4X2FkY19paW9faW5mbyA9
IHsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlvL2FkYy9iY21faXByb2NfYWRjLmMgYi9kcml2ZXJz
L2lpby9hZGMvYmNtX2lwcm9jX2FkYy5jCmluZGV4IDViYzUxNGJkNWViYy4uNmJjMTQ5YzUxNDE0
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9hZGMvYmNtX2lwcm9jX2FkYy5jCisrKyBiL2RyaXZl
cnMvaWlvL2FkYy9iY21faXByb2NfYWRjLmMKQEAgLTM1Nyw4ICszNTcsOCBAQCBzdGF0aWMgaW50
IGlwcm9jX2FkY19lbmFibGUoc3RydWN0IGlpb19kZXYgKmluZGlvX2RldikKIAlpbnQgcmV0Owog
CiAJLyogU2V0IGlfYW11eCA9IDNiJzAwMCwgc2VsZWN0IGNoYW5uZWwgMCAqLwotCXJldCA9IHJl
Z21hcF91cGRhdGVfYml0cyhhZGNfcHJpdi0+cmVnbWFwLCBJUFJPQ19BTkFMT0dfQ09OVFJPTCwK
LQkJCQlJUFJPQ19BRENfQ0hBTk5FTF9TRUxfTUFTSywgMCk7CisJcmV0ID0gcmVnbWFwX2NsZWFy
X2JpdHMoYWRjX3ByaXYtPnJlZ21hcCwgSVBST0NfQU5BTE9HX0NPTlRST0wsCisJCQkJSVBST0Nf
QURDX0NIQU5ORUxfU0VMX01BU0spOwogCWlmIChyZXQpIHsKIAkJZGV2X2VycigmaW5kaW9fZGV2
LT5kZXYsCiAJCQkiZmFpbGVkIHRvIHdyaXRlIElQUk9DX0FOQUxPR19DT05UUk9MICVkXG4iLCBy
ZXQpOwpAQCAtNTQzLDggKzU0Myw4IEBAIHN0YXRpYyBpbnQgaXByb2NfYWRjX3Byb2JlKHN0cnVj
dCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCiAJaWYgKGFkY19wcml2LT5pcnFubyA8IDApCiAJCXJl
dHVybiBhZGNfcHJpdi0+aXJxbm87CiAKLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoYWRjX3By
aXYtPnJlZ21hcCwgSVBST0NfUkVHQ1RMMiwKLQkJCQlJUFJPQ19BRENfQVVYSU5fU0NBTl9FTkEs
IDApOworCXJldCA9IHJlZ21hcF9jbGVhcl9iaXRzKGFkY19wcml2LT5yZWdtYXAsIElQUk9DX1JF
R0NUTDIsCisJCQkJSVBST0NfQURDX0FVWElOX1NDQU5fRU5BKTsKIAlpZiAocmV0KSB7CiAJCWRl
dl9lcnIoJnBkZXYtPmRldiwgImZhaWxlZCB0byB3cml0ZSBJUFJPQ19SRUdDVEwyICVkXG4iLCBy
ZXQpOwogCQlyZXR1cm4gcmV0OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vYWRjL2JlcmxpbjIt
YWRjLmMgYi9kcml2ZXJzL2lpby9hZGMvYmVybGluMi1hZGMuYwppbmRleCBhNGU3YzdlZmY1YWMu
LjRjZGRkYzZlMzZlOSAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vYWRjL2JlcmxpbjItYWRjLmMK
KysrIGIvZHJpdmVycy9paW8vYWRjL2JlcmxpbjItYWRjLmMKQEAgLTEyOSw4ICsxMjksOCBAQCBz
dGF0aWMgaW50IGJlcmxpbjJfYWRjX3JlYWQoc3RydWN0IGlpb19kZXYgKmluZGlvX2RldiwgaW50
IGNoYW5uZWwpCiAJCQkJCSAgICAgICBtc2Vjc190b19qaWZmaWVzKDEwMDApKTsKIAogCS8qIERp
c2FibGUgdGhlIGludGVycnVwdHMgKi8KLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFw
LCBCRVJMSU4yX1NNX0FEQ19TVEFUVVMsCi0JCQkgICBCRVJMSU4yX1NNX0FEQ19TVEFUVVNfSU5U
X0VOKGNoYW5uZWwpLCAwKTsKKwlyZWdtYXBfY2xlYXJfYml0cyhwcml2LT5yZWdtYXAsIEJFUkxJ
TjJfU01fQURDX1NUQVRVUywKKwkJCSAgQkVSTElOMl9TTV9BRENfU1RBVFVTX0lOVF9FTihjaGFu
bmVsKSk7CiAKIAlpZiAocmV0ID09IDApCiAJCXJldCA9IC1FVElNRURPVVQ7CkBAIC0xMzksOCAr
MTM5LDggQEAgc3RhdGljIGludCBiZXJsaW4yX2FkY19yZWFkKHN0cnVjdCBpaW9fZGV2ICppbmRp
b19kZXYsIGludCBjaGFubmVsKQogCQlyZXR1cm4gcmV0OwogCX0KIAotCXJlZ21hcF91cGRhdGVf
Yml0cyhwcml2LT5yZWdtYXAsIEJFUkxJTjJfU01fQ1RSTCwKLQkJCSAgIEJFUkxJTjJfU01fQ1RS
TF9BRENfU1RBUlQsIDApOworCXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgQkVSTElO
Ml9TTV9DVFJMLAorCQkJICBCRVJMSU4yX1NNX0NUUkxfQURDX1NUQVJUKTsKIAogCWRhdGEgPSBw
cml2LT5kYXRhOwogCXByaXYtPmRhdGFfYXZhaWxhYmxlID0gZmFsc2U7CkBAIC0xODAsOCArMTgw
LDggQEAgc3RhdGljIGludCBiZXJsaW4yX2FkY190c2VuX3JlYWQoc3RydWN0IGlpb19kZXYgKmlu
ZGlvX2RldikKIAkJCQkJICAgICAgIG1zZWNzX3RvX2ppZmZpZXMoMTAwMCkpOwogCiAJLyogRGlz
YWJsZSBpbnRlcnJ1cHRzICovCi0JcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgQkVS
TElOMl9TTV9UU0VOX1NUQVRVUywKLQkJCSAgIEJFUkxJTjJfU01fVFNFTl9TVEFUVVNfSU5UX0VO
LCAwKTsKKwlyZWdtYXBfY2xlYXJfYml0cyhwcml2LT5yZWdtYXAsIEJFUkxJTjJfU01fVFNFTl9T
VEFUVVMsCisJCQkgIEJFUkxJTjJfU01fVFNFTl9TVEFUVVNfSU5UX0VOKTsKIAogCWlmIChyZXQg
PT0gMCkKIAkJcmV0ID0gLUVUSU1FRE9VVDsKQEAgLTE5MCw4ICsxOTAsOCBAQCBzdGF0aWMgaW50
IGJlcmxpbjJfYWRjX3RzZW5fcmVhZChzdHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2KQogCQlyZXR1
cm4gcmV0OwogCX0KIAotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIEJFUkxJTjJf
U01fVFNFTl9DVFJMLAotCQkJICAgQkVSTElOMl9TTV9UU0VOX0NUUkxfU1RBUlQsIDApOworCXJl
Z21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgQkVSTElOMl9TTV9UU0VOX0NUUkwsCisJCQkg
IEJFUkxJTjJfU01fVFNFTl9DVFJMX1NUQVJUKTsKIAogCWRhdGEgPSBwcml2LT5kYXRhOwogCXBy
aXYtPmRhdGFfYXZhaWxhYmxlID0gZmFsc2U7CkBAIC0yODQsOCArMjg0LDcgQEAgc3RhdGljIGNv
bnN0IHN0cnVjdCBpaW9faW5mbyBiZXJsaW4yX2FkY19pbmZvID0gewogCiBzdGF0aWMgdm9pZCBi
ZXJsaW4yX2FkY19wb3dlcmRvd24odm9pZCAqcmVnbWFwKQogewotCXJlZ21hcF91cGRhdGVfYml0
cyhyZWdtYXAsIEJFUkxJTjJfU01fQ1RSTCwKLQkJCSAgIEJFUkxJTjJfU01fQ1RSTF9BRENfUE9X
RVIsIDApOworCXJlZ21hcF9jbGVhcl9iaXRzKHJlZ21hcCwgQkVSTElOMl9TTV9DVFJMLCBCRVJM
SU4yX1NNX0NUUkxfQURDX1BPV0VSKTsKIAogfQogCkBAIC0zMzksOSArMzM4LDggQEAgc3RhdGlj
IGludCBiZXJsaW4yX2FkY19wcm9iZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpwZGV2KQogCWlu
ZGlvX2Rldi0+bnVtX2NoYW5uZWxzID0gQVJSQVlfU0laRShiZXJsaW4yX2FkY19jaGFubmVscyk7
CiAKIAkvKiBQb3dlciB1cCB0aGUgQURDICovCi0JcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJl
Z21hcCwgQkVSTElOMl9TTV9DVFJMLAotCQkJICAgQkVSTElOMl9TTV9DVFJMX0FEQ19QT1dFUiwK
LQkJCSAgIEJFUkxJTjJfU01fQ1RSTF9BRENfUE9XRVIpOworCXJlZ21hcF9zZXRfYml0cyhwcml2
LT5yZWdtYXAsIEJFUkxJTjJfU01fQ1RSTCwKKwkJCUJFUkxJTjJfU01fQ1RSTF9BRENfUE9XRVIp
OwogCiAJcmV0ID0gZGV2bV9hZGRfYWN0aW9uX29yX3Jlc2V0KCZwZGV2LT5kZXYsIGJlcmxpbjJf
YWRjX3Bvd2VyZG93biwKIAkJCQkgICAgICAgcHJpdi0+cmVnbWFwKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvaWlvL2FkYy9jcGNhcC1hZGMuYyBiL2RyaXZlcnMvaWlvL2FkYy9jcGNhcC1hZGMuYwpp
bmRleCBiNmM0ZWY3MDQ4NGUuLmMyMThhY2Y2YzljNiAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8v
YWRjL2NwY2FwLWFkYy5jCisrKyBiL2RyaXZlcnMvaWlvL2FkYy9jcGNhcC1hZGMuYwpAQCAtMzg1
LDkgKzM4NSw4IEBAIHN0YXRpYyBpcnFyZXR1cm5fdCBjcGNhcF9hZGNfaXJxX3RocmVhZChpbnQg
aXJxLCB2b2lkICpkYXRhKQogCXN0cnVjdCBjcGNhcF9hZGMgKmRkYXRhID0gaWlvX3ByaXYoaW5k
aW9fZGV2KTsKIAlpbnQgZXJyb3I7CiAKLQllcnJvciA9IHJlZ21hcF91cGRhdGVfYml0cyhkZGF0
YS0+cmVnLCBDUENBUF9SRUdfQURDQzIsCi0JCQkJICAgQ1BDQVBfQklUX0FEVFJJR19ESVMsCi0J
CQkJICAgQ1BDQVBfQklUX0FEVFJJR19ESVMpOworCWVycm9yID0gcmVnbWFwX3NldF9iaXRzKGRk
YXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMiwKKwkJCQlDUENBUF9CSVRfQURUUklHX0RJUyk7CiAJ
aWYgKGVycm9yKQogCQlyZXR1cm4gSVJRX05PTkU7CiAKQEAgLTQyNCwyMyArNDIzLDE5IEBAIHN0
YXRpYyB2b2lkIGNwY2FwX2FkY19zZXR1cF9jYWxpYnJhdGUoc3RydWN0IGNwY2FwX2FkYyAqZGRh
dGEsCiAJaWYgKGVycm9yKQogCQlyZXR1cm47CiAKLQllcnJvciA9IHJlZ21hcF91cGRhdGVfYml0
cyhkZGF0YS0+cmVnLCBDUENBUF9SRUdfQURDQzIsCi0JCQkJICAgQ1BDQVBfQklUX0FUT1hfUFNf
RkFDVE9SIHwKLQkJCQkgICBDUENBUF9CSVRfQURDX1BTX0ZBQ1RPUjEgfAotCQkJCSAgIENQQ0FQ
X0JJVF9BRENfUFNfRkFDVE9SMCwKLQkJCQkgICAwKTsKKwllcnJvciA9IHJlZ21hcF9jbGVhcl9i
aXRzKGRkYXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMiwKKwkJCQkgIENQQ0FQX0JJVF9BVE9YX1BT
X0ZBQ1RPUiB8CisJCQkJICBDUENBUF9CSVRfQURDX1BTX0ZBQ1RPUjEgfAorCQkJCSAgQ1BDQVBf
QklUX0FEQ19QU19GQUNUT1IwKTsKIAlpZiAoZXJyb3IpCiAJCXJldHVybjsKIAotCWVycm9yID0g
cmVnbWFwX3VwZGF0ZV9iaXRzKGRkYXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMiwKLQkJCQkgICBD
UENBUF9CSVRfQURUUklHX0RJUywKLQkJCQkgICBDUENBUF9CSVRfQURUUklHX0RJUyk7CisJZXJy
b3IgPSByZWdtYXBfc2V0X2JpdHMoZGRhdGEtPnJlZywgQ1BDQVBfUkVHX0FEQ0MyLAorCQkJCUNQ
Q0FQX0JJVF9BRFRSSUdfRElTKTsKIAlpZiAoZXJyb3IpCiAJCXJldHVybjsKIAotCWVycm9yID0g
cmVnbWFwX3VwZGF0ZV9iaXRzKGRkYXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMiwKLQkJCQkgICBD
UENBUF9CSVRfQVNDLAotCQkJCSAgIENQQ0FQX0JJVF9BU0MpOworCWVycm9yID0gcmVnbWFwX3Nl
dF9iaXRzKGRkYXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMiwgQ1BDQVBfQklUX0FTQyk7CiAJaWYg
KGVycm9yKQogCQlyZXR1cm47CiAKQEAgLTQ1NSw4ICs0NTAsOCBAQCBzdGF0aWMgdm9pZCBjcGNh
cF9hZGNfc2V0dXBfY2FsaWJyYXRlKHN0cnVjdCBjcGNhcF9hZGMgKmRkYXRhLAogCQlkZXZfZXJy
KGRkYXRhLT5kZXYsCiAJCQkiVGltZW91dCB3YWl0aW5nIGZvciBjYWxpYnJhdGlvbiB0byBjb21w
bGV0ZVxuIik7CiAKLQllcnJvciA9IHJlZ21hcF91cGRhdGVfYml0cyhkZGF0YS0+cmVnLCBDUENB
UF9SRUdfQURDQzEsCi0JCQkJICAgQ1BDQVBfQklUX0NBTF9NT0RFLCAwKTsKKwllcnJvciA9IHJl
Z21hcF9jbGVhcl9iaXRzKGRkYXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMSwKKwkJCQkgIENQQ0FQ
X0JJVF9DQUxfTU9ERSk7CiAJaWYgKGVycm9yKQogCQlyZXR1cm47CiB9CkBAIC02MDIsMjYgKzU5
NywyMyBAQCBzdGF0aWMgdm9pZCBjcGNhcF9hZGNfc2V0dXBfYmFuayhzdHJ1Y3QgY3BjYXBfYWRj
ICpkZGF0YSwKIAkJcmV0dXJuOwogCiAJaWYgKHJlcS0+dGltaW5nID09IENQQ0FQX0FEQ19USU1J
TkdfSU1NKSB7Ci0JCWVycm9yID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGRkYXRhLT5yZWcsIENQQ0FQ
X1JFR19BRENDMiwKLQkJCQkJICAgQ1BDQVBfQklUX0FEVFJJR19ESVMsCi0JCQkJCSAgIENQQ0FQ
X0JJVF9BRFRSSUdfRElTKTsKKwkJZXJyb3IgPSByZWdtYXBfc2V0X2JpdHMoZGRhdGEtPnJlZywg
Q1BDQVBfUkVHX0FEQ0MyLAorCQkJCQlDUENBUF9CSVRfQURUUklHX0RJUyk7CiAJCWlmIChlcnJv
cikKIAkJCXJldHVybjsKIAotCQllcnJvciA9IHJlZ21hcF91cGRhdGVfYml0cyhkZGF0YS0+cmVn
LCBDUENBUF9SRUdfQURDQzIsCi0JCQkJCSAgIENQQ0FQX0JJVF9BU0MsCi0JCQkJCSAgIENQQ0FQ
X0JJVF9BU0MpOworCQllcnJvciA9IHJlZ21hcF9zZXRfYml0cyhkZGF0YS0+cmVnLCBDUENBUF9S
RUdfQURDQzIsCisJCQkJCUNQQ0FQX0JJVF9BU0MpOwogCQlpZiAoZXJyb3IpCiAJCQlyZXR1cm47
CiAJfSBlbHNlIHsKLQkJZXJyb3IgPSByZWdtYXBfdXBkYXRlX2JpdHMoZGRhdGEtPnJlZywgQ1BD
QVBfUkVHX0FEQ0MyLAotCQkJCQkgICBDUENBUF9CSVRfQURUUklHX09ORVNIT1QsCi0JCQkJCSAg
IENQQ0FQX0JJVF9BRFRSSUdfT05FU0hPVCk7CisJCWVycm9yID0gcmVnbWFwX3NldF9iaXRzKGRk
YXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMiwKKwkJCQkJQ1BDQVBfQklUX0FEVFJJR19PTkVTSE9U
KTsKIAkJaWYgKGVycm9yKQogCQkJcmV0dXJuOwogCi0JCWVycm9yID0gcmVnbWFwX3VwZGF0ZV9i
aXRzKGRkYXRhLT5yZWcsIENQQ0FQX1JFR19BRENDMiwKLQkJCQkJICAgQ1BDQVBfQklUX0FEVFJJ
R19ESVMsIDApOworCQllcnJvciA9IHJlZ21hcF9jbGVhcl9iaXRzKGRkYXRhLT5yZWcsIENQQ0FQ
X1JFR19BRENDMiwKKwkJCQkJICBDUENBUF9CSVRfQURUUklHX0RJUyk7CiAJCWlmIChlcnJvcikK
IAkJCXJldHVybjsKIAl9CmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9hZGMvZnNsLWlteDI1LWdj
cS5jIGIvZHJpdmVycy9paW8vYWRjL2ZzbC1pbXgyNS1nY3EuYwppbmRleCBiNjgwNjkwNjMxZGIu
LmIzZjAzNzUxMGUzNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vYWRjL2ZzbC1pbXgyNS1nY3Eu
YworKysgYi9kcml2ZXJzL2lpby9hZGMvZnNsLWlteDI1LWdjcS5jCkBAIC04NywxMyArODcsMTMg
QEAgc3RhdGljIGlycXJldHVybl90IG14MjVfZ2NxX2lycShpbnQgaXJxLCB2b2lkICpkYXRhKQog
CXJlZ21hcF9yZWFkKHByaXYtPnJlZ3MsIE1YMjVfQURDUV9TUiwgJnN0YXRzKTsKIAogCWlmIChz
dGF0cyAmIE1YMjVfQURDUV9TUl9FT1EpIHsKLQkJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJl
Z3MsIE1YMjVfQURDUV9NUiwKLQkJCQkgICBNWDI1X0FEQ1FfTVJfRU9RX0lSUSwgTVgyNV9BRENR
X01SX0VPUV9JUlEpOworCQlyZWdtYXBfc2V0X2JpdHMocHJpdi0+cmVncywgTVgyNV9BRENRX01S
LAorCQkJCU1YMjVfQURDUV9NUl9FT1FfSVJRKTsKIAkJY29tcGxldGUoJnByaXYtPmNvbXBsZXRl
ZCk7CiAJfQogCiAJLyogRGlzYWJsZSBjb252ZXJzaW9uIHF1ZXVlIHJ1biAqLwotCXJlZ21hcF91
cGRhdGVfYml0cyhwcml2LT5yZWdzLCBNWDI1X0FEQ1FfQ1IsIE1YMjVfQURDUV9DUl9GUVMsIDAp
OworCXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ3MsIE1YMjVfQURDUV9DUiwgTVgyNV9BRENR
X0NSX0ZRUyk7CiAKIAkvKiBBY2tub3dsZWRnZSBhbGwgcG9zc2libGUgaXJxcyAqLwogCXJlZ21h
cF93cml0ZShwcml2LT5yZWdzLCBNWDI1X0FEQ1FfU1IsIE1YMjVfQURDUV9TUl9GUlIgfApAQCAt
MTE1LDExICsxMTUsMTAgQEAgc3RhdGljIGludCBteDI1X2djcV9nZXRfcmF3X3ZhbHVlKHN0cnVj
dCBkZXZpY2UgKmRldiwKIAlyZWdtYXBfd3JpdGUocHJpdi0+cmVncywgTVgyNV9BRENRX0lURU1f
N18wLAogCQkgICAgIE1YMjVfQURDUV9JVEVNKDAsIGNoYW4tPmNoYW5uZWwpKTsKIAotCXJlZ21h
cF91cGRhdGVfYml0cyhwcml2LT5yZWdzLCBNWDI1X0FEQ1FfTVIsIE1YMjVfQURDUV9NUl9FT1Ff
SVJRLCAwKTsKKwlyZWdtYXBfY2xlYXJfYml0cyhwcml2LT5yZWdzLCBNWDI1X0FEQ1FfTVIsIE1Y
MjVfQURDUV9NUl9FT1FfSVJRKTsKIAogCS8qIFRyaWdnZXIgcXVldWUgZm9yIG9uZSBydW4gKi8K
LQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVncywgTVgyNV9BRENRX0NSLCBNWDI1X0FEQ1Ff
Q1JfRlFTLAotCQkJICAgTVgyNV9BRENRX0NSX0ZRUyk7CisJcmVnbWFwX3NldF9iaXRzKHByaXYt
PnJlZ3MsIE1YMjVfQURDUV9DUiwgTVgyNV9BRENRX0NSX0ZRUyk7CiAKIAl0aW1lX2xlZnQgPSB3
YWl0X2Zvcl9jb21wbGV0aW9uX2ludGVycnVwdGlibGVfdGltZW91dCgKIAkJJnByaXYtPmNvbXBs
ZXRlZCwgTVgyNV9HQ1FfVElNRU9VVCk7CkBAIC0yNzIsOSArMjcxLDggQEAgc3RhdGljIGludCBt
eDI1X2djcV9zZXR1cF9jZmdzKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYsCiAJCQkJICAg
TVgyNV9BRENRX0NGR19SRUZOX01BU0ssCiAJCQkJICAgcmVmcCB8IHJlZm4pOwogCX0KLQlyZWdt
YXBfdXBkYXRlX2JpdHMocHJpdi0+cmVncywgTVgyNV9BRENRX0NSLAotCQkJICAgTVgyNV9BRENR
X0NSX0ZSU1QgfCBNWDI1X0FEQ1FfQ1JfUVJTVCwKLQkJCSAgIE1YMjVfQURDUV9DUl9GUlNUIHwg
TVgyNV9BRENRX0NSX1FSU1QpOworCXJlZ21hcF9zZXRfYml0cyhwcml2LT5yZWdzLCBNWDI1X0FE
Q1FfQ1IsCisJCQlNWDI1X0FEQ1FfQ1JfRlJTVCB8IE1YMjVfQURDUV9DUl9RUlNUKTsKIAogCXJl
Z21hcF93cml0ZShwcml2LT5yZWdzLCBNWDI1X0FEQ1FfQ1IsCiAJCSAgICAgTVgyNV9BRENRX0NS
X1BETVNLIHwgTVgyNV9BRENRX0NSX1FTTV9GUVMpOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8v
YWRjL2luYTJ4eC1hZGMuYyBiL2RyaXZlcnMvaWlvL2FkYy9pbmEyeHgtYWRjLmMKaW5kZXggOWU1
MjIwNzM1MmZiLi43MjdlMzkwYmQ5NzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2FkYy9pbmEy
eHgtYWRjLmMKKysrIGIvZHJpdmVycy9paW8vYWRjL2luYTJ4eC1hZGMuYwpAQCAtMTA0Niw4ICsx
MDQ2LDcgQEAgc3RhdGljIHZvaWQgaW5hMnh4X3JlbW92ZShzdHJ1Y3QgaTJjX2NsaWVudCAqY2xp
ZW50KQogCWlpb19kZXZpY2VfdW5yZWdpc3RlcihpbmRpb19kZXYpOwogCiAJLyogUG93ZXJkb3du
ICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGNoaXAtPnJlZ21hcCwgSU5BMlhYX0NPTkZJ
RywKLQkJCQkgSU5BMlhYX01PREVfTUFTSywgMCk7CisJcmV0ID0gcmVnbWFwX2NsZWFyX2JpdHMo
Y2hpcC0+cmVnbWFwLCBJTkEyWFhfQ09ORklHLCBJTkEyWFhfTU9ERV9NQVNLKTsKIAlpZiAocmV0
KQogCQlkZXZfd2FybigmY2xpZW50LT5kZXYsICJGYWlsZWQgdG8gcG93ZXIgZG93biBkZXZpY2Ug
KCVwZSlcbiIsCiAJCQkgRVJSX1BUUihyZXQpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlvL2Fk
Yy9pbnRlbF9tcmZsZF9hZGMuYyBiL2RyaXZlcnMvaWlvL2FkYy9pbnRlbF9tcmZsZF9hZGMuYwpp
bmRleCBjN2Y0MGFlNmU2MDguLjA1OTBhMTI2ZjMyMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8v
YWRjL2ludGVsX21yZmxkX2FkYy5jCisrKyBiL2RyaXZlcnMvaWlvL2FkYy9pbnRlbF9tcmZsZF9h
ZGMuYwpAQCAtODEsOCArODEsOCBAQCBzdGF0aWMgaW50IG1yZmxkX2FkY19zaW5nbGVfY29udihz
dHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2LAogCiAJcmVpbml0X2NvbXBsZXRpb24oJmFkYy0+Y29t
cGxldGlvbik7CiAKLQlyZWdtYXBfdXBkYXRlX2JpdHMocmVnbWFwLCBCQ09WRV9NQURDSVJRLCBC
Q09WRV9BRENJUlFfQUxMLCAwKTsKLQlyZWdtYXBfdXBkYXRlX2JpdHMocmVnbWFwLCBCQ09WRV9N
SVJRTFZMMSwgQkNPVkVfTFZMMV9BREMsIDApOworCXJlZ21hcF9jbGVhcl9iaXRzKHJlZ21hcCwg
QkNPVkVfTUFEQ0lSUSwgQkNPVkVfQURDSVJRX0FMTCk7CisJcmVnbWFwX2NsZWFyX2JpdHMocmVn
bWFwLCBCQ09WRV9NSVJRTFZMMSwgQkNPVkVfTFZMMV9BREMpOwogCiAJcmV0ID0gcmVnbWFwX3Jl
YWRfcG9sbF90aW1lb3V0KHJlZ21hcCwgQkNPVkVfR1BBRENSRVEsIHJlcSwKIAkJCQkgICAgICAg
IShyZXEgJiBCQ09WRV9HUEFEQ1JFUV9CVVNZKSwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlvL2Fk
Yy9tZXNvbl9zYXJhZGMuYyBiL2RyaXZlcnMvaWlvL2FkYy9tZXNvbl9zYXJhZGMuYwppbmRleCAx
M2I0NzNkOGM2YzcuLmUxNmIwZTI4OTc0ZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vYWRjL21l
c29uX3NhcmFkYy5jCisrKyBiL2RyaXZlcnMvaWlvL2FkYy9tZXNvbl9zYXJhZGMuYwpAQCAtNTQ2
LDM1ICs1NDYsMzEgQEAgc3RhdGljIHZvaWQgbWVzb25fc2FyX2FkY19zdGFydF9zYW1wbGVfZW5n
aW5lKHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYpCiAKIAlyZWluaXRfY29tcGxldGlvbigmcHJp
di0+ZG9uZSk7CiAKLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJf
QURDX1JFRzAsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzBfRklGT19JUlFfRU4sCi0JCQkgICBN
RVNPTl9TQVJfQURDX1JFRzBfRklGT19JUlFfRU4pOworCXJlZ21hcF9zZXRfYml0cyhwcml2LT5y
ZWdtYXAsIE1FU09OX1NBUl9BRENfUkVHMCwKKwkJCU1FU09OX1NBUl9BRENfUkVHMF9GSUZPX0lS
UV9FTik7CiAKLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJfQURD
X1JFRzAsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzBfU0FNUExFX0VOR0lORV9FTkFCTEUsCi0J
CQkgICBNRVNPTl9TQVJfQURDX1JFRzBfU0FNUExFX0VOR0lORV9FTkFCTEUpOworCXJlZ21hcF9z
ZXRfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfUkVHMCwKKwkJCU1FU09OX1NBUl9B
RENfUkVHMF9TQU1QTEVfRU5HSU5FX0VOQUJMRSk7CiAKLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJp
di0+cmVnbWFwLCBNRVNPTl9TQVJfQURDX1JFRzAsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzBf
U0FNUExJTkdfU1RBUlQsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzBfU0FNUExJTkdfU1RBUlQp
OworCXJlZ21hcF9zZXRfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfUkVHMCwKKwkJ
CU1FU09OX1NBUl9BRENfUkVHMF9TQU1QTElOR19TVEFSVCk7CiB9CiAKIHN0YXRpYyB2b2lkIG1l
c29uX3Nhcl9hZGNfc3RvcF9zYW1wbGVfZW5naW5lKHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYp
CiB7CiAJc3RydWN0IG1lc29uX3Nhcl9hZGNfcHJpdiAqcHJpdiA9IGlpb19wcml2KGluZGlvX2Rl
dik7CiAKLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJfQURDX1JF
RzAsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzBfRklGT19JUlFfRU4sIDApOworCXJlZ21hcF9j
bGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19SRUcwLAorCQkJICBNRVNPTl9T
QVJfQURDX1JFRzBfRklGT19JUlFfRU4pOwogCi0JcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJl
Z21hcCwgTUVTT05fU0FSX0FEQ19SRUcwLAotCQkJICAgTUVTT05fU0FSX0FEQ19SRUcwX1NBTVBM
SU5HX1NUT1AsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzBfU0FNUExJTkdfU1RPUCk7CisJcmVn
bWFwX3NldF9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19SRUcwLAorCQkJTUVTT05f
U0FSX0FEQ19SRUcwX1NBTVBMSU5HX1NUT1ApOwogCiAJLyogd2FpdCB1bnRpbCBhbGwgbW9kdWxl
cyBhcmUgc3RvcHBlZCAqLwogCW1lc29uX3Nhcl9hZGNfd2FpdF9idXN5X2NsZWFyKGluZGlvX2Rl
dik7CiAKLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJfQURDX1JF
RzAsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzBfU0FNUExFX0VOR0lORV9FTkFCTEUsIDApOwor
CXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19SRUcwLAorCQkJ
ICBNRVNPTl9TQVJfQURDX1JFRzBfU0FNUExFX0VOR0lORV9FTkFCTEUpOwogfQogCiBzdGF0aWMg
aW50IG1lc29uX3Nhcl9hZGNfbG9jayhzdHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2KQpAQCAtNTg2
LDkgKzU4Miw4IEBAIHN0YXRpYyBpbnQgbWVzb25fc2FyX2FkY19sb2NrKHN0cnVjdCBpaW9fZGV2
ICppbmRpb19kZXYpCiAKIAlpZiAocHJpdi0+cGFyYW0tPmhhc19ibDMwX2ludGVncmF0aW9uKSB7
CiAJCS8qIHByZXZlbnQgQkwzMCBmcm9tIHVzaW5nIHRoZSBTQVIgQURDIHdoaWxlIHdlIGFyZSB1
c2luZyBpdCAqLwotCQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJf
QURDX0RFTEFZLAotCQkJCSAgIE1FU09OX1NBUl9BRENfREVMQVlfS0VSTkVMX0JVU1ksCi0JCQkJ
ICAgTUVTT05fU0FSX0FEQ19ERUxBWV9LRVJORUxfQlVTWSk7CisJCXJlZ21hcF9zZXRfYml0cyhw
cml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfREVMQVksCisJCQkJTUVTT05fU0FSX0FEQ19ERUxB
WV9LRVJORUxfQlVTWSk7CiAKIAkJdWRlbGF5KDEpOwogCkBAIC02MTQsOCArNjA5LDggQEAgc3Rh
dGljIHZvaWQgbWVzb25fc2FyX2FkY191bmxvY2soc3RydWN0IGlpb19kZXYgKmluZGlvX2RldikK
IAogCWlmIChwcml2LT5wYXJhbS0+aGFzX2JsMzBfaW50ZWdyYXRpb24pCiAJCS8qIGFsbG93IEJM
MzAgdG8gdXNlIHRoZSBTQVIgQURDIGFnYWluICovCi0JCXJlZ21hcF91cGRhdGVfYml0cyhwcml2
LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfREVMQVksCi0JCQkJICAgTUVTT05fU0FSX0FEQ19ERUxB
WV9LRVJORUxfQlVTWSwgMCk7CisJCXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgTUVT
T05fU0FSX0FEQ19ERUxBWSwKKwkJCQkgIE1FU09OX1NBUl9BRENfREVMQVlfS0VSTkVMX0JVU1kp
OwogCiAJbXV0ZXhfdW5sb2NrKCZwcml2LT5sb2NrKTsKIH0KQEAgLTg2OSwxNyArODY0LDE2IEBA
IHN0YXRpYyBpbnQgbWVzb25fc2FyX2FkY19pbml0KHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYp
CiAJICogZGlzYWJsZSB0aGlzIGJpdCBhcyBzZWVtcyB0byBiZSBvbmx5IHJlbGV2YW50IGZvciBN
ZXNvbjYgKGJhc2VkCiAJICogb24gdGhlIHZlbmRvciBkcml2ZXIpLCB3aGljaCB3ZSBkb24ndCBz
dXBwb3J0IGF0IHRoZSBtb21lbnQuCiAJICovCi0JcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJl
Z21hcCwgTUVTT05fU0FSX0FEQ19SRUcwLAotCQkJICAgTUVTT05fU0FSX0FEQ19SRUcwX0FEQ19U
RU1QX1NFTl9TRUwsIDApOworCXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05f
U0FSX0FEQ19SRUcwLAorCQkJICBNRVNPTl9TQVJfQURDX1JFRzBfQURDX1RFTVBfU0VOX1NFTCk7
CiAKIAkvKiBkaXNhYmxlIGFsbCBjaGFubmVscyBieSBkZWZhdWx0ICovCiAJcmVnbWFwX3dyaXRl
KHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19DSEFOX0xJU1QsIDB4MCk7CiAKLQlyZWdtYXBf
dXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJfQURDX1JFRzMsCi0JCQkgICBNRVNP
Tl9TQVJfQURDX1JFRzNfQ1RSTF9TQU1QTElOR19DTE9DS19QSEFTRSwgMCk7Ci0JcmVnbWFwX3Vw
ZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19SRUczLAotCQkJICAgTUVTT05f
U0FSX0FEQ19SRUczX0NOVExfVVNFX1NDX0RMWSwKLQkJCSAgIE1FU09OX1NBUl9BRENfUkVHM19D
TlRMX1VTRV9TQ19ETFkpOworCXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05f
U0FSX0FEQ19SRUczLAorCQkJICBNRVNPTl9TQVJfQURDX1JFRzNfQ1RSTF9TQU1QTElOR19DTE9D
S19QSEFTRSk7CisJcmVnbWFwX3NldF9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19S
RUczLAorCQkJTUVTT05fU0FSX0FEQ19SRUczX0NOVExfVVNFX1NDX0RMWSk7CiAKIAkvKiBkZWxh
eSBiZXR3ZWVuIHR3byBzYW1wbGVzID0gKDEwKzEpICogMXVTICovCiAJcmVnbWFwX3VwZGF0ZV9i
aXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19ERUxBWSwKQEAgLTkxNCwyMSArOTA4LDE3
IEBAIHN0YXRpYyBpbnQgbWVzb25fc2FyX2FkY19pbml0KHN0cnVjdCBpaW9fZGV2ICppbmRpb19k
ZXYpCiAJCQkgICBNRVNPTl9TQVJfQURDX0NIQU5fMTBfU1dfQ0hBTjFfTVVYX1NFTF9NQVNLLAog
CQkJICAgcmVndmFsKTsKIAotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIE1FU09O
X1NBUl9BRENfQ0hBTl8xMF9TVywKLQkJCSAgIE1FU09OX1NBUl9BRENfQ0hBTl8xMF9TV19DSEFO
MF9YUF9EUklWRV9TVywKLQkJCSAgIE1FU09OX1NBUl9BRENfQ0hBTl8xMF9TV19DSEFOMF9YUF9E
UklWRV9TVyk7CisJcmVnbWFwX3NldF9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19D
SEFOXzEwX1NXLAorCQkJTUVTT05fU0FSX0FEQ19DSEFOXzEwX1NXX0NIQU4wX1hQX0RSSVZFX1NX
KTsKIAotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfQ0hB
Tl8xMF9TVywKLQkJCSAgIE1FU09OX1NBUl9BRENfQ0hBTl8xMF9TV19DSEFOMF9ZUF9EUklWRV9T
VywKLQkJCSAgIE1FU09OX1NBUl9BRENfQ0hBTl8xMF9TV19DSEFOMF9ZUF9EUklWRV9TVyk7CisJ
cmVnbWFwX3NldF9iaXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19DSEFOXzEwX1NXLAor
CQkJTUVTT05fU0FSX0FEQ19DSEFOXzEwX1NXX0NIQU4wX1lQX0RSSVZFX1NXKTsKIAotCXJlZ21h
cF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfQ0hBTl8xMF9TVywKLQkJ
CSAgIE1FU09OX1NBUl9BRENfQ0hBTl8xMF9TV19DSEFOMV9YUF9EUklWRV9TVywKLQkJCSAgIE1F
U09OX1NBUl9BRENfQ0hBTl8xMF9TV19DSEFOMV9YUF9EUklWRV9TVyk7CisJcmVnbWFwX3NldF9i
aXRzKHByaXYtPnJlZ21hcCwgTUVTT05fU0FSX0FEQ19DSEFOXzEwX1NXLAorCQkJTUVTT05fU0FS
X0FEQ19DSEFOXzEwX1NXX0NIQU4xX1hQX0RSSVZFX1NXKTsKIAotCXJlZ21hcF91cGRhdGVfYml0
cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfQ0hBTl8xMF9TVywKLQkJCSAgIE1FU09OX1NB
Ul9BRENfQ0hBTl8xMF9TV19DSEFOMV9ZUF9EUklWRV9TVywKLQkJCSAgIE1FU09OX1NBUl9BRENf
Q0hBTl8xMF9TV19DSEFOMV9ZUF9EUklWRV9TVyk7CisJcmVnbWFwX3NldF9iaXRzKHByaXYtPnJl
Z21hcCwgTUVTT05fU0FSX0FEQ19DSEFOXzEwX1NXLAorCQkJTUVTT05fU0FSX0FEQ19DSEFOXzEw
X1NXX0NIQU4xX1lQX0RSSVZFX1NXKTsKIAogCS8qCiAJICogc2V0IHVwIHRoZSBpbnB1dCBjaGFu
bmVsIG11eGVzIGluIE1FU09OX1NBUl9BRENfQVVYX1NXCkBAIC05NDQsMTIgKzkzNCwxMCBAQCBz
dGF0aWMgaW50IG1lc29uX3Nhcl9hZGNfaW5pdChzdHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2KQog
CXJlZ21hcF93cml0ZShwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfQVVYX1NXLCByZWd2YWwp
OwogCiAJaWYgKHByaXYtPnRlbXBlcmF0dXJlX3NlbnNvcl9jYWxpYnJhdGVkKSB7Ci0JCXJlZ21h
cF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfREVMVEFfMTAsCi0JCQkJ
ICAgTUVTT05fU0FSX0FEQ19ERUxUQV8xMF9UU19SRVZFMSwKLQkJCQkgICBNRVNPTl9TQVJfQURD
X0RFTFRBXzEwX1RTX1JFVkUxKTsKLQkJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwg
TUVTT05fU0FSX0FEQ19ERUxUQV8xMCwKLQkJCQkgICBNRVNPTl9TQVJfQURDX0RFTFRBXzEwX1RT
X1JFVkUwLAotCQkJCSAgIE1FU09OX1NBUl9BRENfREVMVEFfMTBfVFNfUkVWRTApOworCQlyZWdt
YXBfc2V0X2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJfQURDX0RFTFRBXzEwLAorCQkJCU1F
U09OX1NBUl9BRENfREVMVEFfMTBfVFNfUkVWRTEpOworCQlyZWdtYXBfc2V0X2JpdHMocHJpdi0+
cmVnbWFwLCBNRVNPTl9TQVJfQURDX0RFTFRBXzEwLAorCQkJCU1FU09OX1NBUl9BRENfREVMVEFf
MTBfVFNfUkVWRTApOwogCiAJCS8qCiAJCSAqIHNldCBiaXRzIFszOjBdIG9mIHRoZSBUU0MgKHRl
bXBlcmF0dXJlIHNlbnNvciBjb2VmZmljaWVudCkKQEAgLTk3NiwxMCArOTY0LDEwIEBAIHN0YXRp
YyBpbnQgbWVzb25fc2FyX2FkY19pbml0KHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYpCiAJCQkJ
CSAgIHJlZ3ZhbCk7CiAJCX0KIAl9IGVsc2UgewotCQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+
cmVnbWFwLCBNRVNPTl9TQVJfQURDX0RFTFRBXzEwLAotCQkJCSAgIE1FU09OX1NBUl9BRENfREVM
VEFfMTBfVFNfUkVWRTEsIDApOwotCQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBN
RVNPTl9TQVJfQURDX0RFTFRBXzEwLAotCQkJCSAgIE1FU09OX1NBUl9BRENfREVMVEFfMTBfVFNf
UkVWRTAsIDApOworCQlyZWdtYXBfY2xlYXJfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9B
RENfREVMVEFfMTAsCisJCQkJICBNRVNPTl9TQVJfQURDX0RFTFRBXzEwX1RTX1JFVkUxKTsKKwkJ
cmVnbWFwX2NsZWFyX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9TQVJfQURDX0RFTFRBXzEwLAor
CQkJCSAgTUVTT05fU0FSX0FEQ19ERUxUQV8xMF9UU19SRVZFMCk7CiAJfQogCiAJcmVndmFsID0g
RklFTERfUFJFUChNRVNPTl9TQVJfQURDX1JFRzNfQ1RSTF9DT05UX1JJTkdfQ09VTlRFUl9FTiwK
QEAgLTEwNjIsOSArMTA1MCw4IEBAIHN0YXRpYyBpbnQgbWVzb25fc2FyX2FkY19od19lbmFibGUo
c3RydWN0IGlpb19kZXYgKmluZGlvX2RldikKIAogCW1lc29uX3Nhcl9hZGNfc2V0X2JhbmRnYXAo
aW5kaW9fZGV2LCB0cnVlKTsKIAotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIE1F
U09OX1NBUl9BRENfUkVHMywKLQkJCSAgIE1FU09OX1NBUl9BRENfUkVHM19BRENfRU4sCi0JCQkg
ICBNRVNPTl9TQVJfQURDX1JFRzNfQURDX0VOKTsKKwlyZWdtYXBfc2V0X2JpdHMocHJpdi0+cmVn
bWFwLCBNRVNPTl9TQVJfQURDX1JFRzMsCisJCQlNRVNPTl9TQVJfQURDX1JFRzNfQURDX0VOKTsK
IAogCXVkZWxheSg1KTsKIApAQCAtMTA3OSw4ICsxMDY2LDggQEAgc3RhdGljIGludCBtZXNvbl9z
YXJfYWRjX2h3X2VuYWJsZShzdHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2KQogCXJldHVybiAwOwog
CiBlcnJfYWRjX2NsazoKLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNPTl9T
QVJfQURDX1JFRzMsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzNfQURDX0VOLCAwKTsKKwlyZWdt
YXBfY2xlYXJfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfUkVHMywKKwkJCSAgTUVT
T05fU0FSX0FEQ19SRUczX0FEQ19FTik7CiAJbWVzb25fc2FyX2FkY19zZXRfYmFuZGdhcChpbmRp
b19kZXYsIGZhbHNlKTsKIAlyZWd1bGF0b3JfZGlzYWJsZShwcml2LT52cmVmKTsKIGVycl92cmVm
OgpAQCAtMTEwNCw4ICsxMDkxLDggQEAgc3RhdGljIHZvaWQgbWVzb25fc2FyX2FkY19od19kaXNh
YmxlKHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYpCiAKIAljbGtfZGlzYWJsZV91bnByZXBhcmUo
cHJpdi0+YWRjX2Nsayk7CiAKLQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBNRVNP
Tl9TQVJfQURDX1JFRzMsCi0JCQkgICBNRVNPTl9TQVJfQURDX1JFRzNfQURDX0VOLCAwKTsKKwly
ZWdtYXBfY2xlYXJfYml0cyhwcml2LT5yZWdtYXAsIE1FU09OX1NBUl9BRENfUkVHMywKKwkJCSAg
TUVTT05fU0FSX0FEQ19SRUczX0FEQ19FTik7CiAKIAltZXNvbl9zYXJfYWRjX3NldF9iYW5kZ2Fw
KGluZGlvX2RldiwgZmFsc2UpOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9hZGMvbXAyNjI5
X2FkYy5jIGIvZHJpdmVycy9paW8vYWRjL21wMjYyOV9hZGMuYwppbmRleCA3YzY2YzJjZDViZTIu
LjVmNjcyNzY1ZDRhMiAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vYWRjL21wMjYyOV9hZGMuYwor
KysgYi9kcml2ZXJzL2lpby9hZGMvbXAyNjI5X2FkYy5jCkBAIC0xMzEsOSArMTMxLDggQEAgc3Rh
dGljIGludCBtcDI2MjlfYWRjX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpCiAJ
aW5mby0+ZGV2ID0gZGV2OwogCXBsYXRmb3JtX3NldF9kcnZkYXRhKHBkZXYsIGluZGlvX2Rldik7
CiAKLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoaW5mby0+cmVnbWFwLCBNUDI2MjlfUkVHX0FE
Q19DVFJMLAotCQkJCU1QMjYyOV9BRENfU1RBUlQgfCBNUDI2MjlfQURDX0NPTlRJTlVPVVMsCi0J
CQkJTVAyNjI5X0FEQ19TVEFSVCB8IE1QMjYyOV9BRENfQ09OVElOVU9VUyk7CisJcmV0ID0gcmVn
bWFwX3NldF9iaXRzKGluZm8tPnJlZ21hcCwgTVAyNjI5X1JFR19BRENfQ1RSTCwKKwkJCSAgICAg
IE1QMjYyOV9BRENfU1RBUlQgfCBNUDI2MjlfQURDX0NPTlRJTlVPVVMpOwogCWlmIChyZXQpIHsK
IAkJZGV2X2VycihkZXYsICJhZGMgZW5hYmxlIGZhaWw6ICVkXG4iLCByZXQpOwogCQlyZXR1cm4g
cmV0OwpAQCAtMTYzLDEwICsxNjIsOSBAQCBzdGF0aWMgaW50IG1wMjYyOV9hZGNfcHJvYmUoc3Ry
dWN0IHBsYXRmb3JtX2RldmljZSAqcGRldikKIAlpaW9fbWFwX2FycmF5X3VucmVnaXN0ZXIoaW5k
aW9fZGV2KTsKIAogZmFpbF9kaXNhYmxlOgotCXJlZ21hcF91cGRhdGVfYml0cyhpbmZvLT5yZWdt
YXAsIE1QMjYyOV9SRUdfQURDX0NUUkwsCi0JCQkJCSBNUDI2MjlfQURDX0NPTlRJTlVPVVMsIDAp
OwotCXJlZ21hcF91cGRhdGVfYml0cyhpbmZvLT5yZWdtYXAsIE1QMjYyOV9SRUdfQURDX0NUUkws
Ci0JCQkJCSBNUDI2MjlfQURDX1NUQVJULCAwKTsKKwlyZWdtYXBfY2xlYXJfYml0cyhpbmZvLT5y
ZWdtYXAsIE1QMjYyOV9SRUdfQURDX0NUUkwsCisJCQkgIE1QMjYyOV9BRENfQ09OVElOVU9VUyk7
CisJcmVnbWFwX2NsZWFyX2JpdHMoaW5mby0+cmVnbWFwLCBNUDI2MjlfUkVHX0FEQ19DVFJMLCBN
UDI2MjlfQURDX1NUQVJUKTsKIAogCXJldHVybiByZXQ7CiB9CkBAIC0xODAsMTAgKzE3OCw5IEBA
IHN0YXRpYyB2b2lkIG1wMjYyOV9hZGNfcmVtb3ZlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpCiAKIAlpaW9fbWFwX2FycmF5X3VucmVnaXN0ZXIoaW5kaW9fZGV2KTsKIAotCXJlZ21hcF91
cGRhdGVfYml0cyhpbmZvLT5yZWdtYXAsIE1QMjYyOV9SRUdfQURDX0NUUkwsCi0JCQkJCSBNUDI2
MjlfQURDX0NPTlRJTlVPVVMsIDApOwotCXJlZ21hcF91cGRhdGVfYml0cyhpbmZvLT5yZWdtYXAs
IE1QMjYyOV9SRUdfQURDX0NUUkwsCi0JCQkJCSBNUDI2MjlfQURDX1NUQVJULCAwKTsKKwlyZWdt
YXBfY2xlYXJfYml0cyhpbmZvLT5yZWdtYXAsIE1QMjYyOV9SRUdfQURDX0NUUkwsCisJCQkgIE1Q
MjYyOV9BRENfQ09OVElOVU9VUyk7CisJcmVnbWFwX2NsZWFyX2JpdHMoaW5mby0+cmVnbWFwLCBN
UDI2MjlfUkVHX0FEQ19DVFJMLCBNUDI2MjlfQURDX1NUQVJUKTsKIH0KIAogc3RhdGljIGNvbnN0
IHN0cnVjdCBvZl9kZXZpY2VfaWQgbXAyNjI5X2FkY19vZl9tYXRjaFtdID0gewpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9paW8vYWRjL3Fjb20tc3BtaS1ycmFkYy5jIGIvZHJpdmVycy9paW8vYWRjL3Fj
b20tc3BtaS1ycmFkYy5jCmluZGV4IDU2YTcxMzc2Njk1NC4uMTQwMmRmNjhkZDUyIDEwMDY0NAot
LS0gYS9kcml2ZXJzL2lpby9hZGMvcWNvbS1zcG1pLXJyYWRjLmMKKysrIGIvZHJpdmVycy9paW8v
YWRjL3Fjb20tc3BtaS1ycmFkYy5jCkBAIC0zNTgsMTUgKzM1OCwxNSBAQCBzdGF0aWMgaW50IHJy
YWRjX2VuYWJsZV9jb250aW51b3VzX21vZGUoc3RydWN0IHJyYWRjX2NoaXAgKmNoaXApCiAJaW50
IHJldDsKIAogCS8qIENsZWFyIGNoYW5uZWwgbG9nICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9i
aXRzKGNoaXAtPnJlZ21hcCwgY2hpcC0+YmFzZSArIFJSX0FEQ19MT0csCi0JCQkJIFJSX0FEQ19M
T0dfQ0xSX0NUUkwsIFJSX0FEQ19MT0dfQ0xSX0NUUkwpOworCXJldCA9IHJlZ21hcF9zZXRfYml0
cyhjaGlwLT5yZWdtYXAsIGNoaXAtPmJhc2UgKyBSUl9BRENfTE9HLAorCQkJICAgICAgUlJfQURD
X0xPR19DTFJfQ1RSTCk7CiAJaWYgKHJldCA8IDApIHsKIAkJZGV2X2VycihjaGlwLT5kZXYsICJs
b2cgY3RybCB1cGRhdGUgdG8gY2xlYXIgZmFpbGVkOiVkXG4iLCByZXQpOwogCQlyZXR1cm4gcmV0
OwogCX0KIAotCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhjaGlwLT5yZWdtYXAsIGNoaXAtPmJh
c2UgKyBSUl9BRENfTE9HLAotCQkJCSBSUl9BRENfTE9HX0NMUl9DVFJMLCAwKTsKKwlyZXQgPSBy
ZWdtYXBfY2xlYXJfYml0cyhjaGlwLT5yZWdtYXAsIGNoaXAtPmJhc2UgKyBSUl9BRENfTE9HLAor
CQkJCVJSX0FEQ19MT0dfQ0xSX0NUUkwpOwogCWlmIChyZXQgPCAwKSB7CiAJCWRldl9lcnIoY2hp
cC0+ZGV2LCAibG9nIGN0cmwgdXBkYXRlIHRvIG5vdCBjbGVhciBmYWlsZWQ6JWRcbiIsCiAJCQly
ZXQpOwpAQCAtMzc0LDkgKzM3NCw4IEBAIHN0YXRpYyBpbnQgcnJhZGNfZW5hYmxlX2NvbnRpbnVv
dXNfbW9kZShzdHJ1Y3QgcnJhZGNfY2hpcCAqY2hpcCkKIAl9CiAKIAkvKiBTd2l0Y2ggdG8gY29u
dGludW91cyBtb2RlICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGNoaXAtPnJlZ21hcCwg
Y2hpcC0+YmFzZSArIFJSX0FEQ19DVEwsCi0JCQkJIFJSX0FEQ19DVExfQ09OVElOVU9VU19TRUws
Ci0JCQkJIFJSX0FEQ19DVExfQ09OVElOVU9VU19TRUwpOworCXJldCA9IHJlZ21hcF9zZXRfYml0
cyhjaGlwLT5yZWdtYXAsIGNoaXAtPmJhc2UgKyBSUl9BRENfQ1RMLAorCQkJICAgICAgUlJfQURD
X0NUTF9DT05USU5VT1VTX1NFTCk7CiAJaWYgKHJldCA8IDApCiAJCWRldl9lcnIoY2hpcC0+ZGV2
LCAiVXBkYXRlIHRvIGNvbnRpbnVvdXMgbW9kZSBmYWlsZWQ6JWRcbiIsCiAJCQlyZXQpOwpAQCAt
Mzg5LDggKzM4OCw4IEBAIHN0YXRpYyBpbnQgcnJhZGNfZGlzYWJsZV9jb250aW51b3VzX21vZGUo
c3RydWN0IHJyYWRjX2NoaXAgKmNoaXApCiAJaW50IHJldDsKIAogCS8qIFN3aXRjaCB0byBub24g
Y29udGludW91cyBtb2RlICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGNoaXAtPnJlZ21h
cCwgY2hpcC0+YmFzZSArIFJSX0FEQ19DVEwsCi0JCQkJIFJSX0FEQ19DVExfQ09OVElOVU9VU19T
RUwsIDApOworCXJldCA9IHJlZ21hcF9jbGVhcl9iaXRzKGNoaXAtPnJlZ21hcCwgY2hpcC0+YmFz
ZSArIFJSX0FEQ19DVEwsCisJCQkJUlJfQURDX0NUTF9DT05USU5VT1VTX1NFTCk7CiAJaWYgKHJl
dCA8IDApCiAJCWRldl9lcnIoY2hpcC0+ZGV2LCAiVXBkYXRlIHRvIG5vbi1jb250aW51b3VzIG1v
ZGUgZmFpbGVkOiVkXG4iLAogCQkJcmV0KTsKQEAgLTQzNCw4ICs0MzMsOCBAQCBzdGF0aWMgaW50
IHJyYWRjX3JlYWRfc3RhdHVzX2luX2NvbnRfbW9kZShzdHJ1Y3QgcnJhZGNfY2hpcCAqY2hpcCwK
IAkJcmV0dXJuIC1FSU5WQUw7CiAJfQogCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGNoaXAt
PnJlZ21hcCwgY2hpcC0+YmFzZSArIGNoYW4tPnRyaWdnZXJfYWRkciwKLQkJCQkgY2hhbi0+dHJp
Z2dlcl9tYXNrLCBjaGFuLT50cmlnZ2VyX21hc2spOworCXJldCA9IHJlZ21hcF9zZXRfYml0cyhj
aGlwLT5yZWdtYXAsIGNoaXAtPmJhc2UgKyBjaGFuLT50cmlnZ2VyX2FkZHIsCisJCQkgICAgICBj
aGFuLT50cmlnZ2VyX21hc2spOwogCWlmIChyZXQgPCAwKSB7CiAJCWRldl9lcnIoY2hpcC0+ZGV2
LAogCQkJIkZhaWxlZCB0byBhcHBseSB0cmlnZ2VyIGZvciBjaGFubmVsICclcycgcmV0PSVkXG4i
LApAQCAtNDY5LDggKzQ2OCw4IEBAIHN0YXRpYyBpbnQgcnJhZGNfcmVhZF9zdGF0dXNfaW5fY29u
dF9tb2RlKHN0cnVjdCBycmFkY19jaGlwICpjaGlwLAogCXJyYWRjX2Rpc2FibGVfY29udGludW91
c19tb2RlKGNoaXApOwogCiBkaXNhYmxlX3RyaWdnZXI6Ci0JcmVnbWFwX3VwZGF0ZV9iaXRzKGNo
aXAtPnJlZ21hcCwgY2hpcC0+YmFzZSArIGNoYW4tPnRyaWdnZXJfYWRkciwKLQkJCSAgIGNoYW4t
PnRyaWdnZXJfbWFzaywgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMoY2hpcC0+cmVnbWFwLCBjaGlw
LT5iYXNlICsgY2hhbi0+dHJpZ2dlcl9hZGRyLAorCQkJICBjaGFuLT50cmlnZ2VyX21hc2spOwog
CiAJcmV0dXJuIHJldDsKIH0KQEAgLTQ4MSwxNyArNDgwLDE2IEBAIHN0YXRpYyBpbnQgcnJhZGNf
cHJlcGFyZV9iYXR0X2lkX2NvbnZlcnNpb24oc3RydWN0IHJyYWRjX2NoaXAgKmNoaXAsCiB7CiAJ
aW50IHJldDsKIAotCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhjaGlwLT5yZWdtYXAsIGNoaXAt
PmJhc2UgKyBSUl9BRENfQkFUVF9JRF9DVFJMLAotCQkJCSBSUl9BRENfQkFUVF9JRF9DVFJMX0NI
QU5ORUxfQ09OViwKLQkJCQkgUlJfQURDX0JBVFRfSURfQ1RSTF9DSEFOTkVMX0NPTlYpOworCXJl
dCA9IHJlZ21hcF9zZXRfYml0cyhjaGlwLT5yZWdtYXAsIGNoaXAtPmJhc2UgKyBSUl9BRENfQkFU
VF9JRF9DVFJMLAorCQkJICAgICAgUlJfQURDX0JBVFRfSURfQ1RSTF9DSEFOTkVMX0NPTlYpOwog
CWlmIChyZXQgPCAwKSB7CiAJCWRldl9lcnIoY2hpcC0+ZGV2LCAiRW5hYmxpbmcgQkFUVCBJRCBj
aGFubmVsIGZhaWxlZDolZFxuIiwgcmV0KTsKIAkJcmV0dXJuIHJldDsKIAl9CiAKLQlyZXQgPSBy
ZWdtYXBfdXBkYXRlX2JpdHMoY2hpcC0+cmVnbWFwLAotCQkJCSBjaGlwLT5iYXNlICsgUlJfQURD
X0JBVFRfSURfVFJJR0dFUiwKLQkJCQkgUlJfQURDX1RSSUdHRVJfQ1RMLCBSUl9BRENfVFJJR0dF
Ul9DVEwpOworCXJldCA9IHJlZ21hcF9zZXRfYml0cyhjaGlwLT5yZWdtYXAsCisJCQkgICAgICBj
aGlwLT5iYXNlICsgUlJfQURDX0JBVFRfSURfVFJJR0dFUiwKKwkJCSAgICAgIFJSX0FEQ19UUklH
R0VSX0NUTCk7CiAJaWYgKHJldCA8IDApIHsKIAkJZGV2X2VycihjaGlwLT5kZXYsICJCQVRUX0lE
IHRyaWdnZXIgc2V0IGZhaWxlZDolZFxuIiwgcmV0KTsKIAkJZ290byBvdXRfZGlzYWJsZV9iYXR0
X2lkOwpAQCAtNTAwLDEyICs0OTgsMTIgQEAgc3RhdGljIGludCBycmFkY19wcmVwYXJlX2JhdHRf
aWRfY29udmVyc2lvbihzdHJ1Y3QgcnJhZGNfY2hpcCAqY2hpcCwKIAlyZXQgPSBycmFkY19yZWFk
X3N0YXR1c19pbl9jb250X21vZGUoY2hpcCwgY2hhbl9hZGRyZXNzKTsKIAogCS8qIFJlc2V0IHJl
Z2lzdGVycyBiYWNrIHRvIGRlZmF1bHQgdmFsdWVzICovCi0JcmVnbWFwX3VwZGF0ZV9iaXRzKGNo
aXAtPnJlZ21hcCwgY2hpcC0+YmFzZSArIFJSX0FEQ19CQVRUX0lEX1RSSUdHRVIsCi0JCQkgICBS
Ul9BRENfVFJJR0dFUl9DVEwsIDApOworCXJlZ21hcF9jbGVhcl9iaXRzKGNoaXAtPnJlZ21hcCwg
Y2hpcC0+YmFzZSArIFJSX0FEQ19CQVRUX0lEX1RSSUdHRVIsCisJCQkgIFJSX0FEQ19UUklHR0VS
X0NUTCk7CiAKIG91dF9kaXNhYmxlX2JhdHRfaWQ6Ci0JcmVnbWFwX3VwZGF0ZV9iaXRzKGNoaXAt
PnJlZ21hcCwgY2hpcC0+YmFzZSArIFJSX0FEQ19CQVRUX0lEX0NUUkwsCi0JCQkgICBSUl9BRENf
QkFUVF9JRF9DVFJMX0NIQU5ORUxfQ09OViwgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMoY2hpcC0+
cmVnbWFwLCBjaGlwLT5iYXNlICsgUlJfQURDX0JBVFRfSURfQ1RSTCwKKwkJCSAgUlJfQURDX0JB
VFRfSURfQ1RSTF9DSEFOTkVMX0NPTlYpOwogCiAJcmV0dXJuIHJldDsKIH0KQEAgLTk2NSw5ICs5
NjMsOSBAQCBzdGF0aWMgaW50IHJyYWRjX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBk
ZXYpCiAKIAlpZiAoYmF0dF9pZF9kZWxheSA+PSAwKSB7CiAJCWJhdHRfaWRfZGVsYXkgPSBGSUVM
RF9QUkVQKEJBVFRfSURfU0VUVExFX01BU0ssIGJhdHRfaWRfZGVsYXkpOwotCQlyZXQgPSByZWdt
YXBfdXBkYXRlX2JpdHMoY2hpcC0+cmVnbWFwLAotCQkJCQkgY2hpcC0+YmFzZSArIFJSX0FEQ19C
QVRUX0lEX0NGRywKLQkJCQkJIGJhdHRfaWRfZGVsYXksIGJhdHRfaWRfZGVsYXkpOworCQlyZXQg
PSByZWdtYXBfc2V0X2JpdHMoY2hpcC0+cmVnbWFwLAorCQkJCSAgICAgIGNoaXAtPmJhc2UgKyBS
Ul9BRENfQkFUVF9JRF9DRkcsCisJCQkJICAgICAgYmF0dF9pZF9kZWxheSk7CiAJCWlmIChyZXQg
PCAwKSB7CiAJCQlkZXZfZXJyKGNoaXAtPmRldiwKIAkJCQkiQkFUVF9JRCBzZXR0bGluZyB0aW1l
IGNvbmZpZyBmYWlsZWQ6JWRcbiIsCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9hZGMvcm41dDYx
OC1hZGMuYyBiL2RyaXZlcnMvaWlvL2FkYy9ybjV0NjE4LWFkYy5jCmluZGV4IDZiZjMyOTA3ZjAx
ZC4uY2U1ZjMwMTFmZTAwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9hZGMvcm41dDYxOC1hZGMu
YworKysgYi9kcml2ZXJzL2lpby9hZGMvcm41dDYxOC1hZGMuYwpAQCAtMTM3LDkgKzEzNyw4IEBA
IHN0YXRpYyBpbnQgcm41dDYxOF9hZGNfcmVhZChzdHJ1Y3QgaWlvX2RldiAqaWlvX2RldiwKIAog
CWluaXRfY29tcGxldGlvbigmYWRjLT5jb252X2NvbXBsZXRpb24pOwogCS8qIHNpbmdsZSBjb252
ZXJzaW9uICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGFkYy0+cm41dDYxOC0+cmVnbWFw
LCBSTjVUNjE4X0FEQ0NOVDMsCi0JCQkJIFJONVQ2MThfQURDQ05UM19HT0RPTkUsCi0JCQkJIFJO
NVQ2MThfQURDQ05UM19HT0RPTkUpOworCXJldCA9IHJlZ21hcF9zZXRfYml0cyhhZGMtPnJuNXQ2
MTgtPnJlZ21hcCwgUk41VDYxOF9BRENDTlQzLAorCQkJICAgICAgUk41VDYxOF9BRENDTlQzX0dP
RE9ORSk7CiAJaWYgKHJldCA8IDApCiAJCXJldHVybiByZXQ7CiAKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvaWlvL2FkYy9zYzI3eHhfYWRjLmMgYi9kcml2ZXJzL2lpby9hZGMvc2MyN3h4X2FkYy5jCmlu
ZGV4IGI0YTJlMDU3ZDgwZi4uMjUzNWMyYzNlNjBiIDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9h
ZGMvc2MyN3h4X2FkYy5jCisrKyBiL2RyaXZlcnMvaWlvL2FkYy9zYzI3eHhfYWRjLmMKQEAgLTUw
OCwxMyArNTA4LDEzIEBAIHN0YXRpYyBpbnQgc2MyN3h4X2FkY19yZWFkKHN0cnVjdCBzYzI3eHhf
YWRjX2RhdGEgKmRhdGEsIGludCBjaGFubmVsLAogCQl9CiAJfQogCi0JcmV0ID0gcmVnbWFwX3Vw
ZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+YmFzZSArIFNDMjdYWF9BRENfQ1RMLAotCQkJ
CSBTQzI3WFhfQURDX0VOLCBTQzI3WFhfQURDX0VOKTsKKwlyZXQgPSByZWdtYXBfc2V0X2JpdHMo
ZGF0YS0+cmVnbWFwLCBkYXRhLT5iYXNlICsgU0MyN1hYX0FEQ19DVEwsCisJCQkgICAgICBTQzI3
WFhfQURDX0VOKTsKIAlpZiAocmV0KQogCQlnb3RvIHJlZ3VsYXRvcl9yZXN0b3JlOwogCi0JcmV0
ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+YmFzZSArIFNDMjdYWF9B
RENfSU5UX0NMUiwKLQkJCQkgU0MyN1hYX0FEQ19JUlFfQ0xSLCBTQzI3WFhfQURDX0lSUV9DTFIp
OworCXJldCA9IHJlZ21hcF9zZXRfYml0cyhkYXRhLT5yZWdtYXAsIGRhdGEtPmJhc2UgKyBTQzI3
WFhfQURDX0lOVF9DTFIsCisJCQkgICAgICBTQzI3WFhfQURDX0lSUV9DTFIpOwogCWlmIChyZXQp
CiAJCWdvdG8gZGlzYWJsZV9hZGM7CiAKQEAgLTUzNyw4ICs1MzcsOCBAQCBzdGF0aWMgaW50IHNj
Mjd4eF9hZGNfcmVhZChzdHJ1Y3Qgc2MyN3h4X2FkY19kYXRhICpkYXRhLCBpbnQgY2hhbm5lbCwK
IAlpZiAocmV0KQogCQlnb3RvIGRpc2FibGVfYWRjOwogCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9i
aXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+YmFzZSArIFNDMjdYWF9BRENfQ1RMLAotCQkJCSBTQzI3
WFhfQURDX0NITl9SVU4sIFNDMjdYWF9BRENfQ0hOX1JVTik7CisJcmV0ID0gcmVnbWFwX3NldF9i
aXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+YmFzZSArIFNDMjdYWF9BRENfQ1RMLAorCQkJICAgICAg
U0MyN1hYX0FEQ19DSE5fUlVOKTsKIAlpZiAocmV0KQogCQlnb3RvIGRpc2FibGVfYWRjOwogCkBA
IC01NTksOCArNTU5LDggQEAgc3RhdGljIGludCBzYzI3eHhfYWRjX3JlYWQoc3RydWN0IHNjMjd4
eF9hZGNfZGF0YSAqZGF0YSwgaW50IGNoYW5uZWwsCiAJdmFsdWUgJj0gU0MyN1hYX0FEQ19EQVRB
X01BU0s7CiAKIGRpc2FibGVfYWRjOgotCXJlZ21hcF91cGRhdGVfYml0cyhkYXRhLT5yZWdtYXAs
IGRhdGEtPmJhc2UgKyBTQzI3WFhfQURDX0NUTCwKLQkJCSAgIFNDMjdYWF9BRENfRU4sIDApOwor
CXJlZ21hcF9jbGVhcl9iaXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+YmFzZSArIFNDMjdYWF9BRENf
Q1RMLAorCQkJICBTQzI3WFhfQURDX0VOKTsKIHJlZ3VsYXRvcl9yZXN0b3JlOgogCWlmICgoZGF0
YS0+dmFyX2RhdGEtPnNldF92b2xyZWYpICYmIChjaGFubmVsID09IDMwIHx8IGNoYW5uZWwgPT0g
MzEpKSB7CiAJCXJldF92b2xyZWYgPSByZWd1bGF0b3Jfc2V0X3ZvbHRhZ2UoZGF0YS0+dm9scmVm
LApAQCAtNzY1LDE1ICs3NjUsMTQgQEAgc3RhdGljIGludCBzYzI3eHhfYWRjX2VuYWJsZShzdHJ1
Y3Qgc2MyN3h4X2FkY19kYXRhICpkYXRhKQogewogCWludCByZXQ7CiAKLQlyZXQgPSByZWdtYXBf
dXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBkYXRhLT52YXJfZGF0YS0+bW9kdWxlX2VuLAotCQkJ
CSBTQzI3WFhfTU9EVUxFX0FEQ19FTiwgU0MyN1hYX01PRFVMRV9BRENfRU4pOworCXJldCA9IHJl
Z21hcF9zZXRfYml0cyhkYXRhLT5yZWdtYXAsIGRhdGEtPnZhcl9kYXRhLT5tb2R1bGVfZW4sCisJ
CQkgICAgICBTQzI3WFhfTU9EVUxFX0FEQ19FTik7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsK
IAogCS8qIEVuYWJsZSBBREMgd29yayBjbG9jayBhbmQgY29udHJvbGxlciBjbG9jayAqLwotCXJl
dCA9IHJlZ21hcF91cGRhdGVfYml0cyhkYXRhLT5yZWdtYXAsIGRhdGEtPnZhcl9kYXRhLT5jbGtf
ZW4sCi0JCQkJIFNDMjdYWF9DTEtfQURDX0VOIHwgU0MyN1hYX0NMS19BRENfQ0xLX0VOLAotCQkJ
CSBTQzI3WFhfQ0xLX0FEQ19FTiB8IFNDMjdYWF9DTEtfQURDX0NMS19FTik7CisJcmV0ID0gcmVn
bWFwX3NldF9iaXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+dmFyX2RhdGEtPmNsa19lbiwKKwkJCSAg
ICAgIFNDMjdYWF9DTEtfQURDX0VOIHwgU0MyN1hYX0NMS19BRENfQ0xLX0VOKTsKIAlpZiAocmV0
KQogCQlnb3RvIGRpc2FibGVfYWRjOwogCkBAIC03ODksMTEgKzc4OCwxMSBAQCBzdGF0aWMgaW50
IHNjMjd4eF9hZGNfZW5hYmxlKHN0cnVjdCBzYzI3eHhfYWRjX2RhdGEgKmRhdGEpCiAJcmV0dXJu
IDA7CiAKIGRpc2FibGVfY2xrOgotCXJlZ21hcF91cGRhdGVfYml0cyhkYXRhLT5yZWdtYXAsIGRh
dGEtPnZhcl9kYXRhLT5jbGtfZW4sCi0JCQkgICBTQzI3WFhfQ0xLX0FEQ19FTiB8IFNDMjdYWF9D
TEtfQURDX0NMS19FTiwgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMoZGF0YS0+cmVnbWFwLCBkYXRh
LT52YXJfZGF0YS0+Y2xrX2VuLAorCQkJICBTQzI3WFhfQ0xLX0FEQ19FTiB8IFNDMjdYWF9DTEtf
QURDX0NMS19FTik7CiBkaXNhYmxlX2FkYzoKLQlyZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVn
bWFwLCBkYXRhLT52YXJfZGF0YS0+bW9kdWxlX2VuLAotCQkJICAgU0MyN1hYX01PRFVMRV9BRENf
RU4sIDApOworCXJlZ21hcF9jbGVhcl9iaXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+dmFyX2RhdGEt
Pm1vZHVsZV9lbiwKKwkJCSAgU0MyN1hYX01PRFVMRV9BRENfRU4pOwogCiAJcmV0dXJuIHJldDsK
IH0KQEAgLTgwMywxMSArODAyLDExIEBAIHN0YXRpYyB2b2lkIHNjMjd4eF9hZGNfZGlzYWJsZSh2
b2lkICpfZGF0YSkKIAlzdHJ1Y3Qgc2MyN3h4X2FkY19kYXRhICpkYXRhID0gX2RhdGE7CiAKIAkv
KiBEaXNhYmxlIEFEQyB3b3JrIGNsb2NrIGFuZCBjb250cm9sbGVyIGNsb2NrICovCi0JcmVnbWFw
X3VwZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+dmFyX2RhdGEtPmNsa19lbiwKLQkJCSAg
IFNDMjdYWF9DTEtfQURDX0VOIHwgU0MyN1hYX0NMS19BRENfQ0xLX0VOLCAwKTsKKwlyZWdtYXBf
Y2xlYXJfYml0cyhkYXRhLT5yZWdtYXAsIGRhdGEtPnZhcl9kYXRhLT5jbGtfZW4sCisJCQkgIFND
MjdYWF9DTEtfQURDX0VOIHwgU0MyN1hYX0NMS19BRENfQ0xLX0VOKTsKIAotCXJlZ21hcF91cGRh
dGVfYml0cyhkYXRhLT5yZWdtYXAsIGRhdGEtPnZhcl9kYXRhLT5tb2R1bGVfZW4sCi0JCQkgICBT
QzI3WFhfTU9EVUxFX0FEQ19FTiwgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMoZGF0YS0+cmVnbWFw
LCBkYXRhLT52YXJfZGF0YS0+bW9kdWxlX2VuLAorCQkJICBTQzI3WFhfTU9EVUxFX0FEQ19FTik7
CiB9CiAKIHN0YXRpYyBjb25zdCBzdHJ1Y3Qgc2MyN3h4X2FkY192YXJpYW50X2RhdGEgc2MyNzMx
X2RhdGEgPSB7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9hZGMvc3RtMzItZGZzZG0tYWRjLmMg
Yi9kcml2ZXJzL2lpby9hZGMvc3RtMzItZGZzZG0tYWRjLmMKaW5kZXggOWE0N2QyYzg3ZjA1Li5m
YWJkNjU0MjQ1ZjUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2FkYy9zdG0zMi1kZnNkbS1hZGMu
YworKysgYi9kcml2ZXJzL2lpby9hZGMvc3RtMzItZGZzZG0tYWRjLmMKQEAgLTc1OSw4ICs3NTks
NyBAQCBzdGF0aWMgaW50IHN0bTMyX2Rmc2RtX3N0YXJ0X2NvbnYoc3RydWN0IGlpb19kZXYgKmlu
ZGlvX2RldiwKIAlyZXR1cm4gMDsKIAogZmlsdGVyX3VuY29uZmlndXJlOgotCXJlZ21hcF91cGRh
dGVfYml0cyhyZWdtYXAsIERGU0RNX0NSMShhZGMtPmZsX2lkKSwKLQkJCSAgIERGU0RNX0NSMV9D
RkdfTUFTSywgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMocmVnbWFwLCBERlNETV9DUjEoYWRjLT5m
bF9pZCksIERGU0RNX0NSMV9DRkdfTUFTSyk7CiBzdG9wX2NoYW5uZWxzOgogCXN0bTMyX2Rmc2Rt
X3N0b3BfY2hhbm5lbChpbmRpb19kZXYpOwogCkBAIC03NzQsOCArNzczLDcgQEAgc3RhdGljIHZv
aWQgc3RtMzJfZGZzZG1fc3RvcF9jb252KHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYpCiAKIAlz
dG0zMl9kZnNkbV9zdG9wX2ZpbHRlcihhZGMtPmRmc2RtLCBhZGMtPmZsX2lkKTsKIAotCXJlZ21h
cF91cGRhdGVfYml0cyhyZWdtYXAsIERGU0RNX0NSMShhZGMtPmZsX2lkKSwKLQkJCSAgIERGU0RN
X0NSMV9DRkdfTUFTSywgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMocmVnbWFwLCBERlNETV9DUjEo
YWRjLT5mbF9pZCksIERGU0RNX0NSMV9DRkdfTUFTSyk7CiAKIAlzdG0zMl9kZnNkbV9zdG9wX2No
YW5uZWwoaW5kaW9fZGV2KTsKIH0KQEAgLTk1MSwxNiArOTQ5LDE0IEBAIHN0YXRpYyBpbnQgc3Rt
MzJfZGZzZG1fYWRjX2RtYV9zdGFydChzdHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2KQogCiAJaWYg
KGFkYy0+bmNvbnYgPT0gMSAmJiAhaW5kaW9fZGV2LT50cmlnKSB7CiAJCS8qIEVuYWJsZSByZWd1
bGFyIERNQSB0cmFuc2ZlciovCi0JCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhhZGMtPmRmc2Rt
LT5yZWdtYXAsCi0JCQkJCSBERlNETV9DUjEoYWRjLT5mbF9pZCksCi0JCQkJCSBERlNETV9DUjFf
UkRNQUVOX01BU0ssCi0JCQkJCSBERlNETV9DUjFfUkRNQUVOX01BU0spOworCQlyZXQgPSByZWdt
YXBfc2V0X2JpdHMoYWRjLT5kZnNkbS0+cmVnbWFwLAorCQkJCSAgICAgIERGU0RNX0NSMShhZGMt
PmZsX2lkKSwKKwkJCQkgICAgICBERlNETV9DUjFfUkRNQUVOX01BU0spOwogCX0gZWxzZSB7CiAJ
CS8qIEVuYWJsZSBpbmplY3RlZCBETUEgdHJhbnNmZXIqLwotCQlyZXQgPSByZWdtYXBfdXBkYXRl
X2JpdHMoYWRjLT5kZnNkbS0+cmVnbWFwLAotCQkJCQkgREZTRE1fQ1IxKGFkYy0+ZmxfaWQpLAot
CQkJCQkgREZTRE1fQ1IxX0pETUFFTl9NQVNLLAotCQkJCQkgREZTRE1fQ1IxX0pETUFFTl9NQVNL
KTsKKwkJcmV0ID0gcmVnbWFwX3NldF9iaXRzKGFkYy0+ZGZzZG0tPnJlZ21hcCwKKwkJCQkgICAg
ICBERlNETV9DUjEoYWRjLT5mbF9pZCksCisJCQkJICAgICAgREZTRE1fQ1IxX0pETUFFTl9NQVNL
KTsKIAl9CiAKIAlpZiAocmV0IDwgMCkKQEAgLTk4MSw4ICs5NzcsOCBAQCBzdGF0aWMgdm9pZCBz
dG0zMl9kZnNkbV9hZGNfZG1hX3N0b3Aoc3RydWN0IGlpb19kZXYgKmluZGlvX2RldikKIAlpZiAo
IWFkYy0+ZG1hX2NoYW4pCiAJCXJldHVybjsKIAotCXJlZ21hcF91cGRhdGVfYml0cyhhZGMtPmRm
c2RtLT5yZWdtYXAsIERGU0RNX0NSMShhZGMtPmZsX2lkKSwKLQkJCSAgIERGU0RNX0NSMV9SRE1B
RU5fTUFTSyB8IERGU0RNX0NSMV9KRE1BRU5fTUFTSywgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMo
YWRjLT5kZnNkbS0+cmVnbWFwLCBERlNETV9DUjEoYWRjLT5mbF9pZCksCisJCQkgIERGU0RNX0NS
MV9SRE1BRU5fTUFTSyB8IERGU0RNX0NSMV9KRE1BRU5fTUFTSyk7CiAJZG1hZW5naW5lX3Rlcm1p
bmF0ZV9hbGwoYWRjLT5kbWFfY2hhbik7CiB9CiAKQEAgLTEzMDUsOSArMTMwMSw4IEBAIHN0YXRp
YyBpcnFyZXR1cm5fdCBzdG0zMl9kZnNkbV9pcnEoaW50IGlycSwgdm9pZCAqYXJnKQogCWlmIChz
dGF0dXMgJiBERlNETV9JU1JfUk9WUkZfTUFTSykgewogCQlpZiAoaW50X2VuICYgREZTRE1fQ1Iy
X1JPVlJJRV9NQVNLKQogCQkJZGV2X3dhcm4oJmluZGlvX2Rldi0+ZGV2LCAiT3ZlcnJ1biBkZXRl
Y3RlZFxuIik7Ci0JCXJlZ21hcF91cGRhdGVfYml0cyhyZWdtYXAsIERGU0RNX0lDUihhZGMtPmZs
X2lkKSwKLQkJCQkgICBERlNETV9JQ1JfQ0xSUk9WUkZfTUFTSywKLQkJCQkgICBERlNETV9JQ1Jf
Q0xSUk9WUkZfTUFTSyk7CisJCXJlZ21hcF9zZXRfYml0cyhyZWdtYXAsIERGU0RNX0lDUihhZGMt
PmZsX2lkKSwKKwkJCQlERlNETV9JQ1JfQ0xSUk9WUkZfTUFTSyk7CiAJfQogCiAJcmV0dXJuIElS
UV9IQU5ETEVEOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vZGFjL2x0YzI2ODguYyBiL2RyaXZl
cnMvaWlvL2RhYy9sdGMyNjg4LmMKaW5kZXggYzRiMWJhMzBmOTM1Li5hZjUwZDJhOTU4OTggMTAw
NjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2RhYy9sdGMyNjg4LmMKKysrIGIvZHJpdmVycy9paW8vZGFj
L2x0YzI2ODguYwpAQCAtODYwLDkgKzg2MCw4IEBAIHN0YXRpYyBpbnQgbHRjMjY4OF9zZXR1cChz
dHJ1Y3QgbHRjMjY4OF9zdGF0ZSAqc3QsIHN0cnVjdCByZWd1bGF0b3IgKnZyZWYpCiAJCS8qIGJy
aW5nIGRldmljZSBvdXQgb2YgcmVzZXQgKi8KIAkJZ3Bpb2Rfc2V0X3ZhbHVlX2NhbnNsZWVwKGdw
aW8sIDApOwogCX0gZWxzZSB7Ci0JCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhzdC0+cmVnbWFw
LCBMVEMyNjg4X0NNRF9DT05GSUcsCi0JCQkJCSBMVEMyNjg4X0NPTkZJR19SU1QsCi0JCQkJCSBM
VEMyNjg4X0NPTkZJR19SU1QpOworCQlyZXQgPSByZWdtYXBfc2V0X2JpdHMoc3QtPnJlZ21hcCwg
TFRDMjY4OF9DTURfQ09ORklHLAorCQkJCSAgICAgIExUQzI2ODhfQ09ORklHX1JTVCk7CiAJCWlm
IChyZXQpCiAJCQlyZXR1cm4gcmV0OwogCX0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlvL2RhYy9z
dG0zMi1kYWMtY29yZS5jIGIvZHJpdmVycy9paW8vZGFjL3N0bTMyLWRhYy1jb3JlLmMKaW5kZXgg
ZTE1MGFjNzI5MTU0Li4yZDU2NzA3Mzk5NmIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2RhYy9z
dG0zMi1kYWMtY29yZS5jCisrKyBiL2RyaXZlcnMvaWlvL2RhYy9zdG0zMi1kYWMtY29yZS5jCkBA
IC0yMDAsOSArMjAwLDggQEAgc3RhdGljIGludCBzdG0zMl9kYWNfY29yZV9yZXN1bWUoc3RydWN0
IGRldmljZSAqZGV2KQogCiAJaWYgKHByaXYtPmNvbW1vbi5oZnNlbCkgewogCQkvKiByZXN0b3Jl
IGhmc2VsIChtYXliZSBsb3N0IHVuZGVyIGxvdyBwb3dlciBzdGF0ZSkgKi8KLQkJcmV0ID0gcmVn
bWFwX3VwZGF0ZV9iaXRzKHByaXYtPmNvbW1vbi5yZWdtYXAsIFNUTTMyX0RBQ19DUiwKLQkJCQkJ
IFNUTTMySDdfREFDX0NSX0hGU0VMLAotCQkJCQkgU1RNMzJIN19EQUNfQ1JfSEZTRUwpOworCQly
ZXQgPSByZWdtYXBfc2V0X2JpdHMocHJpdi0+Y29tbW9uLnJlZ21hcCwgU1RNMzJfREFDX0NSLAor
CQkJCSAgICAgIFNUTTMySDdfREFDX0NSX0hGU0VMKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiBy
ZXQ7CiAJfQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vZ3lyby9ibWcxNjBfY29yZS5jIGIvZHJp
dmVycy9paW8vZ3lyby9ibWcxNjBfY29yZS5jCmluZGV4IDBlMmViMGU5ODIzNS4uMTA3MjhkNWNj
YWUzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9neXJvL2JtZzE2MF9jb3JlLmMKKysrIGIvZHJp
dmVycy9paW8vZ3lyby9ibWcxNjBfY29yZS5jCkBAIC0yODUsOCArMjg1LDggQEAgc3RhdGljIGlu
dCBibWcxNjBfY2hpcF9pbml0KHN0cnVjdCBibWcxNjBfZGF0YSAqZGF0YSkKIAlkYXRhLT5zbG9w
ZV90aHJlcyA9IHZhbDsKIAogCS8qIFNldCBkZWZhdWx0IGludGVycnVwdCBtb2RlICovCi0JcmV0
ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgQk1HMTYwX1JFR19JTlRfRU5fMSwK
LQkJCQkgQk1HMTYwX0lOVDFfQklUX09ELCAwKTsKKwlyZXQgPSByZWdtYXBfY2xlYXJfYml0cyhk
YXRhLT5yZWdtYXAsIEJNRzE2MF9SRUdfSU5UX0VOXzEsCisJCQkJQk1HMTYwX0lOVDFfQklUX09E
KTsKIAlpZiAocmV0IDwgMCkgewogCQlkZXZfZXJyKGRldiwgIkVycm9yIHVwZGF0aW5nIGJpdHMg
aW4gcmVnX2ludF9lbl8xXG4iKTsKIAkJcmV0dXJuIHJldDsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
aWlvL2d5cm8vbXB1MzA1MC1jb3JlLmMgYi9kcml2ZXJzL2lpby9neXJvL21wdTMwNTAtY29yZS5j
CmluZGV4IGE3OTFiYTNhNjkzYS4uZmYxYzgxNTUzMDQ1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2lp
by9neXJvL21wdTMwNTAtY29yZS5jCisrKyBiL2RyaXZlcnMvaWlvL2d5cm8vbXB1MzA1MC1jb3Jl
LmMKQEAgLTE5Nyw4ICsxOTcsOCBAQCBzdGF0aWMgaW50IG1wdTMwNTBfc3RhcnRfc2FtcGxpbmco
c3RydWN0IG1wdTMwNTAgKm1wdTMwNTApCiAJaW50IGk7CiAKIAkvKiBSZXNldCAqLwotCXJldCA9
IHJlZ21hcF91cGRhdGVfYml0cyhtcHUzMDUwLT5tYXAsIE1QVTMwNTBfUFdSX01HTSwKLQkJCQkg
TVBVMzA1MF9QV1JfTUdNX1JFU0VULCBNUFUzMDUwX1BXUl9NR01fUkVTRVQpOworCXJldCA9IHJl
Z21hcF9zZXRfYml0cyhtcHUzMDUwLT5tYXAsIE1QVTMwNTBfUFdSX01HTSwKKwkJCSAgICAgIE1Q
VTMwNTBfUFdSX01HTV9SRVNFVCk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApAQCAtNTEz
LDEyICs1MTMsOCBAQCBzdGF0aWMgaXJxcmV0dXJuX3QgbXB1MzA1MF90cmlnZ2VyX2hhbmRsZXIo
aW50IGlycSwgdm9pZCAqcCkKIAkJCQkgIkZJRk8gb3ZlcmZsb3chIEVtcHR5aW5nIGFuZCByZXNl
dHRpbmcgRklGT1xuIik7CiAJCQlmaWZvX292ZXJmbG93ID0gdHJ1ZTsKIAkJCS8qIFJlc2V0IGFu
ZCBlbmFibGUgdGhlIEZJRk8gKi8KLQkJCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhtcHUzMDUw
LT5tYXAsCi0JCQkJCQkgTVBVMzA1MF9VU1JfQ1RSTCwKLQkJCQkJCSBNUFUzMDUwX1VTUl9DVFJM
X0ZJRk9fRU4gfAotCQkJCQkJIE1QVTMwNTBfVVNSX0NUUkxfRklGT19SU1QsCi0JCQkJCQkgTVBV
MzA1MF9VU1JfQ1RSTF9GSUZPX0VOIHwKLQkJCQkJCSBNUFUzMDUwX1VTUl9DVFJMX0ZJRk9fUlNU
KTsKKwkJCXJldCA9IHJlZ21hcF9zZXRfYml0cyhtcHUzMDUwLT5tYXAsIE1QVTMwNTBfVVNSX0NU
UkwsCisJCQkJCSAgICAgIE1QVTMwNTBfVVNSX0NUUkxfRklGT19FTiB8IE1QVTMwNTBfVVNSX0NU
UkxfRklGT19SU1QpOwogCQkJaWYgKHJldCkgewogCQkJCWRldl9pbmZvKG1wdTMwNTAtPmRldiwg
ImVycm9yIHJlc2V0dGluZyBGSUZPXG4iKTsKIAkJCQlnb3RvIG91dF90cmlnZ2VyX3VubG9jazsK
QEAgLTc5OSwxMCArNzk1LDggQEAgc3RhdGljIGludCBtcHUzMDUwX2h3X2luaXQoc3RydWN0IG1w
dTMwNTAgKm1wdTMwNTApCiAJdTY0IG90cDsKIAogCS8qIFJlc2V0ICovCi0JcmV0ID0gcmVnbWFw
X3VwZGF0ZV9iaXRzKG1wdTMwNTAtPm1hcCwKLQkJCQkgTVBVMzA1MF9QV1JfTUdNLAotCQkJCSBN
UFUzMDUwX1BXUl9NR01fUkVTRVQsCi0JCQkJIE1QVTMwNTBfUFdSX01HTV9SRVNFVCk7CisJcmV0
ID0gcmVnbWFwX3NldF9iaXRzKG1wdTMwNTAtPm1hcCwgTVBVMzA1MF9QV1JfTUdNLAorCQkJICAg
ICAgTVBVMzA1MF9QV1JfTUdNX1JFU0VUKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBA
IC04NzIsOCArODY2LDggQEAgc3RhdGljIGludCBtcHUzMDUwX3Bvd2VyX3VwKHN0cnVjdCBtcHUz
MDUwICptcHUzMDUwKQogCW1zbGVlcCgyMDApOwogCiAJLyogVGFrZSBkZXZpY2Ugb3V0IG9mIHNs
ZWVwIG1vZGUgKi8KLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMobXB1MzA1MC0+bWFwLCBNUFUz
MDUwX1BXUl9NR00sCi0JCQkJIE1QVTMwNTBfUFdSX01HTV9TTEVFUCwgMCk7CisJcmV0ID0gcmVn
bWFwX2NsZWFyX2JpdHMobXB1MzA1MC0+bWFwLCBNUFUzMDUwX1BXUl9NR00sCisJCQkJTVBVMzA1
MF9QV1JfTUdNX1NMRUVQKTsKIAlpZiAocmV0KSB7CiAJCXJlZ3VsYXRvcl9idWxrX2Rpc2FibGUo
QVJSQVlfU0laRShtcHUzMDUwLT5yZWdzKSwgbXB1MzA1MC0+cmVncyk7CiAJCWRldl9lcnIobXB1
MzA1MC0+ZGV2LCAiZXJyb3Igc2V0dGluZyBwb3dlciBtb2RlXG4iKTsKQEAgLTg5NSw4ICs4ODks
OCBAQCBzdGF0aWMgaW50IG1wdTMwNTBfcG93ZXJfZG93bihzdHJ1Y3QgbXB1MzA1MCAqbXB1MzA1
MCkKIAkgKiB0aGVuIHdlIHdvdWxkIGJlIHdhc3RpbmcgcG93ZXIgdW5sZXNzIHdlIGdvIHRvIHNs
ZWVwIG1vZGUKIAkgKiBmaXJzdC4KIAkgKi8KLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMobXB1
MzA1MC0+bWFwLCBNUFUzMDUwX1BXUl9NR00sCi0JCQkJIE1QVTMwNTBfUFdSX01HTV9TTEVFUCwg
TVBVMzA1MF9QV1JfTUdNX1NMRUVQKTsKKwlyZXQgPSByZWdtYXBfc2V0X2JpdHMobXB1MzA1MC0+
bWFwLCBNUFUzMDUwX1BXUl9NR00sCisJCQkgICAgICBNUFUzMDUwX1BXUl9NR01fU0xFRVApOwog
CWlmIChyZXQpCiAJCWRldl9lcnIobXB1MzA1MC0+ZGV2LCAiZXJyb3IgcHV0dGluZyB0byBzbGVl
cFxuIik7CiAKQEAgLTk5NywxMSArOTkxLDggQEAgc3RhdGljIGludCBtcHUzMDUwX2RyZHlfdHJp
Z2dlcl9zZXRfc3RhdGUoc3RydWN0IGlpb190cmlnZ2VyICp0cmlnLAogCQkJcmV0dXJuIHJldDsK
IAogCQkvKiBSZXNldCBhbmQgZW5hYmxlIHRoZSBGSUZPICovCi0JCXJldCA9IHJlZ21hcF91cGRh
dGVfYml0cyhtcHUzMDUwLT5tYXAsIE1QVTMwNTBfVVNSX0NUUkwsCi0JCQkJCSBNUFUzMDUwX1VT
Ul9DVFJMX0ZJRk9fRU4gfAotCQkJCQkgTVBVMzA1MF9VU1JfQ1RSTF9GSUZPX1JTVCwKLQkJCQkJ
IE1QVTMwNTBfVVNSX0NUUkxfRklGT19FTiB8Ci0JCQkJCSBNUFUzMDUwX1VTUl9DVFJMX0ZJRk9f
UlNUKTsKKwkJcmV0ID0gcmVnbWFwX3NldF9iaXRzKG1wdTMwNTAtPm1hcCwgTVBVMzA1MF9VU1Jf
Q1RSTCwKKwkJCQkgICAgICBNUFUzMDUwX1VTUl9DVFJMX0ZJRk9fRU4gfCBNUFUzMDUwX1VTUl9D
VFJMX0ZJRk9fUlNUKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CiAKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvaWlvL2hlYWx0aC9hZmU0NDAzLmMgYi9kcml2ZXJzL2lpby9oZWFsdGgvYWZlNDQw
My5jCmluZGV4IDFkYmU0OGRhZTc0ZS4uNTIzMjZkYzUyMWFjIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2lpby9oZWFsdGgvYWZlNDQwMy5jCisrKyBiL2RyaXZlcnMvaWlvL2hlYWx0aC9hZmU0NDAzLmMK
QEAgLTQyMiw5ICs0MjIsOCBAQCBzdGF0aWMgaW50IGFmZTQ0MDNfc3VzcGVuZChzdHJ1Y3QgZGV2
aWNlICpkZXYpCiAJc3RydWN0IGFmZTQ0MDNfZGF0YSAqYWZlID0gaWlvX3ByaXYoaW5kaW9fZGV2
KTsKIAlpbnQgcmV0OwogCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGFmZS0+cmVnbWFwLCBB
RkU0NDBYX0NPTlRST0wyLAotCQkJCSBBRkU0NDBYX0NPTlRST0wyX1BETl9BRkUsCi0JCQkJIEFG
RTQ0MFhfQ09OVFJPTDJfUEROX0FGRSk7CisJcmV0ID0gcmVnbWFwX3NldF9iaXRzKGFmZS0+cmVn
bWFwLCBBRkU0NDBYX0NPTlRST0wyLAorCQkJICAgICAgQUZFNDQwWF9DT05UUk9MMl9QRE5fQUZF
KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCkBAIC00NDksOCArNDQ4LDggQEAgc3RhdGlj
IGludCBhZmU0NDAzX3Jlc3VtZShzdHJ1Y3QgZGV2aWNlICpkZXYpCiAJCXJldHVybiByZXQ7CiAJ
fQogCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGFmZS0+cmVnbWFwLCBBRkU0NDBYX0NPTlRS
T0wyLAotCQkJCSBBRkU0NDBYX0NPTlRST0wyX1BETl9BRkUsIDApOworCXJldCA9IHJlZ21hcF9j
bGVhcl9iaXRzKGFmZS0+cmVnbWFwLCBBRkU0NDBYX0NPTlRST0wyLAorCQkJCUFGRTQ0MFhfQ09O
VFJPTDJfUEROX0FGRSk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9paW8vaGVhbHRoL2FmZTQ0MDQuYyBiL2RyaXZlcnMvaWlvL2hlYWx0aC9hZmU0NDA0
LmMKaW5kZXggNzc2OGIwN2VmN2E2Li41MWY0YmUzOWQyMGIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMv
aWlvL2hlYWx0aC9hZmU0NDA0LmMKKysrIGIvZHJpdmVycy9paW8vaGVhbHRoL2FmZTQ0MDQuYwpA
QCAtNDMwLDkgKzQzMCw4IEBAIHN0YXRpYyBpbnQgYWZlNDQwNF9zdXNwZW5kKHN0cnVjdCBkZXZp
Y2UgKmRldikKIAlzdHJ1Y3QgYWZlNDQwNF9kYXRhICphZmUgPSBpaW9fcHJpdihpbmRpb19kZXYp
OwogCWludCByZXQ7CiAKLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoYWZlLT5yZWdtYXAsIEFG
RTQ0MFhfQ09OVFJPTDIsCi0JCQkJIEFGRTQ0MFhfQ09OVFJPTDJfUEROX0FGRSwKLQkJCQkgQUZF
NDQwWF9DT05UUk9MMl9QRE5fQUZFKTsKKwlyZXQgPSByZWdtYXBfc2V0X2JpdHMoYWZlLT5yZWdt
YXAsIEFGRTQ0MFhfQ09OVFJPTDIsCisJCQkgICAgICBBRkU0NDBYX0NPTlRST0wyX1BETl9BRkUp
OwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTQ1Nyw4ICs0NTYsOCBAQCBzdGF0aWMg
aW50IGFmZTQ0MDRfcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikKIAkJcmV0dXJuIHJldDsKIAl9
CiAKLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoYWZlLT5yZWdtYXAsIEFGRTQ0MFhfQ09OVFJP
TDIsCi0JCQkJIEFGRTQ0MFhfQ09OVFJPTDJfUEROX0FGRSwgMCk7CisJcmV0ID0gcmVnbWFwX2Ns
ZWFyX2JpdHMoYWZlLT5yZWdtYXAsIEFGRTQ0MFhfQ09OVFJPTDIsCisJCQkJQUZFNDQwWF9DT05U
Uk9MMl9QRE5fQUZFKTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2lpby9oZWFsdGgvbWF4MzAxMDAuYyBiL2RyaXZlcnMvaWlvL2hlYWx0aC9tYXgzMDEw
MC5jCmluZGV4IDYyMzZiNGQ5NjEzNy4uYzE4NjdjMmVmOGUyIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2lpby9oZWFsdGgvbWF4MzAxMDAuYworKysgYi9kcml2ZXJzL2lpby9oZWFsdGgvbWF4MzAxMDAu
YwpAQCAtMzYzLDkgKzM2Myw4IEBAIHN0YXRpYyBpbnQgbWF4MzAxMDBfZ2V0X3RlbXAoc3RydWN0
IG1heDMwMTAwX2RhdGEgKmRhdGEsIGludCAqdmFsKQogCWludCByZXQ7CiAKIAkvKiBzdGFydCBh
Y3F1aXNpdGlvbiAqLwotCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhkYXRhLT5yZWdtYXAsIE1B
WDMwMTAwX1JFR19NT0RFX0NPTkZJRywKLQkJCQkgTUFYMzAxMDBfUkVHX01PREVfQ09ORklHX1RF
TVBfRU4sCi0JCQkJIE1BWDMwMTAwX1JFR19NT0RFX0NPTkZJR19URU1QX0VOKTsKKwlyZXQgPSBy
ZWdtYXBfc2V0X2JpdHMoZGF0YS0+cmVnbWFwLCBNQVgzMDEwMF9SRUdfTU9ERV9DT05GSUcsCisJ
CQkgICAgICBNQVgzMDEwMF9SRUdfTU9ERV9DT05GSUdfVEVNUF9FTik7CiAJaWYgKHJldCkKIAkJ
cmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vaGVhbHRoL21heDMwMTAyLmMg
Yi9kcml2ZXJzL2lpby9oZWFsdGgvbWF4MzAxMDIuYwppbmRleCA2NjE2NzI5YWY1YjcuLjA3YTM0
M2UzNWE4MSAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vaGVhbHRoL21heDMwMTAyLmMKKysrIGIv
ZHJpdmVycy9paW8vaGVhbHRoL21heDMwMTAyLmMKQEAgLTQ0OCw5ICs0NDgsOCBAQCBzdGF0aWMg
aW50IG1heDMwMTAyX2dldF90ZW1wKHN0cnVjdCBtYXgzMDEwMl9kYXRhICpkYXRhLCBpbnQgKnZh
bCwgYm9vbCBlbikKIAl9CiAKIAkvKiBzdGFydCBhY3F1aXNpdGlvbiAqLwotCXJldCA9IHJlZ21h
cF91cGRhdGVfYml0cyhkYXRhLT5yZWdtYXAsIE1BWDMwMTAyX1JFR19URU1QX0NPTkZJRywKLQkJ
CQkgTUFYMzAxMDJfUkVHX1RFTVBfQ09ORklHX1RFTVBfRU4sCi0JCQkJIE1BWDMwMTAyX1JFR19U
RU1QX0NPTkZJR19URU1QX0VOKTsKKwlyZXQgPSByZWdtYXBfc2V0X2JpdHMoZGF0YS0+cmVnbWFw
LCBNQVgzMDEwMl9SRUdfVEVNUF9DT05GSUcsCisJCQkgICAgICBNQVgzMDEwMl9SRUdfVEVNUF9D
T05GSUdfVEVNUF9FTik7CiAJaWYgKHJldCkKIAkJZ290byBvdXQ7CiAKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvaWlvL2ltdS9pbnZfaWNtNDI2MDAvaW52X2ljbTQyNjAwX2J1ZmZlci5jIGIvZHJpdmVy
cy9paW8vaW11L2ludl9pY200MjYwMC9pbnZfaWNtNDI2MDBfYnVmZmVyLmMKaW5kZXggNjNiODVl
Yzg4YzEzLi41MDlmZTZhM2FlOTcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2ltdS9pbnZfaWNt
NDI2MDAvaW52X2ljbTQyNjAwX2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvaWlvL2ltdS9pbnZfaWNt
NDI2MDAvaW52X2ljbTQyNjAwX2J1ZmZlci5jCkBAIC0yNjIsOSArMjYyLDggQEAgaW50IGludl9p
Y200MjYwMF9idWZmZXJfdXBkYXRlX3dhdGVybWFyayhzdHJ1Y3QgaW52X2ljbTQyNjAwX3N0YXRl
ICpzdCkKIAogCS8qIHJlc3RvcmUgd2F0ZXJtYXJrIGludGVycnVwdCAqLwogCWlmIChyZXN0b3Jl
KSB7Ci0JCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhzdC0+bWFwLCBJTlZfSUNNNDI2MDBfUkVH
X0lOVF9TT1VSQ0UwLAotCQkJCQkgSU5WX0lDTTQyNjAwX0lOVF9TT1VSQ0UwX0ZJRk9fVEhTX0lO
VDFfRU4sCi0JCQkJCSBJTlZfSUNNNDI2MDBfSU5UX1NPVVJDRTBfRklGT19USFNfSU5UMV9FTik7
CisJCXJldCA9IHJlZ21hcF9zZXRfYml0cyhzdC0+bWFwLCBJTlZfSUNNNDI2MDBfUkVHX0lOVF9T
T1VSQ0UwLAorCQkJCSAgICAgIElOVl9JQ000MjYwMF9JTlRfU09VUkNFMF9GSUZPX1RIU19JTlQx
X0VOKTsKIAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CiAJfQpAQCAtMzA2LDkgKzMwNSw4IEBA
IHN0YXRpYyBpbnQgaW52X2ljbTQyNjAwX2J1ZmZlcl9wb3N0ZW5hYmxlKHN0cnVjdCBpaW9fZGV2
ICppbmRpb19kZXYpCiAJfQogCiAJLyogc2V0IEZJRk8gdGhyZXNob2xkIGludGVycnVwdCAqLwot
CXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhzdC0+bWFwLCBJTlZfSUNNNDI2MDBfUkVHX0lOVF9T
T1VSQ0UwLAotCQkJCSBJTlZfSUNNNDI2MDBfSU5UX1NPVVJDRTBfRklGT19USFNfSU5UMV9FTiwK
LQkJCQkgSU5WX0lDTTQyNjAwX0lOVF9TT1VSQ0UwX0ZJRk9fVEhTX0lOVDFfRU4pOworCXJldCA9
IHJlZ21hcF9zZXRfYml0cyhzdC0+bWFwLCBJTlZfSUNNNDI2MDBfUkVHX0lOVF9TT1VSQ0UwLAor
CQkJICAgICAgSU5WX0lDTTQyNjAwX0lOVF9TT1VSQ0UwX0ZJRk9fVEhTX0lOVDFfRU4pOwogCWlm
IChyZXQpCiAJCWdvdG8gb3V0X3VubG9jazsKIApAQCAtMzYzLDggKzM2MSw4IEBAIHN0YXRpYyBp
bnQgaW52X2ljbTQyNjAwX2J1ZmZlcl9wcmVkaXNhYmxlKHN0cnVjdCBpaW9fZGV2ICppbmRpb19k
ZXYpCiAJCWdvdG8gb3V0X3VubG9jazsKIAogCS8qIGRpc2FibGUgRklGTyB0aHJlc2hvbGQgaW50
ZXJydXB0ICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKHN0LT5tYXAsIElOVl9JQ000MjYw
MF9SRUdfSU5UX1NPVVJDRTAsCi0JCQkJIElOVl9JQ000MjYwMF9JTlRfU09VUkNFMF9GSUZPX1RI
U19JTlQxX0VOLCAwKTsKKwlyZXQgPSByZWdtYXBfY2xlYXJfYml0cyhzdC0+bWFwLCBJTlZfSUNN
NDI2MDBfUkVHX0lOVF9TT1VSQ0UwLAorCQkJCUlOVl9JQ000MjYwMF9JTlRfU09VUkNFMF9GSUZP
X1RIU19JTlQxX0VOKTsKIAlpZiAocmV0KQogCQlnb3RvIG91dF91bmxvY2s7CiAKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvaWlvL2ltdS9pbnZfaWNtNDI2MDAvaW52X2ljbTQyNjAwX2NvcmUuYyBiL2Ry
aXZlcnMvaWlvL2ltdS9pbnZfaWNtNDI2MDAvaW52X2ljbTQyNjAwX2NvcmUuYwppbmRleCA5NjEx
NmE2OGFiMjkuLmJiMzAyZjU1NDBjZiAxMDA2NDQKLS0tIGEvZHJpdmVycy9paW8vaW11L2ludl9p
Y200MjYwMC9pbnZfaWNtNDI2MDBfY29yZS5jCisrKyBiL2RyaXZlcnMvaWlvL2ltdS9pbnZfaWNt
NDI2MDAvaW52X2ljbTQyNjAwX2NvcmUuYwpAQCAtNDM1LDkgKzQzNSw4IEBAIHN0YXRpYyBpbnQg
aW52X2ljbTQyNjAwX3NldHVwKHN0cnVjdCBpbnZfaWNtNDI2MDBfc3RhdGUgKnN0LAogCQlyZXR1
cm4gcmV0OwogCiAJLyogc2Vuc29yIGRhdGEgaW4gYmlnLWVuZGlhbiAoZGVmYXVsdCkgKi8KLQly
ZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoc3QtPm1hcCwgSU5WX0lDTTQyNjAwX1JFR19JTlRGX0NP
TkZJRzAsCi0JCQkJIElOVl9JQ000MjYwMF9JTlRGX0NPTkZJRzBfU0VOU09SX0RBVEFfRU5ESUFO
LAotCQkJCSBJTlZfSUNNNDI2MDBfSU5URl9DT05GSUcwX1NFTlNPUl9EQVRBX0VORElBTik7CisJ
cmV0ID0gcmVnbWFwX3NldF9iaXRzKHN0LT5tYXAsIElOVl9JQ000MjYwMF9SRUdfSU5URl9DT05G
SUcwLAorCQkJICAgICAgSU5WX0lDTTQyNjAwX0lOVEZfQ09ORklHMF9TRU5TT1JfREFUQV9FTkRJ
QU4pOwogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKQEAgLTUzMiw4ICs1MzEsOCBAQCBzdGF0
aWMgaW50IGludl9pY200MjYwMF9pcnFfaW5pdChzdHJ1Y3QgaW52X2ljbTQyNjAwX3N0YXRlICpz
dCwgaW50IGlycSwKIAkJcmV0dXJuIHJldDsKIAogCS8qIERlYXNzZXJ0IGFzeW5jIHJlc2V0IGZv
ciBwcm9wZXIgSU5UIHBpbiBvcGVyYXRpb24gKGNmIGRhdGFzaGVldCkgKi8KLQlyZXQgPSByZWdt
YXBfdXBkYXRlX2JpdHMoc3QtPm1hcCwgSU5WX0lDTTQyNjAwX1JFR19JTlRfQ09ORklHMSwKLQkJ
CQkgSU5WX0lDTTQyNjAwX0lOVF9DT05GSUcxX0FTWU5DX1JFU0VULCAwKTsKKwlyZXQgPSByZWdt
YXBfY2xlYXJfYml0cyhzdC0+bWFwLCBJTlZfSUNNNDI2MDBfUkVHX0lOVF9DT05GSUcxLAorCQkJ
CUlOVl9JQ000MjYwMF9JTlRfQ09ORklHMV9BU1lOQ19SRVNFVCk7CiAJaWYgKHJldCkKIAkJcmV0
dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vaW11L2ludl9pY200MjYwMC9pbnZf
aWNtNDI2MDBfaTJjLmMgYi9kcml2ZXJzL2lpby9pbXUvaW52X2ljbTQyNjAwL2ludl9pY200MjYw
MF9pMmMuYwppbmRleCA4ZDMzNTA0ZDc3MGYuLmViYjMxYjM4NTg4MSAxMDA2NDQKLS0tIGEvZHJp
dmVycy9paW8vaW11L2ludl9pY200MjYwMC9pbnZfaWNtNDI2MDBfaTJjLmMKKysrIGIvZHJpdmVy
cy9paW8vaW11L2ludl9pY200MjYwMC9pbnZfaWNtNDI2MDBfaTJjLmMKQEAgLTI4LDggKzI4LDgg
QEAgc3RhdGljIGludCBpbnZfaWNtNDI2MDBfaTJjX2J1c19zZXR1cChzdHJ1Y3QgaW52X2ljbTQy
NjAwX3N0YXRlICpzdCkKIAkJCSAgIElOVl9JQ000MjYwMF9JTlRGX0NPTkZJRzZfTUFTSywKIAkJ
CSAgIElOVl9JQ000MjYwMF9JTlRGX0NPTkZJRzZfSTNDX0VOKTsKIAotCXJldCA9IHJlZ21hcF91
cGRhdGVfYml0cyhzdC0+bWFwLCBJTlZfSUNNNDI2MDBfUkVHX0lOVEZfQ09ORklHNCwKLQkJCQkg
SU5WX0lDTTQyNjAwX0lOVEZfQ09ORklHNF9JM0NfQlVTX09OTFksIDApOworCXJldCA9IHJlZ21h
cF9jbGVhcl9iaXRzKHN0LT5tYXAsIElOVl9JQ000MjYwMF9SRUdfSU5URl9DT05GSUc0LAorCQkJ
CUlOVl9JQ000MjYwMF9JTlRGX0NPTkZJRzRfSTNDX0JVU19PTkxZKTsKIAlpZiAocmV0KQogCQly
ZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9pbXUvaW52X2ljbTQyNjAwL2lu
dl9pY200MjYwMF9zcGkuYyBiL2RyaXZlcnMvaWlvL2ltdS9pbnZfaWNtNDI2MDAvaW52X2ljbTQy
NjAwX3NwaS5jCmluZGV4IGNjMmJmMTc5OWE0Ni4uZWFlNWZmN2EzY2MxIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2lpby9pbXUvaW52X2ljbTQyNjAwL2ludl9pY200MjYwMF9zcGkuYworKysgYi9kcml2
ZXJzL2lpby9pbXUvaW52X2ljbTQyNjAwL2ludl9pY200MjYwMF9zcGkuYwpAQCAtMjcsOCArMjcs
OCBAQCBzdGF0aWMgaW50IGludl9pY200MjYwMF9zcGlfYnVzX3NldHVwKHN0cnVjdCBpbnZfaWNt
NDI2MDBfc3RhdGUgKnN0KQogCWlmIChyZXQpCiAJCXJldHVybiByZXQ7CiAKLQlyZXQgPSByZWdt
YXBfdXBkYXRlX2JpdHMoc3QtPm1hcCwgSU5WX0lDTTQyNjAwX1JFR19JTlRGX0NPTkZJRzQsCi0J
CQkJIElOVl9JQ000MjYwMF9JTlRGX0NPTkZJRzRfSTNDX0JVU19PTkxZLCAwKTsKKwlyZXQgPSBy
ZWdtYXBfY2xlYXJfYml0cyhzdC0+bWFwLCBJTlZfSUNNNDI2MDBfUkVHX0lOVEZfQ09ORklHNCwK
KwkJCQlJTlZfSUNNNDI2MDBfSU5URl9DT05GSUc0X0kzQ19CVVNfT05MWSk7CiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vbGlnaHQvYWR1eDEwMjAu
YyBiL2RyaXZlcnMvaWlvL2xpZ2h0L2FkdXgxMDIwLmMKaW5kZXggYWE0YTZjNzhmMGFhLi4zNDIz
MGU2OTlkMjcgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2xpZ2h0L2FkdXgxMDIwLmMKKysrIGIv
ZHJpdmVycy9paW8vbGlnaHQvYWR1eDEwMjAuYwpAQCAtNTM5LDkgKzUzOSw4IEBAIHN0YXRpYyBp
bnQgYWR1eDEwMjBfd3JpdGVfZXZlbnRfY29uZmlnKHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYs
CiAJCSAqIFRyaWdnZXIgcHJveGltaXR5IGludGVycnVwdCB3aGVuIHRoZSBpbnRlbnNpdHkgaXMg
YWJvdmUKIAkJICogb3IgYmVsb3cgdGhyZXNob2xkCiAJCSAqLwotCQlyZXQgPSByZWdtYXBfdXBk
YXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBBRFVYMTAyMF9SRUdfUFJPWF9UWVBFLAotCQkJCQkgQURV
WDEwMjBfUFJPWF9UWVBFLAotCQkJCQkgQURVWDEwMjBfUFJPWF9UWVBFKTsKKwkJcmV0ID0gcmVn
bWFwX3NldF9iaXRzKGRhdGEtPnJlZ21hcCwgQURVWDEwMjBfUkVHX1BST1hfVFlQRSwKKwkJCQkg
ICAgICBBRFVYMTAyMF9QUk9YX1RZUEUpOwogCQlpZiAocmV0IDwgMCkKIAkJCWdvdG8gZmFpbDsK
IApAQCAtNzQ4LDggKzc0Nyw4IEBAIHN0YXRpYyBpbnQgYWR1eDEwMjBfY2hpcF9pbml0KHN0cnVj
dCBhZHV4MTAyMF9kYXRhICpkYXRhKQogCiAJZGV2X2RiZygmY2xpZW50LT5kZXYsICJEZXRlY3Rl
ZCBBRFVYMTAyMCB3aXRoIGNoaXAgaWQ6IDB4JTA0eFxuIiwgdmFsKTsKIAotCXJldCA9IHJlZ21h
cF91cGRhdGVfYml0cyhkYXRhLT5yZWdtYXAsIEFEVVgxMDIwX1JFR19TV19SRVNFVCwKLQkJCQkg
QURVWDEwMjBfU1dfUkVTRVQsIEFEVVgxMDIwX1NXX1JFU0VUKTsKKwlyZXQgPSByZWdtYXBfc2V0
X2JpdHMoZGF0YS0+cmVnbWFwLCBBRFVYMTAyMF9SRUdfU1dfUkVTRVQsCisJCQkgICAgICBBRFVY
MTAyMF9TV19SRVNFVCk7CiAJaWYgKHJldCA8IDApCiAJCXJldHVybiByZXQ7CiAKQEAgLTc2NCw4
ICs3NjMsOCBAQCBzdGF0aWMgaW50IGFkdXgxMDIwX2NoaXBfaW5pdChzdHJ1Y3QgYWR1eDEwMjBf
ZGF0YSAqZGF0YSkKIAkJcmV0dXJuIHJldDsKIAogCS8qIFVzZSBMRURfSVJFRiBmb3IgcHJveGlt
aXR5IG1vZGUgKi8KLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBBRFVY
MTAyMF9SRUdfTEVEX0NVUlJFTlQsCi0JCQkJIEFEVVgxMDIwX0xFRF9QSVJFRl9FTiwgMCk7CisJ
cmV0ID0gcmVnbWFwX2NsZWFyX2JpdHMoZGF0YS0+cmVnbWFwLCBBRFVYMTAyMF9SRUdfTEVEX0NV
UlJFTlQsCisJCQkJQURVWDEwMjBfTEVEX1BJUkVGX0VOKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0
dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vbGlnaHQvaXFzNjIxLWFscy5jIGIv
ZHJpdmVycy9paW8vbGlnaHQvaXFzNjIxLWFscy5jCmluZGV4IDAwNGVhODkwYTRiMi4uNmRlMzNm
ZWFkYTNhIDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9saWdodC9pcXM2MjEtYWxzLmMKKysrIGIv
ZHJpdmVycy9paW8vbGlnaHQvaXFzNjIxLWFscy5jCkBAIC04Niw4ICs4Niw4IEBAIHN0YXRpYyBp
bnQgaXFzNjIxX2Fsc19pbml0KHN0cnVjdCBpcXM2MjFfYWxzX3ByaXZhdGUgKmlxczYyMV9hbHMp
CiAJaWYgKGlxczYyMV9hbHMtPnByb3hfZW4pCiAJCWV2ZW50X21hc2sgfD0gaXFzNjJ4LT5kZXZf
ZGVzYy0+aXJfbWFzazsKIAotCXJldHVybiByZWdtYXBfdXBkYXRlX2JpdHMoaXFzNjJ4LT5yZWdt
YXAsIElRUzYyMF9HTEJMX0VWRU5UX01BU0ssCi0JCQkJICBldmVudF9tYXNrLCAwKTsKKwlyZXR1
cm4gcmVnbWFwX2NsZWFyX2JpdHMoaXFzNjJ4LT5yZWdtYXAsIElRUzYyMF9HTEJMX0VWRU5UX01B
U0ssCisJCQkJIGV2ZW50X21hc2spOwogfQogCiBzdGF0aWMgaW50IGlxczYyMV9hbHNfbm90aWZp
ZXIoc3RydWN0IG5vdGlmaWVyX2Jsb2NrICpub3RpZmllciwKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
aWlvL2xpZ2h0L2lzbDI5MDE4LmMgYi9kcml2ZXJzL2lpby9saWdodC9pc2wyOTAxOC5jCmluZGV4
IDQzNDg0YzE4YjEwMS4uOGRmYzc1MGU2OGMwIDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9saWdo
dC9pc2wyOTAxOC5jCisrKyBiL2RyaXZlcnMvaWlvL2xpZ2h0L2lzbDI5MDE4LmMKQEAgLTU1MCw5
ICs1NTAsOSBAQCBzdGF0aWMgaW50IGlzbDI5MDE4X2NoaXBfaW5pdChzdHJ1Y3QgaXNsMjkwMThf
Y2hpcCAqY2hpcCkKIAkJCXJldHVybiAtRU5PREVWOwogCiAJCS8qIENsZWFyIGJyb3dub3V0IGJp
dCAqLwotCQlzdGF0dXMgPSByZWdtYXBfdXBkYXRlX2JpdHMoY2hpcC0+cmVnbWFwLAotCQkJCQkg
ICAgSVNMMjkwMzVfUkVHX0RFVklDRV9JRCwKLQkJCQkJICAgIElTTDI5MDM1X0JPVVRfTUFTSywg
MCk7CisJCXN0YXR1cyA9IHJlZ21hcF9jbGVhcl9iaXRzKGNoaXAtPnJlZ21hcCwKKwkJCQkJICAg
SVNMMjkwMzVfUkVHX0RFVklDRV9JRCwKKwkJCQkJICAgSVNMMjkwMzVfQk9VVF9NQVNLKTsKIAkJ
aWYgKHN0YXR1cyA8IDApCiAJCQlyZXR1cm4gc3RhdHVzOwogCX0KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvaWlvL2xpZ2h0L3N0X3V2aXMyNV9jb3JlLmMgYi9kcml2ZXJzL2lpby9saWdodC9zdF91dmlz
MjVfY29yZS5jCmluZGV4IGQ0ZTE3MDc5YjJmNC4uZmJhMzk5NzU3NGJiIDEwMDY0NAotLS0gYS9k
cml2ZXJzL2lpby9saWdodC9zdF91dmlzMjVfY29yZS5jCisrKyBiL2RyaXZlcnMvaWlvL2xpZ2h0
L3N0X3V2aXMyNV9jb3JlLmMKQEAgLTMzMCw4ICszMzAsOCBAQCBzdGF0aWMgaW50IHN0X3V2aXMy
NV9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikKIAlzdHJ1Y3QgaWlvX2RldiAqaWlvX2RldiA9
IGRldl9nZXRfZHJ2ZGF0YShkZXYpOwogCXN0cnVjdCBzdF91dmlzMjVfaHcgKmh3ID0gaWlvX3By
aXYoaWlvX2Rldik7CiAKLQlyZXR1cm4gcmVnbWFwX3VwZGF0ZV9iaXRzKGh3LT5yZWdtYXAsIFNU
X1VWSVMyNV9SRUdfQ1RSTDFfQUREUiwKLQkJCQkgIFNUX1VWSVMyNV9SRUdfT0RSX01BU0ssIDAp
OworCXJldHVybiByZWdtYXBfY2xlYXJfYml0cyhody0+cmVnbWFwLCBTVF9VVklTMjVfUkVHX0NU
UkwxX0FERFIsCisJCQkJIFNUX1VWSVMyNV9SRUdfT0RSX01BU0spOwogfQogCiBzdGF0aWMgaW50
IHN0X3V2aXMyNV9yZXN1bWUoc3RydWN0IGRldmljZSAqZGV2KQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9paW8vbGlnaHQvdmVtbDYwMzAuYyBiL2RyaXZlcnMvaWlvL2xpZ2h0L3ZlbWw2MDMwLmMKaW5k
ZXggMDQzZjIzM2Q5YmRiLi5mN2NjYmNlNDVmMzggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL2xp
Z2h0L3ZlbWw2MDMwLmMKKysrIGIvZHJpdmVycy9paW8vbGlnaHQvdmVtbDYwMzAuYwpAQCAtMTQ0
LDggKzE0NCw4IEBAIHN0YXRpYyBjb25zdCBzdHJ1Y3QgYXR0cmlidXRlX2dyb3VwIHZlbWw2MDMw
X2V2ZW50X2F0dHJfZ3JvdXAgPSB7CiAKIHN0YXRpYyBpbnQgdmVtbDYwMzBfYWxzX3B3cl9vbihz
dHJ1Y3QgdmVtbDYwMzBfZGF0YSAqZGF0YSkKIHsKLQlyZXR1cm4gcmVnbWFwX3VwZGF0ZV9iaXRz
KGRhdGEtPnJlZ21hcCwgVkVNTDYwMzBfUkVHX0FMU19DT05GLAotCQkJCSBWRU1MNjAzMF9BTFNf
U0QsIDApOworCXJldHVybiByZWdtYXBfY2xlYXJfYml0cyhkYXRhLT5yZWdtYXAsIFZFTUw2MDMw
X1JFR19BTFNfQ09ORiwKKwkJCQkgVkVNTDYwMzBfQUxTX1NEKTsKIH0KIAogc3RhdGljIGludCB2
ZW1sNjAzMF9hbHNfc2h1dF9kb3duKHN0cnVjdCB2ZW1sNjAzMF9kYXRhICpkYXRhKQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9paW8vbWFnbmV0b21ldGVyL2FrODk3NC5jIGIvZHJpdmVycy9paW8vbWFn
bmV0b21ldGVyL2FrODk3NC5jCmluZGV4IGM3NGQxMTk0M2VjNy4uNzAxNzJiOTE4ZTE2IDEwMDY0
NAotLS0gYS9kcml2ZXJzL2lpby9tYWduZXRvbWV0ZXIvYWs4OTc0LmMKKysrIGIvZHJpdmVycy9p
aW8vbWFnbmV0b21ldGVyL2FrODk3NC5jCkBAIC0zMjcsMTAgKzMyNyw3IEBAIHN0YXRpYyBpbnQg
YWs4OTc0X3RyaWdtZWFzKHN0cnVjdCBhazg5NzQgKmFrODk3NCkKIAl9CiAKIAkvKiBGb3JjZSBh
IG1lYXN1cmVtZW50ICovCi0JcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0cyhhazg5NzQtPm1hcCwK
LQkJCQkgIEFLODk3NF9DVFJMMywKLQkJCQkgIEFLODk3NF9DVFJMM19GT1JDRSwKLQkJCQkgIEFL
ODk3NF9DVFJMM19GT1JDRSk7CisJcmV0dXJuIHJlZ21hcF9zZXRfYml0cyhhazg5NzQtPm1hcCwg
QUs4OTc0X0NUUkwzLCBBSzg5NzRfQ1RSTDNfRk9SQ0UpOwogfQogCiBzdGF0aWMgaW50IGFrODk3
NF9hd2FpdF9kcmR5KHN0cnVjdCBhazg5NzQgKmFrODk3NCkKQEAgLTQzOCwxMCArNDM1LDggQEAg
c3RhdGljIGludCBhazg5NzRfc2VsZnRlc3Qoc3RydWN0IGFrODk3NCAqYWs4OTc0KQogCX0KIAog
CS8qIFRyaWdnZXIgc2VsZi10ZXN0ICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGFrODk3
NC0+bWFwLAotCQkJQUs4OTc0X0NUUkwzLAotCQkJQUs4OTc0X0NUUkwzX1NFTEZURVNULAotCQkJ
QUs4OTc0X0NUUkwzX1NFTEZURVNUKTsKKwlyZXQgPSByZWdtYXBfc2V0X2JpdHMoYWs4OTc0LT5t
YXAsIEFLODk3NF9DVFJMMywKKwkJCSAgICAgIEFLODk3NF9DVFJMM19TRUxGVEVTVCk7CiAJaWYg
KHJldCkgewogCQlkZXZfZXJyKGRldiwgImNvdWxkIG5vdCB3cml0ZSBDVFJMM1xuIik7CiAJCXJl
dHVybiByZXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9tYWduZXRvbWV0ZXIvbW1jMzUyNDAu
YyBiL2RyaXZlcnMvaWlvL21hZ25ldG9tZXRlci9tbWMzNTI0MC5jCmluZGV4IDZiOWY0YjA1NjE5
MS4uZWMzNWU5NTQzYTk2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9tYWduZXRvbWV0ZXIvbW1j
MzUyNDAuYworKysgYi9kcml2ZXJzL2lpby9tYWduZXRvbWV0ZXIvbW1jMzUyNDAuYwpAQCAtMTg2
LDkgKzE4Niw4IEBAIHN0YXRpYyBpbnQgbW1jMzUyNDBfaHdfc2V0KHN0cnVjdCBtbWMzNTI0MF9k
YXRhICpkYXRhLCBib29sIHNldCkKIAkgKiBSZWNoYXJnZSB0aGUgY2FwYWNpdG9yIGF0IFZDQVAg
cGluLCByZXF1ZXN0ZWQgdG8gYmUgaXNzdWVkCiAJICogYmVmb3JlIGEgU0VUL1JFU0VUIGNvbW1h
bmQuCiAJICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgTU1DMzUy
NDBfUkVHX0NUUkwwLAotCQkJCSBNTUMzNTI0MF9DVFJMMF9SRUZJTExfQklULAotCQkJCSBNTUMz
NTI0MF9DVFJMMF9SRUZJTExfQklUKTsKKwlyZXQgPSByZWdtYXBfc2V0X2JpdHMoZGF0YS0+cmVn
bWFwLCBNTUMzNTI0MF9SRUdfQ1RSTDAsCisJCQkgICAgICBNTUMzNTI0MF9DVFJMMF9SRUZJTExf
QklUKTsKIAlpZiAocmV0IDwgMCkKIAkJcmV0dXJuIHJldDsKIAl1c2xlZXBfcmFuZ2UoTU1DMzUy
NDBfV0FJVF9DSEFSR0VfUFVNUCwgTU1DMzUyNDBfV0FJVF9DSEFSR0VfUFVNUCArIDEpOwpAQCAt
MTk4LDggKzE5Nyw3IEBAIHN0YXRpYyBpbnQgbW1jMzUyNDBfaHdfc2V0KHN0cnVjdCBtbWMzNTI0
MF9kYXRhICpkYXRhLCBib29sIHNldCkKIAllbHNlCiAJCWNvaWxfYml0ID0gTU1DMzUyNDBfQ1RS
TDBfUkVTRVRfQklUOwogCi0JcmV0dXJuIHJlZ21hcF91cGRhdGVfYml0cyhkYXRhLT5yZWdtYXAs
IE1NQzM1MjQwX1JFR19DVFJMMCwKLQkJCQkgIGNvaWxfYml0LCBjb2lsX2JpdCk7CisJcmV0dXJu
IHJlZ21hcF9zZXRfYml0cyhkYXRhLT5yZWdtYXAsIE1NQzM1MjQwX1JFR19DVFJMMCwgY29pbF9i
aXQpOwogCiB9CiAKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaWlvL3ByZXNzdXJlL2JtcDI4MC1jb3Jl
LmMgYi9kcml2ZXJzL2lpby9wcmVzc3VyZS9ibXAyODAtY29yZS5jCmluZGV4IDA5ZjUzZDk4N2M3
ZC4uZWY3ZjU0NjgzOWU0IDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby9wcmVzc3VyZS9ibXAyODAt
Y29yZS5jCisrKyBiL2RyaXZlcnMvaWlvL3ByZXNzdXJlL2JtcDI4MC1jb3JlLmMKQEAgLTE1NjYs
OCArMTU2Niw4IEBAIHN0YXRpYyBpbnQgYm1wNTgwX252bWVtX3dyaXRlKHZvaWQgKnByaXYsIHVu
c2lnbmVkIGludCBvZmZzZXQsIHZvaWQgKnZhbCwKIAkJCWdvdG8gZXhpdDsKIAogCQkvKiBEaXNh
YmxlIHByb2dyYW1taW5nIG1vZGUgYml0ICovCi0JCXJldCA9IHJlZ21hcF91cGRhdGVfYml0cyhk
YXRhLT5yZWdtYXAsIEJNUDU4MF9SRUdfTlZNX0FERFIsCi0JCQkJCSBCTVA1ODBfTlZNX1BST0df
RU4sIDApOworCQlyZXQgPSByZWdtYXBfY2xlYXJfYml0cyhkYXRhLT5yZWdtYXAsIEJNUDU4MF9S
RUdfTlZNX0FERFIsCisJCQkJCUJNUDU4MF9OVk1fUFJPR19FTik7CiAJCWlmIChyZXQpIHsKIAkJ
CWRldl9lcnIoZGF0YS0+ZGV2LCAiZXJyb3IgcmVzZXR0aW5nIG52bSB3cml0ZVxuIik7CiAJCQln
b3RvIGV4aXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9wcm94aW1pdHkvc3g5MzI0LmMgYi9k
cml2ZXJzL2lpby9wcm94aW1pdHkvc3g5MzI0LmMKaW5kZXggYWEwZDE0YTQ5ZDVlLi42MjlmODNj
MzdkNTkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL3Byb3hpbWl0eS9zeDkzMjQuYworKysgYi9k
cml2ZXJzL2lpby9wcm94aW1pdHkvc3g5MzI0LmMKQEAgLTgzNSw5ICs4MzUsOCBAQCBzdGF0aWMg
aW50IHN4OTMyNF9pbml0X2NvbXBlbnNhdGlvbihzdHJ1Y3QgaWlvX2RldiAqaW5kaW9fZGV2KQog
CWludCByZXQ7CiAKIAkvKiBydW4gdGhlIGNvbXBlbnNhdGlvbiBwaGFzZSBvbiBhbGwgY2hhbm5l
bHMgKi8KLQlyZXQgPSByZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBTWDkzMjRfUkVH
X1NUQVQyLAotCQkJCSBTWDkzMjRfUkVHX1NUQVQyX0NPTVBTVEFUX01BU0ssCi0JCQkJIFNYOTMy
NF9SRUdfU1RBVDJfQ09NUFNUQVRfTUFTSyk7CisJcmV0ID0gcmVnbWFwX3NldF9iaXRzKGRhdGEt
PnJlZ21hcCwgU1g5MzI0X1JFR19TVEFUMiwKKwkJCSAgICAgIFNYOTMyNF9SRUdfU1RBVDJfQ09N
UFNUQVRfTUFTSyk7CiAJaWYgKHJldCkKIAkJcmV0dXJuIHJldDsKIApkaWZmIC0tZ2l0IGEvZHJp
dmVycy9paW8vcHJveGltaXR5L3N4OTM2MC5jIGIvZHJpdmVycy9paW8vcHJveGltaXR5L3N4OTM2
MC5jCmluZGV4IDc1YTFjMjlmMTRlYi4uMmI5MGJmNDVhMjAxIDEwMDY0NAotLS0gYS9kcml2ZXJz
L2lpby9wcm94aW1pdHkvc3g5MzYwLmMKKysrIGIvZHJpdmVycy9paW8vcHJveGltaXR5L3N4OTM2
MC5jCkBAIC02NzIsOSArNjcyLDggQEAgc3RhdGljIGludCBzeDkzNjBfaW5pdF9jb21wZW5zYXRp
b24oc3RydWN0IGlpb19kZXYgKmluZGlvX2RldikKIAlpbnQgcmV0OwogCiAJLyogcnVuIHRoZSBj
b21wZW5zYXRpb24gcGhhc2Ugb24gYWxsIGNoYW5uZWxzICovCi0JcmV0ID0gcmVnbWFwX3VwZGF0
ZV9iaXRzKGRhdGEtPnJlZ21hcCwgU1g5MzYwX1JFR19TVEFULAotCQkJCSBTWDkzNjBfUkVHX1NU
QVRfQ09NUFNUQVRfTUFTSywKLQkJCQkgU1g5MzYwX1JFR19TVEFUX0NPTVBTVEFUX01BU0spOwor
CXJldCA9IHJlZ21hcF9zZXRfYml0cyhkYXRhLT5yZWdtYXAsIFNYOTM2MF9SRUdfU1RBVCwKKwkJ
CSAgICAgIFNYOTM2MF9SRUdfU1RBVF9DT01QU1RBVF9NQVNLKTsKIAlpZiAocmV0KQogCQlyZXR1
cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby9wcm94aW1pdHkvc3g5NTAwLmMgYi9k
cml2ZXJzL2lpby9wcm94aW1pdHkvc3g5NTAwLmMKaW5kZXggNTUwZTdkM2NkNWVlLi40OWY0Y2Nk
OGE1YzQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlvL3Byb3hpbWl0eS9zeDk1MDAuYworKysgYi9k
cml2ZXJzL2lpby9wcm94aW1pdHkvc3g5NTAwLmMKQEAgLTIwOSw3ICsyMDksNyBAQCBzdGF0aWMg
aW50IHN4OTUwMF9pbmNfdXNlcnMoc3RydWN0IHN4OTUwMF9kYXRhICpkYXRhLCBpbnQgKmNvdW50
ZXIsCiAJCS8qIEJpdCBpcyBhbHJlYWR5IGFjdGl2ZSwgbm90aGluZyB0byBkby4gKi8KIAkJcmV0
dXJuIDA7CiAKLQlyZXR1cm4gcmVnbWFwX3VwZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgcmVnLCBi
aXRtYXNrLCBiaXRtYXNrKTsKKwlyZXR1cm4gcmVnbWFwX3NldF9iaXRzKGRhdGEtPnJlZ21hcCwg
cmVnLCBiaXRtYXNrKTsKIH0KIAogc3RhdGljIGludCBzeDk1MDBfZGVjX3VzZXJzKHN0cnVjdCBz
eDk1MDBfZGF0YSAqZGF0YSwgaW50ICpjb3VudGVyLApAQCAtMjIwLDcgKzIyMCw3IEBAIHN0YXRp
YyBpbnQgc3g5NTAwX2RlY191c2VycyhzdHJ1Y3Qgc3g5NTAwX2RhdGEgKmRhdGEsIGludCAqY291
bnRlciwKIAkJLyogVGhlcmUgYXJlIG1vcmUgdXNlcnMsIGRvIG5vdCBkZWFjdGl2YXRlLiAqLwog
CQlyZXR1cm4gMDsKIAotCXJldHVybiByZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBy
ZWcsIGJpdG1hc2ssIDApOworCXJldHVybiByZWdtYXBfY2xlYXJfYml0cyhkYXRhLT5yZWdtYXAs
IHJlZywgYml0bWFzayk7CiB9CiAKIHN0YXRpYyBpbnQgc3g5NTAwX2luY19jaGFuX3VzZXJzKHN0
cnVjdCBzeDk1MDBfZGF0YSAqZGF0YSwgaW50IGNoYW4pCkBAIC03OTUsOCArNzk1LDggQEAgc3Rh
dGljIGludCBzeDk1MDBfaW5pdF9jb21wZW5zYXRpb24oc3RydWN0IGlpb19kZXYgKmluZGlvX2Rl
dikKIAlpbnQgaSwgcmV0OwogCXVuc2lnbmVkIGludCB2YWw7CiAKLQlyZXQgPSByZWdtYXBfdXBk
YXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBTWDk1MDBfUkVHX1BST1hfQ1RSTDAsCi0JCQkJIFNYOTUw
MF9DSEFOX01BU0ssIFNYOTUwMF9DSEFOX01BU0spOworCXJldCA9IHJlZ21hcF9zZXRfYml0cyhk
YXRhLT5yZWdtYXAsIFNYOTUwMF9SRUdfUFJPWF9DVFJMMCwKKwkJCSAgICAgIFNYOTUwMF9DSEFO
X01BU0spOwogCWlmIChyZXQgPCAwKQogCQlyZXR1cm4gcmV0OwogCkBAIC04MTUsOCArODE1LDgg
QEAgc3RhdGljIGludCBzeDk1MDBfaW5pdF9jb21wZW5zYXRpb24oc3RydWN0IGlpb19kZXYgKmlu
ZGlvX2RldikKIAl9CiAKIG91dDoKLQlyZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBT
WDk1MDBfUkVHX1BST1hfQ1RSTDAsCi0JCQkgICBTWDk1MDBfQ0hBTl9NQVNLLCAwKTsKKwlyZWdt
YXBfY2xlYXJfYml0cyhkYXRhLT5yZWdtYXAsIFNYOTUwMF9SRUdfUFJPWF9DVFJMMCwKKwkJCSAg
U1g5NTAwX0NIQU5fTUFTSyk7CiAJcmV0dXJuIHJldDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9paW8vcHJveGltaXR5L3N4X2NvbW1vbi5jIGIvZHJpdmVycy9paW8vcHJveGltaXR5L3N4X2Nv
bW1vbi5jCmluZGV4IGZlMDdkMTQ0NGFjMy4uYTk1ZTk4MTRhYWYyIDEwMDY0NAotLS0gYS9kcml2
ZXJzL2lpby9wcm94aW1pdHkvc3hfY29tbW9uLmMKKysrIGIvZHJpdmVycy9paW8vcHJveGltaXR5
L3N4X2NvbW1vbi5jCkBAIC0xMTEsMTcgKzExMSwxNiBAQCBzdGF0aWMgaW50IHN4X2NvbW1vbl9l
bmFibGVfaXJxKHN0cnVjdCBzeF9jb21tb25fZGF0YSAqZGF0YSwgdW5zaWduZWQgaW50IGlycSkK
IHsKIAlpZiAoIWRhdGEtPmNsaWVudC0+aXJxKQogCQlyZXR1cm4gMDsKLQlyZXR1cm4gcmVnbWFw
X3VwZGF0ZV9iaXRzKGRhdGEtPnJlZ21hcCwgZGF0YS0+Y2hpcF9pbmZvLT5yZWdfaXJxX21zaywK
LQkJCQkgIGlycSA8PCBkYXRhLT5jaGlwX2luZm8tPmlycV9tc2tfb2Zmc2V0LAotCQkJCSAgaXJx
IDw8IGRhdGEtPmNoaXBfaW5mby0+aXJxX21za19vZmZzZXQpOworCXJldHVybiByZWdtYXBfc2V0
X2JpdHMoZGF0YS0+cmVnbWFwLCBkYXRhLT5jaGlwX2luZm8tPnJlZ19pcnFfbXNrLAorCQkJICAg
ICAgIGlycSA8PCBkYXRhLT5jaGlwX2luZm8tPmlycV9tc2tfb2Zmc2V0KTsKIH0KIAogc3RhdGlj
IGludCBzeF9jb21tb25fZGlzYWJsZV9pcnEoc3RydWN0IHN4X2NvbW1vbl9kYXRhICpkYXRhLCB1
bnNpZ25lZCBpbnQgaXJxKQogewogCWlmICghZGF0YS0+Y2xpZW50LT5pcnEpCiAJCXJldHVybiAw
OwotCXJldHVybiByZWdtYXBfdXBkYXRlX2JpdHMoZGF0YS0+cmVnbWFwLCBkYXRhLT5jaGlwX2lu
Zm8tPnJlZ19pcnFfbXNrLAotCQkJCSAgaXJxIDw8IGRhdGEtPmNoaXBfaW5mby0+aXJxX21za19v
ZmZzZXQsIDApOworCXJldHVybiByZWdtYXBfY2xlYXJfYml0cyhkYXRhLT5yZWdtYXAsIGRhdGEt
PmNoaXBfaW5mby0+cmVnX2lycV9tc2ssCisJCQkJIGlycSA8PCBkYXRhLT5jaGlwX2luZm8tPmly
cV9tc2tfb2Zmc2V0KTsKIH0KIAogc3RhdGljIGludCBzeF9jb21tb25fdXBkYXRlX2NoYW5fZW4o
c3RydWN0IHN4X2NvbW1vbl9kYXRhICpkYXRhLApkaWZmIC0tZ2l0IGEvZHJpdmVycy9paW8vdGVt
cGVyYXR1cmUvbWx4OTA2MzIuYyBiL2RyaXZlcnMvaWlvL3RlbXBlcmF0dXJlL21seDkwNjMyLmMK
aW5kZXggOGE1N2JlMTA4NjIwLi5lN2RlMzBmNjEzZDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaWlv
L3RlbXBlcmF0dXJlL21seDkwNjMyLmMKKysrIGIvZHJpdmVycy9paW8vdGVtcGVyYXR1cmUvbWx4
OTA2MzIuYwpAQCAtMzM0LDggKzMzNCw4IEBAIHN0YXRpYyBpbnQgbWx4OTA2MzJfcGVyZm9ybV9t
ZWFzdXJlbWVudChzdHJ1Y3QgbWx4OTA2MzJfZGF0YSAqZGF0YSkKIAl1bnNpZ25lZCBpbnQgcmVn
X3N0YXR1czsKIAlpbnQgcmV0OwogCi0JcmV0ID0gcmVnbWFwX3VwZGF0ZV9iaXRzKGRhdGEtPnJl
Z21hcCwgTUxYOTA2MzJfUkVHX1NUQVRVUywKLQkJCQkgTUxYOTA2MzJfU1RBVF9EQVRBX1JEWSwg
MCk7CisJcmV0ID0gcmVnbWFwX2NsZWFyX2JpdHMoZGF0YS0+cmVnbWFwLCBNTFg5MDYzMl9SRUdf
U1RBVFVTLAorCQkJCU1MWDkwNjMyX1NUQVRfREFUQV9SRFkpOwogCWlmIChyZXQgPCAwKQogCQly
ZXR1cm4gcmV0OwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2lpby90cmlnZ2VyL3N0bTMyLXRpbWVy
LXRyaWdnZXIuYyBiL2RyaXZlcnMvaWlvL3RyaWdnZXIvc3RtMzItdGltZXItdHJpZ2dlci5jCmlu
ZGV4IGQ3NjQ0NDAzMGEyOC4uMDY4NDMyOTk1NmQ5IDEwMDY0NAotLS0gYS9kcml2ZXJzL2lpby90
cmlnZ2VyL3N0bTMyLXRpbWVyLXRyaWdnZXIuYworKysgYi9kcml2ZXJzL2lpby90cmlnZ2VyL3N0
bTMyLXRpbWVyLXRyaWdnZXIuYwpAQCAtMTU4LDcgKzE1OCw3IEBAIHN0YXRpYyBpbnQgc3RtMzJf
dGltZXJfc3RhcnQoc3RydWN0IHN0bTMyX3RpbWVyX3RyaWdnZXIgKnByaXYsCiAKIAlyZWdtYXBf
d3JpdGUocHJpdi0+cmVnbWFwLCBUSU1fUFNDLCBwcmVzY2FsZXIpOwogCXJlZ21hcF93cml0ZShw
cml2LT5yZWdtYXAsIFRJTV9BUlIsIHByZCAtIDEpOwotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2
LT5yZWdtYXAsIFRJTV9DUjEsIFRJTV9DUjFfQVJQRSwgVElNX0NSMV9BUlBFKTsKKwlyZWdtYXBf
c2V0X2JpdHMocHJpdi0+cmVnbWFwLCBUSU1fQ1IxLCBUSU1fQ1IxX0FSUEUpOwogCiAJLyogRm9y
Y2UgbWFzdGVyIG1vZGUgdG8gdXBkYXRlIG1vZGUgKi8KIAlpZiAoc3RtMzJfdGltZXJfaXNfdHJn
bzJfbmFtZSh0cmlnLT5uYW1lKSkKQEAgLTE2OSwxMCArMTY5LDEwIEBAIHN0YXRpYyBpbnQgc3Rt
MzJfdGltZXJfc3RhcnQoc3RydWN0IHN0bTMyX3RpbWVyX3RyaWdnZXIgKnByaXYsCiAJCQkJICAg
MHgyIDw8IFRJTV9DUjJfTU1TX1NISUZUKTsKIAogCS8qIE1ha2Ugc3VyZSB0aGF0IHJlZ2lzdGVy
cyBhcmUgdXBkYXRlZCAqLwotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIFRJTV9F
R1IsIFRJTV9FR1JfVUcsIFRJTV9FR1JfVUcpOworCXJlZ21hcF9zZXRfYml0cyhwcml2LT5yZWdt
YXAsIFRJTV9FR1IsIFRJTV9FR1JfVUcpOwogCiAJLyogRW5hYmxlIGNvbnRyb2xsZXIgKi8KLQly
ZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBUSU1fQ1IxLCBUSU1fQ1IxX0NFTiwgVElN
X0NSMV9DRU4pOworCXJlZ21hcF9zZXRfYml0cyhwcml2LT5yZWdtYXAsIFRJTV9DUjEsIFRJTV9D
UjFfQ0VOKTsKIAltdXRleF91bmxvY2soJnByaXYtPmxvY2spOwogCiAJcmV0dXJuIDA7CkBAIC0x
ODksMTkgKzE4OSwxOSBAQCBzdGF0aWMgdm9pZCBzdG0zMl90aW1lcl9zdG9wKHN0cnVjdCBzdG0z
Ml90aW1lcl90cmlnZ2VyICpwcml2LAogCiAJbXV0ZXhfbG9jaygmcHJpdi0+bG9jayk7CiAJLyog
U3RvcCB0aW1lciAqLwotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIFRJTV9DUjEs
IFRJTV9DUjFfQVJQRSwgMCk7Ci0JcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgVElN
X0NSMSwgVElNX0NSMV9DRU4sIDApOworCXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwg
VElNX0NSMSwgVElNX0NSMV9BUlBFKTsKKwlyZWdtYXBfY2xlYXJfYml0cyhwcml2LT5yZWdtYXAs
IFRJTV9DUjEsIFRJTV9DUjFfQ0VOKTsKIAlyZWdtYXBfd3JpdGUocHJpdi0+cmVnbWFwLCBUSU1f
UFNDLCAwKTsKIAlyZWdtYXBfd3JpdGUocHJpdi0+cmVnbWFwLCBUSU1fQVJSLCAwKTsKIAogCS8q
IEZvcmNlIGRpc2FibGUgbWFzdGVyIG1vZGUgKi8KIAlpZiAoc3RtMzJfdGltZXJfaXNfdHJnbzJf
bmFtZSh0cmlnLT5uYW1lKSkKLQkJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgVElN
X0NSMiwgVElNX0NSMl9NTVMyLCAwKTsKKwkJcmVnbWFwX2NsZWFyX2JpdHMocHJpdi0+cmVnbWFw
LCBUSU1fQ1IyLCBUSU1fQ1IyX01NUzIpOwogCWVsc2UKLQkJcmVnbWFwX3VwZGF0ZV9iaXRzKHBy
aXYtPnJlZ21hcCwgVElNX0NSMiwgVElNX0NSMl9NTVMsIDApOworCQlyZWdtYXBfY2xlYXJfYml0
cyhwcml2LT5yZWdtYXAsIFRJTV9DUjIsIFRJTV9DUjJfTU1TKTsKIAogCS8qIE1ha2Ugc3VyZSB0
aGF0IHJlZ2lzdGVycyBhcmUgdXBkYXRlZCAqLwotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5y
ZWdtYXAsIFRJTV9FR1IsIFRJTV9FR1JfVUcsIFRJTV9FR1JfVUcpOworCXJlZ21hcF9zZXRfYml0
cyhwcml2LT5yZWdtYXAsIFRJTV9FR1IsIFRJTV9FR1JfVUcpOwogCiAJaWYgKHByaXYtPmVuYWJs
ZWQpIHsKIAkJcHJpdi0+ZW5hYmxlZCA9IGZhbHNlOwpAQCAtNDk4LDExICs0OTgsOSBAQCBzdGF0
aWMgaW50IHN0bTMyX2NvdW50ZXJfd3JpdGVfcmF3KHN0cnVjdCBpaW9fZGV2ICppbmRpb19kZXYs
CiAJCQkJcHJpdi0+ZW5hYmxlZCA9IHRydWU7CiAJCQkJY2xrX2VuYWJsZShwcml2LT5jbGspOwog
CQkJfQotCQkJcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwgVElNX0NSMSwgVElNX0NS
MV9DRU4sCi0JCQkJCSAgIFRJTV9DUjFfQ0VOKTsKKwkJCXJlZ21hcF9zZXRfYml0cyhwcml2LT5y
ZWdtYXAsIFRJTV9DUjEsIFRJTV9DUjFfQ0VOKTsKIAkJfSBlbHNlIHsKLQkJCXJlZ21hcF91cGRh
dGVfYml0cyhwcml2LT5yZWdtYXAsIFRJTV9DUjEsIFRJTV9DUjFfQ0VOLAotCQkJCQkgICAwKTsK
KwkJCXJlZ21hcF9jbGVhcl9iaXRzKHByaXYtPnJlZ21hcCwgVElNX0NSMSwgVElNX0NSMV9DRU4p
OwogCQkJaWYgKHByaXYtPmVuYWJsZWQpIHsKIAkJCQlwcml2LT5lbmFibGVkID0gZmFsc2U7CiAJ
CQkJY2xrX2Rpc2FibGUocHJpdi0+Y2xrKTsKQEAgLTU1NSw3ICs1NTMsNyBAQCBzdGF0aWMgaW50
IHN0bTMyX3NldF90cmlnZ2VyX21vZGUoc3RydWN0IGlpb19kZXYgKmluZGlvX2RldiwKIHsKIAlz
dHJ1Y3Qgc3RtMzJfdGltZXJfdHJpZ2dlciAqcHJpdiA9IGlpb19wcml2KGluZGlvX2Rldik7CiAK
LQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBUSU1fU01DUiwgVElNX1NNQ1JfU01T
LCBUSU1fU01DUl9TTVMpOworCXJlZ21hcF9zZXRfYml0cyhwcml2LT5yZWdtYXAsIFRJTV9TTUNS
LCBUSU1fU01DUl9TTVMpOwogCiAJcmV0dXJuIDA7CiB9CkBAIC02ODMsNyArNjgxLDcgQEAgc3Rh
dGljIHNzaXplX3Qgc3RtMzJfY291bnRfc2V0X3ByZXNldChzdHJ1Y3QgaWlvX2RldiAqaW5kaW9f
ZGV2LAogCQlyZXR1cm4gcmV0OwogCiAJLyogVElNeF9BUlIgcmVnaXN0ZXIgc2hvdWxkbid0IGJl
IGJ1ZmZlcmVkIChBUlBFPTApICovCi0JcmVnbWFwX3VwZGF0ZV9iaXRzKHByaXYtPnJlZ21hcCwg
VElNX0NSMSwgVElNX0NSMV9BUlBFLCAwKTsKKwlyZWdtYXBfY2xlYXJfYml0cyhwcml2LT5yZWdt
YXAsIFRJTV9DUjEsIFRJTV9DUjFfQVJQRSk7CiAJcmVnbWFwX3dyaXRlKHByaXYtPnJlZ21hcCwg
VElNX0FSUiwgcHJlc2V0KTsKIAogCXJldHVybiBsZW47CkBAIC03NTcsOSArNzU1LDkgQEAgc3Rh
dGljIHZvaWQgc3RtMzJfdGltZXJfZGV0ZWN0X3RyZ28yKHN0cnVjdCBzdG0zMl90aW1lcl90cmln
Z2VyICpwcml2KQogCSAqIE1hc3RlciBtb2RlIHNlbGVjdGlvbiAyIGJpdHMgY2FuIG9ubHkgYmUg
d3JpdHRlbiBhbmQgcmVhZCBiYWNrIHdoZW4KIAkgKiB0aW1lciBzdXBwb3J0cyBpdC4KIAkgKi8K
LQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+cmVnbWFwLCBUSU1fQ1IyLCBUSU1fQ1IyX01NUzIs
IFRJTV9DUjJfTU1TMik7CisJcmVnbWFwX3NldF9iaXRzKHByaXYtPnJlZ21hcCwgVElNX0NSMiwg
VElNX0NSMl9NTVMyKTsKIAlyZWdtYXBfcmVhZChwcml2LT5yZWdtYXAsIFRJTV9DUjIsICZ2YWwp
OwotCXJlZ21hcF91cGRhdGVfYml0cyhwcml2LT5yZWdtYXAsIFRJTV9DUjIsIFRJTV9DUjJfTU1T
MiwgMCk7CisJcmVnbWFwX2NsZWFyX2JpdHMocHJpdi0+cmVnbWFwLCBUSU1fQ1IyLCBUSU1fQ1Iy
X01NUzIpOwogCXByaXYtPmhhc190cmdvMiA9ICEhdmFsOwogfQogCkBAIC04MjAsNyArODE4LDcg
QEAgc3RhdGljIHZvaWQgc3RtMzJfdGltZXJfdHJpZ2dlcl9yZW1vdmUoc3RydWN0IHBsYXRmb3Jt
X2RldmljZSAqcGRldikKIAkvKiBDaGVjayBpZiBub2JvZHkgZWxzZSB1c2UgdGhlIHRpbWVyLCB0
aGVuIGRpc2FibGUgaXQgKi8KIAlyZWdtYXBfcmVhZChwcml2LT5yZWdtYXAsIFRJTV9DQ0VSLCAm
dmFsKTsKIAlpZiAoISh2YWwgJiBUSU1fQ0NFUl9DQ1hFKSkKLQkJcmVnbWFwX3VwZGF0ZV9iaXRz
KHByaXYtPnJlZ21hcCwgVElNX0NSMSwgVElNX0NSMV9DRU4sIDApOworCQlyZWdtYXBfY2xlYXJf
Yml0cyhwcml2LT5yZWdtYXAsIFRJTV9DUjEsIFRJTV9DUjFfQ0VOKTsKIAogCWlmIChwcml2LT5l
bmFibGVkKQogCQljbGtfZGlzYWJsZShwcml2LT5jbGspOwpAQCAtODQxLDcgKzgzOSw3IEBAIHN0
YXRpYyBpbnQgc3RtMzJfdGltZXJfdHJpZ2dlcl9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikK
IAkJcmVnbWFwX3JlYWQocHJpdi0+cmVnbWFwLCBUSU1fU01DUiwgJnByaXYtPmJhay5zbWNyKTsK
IAogCQkvKiBEaXNhYmxlIHRoZSB0aW1lciAqLwotCQlyZWdtYXBfdXBkYXRlX2JpdHMocHJpdi0+
cmVnbWFwLCBUSU1fQ1IxLCBUSU1fQ1IxX0NFTiwgMCk7CisJCXJlZ21hcF9jbGVhcl9iaXRzKHBy
aXYtPnJlZ21hcCwgVElNX0NSMSwgVElNX0NSMV9DRU4pOwogCQljbGtfZGlzYWJsZShwcml2LT5j
bGspOwogCX0KIAotLSAKMi40NS4yCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpMaW51eC1zdG0zMiBtYWlsaW5nIGxpc3QKTGludXgtc3RtMzJAc3QtbWQt
bWFpbG1hbi5zdG9ybXJlcGx5LmNvbQpodHRwczovL3N0LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5j
b20vbWFpbG1hbi9saXN0aW5mby9saW51eC1zdG0zMgo=
