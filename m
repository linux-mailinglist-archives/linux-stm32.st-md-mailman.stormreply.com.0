Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id B108C84B3E6
	for <lists+linux-stm32@lfdr.de>; Tue,  6 Feb 2024 12:46:30 +0100 (CET)
Received: from ip-172-31-3-47.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 73748C6B463;
	Tue,  6 Feb 2024 11:46:30 +0000 (UTC)
Received: from mx07-00178001.pphosted.com (mx07-00178001.pphosted.com
 [185.132.182.106])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 3A727C6907A
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Tue,  6 Feb 2024 11:46:29 +0000 (UTC)
Received: from pps.filterd (m0241204.ppops.net [127.0.0.1])
 by mx07-00178001.pphosted.com (8.17.1.24/8.17.1.24) with ESMTP id
 4167ja4O018633; Tue, 6 Feb 2024 12:45:55 +0100
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=foss.st.com; h=
 from:date:subject:mime-version:content-type
 :content-transfer-encoding:message-id:references:in-reply-to:to
 :cc; s=selector1; bh=fgScmsCpf3HxClbFItwqeK57BtQYYUo9tfFNoxM0exE
 =; b=aV4I1ze3kL9U2U1q8c++mHq24Q5ZwIl4l7vL8rm5ceOVRlbCaMJ8WqQ7JAA
 fSVGEVp1OxynSNb2uwj8gwEEfkEuKIpq3MwCXdFJEWksoazNnYyjrwH8yjgWixFV
 mCNmSniqxodn2FOgMzU1TyM8fDbBbGBS7u0eN8sYbcqCBEagdx2uxgll5oApiI9v
 kQfS6+zILVOwaBDbLgAJZgdD+cJuwnQmFx/Zx9uGisSaUrg30EouXTK1k13jaOBm
 rcQlBVIWAyWkN2shUk92HjELVPo3re6n5mbYdd6Pheth2XKPJa6QYdUMmMXAAJ1A
 xtITo/BTVo2nwUVu6m23WR0wHZw==
Received: from beta.dmz-eu.st.com (beta.dmz-eu.st.com [164.129.1.35])
 by mx07-00178001.pphosted.com (PPS) with ESMTPS id 3w1ewp35by-1
 (version=TLSv1.2 cipher=ECDHE-RSA-AES256-GCM-SHA384 bits=256 verify=NOT);
 Tue, 06 Feb 2024 12:45:55 +0100 (CET)
Received: from euls16034.sgp.st.com (euls16034.sgp.st.com [10.75.44.20])
 by beta.dmz-eu.st.com (STMicroelectronics) with ESMTP id 1E288100061;
 Tue,  6 Feb 2024 12:45:55 +0100 (CET)
Received: from Webmail-eu.st.com (shfdag1node2.st.com [10.75.129.70])
 by euls16034.sgp.st.com (STMicroelectronics) with ESMTP id 1506523D408;
 Tue,  6 Feb 2024 12:45:55 +0100 (CET)
Received: from localhost (10.129.178.155) by SHFDAG1NODE2.st.com
 (10.75.129.70) with Microsoft SMTP Server (version=TLS1_2,
 cipher=TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256) id 15.1.2507.27; Tue, 6 Feb
 2024 12:45:54 +0100
From: Raphael Gallais-Pou <raphael.gallais-pou@foss.st.com>
Date: Tue, 6 Feb 2024 12:45:35 +0100
MIME-Version: 1.0
Message-ID: <20240206-lvds-v5-2-bd16797b0f09@foss.st.com>
References: <20240206-lvds-v5-0-bd16797b0f09@foss.st.com>
In-Reply-To: <20240206-lvds-v5-0-bd16797b0f09@foss.st.com>
To: David Airlie <airlied@gmail.com>, Daniel Vetter <daniel@ffwll.ch>, Maarten
 Lankhorst <maarten.lankhorst@linux.intel.com>, Maxime Ripard
 <mripard@kernel.org>, Thomas Zimmermann <tzimmermann@suse.de>, Rob Herring
 <robh+dt@kernel.org>, Krzysztof Kozlowski
 <krzysztof.kozlowski+dt@linaro.org>, Conor Dooley <conor+dt@kernel.org>,
 Maxime Coquelin <mcoquelin.stm32@gmail.com>, Alexandre Torgue
 <alexandre.torgue@foss.st.com>,
 Yannick Fertre <yannick.fertre@foss.st.com>,
 Philippe Cornu <philippe.cornu@foss.st.com>, Philipp Zabel
 <p.zabel@pengutronix.de>
X-Mailer: b4 0.12.4
X-Originating-IP: [10.129.178.155]
X-ClientProxiedBy: EQNCAS1NODE4.st.com (10.75.129.82) To SHFDAG1NODE2.st.com
 (10.75.129.70)
X-Proofpoint-Virus-Version: vendor=baseguard
 engine=ICAP:2.0.272,Aquarius:18.0.1011,Hydra:6.0.619,FMLib:17.11.176.26
 definitions=2024-02-06_04,2024-01-31_01,2023-05-22_02
Cc: devicetree@vger.kernel.org, linux-kernel@vger.kernel.org,
 dri-devel@lists.freedesktop.org, linux-stm32@st-md-mailman.stormreply.com,
 linux-arm-kernel@lists.infradead.org
Subject: [Linux-stm32] [PATCH v5 2/3] drm/stm: lvds: add new STM32 LVDS
 Display Interface Transmitter driver
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

VGhlIExvdy1Wb2x0YWdlIERpZmZlcmVudGlhbCBTaWduYWxpbmcgKExWRFMpIERpc3BsYXkgSW50
ZXJmYWNlClRyYW5zbWl0dGVyIGhhbmRsZXMgdGhlIExWRFMgcHJvdG9jb2w6IGl0IG1hcHMgdGhl
IHBpeGVscyByZWNlaXZlZCBmcm9tCnRoZSB1cHN0cmVhbSBQaXhlbC1ETUEgTENELVRGVCBEaXNw
bGF5IENvbnRyb2xsZXIgKExUREMpIG9udG8gdGhlIExWRFMKUEhZLgoKSXQgaXMgY29tcG9zZWQg
b2YgdGhyZWUgc3ViIGJsb2NrczoKCSogTFZEUyBob3N0OiBoYW5kbGVzIHRoZSBMVkRTIHByb3Rv
Y29sIChGUEQgLyBPcGVuTERJKSBhbmQgbWFwcwoJICBpdHMgaW5wdXQgcGl4ZWxzIG9udG8gdGhl
IGRhdGEgbGFuZXMgb2YgdGhlIFBIWQoJKiBMVkRTIFBIWTogcGFyYWxsZWxpemUgdGhlIGRhdGEg
YW5kIGRyaXZlcyB0aGUgTFZEUyBkYXRhIGxhbmVzCgkqIExWRFMgd3JhcHBlcjogaGFuZGxlcyB0
b3AtbGV2ZWwgc2V0dGluZ3MKClRoZSBMVkRTIGNvbnRyb2xsZXIgZHJpdmVyIHN1cHBvcnRzIHRo
ZSBmb2xsb3dpbmcgaGlnaC1sZXZlbCBmZWF0dXJlczoKCSogRkRQLUxpbmstSSBhbmQgT3BlbkxE
SSAodjAuOTUpIHByb3RvY29scwoJKiBTaW5nbGUtTGluayBvciBEdWFsLUxpbmsgb3BlcmF0aW9u
CgkqIFNpbmdsZS1EaXNwbGF5IG9yIERvdWJsZS1EaXNwbGF5ICh3aXRoIHRoZSBzYW1lIGNvbnRl
bnQKCSAgZHVwbGljYXRlZCBvbiBib3RoKQoJKiBGbGV4aWJsZSBCaXQtTWFwcGluZywgaW5jbHVk
aW5nIEpFSURBIGFuZCBWRVNBCgkqIFJHQjg4OCBvciBSR0I2NjYgb3V0cHV0CgkqIFN5bmNocm9u
b3VzIGRlc2lnbiwgd2l0aCBvbmUgaW5wdXQgcGl4ZWwgcGVyIGNsb2NrIGN5Y2xlCgpTaWduZWQt
b2ZmLWJ5OiBSYXBoYWVsIEdhbGxhaXMtUG91IDxyYXBoYWVsLmdhbGxhaXMtcG91QGZvc3Muc3Qu
Y29tPgotLS0KQ2hhbmdlcyBpbiB2NToKCS0gQWxpZ24gY29tcGF0aWJsZQoKQ2hhbmdlcyBpbiB2
NDoKCS0gRXhwbGljaXRseSBpbmNsdWRlIGxpbnV4L3BsYXRmb3JtX2RldmljZS5oLCBkZXBlbmRl
bmN5IGludHJvZHVjZWQgYnkKCWVmMTc1YjI5YTI0MiBvZjogU3RvcCBjaXJjdWxhcmx5IGluY2x1
ZGluZyBvZl9kZXZpY2UuaCBhbmQgb2ZfcGxhdGZvcm0uaAoKQ2hhbmdlcyBpbiB2MzoKCS0gcy9y
ZWdyb3Vwcy9pcyBjb21wb3NlZCBvZi8gaW4gY29tbWl0IGxvZwoJLSBDaGFuZ2UgdGhlIGNvbXBh
dGlibGUgdG8gc2hvdyBTb0Mgc3BlY2lmaWNpdHkKCkNoYW5nZXMgaW4gdjI6CgktIEZpeGVkIENh
bWVsIENhc2UgbWFjcm9zCgktIFJlbW92ZWQgZGVidWcgbG9nCi0tLQogZHJpdmVycy9ncHUvZHJt
L3N0bS9LY29uZmlnICB8ICAgMTEgKwogZHJpdmVycy9ncHUvZHJtL3N0bS9NYWtlZmlsZSB8ICAg
IDIgKwogZHJpdmVycy9ncHUvZHJtL3N0bS9sdmRzLmMgICB8IDEyMjYgKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDEyMzkgaW5zZXJ0
aW9ucygrKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9zdG0vS2NvbmZpZyBiL2RyaXZl
cnMvZ3B1L2RybS9zdG0vS2NvbmZpZwppbmRleCBmYTQ5Y2RlNDNiYjIuLjk2Mjc4MTRkMDI3YyAx
MDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL3N0bS9LY29uZmlnCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9zdG0vS2NvbmZpZwpAQCAtMjAsMyArMjAsMTQgQEAgY29uZmlnIERSTV9TVE1fRFNJCiAJ
c2VsZWN0IERSTV9EV19NSVBJX0RTSQogCWhlbHAKIAkgIENob29zZSB0aGlzIG9wdGlvbiBmb3Ig
TUlQSSBEU0kgc3VwcG9ydCBvbiBTVE1pY3JvZWxlY3Ryb25pY3MgU29DLgorCitjb25maWcgRFJN
X1NUTV9MVkRTCisJdHJpc3RhdGUgIlNUTWljcm9lbGVjdHJvbmljcyBMVkRTIERpc3BsYXkgSW50
ZXJmYWNlIFRyYW5zbWl0dGVyIERSTSBkcml2ZXIiCisJZGVwZW5kcyBvbiBEUk1fU1RNCisJaGVs
cAorCSAgRW5hYmxlIHN1cHBvcnQgZm9yIExWRFMgZW5jb2RlcnMgb24gU1RNaWNyb2VsZWN0cm9u
aWNzIFNvQy4KKwkgIFRoZSBTVE0gTFZEUyBpcyBhIGJyaWRnZSB3aGljaCBzZXJpYWxpemUgcGl4
ZWwgc3RyZWFtIG9udG8KKwkgIGEgTFZEUyBwcm90b2NvbC4KKworCSAgVG8gY29tcGlsZSB0aGlz
IGRyaXZlciBhcyBhIG1vZHVsZSwgY2hvb3NlIE0gaGVyZTogdGhlIG1vZHVsZSB3aWxsIGJlCisJ
ICBjYWxsZWQgbHZkcy4KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9zdG0vTWFrZWZpbGUg
Yi9kcml2ZXJzL2dwdS9kcm0vc3RtL01ha2VmaWxlCmluZGV4IDRkZjVjYWYwMWYzNS4uYWQ3NDBk
NjE3NWE2IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vc3RtL01ha2VmaWxlCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS9zdG0vTWFrZWZpbGUKQEAgLTUsNCArNSw2IEBAIHN0bS1kcm0teSA6PSBc
CiAKIG9iai0kKENPTkZJR19EUk1fU1RNX0RTSSkgKz0gZHdfbWlwaV9kc2ktc3RtLm8KIAorb2Jq
LSQoQ09ORklHX0RSTV9TVE1fTFZEUykgKz0gbHZkcy5vCisKIG9iai0kKENPTkZJR19EUk1fU1RN
KSArPSBzdG0tZHJtLm8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9zdG0vbHZkcy5jIGIv
ZHJpdmVycy9ncHUvZHJtL3N0bS9sdmRzLmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAw
MDAwMDAwMDAwLi40NjE2NTQ0Y2I4ODYKLS0tIC9kZXYvbnVsbAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vc3RtL2x2ZHMuYwpAQCAtMCwwICsxLDEyMjYgQEAKKy8vIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wLW9ubHkKKy8qCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMsIFNUTWljcm9lbGVj
dHJvbmljcyAtIEFsbCBSaWdodHMgUmVzZXJ2ZWQKKyAqIEF1dGhvcihzKTogUmFwaGHDq2wgR0FM
TEFJUy1QT1UgPHJhcGhhZWwuZ2FsbGFpcy1wb3VAZm9zcy5zdC5jb20+IGZvciBTVE1pY3JvZWxl
Y3Ryb25pY3MuCisgKi8KKworI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPgorI2lu
Y2x1ZGUgPGRybS9kcm1fYnJpZGdlLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4KKyNp
bmNsdWRlIDxkcm0vZHJtX29mLmg+CisjaW5jbHVkZSA8ZHJtL2RybV9wYW5lbC5oPgorI2luY2x1
ZGUgPGRybS9kcm1fcHJpbnQuaD4KKyNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPgor
CisjaW5jbHVkZSA8bGludXgvY2xrLmg+CisjaW5jbHVkZSA8bGludXgvY2xrLXByb3ZpZGVyLmg+
CisjaW5jbHVkZSA8bGludXgvaW8uaD4KKyNpbmNsdWRlIDxsaW51eC9pb3BvbGwuaD4KKyNpbmNs
dWRlIDxsaW51eC9tZWRpYS1idXMtZm9ybWF0Lmg+CisjaW5jbHVkZSA8bGludXgvbW9kdWxlLmg+
CisjaW5jbHVkZSA8bGludXgvb2ZfZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1f
ZGV2aWNlLmg+CisjaW5jbHVkZSA8bGludXgvcmVzZXQuaD4KKworLyogTFZEUyBIb3N0IHJlZ2lz
dGVycyAqLworI2RlZmluZSBMVkRTX0NSCQkweDAwMDAgIC8qIGNvbmZpZ3VyYXRpb24gcmVnaXN0
ZXIgKi8KKyNkZWZpbmUgTFZEU19ETUxDUjAJMHgwMDA0ICAvKiBkYXRhIG1hcHBpbmcgbHNiIGNv
bmZpZ3VyYXRpb24gcmVnaXN0ZXIgMCAqLworI2RlZmluZSBMVkRTX0RNTUNSMAkweDAwMDggIC8q
IGRhdGEgbWFwcGluZyBtc2IgY29uZmlndXJhdGlvbiByZWdpc3RlciAwICovCisjZGVmaW5lIExW
RFNfRE1MQ1IxCTB4MDAwQyAgLyogZGF0YSBtYXBwaW5nIGxzYiBjb25maWd1cmF0aW9uIHJlZ2lz
dGVyIDEgKi8KKyNkZWZpbmUgTFZEU19ETU1DUjEJMHgwMDEwICAvKiBkYXRhIG1hcHBpbmcgbXNi
IGNvbmZpZ3VyYXRpb24gcmVnaXN0ZXIgMSAqLworI2RlZmluZSBMVkRTX0RNTENSMgkweDAwMTQg
IC8qIGRhdGEgbWFwcGluZyBsc2IgY29uZmlndXJhdGlvbiByZWdpc3RlciAyICovCisjZGVmaW5l
IExWRFNfRE1NQ1IyCTB4MDAxOCAgLyogZGF0YSBtYXBwaW5nIG1zYiBjb25maWd1cmF0aW9uIHJl
Z2lzdGVyIDIgKi8KKyNkZWZpbmUgTFZEU19ETUxDUjMJMHgwMDFDICAvKiBkYXRhIG1hcHBpbmcg
bHNiIGNvbmZpZ3VyYXRpb24gcmVnaXN0ZXIgMyAqLworI2RlZmluZSBMVkRTX0RNTUNSMwkweDAw
MjAgIC8qIGRhdGEgbWFwcGluZyBtc2IgY29uZmlndXJhdGlvbiByZWdpc3RlciAzICovCisjZGVm
aW5lIExWRFNfRE1MQ1I0CTB4MDAyNCAgLyogZGF0YSBtYXBwaW5nIGxzYiBjb25maWd1cmF0aW9u
IHJlZ2lzdGVyIDQgKi8KKyNkZWZpbmUgTFZEU19ETU1DUjQJMHgwMDI4ICAvKiBkYXRhIG1hcHBp
bmcgbXNiIGNvbmZpZ3VyYXRpb24gcmVnaXN0ZXIgNCAqLworI2RlZmluZSBMVkRTX0NETDFDUgkw
eDAwMkMgIC8qIGNoYW5uZWwgZGlzdHJpYiBsaW5rIDEgY29uZmlndXJhdGlvbiByZWdpc3RlciAq
LworI2RlZmluZSBMVkRTX0NETDJDUgkweDAwMzAgIC8qIGNoYW5uZWwgZGlzdHJpYiBsaW5rIDIg
Y29uZmlndXJhdGlvbiByZWdpc3RlciAqLworCisjZGVmaW5lIENETDFDUl9ERUZBVUxUCTB4MDQz
MjEgLyogRGVmYXVsdCB2YWx1ZSBmb3IgQ0RMMUNSICovCisjZGVmaW5lIENETDJDUl9ERUZBVUxU
CTB4NTk4NzYgLyogRGVmYXVsdCB2YWx1ZSBmb3IgQ0RMMkNSICovCisKKyNkZWZpbmUgTFZEU19E
TUxDUihiaXQpCShMVkRTX0RNTENSMCArIDB4OCAqIChiaXQpKQorI2RlZmluZSBMVkRTX0RNTUNS
KGJpdCkJKExWRFNfRE1NQ1IwICsgMHg4ICogKGJpdCkpCisKKy8qIExWRFMgV3JhcHBlciByZWdp
c3RlcnMgKi8KKyNkZWZpbmUgTFZEU19XQ0xLQ1IJMHgxMUIwICAvKiBXcmFwcGVyIGNsb2NrIGNv
bnRyb2wgcmVnaXN0ZXIgKi8KKworI2RlZmluZSBMVkRTX0hXQ0ZHUgkweDFGRjAgIC8qIEhXIGNv
bmZpZ3VyYXRpb24gcmVnaXN0ZXIJKi8KKyNkZWZpbmUgTFZEU19WRVJSCTB4MUZGNCAgLyogVmVy
c2lvbiByZWdpc3RlcgkqLworI2RlZmluZSBMVkRTX0lQSURSCTB4MUZGOCAgLyogSWRlbnRpZmlj
YXRpb24gcmVnaXN0ZXIJKi8KKyNkZWZpbmUgTFZEU19TSURSCTB4MUZGQyAgLyogU2l6ZSBJZGVu
dGlmaWNhdGlvbiByZWdpc3RlcgkqLworCisvKiBCaXRmaWVsZCBkZXNjcmlwdGlvbiAqLworI2Rl
ZmluZSBDUl9MVkRTRU4JQklUKDApICAvKiBMVkRTIFBIWSBFbmFibGUgKi8KKyNkZWZpbmUgQ1Jf
SFNQT0wJQklUKDEpICAvKiBIb3Jpem9udGFsIFN5bmNocm9uaXphdGlvbiBQb2xhcml0eSAqLwor
I2RlZmluZSBDUl9WU1BPTAlCSVQoMikgIC8qIFZlcnRpY2FsIFN5bmNocm9uaXphdGlvbiBQb2xh
cml0eSAqLworI2RlZmluZSBDUl9ERVBPTAlCSVQoMykgIC8qIERhdGEgRW5hYmxlIFBvbGFyaXR5
ICovCisjZGVmaW5lIENSX0NJCQlCSVQoNCkgIC8qIENvbnRyb2wgSW50ZXJuYWwgKHNvZnR3YXJl
IGNvbnRyb2xsZWQgYml0KSAqLworI2RlZmluZSBDUl9MS01PRAlCSVQoNSkgIC8qIExpbmsgTW9k
ZSwgZm9yIGJvdGggTGlua3MgKi8KKyNkZWZpbmUgQ1JfTEtQSEEJQklUKDYpICAvKiBMaW5rIFBo
YXNlLCBmb3IgYm90aCBMaW5rcyAqLworI2RlZmluZSBDUl9MSzFQT0wJR0VOTUFTSygyMCwgMTYp
ICAvKiBMaW5rLTEgb3V0cHV0IFBvbGFyaXR5ICovCisjZGVmaW5lIENSX0xLMlBPTAlHRU5NQVNL
KDI1LCAyMSkgIC8qIExpbmstMiBvdXRwdXQgUG9sYXJpdHkgKi8KKworI2RlZmluZSBETU1DUl9N
QVAwCUdFTk1BU0soNCwgMCkgLyogTWFwcGluZyBmb3IgYml0IDAgb2YgZGF0YWxhbmUgeCAqLwor
I2RlZmluZSBETU1DUl9NQVAxCUdFTk1BU0soOSwgNSkgLyogTWFwcGluZyBmb3IgYml0IDEgb2Yg
ZGF0YWxhbmUgeCAqLworI2RlZmluZSBETU1DUl9NQVAyCUdFTk1BU0soMTQsIDEwKSAvKiBNYXBw
aW5nIGZvciBiaXQgMiBvZiBkYXRhbGFuZSB4ICovCisjZGVmaW5lIERNTUNSX01BUDMJR0VOTUFT
SygxOSwgMTUpIC8qIE1hcHBpbmcgZm9yIGJpdCAzIG9mIGRhdGFsYW5lIHggKi8KKyNkZWZpbmUg
RE1MQ1JfTUFQNAlHRU5NQVNLKDQsIDApIC8qIE1hcHBpbmcgZm9yIGJpdCA0IG9mIGRhdGFsYW5l
IHggKi8KKyNkZWZpbmUgRE1MQ1JfTUFQNQlHRU5NQVNLKDksIDUpIC8qIE1hcHBpbmcgZm9yIGJp
dCA1IG9mIGRhdGFsYW5lIHggKi8KKyNkZWZpbmUgRE1MQ1JfTUFQNglHRU5NQVNLKDE0LCAxMCkg
LyogTWFwcGluZyBmb3IgYml0IDYgb2YgZGF0YWxhbmUgeCAqLworCisjZGVmaW5lIENETENSX0RJ
U1RSMAlHRU5NQVNLKDMsIDApIC8qIENoYW5uZWwgZGlzdHJpYnV0aW9uIGZvciBsYW5lIDAgKi8K
KyNkZWZpbmUgQ0RMQ1JfRElTVFIxCUdFTk1BU0soNywgNCkgLyogQ2hhbm5lbCBkaXN0cmlidXRp
b24gZm9yIGxhbmUgMSAqLworI2RlZmluZSBDRExDUl9ESVNUUjIJR0VOTUFTSygxMSwgOCkgLyog
Q2hhbm5lbCBkaXN0cmlidXRpb24gZm9yIGxhbmUgMiAqLworI2RlZmluZSBDRExDUl9ESVNUUjMJ
R0VOTUFTSygxNSwgMTIpIC8qIENoYW5uZWwgZGlzdHJpYnV0aW9uIGZvciBsYW5lIDMgKi8KKyNk
ZWZpbmUgQ0RMQ1JfRElTVFI0CUdFTk1BU0soMTksIDE2KSAvKiBDaGFubmVsIGRpc3RyaWJ1dGlv
biBmb3IgbGFuZSA0ICovCisKKyNkZWZpbmUgUEhZX0dDUl9CSVRfQ0xLX09VVAlCSVQoMCkgIC8q
IEJJVCBjbG9jayBlbmFibGUgKi8KKyNkZWZpbmUgUEhZX0dDUl9MU19DTEtfT1VUCUJJVCg0KSAg
LyogTFMgY2xvY2sgZW5hYmxlICovCisjZGVmaW5lIFBIWV9HQ1JfRFBfQ0xLX09VVAlCSVQoOCkg
IC8qIERQIGNsb2NrIGVuYWJsZSAqLworI2RlZmluZSBQSFlfR0NSX1JTVFoJCUJJVCgyNCkgLyog
TFZEUyBQSFkgZGlnaXRhbCByZXNldCAqLworI2RlZmluZSBQSFlfR0NSX0RJVl9SU1ROCUJJVCgy
NSkgLyogT3V0cHV0IGRpdmlkZXIgcmVzZXQgKi8KKyNkZWZpbmUgUEhZX1NDUl9UWF9FTgkJQklU
KDE2KSAvKiBUcmFuc21pc3Npb24gbW9kZSBlbmFibGUgKi8KKy8qIEN1cnJlbnQgbW9kZSBkcml2
ZXIgZW5hYmxlICovCisjZGVmaW5lIFBIWV9DTUNSX0NNX0VOX0RMCShCSVQoMjgpIHwgQklUKDIw
KSB8IEJJVCgxMikgfCBCSVQoNCkpCisjZGVmaW5lIFBIWV9DTUNSX0NNX0VOX0RMNAlCSVQoNCkK
Ky8qIEJpYXMgZW5hYmxlICovCisjZGVmaW5lIFBIWV9CQ1IxX0VOX0JJQVNfREwJKEJJVCgxNikg
fCBCSVQoMTIpIHwgQklUKDgpIHwgQklUKDQpIHwgQklUKDApKQorI2RlZmluZSBQSFlfQkNSMl9C
SUFTX0VOCUJJVCgyOCkKKy8qIFZvbHRhZ2UgbW9kZSBkcml2ZXIgZW5hYmxlICovCisjZGVmaW5l
IFBIWV9CQ1IzX1ZNX0VOX0RMCShCSVQoMTYpIHwgQklUKDEyKSB8IEJJVCg4KSB8IEJJVCg0KSB8
IEJJVCgwKSkKKyNkZWZpbmUgUEhZX0RDUl9QT1dFUl9PSwlCSVQoMTIpCisjZGVmaW5lIFBIWV9D
RkdDUl9FTl9ESUdfREwJR0VOTUFTSyg0LCAwKSAvKiBMVkRTIFBIWSBkaWdpdGFsIGxhbmUgZW5h
YmxlICovCisjZGVmaW5lIFBIWV9QTExDUjFfUExMX0VOCUJJVCgwKSAvKiBMVkRTIFBIWSBQTEwg
ZW5hYmxlICovCisjZGVmaW5lIFBIWV9QTExDUjFfRU5fU0QJQklUKDEpIC8qIExWRFMgUEhZIFBM
TCBzaWdtYS1kZWx0YSBzaWduYWwgZW5hYmxlICovCisjZGVmaW5lIFBIWV9QTExDUjFfRU5fVFdH
CUJJVCgyKSAvKiBMVkRTIFBIWSBQTEwgdHJpYW5ndWxhciB3YXZlIGdlbmVyYXRvciBlbmFibGUg
Ki8KKyNkZWZpbmUgUEhZX1BMTENSMV9ESVZfRU4JQklUKDgpIC8qIExWRFMgUEhZIFBMTCBkaXZp
ZGVycyBlbmFibGUgKi8KKyNkZWZpbmUgUEhZX1BMTENSMl9ORElWCQlHRU5NQVNLKDI1LCAxNikg
LyogTkRJViBtYXNrIHZhbHVlICovCisjZGVmaW5lIFBIWV9QTExDUjJfQkRJVgkJR0VOTUFTSyg5
LCAwKSAgIC8qIEJESVYgbWFzayB2YWx1ZSAqLworI2RlZmluZSBQSFlfUExMU1JfUExMX0xPQ0sJ
QklUKDApIC8qIExWRFMgUEhZIFBMTCBsb2NrIHN0YXR1cyAqLworI2RlZmluZSBQSFlfUExMU0RD
UjFfTURJVglHRU5NQVNLKDksIDApICAgLyogTURJViBtYXNrIHZhbHVlICovCisjZGVmaW5lIFBI
WV9QTExURVNUQ1JfVERJVglHRU5NQVNLKDI1LCAxNikgLyogVERJViBtYXNrIHZhbHVlICovCisj
ZGVmaW5lIFBIWV9QTExURVNUQ1JfQ0xLX0VOCUJJVCgwKSAvKiBUZXN0IGNsb2NrIGVuYWJsZSAq
LworI2RlZmluZSBQSFlfUExMVEVTVENSX0VOCUJJVCg4KSAvKiBUZXN0IGRpdmlkZXIgb3V0cHV0
IGVuYWJsZSAqLworCisjZGVmaW5lIFdDTEtDUl9TRUNORF9DTEtQSVhfU0VMCUJJVCgwKSAvKiBQ
aXhlbCBjbG9jayBzZWxlY3Rpb24gKi8KKyNkZWZpbmUgV0NMS0NSX1NSQ1NFTAkJQklUKDgpIC8q
IFNvdXJjZSBzZWxlY3Rpb24gZm9yIHRoZSBwaXhlbCBjbG9jayAqLworCisvKiBTbGVlcCAmIHRp
bWVvdXQgZm9yIHBsbCBsb2NrL3VubG9jayAqLworI2RlZmluZSBTTEVFUF9VUwkxMDAwCisjZGVm
aW5lIFRJTUVPVVRfVVMJMjAwMDAwCisKKy8qCisgKiBUaGUgbGluayBwaGFzZSBkZWZpbmVzIHdo
ZXRoZXIgYW4gT0REIHBpeGVsIGlzIGNhcnJpZWQgb3ZlciB0b2dldGhlciB3aXRoCisgKiB0aGUg
bmV4dCBFVkVOIHBpeGVsIG9yIHRvZ2V0aGVyIHdpdGggdGhlIHByZXZpb3VzIEVWRU4gcGl4ZWwu
CisgKgorICogTFZEU19EVUFMX0xJTktfRVZFTl9PRERfUElYRUxTIChMS1BIQSA9IDApCisgKgor
ICogLC0tLS0tLS0tLiAgLC0tLS0tLS0tLiAgLC0tLS0tLS0tLiAgLC0tLS0tLS0tLiAgLC0tLS0t
LS0tLS4KKyAqIHwgT0REICBMSyBcLyBQSVhFTCAgMyBcLyBQSVhFTCAgMSBcLyBQSVhFTCcgMSBc
LyBQSVhFTCcgMyB8CisgKiB8IEVWRU4gTEsgL1wgUElYRUwgIDIgL1wgUElYRUwnIDAgL1wgUElY
RUwnIDIgL1wgUElYRUwnIDQgfAorICogYC0tLS0tLS0tJyAgYC0tLS0tLS0tJyAgYC0tLS0tLS0t
JyAgYC0tLS0tLS0tJyAgYC0tLS0tLS0tLScKKyAqCisgKiBMVkRTX0RVQUxfTElOS19PRERfRVZF
Tl9QSVhFTFMgKExLUEhBID0gMSkKKyAqCisgKiAsLS0tLS0tLS0uICAsLS0tLS0tLS0uICAsLS0t
LS0tLS0uICAsLS0tLS0tLS0uICAsLS0tLS0tLS0tLgorICogfCBPREQgIExLIFwvIFBJWEVMICAz
IFwvIFBJWEVMICAxIFwvIFBJWEVMJyAxIFwvIFBJWEVMJyAzIHwKKyAqIHwgRVZFTiBMSyAvXCBQ
SVhFTCAgNCAvXCBQSVhFTCAgMiAvXCBQSVhFTCcgMCAvXCBQSVhFTCcgMiB8CisgKiBgLS0tLS0t
LS0nICBgLS0tLS0tLS0nICBgLS0tLS0tLS0nICBgLS0tLS0tLS0nICBgLS0tLS0tLS0tJworICoK
KyAqLworZW51bSBsdmRzX2xpbmtfdHlwZSB7CisJTFZEU19TSU5HTEVfTElOS19QUklNQVJZID0g
MCwKKwlMVkRTX1NJTkdMRV9MSU5LX1NFQ09OREFSWSwKKwlMVkRTX0RVQUxfTElOS19FVkVOX09E
RF9QSVhFTFMsCisJTFZEU19EVUFMX0xJTktfT0REX0VWRU5fUElYRUxTLAorfTsKKworZW51bSBs
dmRzX3BpeGVsIHsKKwlQSVhfUl8wID0gMCwKKwlQSVhfUl8xLAorCVBJWF9SXzIsCisJUElYX1Jf
MywKKwlQSVhfUl80LAorCVBJWF9SXzUsCisJUElYX1JfNiwKKwlQSVhfUl83LAorCVBJWF9HXzAs
CisJUElYX0dfMSwKKwlQSVhfR18yLAorCVBJWF9HXzMsCisJUElYX0dfNCwKKwlQSVhfR181LAor
CVBJWF9HXzYsCisJUElYX0dfNywKKwlQSVhfQl8wLAorCVBJWF9CXzEsCisJUElYX0JfMiwKKwlQ
SVhfQl8zLAorCVBJWF9CXzQsCisJUElYX0JfNSwKKwlQSVhfQl82LAorCVBJWF9CXzcsCisJUElY
X0hfUywKKwlQSVhfVl9TLAorCVBJWF9EX0UsCisJUElYX0NfRSwKKwlQSVhfQ19JLAorCVBJWF9U
T0csCisJUElYX09ORSwKKwlQSVhfWkVSLAorfTsKKworc3RydWN0IHBoeV9yZWdfb2Zmc2V0cyB7
CisJdTMyIEdDUjsJLyogR2xvYmFsIENvbnRyb2wgUmVnaXN0ZXIJKi8KKwl1MzIgQ01DUjE7ICAg
IC8qIEN1cnJlbnQgTW9kZSBDb250cm9sIFJlZ2lzdGVyIDEgKi8KKwl1MzIgQ01DUjI7ICAgIC8q
IEN1cnJlbnQgTW9kZSBDb250cm9sIFJlZ2lzdGVyIDIgKi8KKwl1MzIgU0NSOyAgICAgIC8qIFNl
cmlhbCBDb250cm9sIFJlZ2lzdGVyCSovCisJdTMyIEJDUjE7ICAgICAvKiBCaWFzIENvbnRyb2wg
UmVnaXN0ZXIgMQkqLworCXUzMiBCQ1IyOyAgICAgLyogQmlhcyBDb250cm9sIFJlZ2lzdGVyIDIJ
Ki8KKwl1MzIgQkNSMzsgICAgIC8qIEJpYXMgQ29udHJvbCBSZWdpc3RlciAzCSovCisJdTMyIE1Q
TENSOyAgICAvKiBNb25pdG9yIFBMTCBMb2NrIENvbnRyb2wgUmVnaXN0ZXIgKi8KKwl1MzIgRENS
OyAgICAgIC8qIERlYnVnIENvbnRyb2wgUmVnaXN0ZXIJKi8KKwl1MzIgU1NSMTsgICAgIC8qIFNw
YXJlIFN0YXR1cyBSZWdpc3RlciAxCSovCisJdTMyIENGR0NSOyAgICAvKiBDb25maWd1cmF0aW9u
IENvbnRyb2wgUmVnaXN0ZXIgKi8KKwl1MzIgUExMQ1IxOyAgIC8qIFBMTF9NT0RFIDEgQ29udHJv
bCBSZWdpc3RlcgkqLworCXUzMiBQTExDUjI7ICAgLyogUExMX01PREUgMiBDb250cm9sIFJlZ2lz
dGVyCSovCisJdTMyIFBMTFNSOyAgICAvKiBQTEwgU3RhdHVzIFJlZ2lzdGVyCSovCisJdTMyIFBM
TFNEQ1IxOyAvKiBQTExfU0RfMSBDb250cm9sIFJlZ2lzdGVyCSovCisJdTMyIFBMTFNEQ1IyOyAv
KiBQTExfU0RfMiBDb250cm9sIFJlZ2lzdGVyCSovCisJdTMyIFBMTFRXR0NSMTsvKiBQTExfVFdH
XzEgQ29udHJvbCBSZWdpc3RlcgkqLworCXUzMiBQTExUV0dDUjI7LyogUExMX1RXR18yIENvbnRy
b2wgUmVnaXN0ZXIJKi8KKwl1MzIgUExMQ1BDUjsgIC8qIFBMTF9DUCBDb250cm9sIFJlZ2lzdGVy
CSovCisJdTMyIFBMTFRFU1RDUjsvKiBQTExfVEVTVCBDb250cm9sIFJlZ2lzdGVyCSovCit9Owor
CitzdHJ1Y3QgbHZkc19waHlfaW5mbyB7CisJdTMyIGJhc2U7CisJc3RydWN0IHBoeV9yZWdfb2Zm
c2V0cyBvZnM7Cit9OworCitzdGF0aWMgc3RydWN0IGx2ZHNfcGh5X2luZm8gbHZkc19waHlfMTZm
Zl9wcmltYXJ5ID0geworCS5iYXNlID0gMHgxMDAwLAorCS5vZnMgPSB7CisJCS5HQ1IgPSAweDAs
CisJCS5DTUNSMSA9IDB4QywKKwkJLkNNQ1IyID0gMHgxMCwKKwkJLlNDUiA9IDB4MjAsCisJCS5C
Q1IxID0gMHgyQywKKwkJLkJDUjIgPSAweDMwLAorCQkuQkNSMyA9IDB4MzQsCisJCS5NUExDUiA9
IDB4NjQsCisJCS5EQ1IgPSAweDg0LAorCQkuU1NSMSA9IDB4ODgsCisJCS5DRkdDUiA9IDB4QTAs
CisJCS5QTExDUjEgPSAweEMwLAorCQkuUExMQ1IyID0gMHhDNCwKKwkJLlBMTFNSID0gMHhDOCwK
KwkJLlBMTFNEQ1IxID0gMHhDQywKKwkJLlBMTFNEQ1IyID0gMHhEMCwKKwkJLlBMTFRXR0NSMSA9
IDB4RDQsCisJCS5QTExUV0dDUjIgPSAweEQ4LAorCQkuUExMQ1BDUiA9IDB4RTAsCisJCS5QTExU
RVNUQ1IgPSAweEU4LAorCX0KK307CisKK3N0YXRpYyBzdHJ1Y3QgbHZkc19waHlfaW5mbyBsdmRz
X3BoeV8xNmZmX3NlY29uZGFyeSA9IHsKKwkuYmFzZSA9IDB4MTEwMCwKKwkub2ZzID0geworCQku
R0NSID0gMHgwLAorCQkuQ01DUjEgPSAweEMsCisJCS5DTUNSMiA9IDB4MTAsCisJCS5TQ1IgPSAw
eDIwLAorCQkuQkNSMSA9IDB4MkMsCisJCS5CQ1IyID0gMHgzMCwKKwkJLkJDUjMgPSAweDM0LAor
CQkuTVBMQ1IgPSAweDY0LAorCQkuRENSID0gMHg4NCwKKwkJLlNTUjEgPSAweDg4LAorCQkuQ0ZH
Q1IgPSAweEEwLAorCQkuUExMQ1IxID0gMHhDMCwKKwkJLlBMTENSMiA9IDB4QzQsCisJCS5QTExT
UiA9IDB4QzgsCisJCS5QTExTRENSMSA9IDB4Q0MsCisJCS5QTExTRENSMiA9IDB4RDAsCisJCS5Q
TExUV0dDUjEgPSAweEQ0LAorCQkuUExMVFdHQ1IyID0gMHhEOCwKKwkJLlBMTENQQ1IgPSAweEUw
LAorCQkuUExMVEVTVENSID0gMHhFOCwKKwl9Cit9OworCitzdHJ1Y3Qgc3RtX2x2ZHMgeworCXZv
aWQgX19pb21lbSAqYmFzZTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXY7CisJc3RydWN0IGNsayAqcGNs
azsJCS8qIEFQQiBwZXJpcGhlcmFsIGNsb2NrICovCisJc3RydWN0IGNsayAqcGxscmVmX2NsazsJ
CS8qIFJlZmVyZW5jZSBjbG9jayBmb3IgdGhlIGludGVybmFsIFBMTCAqLworCXN0cnVjdCBjbGtf
aHcgbHZkc19ja19weDsJLyogUGl4ZWwgY2xvY2sgKi8KKwl1MzIgcGl4ZWxfY2xvY2tfcmF0ZTsJ
CS8qIFBpeGVsIGNsb2NrIHJhdGUgKi8KKworCXN0cnVjdCBsdmRzX3BoeV9pbmZvICpwcmltYXJ5
OworCXN0cnVjdCBsdmRzX3BoeV9pbmZvICpzZWNvbmRhcnk7CisKKwlzdHJ1Y3QgZHJtX2JyaWRn
ZSBsdmRzX2JyaWRnZTsKKwlzdHJ1Y3QgZHJtX2JyaWRnZSAqbmV4dF9icmlkZ2U7CisJc3RydWN0
IGRybV9jb25uZWN0b3IgY29ubmVjdG9yOworCXN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcjsK
KwlzdHJ1Y3QgZHJtX3BhbmVsICpwYW5lbDsKKworCXUzMiBod192ZXJzaW9uOworCXUzMiBsaW5r
X3R5cGU7Cit9OworCisjZGVmaW5lIGJyaWRnZV90b19zdG1fbHZkcyhiKSBcCisJY29udGFpbmVy
X29mKGIsIHN0cnVjdCBzdG1fbHZkcywgbHZkc19icmlkZ2UpCisKKyNkZWZpbmUgY29ubmVjdG9y
X3RvX3N0bV9sdmRzKGMpIFwKKwljb250YWluZXJfb2YoYywgc3RydWN0IHN0bV9sdmRzLCBjb25u
ZWN0b3IpCisKKyNkZWZpbmUgbHZkc19pc19kdWFsX2xpbmsobHZkcykgXAorCSh7CVwKKwl0eXBl
b2YobHZkcykgX19sdmRzID0gKGx2ZHMpOwlcCisJX19sdmRzID09IExWRFNfRFVBTF9MSU5LX0VW
RU5fT0REX1BJWEVMUyB8fAlcCisJX19sdmRzID09IExWRFNfRFVBTF9MSU5LX09ERF9FVkVOX1BJ
WEVMUzsJXAorCX0pCisKK3N0YXRpYyBpbmxpbmUgdm9pZCBsdmRzX3dyaXRlKHN0cnVjdCBzdG1f
bHZkcyAqbHZkcywgdTMyIHJlZywgdTMyIHZhbCkKK3sKKwl3cml0ZWwodmFsLCBsdmRzLT5iYXNl
ICsgcmVnKTsKK30KKworc3RhdGljIGlubGluZSB1MzIgbHZkc19yZWFkKHN0cnVjdCBzdG1fbHZk
cyAqbHZkcywgdTMyIHJlZykKK3sKKwlyZXR1cm4gcmVhZGwobHZkcy0+YmFzZSArIHJlZyk7Cit9
CisKK3N0YXRpYyBpbmxpbmUgdm9pZCBsdmRzX3NldChzdHJ1Y3Qgc3RtX2x2ZHMgKmx2ZHMsIHUz
MiByZWcsIHUzMiBtYXNrKQoreworCWx2ZHNfd3JpdGUobHZkcywgcmVnLCBsdmRzX3JlYWQobHZk
cywgcmVnKSB8IG1hc2spOworfQorCitzdGF0aWMgaW5saW5lIHZvaWQgbHZkc19jbGVhcihzdHJ1
Y3Qgc3RtX2x2ZHMgKmx2ZHMsIHUzMiByZWcsIHUzMiBtYXNrKQoreworCWx2ZHNfd3JpdGUobHZk
cywgcmVnLCBsdmRzX3JlYWQobHZkcywgcmVnKSAmIH5tYXNrKTsKK30KKworLyoKKyAqIEV4cGVj
dGVkIEpFSURBLVJHQjg4OCBkYXRhIHRvIGJlIHNlbnQgaW4gTFNCIGZvcm1hdAorICoJICAgIGJp
dDYgLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLmJpdDAKKyAqIENIQU4wICAge09ORSwgT05F
LCBaRVJPLCBaRVJPLCBaRVJPLCBPTkUsIE9ORX0KKyAqIENIQU4xICAge0cyLCAgUjcsICBSNiwg
ICBSNSwgICBSNCwgICBSMywgIFIyfQorICogQ0hBTjIgICB7QjMsICBCMiwgIEc3LCAgIEc2LCAg
IEc1LCAgIEc0LCAgRzN9CisgKiBDSEFOMyAgIHtERSwgIFZTLCAgSFMsICAgQjcsICAgQjYsICAg
QjUsICBCNH0KKyAqIENIQU40ICAge0NFLCAgQjEsICBCMCwgICBHMSwgICBHMCwgICBSMSwgIFIw
fQorICovCitlbnVtIGx2ZHNfcGl4ZWwgbHZkc19iaXRtYXBfamVpZGFfcmdiODg4WzVdWzddID0g
eworCXsgUElYX09ORSwgUElYX09ORSwgUElYX1pFUiwgUElYX1pFUiwgUElYX1pFUiwgUElYX09O
RSwgUElYX09ORSB9LAorCXsgUElYX0dfMiwgUElYX1JfNywgUElYX1JfNiwgUElYX1JfNSwgUElY
X1JfNCwgUElYX1JfMywgUElYX1JfMiB9LAorCXsgUElYX0JfMywgUElYX0JfMiwgUElYX0dfNywg
UElYX0dfNiwgUElYX0dfNSwgUElYX0dfNCwgUElYX0dfMyB9LAorCXsgUElYX0RfRSwgUElYX1Zf
UywgUElYX0hfUywgUElYX0JfNywgUElYX0JfNiwgUElYX0JfNSwgUElYX0JfNCB9LAorCXsgUElY
X0NfRSwgUElYX0JfMSwgUElYX0JfMCwgUElYX0dfMSwgUElYX0dfMCwgUElYX1JfMSwgUElYX1Jf
MCB9Cit9OworCisvKgorICogRXhwZWN0ZWQgVkVTQS1SR0I4ODggZGF0YSB0byBiZSBzZW50IGlu
IExTQiBmb3JtYXQKKyAqCSAgICBiaXQ2IC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5iaXQw
CisgKiBDSEFOMCAgIHtPTkUsIE9ORSwgWkVSTywgWkVSTywgWkVSTywgT05FLCBPTkV9CisgKiBD
SEFOMSAgIHtHMCwgIFI1LCAgUjQsICAgUjMsICAgUjIsICAgUjEsICBSMH0KKyAqIENIQU4yICAg
e0IxLCAgQjAsICBHNSwgICBHNCwgICBHMywgICBHMiwgIEcxfQorICogQ0hBTjMgICB7REUsICBW
UywgIEhTLCAgIEI1LCAgIEI0LCAgIEIzLCAgQjJ9CisgKiBDSEFONCAgIHtDRSwgIEI3LCAgQjYs
ICAgRzcsICAgRzYsICAgUjcsICBSNn0KKyAqLworZW51bSBsdmRzX3BpeGVsIGx2ZHNfYml0bWFw
X3Zlc2FfcmdiODg4WzVdWzddID0geworCXsgUElYX09ORSwgUElYX09ORSwgUElYX1pFUiwgUElY
X1pFUiwgUElYX1pFUiwgUElYX09ORSwgUElYX09ORSB9LAorCXsgUElYX0dfMCwgUElYX1JfNSwg
UElYX1JfNCwgUElYX1JfMywgUElYX1JfMiwgUElYX1JfMSwgUElYX1JfMCB9LAorCXsgUElYX0Jf
MSwgUElYX0JfMCwgUElYX0dfNSwgUElYX0dfNCwgUElYX0dfMywgUElYX0dfMiwgUElYX0dfMSB9
LAorCXsgUElYX0RfRSwgUElYX1ZfUywgUElYX0hfUywgUElYX0JfNSwgUElYX0JfNCwgUElYX0Jf
MywgUElYX0JfMiB9LAorCXsgUElYX0NfRSwgUElYX0JfNywgUElYX0JfNiwgUElYX0dfNywgUElY
X0dfNiwgUElYX1JfNywgUElYX1JfNiB9Cit9OworCisvKgorICogQ2xvY2tzIGFuZCBQSFkgcmVs
YXRlZCBmdW5jdGlvbnMKKyAqLworc3RhdGljIGludCBsdmRzX3BsbF9lbmFibGUoc3RydWN0IHN0
bV9sdmRzICpsdmRzLCBzdHJ1Y3QgbHZkc19waHlfaW5mbyAqcGh5KQoreworCXN0cnVjdCBkcm1f
ZGV2aWNlICpkcm0gPSBsdmRzLT5sdmRzX2JyaWRnZS5kZXY7CisJdTMyIGx2ZHNfZ2NyOworCWlu
dCB2YWwsIHJldDsKKworCS8qCisJICogUExMIGxvY2sgdGltaW5nIGNvbnRyb2wgZm9yIHRoZSBt
b25pdG9yIHVubWFzayBhZnRlciBzdGFydHVwIChwbGxfZW4pCisJICogQWRqdXN0ZWQgdmFsdWUg
c28gdGhhdCB0aGUgbWFza2luZyB3aW5kb3cgaXMgb3BlbmVkIGF0IHN0YXJ0LXVwCisJICovCisJ
bHZkc193cml0ZShsdmRzLCBwaHktPmJhc2UgKyBwaHktPm9mcy5NUExDUiwgKDB4MjAwIC0gMHgx
NjApIDw8IDE2KTsKKworCS8qIEVuYWJsZSBiaWFzICovCisJbHZkc193cml0ZShsdmRzLCBwaHkt
PmJhc2UgKyBwaHktPm9mcy5CQ1IyLCBQSFlfQkNSMl9CSUFTX0VOKTsKKworCS8qIEVuYWJsZSBE
UCwgTFMsIEJJVCBjbG9jayBvdXRwdXQgKi8KKwlsdmRzX2djciA9IFBIWV9HQ1JfRFBfQ0xLX09V
VCB8IFBIWV9HQ1JfTFNfQ0xLX09VVCB8IFBIWV9HQ1JfQklUX0NMS19PVVQ7CisJbHZkc19zZXQo
bHZkcywgcGh5LT5iYXNlICsgcGh5LT5vZnMuR0NSLCBsdmRzX2djcik7CisKKwkvKiBQb3dlciB1
cCBhbGwgb3V0cHV0IGRpdmlkZXJzICovCisJbHZkc19zZXQobHZkcywgcGh5LT5iYXNlICsgcGh5
LT5vZnMuUExMVEVTVENSLCBQSFlfUExMVEVTVENSX0VOKTsKKwlsdmRzX3NldChsdmRzLCBwaHkt
PmJhc2UgKyBwaHktPm9mcy5QTExDUjEsIFBIWV9QTExDUjFfRElWX0VOKTsKKworCS8qIFNldCBQ
SFkgaW4gc2VyaWFsIHRyYW5zbWlzc2lvbiBtb2RlICovCisJbHZkc19zZXQobHZkcywgcGh5LT5i
YXNlICsgcGh5LT5vZnMuU0NSLCBQSFlfU0NSX1RYX0VOKTsKKworCS8qIEVuYWJsZSB0aGUgTFZE
UyBQTEwgJiB3YWl0IGZvciBpdHMgbG9jayAqLworCWx2ZHNfc2V0KGx2ZHMsIHBoeS0+YmFzZSAr
IHBoeS0+b2ZzLlBMTENSMSwgUEhZX1BMTENSMV9QTExfRU4pOworCXJldCA9IHJlYWRsX3BvbGxf
dGltZW91dF9hdG9taWMobHZkcy0+YmFzZSArIHBoeS0+YmFzZSArIHBoeS0+b2ZzLlBMTFNSLAor
CQkJCQl2YWwsIHZhbCAmIFBIWV9QTExTUl9QTExfTE9DSywKKwkJCQkJU0xFRVBfVVMsIFRJTUVP
VVRfVVMpOworCWlmIChyZXQpCisJCWRybV9lcnIoZHJtLCAiIVRJTUVPVVQhIHdhaXRpbmcgUExM
LCBsZXQncyBjb250aW51ZVxuIik7CisKKwkvKiBXQ0xLQ1JfU0VDTkRfQ0xLUElYX1NFTCBpcyBm
b3IgZHVhbCBsaW5rICovCisJbHZkc193cml0ZShsdmRzLCBMVkRTX1dDTEtDUiwgV0NMS0NSX1NF
Q05EX0NMS1BJWF9TRUwpOworCisJbHZkc19zZXQobHZkcywgcGh5LT5vZnMuUExMVEVTVENSLCBQ
SFlfUExMVEVTVENSX0NMS19FTik7CisKKwlyZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IHBs
bF9nZXRfY2xrb3V0X2toeihpbnQgY2xraW5fa2h6LCBpbnQgYmRpdiwgaW50IG1kaXYsIGludCBu
ZGl2KQoreworCWludCBkaXZpc29yID0gbmRpdiAqIGJkaXY7CisKKwkvKiBQcmV2ZW50cyBmcm9t
IGRpdmlzaW9uIGJ5IDAgKi8KKwlpZiAoIWRpdmlzb3IpCisJCXJldHVybiAwOworCisJcmV0dXJu
IGNsa2luX2toeiAqIG1kaXYgLyBkaXZpc29yOworfQorCisjZGVmaW5lIFRESVYJNzAKKyNkZWZp
bmUgTkRJVl9NSU4JMgorI2RlZmluZSBORElWX01BWAk2CisjZGVmaW5lIEJESVZfTUlOCTIKKyNk
ZWZpbmUgQkRJVl9NQVgJNgorI2RlZmluZSBNRElWX01JTgkxCisjZGVmaW5lIE1ESVZfTUFYCTEw
MjMKKworc3RhdGljIGludCBsdmRzX3BsbF9nZXRfcGFyYW1zKHN0cnVjdCBzdG1fbHZkcyAqbHZk
cywKKwkJCSAgICAgICB1bnNpZ25lZCBpbnQgY2xraW5fa2h6LCB1bnNpZ25lZCBpbnQgY2xrb3V0
X2toeiwKKwkJCSAgICAgICB1bnNpZ25lZCBpbnQgKmJkaXYsIHVuc2lnbmVkIGludCAqbWRpdiwg
dW5zaWduZWQgaW50ICpuZGl2KQoreworCWludCBkZWx0YSwgYmVzdF9kZWx0YTsgLyogYWxsIGlu
IGtoeiAqLworCWludCBpLCBvLCBuOworCisJLyogRWFybHkgY2hlY2tzIHByZXZlbnRpbmcgZGl2
aXNpb24gYnkgMCAmIG9kZCByZXN1bHRzICovCisJaWYgKGNsa2luX2toeiA8PSAwIHx8IGNsa291
dF9raHogPD0gMCkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwliZXN0X2RlbHRhID0gMTAwMDAwMDsg
LyogYmlnIHN0YXJ0ZWQgdmFsdWUgKDEwMDAwMDBraHopICovCisKKwlmb3IgKGkgPSBORElWX01J
TjsgaSA8PSBORElWX01BWDsgaSsrKSB7CisJCWZvciAobyA9IEJESVZfTUlOOyBvIDw9IEJESVZf
TUFYOyBvKyspIHsKKwkJCW4gPSBESVZfUk9VTkRfQ0xPU0VTVChpICogbyAqIGNsa291dF9raHos
IGNsa2luX2toeik7CisJCQkvKiBDaGVjayBuZGl2IGFjY29yZGluZyB0byB2Y28gcmFuZ2UgKi8K
KwkJCWlmIChuIDwgTURJVl9NSU4gfHwgbiA+IE1ESVZfTUFYKQorCQkJCWNvbnRpbnVlOworCQkJ
LyogQ2hlY2sgaWYgbmV3IGRlbHRhIGlzIGJldHRlciAmIHNhdmVzIHBhcmFtZXRlcnMgKi8KKwkJ
CWRlbHRhID0gcGxsX2dldF9jbGtvdXRfa2h6KGNsa2luX2toeiwgaSwgbiwgbykgLSBjbGtvdXRf
a2h6OworCQkJaWYgKGRlbHRhIDwgMCkKKwkJCQlkZWx0YSA9IC1kZWx0YTsKKwkJCWlmIChkZWx0
YSA8IGJlc3RfZGVsdGEpIHsKKwkJCQkqbmRpdiA9IGk7CisJCQkJKm1kaXYgPSBuOworCQkJCSpi
ZGl2ID0gbzsKKwkJCQliZXN0X2RlbHRhID0gZGVsdGE7CisJCQl9CisJCQkvKiBmYXN0IHJldHVy
biBpbiBjYXNlIG9mICJwZXJmZWN0IHJlc3VsdCIgKi8KKwkJCWlmICghZGVsdGEpCisJCQkJcmV0
dXJuIDA7CisJCX0KKwl9CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIHZvaWQgbHZkc19wbGxf
Y29uZmlnKHN0cnVjdCBzdG1fbHZkcyAqbHZkcywgc3RydWN0IGx2ZHNfcGh5X2luZm8gKnBoeSkK
K3sKKwl1bnNpZ25lZCBpbnQgcGxsX2luX2toeiwgYmRpdiA9IDAsIG1kaXYgPSAwLCBuZGl2ID0g
MDsKKwlzdHJ1Y3QgY2xrX2h3ICpod2NsazsKKwlpbnQgbXVsdGlwbGllcjsKKworCS8qCisJICog
VGhlIExWRFMgUEhZIGluY2x1ZGVzIGEgbG93IHBvd2VyIGxvdyBqaXR0ZXIgaGlnaCBwZXJmb3Jt
YW5jZSBhbmQKKwkgKiBoaWdobHkgY29uZmlndXJhdGlvbiBQaGFzZSBMb2NrZWQgTG9vcCBzdXBw
b3J0aW5nIGludGVnZXIgYW5kCisJICogZnJhY3Rpb25hbCBtdWx0aXBsaWNhdGlvbiByYXRpb3Mg
YW5kIFNwcmVhZCBTcGVjdHJ1bSBDbG9ja2luZy4gIEluCisJICogaW50ZWdlciBtb2RlLCB0aGUg
b25seSBzb2Z0d2FyZSBzdXBwb3J0ZWQgZmVhdHVyZSBmb3Igbm93LCB0aGUgUExMIGlzCisJICog
bWFkZSBvZiBhIHByZS1kaXZpZGVyIE5ESVYsIGEgZmVlZGJhY2sgbXVsdGlwbGllciBNRElWLCBm
b2xsb3dlZCBieQorCSAqIHNldmVyYWwgcG9zdC1kaXZpZGVycywgZWFjaCBvbmUgd2l0aCBhIHNw
ZWNpZmljIGFwcGxpY2F0aW9uLgorCSAqCisJICogICAgICAgICAgLC0tLS0tLS4gICAgICAgICAs
LS0tLS0uICAgICAsLS0tLS0uCisJICogRnJlZiAtLT4gfCBORElWIHwgLUZwZGYtPiB8IFBGRCB8
IC0tPiB8IFZDTyB8IC0tLS0tLS0tPiBGdmNvCisJICogICAgICAgICAgYC0tLS0tLScgICAgICwt
PiB8ICAgICB8ICAgICBgLS0tLS0nICB8CisJICogICAgICAgICAgICAgICAgICAgICAgIHwgICBg
LS0tLS0nICAgICAgICAgICAgICB8CisJICogICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAg
ICAsLS0tLS0tLiAgICAgICB8CisJICogICAgICAgICAgICAgICAgICAgICAgIGAtLS0tLS0tLSB8
IE1ESVYgfCA8LS0tLS0nCisJICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgLS0t
LS0tJworCSAqCisJICogRnJvbSB0aGUgb3V0cHV0IG9mIHRoZSBWQ08sIHRoZSBjbG9jayBjYW4g
YmUgb3B0aW9uYWxseSBleHRyYWN0ZWQgb24KKwkgKiB0aGUgUkNDIGNsb2NrIG9ic2VydmVyLCB3
aXRoIGEgZGl2aWRlciBURElWLCBmb3IgdGVzdGluZyBwdXJwb3NlLCBvcgorCSAqIGlzIHBhc3Nl
ZCB0aHJvdWdoIGEgcHJvZ3JhbW1hYmxlIHBvc3QtZGl2aWRlciBCRElWLiAgRmluYWxseSwgdGhl
CisJICogZnJlcXVlbmN5IGNhbiBiZSBkaXZpZGVkIGZ1cnRoZXIgd2l0aCB0d28gZml4ZWQgZGl2
aWRlcnMuCisJICoKKwkgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAsLS0tLS0tLS0uCisJ
ICogICAgICAgICAgICAgICAgICAgICwtLS0tLT4gfCBEUCBkaXYgfCAtLS0tLS0tLS0tLS0tLS0t
PiBGZHAKKwkgKiAgICAgICAgICAsLS0tLS0tLiAgfCAgICAgICBgLS0tLS0tLS0nCisJICogRnZj
byAtLT4gfCBCRElWIHwgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiBGYml0
CisJICogICAgICB8ICAgYC0tLS0tLScgICAgLC0tLS0tLS4gICB8CisJICogICAgICBgLS0tLS0t
LS0tLS0tLT4gfCBURElWIHwgLS0uLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiBDbGtPYnMKKwkgKiAg
ICAgICAgICAgICAgICAgICAgICAnLS0tLS0tJyAgIHwgICAgLC0tLS0tLS0tLgorCSAqICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYC0tPiB8IExTIGRpdiB8IC0tLS0tLT4gRmxzCisJ
ICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICctLS0tLS0tLScKKwkgKgor
CSAqIFRoZSBMUyBhbmQgRFAgY2xvY2sgZGl2aWRlcnMgb3BlcmF0ZSBhdCBhIGZpeGVkIHJhdGlv
IG9mIDcgYW5kIDMuNQorCSAqIHJlc3BlY3RpdmVseSB3aXRoIHJlZ2FyZHMgdG8gZmJpdC4gTFMg
ZGl2aWRlciBjb252ZXJ0cyB0aGUgYml0IGNsb2NrCisJICogdG8gYSBwaXhlbCBjbG9jayBwZXIg
bGFuZSBwZXIgY2xvY2sgc2FtcGxlIChGbHMpLiAgVGhpcyBpcyB1c2VmdWwKKwkgKiB3aGVuIHVz
ZWQgdG8gZ2VuZXJhdGUgYSBkb3QgY2xvY2sgZm9yIHRoZSBkaXNwbGF5IHVuaXQgUkdCIG91dHB1
dCwKKwkgKiBhbmQgRFAgZGl2aWRlciBpcy4KKwkgKi8KKworCWh3Y2xrID0gX19jbGtfZ2V0X2h3
KGx2ZHMtPnBsbHJlZl9jbGspOworCWlmICghaHdjbGspCisJCXJldHVybjsKKworCXBsbF9pbl9r
aHogPSBjbGtfaHdfZ2V0X3JhdGUoaHdjbGspIC8gMTAwMDsKKworCWlmIChsdmRzX2lzX2R1YWxf
bGluayhsdmRzLT5saW5rX3R5cGUpKQorCQltdWx0aXBsaWVyID0gMjsKKwllbHNlCisJCW11bHRp
cGxpZXIgPSAxOworCisJbHZkc19wbGxfZ2V0X3BhcmFtcyhsdmRzLCBwbGxfaW5fa2h6LAorCQkJ
ICAgIGx2ZHMtPnBpeGVsX2Nsb2NrX3JhdGUgKiA3IC8gMTAwMCAvIG11bHRpcGxpZXIsCisJCQkg
ICAgJmJkaXYsICZtZGl2LCAmbmRpdik7CisKKwkvKiBTZXQgQkRJViwgTURJViBhbmQgTkRJViAq
LworCWx2ZHNfd3JpdGUobHZkcywgcGh5LT5iYXNlICsgcGh5LT5vZnMuUExMQ1IyLCBuZGl2IDw8
IDE2KTsKKwlsdmRzX3NldChsdmRzLCBwaHktPmJhc2UgKyBwaHktPm9mcy5QTExDUjIsIGJkaXYp
OworCWx2ZHNfd3JpdGUobHZkcywgcGh5LT5iYXNlICsgcGh5LT5vZnMuUExMU0RDUjEsIG1kaXYp
OworCisJLyogSGFyZGNvZGUgVERJViBhcyBkeW5hbWljIHZhbHVlcyBhcmUgbm90IHlldCBpbXBs
ZW1lbnRlZCAqLworCWx2ZHNfd3JpdGUobHZkcywgcGh5LT5iYXNlICsgcGh5LT5vZnMuUExMVEVT
VENSLCBURElWIDw8IDE2KTsKKworCS8qCisJICogRm9yIG5vdywgUExMIGp1c3QgbmVlZHMgdG8g
YmUgaW4gaW50ZWdlciBtb2RlCisJICogRnJhY3Rpb25hbCBhbmQgc3ByZWFkIHNwZWN0cnVtIGNs
b2NraW5nIGFyZSBub3QgeWV0IGltcGxlbWVudGVkCisJICoKKwkgKiBQTEwgaW50ZWdlciBtb2Rl
OgorCSAqCS0gUE1SWV9QTExfVFdHX1NURVAgPSBQTVJZX1BMTF9TRF9JTlRfUkFUSU8KKwkgKgkt
IEVOX1RXRyA9IDAKKwkgKgktIEVOX1NEID0gMAorCSAqCS0gRE9XTl9TUFJFQUQgPSAwCisJICoK
KwkgKiBQTEwgZnJhY3Rpb25hbCBtb2RlOgorCSAqCS0gRU5fVFdHID0gMAorCSAqCS0gRU5fU0Qg
PSAxCisJICoJLSBET1dOX1NQUkVBRCA9IDAKKwkgKgorCSAqIFNwcmVhZCBTcGVjdHJ1bSBDbG9j
a2luZworCSAqCS0gRU5fVFdHID0gMQorCSAqCS0gRU5fU0QgPSAxCisJICovCisKKwkvKiBEaXNh
YmxlIFRXRyBhbmQgU0QgKi8KKwlsdmRzX2NsZWFyKGx2ZHMsIHBoeS0+YmFzZSArIHBoeS0+b2Zz
LlBMTENSMSwgUEhZX1BMTENSMV9FTl9UV0cgfCBQSFlfUExMQ1IxX0VOX1NEKTsKKworCS8qIFBv
d2VyIHVwIGJpYXMgYW5kIFBMTCBkaXZpZGVycyAqLworCWx2ZHNfc2V0KGx2ZHMsIHBoeS0+YmFz
ZSArIHBoeS0+b2ZzLkRDUiwgUEhZX0RDUl9QT1dFUl9PSyk7CisJbHZkc19zZXQobHZkcywgcGh5
LT5iYXNlICsgcGh5LT5vZnMuQ01DUjEsIFBIWV9DTUNSX0NNX0VOX0RMKTsKKwlsdmRzX3NldChs
dmRzLCBwaHktPmJhc2UgKyBwaHktPm9mcy5DTUNSMiwgUEhZX0NNQ1JfQ01fRU5fREw0KTsKKwor
CS8qIFNldCB1cCB2b2x0YWdlIG1vZGUgKi8KKwlsdmRzX3NldChsdmRzLCBwaHktPmJhc2UgKyBw
aHktPm9mcy5QTExDUENSLCAweDEpOworCWx2ZHNfc2V0KGx2ZHMsIHBoeS0+YmFzZSArIHBoeS0+
b2ZzLkJDUjMsIFBIWV9CQ1IzX1ZNX0VOX0RMKTsKKwlsdmRzX3NldChsdmRzLCBwaHktPmJhc2Ug
KyBwaHktPm9mcy5CQ1IxLCBQSFlfQkNSMV9FTl9CSUFTX0RMKTsKKwkvKiBFbmFibGUgZGlnaXRh
bCBkYXRhbGFuZXMgKi8KKwlsdmRzX3NldChsdmRzLCBwaHktPmJhc2UgKyBwaHktPm9mcy5DRkdD
UiwgUEhZX0NGR0NSX0VOX0RJR19ETCk7Cit9CisKK3N0YXRpYyBpbnQgbHZkc19waXhlbF9jbGtf
ZW5hYmxlKHN0cnVjdCBjbGtfaHcgKmh3KQoreworCXN0cnVjdCBzdG1fbHZkcyAqbHZkcyA9IGNv
bnRhaW5lcl9vZihodywgc3RydWN0IHN0bV9sdmRzLCBsdmRzX2NrX3B4KTsKKwlzdHJ1Y3QgZHJt
X2RldmljZSAqZHJtID0gbHZkcy0+bHZkc19icmlkZ2UuZGV2OworCXN0cnVjdCBsdmRzX3BoeV9p
bmZvICpwaHk7CisJaW50IHJldDsKKworCXJldCA9IGNsa19wcmVwYXJlX2VuYWJsZShsdmRzLT5w
Y2xrKTsKKwlpZiAocmV0KSB7CisJCWRybV9lcnIoZHJtLCAiRmFpbGVkIHRvIGVuYWJsZSBsdmRz
IHBlcmlwaGVyYWwgY2xrXG4iKTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBjbGtfcHJl
cGFyZV9lbmFibGUobHZkcy0+cGxscmVmX2Nsayk7CisJaWYgKHJldCkgeworCQlkcm1fZXJyKGRy
bSwgIkZhaWxlZCB0byBlbmFibGUgbHZkcyByZWZlcmVuY2UgY2xrXG4iKTsKKwkJY2xrX2Rpc2Fi
bGVfdW5wcmVwYXJlKGx2ZHMtPnBjbGspOworCQlyZXR1cm4gcmV0OworCX0KKworCS8qIEluIGNh
c2Ugd2UgYXJlIG9wZXJhdGluZyBpbiBkdWFsIGxpbmsgdGhlIHNlY29uZCBQSFkgaXMgc2V0IGJl
Zm9yZSB0aGUgcHJpbWFyeSBQSFkuICovCisJaWYgKGx2ZHMtPnNlY29uZGFyeSkgeworCQlwaHkg
PSBsdmRzLT5zZWNvbmRhcnk7CisKKwkJLyogUmVsZWFzZSBMVkRTIFBIWSBmcm9tIHJlc2V0IG1v
ZGUgKi8KKwkJbHZkc19zZXQobHZkcywgcGh5LT5iYXNlICsgcGh5LT5vZnMuR0NSLCBQSFlfR0NS
X0RJVl9SU1ROIHwgUEhZX0dDUl9SU1RaKTsKKwkJbHZkc19wbGxfY29uZmlnKGx2ZHMsIHBoeSk7
CisKKwkJcmV0ID0gbHZkc19wbGxfZW5hYmxlKGx2ZHMsIHBoeSk7CisJCWlmIChyZXQpIHsKKwkJ
CWRybV9lcnIoZHJtLCAiRmFpbGVkIHRvIGVuYWJsZSBzZWNvbmRhcnkgUEhZIFBMTDogJWRcbiIs
IHJldCk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJaWYgKGx2ZHMtPnByaW1hcnkpIHsK
KwkJcGh5ID0gbHZkcy0+cHJpbWFyeTsKKworCQkvKiBSZWxlYXNlIExWRFMgUEhZIGZyb20gcmVz
ZXQgbW9kZSAqLworCQlsdmRzX3NldChsdmRzLCBwaHktPmJhc2UgKyBwaHktPm9mcy5HQ1IsIFBI
WV9HQ1JfRElWX1JTVE4gfCBQSFlfR0NSX1JTVFopOworCQlsdmRzX3BsbF9jb25maWcobHZkcywg
cGh5KTsKKworCQlyZXQgPSBsdmRzX3BsbF9lbmFibGUobHZkcywgcGh5KTsKKwkJaWYgKHJldCkg
eworCQkJZHJtX2Vycihkcm0sICJGYWlsZWQgdG8gZW5hYmxlIHByaW1hcnkgUEhZIFBMTDogJWRc
biIsIHJldCk7CisJCQlyZXR1cm4gcmV0OworCQl9CisJfQorCisJcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyB2b2lkIGx2ZHNfcGl4ZWxfY2xrX2Rpc2FibGUoc3RydWN0IGNsa19odyAqaHcpCit7CisJ
c3RydWN0IHN0bV9sdmRzICpsdmRzID0gY29udGFpbmVyX29mKGh3LCBzdHJ1Y3Qgc3RtX2x2ZHMs
IGx2ZHNfY2tfcHgpOworCisJLyoKKwkgKiBGb3IgZWFjaCBQSFk6CisJICogRGlzYWJsZSBEUCwg
TFMsIEJJVCBjbG9jayBvdXRwdXRzCisJICogU2h1dGRvd24gdGhlIFBMTAorCSAqIEFzc2VydCBM
VkRTIFBIWSBpbiByZXNldCBtb2RlCisJICovCisKKwlpZiAobHZkcy0+cHJpbWFyeSkgeworCQls
dmRzX2NsZWFyKGx2ZHMsIGx2ZHMtPnByaW1hcnktPmJhc2UgKyBsdmRzLT5wcmltYXJ5LT5vZnMu
R0NSLAorCQkJICAgKFBIWV9HQ1JfRFBfQ0xLX09VVCB8IFBIWV9HQ1JfTFNfQ0xLX09VVCB8IFBI
WV9HQ1JfQklUX0NMS19PVVQpKTsKKwkJbHZkc19jbGVhcihsdmRzLCBsdmRzLT5wcmltYXJ5LT5i
YXNlICsgbHZkcy0+cHJpbWFyeS0+b2ZzLlBMTENSMSwKKwkJCSAgIFBIWV9QTExDUjFfUExMX0VO
KTsKKwkJbHZkc19jbGVhcihsdmRzLCBsdmRzLT5wcmltYXJ5LT5iYXNlICsgbHZkcy0+cHJpbWFy
eS0+b2ZzLkdDUiwKKwkJCSAgIFBIWV9HQ1JfRElWX1JTVE4gfCBQSFlfR0NSX1JTVFopOworCX0K
KworCWlmIChsdmRzLT5zZWNvbmRhcnkpIHsKKwkJbHZkc19jbGVhcihsdmRzLCBsdmRzLT5zZWNv
bmRhcnktPmJhc2UgKyBsdmRzLT5zZWNvbmRhcnktPm9mcy5HQ1IsCisJCQkgICAoUEhZX0dDUl9E
UF9DTEtfT1VUIHwgUEhZX0dDUl9MU19DTEtfT1VUIHwgUEhZX0dDUl9CSVRfQ0xLX09VVCkpOwor
CQlsdmRzX2NsZWFyKGx2ZHMsIGx2ZHMtPnNlY29uZGFyeS0+YmFzZSArIGx2ZHMtPnNlY29uZGFy
eS0+b2ZzLlBMTENSMSwKKwkJCSAgIFBIWV9QTExDUjFfUExMX0VOKTsKKwkJbHZkc19jbGVhcihs
dmRzLCBsdmRzLT5zZWNvbmRhcnktPmJhc2UgKyBsdmRzLT5zZWNvbmRhcnktPm9mcy5HQ1IsCisJ
CQkgICBQSFlfR0NSX0RJVl9SU1ROIHwgUEhZX0dDUl9SU1RaKTsKKwl9CisKKwljbGtfZGlzYWJs
ZV91bnByZXBhcmUobHZkcy0+cGxscmVmX2Nsayk7CisJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGx2
ZHMtPnBjbGspOworfQorCitzdGF0aWMgdW5zaWduZWQgbG9uZyBsdmRzX3BpeGVsX2Nsa19yZWNh
bGNfcmF0ZShzdHJ1Y3QgY2xrX2h3ICpodywKKwkJCQkJCXVuc2lnbmVkIGxvbmcgcGFyZW50X3Jh
dGUpCit7CisJc3RydWN0IHN0bV9sdmRzICpsdmRzID0gY29udGFpbmVyX29mKGh3LCBzdHJ1Y3Qg
c3RtX2x2ZHMsIGx2ZHNfY2tfcHgpOworCXN0cnVjdCBkcm1fZGV2aWNlICpkcm0gPSBsdmRzLT5s
dmRzX2JyaWRnZS5kZXY7CisJdW5zaWduZWQgaW50IHBsbF9pbl9raHosIGJkaXYsIG1kaXYsIG5k
aXY7CisJaW50IHJldCwgbXVsdGlwbGllciwgcGxsX291dF9raHo7CisJdTMyIHZhbDsKKworCXJl
dCA9IGNsa19wcmVwYXJlX2VuYWJsZShsdmRzLT5wY2xrKTsKKwlpZiAocmV0KSB7CisJCWRybV9l
cnIoZHJtLCAiRmFpbGVkIHRvIGVuYWJsZSBsdmRzIHBlcmlwaGVyYWwgY2xrXG4iKTsKKwkJcmV0
dXJuIDA7CisJfQorCisJaWYgKGx2ZHNfaXNfZHVhbF9saW5rKGx2ZHMtPmxpbmtfdHlwZSkpCisJ
CW11bHRpcGxpZXIgPSAyOworCWVsc2UKKwkJbXVsdGlwbGllciA9IDE7CisKKwl2YWwgPSBsdmRz
X3JlYWQobHZkcywgbHZkcy0+cHJpbWFyeS0+YmFzZSArIGx2ZHMtPnByaW1hcnktPm9mcy5QTExD
UjIpOworCisJbmRpdiA9ICh2YWwgJiBQSFlfUExMQ1IyX05ESVYpID4+IDE2OworCWJkaXYgPSAo
dmFsICYgUEhZX1BMTENSMl9CRElWKSA+PiAwOworCisJbWRpdiA9ICh1bnNpZ25lZCBpbnQpbHZk
c19yZWFkKGx2ZHMsCisJCQkJICAgICAgIGx2ZHMtPnByaW1hcnktPmJhc2UgKyBsdmRzLT5wcmlt
YXJ5LT5vZnMuUExMU0RDUjEpOworCisJcGxsX2luX2toeiA9ICh1bnNpZ25lZCBpbnQpKHBhcmVu
dF9yYXRlIC8gMTAwMCk7CisKKwkvKiBDb21wdXRlIHZhbHVlcyBpZiBub3QgeWV0IGFjY2Vzc2li
bGUgKi8KKwlpZiAodmFsID09IDAgfHwgbWRpdiA9PSAwKSB7CisJCWx2ZHNfcGxsX2dldF9wYXJh
bXMobHZkcywgcGxsX2luX2toeiwKKwkJCQkgICAgbHZkcy0+cGl4ZWxfY2xvY2tfcmF0ZSAqIDcg
LyAxMDAwIC8gbXVsdGlwbGllciwKKwkJCQkgICAgJmJkaXYsICZtZGl2LCAmbmRpdik7CisJfQor
CisJcGxsX291dF9raHogPSBwbGxfZ2V0X2Nsa291dF9raHoocGxsX2luX2toeiwgYmRpdiwgbWRp
diwgbmRpdik7CisJZHJtX2RiZyhkcm0sICJuZGl2ICVkICwgYmRpdiAlZCwgbWRpdiAlZCwgcGxs
X291dF9raHogJWRcbiIsCisJCW5kaXYsIGJkaXYsIG1kaXYsIHBsbF9vdXRfa2h6KTsKKworCS8q
CisJICogMS83IGJlY2F1c2UgZm9yIGVhY2ggcGl4ZWwgaW4gMSBsYW5lIHRoZXJlIGlzIDcgYml0
cworCSAqIFdlIHdhbnQgcGl4Y2xrLCBub3QgYml0Y2xrCisJICovCisJbHZkcy0+cGl4ZWxfY2xv
Y2tfcmF0ZSA9IHBsbF9vdXRfa2h6ICogMTAwMCAqIG11bHRpcGxpZXIgLyA3OworCisJY2xrX2Rp
c2FibGVfdW5wcmVwYXJlKGx2ZHMtPnBjbGspOworCisJcmV0dXJuICh1bnNpZ25lZCBsb25nKWx2
ZHMtPnBpeGVsX2Nsb2NrX3JhdGU7Cit9CisKK3N0YXRpYyBsb25nIGx2ZHNfcGl4ZWxfY2xrX3Jv
dW5kX3JhdGUoc3RydWN0IGNsa19odyAqaHcsIHVuc2lnbmVkIGxvbmcgcmF0ZSwKKwkJCQkgICAg
ICB1bnNpZ25lZCBsb25nICpwYXJlbnRfcmF0ZSkKK3sKKwlzdHJ1Y3Qgc3RtX2x2ZHMgKmx2ZHMg
PSBjb250YWluZXJfb2YoaHcsIHN0cnVjdCBzdG1fbHZkcywgbHZkc19ja19weCk7CisJdW5zaWdu
ZWQgaW50IHBsbF9pbl9raHosIGJkaXYgPSAwLCBtZGl2ID0gMCwgbmRpdiA9IDA7CisJY29uc3Qg
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3Bs
YXlfbW9kZSAqbW9kZTsKKwlpbnQgbXVsdGlwbGllcjsKKworCWNvbm5lY3RvciA9ICZsdmRzLT5j
b25uZWN0b3I7CisJaWYgKCFjb25uZWN0b3IpCisJCXJldHVybiAtRUlOVkFMOworCisJaWYgKGxp
c3RfZW1wdHkoJmNvbm5lY3Rvci0+bW9kZXMpKSB7CisJCWRybV9kYmcoY29ubmVjdG9yLT5kZXYs
ICJjb25uZWN0b3I6IGVtcHR5IG1vZGVzIGxpc3RcbiIpOworCQlyZXR1cm4gLUVJTlZBTDsKKwl9
CisKKwltb2RlID0gbGlzdF9maXJzdF9lbnRyeSgmY29ubmVjdG9yLT5tb2RlcywKKwkJCQlzdHJ1
Y3QgZHJtX2Rpc3BsYXlfbW9kZSwgaGVhZCk7CisKKwlwbGxfaW5fa2h6ID0gKHVuc2lnbmVkIGlu
dCkoKnBhcmVudF9yYXRlIC8gMTAwMCk7CisKKwlpZiAobHZkc19pc19kdWFsX2xpbmsobHZkcy0+
bGlua190eXBlKSkKKwkJbXVsdGlwbGllciA9IDI7CisJZWxzZQorCQltdWx0aXBsaWVyID0gMTsK
KworCWx2ZHNfcGxsX2dldF9wYXJhbXMobHZkcywgcGxsX2luX2toeiwgbW9kZS0+Y2xvY2sgKiA3
IC8gbXVsdGlwbGllciwgJmJkaXYsICZtZGl2LCAmbmRpdik7CisKKwkvKgorCSAqIDEvNyBiZWNh
dXNlIGZvciBlYWNoIHBpeGVsIGluIDEgbGFuZSB0aGVyZSBpcyA3IGJpdHMKKwkgKiBXZSB3YW50
IHBpeGNsaywgbm90IGJpdGNsaworCSAqLworCWx2ZHMtPnBpeGVsX2Nsb2NrX3JhdGUgPSAodW5z
aWduZWQgbG9uZylwbGxfZ2V0X2Nsa291dF9raHoocGxsX2luX2toeiwgYmRpdiwgbWRpdiwgbmRp
dikKKwkJCQkJICogMTAwMCAqIG11bHRpcGxpZXIgLyA3OworCisJcmV0dXJuIGx2ZHMtPnBpeGVs
X2Nsb2NrX3JhdGU7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgY2xrX29wcyBsdmRzX3BpeGVs
X2Nsa19vcHMgPSB7CisJLmVuYWJsZSA9IGx2ZHNfcGl4ZWxfY2xrX2VuYWJsZSwKKwkuZGlzYWJs
ZSA9IGx2ZHNfcGl4ZWxfY2xrX2Rpc2FibGUsCisJLnJlY2FsY19yYXRlID0gbHZkc19waXhlbF9j
bGtfcmVjYWxjX3JhdGUsCisJLnJvdW5kX3JhdGUgPSBsdmRzX3BpeGVsX2Nsa19yb3VuZF9yYXRl
LAorfTsKKworc3RhdGljIGNvbnN0IHN0cnVjdCBjbGtfaW5pdF9kYXRhIGNsa19kYXRhID0gewor
CS5uYW1lID0gImNsa19waXhfbHZkcyIsCisJLm9wcyA9ICZsdmRzX3BpeGVsX2Nsa19vcHMsCisJ
LnBhcmVudF9uYW1lcyA9IChjb25zdCBjaGFyICogW10pIHsiY2tfa2VyX2x2ZHNwaHkifSwKKwku
bnVtX3BhcmVudHMgPSAxLAorCS5mbGFncyA9IENMS19JR05PUkVfVU5VU0VELAorfTsKKworc3Rh
dGljIHZvaWQgbHZkc19waXhlbF9jbGtfdW5yZWdpc3Rlcih2b2lkICpkYXRhKQoreworCXN0cnVj
dCBzdG1fbHZkcyAqbHZkcyA9IGRhdGE7CisKKwlvZl9jbGtfZGVsX3Byb3ZpZGVyKGx2ZHMtPmRl
di0+b2Zfbm9kZSk7CisJY2xrX2h3X3VucmVnaXN0ZXIoJmx2ZHMtPmx2ZHNfY2tfcHgpOworfQor
CitzdGF0aWMgaW50IGx2ZHNfcGl4ZWxfY2xrX3JlZ2lzdGVyKHN0cnVjdCBzdG1fbHZkcyAqbHZk
cykKK3sKKwlzdHJ1Y3QgZGV2aWNlX25vZGUgKm5vZGUgPSBsdmRzLT5kZXYtPm9mX25vZGU7CisJ
aW50IHJldDsKKworCWx2ZHMtPmx2ZHNfY2tfcHguaW5pdCA9ICZjbGtfZGF0YTsKKworCS8qIHNl
dCB0aGUgcmF0ZSBieSBkZWZhdWx0IGF0IDE0ODUwMDAwMCAqLworCWx2ZHMtPnBpeGVsX2Nsb2Nr
X3JhdGUgPSAxNDg1MDAwMDA7CisKKwlyZXQgPSBjbGtfaHdfcmVnaXN0ZXIobHZkcy0+ZGV2LCAm
bHZkcy0+bHZkc19ja19weCk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCXJldCA9IG9m
X2Nsa19hZGRfaHdfcHJvdmlkZXIobm9kZSwgb2ZfY2xrX2h3X3NpbXBsZV9nZXQsCisJCQkJICAg
ICAmbHZkcy0+bHZkc19ja19weCk7CisJaWYgKHJldCkKKwkJY2xrX2h3X3VucmVnaXN0ZXIoJmx2
ZHMtPmx2ZHNfY2tfcHgpOworCisJcmV0dXJuIHJldDsKK30KKworLyoKKyAqIEhvc3QgY29uZmln
dXJhdGlvbiByZWxhdGVkCisgKi8KK3N0YXRpYyB2b2lkIGx2ZHNfY29uZmlnX2RhdGFfbWFwcGlu
ZyhzdHJ1Y3Qgc3RtX2x2ZHMgKmx2ZHMpCit7CisJc3RydWN0IGRybV9kZXZpY2UgKmRybSA9IGx2
ZHMtPmx2ZHNfYnJpZGdlLmRldjsKKwljb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfaW5mbyAqaW5m
bzsKKwllbnVtIGx2ZHNfcGl4ZWwgKCpiaXRtYXApWzddOworCXUzMiBsdmRzX2RtbGNyLCBsdmRz
X2RtbWNyOworCWludCBpOworCisJaW5mbyA9ICYoJmx2ZHMtPmNvbm5lY3RvciktPmRpc3BsYXlf
aW5mbzsKKwlpZiAoIWluZm8tPm51bV9idXNfZm9ybWF0cyB8fCAhaW5mby0+YnVzX2Zvcm1hdHMp
IHsKKwkJZHJtX3dhcm4oZHJtLCAiTm8gTFZEUyBidXMgZm9ybWF0IHJlcG9ydGVkXG4iKTsKKwkJ
cmV0dXJuOworCX0KKworCXN3aXRjaCAoaW5mby0+YnVzX2Zvcm1hdHNbMF0pIHsKKwljYXNlIE1F
RElBX0JVU19GTVRfUkdCNjY2XzFYN1gzX1NQV0c6IC8qIFZFU0EtUkdCNjY2ICovCisJCWRybV93
YXJuKGRybSwgIlBpeGVsIGZvcm1hdCB3aXRoIGRhdGEgbWFwcGluZyBub3QgeWV0IHN1cHBvcnRl
ZC5cbiIpOworCQlyZXR1cm47CisJY2FzZSBNRURJQV9CVVNfRk1UX1JHQjg4OF8xWDdYNF9TUFdH
OiAvKiBWRVNBLVJHQjg4OCAqLworCQliaXRtYXAgPSBsdmRzX2JpdG1hcF92ZXNhX3JnYjg4ODsK
KwkJYnJlYWs7CisJY2FzZSBNRURJQV9CVVNfRk1UX1JHQjg4OF8xWDdYNF9KRUlEQTogLyogSkVJ
REEtUkdCODg4ICovCisJCWJpdG1hcCA9IGx2ZHNfYml0bWFwX2plaWRhX3JnYjg4ODsKKwkJYnJl
YWs7CisJZGVmYXVsdDoKKwkJZHJtX3dhcm4oZHJtLCAiVW5zdXBwb3J0ZWQgTFZEUyBidXMgZm9y
bWF0IDB4JTA0eFxuIiwgaW5mby0+YnVzX2Zvcm1hdHNbMF0pOworCQlyZXR1cm47CisJfQorCisJ
LyogU2V0IGJpdG1hcCBmb3IgZWFjaCBsYW5lICovCisJZm9yIChpID0gMDsgaSA8IDU7IGkrKykg
eworCQlsdmRzX2RtbGNyID0gKChiaXRtYXBbaV1bMF0pCisJCQkgICAgICArIChiaXRtYXBbaV1b
MV0gPDwgNSkKKwkJCSAgICAgICsgKGJpdG1hcFtpXVsyXSA8PCAxMCkKKwkJCSAgICAgICsgKGJp
dG1hcFtpXVszXSA8PCAxNSkpOworCQlsdmRzX2RtbWNyID0gKChiaXRtYXBbaV1bNF0pCisJCQkg
ICAgICArIChiaXRtYXBbaV1bNV0gPDwgNSkKKwkJCSAgICAgICsgKGJpdG1hcFtpXVs2XSA8PCAx
MCkpOworCisJCWx2ZHNfd3JpdGUobHZkcywgTFZEU19ETUxDUihpKSwgbHZkc19kbWxjcik7CisJ
CWx2ZHNfd3JpdGUobHZkcywgTFZEU19ETU1DUihpKSwgbHZkc19kbW1jcik7CisJfQorfQorCitz
dGF0aWMgdm9pZCBsdmRzX2NvbmZpZ19tb2RlKHN0cnVjdCBzdG1fbHZkcyAqbHZkcykKK3sKKwl1
MzIgYnVzX2ZsYWdzLCBsdmRzX2NyID0gMCwgbHZkc19jZGwxY3IgPSAwLCBsdmRzX2NkbDJjciA9
IDA7CisJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGU7CisJY29uc3Qgc3RydWN0
IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKKworCWNvbm5lY3RvciA9ICZsdmRzLT5jb25uZWN0
b3I7CisJaWYgKCFjb25uZWN0b3IpCisJCXJldHVybjsKKworCWlmIChsaXN0X2VtcHR5KCZjb25u
ZWN0b3ItPm1vZGVzKSkgeworCQlkcm1fZGJnKGNvbm5lY3Rvci0+ZGV2LCAiY29ubmVjdG9yOiBl
bXB0eSBtb2RlcyBsaXN0XG4iKTsKKwkJcmV0dXJuOworCX0KKworCWJ1c19mbGFncyA9IGNvbm5l
Y3Rvci0+ZGlzcGxheV9pbmZvLmJ1c19mbGFnczsKKwltb2RlID0gbGlzdF9maXJzdF9lbnRyeSgm
Y29ubmVjdG9yLT5tb2RlcywKKwkJCQlzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSwgaGVhZCk7CisK
KwlsdmRzX2NsZWFyKGx2ZHMsIExWRFNfQ1IsIENSX0xLTU9EKTsKKwlsdmRzX2NsZWFyKGx2ZHMs
IExWRFNfQ0RMMUNSLCBDRExDUl9ESVNUUjAgfCBDRExDUl9ESVNUUjEgfCBDRExDUl9ESVNUUjIg
fAorCQkJCSAgICAgIENETENSX0RJU1RSMyB8IENETENSX0RJU1RSNCk7CisJbHZkc19jbGVhcihs
dmRzLCBMVkRTX0NETDJDUiwgQ0RMQ1JfRElTVFIwIHwgQ0RMQ1JfRElTVFIxIHwgQ0RMQ1JfRElT
VFIyIHwKKwkJCQkgICAgICBDRExDUl9ESVNUUjMgfCBDRExDUl9ESVNUUjQpOworCisJLyogU2V0
IGNoYW5uZWwgZGlzdHJpYnV0aW9uICovCisJaWYgKGx2ZHMtPnByaW1hcnkpCisJCWx2ZHNfY2Rs
MWNyID0gQ0RMMUNSX0RFRkFVTFQ7CisKKwlpZiAobHZkcy0+c2Vjb25kYXJ5KSB7CisJCWx2ZHNf
Y3IgfD0gQ1JfTEtNT0Q7CisJCWx2ZHNfY2RsMmNyID0gQ0RMMkNSX0RFRkFVTFQ7CisJfQorCisJ
LyogU2V0IHNpZ25hbCBwb2xhcml0eSAqLworCWlmIChidXNfZmxhZ3MgJiBEUk1fQlVTX0ZMQUdf
REVfTE9XKQorCQlsdmRzX2NyIHw9IENSX0RFUE9MOworCisJaWYgKG1vZGUtPmZsYWdzICYgRFJN
X01PREVfRkxBR19OSFNZTkMpCisJCWx2ZHNfY3IgfD0gQ1JfSFNQT0w7CisKKwlpZiAobW9kZS0+
ZmxhZ3MgJiBEUk1fTU9ERV9GTEFHX05WU1lOQykKKwkJbHZkc19jciB8PSBDUl9WU1BPTDsKKwor
CXN3aXRjaCAobHZkcy0+bGlua190eXBlKSB7CisJY2FzZSBMVkRTX0RVQUxfTElOS19FVkVOX09E
RF9QSVhFTFM6IC8qIExLUEhBID0gMCAqLworCQlsdmRzX2NyICY9IH5DUl9MS1BIQTsKKwkJYnJl
YWs7CisJY2FzZSBMVkRTX0RVQUxfTElOS19PRERfRVZFTl9QSVhFTFM6IC8qIExLUEhBID0gMSAq
LworCQlsdmRzX2NyIHw9IENSX0xLUEhBOworCQlicmVhazsKKwlkZWZhdWx0OgorCQlkcm1fbm90
aWNlKGx2ZHMtPmx2ZHNfYnJpZGdlLmRldiwgIk5vIHBoYXNlIHByZWNpc2VkLCBzZXR0aW5nIGRl
ZmF1bHRcbiIpOworCQlsdmRzX2NyICY9IH5DUl9MS1BIQTsKKwkJYnJlYWs7CisJfQorCisJLyog
V3JpdGUgY29uZmlnIHRvIHJlZ2lzdGVycyAqLworCWx2ZHNfc2V0KGx2ZHMsIExWRFNfQ1IsIGx2
ZHNfY3IpOworCWx2ZHNfd3JpdGUobHZkcywgTFZEU19DREwxQ1IsIGx2ZHNfY2RsMWNyKTsKKwls
dmRzX3dyaXRlKGx2ZHMsIExWRFNfQ0RMMkNSLCBsdmRzX2NkbDJjcik7Cit9CisKK3N0YXRpYyBp
bnQgbHZkc19jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0
b3IpCit7CisJc3RydWN0IHN0bV9sdmRzICpsdmRzID0gY29ubmVjdG9yX3RvX3N0bV9sdmRzKGNv
bm5lY3Rvcik7CisKKwlyZXR1cm4gZHJtX3BhbmVsX2dldF9tb2RlcyhsdmRzLT5wYW5lbCwgY29u
bmVjdG9yKTsKK30KKworc3RhdGljIGludCBsdmRzX2Nvbm5lY3Rvcl9hdG9taWNfY2hlY2soc3Ry
dWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwKKwkJCQkgICAgICAgc3RydWN0IGRybV9hdG9t
aWNfc3RhdGUgKnN0YXRlKQoreworCWNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICpwYW5l
bF9tb2RlOworCXN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25uX3N0YXRlOworCXN0cnVj
dCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZTsKKworCWNvbm5fc3RhdGUgPSBkcm1fYXRvbWlj
X2dldF9uZXdfY29ubmVjdG9yX3N0YXRlKHN0YXRlLCBjb25uZWN0b3IpOworCWlmICghY29ubl9z
dGF0ZSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlpZiAobGlzdF9lbXB0eSgmY29ubmVjdG9yLT5t
b2RlcykpIHsKKwkJZHJtX2RiZyhjb25uZWN0b3ItPmRldiwgImNvbm5lY3RvcjogZW1wdHkgbW9k
ZXMgbGlzdFxuIik7CisJCXJldHVybiAtRUlOVkFMOworCX0KKworCWlmICghY29ubl9zdGF0ZS0+
Y3J0YykKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwlwYW5lbF9tb2RlID0gbGlzdF9maXJzdF9lbnRy
eSgmY29ubmVjdG9yLT5tb2RlcywKKwkJCQkgICAgICBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSwg
aGVhZCk7CisKKwkvKiBXZSdyZSBub3QgYWxsb3dlZCB0byBtb2RpZnkgdGhlIHJlc29sdXRpb24u
ICovCisJY3J0Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X2NydGNfc3RhdGUoc3RhdGUsIGNvbm5f
c3RhdGUtPmNydGMpOworCWlmIChJU19FUlIoY3J0Y19zdGF0ZSkpCisJCXJldHVybiBQVFJfRVJS
KGNydGNfc3RhdGUpOworCisJaWYgKGNydGNfc3RhdGUtPm1vZGUuaGRpc3BsYXkgIT0gcGFuZWxf
bW9kZS0+aGRpc3BsYXkgfHwKKwkgICAgY3J0Y19zdGF0ZS0+bW9kZS52ZGlzcGxheSAhPSBwYW5l
bF9tb2RlLT52ZGlzcGxheSkKKwkJcmV0dXJuIC1FSU5WQUw7CisKKwkvKiBUaGUgZmxhdCBwYW5l
bCBtb2RlIGlzIGZpeGVkLCBqdXN0IGNvcHkgaXQgdG8gdGhlIGFkanVzdGVkIG1vZGUuICovCisJ
ZHJtX21vZGVfY29weSgmY3J0Y19zdGF0ZS0+YWRqdXN0ZWRfbW9kZSwgcGFuZWxfbW9kZSk7CisK
KwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBl
cl9mdW5jcyBsdmRzX2Nvbm5faGVscGVyX2Z1bmNzID0geworCS5nZXRfbW9kZXMgPSBsdmRzX2Nv
bm5lY3Rvcl9nZXRfbW9kZXMsCisJLmF0b21pY19jaGVjayA9IGx2ZHNfY29ubmVjdG9yX2F0b21p
Y19jaGVjaywKK307CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyBs
dmRzX2Nvbm5fZnVuY3MgPSB7CisJLnJlc2V0ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9y
X3Jlc2V0LAorCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29ubmVjdG9y
X21vZGVzLAorCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLAorCS5hdG9taWNfZHVw
bGljYXRlX3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0
ZSwKKwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3Jf
ZGVzdHJveV9zdGF0ZSwKK307CisKK3N0YXRpYyBpbnQgbHZkc19hdHRhY2goc3RydWN0IGRybV9i
cmlkZ2UgKmJyaWRnZSwKKwkJICAgICAgIGVudW0gZHJtX2JyaWRnZV9hdHRhY2hfZmxhZ3MgZmxh
Z3MpCit7CisJc3RydWN0IHN0bV9sdmRzICpsdmRzID0gYnJpZGdlX3RvX3N0bV9sdmRzKGJyaWRn
ZSk7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9ICZsdmRzLT5jb25uZWN0b3I7
CisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gYnJpZGdlLT5lbmNvZGVyOworCWludCBy
ZXQ7CisKKwlpZiAoIWJyaWRnZS0+ZW5jb2RlcikgeworCQlkcm1fZXJyKGJyaWRnZS0+ZGV2LCAi
UGFyZW50IGVuY29kZXIgb2JqZWN0IG5vdCBmb3VuZFxuIik7CisJCXJldHVybiAtRU5PREVWOwor
CX0KKworCS8qIFNldCB0aGUgZW5jb2RlciB0eXBlIGFzIGNhbGxlciBkb2VzIG5vdCBrbm93IGl0
ICovCisJYnJpZGdlLT5lbmNvZGVyLT5lbmNvZGVyX3R5cGUgPSBEUk1fTU9ERV9FTkNPREVSX0xW
RFM7CisKKwkvKiBObyBjbG9uaW5nIHN1cHBvcnQgKi8KKwlicmlkZ2UtPmVuY29kZXItPnBvc3Np
YmxlX2Nsb25lcyA9IDA7CisKKwkvKiBJZiB3ZSBoYXZlIGEgbmV4dCBicmlkZ2UganVzdCBhdHRh
Y2ggaXQuICovCisJaWYgKGx2ZHMtPm5leHRfYnJpZGdlKQorCQlyZXR1cm4gZHJtX2JyaWRnZV9h
dHRhY2goYnJpZGdlLT5lbmNvZGVyLCBsdmRzLT5uZXh0X2JyaWRnZSwKKwkJCQkJIGJyaWRnZSwg
ZmxhZ3MpOworCisJaWYgKGZsYWdzICYgRFJNX0JSSURHRV9BVFRBQ0hfTk9fQ09OTkVDVE9SKSB7
CisJCWRybV9lcnIoYnJpZGdlLT5kZXYsICJGaXggYnJpZGdlIGRyaXZlciB0byBtYWtlIGNvbm5l
Y3RvciBvcHRpb25hbCEiKTsKKwkJcmV0dXJuIC1FSU5WQUw7CisJfQorCisJLyogT3RoZXJ3aXNl
IGlmIHdlIGhhdmUgYSBwYW5lbCwgY3JlYXRlIGEgY29ubmVjdG9yLiAqLworCWlmICghbHZkcy0+
cGFuZWwpCisJCXJldHVybiAwOworCisJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9pbml0KGJyaWRnZS0+
ZGV2LCBjb25uZWN0b3IsCisJCQkJICZsdmRzX2Nvbm5fZnVuY3MsIERSTV9NT0RFX0NPTk5FQ1RP
Ul9MVkRTKTsKKwlpZiAocmV0IDwgMCkKKwkJcmV0dXJuIHJldDsKKworCWRybV9jb25uZWN0b3Jf
aGVscGVyX2FkZChjb25uZWN0b3IsICZsdmRzX2Nvbm5faGVscGVyX2Z1bmNzKTsKKworCXJldCA9
IGRybV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIoY29ubmVjdG9yLCBlbmNvZGVyKTsKKworCXJl
dHVybiByZXQ7Cit9CisKK3N0YXRpYyB2b2lkIGx2ZHNfYXRvbWljX2VuYWJsZShzdHJ1Y3QgZHJt
X2JyaWRnZSAqYnJpZGdlLAorCQkJICAgICAgIHN0cnVjdCBkcm1fYnJpZGdlX3N0YXRlICpvbGRf
YnJpZGdlX3N0YXRlKQoreworCXN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSA9IG9sZF9i
cmlkZ2Vfc3RhdGUtPmJhc2Uuc3RhdGU7CisJc3RydWN0IHN0bV9sdmRzICpsdmRzID0gYnJpZGdl
X3RvX3N0bV9sdmRzKGJyaWRnZSk7CisJc3RydWN0IGRybV9jb25uZWN0b3Jfc3RhdGUgKmNvbm5f
c3RhdGU7CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvcjsKKwlpbnQgcmV0OworCisJ
cmV0ID0gY2xrX3ByZXBhcmVfZW5hYmxlKGx2ZHMtPnBjbGspOworCWlmIChyZXQpIHsKKwkJZHJt
X2VycihicmlkZ2UtPmRldiwgIkZhaWxlZCB0byBlbmFibGUgbHZkcyBwZXJpcGhlcmFsIGNsa1xu
Iik7CisJCXJldHVybjsKKwl9CisKKwljb25uZWN0b3IgPSBkcm1fYXRvbWljX2dldF9uZXdfY29u
bmVjdG9yX2Zvcl9lbmNvZGVyKHN0YXRlLCBicmlkZ2UtPmVuY29kZXIpOworCWlmICghY29ubmVj
dG9yKQorCQlyZXR1cm47CisKKwljb25uX3N0YXRlID0gZHJtX2F0b21pY19nZXRfbmV3X2Nvbm5l
Y3Rvcl9zdGF0ZShzdGF0ZSwgY29ubmVjdG9yKTsKKwlpZiAoIWNvbm5fc3RhdGUpCisJCXJldHVy
bjsKKworCWx2ZHNfY29uZmlnX21vZGUobHZkcyk7CisKKwkvKiBTZXQgRGF0YSBNYXBwaW5nICov
CisJbHZkc19jb25maWdfZGF0YV9tYXBwaW5nKGx2ZHMpOworCisJLyogVHVybiB0aGUgb3V0cHV0
IG9uLiAqLworCWx2ZHNfc2V0KGx2ZHMsIExWRFNfQ1IsIENSX0xWRFNFTik7CisKKwlpZiAobHZk
cy0+cGFuZWwpIHsKKwkJZHJtX3BhbmVsX3ByZXBhcmUobHZkcy0+cGFuZWwpOworCQlkcm1fcGFu
ZWxfZW5hYmxlKGx2ZHMtPnBhbmVsKTsKKwl9Cit9CisKK3N0YXRpYyB2b2lkIGx2ZHNfYXRvbWlj
X2Rpc2FibGUoc3RydWN0IGRybV9icmlkZ2UgKmJyaWRnZSwKKwkJCQlzdHJ1Y3QgZHJtX2JyaWRn
ZV9zdGF0ZSAqb2xkX2JyaWRnZV9zdGF0ZSkKK3sKKwlzdHJ1Y3Qgc3RtX2x2ZHMgKmx2ZHMgPSBi
cmlkZ2VfdG9fc3RtX2x2ZHMoYnJpZGdlKTsKKworCWlmIChsdmRzLT5wYW5lbCkgeworCQlkcm1f
cGFuZWxfZGlzYWJsZShsdmRzLT5wYW5lbCk7CisJCWRybV9wYW5lbF91bnByZXBhcmUobHZkcy0+
cGFuZWwpOworCX0KKworCS8qIERpc2FibGUgTFZEUyBtb2R1bGUgKi8KKwlsdmRzX2NsZWFyKGx2
ZHMsIExWRFNfQ1IsIENSX0xWRFNFTik7CisKKwljbGtfZGlzYWJsZV91bnByZXBhcmUobHZkcy0+
cGNsayk7Cit9CisKK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2JyaWRnZV9mdW5jcyBsdmRzX2Jy
aWRnZV9mdW5jcyA9IHsKKwkuYXR0YWNoID0gbHZkc19hdHRhY2gsCisJLmF0b21pY19lbmFibGUg
PSBsdmRzX2F0b21pY19lbmFibGUsCisJLmF0b21pY19kaXNhYmxlID0gbHZkc19hdG9taWNfZGlz
YWJsZSwKKwkuYXRvbWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2JyaWRn
ZV9kdXBsaWNhdGVfc3RhdGUsCisJLmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19o
ZWxwZXJfYnJpZGdlX2Rlc3Ryb3lfc3RhdGUsCisJLmF0b21pY19yZXNldCA9IGRybV9hdG9taWNf
aGVscGVyX2JyaWRnZV9yZXNldCwKK307CisKK3N0YXRpYyBpbnQgbHZkc19wcm9iZShzdHJ1Y3Qg
cGxhdGZvcm1fZGV2aWNlICpwZGV2KQoreworCXN0cnVjdCBkZXZpY2Vfbm9kZSAqcG9ydDEsICpw
b3J0MiwgKnJlbW90ZTsKKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSAmcGRldi0+ZGV2OworCXN0cnVj
dCByZXNldF9jb250cm9sICpyc3RjOworCXN0cnVjdCBzdG1fbHZkcyAqbHZkczsKKwlpbnQgcmV0
LCBkdWFsX2xpbms7CisKKwlkZXZfZGJnKGRldiwgIlByb2JpbmcgTFZEUyBkcml2ZXIuLi5cbiIp
OworCisJbHZkcyA9IGRldm1fa3phbGxvYyhkZXYsIHNpemVvZigqbHZkcyksIEdGUF9LRVJORUwp
OworCWlmICghbHZkcykKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlsdmRzLT5kZXYgPSBkZXY7CisK
KwlyZXQgPSBkcm1fb2ZfZmluZF9wYW5lbF9vcl9icmlkZ2UoZGV2LT5vZl9ub2RlLCAxLCAwLAor
CQkJCQkgICZsdmRzLT5wYW5lbCwgJmx2ZHMtPm5leHRfYnJpZGdlKTsKKwlpZiAocmV0KSB7CisJ
CWRldl9lcnJfcHJvYmUoZGV2LCByZXQsICJQYW5lbCBub3QgZm91bmRcbiIpOworCQlyZXR1cm4g
cmV0OworCX0KKworCWx2ZHMtPmJhc2UgPSBkZXZtX3BsYXRmb3JtX2lvcmVtYXBfcmVzb3VyY2Uo
cGRldiwgMCk7CisJaWYgKElTX0VSUihsdmRzLT5iYXNlKSkgeworCQlyZXQgPSBQVFJfRVJSKGx2
ZHMtPmJhc2UpOworCQlkZXZfZXJyKGRldiwgIlVuYWJsZSB0byBnZXQgcmVncyAlZFxuIiwgcmV0
KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlsdmRzLT5wY2xrID0gZGV2bV9jbGtfZ2V0KGRldiwg
InBjbGsiKTsKKwlpZiAoSVNfRVJSKGx2ZHMtPnBjbGspKSB7CisJCXJldCA9IFBUUl9FUlIobHZk
cy0+cGNsayk7CisJCWRldl9lcnIoZGV2LCAiVW5hYmxlIHRvIGdldCBwZXJpcGhlcmFsIGNsb2Nr
OiAlZFxuIiwgcmV0KTsKKwkJcmV0dXJuIHJldDsKKwl9CisKKwlyZXQgPSBjbGtfcHJlcGFyZV9l
bmFibGUobHZkcy0+cGNsayk7CisJaWYgKHJldCkgeworCQlkZXZfZXJyKGRldiwgIiVzOiBGYWls
ZWQgdG8gZW5hYmxlIHBlcmlwaGVyYWwgY2xrXG4iLCBfX2Z1bmNfXyk7CisJCXJldHVybiByZXQ7
CisJfQorCisJcnN0YyA9IGRldm1fcmVzZXRfY29udHJvbF9nZXRfZXhjbHVzaXZlKGRldiwgTlVM
TCk7CisKKwlpZiAoSVNfRVJSKHJzdGMpKSB7CisJCXJldCA9IFBUUl9FUlIocnN0Yyk7CisJCWdv
dG8gZXJyX2x2ZHNfcHJvYmU7CisJfQorCisJcmVzZXRfY29udHJvbF9hc3NlcnQocnN0Yyk7CisJ
dXNsZWVwX3JhbmdlKDEwLCAyMCk7CisJcmVzZXRfY29udHJvbF9kZWFzc2VydChyc3RjKTsKKwor
CXBvcnQxID0gb2ZfZ3JhcGhfZ2V0X3BvcnRfYnlfaWQoZGV2LT5vZl9ub2RlLCAxKTsKKwlwb3J0
MiA9IG9mX2dyYXBoX2dldF9wb3J0X2J5X2lkKGRldi0+b2Zfbm9kZSwgMik7CisJZHVhbF9saW5r
ID0gZHJtX29mX2x2ZHNfZ2V0X2R1YWxfbGlua19waXhlbF9vcmRlcihwb3J0MSwgcG9ydDIpOwor
CisJc3dpdGNoIChkdWFsX2xpbmspIHsKKwljYXNlIERSTV9MVkRTX0RVQUxfTElOS19PRERfRVZF
Tl9QSVhFTFM6CisJCWx2ZHMtPmxpbmtfdHlwZSA9IExWRFNfRFVBTF9MSU5LX09ERF9FVkVOX1BJ
WEVMUzsKKwkJbHZkcy0+cHJpbWFyeSA9ICZsdmRzX3BoeV8xNmZmX3ByaW1hcnk7CisJCWx2ZHMt
PnNlY29uZGFyeSA9ICZsdmRzX3BoeV8xNmZmX3NlY29uZGFyeTsKKwkJYnJlYWs7CisJY2FzZSBE
Uk1fTFZEU19EVUFMX0xJTktfRVZFTl9PRERfUElYRUxTOgorCQlsdmRzLT5saW5rX3R5cGUgPSBM
VkRTX0RVQUxfTElOS19FVkVOX09ERF9QSVhFTFM7CisJCWx2ZHMtPnByaW1hcnkgPSAmbHZkc19w
aHlfMTZmZl9wcmltYXJ5OworCQlsdmRzLT5zZWNvbmRhcnkgPSAmbHZkc19waHlfMTZmZl9zZWNv
bmRhcnk7CisJCWJyZWFrOworCWNhc2UgLUVJTlZBTDoKKwkJLyoKKwkJICogZHJtX29mX2x2ZHNf
Z2V0X2R1YWxfcGl4ZWxfb3JkZXIgcmV0dXJucyA0IHBvc3NpYmxlIHZhbHVlcy4KKwkJICogSW4g
dGhlIGNhc2Ugd2hlcmUgdGhlIHJldHVybmVkIHZhbHVlIGlzIGFuIGVycm9yLCBpdCBjYW4gYmUK
KwkJICogZWl0aGVyIEVOT0RFViBvciBFSU5WQUwuIFNlZWluZyB0aGUgc3RydWN0dXJlIG9mIHRo
aXMKKwkJICogZnVuY3Rpb24sIEVJTlZBTCBtZWFucyB0aGF0IGVpdGhlciBwb3J0MSBvciBwb3J0
MiBpcyBub3QKKwkJICogcHJlc2VudCBpbiB0aGUgZGV2aWNlIHRyZWUuCisJCSAqIEluIHRoYXQg
Y2FzZSwgdGhlIGx2ZHMgcGFuZWwgY2FuIGJlIGEgc2luZ2xlIGxpbmsgcGFuZWwsIG9yCisJCSAq
IHRoZXJlIGlzIGEgc2VtYW50aWNhbCBlcnJvciBpbiB0aGUgZGV2aWNlIHRyZWUgY29kZS4KKwkJ
ICovCisJCXJlbW90ZSA9IG9mX2dldF9uZXh0X2F2YWlsYWJsZV9jaGlsZChwb3J0MSwgTlVMTCk7
CisJCWlmIChyZW1vdGUpIHsKKwkJCWlmIChvZl9ncmFwaF9nZXRfcmVtb3RlX2VuZHBvaW50KHJl
bW90ZSkpIHsKKwkJCQlsdmRzLT5saW5rX3R5cGUgPSBMVkRTX1NJTkdMRV9MSU5LX1BSSU1BUlk7
CisJCQkJbHZkcy0+cHJpbWFyeSA9ICZsdmRzX3BoeV8xNmZmX3ByaW1hcnk7CisJCQkJbHZkcy0+
c2Vjb25kYXJ5ID0gTlVMTDsKKwkJCX0gZWxzZSB7CisJCQkJcmV0ID0gLUVJTlZBTDsKKwkJCX0K
KworCQkJb2Zfbm9kZV9wdXQocmVtb3RlKTsKKwkJfQorCisJCXJlbW90ZSA9IG9mX2dldF9uZXh0
X2F2YWlsYWJsZV9jaGlsZChwb3J0MiwgTlVMTCk7CisJCWlmIChyZW1vdGUpIHsKKwkJCWlmIChv
Zl9ncmFwaF9nZXRfcmVtb3RlX2VuZHBvaW50KHJlbW90ZSkpIHsKKwkJCQlsdmRzLT5saW5rX3R5
cGUgPSBMVkRTX1NJTkdMRV9MSU5LX1NFQ09OREFSWTsKKwkJCQlsdmRzLT5wcmltYXJ5ID0gTlVM
TDsKKwkJCQlsdmRzLT5zZWNvbmRhcnkgPSAmbHZkc19waHlfMTZmZl9zZWNvbmRhcnk7CisJCQl9
IGVsc2UgeworCQkJCXJldCA9IChyZXQgPT0gLUVJTlZBTCkgPyAtRUlOVkFMIDogMDsKKwkJCX0K
KworCQkJb2Zfbm9kZV9wdXQocmVtb3RlKTsKKwkJfQorCQlicmVhazsKKwlkZWZhdWx0OgorCQly
ZXQgPSAtRUlOVkFMOworCQlnb3RvIGVycl9sdmRzX3Byb2JlOworCX0KKwlvZl9ub2RlX3B1dChw
b3J0MSk7CisJb2Zfbm9kZV9wdXQocG9ydDIpOworCisJbHZkcy0+cGxscmVmX2NsayA9IGRldm1f
Y2xrX2dldChkZXYsICJyZWYiKTsKKwlpZiAoSVNfRVJSKGx2ZHMtPnBsbHJlZl9jbGspKSB7CisJ
CXJldCA9IFBUUl9FUlIobHZkcy0+cGxscmVmX2Nsayk7CisJCWRldl9lcnIoZGV2LCAiVW5hYmxl
IHRvIGdldCByZWZlcmVuY2UgY2xvY2s6ICVkXG4iLCByZXQpOworCQlnb3RvIGVycl9sdmRzX3By
b2JlOworCX0KKworCXJldCA9IGx2ZHNfcGl4ZWxfY2xrX3JlZ2lzdGVyKGx2ZHMpOworCWlmIChy
ZXQpIHsKKwkJZGV2X2VycihkZXYsICJGYWlsZWQgdG8gcmVnaXN0ZXIgTFZEUyBwaXhlbCBjbG9j
azogJWRcbiIsIHJldCk7CisJCWdvdG8gZXJyX2x2ZHNfcHJvYmU7CisJfQorCisJbHZkcy0+bHZk
c19icmlkZ2UuZnVuY3MgPSAmbHZkc19icmlkZ2VfZnVuY3M7CisJbHZkcy0+bHZkc19icmlkZ2Uu
b2Zfbm9kZSA9IGRldi0+b2Zfbm9kZTsKKwlsdmRzLT5od192ZXJzaW9uID0gbHZkc19yZWFkKGx2
ZHMsIExWRFNfVkVSUik7CisKKwlkZXZfaW5mbyhkZXYsICJ2ZXJzaW9uIDB4JTAyeCBpbml0aWFs
aXplZFxuIiwgbHZkcy0+aHdfdmVyc2lvbik7CisKKwlkcm1fYnJpZGdlX2FkZCgmbHZkcy0+bHZk
c19icmlkZ2UpOworCisJcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgbHZkcyk7CisKKwljbGtf
ZGlzYWJsZV91bnByZXBhcmUobHZkcy0+cGNsayk7CisKKwlyZXR1cm4gMDsKKworZXJyX2x2ZHNf
cHJvYmU6CisJY2xrX2Rpc2FibGVfdW5wcmVwYXJlKGx2ZHMtPnBjbGspOworCisJcmV0dXJuIHJl
dDsKK30KKworc3RhdGljIGludCBsdmRzX3JlbW92ZShzdHJ1Y3QgcGxhdGZvcm1fZGV2aWNlICpw
ZGV2KQoreworCXN0cnVjdCBzdG1fbHZkcyAqbHZkcyA9IHBsYXRmb3JtX2dldF9kcnZkYXRhKHBk
ZXYpOworCisJbHZkc19waXhlbF9jbGtfdW5yZWdpc3RlcihsdmRzKTsKKworCWRybV9icmlkZ2Vf
cmVtb3ZlKCZsdmRzLT5sdmRzX2JyaWRnZSk7CisKKwlyZXR1cm4gMDsKK30KKworc3RhdGljIGNv
bnN0IHN0cnVjdCBvZl9kZXZpY2VfaWQgbHZkc19kdF9pZHNbXSA9IHsKKwl7CisJCS5jb21wYXRp
YmxlID0gInN0LHN0bTMybXAyNS1sdmRzIiwKKwkJLmRhdGEgPSBOVUxMCisJfSwKKwl7IC8qIHNl
bnRpbmVsICovIH0KK307CisKK01PRFVMRV9ERVZJQ0VfVEFCTEUob2YsIGx2ZHNfZHRfaWRzKTsK
Kworc3RhdGljIHN0cnVjdCBwbGF0Zm9ybV9kcml2ZXIgbHZkc19wbGF0Zm9ybV9kcml2ZXIgPSB7
CisJLnByb2JlID0gbHZkc19wcm9iZSwKKwkucmVtb3ZlID0gbHZkc19yZW1vdmUsCisJLmRyaXZl
ciA9IHsKKwkJLm5hbWUgPSAic3RtMzItZGlzcGxheS1sdmRzIiwKKwkJLm93bmVyID0gVEhJU19N
T0RVTEUsCisJCS5vZl9tYXRjaF90YWJsZSA9IGx2ZHNfZHRfaWRzLAorCX0sCit9OworCittb2R1
bGVfcGxhdGZvcm1fZHJpdmVyKGx2ZHNfcGxhdGZvcm1fZHJpdmVyKTsKKworTU9EVUxFX0FVVEhP
UigiUmFwaGHDq2wgR2FsbGFpcy1Qb3UgPHJhcGhhZWwuZ2FsbGFpcy1wb3VAZm9zcy5zdC5jb20+
Iik7CitNT0RVTEVfQVVUSE9SKCJQaGlsaXBwZSBDb3JudSA8cGhpbGlwcGUuY29ybnVAZm9zcy5z
dC5jb20+Iik7CitNT0RVTEVfQVVUSE9SKCJZYW5uaWNrIEZlcnRyZSA8eWFubmljay5mZXJ0cmVA
Zm9zcy5zdC5jb20+Iik7CitNT0RVTEVfREVTQ1JJUFRJT04oIlNUTWljcm9lbGVjdHJvbmljcyBM
VkRTIERpc3BsYXkgSW50ZXJmYWNlIFRyYW5zbWl0dGVyIERSTSBkcml2ZXIiKTsKK01PRFVMRV9M
SUNFTlNFKCJHUEwiKTsKCi0tIAoyLjI1LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkxpbnV4LXN0bTMyIG1haWxpbmcgbGlzdApMaW51eC1zdG0zMkBz
dC1tZC1tYWlsbWFuLnN0b3JtcmVwbHkuY29tCmh0dHBzOi8vc3QtbWQtbWFpbG1hbi5zdG9ybXJl
cGx5LmNvbS9tYWlsbWFuL2xpc3RpbmZvL2xpbnV4LXN0bTMyCg==
