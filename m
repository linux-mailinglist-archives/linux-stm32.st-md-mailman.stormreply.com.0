Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id 61312218255
	for <lists+linux-stm32@lfdr.de>; Wed,  8 Jul 2020 10:28:37 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 24BC6C36B31;
	Wed,  8 Jul 2020 08:28:37 +0000 (UTC)
Received: from out30-130.freemail.mail.aliyun.com
 (out30-130.freemail.mail.aliyun.com [115.124.30.130])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 9624DC36B2A
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Wed,  8 Jul 2020 08:28:28 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R191e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=e01f04397;
 MF=tianjia.zhang@linux.alibaba.com; NM=1; PH=DS; RN=21; SR=0;
 TI=SMTPD_---0U25oiZX_1594196900; 
Received: from localhost(mailfrom:tianjia.zhang@linux.alibaba.com
 fp:SMTPD_---0U25oiZX_1594196900) by smtp.aliyun-inc.com(127.0.0.1);
 Wed, 08 Jul 2020 16:28:21 +0800
From: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
To: herbert@gondor.apana.org.au, davem@davemloft.net, dhowells@redhat.com,
 mcoquelin.stm32@gmail.com, alexandre.torgue@st.com, jmorris@namei.org,
 serge@hallyn.com, nramas@linux.microsoft.com, tusharsu@linux.microsoft.com,
 zohar@linux.ibm.com, gilad@benyossef.com, pvanleeuwen@rambus.com
Date: Wed,  8 Jul 2020 16:28:13 +0800
Message-Id: <20200708082818.5511-4-tianjia.zhang@linux.alibaba.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200708082818.5511-1-tianjia.zhang@linux.alibaba.com>
References: <20200708082818.5511-1-tianjia.zhang@linux.alibaba.com>
MIME-Version: 1.0
Cc: tianjia.zhang@linux.alibaba.com, linux-kernel@vger.kernel.org,
 linux-security-module@vger.kernel.org, keyrings@vger.kernel.org,
 linux-crypto@vger.kernel.org, zhang.jia@linux.alibaba.com,
 linux-integrity@vger.kernel.org, linux-stm32@st-md-mailman.stormreply.com,
 linux-arm-kernel@lists.infradead.org
Subject: [Linux-stm32] [PATCH v4 3/8] lib/mpi: Introduce ec implementation
	to MPI library
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

VGhlIGltcGxlbWVudGF0aW9uIG9mIEVDIGlzIGludHJvZHVjZWQgZnJvbSBsaWJnY3J5cHQgYXMg
dGhlCmJhc2ljIGFsZ29yaXRobSBvZiBlbGxpcHRpYyBjdXJ2ZSwgd2hpY2ggY2FuIGJlIG1vcmUg
cGVyZmVjdGx5CmludGVncmF0ZWQgd2l0aCBNUEkgaW1wbGVtZW50YXRpb24uClNvbWUgb3RoZXIg
YWxnb3JpdGhtcyB3aWxsIGJlIGRldmVsb3BlZCBiYXNlZCBvbiBtcGkgZWNjLCBzdWNoIGFzIFNN
Mi4KClNpZ25lZC1vZmYtYnk6IFRpYW5qaWEgWmhhbmcgPHRpYW5qaWEuemhhbmdAbGludXguYWxp
YmFiYS5jb20+Ci0tLQogaW5jbHVkZS9saW51eC9tcGkuaCB8ICAxMDUgKysrCiBsaWIvbXBpL01h
a2VmaWxlICAgIHwgICAgMSArCiBsaWIvbXBpL2VjLmMgICAgICAgIHwgMTUzOCArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDE2NDQg
aW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGxpYi9tcGkvZWMuYwoKZGlmZiAtLWdp
dCBhL2luY2x1ZGUvbGludXgvbXBpLmggYi9pbmNsdWRlL2xpbnV4L21waS5oCmluZGV4IDJkZGRm
NGM2ZTAxMS4uMjBhMzFkNWMyOWQyIDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L21waS5oCisr
KyBiL2luY2x1ZGUvbGludXgvbXBpLmgKQEAgLTE1NSw2ICsxNTUsMTExIEBAIHZvaWQgbXBpX2Zk
aXZfcShNUEkgcXVvdCwgTVBJIGRpdmlkZW5kLCBNUEkgZGl2aXNvcik7CiAvKi0tIG1waS1pbnYu
YyAtLSovCiBpbnQgbXBpX2ludm0oTVBJIHgsIE1QSSBhLCBNUEkgbik7CiAKKy8qLS0gZWMuYyAt
LSovCisKKy8qIE9iamVjdCB0byByZXByZXNlbnQgYSBwb2ludCBpbiBwcm9qZWN0aXZlIGNvb3Jk
aW5hdGVzICovCitzdHJ1Y3QgZ2NyeV9tcGlfcG9pbnQgeworCU1QSSB4OworCU1QSSB5OworCU1Q
SSB6OworfTsKKwordHlwZWRlZiBzdHJ1Y3QgZ2NyeV9tcGlfcG9pbnQgKk1QSV9QT0lOVDsKKwor
LyogTW9kZWxzIGRlc2NyaWJpbmcgYW4gZWxsaXB0aWMgY3VydmUgKi8KK2VudW0gZ2NyeV9tcGlf
ZWNfbW9kZWxzIHsKKwkvKiBUaGUgU2hvcnQgV2VpZXJzdHJhc3MgZXF1YXRpb24gaXMKKwkgKiAg
ICAgIHleMiA9IHheMyArIGF4ICsgYgorCSAqLworCU1QSV9FQ19XRUlFUlNUUkFTUyA9IDAsCisJ
LyogVGhlIE1vbnRnb21lcnkgZXF1YXRpb24gaXMKKwkgKiAgICAgIGJ5XjIgPSB4XjMgKyBheF4y
ICsgeAorCSAqLworCU1QSV9FQ19NT05UR09NRVJZLAorCS8qIFRoZSBUd2lzdGVkIEVkd2FyZHMg
ZXF1YXRpb24gaXMKKwkgKiAgICAgIGF4XjIgKyB5XjIgPSAxICsgYnheMnleMgorCSAqIE5vdGUg
dGhhdCB3ZSB1c2UgJ2InIGluc3RlYWQgb2YgdGhlIGNvbW1vbmx5IHVzZWQgJ2QnLgorCSAqLwor
CU1QSV9FQ19FRFdBUkRTCit9OworCisvKiBEaWFsZWN0cyB1c2VkIHdpdGggZWxsaXB0aWMgY3Vy
dmVzICovCitlbnVtIGVjY19kaWFsZWN0cyB7CisJRUNDX0RJQUxFQ1RfU1RBTkRBUkQgPSAwLAor
CUVDQ19ESUFMRUNUX0VEMjU1MTksCisJRUNDX0RJQUxFQ1RfU0FGRUNVUlZFCit9OworCisvKiBU
aGlzIGNvbnRleHQgaXMgdXNlZCB3aXRoIGFsbCBvdXIgRUMgZnVuY3Rpb25zLiAqLworc3RydWN0
IG1waV9lY19jdHggeworCWVudW0gZ2NyeV9tcGlfZWNfbW9kZWxzIG1vZGVsOyAvKiBUaGUgbW9k
ZWwgZGVzY3JpYmluZyB0aGlzIGN1cnZlLiAqLworCWVudW0gZWNjX2RpYWxlY3RzIGRpYWxlY3Q7
ICAgICAvKiBUaGUgRUNDIGRpYWxlY3QgdXNlZCB3aXRoIHRoZSBjdXJ2ZS4gKi8KKwlpbnQgZmxh
Z3M7ICAgICAgICAgICAgICAgICAgICAgLyogUHVibGljIGtleSBmbGFncyAobm90IGFsd2F5cyB1
c2VkKS4gKi8KKwl1bnNpZ25lZCBpbnQgbmJpdHM7ICAgICAgICAgICAgLyogTnVtYmVyIG9mIGJp
dHMuICAqLworCisJLyogRG9tYWluIHBhcmFtZXRlcnMuICBOb3RlIHRoYXQgdGhleSBtYXkgbm90
IGFsbCBiZSBzZXQgYW5kIGlmIHNldAorCSAqIHRoZSBNUElzIG1heSBiZSBmbGFnZWQgYXMgY29u
c3RhbnQuCisJICovCisJTVBJIHA7ICAgICAgICAgLyogUHJpbWUgc3BlY2lmeWluZyB0aGUgZmll
bGQgR0YocCkuICAqLworCU1QSSBhOyAgICAgICAgIC8qIEZpcnN0IGNvZWZmaWNpZW50IG9mIHRo
ZSBXZWllcnN0cmFzcyBlcXVhdGlvbi4gICovCisJTVBJIGI7ICAgICAgICAgLyogU2Vjb25kIGNv
ZWZmaWNpZW50IG9mIHRoZSBXZWllcnN0cmFzcyBlcXVhdGlvbi4gICovCisJTVBJX1BPSU5UIEc7
ICAgLyogQmFzZSBwb2ludCAoZ2VuZXJhdG9yKS4gICovCisJTVBJIG47ICAgICAgICAgLyogT3Jk
ZXIgb2YgRy4gICovCisJdW5zaWduZWQgaW50IGg7ICAgICAgIC8qIENvZmFjdG9yLiAgKi8KKwor
CS8qIFRoZSBhY3R1YWwga2V5LiAgTWF5IG5vdCBiZSBzZXQuICAqLworCU1QSV9QT0lOVCBROyAg
IC8qIFB1YmxpYyBrZXkuICAgKi8KKwlNUEkgZDsgICAgICAgICAvKiBQcml2YXRlIGtleS4gICov
CisKKwljb25zdCBjaGFyICpuYW1lOyAgICAgIC8qIE5hbWUgb2YgdGhlIGN1cnZlLiAgKi8KKwor
CS8qIFRoaXMgc3RydWN0dXJlIGlzIHByaXZhdGUgdG8gbXBpL2VjLmMhICovCisJc3RydWN0IHsK
KwkJc3RydWN0IHsKKwkJCXVuc2lnbmVkIGludCBhX2lzX3BtaW51czM6MTsKKwkJCXVuc2lnbmVk
IGludCB0d29faW52X3A6MTsKKwkJfSB2YWxpZDsgLyogRmxhZ3MgdG8gaGVscCBzZXR0aW5nIHRo
ZSBoZWxwZXIgdmFycyBiZWxvdy4gICovCisKKwkJaW50IGFfaXNfcG1pbnVzMzsgIC8qIFRydWUg
aWYgQSA9IFAgLSAzLiAqLworCisJCU1QSSB0d29faW52X3A7CisKKwkJbXBpX2JhcnJldHRfdCBw
X2JhcnJldHQ7CisKKwkJLyogU2NyYXRjaCB2YXJpYWJsZXMuICAqLworCQlNUEkgc2NyYXRjaFsx
MV07CisKKwkJLyogSGVscGVyIGZvciBmYXN0IHJlZHVjdGlvbi4gICovCisJCS8qICAgaW50IG5p
c3RfbmJpdHM7IC9cKiBJZiB0aGlzIGlzIGEgTklTVCBjdXJ2ZSwgdGhlICMgb2YgYml0cy4gKlwv
ICovCisJCS8qICAgTVBJIHNbMTBdOyAqLworCQkvKiAgIE1QSSBjOyAqLworCX0gdDsKKworCS8q
IEN1cnZlIHNwZWNpZmljIGNvbXB1dGF0aW9uIHJvdXRpbmVzIGZvciB0aGUgZmllbGQuICAqLwor
CXZvaWQgKCphZGRtKShNUEkgdywgTVBJIHUsIE1QSSB2LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4
KTsKKwl2b2lkICgqc3VibSkoTVBJIHcsIE1QSSB1LCBNUEkgdiwgc3RydWN0IG1waV9lY19jdHgg
KmVjKTsKKwl2b2lkICgqbXVsbSkoTVBJIHcsIE1QSSB1LCBNUEkgdiwgc3RydWN0IG1waV9lY19j
dHggKmN0eCk7CisJdm9pZCAoKnBvdzIpKE1QSSB3LCBjb25zdCBNUEkgYiwgc3RydWN0IG1waV9l
Y19jdHggKmN0eCk7CisJdm9pZCAoKm11bDIpKE1QSSB3LCBNUEkgdSwgc3RydWN0IG1waV9lY19j
dHggKmN0eCk7Cit9OworCit2b2lkIG1waV9lY19pbml0KHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgs
IGVudW0gZ2NyeV9tcGlfZWNfbW9kZWxzIG1vZGVsLAorCQkJZW51bSBlY2NfZGlhbGVjdHMgZGlh
bGVjdCwKKwkJCWludCBmbGFncywgTVBJIHAsIE1QSSBhLCBNUEkgYik7Cit2b2lkIG1waV9lY19k
ZWluaXQoc3RydWN0IG1waV9lY19jdHggKmN0eCk7CitNUElfUE9JTlQgbXBpX3BvaW50X25ldyh1
bnNpZ25lZCBpbnQgbmJpdHMpOwordm9pZCBtcGlfcG9pbnRfcmVsZWFzZShNUElfUE9JTlQgcCk7
Cit2b2lkIG1waV9wb2ludF9pbml0KE1QSV9QT0lOVCBwKTsKK3ZvaWQgbXBpX3BvaW50X2ZyZWVf
cGFydHMoTVBJX1BPSU5UIHApOworaW50IG1waV9lY19nZXRfYWZmaW5lKE1QSSB4LCBNUEkgeSwg
TVBJX1BPSU5UIHBvaW50LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KTsKK3ZvaWQgbXBpX2VjX2Fk
ZF9wb2ludHMoTVBJX1BPSU5UIHJlc3VsdCwKKwkJCU1QSV9QT0lOVCBwMSwgTVBJX1BPSU5UIHAy
LAorCQkJc3RydWN0IG1waV9lY19jdHggKmN0eCk7Cit2b2lkIG1waV9lY19tdWxfcG9pbnQoTVBJ
X1BPSU5UIHJlc3VsdCwKKwkJCU1QSSBzY2FsYXIsIE1QSV9QT0lOVCBwb2ludCwKKwkJCXN0cnVj
dCBtcGlfZWNfY3R4ICpjdHgpOworaW50IG1waV9lY19jdXJ2ZV9wb2ludChNUElfUE9JTlQgcG9p
bnQsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpOworCiAvKiBpbmxpbmUgZnVuY3Rpb25zICovCiAK
IC8qKgpkaWZmIC0tZ2l0IGEvbGliL21waS9NYWtlZmlsZSBiL2xpYi9tcGkvTWFrZWZpbGUKaW5k
ZXggNWY0MGY5M2ZmM2Q5Li4wZDA3ZTNkMmUwZjQgMTAwNjQ0Ci0tLSBhL2xpYi9tcGkvTWFrZWZp
bGUKKysrIGIvbGliL21waS9NYWtlZmlsZQpAQCAtMTMsNiArMTMsNyBAQCBtcGkteSA9IFwKIAln
ZW5lcmljX21waWgtcnNoaWZ0Lm8JCVwKIAlnZW5lcmljX21waWgtc3ViMS5vCQlcCiAJZ2VuZXJp
Y19tcGloLWFkZDEubwkJXAorCWVjLm8JCQkJXAogCW1waWNvZGVyLm8JCQlcCiAJbXBpLWFkZC5v
CQkJXAogCW1waS1iaXQubwkJCVwKZGlmZiAtLWdpdCBhL2xpYi9tcGkvZWMuYyBiL2xpYi9tcGkv
ZWMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjM1OWMxYjU4ZWQx
MQotLS0gL2Rldi9udWxsCisrKyBiL2xpYi9tcGkvZWMuYwpAQCAtMCwwICsxLDE1MzggQEAKKy8q
IGVjLmMgLSAgRWxsaXB0aWMgQ3VydmUgZnVuY3Rpb25zCisgKiBDb3B5cmlnaHQgKEMpIDIwMDcg
RnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuCisgKiBDb3B5cmlnaHQgKEMpIDIwMTMgZzEw
IENvZGUgR21iSAorICoKKyAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIExpYmdjcnlwdC4KKyAqCisg
KiBMaWJnY3J5cHQgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5k
L29yIG1vZGlmeQorICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgYXMKKyAqIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBG
b3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyLjEgb2YKKyAqIHRoZSBMaWNlbnNlLCBvciAoYXQg
eW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqIExpYmdjcnlwdCBpcyBkaXN0
cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhP
VVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAq
IE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNl
ZSB0aGUKKyAqIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRh
aWxzLgorICoKKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07
IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyAqLworCisjaW5j
bHVkZSAibXBpLWludGVybmFsLmgiCisjaW5jbHVkZSAibG9uZ2xvbmcuaCIKKworI2RlZmluZSBw
b2ludF9pbml0KGEpICBtcGlfcG9pbnRfaW5pdCgoYSkpCisjZGVmaW5lIHBvaW50X2ZyZWUoYSkg
IG1waV9wb2ludF9mcmVlX3BhcnRzKChhKSkKKworI2RlZmluZSBsb2dfZXJyb3IoZm10LCAuLi4p
IHByX2VycihmbXQsICMjX19WQV9BUkdTX18pCisjZGVmaW5lIGxvZ19mYXRhbChmbXQsIC4uLikg
cHJfZXJyKGZtdCwgIyNfX1ZBX0FSR1NfXykKKworI2RlZmluZSBESU0odikgKHNpemVvZih2KS9z
aXplb2YoKHYpWzBdKSkKKworCisvKiBDcmVhdGUgYSBuZXcgcG9pbnQgb3B0aW9uLiAgTkJJVFMg
Z2l2ZXMgdGhlIHNpemUgaW4gYml0cyBvZiBvbmUKKyAqIGNvb3JkaW5hdGU7IGl0IGlzIG9ubHkg
dXNlZCB0byBwcmUtYWxsb2NhdGUgc29tZSByZXNvdXJjZXMgYW5kCisgKiBtaWdodCBhbHNvIGJl
IHBhc3NlZCBhcyAwIHRvIHVzZSBhIGRlZmF1bHQgdmFsdWUuCisgKi8KK01QSV9QT0lOVCBtcGlf
cG9pbnRfbmV3KHVuc2lnbmVkIGludCBuYml0cykKK3sKKwlNUElfUE9JTlQgcDsKKworCSh2b2lk
KW5iaXRzOyAgLyogQ3VycmVudGx5IG5vdCB1c2VkLiAgKi8KKworCXAgPSBrbWFsbG9jKHNpemVv
ZigqcCksIEdGUF9LRVJORUwpOworCWlmIChwKQorCQltcGlfcG9pbnRfaW5pdChwKTsKKwlyZXR1
cm4gcDsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKG1waV9wb2ludF9uZXcpOworCisvKiBSZWxlYXNl
IHRoZSBwb2ludCBvYmplY3QgUC4gIFAgbWF5IGJlIE5VTEwuICovCit2b2lkIG1waV9wb2ludF9y
ZWxlYXNlKE1QSV9QT0lOVCBwKQoreworCWlmIChwKSB7CisJCW1waV9wb2ludF9mcmVlX3BhcnRz
KHApOworCQlrZnJlZShwKTsKKwl9Cit9CitFWFBPUlRfU1lNQk9MX0dQTChtcGlfcG9pbnRfcmVs
ZWFzZSk7CisKKy8qIEluaXRpYWxpemUgdGhlIGZpZWxkcyBvZiBhIHBvaW50IG9iamVjdC4gIGdj
cnlfbXBpX3BvaW50X2ZyZWVfcGFydHMKKyAqIG1heSBiZSB1c2VkIHRvIHJlbGVhc2UgdGhlIGZp
ZWxkcy4KKyAqLwordm9pZCBtcGlfcG9pbnRfaW5pdChNUElfUE9JTlQgcCkKK3sKKwlwLT54ID0g
bXBpX25ldygwKTsKKwlwLT55ID0gbXBpX25ldygwKTsKKwlwLT56ID0gbXBpX25ldygwKTsKK30K
K0VYUE9SVF9TWU1CT0xfR1BMKG1waV9wb2ludF9pbml0KTsKKworLyogUmVsZWFzZSB0aGUgcGFy
dHMgb2YgYSBwb2ludCBvYmplY3QuICovCit2b2lkIG1waV9wb2ludF9mcmVlX3BhcnRzKE1QSV9Q
T0lOVCBwKQoreworCW1waV9mcmVlKHAtPngpOyBwLT54ID0gTlVMTDsKKwltcGlfZnJlZShwLT55
KTsgcC0+eSA9IE5VTEw7CisJbXBpX2ZyZWUocC0+eik7IHAtPnogPSBOVUxMOworfQorRVhQT1JU
X1NZTUJPTF9HUEwobXBpX3BvaW50X2ZyZWVfcGFydHMpOworCisvKiBTZXQgdGhlIHZhbHVlIGZy
b20gUyBpbnRvIEQuICAqLworc3RhdGljIHZvaWQgcG9pbnRfc2V0KE1QSV9QT0lOVCBkLCBNUElf
UE9JTlQgcykKK3sKKwltcGlfc2V0KGQtPngsIHMtPngpOworCW1waV9zZXQoZC0+eSwgcy0+eSk7
CisJbXBpX3NldChkLT56LCBzLT56KTsKK30KKworc3RhdGljIHZvaWQgcG9pbnRfcmVzaXplKE1Q
SV9QT0lOVCBwLCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCXNpemVfdCBubGltYnMgPSBj
dHgtPnAtPm5saW1iczsKKworCW1waV9yZXNpemUocC0+eCwgbmxpbWJzKTsKKwlwLT54LT5ubGlt
YnMgPSBubGltYnM7CisJbXBpX3Jlc2l6ZShwLT56LCBubGltYnMpOworCXAtPnotPm5saW1icyA9
IG5saW1iczsKKworCWlmIChjdHgtPm1vZGVsICE9IE1QSV9FQ19NT05UR09NRVJZKSB7CisJCW1w
aV9yZXNpemUocC0+eSwgbmxpbWJzKTsKKwkJcC0+eS0+bmxpbWJzID0gbmxpbWJzOworCX0KK30K
Kworc3RhdGljIHZvaWQgcG9pbnRfc3dhcF9jb25kKE1QSV9QT0lOVCBkLCBNUElfUE9JTlQgcywg
dW5zaWduZWQgbG9uZyBzd2FwLAorCQlzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCW1waV9z
d2FwX2NvbmQoZC0+eCwgcy0+eCwgc3dhcCk7CisJaWYgKGN0eC0+bW9kZWwgIT0gTVBJX0VDX01P
TlRHT01FUlkpCisJCW1waV9zd2FwX2NvbmQoZC0+eSwgcy0+eSwgc3dhcCk7CisJbXBpX3N3YXBf
Y29uZChkLT56LCBzLT56LCBzd2FwKTsKK30KKworCisvKiBXID0gVyBtb2QgUC4gICovCitzdGF0
aWMgdm9pZCBlY19tb2QoTVBJIHcsIHN0cnVjdCBtcGlfZWNfY3R4ICplYykKK3sKKwlpZiAoZWMt
PnQucF9iYXJyZXR0KQorCQltcGlfbW9kX2JhcnJldHQodywgdywgZWMtPnQucF9iYXJyZXR0KTsK
KwllbHNlCisJCW1waV9tb2QodywgdywgZWMtPnApOworfQorCitzdGF0aWMgdm9pZCBlY19hZGRt
KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX2Fk
ZCh3LCB1LCB2KTsKKwllY19tb2QodywgY3R4KTsKK30KKworc3RhdGljIHZvaWQgZWNfc3VibShN
UEkgdywgTVBJIHUsIE1QSSB2LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqZWMpCit7CisJbXBpX3N1Yih3
LCB1LCB2KTsKKwl3aGlsZSAody0+c2lnbikKKwkJbXBpX2FkZCh3LCB3LCBlYy0+cCk7CisJLypl
Y19tb2QodywgZWMpOyovCit9CisKK3N0YXRpYyB2b2lkIGVjX211bG0oTVBJIHcsIE1QSSB1LCBN
UEkgdiwgc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwltcGlfbXVsKHcsIHUsIHYpOworCWVj
X21vZCh3LCBjdHgpOworfQorCisvKiBXID0gMiAqIFUgbW9kIFAuICAqLworc3RhdGljIHZvaWQg
ZWNfbXVsMihNUEkgdywgTVBJIHUsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX2xz
aGlmdCh3LCB1LCAxKTsKKwllY19tb2QodywgY3R4KTsKK30KKworc3RhdGljIHZvaWQgZWNfcG93
bShNUEkgdywgY29uc3QgTVBJIGIsIGNvbnN0IE1QSSBlLAorCQlzdHJ1Y3QgbXBpX2VjX2N0eCAq
Y3R4KQoreworCW1waV9wb3dtKHcsIGIsIGUsIGN0eC0+cCk7CisJLyogbXBpX2Ficyh3KTsgKi8K
K30KKworLyogU2hvcnRjdXQgZm9yCisgKiBlY19wb3dtKEIsIEIsIG1waV9jb25zdChNUElfQ19U
V08pLCBjdHgpOworICogZm9yIGVhc2llciBvcHRpbWl6YXRpb24uCisgKi8KK3N0YXRpYyB2b2lk
IGVjX3BvdzIoTVBJIHcsIGNvbnN0IE1QSSBiLCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQorewor
CS8qIFVzaW5nIG1waV9tdWwgaXMgc2xpZ2h0bHkgZmFzdGVyIChhdCBsZWFzdCBvbiBhbWQ2NCku
ICAqLworCS8qIG1waV9wb3dtKHcsIGIsIG1waV9jb25zdChNUElfQ19UV08pLCBjdHgtPnApOyAq
LworCWVjX211bG0odywgYiwgYiwgY3R4KTsKK30KKworLyogU2hvcnRjdXQgZm9yCisgKiBlY19w
b3dtKEIsIEIsIG1waV9jb25zdChNUElfQ19USFJFRSksIGN0eCk7CisgKiBmb3IgZWFzaWVyIG9w
dGltaXphdGlvbi4KKyAqLworc3RhdGljIHZvaWQgZWNfcG93MyhNUEkgdywgY29uc3QgTVBJIGIs
IHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX3Bvd20odywgYiwgbXBpX2NvbnN0KE1Q
SV9DX1RIUkVFKSwgY3R4LT5wKTsKK30KKworc3RhdGljIHZvaWQgZWNfaW52bShNUEkgeCwgTVBJ
IGEsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJaWYgKCFtcGlfaW52bSh4LCBhLCBjdHgt
PnApKQorCQlsb2dfZXJyb3IoImVjX2ludm06IGludmVyc2UgZG9lcyBub3QgZXhpc3Q6XG4iKTsK
K30KKworc3RhdGljIHZvaWQgbXBpaF9zZXRfY29uZChtcGlfcHRyX3Qgd3AsIG1waV9wdHJfdCB1
cCwKKwkJbXBpX3NpemVfdCB1c2l6ZSwgdW5zaWduZWQgbG9uZyBzZXQpCit7CisJbXBpX3NpemVf
dCBpOworCW1waV9saW1iX3QgbWFzayA9ICgobXBpX2xpbWJfdCkwKSAtIHNldDsKKwltcGlfbGlt
Yl90IHg7CisKKwlmb3IgKGkgPSAwOyBpIDwgdXNpemU7IGkrKykgeworCQl4ID0gbWFzayAmICh3
cFtpXSBeIHVwW2ldKTsKKwkJd3BbaV0gPSB3cFtpXSBeIHg7CisJfQorfQorCisvKiBSb3V0aW5l
cyBmb3IgMl4yNTUgLSAxOS4gICovCisKKyNkZWZpbmUgTElNQl9TSVpFXzI1NTE5ICgoMjU2K0JJ
VFNfUEVSX01QSV9MSU1CLTEpL0JJVFNfUEVSX01QSV9MSU1CKQorCitzdGF0aWMgdm9pZCBlY19h
ZGRtXzI1NTE5KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7
CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJbXBpX3NpemVfdCB3c2l6ZSA9IExJTUJfU0laRV8y
NTUxOTsKKwltcGlfbGltYl90IG5bTElNQl9TSVpFXzI1NTE5XTsKKwltcGlfbGltYl90IGJvcnJv
dzsKKworCWlmICh3LT5ubGltYnMgIT0gd3NpemUgfHwgdS0+bmxpbWJzICE9IHdzaXplIHx8IHYt
Pm5saW1icyAhPSB3c2l6ZSkKKwkJbG9nX2J1ZygiYWRkbV8yNTUxOTogZGlmZmVyZW50IHNpemVz
XG4iKTsKKworCW1lbXNldChuLCAwLCBzaXplb2YobikpOworCXVwID0gdS0+ZDsKKwl2cCA9IHYt
PmQ7CisJd3AgPSB3LT5kOworCisJbXBpaGVscF9hZGRfbih3cCwgdXAsIHZwLCB3c2l6ZSk7CisJ
Ym9ycm93ID0gbXBpaGVscF9zdWJfbih3cCwgd3AsIGN0eC0+cC0+ZCwgd3NpemUpOworCW1waWhf
c2V0X2NvbmQobiwgY3R4LT5wLT5kLCB3c2l6ZSwgKGJvcnJvdyAhPSAwVUwpKTsKKwltcGloZWxw
X2FkZF9uKHdwLCB3cCwgbiwgd3NpemUpOworCXdwW0xJTUJfU0laRV8yNTUxOS0xXSAmPSB+KCht
cGlfbGltYl90KTEgPDwgKDI1NSAlIEJJVFNfUEVSX01QSV9MSU1CKSk7Cit9CisKK3N0YXRpYyB2
b2lkIGVjX3N1Ym1fMjU1MTkoTVBJIHcsIE1QSSB1LCBNUEkgdiwgc3RydWN0IG1waV9lY19jdHgg
KmN0eCkKK3sKKwltcGlfcHRyX3Qgd3AsIHVwLCB2cDsKKwltcGlfc2l6ZV90IHdzaXplID0gTElN
Ql9TSVpFXzI1NTE5OworCW1waV9saW1iX3QgbltMSU1CX1NJWkVfMjU1MTldOworCW1waV9saW1i
X3QgYm9ycm93OworCisJaWYgKHctPm5saW1icyAhPSB3c2l6ZSB8fCB1LT5ubGltYnMgIT0gd3Np
emUgfHwgdi0+bmxpbWJzICE9IHdzaXplKQorCQlsb2dfYnVnKCJzdWJtXzI1NTE5OiBkaWZmZXJl
bnQgc2l6ZXNcbiIpOworCisJbWVtc2V0KG4sIDAsIHNpemVvZihuKSk7CisJdXAgPSB1LT5kOwor
CXZwID0gdi0+ZDsKKwl3cCA9IHctPmQ7CisKKwlib3Jyb3cgPSBtcGloZWxwX3N1Yl9uKHdwLCB1
cCwgdnAsIHdzaXplKTsKKwltcGloX3NldF9jb25kKG4sIGN0eC0+cC0+ZCwgd3NpemUsIChib3Jy
b3cgIT0gMFVMKSk7CisJbXBpaGVscF9hZGRfbih3cCwgd3AsIG4sIHdzaXplKTsKKwl3cFtMSU1C
X1NJWkVfMjU1MTktMV0gJj0gfigobXBpX2xpbWJfdCkxIDw8ICgyNTUgJSBCSVRTX1BFUl9NUElf
TElNQikpOworfQorCitzdGF0aWMgdm9pZCBlY19tdWxtXzI1NTE5KE1QSSB3LCBNUEkgdSwgTVBJ
IHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJ
bXBpX3NpemVfdCB3c2l6ZSA9IExJTUJfU0laRV8yNTUxOTsKKwltcGlfbGltYl90IG5bTElNQl9T
SVpFXzI1NTE5KjJdOworCW1waV9saW1iX3QgbVtMSU1CX1NJWkVfMjU1MTkrMV07CisJbXBpX2xp
bWJfdCBjeTsKKwlpbnQgbXNiOworCisJKHZvaWQpY3R4OworCWlmICh3LT5ubGltYnMgIT0gd3Np
emUgfHwgdS0+bmxpbWJzICE9IHdzaXplIHx8IHYtPm5saW1icyAhPSB3c2l6ZSkKKwkJbG9nX2J1
ZygibXVsbV8yNTUxOTogZGlmZmVyZW50IHNpemVzXG4iKTsKKworCXVwID0gdS0+ZDsKKwl2cCA9
IHYtPmQ7CisJd3AgPSB3LT5kOworCisJbXBpaGVscF9tdWxfbihuLCB1cCwgdnAsIHdzaXplKTsK
KwltZW1jcHkod3AsIG4sIHdzaXplICogQllURVNfUEVSX01QSV9MSU1CKTsKKwl3cFtMSU1CX1NJ
WkVfMjU1MTktMV0gJj0gfigobXBpX2xpbWJfdCkxIDw8ICgyNTUgJSBCSVRTX1BFUl9NUElfTElN
QikpOworCisJbWVtY3B5KG0sIG4rTElNQl9TSVpFXzI1NTE5LTEsICh3c2l6ZSsxKSAqIEJZVEVT
X1BFUl9NUElfTElNQik7CisJbXBpaGVscF9yc2hpZnQobSwgbSwgTElNQl9TSVpFXzI1NTE5KzEs
ICgyNTUgJSBCSVRTX1BFUl9NUElfTElNQikpOworCisJbWVtY3B5KG4sIG0sIHdzaXplICogQllU
RVNfUEVSX01QSV9MSU1CKTsKKwljeSA9IG1waWhlbHBfbHNoaWZ0KG0sIG0sIExJTUJfU0laRV8y
NTUxOSwgNCk7CisJbVtMSU1CX1NJWkVfMjU1MTldID0gY3k7CisJY3kgPSBtcGloZWxwX2FkZF9u
KG0sIG0sIG4sIHdzaXplKTsKKwltW0xJTUJfU0laRV8yNTUxOV0gKz0gY3k7CisJY3kgPSBtcGlo
ZWxwX2FkZF9uKG0sIG0sIG4sIHdzaXplKTsKKwltW0xJTUJfU0laRV8yNTUxOV0gKz0gY3k7CisJ
Y3kgPSBtcGloZWxwX2FkZF9uKG0sIG0sIG4sIHdzaXplKTsKKwltW0xJTUJfU0laRV8yNTUxOV0g
Kz0gY3k7CisKKwljeSA9IG1waWhlbHBfYWRkX24od3AsIHdwLCBtLCB3c2l6ZSk7CisJbVtMSU1C
X1NJWkVfMjU1MTldICs9IGN5OworCisJbWVtc2V0KG0sIDAsIHdzaXplICogQllURVNfUEVSX01Q
SV9MSU1CKTsKKwltc2IgPSAod3BbTElNQl9TSVpFXzI1NTE5LTFdID4+ICgyNTUgJSBCSVRTX1BF
Ul9NUElfTElNQikpOworCW1bMF0gPSAobVtMSU1CX1NJWkVfMjU1MTldICogMiArIG1zYikgKiAx
OTsKKwl3cFtMSU1CX1NJWkVfMjU1MTktMV0gJj0gfigobXBpX2xpbWJfdCkxIDw8ICgyNTUgJSBC
SVRTX1BFUl9NUElfTElNQikpOworCW1waWhlbHBfYWRkX24od3AsIHdwLCBtLCB3c2l6ZSk7CisK
KwltWzBdID0gMDsKKwljeSA9IG1waWhlbHBfc3ViX24od3AsIHdwLCBjdHgtPnAtPmQsIHdzaXpl
KTsKKwltcGloX3NldF9jb25kKG0sIGN0eC0+cC0+ZCwgd3NpemUsIChjeSAhPSAwVUwpKTsKKwlt
cGloZWxwX2FkZF9uKHdwLCB3cCwgbSwgd3NpemUpOworfQorCitzdGF0aWMgdm9pZCBlY19tdWwy
XzI1NTE5KE1QSSB3LCBNUEkgdSwgc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwllY19hZGRt
XzI1NTE5KHcsIHUsIHUsIGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGVjX3BvdzJfMjU1MTkoTVBJ
IHcsIGNvbnN0IE1QSSBiLCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCWVjX211bG1fMjU1
MTkodywgYiwgYiwgY3R4KTsKK30KKworLyogUm91dGluZXMgZm9yIDJeNDQ4IC0gMl4yMjQgLSAx
LiAgKi8KKworI2RlZmluZSBMSU1CX1NJWkVfNDQ4ICgoNDQ4K0JJVFNfUEVSX01QSV9MSU1CLTEp
L0JJVFNfUEVSX01QSV9MSU1CKQorI2RlZmluZSBMSU1CX1NJWkVfSEFMRl80NDggKChMSU1CX1NJ
WkVfNDQ4KzEpLzIpCisKK3N0YXRpYyB2b2lkIGVjX2FkZG1fNDQ4KE1QSSB3LCBNUEkgdSwgTVBJ
IHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJ
bXBpX3NpemVfdCB3c2l6ZSA9IExJTUJfU0laRV80NDg7CisJbXBpX2xpbWJfdCBuW0xJTUJfU0la
RV80NDhdOworCW1waV9saW1iX3QgY3k7CisKKwlpZiAody0+bmxpbWJzICE9IHdzaXplIHx8IHUt
Pm5saW1icyAhPSB3c2l6ZSB8fCB2LT5ubGltYnMgIT0gd3NpemUpCisJCWxvZ19idWcoImFkZG1f
NDQ4OiBkaWZmZXJlbnQgc2l6ZXNcbiIpOworCisJbWVtc2V0KG4sIDAsIHNpemVvZihuKSk7CisJ
dXAgPSB1LT5kOworCXZwID0gdi0+ZDsKKwl3cCA9IHctPmQ7CisKKwljeSA9IG1waWhlbHBfYWRk
X24od3AsIHVwLCB2cCwgd3NpemUpOworCW1waWhfc2V0X2NvbmQobiwgY3R4LT5wLT5kLCB3c2l6
ZSwgKGN5ICE9IDBVTCkpOworCW1waWhlbHBfc3ViX24od3AsIHdwLCBuLCB3c2l6ZSk7Cit9CisK
K3N0YXRpYyB2b2lkIGVjX3N1Ym1fNDQ4KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlf
ZWNfY3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJbXBpX3NpemVfdCB3c2l6
ZSA9IExJTUJfU0laRV80NDg7CisJbXBpX2xpbWJfdCBuW0xJTUJfU0laRV80NDhdOworCW1waV9s
aW1iX3QgYm9ycm93OworCisJaWYgKHctPm5saW1icyAhPSB3c2l6ZSB8fCB1LT5ubGltYnMgIT0g
d3NpemUgfHwgdi0+bmxpbWJzICE9IHdzaXplKQorCQlsb2dfYnVnKCJzdWJtXzQ0ODogZGlmZmVy
ZW50IHNpemVzXG4iKTsKKworCW1lbXNldChuLCAwLCBzaXplb2YobikpOworCXVwID0gdS0+ZDsK
Kwl2cCA9IHYtPmQ7CisJd3AgPSB3LT5kOworCisJYm9ycm93ID0gbXBpaGVscF9zdWJfbih3cCwg
dXAsIHZwLCB3c2l6ZSk7CisJbXBpaF9zZXRfY29uZChuLCBjdHgtPnAtPmQsIHdzaXplLCAoYm9y
cm93ICE9IDBVTCkpOworCW1waWhlbHBfYWRkX24od3AsIHdwLCBuLCB3c2l6ZSk7Cit9CisKK3N0
YXRpYyB2b2lkIGVjX211bG1fNDQ4KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlfZWNf
Y3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJbXBpX3NpemVfdCB3c2l6ZSA9
IExJTUJfU0laRV80NDg7CisJbXBpX2xpbWJfdCBuW0xJTUJfU0laRV80NDgqMl07CisJbXBpX2xp
bWJfdCBhMltMSU1CX1NJWkVfSEFMRl80NDhdOworCW1waV9saW1iX3QgYTNbTElNQl9TSVpFX0hB
TEZfNDQ4XTsKKwltcGlfbGltYl90IGIwW0xJTUJfU0laRV9IQUxGXzQ0OF07CisJbXBpX2xpbWJf
dCBiMVtMSU1CX1NJWkVfSEFMRl80NDhdOworCW1waV9saW1iX3QgY3k7CisJaW50IGk7CisjaWYg
KExJTUJfU0laRV9IQUxGXzQ0OCA+IExJTUJfU0laRV80NDgvMikKKwltcGlfbGltYl90IGIxX3Jl
c3QsIGEzX3Jlc3Q7CisjZW5kaWYKKworCWlmICh3LT5ubGltYnMgIT0gd3NpemUgfHwgdS0+bmxp
bWJzICE9IHdzaXplIHx8IHYtPm5saW1icyAhPSB3c2l6ZSkKKwkJbG9nX2J1ZygibXVsbV80NDg6
IGRpZmZlcmVudCBzaXplc1xuIik7CisKKwl1cCA9IHUtPmQ7CisJdnAgPSB2LT5kOworCXdwID0g
dy0+ZDsKKworCW1waWhlbHBfbXVsX24obiwgdXAsIHZwLCB3c2l6ZSk7CisKKwlmb3IgKGkgPSAw
OyBpIDwgKHdzaXplICsgMSkgLyAyOyBpKyspIHsKKwkJYjBbaV0gPSBuW2ldOworCQliMVtpXSA9
IG5baSt3c2l6ZS8yXTsKKwkJYTJbaV0gPSBuW2krd3NpemVdOworCQlhM1tpXSA9IG5baSt3c2l6
ZSt3c2l6ZS8yXTsKKwl9CisKKyNpZiAoTElNQl9TSVpFX0hBTEZfNDQ4ID4gTElNQl9TSVpFXzQ0
OC8yKQorCWIwW0xJTUJfU0laRV9IQUxGXzQ0OC0xXSAmPSAoKG1waV9saW1iX3QpMVVMIDw8IDMy
KS0xOworCWEyW0xJTUJfU0laRV9IQUxGXzQ0OC0xXSAmPSAoKG1waV9saW1iX3QpMVVMIDw8IDMy
KS0xOworCisJYjFfcmVzdCA9IDA7CisJYTNfcmVzdCA9IDA7CisKKwlmb3IgKGkgPSAod3NpemUg
KyAxKSAvIDIgLSAxOyBpID49IDA7IGktLSkgeworCQltcGlfbGltYl90IGIxdiwgYTN2OworCQli
MXYgPSBiMVtpXTsKKwkJYTN2ID0gYTNbaV07CisJCWIxW2ldID0gKGIxX3Jlc3QgPDwgMzIpIHwg
KGIxdiA+PiAzMik7CisJCWEzW2ldID0gKGEzX3Jlc3QgPDwgMzIpIHwgKGEzdiA+PiAzMik7CisJ
CWIxX3Jlc3QgPSBiMXYgJiAoKChtcGlfbGltYl90KTFVTCA8PCAzMiktMSk7CisJCWEzX3Jlc3Qg
PSBhM3YgJiAoKChtcGlfbGltYl90KTFVTCA8PCAzMiktMSk7CisJfQorI2VuZGlmCisKKwljeSA9
IG1waWhlbHBfYWRkX24oYjAsIGIwLCBhMiwgTElNQl9TSVpFX0hBTEZfNDQ4KTsKKwljeSArPSBt
cGloZWxwX2FkZF9uKGIwLCBiMCwgYTMsIExJTUJfU0laRV9IQUxGXzQ0OCk7CisJZm9yIChpID0g
MDsgaSA8ICh3c2l6ZSArIDEpIC8gMjsgaSsrKQorCQl3cFtpXSA9IGIwW2ldOworI2lmIChMSU1C
X1NJWkVfSEFMRl80NDggPiBMSU1CX1NJWkVfNDQ4LzIpCisJd3BbTElNQl9TSVpFX0hBTEZfNDQ4
LTFdICY9ICgoKG1waV9saW1iX3QpMVVMIDw8IDMyKS0xKTsKKyNlbmRpZgorCisjaWYgKExJTUJf
U0laRV9IQUxGXzQ0OCA+IExJTUJfU0laRV80NDgvMikKKwljeSA9IGIwW0xJTUJfU0laRV9IQUxG
XzQ0OC0xXSA+PiAzMjsKKyNlbmRpZgorCisJY3kgPSBtcGloZWxwX2FkZF8xKGIxLCBiMSwgTElN
Ql9TSVpFX0hBTEZfNDQ4LCBjeSk7CisJY3kgKz0gbXBpaGVscF9hZGRfbihiMSwgYjEsIGEyLCBM
SU1CX1NJWkVfSEFMRl80NDgpOworCWN5ICs9IG1waWhlbHBfYWRkX24oYjEsIGIxLCBhMywgTElN
Ql9TSVpFX0hBTEZfNDQ4KTsKKwljeSArPSBtcGloZWxwX2FkZF9uKGIxLCBiMSwgYTMsIExJTUJf
U0laRV9IQUxGXzQ0OCk7CisjaWYgKExJTUJfU0laRV9IQUxGXzQ0OCA+IExJTUJfU0laRV80NDgv
MikKKwliMV9yZXN0ID0gMDsKKwlmb3IgKGkgPSAod3NpemUgKyAxKSAvIDIgLSAxOyBpID49IDA7
IGktLSkgeworCQltcGlfbGltYl90IGIxdiA9IGIxW2ldOworCQliMVtpXSA9IChiMV9yZXN0IDw8
IDMyKSB8IChiMXYgPj4gMzIpOworCQliMV9yZXN0ID0gYjF2ICYgKCgobXBpX2xpbWJfdCkxVUwg
PDwgMzIpLTEpOworCX0KKwl3cFtMSU1CX1NJWkVfSEFMRl80NDgtMV0gfD0gKGIxX3Jlc3QgPDwg
MzIpOworI2VuZGlmCisJZm9yIChpID0gMDsgaSA8IHdzaXplIC8gMjsgaSsrKQorCQl3cFtpKyh3
c2l6ZSArIDEpIC8gMl0gPSBiMVtpXTsKKworI2lmIChMSU1CX1NJWkVfSEFMRl80NDggPiBMSU1C
X1NJWkVfNDQ4LzIpCisJY3kgPSBiMVtMSU1CX1NJWkVfSEFMRl80NDgtMV07CisjZW5kaWYKKwor
CW1lbXNldChuLCAwLCB3c2l6ZSAqIEJZVEVTX1BFUl9NUElfTElNQik7CisKKyNpZiAoTElNQl9T
SVpFX0hBTEZfNDQ4ID4gTElNQl9TSVpFXzQ0OC8yKQorCW5bTElNQl9TSVpFX0hBTEZfNDQ4LTFd
ID0gY3kgPDwgMzI7CisjZWxzZQorCW5bTElNQl9TSVpFX0hBTEZfNDQ4XSA9IGN5OworI2VuZGlm
CisJblswXSA9IGN5OworCW1waWhlbHBfYWRkX24od3AsIHdwLCBuLCB3c2l6ZSk7CisKKwltZW1z
ZXQobiwgMCwgd3NpemUgKiBCWVRFU19QRVJfTVBJX0xJTUIpOworCWN5ID0gbXBpaGVscF9zdWJf
bih3cCwgd3AsIGN0eC0+cC0+ZCwgd3NpemUpOworCW1waWhfc2V0X2NvbmQobiwgY3R4LT5wLT5k
LCB3c2l6ZSwgKGN5ICE9IDBVTCkpOworCW1waWhlbHBfYWRkX24od3AsIHdwLCBuLCB3c2l6ZSk7
Cit9CisKK3N0YXRpYyB2b2lkIGVjX211bDJfNDQ4KE1QSSB3LCBNUEkgdSwgc3RydWN0IG1waV9l
Y19jdHggKmN0eCkKK3sKKwllY19hZGRtXzQ0OCh3LCB1LCB1LCBjdHgpOworfQorCitzdGF0aWMg
dm9pZCBlY19wb3cyXzQ0OChNUEkgdywgY29uc3QgTVBJIGIsIHN0cnVjdCBtcGlfZWNfY3R4ICpj
dHgpCit7CisJZWNfbXVsbV80NDgodywgYiwgYiwgY3R4KTsKK30KKworc3RydWN0IGZpZWxkX3Rh
YmxlIHsKKwljb25zdCBjaGFyICpwOworCisJLyogY29tcHV0YXRpb24gcm91dGluZXMgZm9yIHRo
ZSBmaWVsZC4gICovCisJdm9pZCAoKmFkZG0pKE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBt
cGlfZWNfY3R4ICpjdHgpOworCXZvaWQgKCpzdWJtKShNUEkgdywgTVBJIHUsIE1QSSB2LCBzdHJ1
Y3QgbXBpX2VjX2N0eCAqY3R4KTsKKwl2b2lkICgqbXVsbSkoTVBJIHcsIE1QSSB1LCBNUEkgdiwg
c3RydWN0IG1waV9lY19jdHggKmN0eCk7CisJdm9pZCAoKm11bDIpKE1QSSB3LCBNUEkgdSwgc3Ry
dWN0IG1waV9lY19jdHggKmN0eCk7CisJdm9pZCAoKnBvdzIpKE1QSSB3LCBjb25zdCBNUEkgYiwg
c3RydWN0IG1waV9lY19jdHggKmN0eCk7Cit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGZpZWxk
X3RhYmxlIGZpZWxkX3RhYmxlW10gPSB7CisJeworCQkiMHg3RkZGRkZGRkZGRkZGRkZGRkZGRkZG
RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkVEIiwKKwkJZWNfYWRkbV8y
NTUxOSwKKwkJZWNfc3VibV8yNTUxOSwKKwkJZWNfbXVsbV8yNTUxOSwKKwkJZWNfbXVsMl8yNTUx
OSwKKwkJZWNfcG93Ml8yNTUxOQorCX0sCisJeworCQkiMHhGRkZGRkZGRkZGRkZGRkZGRkZGRkZG
RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRSIKKwkJIkZGRkZGRkZGRkZGRkZGRkZG
RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGIiwKKwkJZWNfYWRkbV80NDgs
CisJCWVjX3N1Ym1fNDQ4LAorCQllY19tdWxtXzQ0OCwKKwkJZWNfbXVsMl80NDgsCisJCWVjX3Bv
dzJfNDQ4CisJfSwKKwl7IE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwgfSwKK307
CisKKy8qIEZvcmNlIHJlY29tcHV0YXRpb24gb2YgYWxsIGhlbHBlciB2YXJpYWJsZXMuICAqLwor
dm9pZCBtcGlfZWNfZ2V0X3Jlc2V0KHN0cnVjdCBtcGlfZWNfY3R4ICplYykKK3sKKwllYy0+dC52
YWxpZC5hX2lzX3BtaW51czMgPSAwOworCWVjLT50LnZhbGlkLnR3b19pbnZfcCA9IDA7Cit9CisK
Ky8qIEFjY2Vzc29yIGZvciBoZWxwZXIgdmFyaWFibGUuICAqLworc3RhdGljIGludCBlY19nZXRf
YV9pc19wbWludXMzKHN0cnVjdCBtcGlfZWNfY3R4ICplYykKK3sKKwlNUEkgdG1wOworCisJaWYg
KCFlYy0+dC52YWxpZC5hX2lzX3BtaW51czMpIHsKKwkJZWMtPnQudmFsaWQuYV9pc19wbWludXMz
ID0gMTsKKwkJdG1wID0gbXBpX2FsbG9jX2xpa2UoZWMtPnApOworCQltcGlfc3ViX3VpKHRtcCwg
ZWMtPnAsIDMpOworCQllYy0+dC5hX2lzX3BtaW51czMgPSAhbXBpX2NtcChlYy0+YSwgdG1wKTsK
KwkJbXBpX2ZyZWUodG1wKTsKKwl9CisKKwlyZXR1cm4gZWMtPnQuYV9pc19wbWludXMzOworfQor
CisvKiBBY2Nlc3NvciBmb3IgaGVscGVyIHZhcmlhYmxlLiAgKi8KK3N0YXRpYyBNUEkgZWNfZ2V0
X3R3b19pbnZfcChzdHJ1Y3QgbXBpX2VjX2N0eCAqZWMpCit7CisJaWYgKCFlYy0+dC52YWxpZC50
d29faW52X3ApIHsKKwkJZWMtPnQudmFsaWQudHdvX2ludl9wID0gMTsKKwkJaWYgKCFlYy0+dC50
d29faW52X3ApCisJCQllYy0+dC50d29faW52X3AgPSBtcGlfYWxsb2MoMCk7CisJCWVjX2ludm0o
ZWMtPnQudHdvX2ludl9wLCBtcGlfY29uc3QoTVBJX0NfVFdPKSwgZWMpOworCX0KKwlyZXR1cm4g
ZWMtPnQudHdvX2ludl9wOworfQorCitzdGF0aWMgY29uc3QgY2hhciAqY29uc3QgY3VydmUyNTUx
OV9iYWRfcG9pbnRzW10gPSB7CisJIjB4N2ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlZCIsCisJIjB4MDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCIsCisJIjB4MDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMSIsCisJIjB4MDBiODQ5NWYxNjA1NjI4NmZkYjEzMjljZWI4ZDA5ZGE2YWM0OWZmMWZhZTM1
NjE2YWViODQxM2I3YzdhZWJlMCIsCisJIjB4NTcxMTlmZDBkZDRlMjJkODg2OGUxYzU4YzQ1YzQ0
MDQ1YmVmODM5YzU1YjFkMGIxMjQ4YzUwYTNiYzk1OWM1ZiIsCisJIjB4N2ZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZlYyIsCisJIjB4
N2ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZlZSIsCisJTlVMTAorfTsKKworc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGN1cnZlNDQ4
X2JhZF9wb2ludHNbXSA9IHsKKwkiMHhmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZSIKKwkiZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmYiLAorCSIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwIgorCSIwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCIsCisJIjB4MDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiCisJIjAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAxIiwKKwkiMHhm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZSIK
KwkiZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmUiLAorCSIweGZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmIgorCSIwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMCIsCisJTlVMTAorfTsKKworc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0ICpi
YWRfcG9pbnRzX3RhYmxlW10gPSB7CisJY3VydmUyNTUxOV9iYWRfcG9pbnRzLAorCWN1cnZlNDQ4
X2JhZF9wb2ludHMsCit9OworCitzdGF0aWMgdm9pZCBtcGlfZWNfY29lZmZpY2llbnRfbm9ybWFs
aXplKE1QSSBhLCBNUEkgcCkKK3sKKwlpZiAoYS0+c2lnbikgeworCQltcGlfcmVzaXplKGEsIHAt
Pm5saW1icyk7CisJCW1waWhlbHBfc3ViX24oYS0+ZCwgcC0+ZCwgYS0+ZCwgcC0+bmxpbWJzKTsK
KwkJYS0+bmxpbWJzID0gcC0+bmxpbWJzOworCQlhLT5zaWduID0gMDsKKwl9Cit9CisKKy8qIFRo
aXMgZnVuY3Rpb24gaW5pdGlhbGl6ZWQgYSBjb250ZXh0IGZvciBlbGxpcHRpYyBjdXJ2ZSBiYXNl
ZCBvbiB0aGUKKyAqIGZpZWxkIEdGKHApLiAgUCBpcyB0aGUgcHJpbWUgc3BlY2lmeWluZyB0aGlz
IGZpZWxkLCBBIGlzIHRoZSBmaXJzdAorICogY29lZmZpY2llbnQuICBDVFggaXMgZXhwZWN0ZWQg
dG8gYmUgemVyb2l6ZWQuCisgKi8KK3ZvaWQgbXBpX2VjX2luaXQoc3RydWN0IG1waV9lY19jdHgg
KmN0eCwgZW51bSBnY3J5X21waV9lY19tb2RlbHMgbW9kZWwsCisJCQllbnVtIGVjY19kaWFsZWN0
cyBkaWFsZWN0LAorCQkJaW50IGZsYWdzLCBNUEkgcCwgTVBJIGEsIE1QSSBiKQoreworCWludCBp
OworCXN0YXRpYyBpbnQgdXNlX2JhcnJldHQgPSAtMSAvKiBUT0RPOiAxIG9yIC0xICovOworCisJ
bXBpX2VjX2NvZWZmaWNpZW50X25vcm1hbGl6ZShhLCBwKTsKKwltcGlfZWNfY29lZmZpY2llbnRf
bm9ybWFsaXplKGIsIHApOworCisJLyogRml4bWU6IERvIHdlIHdhbnQgdG8gY2hlY2sgc29tZSBj
b25zdHJhaW50cz8gZS5nLiAgYSA8IHAgICovCisKKwljdHgtPm1vZGVsID0gbW9kZWw7CisJY3R4
LT5kaWFsZWN0ID0gZGlhbGVjdDsKKwljdHgtPmZsYWdzID0gZmxhZ3M7CisJaWYgKGRpYWxlY3Qg
PT0gRUNDX0RJQUxFQ1RfRUQyNTUxOSkKKwkJY3R4LT5uYml0cyA9IDI1NjsKKwllbHNlCisJCWN0
eC0+bmJpdHMgPSBtcGlfZ2V0X25iaXRzKHApOworCWN0eC0+cCA9IG1waV9jb3B5KHApOworCWN0
eC0+YSA9IG1waV9jb3B5KGEpOworCWN0eC0+YiA9IG1waV9jb3B5KGIpOworCisJY3R4LT50LnBf
YmFycmV0dCA9IHVzZV9iYXJyZXR0ID4gMCA/IG1waV9iYXJyZXR0X2luaXQoY3R4LT5wLCAwKSA6
IE5VTEw7CisKKwltcGlfZWNfZ2V0X3Jlc2V0KGN0eCk7CisKKwlpZiAobW9kZWwgPT0gTVBJX0VD
X01PTlRHT01FUlkpIHsKKwkJZm9yIChpID0gMDsgaSA8IERJTShiYWRfcG9pbnRzX3RhYmxlKTsg
aSsrKSB7CisJCQlNUEkgcF9jYW5kaWRhdGUgPSBtcGlfc2NhbnZhbChiYWRfcG9pbnRzX3RhYmxl
W2ldWzBdKTsKKwkJCWludCBtYXRjaF9wID0gIW1waV9jbXAoY3R4LT5wLCBwX2NhbmRpZGF0ZSk7
CisJCQlpbnQgajsKKworCQkJbXBpX2ZyZWUocF9jYW5kaWRhdGUpOworCQkJaWYgKCFtYXRjaF9w
KQorCQkJCWNvbnRpbnVlOworCisJCQlmb3IgKGogPSAwOyBpIDwgRElNKGN0eC0+dC5zY3JhdGNo
KSAmJiBiYWRfcG9pbnRzX3RhYmxlW2ldW2pdOyBqKyspCisJCQkJY3R4LT50LnNjcmF0Y2hbal0g
PSBtcGlfc2NhbnZhbChiYWRfcG9pbnRzX3RhYmxlW2ldW2pdKTsKKwkJfQorCX0gZWxzZSB7CisJ
CS8qIEFsbG9jYXRlIHNjcmF0Y2ggdmFyaWFibGVzLiAgKi8KKwkJZm9yIChpID0gMDsgaSA8IERJ
TShjdHgtPnQuc2NyYXRjaCk7IGkrKykKKwkJCWN0eC0+dC5zY3JhdGNoW2ldID0gbXBpX2FsbG9j
X2xpa2UoY3R4LT5wKTsKKwl9CisKKwljdHgtPmFkZG0gPSBlY19hZGRtOworCWN0eC0+c3VibSA9
IGVjX3N1Ym07CisJY3R4LT5tdWxtID0gZWNfbXVsbTsKKwljdHgtPm11bDIgPSBlY19tdWwyOwor
CWN0eC0+cG93MiA9IGVjX3BvdzI7CisKKwlmb3IgKGkgPSAwOyBmaWVsZF90YWJsZVtpXS5wOyBp
KyspIHsKKwkJTVBJIGZfcDsKKworCQlmX3AgPSBtcGlfc2NhbnZhbChmaWVsZF90YWJsZVtpXS5w
KTsKKwkJaWYgKCFmX3ApCisJCQlicmVhazsKKworCQlpZiAoIW1waV9jbXAocCwgZl9wKSkgewor
CQkJY3R4LT5hZGRtID0gZmllbGRfdGFibGVbaV0uYWRkbTsKKwkJCWN0eC0+c3VibSA9IGZpZWxk
X3RhYmxlW2ldLnN1Ym07CisJCQljdHgtPm11bG0gPSBmaWVsZF90YWJsZVtpXS5tdWxtOworCQkJ
Y3R4LT5tdWwyID0gZmllbGRfdGFibGVbaV0ubXVsMjsKKwkJCWN0eC0+cG93MiA9IGZpZWxkX3Rh
YmxlW2ldLnBvdzI7CisJCQltcGlfZnJlZShmX3ApOworCisJCQltcGlfcmVzaXplKGN0eC0+YSwg
Y3R4LT5wLT5ubGltYnMpOworCQkJY3R4LT5hLT5ubGltYnMgPSBjdHgtPnAtPm5saW1iczsKKwor
CQkJbXBpX3Jlc2l6ZShjdHgtPmIsIGN0eC0+cC0+bmxpbWJzKTsKKwkJCWN0eC0+Yi0+bmxpbWJz
ID0gY3R4LT5wLT5ubGltYnM7CisKKwkJCWZvciAoaSA9IDA7IGkgPCBESU0oY3R4LT50LnNjcmF0
Y2gpICYmIGN0eC0+dC5zY3JhdGNoW2ldOyBpKyspCisJCQkJY3R4LT50LnNjcmF0Y2hbaV0tPm5s
aW1icyA9IGN0eC0+cC0+bmxpbWJzOworCisJCQlicmVhazsKKwkJfQorCisJCW1waV9mcmVlKGZf
cCk7CisJfQorfQorRVhQT1JUX1NZTUJPTF9HUEwobXBpX2VjX2luaXQpOworCit2b2lkIG1waV9l
Y19kZWluaXQoc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwlpbnQgaTsKKworCW1waV9iYXJy
ZXR0X2ZyZWUoY3R4LT50LnBfYmFycmV0dCk7CisKKwkvKiBEb21haW4gcGFyYW1ldGVyLiAgKi8K
KwltcGlfZnJlZShjdHgtPnApOworCW1waV9mcmVlKGN0eC0+YSk7CisJbXBpX2ZyZWUoY3R4LT5i
KTsKKwltcGlfcG9pbnRfcmVsZWFzZShjdHgtPkcpOworCW1waV9mcmVlKGN0eC0+bik7CisKKwkv
KiBUaGUga2V5LiAgKi8KKwltcGlfcG9pbnRfcmVsZWFzZShjdHgtPlEpOworCW1waV9mcmVlKGN0
eC0+ZCk7CisKKwkvKiBQcml2YXRlIGRhdGEgb2YgZWMuYy4gICovCisJbXBpX2ZyZWUoY3R4LT50
LnR3b19pbnZfcCk7CisKKwlmb3IgKGkgPSAwOyBpIDwgRElNKGN0eC0+dC5zY3JhdGNoKTsgaSsr
KQorCQltcGlfZnJlZShjdHgtPnQuc2NyYXRjaFtpXSk7Cit9CitFWFBPUlRfU1lNQk9MX0dQTCht
cGlfZWNfZGVpbml0KTsKKworCisvKiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgYSBuZXcgY29udGV4
dCBmb3IgZWxsaXB0aWMgY3VydmUgYmFzZWQgb24gdGhlCisgKiBmaWVsZCBHRihwKS4gIFAgaXMg
dGhlIHByaW1lIHNwZWNpZnlpbmcgdGhpcyBmaWVsZCwgQSBpcyB0aGUgZmlyc3QKKyAqIGNvZWZm
aWNpZW50LCBCIGlzIHRoZSBzZWNvbmQgY29lZmZpY2llbnQsIGFuZCBNT0RFTCBpcyB0aGUgbW9k
ZWwKKyAqIGZvciB0aGUgY3VydmUuICBUaGlzIGZ1bmN0aW9uIGlzIG9ubHkgdXNlZCB3aXRoaW4g
TGliZ2NyeXB0IGFuZCBub3QKKyAqIHBhcnQgb2YgdGhlIHB1YmxpYyBBUEkuCisgKgorICogVGhp
cyBjb250ZXh0IG5lZWRzIHRvIGJlIHJlbGVhc2VkIHVzaW5nIG1waV9lY19mcmVlLgorICovCitz
dHJ1Y3QgbXBpX2VjX2N0eCAqbXBpX2VjX25ldyhlbnVtIGdjcnlfbXBpX2VjX21vZGVscyBtb2Rl
bCwKKwkJZW51bSBlY2NfZGlhbGVjdHMgZGlhbGVjdCwgaW50IGZsYWdzLAorCQlNUEkgcCwgTVBJ
IGEsIE1QSSBiKQoreworCXN0cnVjdCBtcGlfZWNfY3R4ICpjdHg7CisKKwljdHggPSBrY2FsbG9j
KDEsIHNpemVvZigqY3R4KSwgR0ZQX0tFUk5FTCk7CisJaWYgKGN0eCkKKwkJbXBpX2VjX2luaXQo
Y3R4LCBtb2RlbCwgZGlhbGVjdCwgZmxhZ3MsIHAsIGEsIGIpOworCisJcmV0dXJuIGN0eDsKK30K
Kwordm9pZCBtcGlfZWNfZnJlZShzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCWlmIChjdHgp
IHsKKwkJbXBpX2VjX2RlaW5pdChjdHgpOworCQlrZnJlZShjdHgpOworCX0KK30KKworLyogQ29t
cHV0ZSB0aGUgYWZmaW5lIGNvb3JkaW5hdGVzIGZyb20gdGhlIHByb2plY3RpdmUgY29vcmRpbmF0
ZXMgaW4KKyAqIFBPSU5ULiAgU2V0IHRoZW0gaW50byBYIGFuZCBZLiAgSWYgb25lIGNvb3JkaW5h
dGUgaXMgbm90IHJlcXVpcmVkLAorICogWCBvciBZIG1heSBiZSBwYXNzZWQgYXMgTlVMTC4gIENU
WCBpcyB0aGUgdXN1YWwgY29udGV4dC4gUmV0dXJuczogMAorICogb24gc3VjY2VzcyBvciAhMCBp
ZiBQT0lOVCBpcyBhdCBpbmZpbml0eS4KKyAqLworaW50IG1waV9lY19nZXRfYWZmaW5lKE1QSSB4
LCBNUEkgeSwgTVBJX1BPSU5UIHBvaW50LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCWlm
ICghbXBpX2NtcF91aShwb2ludC0+eiwgMCkpCisJCXJldHVybiAtMTsKKworCXN3aXRjaCAoY3R4
LT5tb2RlbCkgeworCWNhc2UgTVBJX0VDX1dFSUVSU1RSQVNTOiAvKiBVc2luZyBKYWNvYmlhbiBj
b29yZGluYXRlcy4gICovCisJCXsKKwkJCU1QSSB6MSwgejIsIHozOworCisJCQl6MSA9IG1waV9u
ZXcoMCk7CisJCQl6MiA9IG1waV9uZXcoMCk7CisJCQllY19pbnZtKHoxLCBwb2ludC0+eiwgY3R4
KTsgIC8qIHoxID0gel4oLTEpIG1vZCBwICAqLworCQkJZWNfbXVsbSh6MiwgejEsIHoxLCBjdHgp
OyAgICAvKiB6MiA9IHpeKC0yKSBtb2QgcCAgKi8KKworCQkJaWYgKHgpCisJCQkJZWNfbXVsbSh4
LCBwb2ludC0+eCwgejIsIGN0eCk7CisKKwkJCWlmICh5KSB7CisJCQkJejMgPSBtcGlfbmV3KDAp
OworCQkJCWVjX211bG0oejMsIHoyLCB6MSwgY3R4KTsgICAgICAvKiB6MyA9IHpeKC0zKSBtb2Qg
cCAqLworCQkJCWVjX211bG0oeSwgcG9pbnQtPnksIHozLCBjdHgpOworCQkJCW1waV9mcmVlKHoz
KTsKKwkJCX0KKworCQkJbXBpX2ZyZWUoejIpOworCQkJbXBpX2ZyZWUoejEpOworCQl9CisJCXJl
dHVybiAwOworCisJY2FzZSBNUElfRUNfTU9OVEdPTUVSWToKKwkJeworCQkJaWYgKHgpCisJCQkJ
bXBpX3NldCh4LCBwb2ludC0+eCk7CisKKwkJCWlmICh5KSB7CisJCQkJbG9nX2ZhdGFsKCIlczog
R2V0dGluZyBZLWNvb3JkaW5hdGUgb24gJXMgaXMgbm90IHN1cHBvcnRlZFxuIiwKKwkJCQkJCSJt
cGlfZWNfZ2V0X2FmZmluZSIsICJNb250Z29tZXJ5Iik7CisJCQkJcmV0dXJuIC0xOworCQkJfQor
CQl9CisJCXJldHVybiAwOworCisJY2FzZSBNUElfRUNfRURXQVJEUzoKKwkJeworCQkJTVBJIHo7
CisKKwkJCXogPSBtcGlfbmV3KDApOworCQkJZWNfaW52bSh6LCBwb2ludC0+eiwgY3R4KTsKKwor
CQkJbXBpX3Jlc2l6ZSh6LCBjdHgtPnAtPm5saW1icyk7CisJCQl6LT5ubGltYnMgPSBjdHgtPnAt
Pm5saW1iczsKKworCQkJaWYgKHgpIHsKKwkJCQltcGlfcmVzaXplKHgsIGN0eC0+cC0+bmxpbWJz
KTsKKwkJCQl4LT5ubGltYnMgPSBjdHgtPnAtPm5saW1iczsKKwkJCQljdHgtPm11bG0oeCwgcG9p
bnQtPngsIHosIGN0eCk7CisJCQl9CisJCQlpZiAoeSkgeworCQkJCW1waV9yZXNpemUoeSwgY3R4
LT5wLT5ubGltYnMpOworCQkJCXktPm5saW1icyA9IGN0eC0+cC0+bmxpbWJzOworCQkJCWN0eC0+
bXVsbSh5LCBwb2ludC0+eSwgeiwgY3R4KTsKKwkJCX0KKworCQkJbXBpX2ZyZWUoeik7CisJCX0K
KwkJcmV0dXJuIDA7CisKKwlkZWZhdWx0OgorCQlyZXR1cm4gLTE7CisJfQorfQorRVhQT1JUX1NZ
TUJPTF9HUEwobXBpX2VjX2dldF9hZmZpbmUpOworCisvKiAgUkVTVUxUID0gMiAqIFBPSU5UICAo
V2VpZXJzdHJhc3MgdmVyc2lvbikuICovCitzdGF0aWMgdm9pZCBkdXBfcG9pbnRfd2VpZXJzdHJh
c3MoTVBJX1BPSU5UIHJlc3VsdCwKKwkJTVBJX1BPSU5UIHBvaW50LCBzdHJ1Y3QgbXBpX2VjX2N0
eCAqY3R4KQoreworI2RlZmluZSB4MyAocmVzdWx0LT54KQorI2RlZmluZSB5MyAocmVzdWx0LT55
KQorI2RlZmluZSB6MyAocmVzdWx0LT56KQorI2RlZmluZSB0MSAoY3R4LT50LnNjcmF0Y2hbMF0p
CisjZGVmaW5lIHQyIChjdHgtPnQuc2NyYXRjaFsxXSkKKyNkZWZpbmUgdDMgKGN0eC0+dC5zY3Jh
dGNoWzJdKQorI2RlZmluZSBsMSAoY3R4LT50LnNjcmF0Y2hbM10pCisjZGVmaW5lIGwyIChjdHgt
PnQuc2NyYXRjaFs0XSkKKyNkZWZpbmUgbDMgKGN0eC0+dC5zY3JhdGNoWzVdKQorCisJaWYgKCFt
cGlfY21wX3VpKHBvaW50LT55LCAwKSB8fCAhbXBpX2NtcF91aShwb2ludC0+eiwgMCkpIHsKKwkJ
LyogUF95ID09IDAgfHwgUF96ID09IDAgPT4gWzE6MTowXSAqLworCQltcGlfc2V0X3VpKHgzLCAx
KTsKKwkJbXBpX3NldF91aSh5MywgMSk7CisJCW1waV9zZXRfdWkoejMsIDApOworCX0gZWxzZSB7
CisJCWlmIChlY19nZXRfYV9pc19wbWludXMzKGN0eCkpIHsKKwkJCS8qIFVzZSB0aGUgZmFzdGVy
IGNhc2UuICAqLworCQkJLyogTDEgPSAzKFggLSBaXjIpKFggKyBaXjIpICovCisJCQkvKiAgICAg
ICAgICAgICAgICAgICAgICAgICAgVDE6IHVzZWQgZm9yIFpeMi4gKi8KKwkJCS8qICAgICAgICAg
ICAgICAgICAgICAgICAgICBUMjogdXNlZCBmb3IgdGhlIHJpZ2h0IHRlcm0uICovCisJCQllY19w
b3cyKHQxLCBwb2ludC0+eiwgY3R4KTsKKwkJCWVjX3N1Ym0obDEsIHBvaW50LT54LCB0MSwgY3R4
KTsKKwkJCWVjX211bG0obDEsIGwxLCBtcGlfY29uc3QoTVBJX0NfVEhSRUUpLCBjdHgpOworCQkJ
ZWNfYWRkbSh0MiwgcG9pbnQtPngsIHQxLCBjdHgpOworCQkJZWNfbXVsbShsMSwgbDEsIHQyLCBj
dHgpOworCQl9IGVsc2UgeworCQkJLyogU3RhbmRhcmQgY2FzZS4gKi8KKwkJCS8qIEwxID0gM1he
MiArIGFaXjQgKi8KKwkJCS8qICAgICAgICAgICAgICAgICAgICAgICAgICBUMTogdXNlZCBmb3Ig
YVpeNC4gKi8KKwkJCWVjX3BvdzIobDEsIHBvaW50LT54LCBjdHgpOworCQkJZWNfbXVsbShsMSwg
bDEsIG1waV9jb25zdChNUElfQ19USFJFRSksIGN0eCk7CisJCQllY19wb3dtKHQxLCBwb2ludC0+
eiwgbXBpX2NvbnN0KE1QSV9DX0ZPVVIpLCBjdHgpOworCQkJZWNfbXVsbSh0MSwgdDEsIGN0eC0+
YSwgY3R4KTsKKwkJCWVjX2FkZG0obDEsIGwxLCB0MSwgY3R4KTsKKwkJfQorCQkvKiBaMyA9IDJZ
WiAqLworCQllY19tdWxtKHozLCBwb2ludC0+eSwgcG9pbnQtPnosIGN0eCk7CisJCWVjX211bDIo
ejMsIHozLCBjdHgpOworCisJCS8qIEwyID0gNFhZXjIgKi8KKwkJLyogICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBUMjogdXNlZCBmb3IgWTI7IHJlcXVpcmVkIGxhdGVyLiAqLworCQllY19w
b3cyKHQyLCBwb2ludC0+eSwgY3R4KTsKKwkJZWNfbXVsbShsMiwgdDIsIHBvaW50LT54LCBjdHgp
OworCQllY19tdWxtKGwyLCBsMiwgbXBpX2NvbnN0KE1QSV9DX0ZPVVIpLCBjdHgpOworCisJCS8q
IFgzID0gTDFeMiAtIDJMMiAqLworCQkvKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFQx
OiB1c2VkIGZvciBMMl4yLiAqLworCQllY19wb3cyKHgzLCBsMSwgY3R4KTsKKwkJZWNfbXVsMih0
MSwgbDIsIGN0eCk7CisJCWVjX3N1Ym0oeDMsIHgzLCB0MSwgY3R4KTsKKworCQkvKiBMMyA9IDhZ
XjQgKi8KKwkJLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUMjogdGFrZW4gZnJvbSBh
Ym92ZS4gKi8KKwkJZWNfcG93Mih0MiwgdDIsIGN0eCk7CisJCWVjX211bG0obDMsIHQyLCBtcGlf
Y29uc3QoTVBJX0NfRUlHSFQpLCBjdHgpOworCisJCS8qIFkzID0gTDEoTDIgLSBYMykgLSBMMyAq
LworCQllY19zdWJtKHkzLCBsMiwgeDMsIGN0eCk7CisJCWVjX211bG0oeTMsIHkzLCBsMSwgY3R4
KTsKKwkJZWNfc3VibSh5MywgeTMsIGwzLCBjdHgpOworCX0KKworI3VuZGVmIHgzCisjdW5kZWYg
eTMKKyN1bmRlZiB6MworI3VuZGVmIHQxCisjdW5kZWYgdDIKKyN1bmRlZiB0MworI3VuZGVmIGwx
CisjdW5kZWYgbDIKKyN1bmRlZiBsMworfQorCisvKiAgUkVTVUxUID0gMiAqIFBPSU5UICAoTW9u
dGdvbWVyeSB2ZXJzaW9uKS4gKi8KK3N0YXRpYyB2b2lkIGR1cF9wb2ludF9tb250Z29tZXJ5KE1Q
SV9QT0lOVCByZXN1bHQsCisJCQkJTVBJX1BPSU5UIHBvaW50LCBzdHJ1Y3QgbXBpX2VjX2N0eCAq
Y3R4KQoreworCSh2b2lkKXJlc3VsdDsKKwkodm9pZClwb2ludDsKKwkodm9pZCljdHg7CisJbG9n
X2ZhdGFsKCIlczogJXMgbm90IHlldCBzdXBwb3J0ZWRcbiIsCisJCQkibXBpX2VjX2R1cF9wb2lu
dCIsICJNb250Z29tZXJ5Iik7Cit9CisKKy8qICBSRVNVTFQgPSAyICogUE9JTlQgIChUd2lzdGVk
IEVkd2FyZHMgdmVyc2lvbikuICovCitzdGF0aWMgdm9pZCBkdXBfcG9pbnRfZWR3YXJkcyhNUElf
UE9JTlQgcmVzdWx0LAorCQlNUElfUE9JTlQgcG9pbnQsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgp
Cit7CisjZGVmaW5lIFgxIChwb2ludC0+eCkKKyNkZWZpbmUgWTEgKHBvaW50LT55KQorI2RlZmlu
ZSBaMSAocG9pbnQtPnopCisjZGVmaW5lIFgzIChyZXN1bHQtPngpCisjZGVmaW5lIFkzIChyZXN1
bHQtPnkpCisjZGVmaW5lIFozIChyZXN1bHQtPnopCisjZGVmaW5lIEIgKGN0eC0+dC5zY3JhdGNo
WzBdKQorI2RlZmluZSBDIChjdHgtPnQuc2NyYXRjaFsxXSkKKyNkZWZpbmUgRCAoY3R4LT50LnNj
cmF0Y2hbMl0pCisjZGVmaW5lIEUgKGN0eC0+dC5zY3JhdGNoWzNdKQorI2RlZmluZSBGIChjdHgt
PnQuc2NyYXRjaFs0XSkKKyNkZWZpbmUgSCAoY3R4LT50LnNjcmF0Y2hbNV0pCisjZGVmaW5lIEog
KGN0eC0+dC5zY3JhdGNoWzZdKQorCisJLyogQ29tcHV0ZTogKFhfMyA6IFlfMyA6IFpfMykgPSAy
KCBYXzEgOiBZXzEgOiBaXzEgKSAqLworCisJLyogQiA9IChYXzEgKyBZXzEpXjIgICovCisJY3R4
LT5hZGRtKEIsIFgxLCBZMSwgY3R4KTsKKwljdHgtPnBvdzIoQiwgQiwgY3R4KTsKKworCS8qIEMg
PSBYXzFeMiAqLworCS8qIEQgPSBZXzFeMiAqLworCWN0eC0+cG93MihDLCBYMSwgY3R4KTsKKwlj
dHgtPnBvdzIoRCwgWTEsIGN0eCk7CisKKwkvKiBFID0gYUMgKi8KKwlpZiAoY3R4LT5kaWFsZWN0
ID09IEVDQ19ESUFMRUNUX0VEMjU1MTkpCisJCWN0eC0+c3VibShFLCBjdHgtPnAsIEMsIGN0eCk7
CisJZWxzZQorCQljdHgtPm11bG0oRSwgY3R4LT5hLCBDLCBjdHgpOworCisJLyogRiA9IEUgKyBE
ICovCisJY3R4LT5hZGRtKEYsIEUsIEQsIGN0eCk7CisKKwkvKiBIID0gWl8xXjIgKi8KKwljdHgt
PnBvdzIoSCwgWjEsIGN0eCk7CisKKwkvKiBKID0gRiAtIDJIICovCisJY3R4LT5tdWwyKEosIEgs
IGN0eCk7CisJY3R4LT5zdWJtKEosIEYsIEosIGN0eCk7CisKKwkvKiBYXzMgPSAoQiAtIEMgLSBE
KSDCtyBKICovCisJY3R4LT5zdWJtKFgzLCBCLCBDLCBjdHgpOworCWN0eC0+c3VibShYMywgWDMs
IEQsIGN0eCk7CisJY3R4LT5tdWxtKFgzLCBYMywgSiwgY3R4KTsKKworCS8qIFlfMyA9IEYgwrcg
KEUgLSBEKSAqLworCWN0eC0+c3VibShZMywgRSwgRCwgY3R4KTsKKwljdHgtPm11bG0oWTMsIFkz
LCBGLCBjdHgpOworCisJLyogWl8zID0gRiDCtyBKICovCisJY3R4LT5tdWxtKFozLCBGLCBKLCBj
dHgpOworCisjdW5kZWYgWDEKKyN1bmRlZiBZMQorI3VuZGVmIFoxCisjdW5kZWYgWDMKKyN1bmRl
ZiBZMworI3VuZGVmIFozCisjdW5kZWYgQgorI3VuZGVmIEMKKyN1bmRlZiBECisjdW5kZWYgRQor
I3VuZGVmIEYKKyN1bmRlZiBICisjdW5kZWYgSgorfQorCisvKiAgUkVTVUxUID0gMiAqIFBPSU5U
ICAqLwordm9pZCBtcGlfZWNfZHVwX3BvaW50KE1QSV9QT0lOVCByZXN1bHQsIE1QSV9QT0lOVCBw
b2ludCwgc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwlzd2l0Y2ggKGN0eC0+bW9kZWwpIHsK
KwljYXNlIE1QSV9FQ19XRUlFUlNUUkFTUzoKKwkJZHVwX3BvaW50X3dlaWVyc3RyYXNzKHJlc3Vs
dCwgcG9pbnQsIGN0eCk7CisJCWJyZWFrOworCWNhc2UgTVBJX0VDX01PTlRHT01FUlk6CisJCWR1
cF9wb2ludF9tb250Z29tZXJ5KHJlc3VsdCwgcG9pbnQsIGN0eCk7CisJCWJyZWFrOworCWNhc2Ug
TVBJX0VDX0VEV0FSRFM6CisJCWR1cF9wb2ludF9lZHdhcmRzKHJlc3VsdCwgcG9pbnQsIGN0eCk7
CisJCWJyZWFrOworCX0KK30KKworLyogUkVTVUxUID0gUDEgKyBQMiAgKFdlaWVyc3RyYXNzIHZl
cnNpb24pLiovCitzdGF0aWMgdm9pZCBhZGRfcG9pbnRzX3dlaWVyc3RyYXNzKE1QSV9QT0lOVCBy
ZXN1bHQsCisJCU1QSV9QT0lOVCBwMSwgTVBJX1BPSU5UIHAyLAorCQlzdHJ1Y3QgbXBpX2VjX2N0
eCAqY3R4KQoreworI2RlZmluZSB4MSAocDEtPngpCisjZGVmaW5lIHkxIChwMS0+eSkKKyNkZWZp
bmUgejEgKHAxLT56KQorI2RlZmluZSB4MiAocDItPngpCisjZGVmaW5lIHkyIChwMi0+eSkKKyNk
ZWZpbmUgejIgKHAyLT56KQorI2RlZmluZSB4MyAocmVzdWx0LT54KQorI2RlZmluZSB5MyAocmVz
dWx0LT55KQorI2RlZmluZSB6MyAocmVzdWx0LT56KQorI2RlZmluZSBsMSAoY3R4LT50LnNjcmF0
Y2hbMF0pCisjZGVmaW5lIGwyIChjdHgtPnQuc2NyYXRjaFsxXSkKKyNkZWZpbmUgbDMgKGN0eC0+
dC5zY3JhdGNoWzJdKQorI2RlZmluZSBsNCAoY3R4LT50LnNjcmF0Y2hbM10pCisjZGVmaW5lIGw1
IChjdHgtPnQuc2NyYXRjaFs0XSkKKyNkZWZpbmUgbDYgKGN0eC0+dC5zY3JhdGNoWzVdKQorI2Rl
ZmluZSBsNyAoY3R4LT50LnNjcmF0Y2hbNl0pCisjZGVmaW5lIGw4IChjdHgtPnQuc2NyYXRjaFs3
XSkKKyNkZWZpbmUgbDkgKGN0eC0+dC5zY3JhdGNoWzhdKQorI2RlZmluZSB0MSAoY3R4LT50LnNj
cmF0Y2hbOV0pCisjZGVmaW5lIHQyIChjdHgtPnQuc2NyYXRjaFsxMF0pCisKKwlpZiAoKCFtcGlf
Y21wKHgxLCB4MikpICYmICghbXBpX2NtcCh5MSwgeTIpKSAmJiAoIW1waV9jbXAoejEsIHoyKSkp
IHsKKwkJLyogU2FtZSBwb2ludDsgbmVlZCB0byBjYWxsIHRoZSBkdXBsaWNhdGUgZnVuY3Rpb24u
ICAqLworCQltcGlfZWNfZHVwX3BvaW50KHJlc3VsdCwgcDEsIGN0eCk7CisJfSBlbHNlIGlmICgh
bXBpX2NtcF91aSh6MSwgMCkpIHsKKwkJLyogUDEgaXMgYXQgaW5maW5pdHkuICAqLworCQltcGlf
c2V0KHgzLCBwMi0+eCk7CisJCW1waV9zZXQoeTMsIHAyLT55KTsKKwkJbXBpX3NldCh6MywgcDIt
PnopOworCX0gZWxzZSBpZiAoIW1waV9jbXBfdWkoejIsIDApKSB7CisJCS8qIFAyIGlzIGF0IGlu
ZmluaXR5LiAgKi8KKwkJbXBpX3NldCh4MywgcDEtPngpOworCQltcGlfc2V0KHkzLCBwMS0+eSk7
CisJCW1waV9zZXQoejMsIHAxLT56KTsKKwl9IGVsc2UgeworCQlpbnQgejFfaXNfb25lID0gIW1w
aV9jbXBfdWkoejEsIDEpOworCQlpbnQgejJfaXNfb25lID0gIW1waV9jbXBfdWkoejIsIDEpOwor
CisJCS8qIGwxID0geDEgejJeMiAgKi8KKwkJLyogbDIgPSB4MiB6MV4yICAqLworCQlpZiAoejJf
aXNfb25lKQorCQkJbXBpX3NldChsMSwgeDEpOworCQllbHNlIHsKKwkJCWVjX3BvdzIobDEsIHoy
LCBjdHgpOworCQkJZWNfbXVsbShsMSwgbDEsIHgxLCBjdHgpOworCQl9CisJCWlmICh6MV9pc19v
bmUpCisJCQltcGlfc2V0KGwyLCB4Mik7CisJCWVsc2UgeworCQkJZWNfcG93MihsMiwgejEsIGN0
eCk7CisJCQllY19tdWxtKGwyLCBsMiwgeDIsIGN0eCk7CisJCX0KKwkJLyogbDMgPSBsMSAtIGwy
ICovCisJCWVjX3N1Ym0obDMsIGwxLCBsMiwgY3R4KTsKKwkJLyogbDQgPSB5MSB6Ml4zICAqLwor
CQllY19wb3dtKGw0LCB6MiwgbXBpX2NvbnN0KE1QSV9DX1RIUkVFKSwgY3R4KTsKKwkJZWNfbXVs
bShsNCwgbDQsIHkxLCBjdHgpOworCQkvKiBsNSA9IHkyIHoxXjMgICovCisJCWVjX3Bvd20obDUs
IHoxLCBtcGlfY29uc3QoTVBJX0NfVEhSRUUpLCBjdHgpOworCQllY19tdWxtKGw1LCBsNSwgeTIs
IGN0eCk7CisJCS8qIGw2ID0gbDQgLSBsNSAgKi8KKwkJZWNfc3VibShsNiwgbDQsIGw1LCBjdHgp
OworCisJCWlmICghbXBpX2NtcF91aShsMywgMCkpIHsKKwkJCWlmICghbXBpX2NtcF91aShsNiwg
MCkpIHsKKwkJCQkvKiBQMSBhbmQgUDIgYXJlIHRoZSBzYW1lIC0gdXNlIGR1cGxpY2F0ZSBmdW5j
dGlvbi4gKi8KKwkJCQltcGlfZWNfZHVwX3BvaW50KHJlc3VsdCwgcDEsIGN0eCk7CisJCQl9IGVs
c2UgeworCQkJCS8qIFAxIGlzIHRoZSBpbnZlcnNlIG9mIFAyLiAgKi8KKwkJCQltcGlfc2V0X3Vp
KHgzLCAxKTsKKwkJCQltcGlfc2V0X3VpKHkzLCAxKTsKKwkJCQltcGlfc2V0X3VpKHozLCAwKTsK
KwkJCX0KKwkJfSBlbHNlIHsKKwkJCS8qIGw3ID0gbDEgKyBsMiAgKi8KKwkJCWVjX2FkZG0obDcs
IGwxLCBsMiwgY3R4KTsKKwkJCS8qIGw4ID0gbDQgKyBsNSAgKi8KKwkJCWVjX2FkZG0obDgsIGw0
LCBsNSwgY3R4KTsKKwkJCS8qIHozID0gejEgejIgbDMgICovCisJCQllY19tdWxtKHozLCB6MSwg
ejIsIGN0eCk7CisJCQllY19tdWxtKHozLCB6MywgbDMsIGN0eCk7CisJCQkvKiB4MyA9IGw2XjIg
LSBsNyBsM14yICAqLworCQkJZWNfcG93Mih0MSwgbDYsIGN0eCk7CisJCQllY19wb3cyKHQyLCBs
MywgY3R4KTsKKwkJCWVjX211bG0odDIsIHQyLCBsNywgY3R4KTsKKwkJCWVjX3N1Ym0oeDMsIHQx
LCB0MiwgY3R4KTsKKwkJCS8qIGw5ID0gbDcgbDNeMiAtIDIgeDMgICovCisJCQllY19tdWwyKHQx
LCB4MywgY3R4KTsKKwkJCWVjX3N1Ym0obDksIHQyLCB0MSwgY3R4KTsKKwkJCS8qIHkzID0gKGw5
IGw2IC0gbDggbDNeMykvMiAgKi8KKwkJCWVjX211bG0obDksIGw5LCBsNiwgY3R4KTsKKwkJCWVj
X3Bvd20odDEsIGwzLCBtcGlfY29uc3QoTVBJX0NfVEhSRUUpLCBjdHgpOyAvKiBmaXhtZTogVXNl
IHNhdmVkIHZhbHVlKi8KKwkJCWVjX211bG0odDEsIHQxLCBsOCwgY3R4KTsKKwkJCWVjX3N1Ym0o
eTMsIGw5LCB0MSwgY3R4KTsKKwkJCWVjX211bG0oeTMsIHkzLCBlY19nZXRfdHdvX2ludl9wKGN0
eCksIGN0eCk7CisJCX0KKwl9CisKKyN1bmRlZiB4MQorI3VuZGVmIHkxCisjdW5kZWYgejEKKyN1
bmRlZiB4MgorI3VuZGVmIHkyCisjdW5kZWYgejIKKyN1bmRlZiB4MworI3VuZGVmIHkzCisjdW5k
ZWYgejMKKyN1bmRlZiBsMQorI3VuZGVmIGwyCisjdW5kZWYgbDMKKyN1bmRlZiBsNAorI3VuZGVm
IGw1CisjdW5kZWYgbDYKKyN1bmRlZiBsNworI3VuZGVmIGw4CisjdW5kZWYgbDkKKyN1bmRlZiB0
MQorI3VuZGVmIHQyCit9CisKKy8qIFJFU1VMVCA9IFAxICsgUDIgIChNb250Z29tZXJ5IHZlcnNp
b24pLiovCitzdGF0aWMgdm9pZCBhZGRfcG9pbnRzX21vbnRnb21lcnkoTVBJX1BPSU5UIHJlc3Vs
dCwKKwkJTVBJX1BPSU5UIHAxLCBNUElfUE9JTlQgcDIsCisJCXN0cnVjdCBtcGlfZWNfY3R4ICpj
dHgpCit7CisJKHZvaWQpcmVzdWx0OworCSh2b2lkKXAxOworCSh2b2lkKXAyOworCSh2b2lkKWN0
eDsKKwlsb2dfZmF0YWwoIiVzOiAlcyBub3QgeWV0IHN1cHBvcnRlZFxuIiwKKwkJCSJtcGlfZWNf
YWRkX3BvaW50cyIsICJNb250Z29tZXJ5Iik7Cit9CisKKy8qIFJFU1VMVCA9IFAxICsgUDIgIChU
d2lzdGVkIEVkd2FyZHMgdmVyc2lvbikuKi8KK3N0YXRpYyB2b2lkIGFkZF9wb2ludHNfZWR3YXJk
cyhNUElfUE9JTlQgcmVzdWx0LAorCQlNUElfUE9JTlQgcDEsIE1QSV9QT0lOVCBwMiwKKwkJc3Ry
dWN0IG1waV9lY19jdHggKmN0eCkKK3sKKyNkZWZpbmUgWDEgKHAxLT54KQorI2RlZmluZSBZMSAo
cDEtPnkpCisjZGVmaW5lIFoxIChwMS0+eikKKyNkZWZpbmUgWDIgKHAyLT54KQorI2RlZmluZSBZ
MiAocDItPnkpCisjZGVmaW5lIFoyIChwMi0+eikKKyNkZWZpbmUgWDMgKHJlc3VsdC0+eCkKKyNk
ZWZpbmUgWTMgKHJlc3VsdC0+eSkKKyNkZWZpbmUgWjMgKHJlc3VsdC0+eikKKyNkZWZpbmUgQSAo
Y3R4LT50LnNjcmF0Y2hbMF0pCisjZGVmaW5lIEIgKGN0eC0+dC5zY3JhdGNoWzFdKQorI2RlZmlu
ZSBDIChjdHgtPnQuc2NyYXRjaFsyXSkKKyNkZWZpbmUgRCAoY3R4LT50LnNjcmF0Y2hbM10pCisj
ZGVmaW5lIEUgKGN0eC0+dC5zY3JhdGNoWzRdKQorI2RlZmluZSBGIChjdHgtPnQuc2NyYXRjaFs1
XSkKKyNkZWZpbmUgRyAoY3R4LT50LnNjcmF0Y2hbNl0pCisjZGVmaW5lIHRtcCAoY3R4LT50LnNj
cmF0Y2hbN10pCisKKwlwb2ludF9yZXNpemUocmVzdWx0LCBjdHgpOworCisJLyogQ29tcHV0ZTog
KFhfMyA6IFlfMyA6IFpfMykgPSAoWF8xIDogWV8xIDogWl8xKSArIChYXzIgOiBZXzIgOiBaXzMp
ICovCisKKwkvKiBBID0gWjEgwrcgWjIgKi8KKwljdHgtPm11bG0oQSwgWjEsIFoyLCBjdHgpOwor
CisJLyogQiA9IEFeMiAqLworCWN0eC0+cG93MihCLCBBLCBjdHgpOworCisJLyogQyA9IFgxIMK3
IFgyICovCisJY3R4LT5tdWxtKEMsIFgxLCBYMiwgY3R4KTsKKworCS8qIEQgPSBZMSDCtyBZMiAq
LworCWN0eC0+bXVsbShELCBZMSwgWTIsIGN0eCk7CisKKwkvKiBFID0gZCDCtyBDIMK3IEQgKi8K
KwljdHgtPm11bG0oRSwgY3R4LT5iLCBDLCBjdHgpOworCWN0eC0+bXVsbShFLCBFLCBELCBjdHgp
OworCisJLyogRiA9IEIgLSBFICovCisJY3R4LT5zdWJtKEYsIEIsIEUsIGN0eCk7CisKKwkvKiBH
ID0gQiArIEUgKi8KKwljdHgtPmFkZG0oRywgQiwgRSwgY3R4KTsKKworCS8qIFhfMyA9IEEgwrcg
RiDCtyAoKFhfMSArIFlfMSkgwrcgKFhfMiArIFlfMikgLSBDIC0gRCkgKi8KKwljdHgtPmFkZG0o
dG1wLCBYMSwgWTEsIGN0eCk7CisJY3R4LT5hZGRtKFgzLCBYMiwgWTIsIGN0eCk7CisJY3R4LT5t
dWxtKFgzLCBYMywgdG1wLCBjdHgpOworCWN0eC0+c3VibShYMywgWDMsIEMsIGN0eCk7CisJY3R4
LT5zdWJtKFgzLCBYMywgRCwgY3R4KTsKKwljdHgtPm11bG0oWDMsIFgzLCBGLCBjdHgpOworCWN0
eC0+bXVsbShYMywgWDMsIEEsIGN0eCk7CisKKwkvKiBZXzMgPSBBIMK3IEcgwrcgKEQgLSBhQykg
Ki8KKwlpZiAoY3R4LT5kaWFsZWN0ID09IEVDQ19ESUFMRUNUX0VEMjU1MTkpIHsKKwkJY3R4LT5h
ZGRtKFkzLCBELCBDLCBjdHgpOworCX0gZWxzZSB7CisJCWN0eC0+bXVsbShZMywgY3R4LT5hLCBD
LCBjdHgpOworCQljdHgtPnN1Ym0oWTMsIEQsIFkzLCBjdHgpOworCX0KKwljdHgtPm11bG0oWTMs
IFkzLCBHLCBjdHgpOworCWN0eC0+bXVsbShZMywgWTMsIEEsIGN0eCk7CisKKwkvKiBaXzMgPSBG
IMK3IEcgKi8KKwljdHgtPm11bG0oWjMsIEYsIEcsIGN0eCk7CisKKworI3VuZGVmIFgxCisjdW5k
ZWYgWTEKKyN1bmRlZiBaMQorI3VuZGVmIFgyCisjdW5kZWYgWTIKKyN1bmRlZiBaMgorI3VuZGVm
IFgzCisjdW5kZWYgWTMKKyN1bmRlZiBaMworI3VuZGVmIEEKKyN1bmRlZiBCCisjdW5kZWYgQwor
I3VuZGVmIEQKKyN1bmRlZiBFCisjdW5kZWYgRgorI3VuZGVmIEcKKyN1bmRlZiB0bXAKK30KKwor
LyogQ29tcHV0ZSBhIHN0ZXAgb2YgTW9udGdvbWVyeSBMYWRkZXIgKG9ubHkgdXNlIFggYW5kIFog
aW4gdGhlIHBvaW50KS4KKyAqIElucHV0czogIFAxLCBQMiwgYW5kIHgtY29vcmRpbmF0ZSBvZiBE
SUYgPSBQMSAtIFAxLgorICogT3V0cHV0czogUFJEID0gMiAqIFAxIGFuZCAgU1VNID0gUDEgKyBQ
Mi4KKyAqLworc3RhdGljIHZvaWQgbW9udGdvbWVyeV9sYWRkZXIoTVBJX1BPSU5UIHByZCwgTVBJ
X1BPSU5UIHN1bSwKKwkJTVBJX1BPSU5UIHAxLCBNUElfUE9JTlQgcDIsIE1QSSBkaWZfeCwKKwkJ
c3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwljdHgtPmFkZG0oc3VtLT54LCBwMi0+eCwgcDIt
PnosIGN0eCk7CisJY3R4LT5zdWJtKHAyLT56LCBwMi0+eCwgcDItPnosIGN0eCk7CisJY3R4LT5h
ZGRtKHByZC0+eCwgcDEtPngsIHAxLT56LCBjdHgpOworCWN0eC0+c3VibShwMS0+eiwgcDEtPngs
IHAxLT56LCBjdHgpOworCWN0eC0+bXVsbShwMi0+eCwgcDEtPnosIHN1bS0+eCwgY3R4KTsKKwlj
dHgtPm11bG0ocDItPnosIHByZC0+eCwgcDItPnosIGN0eCk7CisJY3R4LT5wb3cyKHAxLT54LCBw
cmQtPngsIGN0eCk7CisJY3R4LT5wb3cyKHAxLT56LCBwMS0+eiwgY3R4KTsKKwljdHgtPmFkZG0o
c3VtLT54LCBwMi0+eCwgcDItPnosIGN0eCk7CisJY3R4LT5zdWJtKHAyLT56LCBwMi0+eCwgcDIt
PnosIGN0eCk7CisJY3R4LT5tdWxtKHByZC0+eCwgcDEtPngsIHAxLT56LCBjdHgpOworCWN0eC0+
c3VibShwMS0+eiwgcDEtPngsIHAxLT56LCBjdHgpOworCWN0eC0+cG93MihzdW0tPngsIHN1bS0+
eCwgY3R4KTsKKwljdHgtPnBvdzIoc3VtLT56LCBwMi0+eiwgY3R4KTsKKwljdHgtPm11bG0ocHJk
LT56LCBwMS0+eiwgY3R4LT5hLCBjdHgpOyAvKiBDVFgtPkE6IChhLTIpLzQgKi8KKwljdHgtPm11
bG0oc3VtLT56LCBzdW0tPnosIGRpZl94LCBjdHgpOworCWN0eC0+YWRkbShwcmQtPnosIHAxLT54
LCBwcmQtPnosIGN0eCk7CisJY3R4LT5tdWxtKHByZC0+eiwgcHJkLT56LCBwMS0+eiwgY3R4KTsK
K30KKworLyogUkVTVUxUID0gUDEgKyBQMiAqLwordm9pZCBtcGlfZWNfYWRkX3BvaW50cyhNUElf
UE9JTlQgcmVzdWx0LAorCQlNUElfUE9JTlQgcDEsIE1QSV9QT0lOVCBwMiwKKwkJc3RydWN0IG1w
aV9lY19jdHggKmN0eCkKK3sKKwlzd2l0Y2ggKGN0eC0+bW9kZWwpIHsKKwljYXNlIE1QSV9FQ19X
RUlFUlNUUkFTUzoKKwkJYWRkX3BvaW50c193ZWllcnN0cmFzcyhyZXN1bHQsIHAxLCBwMiwgY3R4
KTsKKwkJYnJlYWs7CisJY2FzZSBNUElfRUNfTU9OVEdPTUVSWToKKwkJYWRkX3BvaW50c19tb250
Z29tZXJ5KHJlc3VsdCwgcDEsIHAyLCBjdHgpOworCQlicmVhazsKKwljYXNlIE1QSV9FQ19FRFdB
UkRTOgorCQlhZGRfcG9pbnRzX2Vkd2FyZHMocmVzdWx0LCBwMSwgcDIsIGN0eCk7CisJCWJyZWFr
OworCX0KK30KK0VYUE9SVF9TWU1CT0xfR1BMKG1waV9lY19hZGRfcG9pbnRzKTsKKworLyogU2Nh
bGFyIHBvaW50IG11bHRpcGxpY2F0aW9uIC0gdGhlIG1haW4gZnVuY3Rpb24gZm9yIEVDQy4gIElm
IHRha2VzCisgKiBhbiBpbnRlZ2VyIFNDQUxBUiBhbmQgYSBQT0lOVCBhcyB3ZWxsIGFzIHRoZSB1
c3VhbCBjb250ZXh0IENUWC4KKyAqIFJFU1VMVCB3aWxsIGJlIHNldCB0byB0aGUgcmVzdWx0aW5n
IHBvaW50LgorICovCit2b2lkIG1waV9lY19tdWxfcG9pbnQoTVBJX1BPSU5UIHJlc3VsdCwKKwkJ
CU1QSSBzY2FsYXIsIE1QSV9QT0lOVCBwb2ludCwKKwkJCXN0cnVjdCBtcGlfZWNfY3R4ICpjdHgp
Cit7CisJTVBJIHgxLCB5MSwgejEsIGssIGgsIHl5OworCXVuc2lnbmVkIGludCBpLCBsb29wczsK
KwlzdHJ1Y3QgZ2NyeV9tcGlfcG9pbnQgcDEsIHAyLCBwMWludjsKKworCWlmIChjdHgtPm1vZGVs
ID09IE1QSV9FQ19FRFdBUkRTKSB7CisJCS8qIFNpbXBsZSBsZWZ0IHRvIHJpZ2h0IGJpbmFyeSBt
ZXRob2QuICBBbGdvcml0aG0gMy4yNyBmcm9tCisJCSAqIHthdXRob3I9e0hhbmtlcnNvbiwgRGFy
cmVsIGFuZCBNZW5lemVzLCBBbGZyZWQgSi4gYW5kIFZhbnN0b25lLCBTY290dH0sCisJCSAqICB0
aXRsZSA9IHtHdWlkZSB0byBFbGxpcHRpYyBDdXJ2ZSBDcnlwdG9ncmFwaHl9LAorCQkgKiAgeWVh
ciA9IHsyMDAzfSwgaXNibiA9IHswMzg3OTUyNzNYfSwKKwkJICogIHVybCA9IHtodHRwOi8vd3d3
LmNhY3IubWF0aC51d2F0ZXJsb28uY2EvZWNjL30sCisJCSAqICBwdWJsaXNoZXIgPSB7U3ByaW5n
ZXItVmVybGFnIE5ldyBZb3JrLCBJbmMufX0KKwkJICovCisJCXVuc2lnbmVkIGludCBuYml0czsK
KwkJaW50IGo7CisKKwkJaWYgKG1waV9jbXAoc2NhbGFyLCBjdHgtPnApID49IDApCisJCQluYml0
cyA9IG1waV9nZXRfbmJpdHMoc2NhbGFyKTsKKwkJZWxzZQorCQkJbmJpdHMgPSBtcGlfZ2V0X25i
aXRzKGN0eC0+cCk7CisKKwkJbXBpX3NldF91aShyZXN1bHQtPngsIDApOworCQltcGlfc2V0X3Vp
KHJlc3VsdC0+eSwgMSk7CisJCW1waV9zZXRfdWkocmVzdWx0LT56LCAxKTsKKwkJcG9pbnRfcmVz
aXplKHBvaW50LCBjdHgpOworCisJCXBvaW50X3Jlc2l6ZShyZXN1bHQsIGN0eCk7CisJCXBvaW50
X3Jlc2l6ZShwb2ludCwgY3R4KTsKKworCQlmb3IgKGogPSBuYml0cy0xOyBqID49IDA7IGotLSkg
eworCQkJbXBpX2VjX2R1cF9wb2ludChyZXN1bHQsIHJlc3VsdCwgY3R4KTsKKwkJCWlmIChtcGlf
dGVzdF9iaXQoc2NhbGFyLCBqKSkKKwkJCQltcGlfZWNfYWRkX3BvaW50cyhyZXN1bHQsIHJlc3Vs
dCwgcG9pbnQsIGN0eCk7CisJCX0KKwkJcmV0dXJuOworCX0gZWxzZSBpZiAoY3R4LT5tb2RlbCA9
PSBNUElfRUNfTU9OVEdPTUVSWSkgeworCQl1bnNpZ25lZCBpbnQgbmJpdHM7CisJCWludCBqOwor
CQlzdHJ1Y3QgZ2NyeV9tcGlfcG9pbnQgcDFfLCBwMl87CisJCU1QSV9QT0lOVCBxMSwgcTIsIHBy
ZCwgc3VtOworCQl1bnNpZ25lZCBsb25nIHN3OworCQltcGlfc2l6ZV90IHJzaXplOworCQlpbnQg
c2NhbGFyX2NvcGllZCA9IDA7CisKKwkJLyogQ29tcHV0ZSBzY2FsYXIgcG9pbnQgbXVsdGlwbGlj
YXRpb24gd2l0aCBNb250Z29tZXJ5IExhZGRlci4KKwkJICogTm90ZSB0aGF0IHdlIGRvbid0IHVz
ZSBZLWNvb3JkaW5hdGUgaW4gdGhlIHBvaW50cyBhdCBhbGwuCisJCSAqIFJFU1VMVC0+WSB3aWxs
IGJlIGZpbGxlZCBieSB6ZXJvLgorCQkgKi8KKworCQluYml0cyA9IG1waV9nZXRfbmJpdHMoc2Nh
bGFyKTsKKwkJcG9pbnRfaW5pdCgmcDEpOworCQlwb2ludF9pbml0KCZwMik7CisJCXBvaW50X2lu
aXQoJnAxXyk7CisJCXBvaW50X2luaXQoJnAyXyk7CisJCW1waV9zZXRfdWkocDEueCwgMSk7CisJ
CW1waV9mcmVlKHAyLngpOworCQlwMi54ID0gbXBpX2NvcHkocG9pbnQtPngpOworCQltcGlfc2V0
X3VpKHAyLnosIDEpOworCisJCXBvaW50X3Jlc2l6ZSgmcDEsIGN0eCk7CisJCXBvaW50X3Jlc2l6
ZSgmcDIsIGN0eCk7CisJCXBvaW50X3Jlc2l6ZSgmcDFfLCBjdHgpOworCQlwb2ludF9yZXNpemUo
JnAyXywgY3R4KTsKKworCQltcGlfcmVzaXplKHBvaW50LT54LCBjdHgtPnAtPm5saW1icyk7CisJ
CXBvaW50LT54LT5ubGltYnMgPSBjdHgtPnAtPm5saW1iczsKKworCQlxMSA9ICZwMTsKKwkJcTIg
PSAmcDI7CisJCXByZCA9ICZwMV87CisJCXN1bSA9ICZwMl87CisKKwkJZm9yIChqID0gbmJpdHMt
MTsgaiA+PSAwOyBqLS0pIHsKKwkJCU1QSV9QT0lOVCB0OworCisJCQlzdyA9IG1waV90ZXN0X2Jp
dChzY2FsYXIsIGopOworCQkJcG9pbnRfc3dhcF9jb25kKHExLCBxMiwgc3csIGN0eCk7CisJCQlt
b250Z29tZXJ5X2xhZGRlcihwcmQsIHN1bSwgcTEsIHEyLCBwb2ludC0+eCwgY3R4KTsKKwkJCXBv
aW50X3N3YXBfY29uZChwcmQsIHN1bSwgc3csIGN0eCk7CisJCQl0ID0gcTE7ICBxMSA9IHByZDsg
IHByZCA9IHQ7CisJCQl0ID0gcTI7ICBxMiA9IHN1bTsgIHN1bSA9IHQ7CisJCX0KKworCQltcGlf
Y2xlYXIocmVzdWx0LT55KTsKKwkJc3cgPSAobmJpdHMgJiAxKTsKKwkJcG9pbnRfc3dhcF9jb25k
KCZwMSwgJnAxXywgc3csIGN0eCk7CisKKwkJcnNpemUgPSBwMS56LT5ubGltYnM7CisJCU1QTl9O
T1JNQUxJWkUocDEuei0+ZCwgcnNpemUpOworCQlpZiAocnNpemUgPT0gMCkgeworCQkJbXBpX3Nl
dF91aShyZXN1bHQtPngsIDEpOworCQkJbXBpX3NldF91aShyZXN1bHQtPnosIDApOworCQl9IGVs
c2UgeworCQkJejEgPSBtcGlfbmV3KDApOworCQkJZWNfaW52bSh6MSwgcDEueiwgY3R4KTsKKwkJ
CWVjX211bG0ocmVzdWx0LT54LCBwMS54LCB6MSwgY3R4KTsKKwkJCW1waV9zZXRfdWkocmVzdWx0
LT56LCAxKTsKKwkJCW1waV9mcmVlKHoxKTsKKwkJfQorCisJCXBvaW50X2ZyZWUoJnAxKTsKKwkJ
cG9pbnRfZnJlZSgmcDIpOworCQlwb2ludF9mcmVlKCZwMV8pOworCQlwb2ludF9mcmVlKCZwMl8p
OworCQlpZiAoc2NhbGFyX2NvcGllZCkKKwkJCW1waV9mcmVlKHNjYWxhcik7CisJCXJldHVybjsK
Kwl9CisKKwl4MSA9IG1waV9hbGxvY19saWtlKGN0eC0+cCk7CisJeTEgPSBtcGlfYWxsb2NfbGlr
ZShjdHgtPnApOworCWggID0gbXBpX2FsbG9jX2xpa2UoY3R4LT5wKTsKKwlrICA9IG1waV9jb3B5
KHNjYWxhcik7CisJeXkgPSBtcGlfY29weShwb2ludC0+eSk7CisKKwlpZiAobXBpX2hhc19zaWdu
KGspKSB7CisJCWstPnNpZ24gPSAwOworCQllY19pbnZtKHl5LCB5eSwgY3R4KTsKKwl9CisKKwlp
ZiAoIW1waV9jbXBfdWkocG9pbnQtPnosIDEpKSB7CisJCW1waV9zZXQoeDEsIHBvaW50LT54KTsK
KwkJbXBpX3NldCh5MSwgeXkpOworCX0gZWxzZSB7CisJCU1QSSB6MiwgejM7CisKKwkJejIgPSBt
cGlfYWxsb2NfbGlrZShjdHgtPnApOworCQl6MyA9IG1waV9hbGxvY19saWtlKGN0eC0+cCk7CisJ
CWVjX211bG0oejIsIHBvaW50LT56LCBwb2ludC0+eiwgY3R4KTsKKwkJZWNfbXVsbSh6MywgcG9p
bnQtPnosIHoyLCBjdHgpOworCQllY19pbnZtKHoyLCB6MiwgY3R4KTsKKwkJZWNfbXVsbSh4MSwg
cG9pbnQtPngsIHoyLCBjdHgpOworCQllY19pbnZtKHozLCB6MywgY3R4KTsKKwkJZWNfbXVsbSh5
MSwgeXksIHozLCBjdHgpOworCQltcGlfZnJlZSh6Mik7CisJCW1waV9mcmVlKHozKTsKKwl9CisJ
ejEgPSBtcGlfY29weShtcGlfY29uc3QoTVBJX0NfT05FKSk7CisKKwltcGlfbXVsKGgsIGssIG1w
aV9jb25zdChNUElfQ19USFJFRSkpOyAvKiBoID0gM2sgKi8KKwlsb29wcyA9IG1waV9nZXRfbmJp
dHMoaCk7CisJaWYgKGxvb3BzIDwgMikgeworCQkvKiBJZiBTQ0FMQVIgaXMgemVybywgdGhlIGFi
b3ZlIG1waV9tdWwgc2V0cyBIIHRvIHplcm8gYW5kIHRodXMKKwkJICogTE9PUHMgd2lsbCBiZSB6
ZXJvLiAgVG8gYXZvaWQgYW4gdW5kZXJmbG93IG9mIEkgaW4gdGhlIG1haW4KKwkJICogbG9vcCB3
ZSBzZXQgTE9PUCB0byAyIGFuZCB0aGUgcmVzdWx0IHRvICgwLDAsMCkuCisJCSAqLworCQlsb29w
cyA9IDI7CisJCW1waV9jbGVhcihyZXN1bHQtPngpOworCQltcGlfY2xlYXIocmVzdWx0LT55KTsK
KwkJbXBpX2NsZWFyKHJlc3VsdC0+eik7CisJfSBlbHNlIHsKKwkJbXBpX3NldChyZXN1bHQtPngs
IHBvaW50LT54KTsKKwkJbXBpX3NldChyZXN1bHQtPnksIHl5KTsKKwkJbXBpX3NldChyZXN1bHQt
PnosIHBvaW50LT56KTsKKwl9CisJbXBpX2ZyZWUoeXkpOyB5eSA9IE5VTEw7CisKKwlwMS54ID0g
eDE7IHgxID0gTlVMTDsKKwlwMS55ID0geTE7IHkxID0gTlVMTDsKKwlwMS56ID0gejE7IHoxID0g
TlVMTDsKKwlwb2ludF9pbml0KCZwMik7CisJcG9pbnRfaW5pdCgmcDFpbnYpOworCisJLyogSW52
ZXJ0IHBvaW50OiB5ID0gcCAtIHkgbW9kIHAgICovCisJcG9pbnRfc2V0KCZwMWludiwgJnAxKTsK
KwllY19zdWJtKHAxaW52LnksIGN0eC0+cCwgcDFpbnYueSwgY3R4KTsKKworCWZvciAoaSA9IGxv
b3BzLTI7IGkgPiAwOyBpLS0pIHsKKwkJbXBpX2VjX2R1cF9wb2ludChyZXN1bHQsIHJlc3VsdCwg
Y3R4KTsKKwkJaWYgKG1waV90ZXN0X2JpdChoLCBpKSA9PSAxICYmIG1waV90ZXN0X2JpdChrLCBp
KSA9PSAwKSB7CisJCQlwb2ludF9zZXQoJnAyLCByZXN1bHQpOworCQkJbXBpX2VjX2FkZF9wb2lu
dHMocmVzdWx0LCAmcDIsICZwMSwgY3R4KTsKKwkJfQorCQlpZiAobXBpX3Rlc3RfYml0KGgsIGkp
ID09IDAgJiYgbXBpX3Rlc3RfYml0KGssIGkpID09IDEpIHsKKwkJCXBvaW50X3NldCgmcDIsIHJl
c3VsdCk7CisJCQltcGlfZWNfYWRkX3BvaW50cyhyZXN1bHQsICZwMiwgJnAxaW52LCBjdHgpOwor
CQl9CisJfQorCisJcG9pbnRfZnJlZSgmcDEpOworCXBvaW50X2ZyZWUoJnAyKTsKKwlwb2ludF9m
cmVlKCZwMWludik7CisJbXBpX2ZyZWUoaCk7CisJbXBpX2ZyZWUoayk7Cit9CitFWFBPUlRfU1lN
Qk9MX0dQTChtcGlfZWNfbXVsX3BvaW50KTsKKworLyogUmV0dXJuIHRydWUgaWYgUE9JTlQgaXMg
b24gdGhlIGN1cnZlIGRlc2NyaWJlZCBieSBDVFguICAqLworaW50IG1waV9lY19jdXJ2ZV9wb2lu
dChNUElfUE9JTlQgcG9pbnQsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJaW50IHJlcyA9
IDA7CisJTVBJIHgsIHksIHc7CisKKwl4ID0gbXBpX25ldygwKTsKKwl5ID0gbXBpX25ldygwKTsK
Kwl3ID0gbXBpX25ldygwKTsKKworCS8qIENoZWNrIHRoYXQgdGhlIHBvaW50IGlzIGluIHJhbmdl
LiAgVGhpcyBuZWVkcyB0byBiZSBkb25lIGhlcmUgYW5kCisJICogbm90IGFmdGVyIGNvbnZlcnNp
b24gdG8gYWZmaW5lIGNvb3JkaW5hdGVzLgorCSAqLworCWlmIChtcGlfY21wYWJzKHBvaW50LT54
LCBjdHgtPnApID49IDApCisJCWdvdG8gbGVhdmU7CisJaWYgKG1waV9jbXBhYnMocG9pbnQtPnks
IGN0eC0+cCkgPj0gMCkKKwkJZ290byBsZWF2ZTsKKwlpZiAobXBpX2NtcGFicyhwb2ludC0+eiwg
Y3R4LT5wKSA+PSAwKQorCQlnb3RvIGxlYXZlOworCisJc3dpdGNoIChjdHgtPm1vZGVsKSB7CisJ
Y2FzZSBNUElfRUNfV0VJRVJTVFJBU1M6CisJCXsKKwkJCU1QSSB4eHg7CisKKwkJCWlmIChtcGlf
ZWNfZ2V0X2FmZmluZSh4LCB5LCBwb2ludCwgY3R4KSkKKwkJCQlnb3RvIGxlYXZlOworCisJCQl4
eHggPSBtcGlfbmV3KDApOworCisJCQkvKiB5XjIgPT0geF4zICsgYcK3eCArIGIgKi8KKwkJCWVj
X3BvdzIoeSwgeSwgY3R4KTsKKworCQkJZWNfcG93Myh4eHgsIHgsIGN0eCk7CisJCQllY19tdWxt
KHcsIGN0eC0+YSwgeCwgY3R4KTsKKwkJCWVjX2FkZG0odywgdywgY3R4LT5iLCBjdHgpOworCQkJ
ZWNfYWRkbSh3LCB3LCB4eHgsIGN0eCk7CisKKwkJCWlmICghbXBpX2NtcCh5LCB3KSkKKwkJCQly
ZXMgPSAxOworCisJCQltcGlfZnJlZSh4eHgpOworCQl9CisJCWJyZWFrOworCisJY2FzZSBNUElf
RUNfTU9OVEdPTUVSWToKKwkJeworI2RlZmluZSB4eCB5CisJCQkvKiBXaXRoIE1vbnRnb21lcnkg
Y3VydmUsIG9ubHkgWC1jb29yZGluYXRlIGlzIHZhbGlkLiAqLworCQkJaWYgKG1waV9lY19nZXRf
YWZmaW5lKHgsIE5VTEwsIHBvaW50LCBjdHgpKQorCQkJCWdvdG8gbGVhdmU7CisKKwkJCS8qIFRo
ZSBlcXVhdGlvbiBpczogYiAqIHleMiA9PSB4XjMgKyBhIMK3IHheMiArIHggKi8KKwkJCS8qIFdl
IGNoZWNrIGlmIHJpZ2h0IGhhbmQgaXMgcXVhZHJhdGljIHJlc2lkdWUgb3Igbm90IGJ5CisJCQkg
KiBFdWxlcidzIGNyaXRlcmlvbi4KKwkJCSAqLworCQkJLyogQ1RYLT5BIGhhcyAoYS0yKS80IGFu
ZCBDVFgtPkIgaGFzIGJeLTEgKi8KKwkJCWVjX211bG0odywgY3R4LT5hLCBtcGlfY29uc3QoTVBJ
X0NfRk9VUiksIGN0eCk7CisJCQllY19hZGRtKHcsIHcsIG1waV9jb25zdChNUElfQ19UV08pLCBj
dHgpOworCQkJZWNfbXVsbSh3LCB3LCB4LCBjdHgpOworCQkJZWNfcG93Mih4eCwgeCwgY3R4KTsK
KwkJCWVjX2FkZG0odywgdywgeHgsIGN0eCk7CisJCQllY19hZGRtKHcsIHcsIG1waV9jb25zdChN
UElfQ19PTkUpLCBjdHgpOworCQkJZWNfbXVsbSh3LCB3LCB4LCBjdHgpOworCQkJZWNfbXVsbSh3
LCB3LCBjdHgtPmIsIGN0eCk7CisjdW5kZWYgeHgKKwkJCS8qIENvbXB1dGUgRXVsZXIncyBjcml0
ZXJpb246IHdeKHAtMSkvMiAqLworI2RlZmluZSBwX21pbnVzMSB5CisJCQllY19zdWJtKHBfbWlu
dXMxLCBjdHgtPnAsIG1waV9jb25zdChNUElfQ19PTkUpLCBjdHgpOworCQkJbXBpX3JzaGlmdChw
X21pbnVzMSwgcF9taW51czEsIDEpOworCQkJZWNfcG93bSh3LCB3LCBwX21pbnVzMSwgY3R4KTsK
KworCQkJcmVzID0gIW1waV9jbXBfdWkodywgMSk7CisjdW5kZWYgcF9taW51czEKKwkJfQorCQli
cmVhazsKKworCWNhc2UgTVBJX0VDX0VEV0FSRFM6CisJCXsKKwkJCWlmIChtcGlfZWNfZ2V0X2Fm
ZmluZSh4LCB5LCBwb2ludCwgY3R4KSkKKwkJCQlnb3RvIGxlYXZlOworCisJCQltcGlfcmVzaXpl
KHcsIGN0eC0+cC0+bmxpbWJzKTsKKwkJCXctPm5saW1icyA9IGN0eC0+cC0+bmxpbWJzOworCisJ
CQkvKiBhIMK3IHheMiArIHleMiAtIDEgLSBiIMK3IHheMiDCtyB5XjIgPT0gMCAqLworCQkJY3R4
LT5wb3cyKHgsIHgsIGN0eCk7CisJCQljdHgtPnBvdzIoeSwgeSwgY3R4KTsKKwkJCWlmIChjdHgt
PmRpYWxlY3QgPT0gRUNDX0RJQUxFQ1RfRUQyNTUxOSkKKwkJCQljdHgtPnN1Ym0odywgY3R4LT5w
LCB4LCBjdHgpOworCQkJZWxzZQorCQkJCWN0eC0+bXVsbSh3LCBjdHgtPmEsIHgsIGN0eCk7CisJ
CQljdHgtPmFkZG0odywgdywgeSwgY3R4KTsKKwkJCWN0eC0+bXVsbSh4LCB4LCB5LCBjdHgpOwor
CQkJY3R4LT5tdWxtKHgsIHgsIGN0eC0+YiwgY3R4KTsKKwkJCWN0eC0+c3VibSh3LCB3LCB4LCBj
dHgpOworCQkJaWYgKCFtcGlfY21wX3VpKHcsIDEpKQorCQkJCXJlcyA9IDE7CisJCX0KKwkJYnJl
YWs7CisJfQorCitsZWF2ZToKKwltcGlfZnJlZSh3KTsKKwltcGlfZnJlZSh4KTsKKwltcGlfZnJl
ZSh5KTsKKworCXJldHVybiByZXM7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChtcGlfZWNfY3VydmVf
cG9pbnQpOwotLSAKMi4xNy4xCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fXwpMaW51eC1zdG0zMiBtYWlsaW5nIGxpc3QKTGludXgtc3RtMzJAc3QtbWQtbWFp
bG1hbi5zdG9ybXJlcGx5LmNvbQpodHRwczovL3N0LW1kLW1haWxtYW4uc3Rvcm1yZXBseS5jb20v
bWFpbG1hbi9saXN0aW5mby9saW51eC1zdG0zMgo=
