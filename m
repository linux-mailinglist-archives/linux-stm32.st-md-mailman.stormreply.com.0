Return-Path: <linux-stm32-bounces@st-md-mailman.stormreply.com>
X-Original-To: lists+linux-stm32@lfdr.de
Delivered-To: lists+linux-stm32@lfdr.de
Received: from stm-ict-prod-mailman-01.stormreply.prv (st-md-mailman.stormreply.com [52.209.6.89])
	by mail.lfdr.de (Postfix) with ESMTPS id BAFE825C18D
	for <lists+linux-stm32@lfdr.de>; Thu,  3 Sep 2020 15:13:03 +0200 (CEST)
Received: from ip-172-31-3-76.eu-west-1.compute.internal (localhost [127.0.0.1])
	by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTP id 7C131C3FAFF;
	Thu,  3 Sep 2020 13:13:03 +0000 (UTC)
Received: from out30-130.freemail.mail.aliyun.com
 (out30-130.freemail.mail.aliyun.com [115.124.30.130])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
 (No client certificate requested)
 by stm-ict-prod-mailman-01.stormreply.prv (Postfix) with ESMTPS id 17278C3FADB
 for <linux-stm32@st-md-mailman.stormreply.com>;
 Thu,  3 Sep 2020 13:12:57 +0000 (UTC)
X-Alimail-AntiSpam: AC=PASS; BC=-1|-1; BR=01201311R241e4; CH=green; DM=||false|;
 DS=||; FP=0|-1|-1|-1|0|-1|-1|-1; HT=e01e01355;
 MF=tianjia.zhang@linux.alibaba.com; NM=1; PH=DS; RN=31; SR=0;
 TI=SMTPD_---0U7ok5HV_1599138764; 
Received: from localhost(mailfrom:tianjia.zhang@linux.alibaba.com
 fp:SMTPD_---0U7ok5HV_1599138764) by smtp.aliyun-inc.com(127.0.0.1);
 Thu, 03 Sep 2020 21:12:44 +0800
From: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
To: Herbert Xu <herbert@gondor.apana.org.au>,
 "David S. Miller" <davem@davemloft.net>,
 David Howells <dhowells@redhat.com>,
 Maxime Coquelin <mcoquelin.stm32@gmail.com>,
 Alexandre Torgue <alexandre.torgue@st.com>,
 James Morris <jmorris@namei.org>, "Serge E. Hallyn" <serge@hallyn.com>,
 Stephan Mueller <smueller@chronox.de>,
 Marcelo Henrique Cerri <marcelo.cerri@canonical.com>,
 "Steven Rostedt (VMware)" <rostedt@goodmis.org>,
 Masahiro Yamada <masahiroy@kernel.org>,
 Brendan Higgins <brendanhiggins@google.com>,
 Andrew Morton <akpm@linux-foundation.org>,
 Johannes Weiner <hannes@cmpxchg.org>, Waiman Long <longman@redhat.com>,
 Mimi Zohar <zohar@linux.ibm.com>,
 Lakshmi Ramasubramanian <nramas@linux.microsoft.com>,
 Colin Ian King <colin.king@canonical.com>,
 Tushar Sugandhi <tusharsu@linux.microsoft.com>,
 Vitaly Chikunov <vt@altlinux.org>,
 "Gilad Ben-Yossef" <gilad@benyossef.com>,
 Pascal van Leeuwen <pvanleeuwen@rambus.com>, linux-crypto@vger.kernel.org,
 linux-kernel@vger.kernel.org, keyrings@vger.kernel.org,
 linux-stm32@st-md-mailman.stormreply.com,
 linux-arm-kernel@lists.infradead.org, linux-security-module@vger.kernel.org
Date: Thu,  3 Sep 2020 21:12:37 +0800
Message-Id: <20200903131242.128665-4-tianjia.zhang@linux.alibaba.com>
X-Mailer: git-send-email 2.19.1.3.ge56e4f7
In-Reply-To: <20200903131242.128665-1-tianjia.zhang@linux.alibaba.com>
References: <20200903131242.128665-1-tianjia.zhang@linux.alibaba.com>
MIME-Version: 1.0
Cc: Xufeng Zhang <yunbo.xufeng@linux.alibaba.com>,
 Tianjia Zhang <tianjia.zhang@linux.alibaba.com>,
 Jia Zhang <zhang.jia@linux.alibaba.com>
Subject: [Linux-stm32] [PATCH v6 3/8] lib/mpi: Introduce ec implementation
	to MPI library
X-BeenThere: linux-stm32@st-md-mailman.stormreply.com
X-Mailman-Version: 2.1.15
Precedence: list
List-Id: <linux-stm32.st-md-mailman.stormreply.com>
List-Unsubscribe: <https://st-md-mailman.stormreply.com/mailman/options/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=unsubscribe>
List-Archive: <http://st-md-mailman.stormreply.com/pipermail/linux-stm32/>
List-Post: <mailto:linux-stm32@st-md-mailman.stormreply.com>
List-Help: <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=help>
List-Subscribe: <https://st-md-mailman.stormreply.com/mailman/listinfo/linux-stm32>, 
 <mailto:linux-stm32-request@st-md-mailman.stormreply.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linux-stm32-bounces@st-md-mailman.stormreply.com
Sender: "Linux-stm32" <linux-stm32-bounces@st-md-mailman.stormreply.com>

VGhlIGltcGxlbWVudGF0aW9uIG9mIEVDIGlzIGludHJvZHVjZWQgZnJvbSBsaWJnY3J5cHQgYXMg
dGhlCmJhc2ljIGFsZ29yaXRobSBvZiBlbGxpcHRpYyBjdXJ2ZSwgd2hpY2ggY2FuIGJlIG1vcmUg
cGVyZmVjdGx5CmludGVncmF0ZWQgd2l0aCBNUEkgaW1wbGVtZW50YXRpb24uClNvbWUgb3RoZXIg
YWxnb3JpdGhtcyB3aWxsIGJlIGRldmVsb3BlZCBiYXNlZCBvbiBtcGkgZWNjLCBzdWNoIGFzIFNN
Mi4KClNpZ25lZC1vZmYtYnk6IFRpYW5qaWEgWmhhbmcgPHRpYW5qaWEuemhhbmdAbGludXguYWxp
YmFiYS5jb20+ClRlc3RlZC1ieTogWHVmZW5nIFpoYW5nIDx5dW5iby54dWZlbmdAbGludXguYWxp
YmFiYS5jb20+Ci0tLQogaW5jbHVkZS9saW51eC9tcGkuaCB8ICAxMDUgKysrCiBsaWIvbXBpL01h
a2VmaWxlICAgIHwgICAgMSArCiBsaWIvbXBpL2VjLmMgICAgICAgIHwgMTUwOSArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDE2MTUg
aW5zZXJ0aW9ucygrKQogY3JlYXRlIG1vZGUgMTAwNjQ0IGxpYi9tcGkvZWMuYwoKZGlmZiAtLWdp
dCBhL2luY2x1ZGUvbGludXgvbXBpLmggYi9pbmNsdWRlL2xpbnV4L21waS5oCmluZGV4IDNjOWU0
MTYwM2NmNi4uM2U1MzU4ZjRkZTJmIDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L21waS5oCisr
KyBiL2luY2x1ZGUvbGludXgvbXBpLmgKQEAgLTE1Nyw2ICsxNTcsMTExIEBAIHZvaWQgbXBpX2Zk
aXZfcShNUEkgcXVvdCwgTVBJIGRpdmlkZW5kLCBNUEkgZGl2aXNvcik7CiAvKi0tIG1waS1pbnYu
YyAtLSovCiBpbnQgbXBpX2ludm0oTVBJIHgsIE1QSSBhLCBNUEkgbik7CiAKKy8qLS0gZWMuYyAt
LSovCisKKy8qIE9iamVjdCB0byByZXByZXNlbnQgYSBwb2ludCBpbiBwcm9qZWN0aXZlIGNvb3Jk
aW5hdGVzICovCitzdHJ1Y3QgZ2NyeV9tcGlfcG9pbnQgeworCU1QSSB4OworCU1QSSB5OworCU1Q
SSB6OworfTsKKwordHlwZWRlZiBzdHJ1Y3QgZ2NyeV9tcGlfcG9pbnQgKk1QSV9QT0lOVDsKKwor
LyogTW9kZWxzIGRlc2NyaWJpbmcgYW4gZWxsaXB0aWMgY3VydmUgKi8KK2VudW0gZ2NyeV9tcGlf
ZWNfbW9kZWxzIHsKKwkvKiBUaGUgU2hvcnQgV2VpZXJzdHJhc3MgZXF1YXRpb24gaXMKKwkgKiAg
ICAgIHleMiA9IHheMyArIGF4ICsgYgorCSAqLworCU1QSV9FQ19XRUlFUlNUUkFTUyA9IDAsCisJ
LyogVGhlIE1vbnRnb21lcnkgZXF1YXRpb24gaXMKKwkgKiAgICAgIGJ5XjIgPSB4XjMgKyBheF4y
ICsgeAorCSAqLworCU1QSV9FQ19NT05UR09NRVJZLAorCS8qIFRoZSBUd2lzdGVkIEVkd2FyZHMg
ZXF1YXRpb24gaXMKKwkgKiAgICAgIGF4XjIgKyB5XjIgPSAxICsgYnheMnleMgorCSAqIE5vdGUg
dGhhdCB3ZSB1c2UgJ2InIGluc3RlYWQgb2YgdGhlIGNvbW1vbmx5IHVzZWQgJ2QnLgorCSAqLwor
CU1QSV9FQ19FRFdBUkRTCit9OworCisvKiBEaWFsZWN0cyB1c2VkIHdpdGggZWxsaXB0aWMgY3Vy
dmVzICovCitlbnVtIGVjY19kaWFsZWN0cyB7CisJRUNDX0RJQUxFQ1RfU1RBTkRBUkQgPSAwLAor
CUVDQ19ESUFMRUNUX0VEMjU1MTksCisJRUNDX0RJQUxFQ1RfU0FGRUNVUlZFCit9OworCisvKiBU
aGlzIGNvbnRleHQgaXMgdXNlZCB3aXRoIGFsbCBvdXIgRUMgZnVuY3Rpb25zLiAqLworc3RydWN0
IG1waV9lY19jdHggeworCWVudW0gZ2NyeV9tcGlfZWNfbW9kZWxzIG1vZGVsOyAvKiBUaGUgbW9k
ZWwgZGVzY3JpYmluZyB0aGlzIGN1cnZlLiAqLworCWVudW0gZWNjX2RpYWxlY3RzIGRpYWxlY3Q7
ICAgICAvKiBUaGUgRUNDIGRpYWxlY3QgdXNlZCB3aXRoIHRoZSBjdXJ2ZS4gKi8KKwlpbnQgZmxh
Z3M7ICAgICAgICAgICAgICAgICAgICAgLyogUHVibGljIGtleSBmbGFncyAobm90IGFsd2F5cyB1
c2VkKS4gKi8KKwl1bnNpZ25lZCBpbnQgbmJpdHM7ICAgICAgICAgICAgLyogTnVtYmVyIG9mIGJp
dHMuICAqLworCisJLyogRG9tYWluIHBhcmFtZXRlcnMuICBOb3RlIHRoYXQgdGhleSBtYXkgbm90
IGFsbCBiZSBzZXQgYW5kIGlmIHNldAorCSAqIHRoZSBNUElzIG1heSBiZSBmbGFnZWQgYXMgY29u
c3RhbnQuCisJICovCisJTVBJIHA7ICAgICAgICAgLyogUHJpbWUgc3BlY2lmeWluZyB0aGUgZmll
bGQgR0YocCkuICAqLworCU1QSSBhOyAgICAgICAgIC8qIEZpcnN0IGNvZWZmaWNpZW50IG9mIHRo
ZSBXZWllcnN0cmFzcyBlcXVhdGlvbi4gICovCisJTVBJIGI7ICAgICAgICAgLyogU2Vjb25kIGNv
ZWZmaWNpZW50IG9mIHRoZSBXZWllcnN0cmFzcyBlcXVhdGlvbi4gICovCisJTVBJX1BPSU5UIEc7
ICAgLyogQmFzZSBwb2ludCAoZ2VuZXJhdG9yKS4gICovCisJTVBJIG47ICAgICAgICAgLyogT3Jk
ZXIgb2YgRy4gICovCisJdW5zaWduZWQgaW50IGg7ICAgICAgIC8qIENvZmFjdG9yLiAgKi8KKwor
CS8qIFRoZSBhY3R1YWwga2V5LiAgTWF5IG5vdCBiZSBzZXQuICAqLworCU1QSV9QT0lOVCBROyAg
IC8qIFB1YmxpYyBrZXkuICAgKi8KKwlNUEkgZDsgICAgICAgICAvKiBQcml2YXRlIGtleS4gICov
CisKKwljb25zdCBjaGFyICpuYW1lOyAgICAgIC8qIE5hbWUgb2YgdGhlIGN1cnZlLiAgKi8KKwor
CS8qIFRoaXMgc3RydWN0dXJlIGlzIHByaXZhdGUgdG8gbXBpL2VjLmMhICovCisJc3RydWN0IHsK
KwkJc3RydWN0IHsKKwkJCXVuc2lnbmVkIGludCBhX2lzX3BtaW51czM6MTsKKwkJCXVuc2lnbmVk
IGludCB0d29faW52X3A6MTsKKwkJfSB2YWxpZDsgLyogRmxhZ3MgdG8gaGVscCBzZXR0aW5nIHRo
ZSBoZWxwZXIgdmFycyBiZWxvdy4gICovCisKKwkJaW50IGFfaXNfcG1pbnVzMzsgIC8qIFRydWUg
aWYgQSA9IFAgLSAzLiAqLworCisJCU1QSSB0d29faW52X3A7CisKKwkJbXBpX2JhcnJldHRfdCBw
X2JhcnJldHQ7CisKKwkJLyogU2NyYXRjaCB2YXJpYWJsZXMuICAqLworCQlNUEkgc2NyYXRjaFsx
MV07CisKKwkJLyogSGVscGVyIGZvciBmYXN0IHJlZHVjdGlvbi4gICovCisJCS8qICAgaW50IG5p
c3RfbmJpdHM7IC9cKiBJZiB0aGlzIGlzIGEgTklTVCBjdXJ2ZSwgdGhlICMgb2YgYml0cy4gKlwv
ICovCisJCS8qICAgTVBJIHNbMTBdOyAqLworCQkvKiAgIE1QSSBjOyAqLworCX0gdDsKKworCS8q
IEN1cnZlIHNwZWNpZmljIGNvbXB1dGF0aW9uIHJvdXRpbmVzIGZvciB0aGUgZmllbGQuICAqLwor
CXZvaWQgKCphZGRtKShNUEkgdywgTVBJIHUsIE1QSSB2LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4
KTsKKwl2b2lkICgqc3VibSkoTVBJIHcsIE1QSSB1LCBNUEkgdiwgc3RydWN0IG1waV9lY19jdHgg
KmVjKTsKKwl2b2lkICgqbXVsbSkoTVBJIHcsIE1QSSB1LCBNUEkgdiwgc3RydWN0IG1waV9lY19j
dHggKmN0eCk7CisJdm9pZCAoKnBvdzIpKE1QSSB3LCBjb25zdCBNUEkgYiwgc3RydWN0IG1waV9l
Y19jdHggKmN0eCk7CisJdm9pZCAoKm11bDIpKE1QSSB3LCBNUEkgdSwgc3RydWN0IG1waV9lY19j
dHggKmN0eCk7Cit9OworCit2b2lkIG1waV9lY19pbml0KHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgs
IGVudW0gZ2NyeV9tcGlfZWNfbW9kZWxzIG1vZGVsLAorCQkJZW51bSBlY2NfZGlhbGVjdHMgZGlh
bGVjdCwKKwkJCWludCBmbGFncywgTVBJIHAsIE1QSSBhLCBNUEkgYik7Cit2b2lkIG1waV9lY19k
ZWluaXQoc3RydWN0IG1waV9lY19jdHggKmN0eCk7CitNUElfUE9JTlQgbXBpX3BvaW50X25ldyh1
bnNpZ25lZCBpbnQgbmJpdHMpOwordm9pZCBtcGlfcG9pbnRfcmVsZWFzZShNUElfUE9JTlQgcCk7
Cit2b2lkIG1waV9wb2ludF9pbml0KE1QSV9QT0lOVCBwKTsKK3ZvaWQgbXBpX3BvaW50X2ZyZWVf
cGFydHMoTVBJX1BPSU5UIHApOworaW50IG1waV9lY19nZXRfYWZmaW5lKE1QSSB4LCBNUEkgeSwg
TVBJX1BPSU5UIHBvaW50LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KTsKK3ZvaWQgbXBpX2VjX2Fk
ZF9wb2ludHMoTVBJX1BPSU5UIHJlc3VsdCwKKwkJCU1QSV9QT0lOVCBwMSwgTVBJX1BPSU5UIHAy
LAorCQkJc3RydWN0IG1waV9lY19jdHggKmN0eCk7Cit2b2lkIG1waV9lY19tdWxfcG9pbnQoTVBJ
X1BPSU5UIHJlc3VsdCwKKwkJCU1QSSBzY2FsYXIsIE1QSV9QT0lOVCBwb2ludCwKKwkJCXN0cnVj
dCBtcGlfZWNfY3R4ICpjdHgpOworaW50IG1waV9lY19jdXJ2ZV9wb2ludChNUElfUE9JTlQgcG9p
bnQsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpOworCiAvKiBpbmxpbmUgZnVuY3Rpb25zICovCiAK
IC8qKgpkaWZmIC0tZ2l0IGEvbGliL21waS9NYWtlZmlsZSBiL2xpYi9tcGkvTWFrZWZpbGUKaW5k
ZXggNDc3ZGViZDdlZDUwLi42ZTZlZjlhMzRmZTEgMTAwNjQ0Ci0tLSBhL2xpYi9tcGkvTWFrZWZp
bGUKKysrIGIvbGliL21waS9NYWtlZmlsZQpAQCAtMTMsNiArMTMsNyBAQCBtcGkteSA9IFwKIAln
ZW5lcmljX21waWgtcnNoaWZ0Lm8JCVwKIAlnZW5lcmljX21waWgtc3ViMS5vCQlcCiAJZ2VuZXJp
Y19tcGloLWFkZDEubwkJXAorCWVjLm8JCQkJXAogCW1waWNvZGVyLm8JCQlcCiAJbXBpLWFkZC5v
CQkJXAogCW1waS1iaXQubwkJCVwKZGlmZiAtLWdpdCBhL2xpYi9tcGkvZWMuYyBiL2xpYi9tcGkv
ZWMuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLmMyMTQ3MDEyMmRm
YwotLS0gL2Rldi9udWxsCisrKyBiL2xpYi9tcGkvZWMuYwpAQCAtMCwwICsxLDE1MDkgQEAKKy8q
IGVjLmMgLSAgRWxsaXB0aWMgQ3VydmUgZnVuY3Rpb25zCisgKiBDb3B5cmlnaHQgKEMpIDIwMDcg
RnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuCisgKiBDb3B5cmlnaHQgKEMpIDIwMTMgZzEw
IENvZGUgR21iSAorICoKKyAqIFRoaXMgZmlsZSBpcyBwYXJ0IG9mIExpYmdjcnlwdC4KKyAqCisg
KiBMaWJnY3J5cHQgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5k
L29yIG1vZGlmeQorICogaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVy
YWwgUHVibGljIExpY2Vuc2UgYXMKKyAqIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBG
b3VuZGF0aW9uOyBlaXRoZXIgdmVyc2lvbiAyLjEgb2YKKyAqIHRoZSBMaWNlbnNlLCBvciAoYXQg
eW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLgorICoKKyAqIExpYmdjcnlwdCBpcyBkaXN0
cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAorICogYnV0IFdJVEhP
VVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YKKyAq
IE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNl
ZSB0aGUKKyAqIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRh
aWxzLgorICoKKyAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBM
ZXNzZXIgR2VuZXJhbCBQdWJsaWMKKyAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIHByb2dyYW07
IGlmIG5vdCwgc2VlIDxodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvPi4KKyAqLworCisjaW5j
bHVkZSAibXBpLWludGVybmFsLmgiCisjaW5jbHVkZSAibG9uZ2xvbmcuaCIKKworI2RlZmluZSBw
b2ludF9pbml0KGEpICBtcGlfcG9pbnRfaW5pdCgoYSkpCisjZGVmaW5lIHBvaW50X2ZyZWUoYSkg
IG1waV9wb2ludF9mcmVlX3BhcnRzKChhKSkKKworI2RlZmluZSBsb2dfZXJyb3IoZm10LCAuLi4p
IHByX2VycihmbXQsICMjX19WQV9BUkdTX18pCisjZGVmaW5lIGxvZ19mYXRhbChmbXQsIC4uLikg
cHJfZXJyKGZtdCwgIyNfX1ZBX0FSR1NfXykKKworI2RlZmluZSBESU0odikgKHNpemVvZih2KS9z
aXplb2YoKHYpWzBdKSkKKworCisvKiBDcmVhdGUgYSBuZXcgcG9pbnQgb3B0aW9uLiAgTkJJVFMg
Z2l2ZXMgdGhlIHNpemUgaW4gYml0cyBvZiBvbmUKKyAqIGNvb3JkaW5hdGU7IGl0IGlzIG9ubHkg
dXNlZCB0byBwcmUtYWxsb2NhdGUgc29tZSByZXNvdXJjZXMgYW5kCisgKiBtaWdodCBhbHNvIGJl
IHBhc3NlZCBhcyAwIHRvIHVzZSBhIGRlZmF1bHQgdmFsdWUuCisgKi8KK01QSV9QT0lOVCBtcGlf
cG9pbnRfbmV3KHVuc2lnbmVkIGludCBuYml0cykKK3sKKwlNUElfUE9JTlQgcDsKKworCSh2b2lk
KW5iaXRzOyAgLyogQ3VycmVudGx5IG5vdCB1c2VkLiAgKi8KKworCXAgPSBrbWFsbG9jKHNpemVv
ZigqcCksIEdGUF9LRVJORUwpOworCWlmIChwKQorCQltcGlfcG9pbnRfaW5pdChwKTsKKwlyZXR1
cm4gcDsKK30KK0VYUE9SVF9TWU1CT0xfR1BMKG1waV9wb2ludF9uZXcpOworCisvKiBSZWxlYXNl
IHRoZSBwb2ludCBvYmplY3QgUC4gIFAgbWF5IGJlIE5VTEwuICovCit2b2lkIG1waV9wb2ludF9y
ZWxlYXNlKE1QSV9QT0lOVCBwKQoreworCWlmIChwKSB7CisJCW1waV9wb2ludF9mcmVlX3BhcnRz
KHApOworCQlrZnJlZShwKTsKKwl9Cit9CitFWFBPUlRfU1lNQk9MX0dQTChtcGlfcG9pbnRfcmVs
ZWFzZSk7CisKKy8qIEluaXRpYWxpemUgdGhlIGZpZWxkcyBvZiBhIHBvaW50IG9iamVjdC4gIGdj
cnlfbXBpX3BvaW50X2ZyZWVfcGFydHMKKyAqIG1heSBiZSB1c2VkIHRvIHJlbGVhc2UgdGhlIGZp
ZWxkcy4KKyAqLwordm9pZCBtcGlfcG9pbnRfaW5pdChNUElfUE9JTlQgcCkKK3sKKwlwLT54ID0g
bXBpX25ldygwKTsKKwlwLT55ID0gbXBpX25ldygwKTsKKwlwLT56ID0gbXBpX25ldygwKTsKK30K
K0VYUE9SVF9TWU1CT0xfR1BMKG1waV9wb2ludF9pbml0KTsKKworLyogUmVsZWFzZSB0aGUgcGFy
dHMgb2YgYSBwb2ludCBvYmplY3QuICovCit2b2lkIG1waV9wb2ludF9mcmVlX3BhcnRzKE1QSV9Q
T0lOVCBwKQoreworCW1waV9mcmVlKHAtPngpOyBwLT54ID0gTlVMTDsKKwltcGlfZnJlZShwLT55
KTsgcC0+eSA9IE5VTEw7CisJbXBpX2ZyZWUocC0+eik7IHAtPnogPSBOVUxMOworfQorRVhQT1JU
X1NZTUJPTF9HUEwobXBpX3BvaW50X2ZyZWVfcGFydHMpOworCisvKiBTZXQgdGhlIHZhbHVlIGZy
b20gUyBpbnRvIEQuICAqLworc3RhdGljIHZvaWQgcG9pbnRfc2V0KE1QSV9QT0lOVCBkLCBNUElf
UE9JTlQgcykKK3sKKwltcGlfc2V0KGQtPngsIHMtPngpOworCW1waV9zZXQoZC0+eSwgcy0+eSk7
CisJbXBpX3NldChkLT56LCBzLT56KTsKK30KKworc3RhdGljIHZvaWQgcG9pbnRfcmVzaXplKE1Q
SV9QT0lOVCBwLCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCXNpemVfdCBubGltYnMgPSBj
dHgtPnAtPm5saW1iczsKKworCW1waV9yZXNpemUocC0+eCwgbmxpbWJzKTsKKwlwLT54LT5ubGlt
YnMgPSBubGltYnM7CisJbXBpX3Jlc2l6ZShwLT56LCBubGltYnMpOworCXAtPnotPm5saW1icyA9
IG5saW1iczsKKworCWlmIChjdHgtPm1vZGVsICE9IE1QSV9FQ19NT05UR09NRVJZKSB7CisJCW1w
aV9yZXNpemUocC0+eSwgbmxpbWJzKTsKKwkJcC0+eS0+bmxpbWJzID0gbmxpbWJzOworCX0KK30K
Kworc3RhdGljIHZvaWQgcG9pbnRfc3dhcF9jb25kKE1QSV9QT0lOVCBkLCBNUElfUE9JTlQgcywg
dW5zaWduZWQgbG9uZyBzd2FwLAorCQlzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCW1waV9z
d2FwX2NvbmQoZC0+eCwgcy0+eCwgc3dhcCk7CisJaWYgKGN0eC0+bW9kZWwgIT0gTVBJX0VDX01P
TlRHT01FUlkpCisJCW1waV9zd2FwX2NvbmQoZC0+eSwgcy0+eSwgc3dhcCk7CisJbXBpX3N3YXBf
Y29uZChkLT56LCBzLT56LCBzd2FwKTsKK30KKworCisvKiBXID0gVyBtb2QgUC4gICovCitzdGF0
aWMgdm9pZCBlY19tb2QoTVBJIHcsIHN0cnVjdCBtcGlfZWNfY3R4ICplYykKK3sKKwlpZiAoZWMt
PnQucF9iYXJyZXR0KQorCQltcGlfbW9kX2JhcnJldHQodywgdywgZWMtPnQucF9iYXJyZXR0KTsK
KwllbHNlCisJCW1waV9tb2QodywgdywgZWMtPnApOworfQorCitzdGF0aWMgdm9pZCBlY19hZGRt
KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX2Fk
ZCh3LCB1LCB2KTsKKwllY19tb2QodywgY3R4KTsKK30KKworc3RhdGljIHZvaWQgZWNfc3VibShN
UEkgdywgTVBJIHUsIE1QSSB2LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqZWMpCit7CisJbXBpX3N1Yih3
LCB1LCB2KTsKKwl3aGlsZSAody0+c2lnbikKKwkJbXBpX2FkZCh3LCB3LCBlYy0+cCk7CisJLypl
Y19tb2QodywgZWMpOyovCit9CisKK3N0YXRpYyB2b2lkIGVjX211bG0oTVBJIHcsIE1QSSB1LCBN
UEkgdiwgc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwltcGlfbXVsKHcsIHUsIHYpOworCWVj
X21vZCh3LCBjdHgpOworfQorCisvKiBXID0gMiAqIFUgbW9kIFAuICAqLworc3RhdGljIHZvaWQg
ZWNfbXVsMihNUEkgdywgTVBJIHUsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX2xz
aGlmdCh3LCB1LCAxKTsKKwllY19tb2QodywgY3R4KTsKK30KKworc3RhdGljIHZvaWQgZWNfcG93
bShNUEkgdywgY29uc3QgTVBJIGIsIGNvbnN0IE1QSSBlLAorCQlzdHJ1Y3QgbXBpX2VjX2N0eCAq
Y3R4KQoreworCW1waV9wb3dtKHcsIGIsIGUsIGN0eC0+cCk7CisJLyogbXBpX2Ficyh3KTsgKi8K
K30KKworLyogU2hvcnRjdXQgZm9yCisgKiBlY19wb3dtKEIsIEIsIG1waV9jb25zdChNUElfQ19U
V08pLCBjdHgpOworICogZm9yIGVhc2llciBvcHRpbWl6YXRpb24uCisgKi8KK3N0YXRpYyB2b2lk
IGVjX3BvdzIoTVBJIHcsIGNvbnN0IE1QSSBiLCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQorewor
CS8qIFVzaW5nIG1waV9tdWwgaXMgc2xpZ2h0bHkgZmFzdGVyIChhdCBsZWFzdCBvbiBhbWQ2NCku
ICAqLworCS8qIG1waV9wb3dtKHcsIGIsIG1waV9jb25zdChNUElfQ19UV08pLCBjdHgtPnApOyAq
LworCWVjX211bG0odywgYiwgYiwgY3R4KTsKK30KKworLyogU2hvcnRjdXQgZm9yCisgKiBlY19w
b3dtKEIsIEIsIG1waV9jb25zdChNUElfQ19USFJFRSksIGN0eCk7CisgKiBmb3IgZWFzaWVyIG9w
dGltaXphdGlvbi4KKyAqLworc3RhdGljIHZvaWQgZWNfcG93MyhNUEkgdywgY29uc3QgTVBJIGIs
IHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX3Bvd20odywgYiwgbXBpX2NvbnN0KE1Q
SV9DX1RIUkVFKSwgY3R4LT5wKTsKK30KKworc3RhdGljIHZvaWQgZWNfaW52bShNUEkgeCwgTVBJ
IGEsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJaWYgKCFtcGlfaW52bSh4LCBhLCBjdHgt
PnApKQorCQlsb2dfZXJyb3IoImVjX2ludm06IGludmVyc2UgZG9lcyBub3QgZXhpc3Q6XG4iKTsK
K30KKworc3RhdGljIHZvaWQgbXBpaF9zZXRfY29uZChtcGlfcHRyX3Qgd3AsIG1waV9wdHJfdCB1
cCwKKwkJbXBpX3NpemVfdCB1c2l6ZSwgdW5zaWduZWQgbG9uZyBzZXQpCit7CisJbXBpX3NpemVf
dCBpOworCW1waV9saW1iX3QgbWFzayA9ICgobXBpX2xpbWJfdCkwKSAtIHNldDsKKwltcGlfbGlt
Yl90IHg7CisKKwlmb3IgKGkgPSAwOyBpIDwgdXNpemU7IGkrKykgeworCQl4ID0gbWFzayAmICh3
cFtpXSBeIHVwW2ldKTsKKwkJd3BbaV0gPSB3cFtpXSBeIHg7CisJfQorfQorCisvKiBSb3V0aW5l
cyBmb3IgMl4yNTUgLSAxOS4gICovCisKKyNkZWZpbmUgTElNQl9TSVpFXzI1NTE5ICgoMjU2K0JJ
VFNfUEVSX01QSV9MSU1CLTEpL0JJVFNfUEVSX01QSV9MSU1CKQorCitzdGF0aWMgdm9pZCBlY19h
ZGRtXzI1NTE5KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7
CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJbXBpX3NpemVfdCB3c2l6ZSA9IExJTUJfU0laRV8y
NTUxOTsKKwltcGlfbGltYl90IG5bTElNQl9TSVpFXzI1NTE5XTsKKwltcGlfbGltYl90IGJvcnJv
dzsKKworCWlmICh3LT5ubGltYnMgIT0gd3NpemUgfHwgdS0+bmxpbWJzICE9IHdzaXplIHx8IHYt
Pm5saW1icyAhPSB3c2l6ZSkKKwkJbG9nX2J1ZygiYWRkbV8yNTUxOTogZGlmZmVyZW50IHNpemVz
XG4iKTsKKworCW1lbXNldChuLCAwLCBzaXplb2YobikpOworCXVwID0gdS0+ZDsKKwl2cCA9IHYt
PmQ7CisJd3AgPSB3LT5kOworCisJbXBpaGVscF9hZGRfbih3cCwgdXAsIHZwLCB3c2l6ZSk7CisJ
Ym9ycm93ID0gbXBpaGVscF9zdWJfbih3cCwgd3AsIGN0eC0+cC0+ZCwgd3NpemUpOworCW1waWhf
c2V0X2NvbmQobiwgY3R4LT5wLT5kLCB3c2l6ZSwgKGJvcnJvdyAhPSAwVUwpKTsKKwltcGloZWxw
X2FkZF9uKHdwLCB3cCwgbiwgd3NpemUpOworCXdwW0xJTUJfU0laRV8yNTUxOS0xXSAmPSB+KCht
cGlfbGltYl90KTEgPDwgKDI1NSAlIEJJVFNfUEVSX01QSV9MSU1CKSk7Cit9CisKK3N0YXRpYyB2
b2lkIGVjX3N1Ym1fMjU1MTkoTVBJIHcsIE1QSSB1LCBNUEkgdiwgc3RydWN0IG1waV9lY19jdHgg
KmN0eCkKK3sKKwltcGlfcHRyX3Qgd3AsIHVwLCB2cDsKKwltcGlfc2l6ZV90IHdzaXplID0gTElN
Ql9TSVpFXzI1NTE5OworCW1waV9saW1iX3QgbltMSU1CX1NJWkVfMjU1MTldOworCW1waV9saW1i
X3QgYm9ycm93OworCisJaWYgKHctPm5saW1icyAhPSB3c2l6ZSB8fCB1LT5ubGltYnMgIT0gd3Np
emUgfHwgdi0+bmxpbWJzICE9IHdzaXplKQorCQlsb2dfYnVnKCJzdWJtXzI1NTE5OiBkaWZmZXJl
bnQgc2l6ZXNcbiIpOworCisJbWVtc2V0KG4sIDAsIHNpemVvZihuKSk7CisJdXAgPSB1LT5kOwor
CXZwID0gdi0+ZDsKKwl3cCA9IHctPmQ7CisKKwlib3Jyb3cgPSBtcGloZWxwX3N1Yl9uKHdwLCB1
cCwgdnAsIHdzaXplKTsKKwltcGloX3NldF9jb25kKG4sIGN0eC0+cC0+ZCwgd3NpemUsIChib3Jy
b3cgIT0gMFVMKSk7CisJbXBpaGVscF9hZGRfbih3cCwgd3AsIG4sIHdzaXplKTsKKwl3cFtMSU1C
X1NJWkVfMjU1MTktMV0gJj0gfigobXBpX2xpbWJfdCkxIDw8ICgyNTUgJSBCSVRTX1BFUl9NUElf
TElNQikpOworfQorCitzdGF0aWMgdm9pZCBlY19tdWxtXzI1NTE5KE1QSSB3LCBNUEkgdSwgTVBJ
IHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJ
bXBpX3NpemVfdCB3c2l6ZSA9IExJTUJfU0laRV8yNTUxOTsKKwltcGlfbGltYl90IG5bTElNQl9T
SVpFXzI1NTE5KjJdOworCW1waV9saW1iX3QgbVtMSU1CX1NJWkVfMjU1MTkrMV07CisJbXBpX2xp
bWJfdCBjeTsKKwlpbnQgbXNiOworCisJKHZvaWQpY3R4OworCWlmICh3LT5ubGltYnMgIT0gd3Np
emUgfHwgdS0+bmxpbWJzICE9IHdzaXplIHx8IHYtPm5saW1icyAhPSB3c2l6ZSkKKwkJbG9nX2J1
ZygibXVsbV8yNTUxOTogZGlmZmVyZW50IHNpemVzXG4iKTsKKworCXVwID0gdS0+ZDsKKwl2cCA9
IHYtPmQ7CisJd3AgPSB3LT5kOworCisJbXBpaGVscF9tdWxfbihuLCB1cCwgdnAsIHdzaXplKTsK
KwltZW1jcHkod3AsIG4sIHdzaXplICogQllURVNfUEVSX01QSV9MSU1CKTsKKwl3cFtMSU1CX1NJ
WkVfMjU1MTktMV0gJj0gfigobXBpX2xpbWJfdCkxIDw8ICgyNTUgJSBCSVRTX1BFUl9NUElfTElN
QikpOworCisJbWVtY3B5KG0sIG4rTElNQl9TSVpFXzI1NTE5LTEsICh3c2l6ZSsxKSAqIEJZVEVT
X1BFUl9NUElfTElNQik7CisJbXBpaGVscF9yc2hpZnQobSwgbSwgTElNQl9TSVpFXzI1NTE5KzEs
ICgyNTUgJSBCSVRTX1BFUl9NUElfTElNQikpOworCisJbWVtY3B5KG4sIG0sIHdzaXplICogQllU
RVNfUEVSX01QSV9MSU1CKTsKKwljeSA9IG1waWhlbHBfbHNoaWZ0KG0sIG0sIExJTUJfU0laRV8y
NTUxOSwgNCk7CisJbVtMSU1CX1NJWkVfMjU1MTldID0gY3k7CisJY3kgPSBtcGloZWxwX2FkZF9u
KG0sIG0sIG4sIHdzaXplKTsKKwltW0xJTUJfU0laRV8yNTUxOV0gKz0gY3k7CisJY3kgPSBtcGlo
ZWxwX2FkZF9uKG0sIG0sIG4sIHdzaXplKTsKKwltW0xJTUJfU0laRV8yNTUxOV0gKz0gY3k7CisJ
Y3kgPSBtcGloZWxwX2FkZF9uKG0sIG0sIG4sIHdzaXplKTsKKwltW0xJTUJfU0laRV8yNTUxOV0g
Kz0gY3k7CisKKwljeSA9IG1waWhlbHBfYWRkX24od3AsIHdwLCBtLCB3c2l6ZSk7CisJbVtMSU1C
X1NJWkVfMjU1MTldICs9IGN5OworCisJbWVtc2V0KG0sIDAsIHdzaXplICogQllURVNfUEVSX01Q
SV9MSU1CKTsKKwltc2IgPSAod3BbTElNQl9TSVpFXzI1NTE5LTFdID4+ICgyNTUgJSBCSVRTX1BF
Ul9NUElfTElNQikpOworCW1bMF0gPSAobVtMSU1CX1NJWkVfMjU1MTldICogMiArIG1zYikgKiAx
OTsKKwl3cFtMSU1CX1NJWkVfMjU1MTktMV0gJj0gfigobXBpX2xpbWJfdCkxIDw8ICgyNTUgJSBC
SVRTX1BFUl9NUElfTElNQikpOworCW1waWhlbHBfYWRkX24od3AsIHdwLCBtLCB3c2l6ZSk7CisK
KwltWzBdID0gMDsKKwljeSA9IG1waWhlbHBfc3ViX24od3AsIHdwLCBjdHgtPnAtPmQsIHdzaXpl
KTsKKwltcGloX3NldF9jb25kKG0sIGN0eC0+cC0+ZCwgd3NpemUsIChjeSAhPSAwVUwpKTsKKwlt
cGloZWxwX2FkZF9uKHdwLCB3cCwgbSwgd3NpemUpOworfQorCitzdGF0aWMgdm9pZCBlY19tdWwy
XzI1NTE5KE1QSSB3LCBNUEkgdSwgc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwllY19hZGRt
XzI1NTE5KHcsIHUsIHUsIGN0eCk7Cit9CisKK3N0YXRpYyB2b2lkIGVjX3BvdzJfMjU1MTkoTVBJ
IHcsIGNvbnN0IE1QSSBiLCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworCWVjX211bG1fMjU1
MTkodywgYiwgYiwgY3R4KTsKK30KKworLyogUm91dGluZXMgZm9yIDJeNDQ4IC0gMl4yMjQgLSAx
LiAgKi8KKworI2RlZmluZSBMSU1CX1NJWkVfNDQ4ICgoNDQ4K0JJVFNfUEVSX01QSV9MSU1CLTEp
L0JJVFNfUEVSX01QSV9MSU1CKQorI2RlZmluZSBMSU1CX1NJWkVfSEFMRl80NDggKChMSU1CX1NJ
WkVfNDQ4KzEpLzIpCisKK3N0YXRpYyB2b2lkIGVjX2FkZG1fNDQ4KE1QSSB3LCBNUEkgdSwgTVBJ
IHYsIHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJ
bXBpX3NpemVfdCB3c2l6ZSA9IExJTUJfU0laRV80NDg7CisJbXBpX2xpbWJfdCBuW0xJTUJfU0la
RV80NDhdOworCW1waV9saW1iX3QgY3k7CisKKwlpZiAody0+bmxpbWJzICE9IHdzaXplIHx8IHUt
Pm5saW1icyAhPSB3c2l6ZSB8fCB2LT5ubGltYnMgIT0gd3NpemUpCisJCWxvZ19idWcoImFkZG1f
NDQ4OiBkaWZmZXJlbnQgc2l6ZXNcbiIpOworCisJbWVtc2V0KG4sIDAsIHNpemVvZihuKSk7CisJ
dXAgPSB1LT5kOworCXZwID0gdi0+ZDsKKwl3cCA9IHctPmQ7CisKKwljeSA9IG1waWhlbHBfYWRk
X24od3AsIHVwLCB2cCwgd3NpemUpOworCW1waWhfc2V0X2NvbmQobiwgY3R4LT5wLT5kLCB3c2l6
ZSwgKGN5ICE9IDBVTCkpOworCW1waWhlbHBfc3ViX24od3AsIHdwLCBuLCB3c2l6ZSk7Cit9CisK
K3N0YXRpYyB2b2lkIGVjX3N1Ym1fNDQ4KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlf
ZWNfY3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJbXBpX3NpemVfdCB3c2l6
ZSA9IExJTUJfU0laRV80NDg7CisJbXBpX2xpbWJfdCBuW0xJTUJfU0laRV80NDhdOworCW1waV9s
aW1iX3QgYm9ycm93OworCisJaWYgKHctPm5saW1icyAhPSB3c2l6ZSB8fCB1LT5ubGltYnMgIT0g
d3NpemUgfHwgdi0+bmxpbWJzICE9IHdzaXplKQorCQlsb2dfYnVnKCJzdWJtXzQ0ODogZGlmZmVy
ZW50IHNpemVzXG4iKTsKKworCW1lbXNldChuLCAwLCBzaXplb2YobikpOworCXVwID0gdS0+ZDsK
Kwl2cCA9IHYtPmQ7CisJd3AgPSB3LT5kOworCisJYm9ycm93ID0gbXBpaGVscF9zdWJfbih3cCwg
dXAsIHZwLCB3c2l6ZSk7CisJbXBpaF9zZXRfY29uZChuLCBjdHgtPnAtPmQsIHdzaXplLCAoYm9y
cm93ICE9IDBVTCkpOworCW1waWhlbHBfYWRkX24od3AsIHdwLCBuLCB3c2l6ZSk7Cit9CisKK3N0
YXRpYyB2b2lkIGVjX211bG1fNDQ4KE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBtcGlfZWNf
Y3R4ICpjdHgpCit7CisJbXBpX3B0cl90IHdwLCB1cCwgdnA7CisJbXBpX3NpemVfdCB3c2l6ZSA9
IExJTUJfU0laRV80NDg7CisJbXBpX2xpbWJfdCBuW0xJTUJfU0laRV80NDgqMl07CisJbXBpX2xp
bWJfdCBhMltMSU1CX1NJWkVfSEFMRl80NDhdOworCW1waV9saW1iX3QgYTNbTElNQl9TSVpFX0hB
TEZfNDQ4XTsKKwltcGlfbGltYl90IGIwW0xJTUJfU0laRV9IQUxGXzQ0OF07CisJbXBpX2xpbWJf
dCBiMVtMSU1CX1NJWkVfSEFMRl80NDhdOworCW1waV9saW1iX3QgY3k7CisJaW50IGk7CisjaWYg
KExJTUJfU0laRV9IQUxGXzQ0OCA+IExJTUJfU0laRV80NDgvMikKKwltcGlfbGltYl90IGIxX3Jl
c3QsIGEzX3Jlc3Q7CisjZW5kaWYKKworCWlmICh3LT5ubGltYnMgIT0gd3NpemUgfHwgdS0+bmxp
bWJzICE9IHdzaXplIHx8IHYtPm5saW1icyAhPSB3c2l6ZSkKKwkJbG9nX2J1ZygibXVsbV80NDg6
IGRpZmZlcmVudCBzaXplc1xuIik7CisKKwl1cCA9IHUtPmQ7CisJdnAgPSB2LT5kOworCXdwID0g
dy0+ZDsKKworCW1waWhlbHBfbXVsX24obiwgdXAsIHZwLCB3c2l6ZSk7CisKKwlmb3IgKGkgPSAw
OyBpIDwgKHdzaXplICsgMSkgLyAyOyBpKyspIHsKKwkJYjBbaV0gPSBuW2ldOworCQliMVtpXSA9
IG5baSt3c2l6ZS8yXTsKKwkJYTJbaV0gPSBuW2krd3NpemVdOworCQlhM1tpXSA9IG5baSt3c2l6
ZSt3c2l6ZS8yXTsKKwl9CisKKyNpZiAoTElNQl9TSVpFX0hBTEZfNDQ4ID4gTElNQl9TSVpFXzQ0
OC8yKQorCWIwW0xJTUJfU0laRV9IQUxGXzQ0OC0xXSAmPSAoKG1waV9saW1iX3QpMVVMIDw8IDMy
KS0xOworCWEyW0xJTUJfU0laRV9IQUxGXzQ0OC0xXSAmPSAoKG1waV9saW1iX3QpMVVMIDw8IDMy
KS0xOworCisJYjFfcmVzdCA9IDA7CisJYTNfcmVzdCA9IDA7CisKKwlmb3IgKGkgPSAod3NpemUg
KyAxKSAvIDIgLSAxOyBpID49IDA7IGktLSkgeworCQltcGlfbGltYl90IGIxdiwgYTN2OworCQli
MXYgPSBiMVtpXTsKKwkJYTN2ID0gYTNbaV07CisJCWIxW2ldID0gKGIxX3Jlc3QgPDwgMzIpIHwg
KGIxdiA+PiAzMik7CisJCWEzW2ldID0gKGEzX3Jlc3QgPDwgMzIpIHwgKGEzdiA+PiAzMik7CisJ
CWIxX3Jlc3QgPSBiMXYgJiAoKChtcGlfbGltYl90KTFVTCA8PCAzMiktMSk7CisJCWEzX3Jlc3Qg
PSBhM3YgJiAoKChtcGlfbGltYl90KTFVTCA8PCAzMiktMSk7CisJfQorI2VuZGlmCisKKwljeSA9
IG1waWhlbHBfYWRkX24oYjAsIGIwLCBhMiwgTElNQl9TSVpFX0hBTEZfNDQ4KTsKKwljeSArPSBt
cGloZWxwX2FkZF9uKGIwLCBiMCwgYTMsIExJTUJfU0laRV9IQUxGXzQ0OCk7CisJZm9yIChpID0g
MDsgaSA8ICh3c2l6ZSArIDEpIC8gMjsgaSsrKQorCQl3cFtpXSA9IGIwW2ldOworI2lmIChMSU1C
X1NJWkVfSEFMRl80NDggPiBMSU1CX1NJWkVfNDQ4LzIpCisJd3BbTElNQl9TSVpFX0hBTEZfNDQ4
LTFdICY9ICgoKG1waV9saW1iX3QpMVVMIDw8IDMyKS0xKTsKKyNlbmRpZgorCisjaWYgKExJTUJf
U0laRV9IQUxGXzQ0OCA+IExJTUJfU0laRV80NDgvMikKKwljeSA9IGIwW0xJTUJfU0laRV9IQUxG
XzQ0OC0xXSA+PiAzMjsKKyNlbmRpZgorCisJY3kgPSBtcGloZWxwX2FkZF8xKGIxLCBiMSwgTElN
Ql9TSVpFX0hBTEZfNDQ4LCBjeSk7CisJY3kgKz0gbXBpaGVscF9hZGRfbihiMSwgYjEsIGEyLCBM
SU1CX1NJWkVfSEFMRl80NDgpOworCWN5ICs9IG1waWhlbHBfYWRkX24oYjEsIGIxLCBhMywgTElN
Ql9TSVpFX0hBTEZfNDQ4KTsKKwljeSArPSBtcGloZWxwX2FkZF9uKGIxLCBiMSwgYTMsIExJTUJf
U0laRV9IQUxGXzQ0OCk7CisjaWYgKExJTUJfU0laRV9IQUxGXzQ0OCA+IExJTUJfU0laRV80NDgv
MikKKwliMV9yZXN0ID0gMDsKKwlmb3IgKGkgPSAod3NpemUgKyAxKSAvIDIgLSAxOyBpID49IDA7
IGktLSkgeworCQltcGlfbGltYl90IGIxdiA9IGIxW2ldOworCQliMVtpXSA9IChiMV9yZXN0IDw8
IDMyKSB8IChiMXYgPj4gMzIpOworCQliMV9yZXN0ID0gYjF2ICYgKCgobXBpX2xpbWJfdCkxVUwg
PDwgMzIpLTEpOworCX0KKwl3cFtMSU1CX1NJWkVfSEFMRl80NDgtMV0gfD0gKGIxX3Jlc3QgPDwg
MzIpOworI2VuZGlmCisJZm9yIChpID0gMDsgaSA8IHdzaXplIC8gMjsgaSsrKQorCQl3cFtpKyh3
c2l6ZSArIDEpIC8gMl0gPSBiMVtpXTsKKworI2lmIChMSU1CX1NJWkVfSEFMRl80NDggPiBMSU1C
X1NJWkVfNDQ4LzIpCisJY3kgPSBiMVtMSU1CX1NJWkVfSEFMRl80NDgtMV07CisjZW5kaWYKKwor
CW1lbXNldChuLCAwLCB3c2l6ZSAqIEJZVEVTX1BFUl9NUElfTElNQik7CisKKyNpZiAoTElNQl9T
SVpFX0hBTEZfNDQ4ID4gTElNQl9TSVpFXzQ0OC8yKQorCW5bTElNQl9TSVpFX0hBTEZfNDQ4LTFd
ID0gY3kgPDwgMzI7CisjZWxzZQorCW5bTElNQl9TSVpFX0hBTEZfNDQ4XSA9IGN5OworI2VuZGlm
CisJblswXSA9IGN5OworCW1waWhlbHBfYWRkX24od3AsIHdwLCBuLCB3c2l6ZSk7CisKKwltZW1z
ZXQobiwgMCwgd3NpemUgKiBCWVRFU19QRVJfTVBJX0xJTUIpOworCWN5ID0gbXBpaGVscF9zdWJf
bih3cCwgd3AsIGN0eC0+cC0+ZCwgd3NpemUpOworCW1waWhfc2V0X2NvbmQobiwgY3R4LT5wLT5k
LCB3c2l6ZSwgKGN5ICE9IDBVTCkpOworCW1waWhlbHBfYWRkX24od3AsIHdwLCBuLCB3c2l6ZSk7
Cit9CisKK3N0YXRpYyB2b2lkIGVjX211bDJfNDQ4KE1QSSB3LCBNUEkgdSwgc3RydWN0IG1waV9l
Y19jdHggKmN0eCkKK3sKKwllY19hZGRtXzQ0OCh3LCB1LCB1LCBjdHgpOworfQorCitzdGF0aWMg
dm9pZCBlY19wb3cyXzQ0OChNUEkgdywgY29uc3QgTVBJIGIsIHN0cnVjdCBtcGlfZWNfY3R4ICpj
dHgpCit7CisJZWNfbXVsbV80NDgodywgYiwgYiwgY3R4KTsKK30KKworc3RydWN0IGZpZWxkX3Rh
YmxlIHsKKwljb25zdCBjaGFyICpwOworCisJLyogY29tcHV0YXRpb24gcm91dGluZXMgZm9yIHRo
ZSBmaWVsZC4gICovCisJdm9pZCAoKmFkZG0pKE1QSSB3LCBNUEkgdSwgTVBJIHYsIHN0cnVjdCBt
cGlfZWNfY3R4ICpjdHgpOworCXZvaWQgKCpzdWJtKShNUEkgdywgTVBJIHUsIE1QSSB2LCBzdHJ1
Y3QgbXBpX2VjX2N0eCAqY3R4KTsKKwl2b2lkICgqbXVsbSkoTVBJIHcsIE1QSSB1LCBNUEkgdiwg
c3RydWN0IG1waV9lY19jdHggKmN0eCk7CisJdm9pZCAoKm11bDIpKE1QSSB3LCBNUEkgdSwgc3Ry
dWN0IG1waV9lY19jdHggKmN0eCk7CisJdm9pZCAoKnBvdzIpKE1QSSB3LCBjb25zdCBNUEkgYiwg
c3RydWN0IG1waV9lY19jdHggKmN0eCk7Cit9OworCitzdGF0aWMgY29uc3Qgc3RydWN0IGZpZWxk
X3RhYmxlIGZpZWxkX3RhYmxlW10gPSB7CisJeworCQkiMHg3RkZGRkZGRkZGRkZGRkZGRkZGRkZG
RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkVEIiwKKwkJZWNfYWRkbV8y
NTUxOSwKKwkJZWNfc3VibV8yNTUxOSwKKwkJZWNfbXVsbV8yNTUxOSwKKwkJZWNfbXVsMl8yNTUx
OSwKKwkJZWNfcG93Ml8yNTUxOQorCX0sCisJeworCQkiMHhGRkZGRkZGRkZGRkZGRkZGRkZGRkZG
RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRSIKKwkJIkZGRkZGRkZGRkZGRkZGRkZG
RkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGIiwKKwkJZWNfYWRkbV80NDgs
CisJCWVjX3N1Ym1fNDQ4LAorCQllY19tdWxtXzQ0OCwKKwkJZWNfbXVsMl80NDgsCisJCWVjX3Bv
dzJfNDQ4CisJfSwKKwl7IE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwgfSwKK307
CisKKy8qIEZvcmNlIHJlY29tcHV0YXRpb24gb2YgYWxsIGhlbHBlciB2YXJpYWJsZXMuICAqLwor
c3RhdGljIHZvaWQgbXBpX2VjX2dldF9yZXNldChzdHJ1Y3QgbXBpX2VjX2N0eCAqZWMpCit7CisJ
ZWMtPnQudmFsaWQuYV9pc19wbWludXMzID0gMDsKKwllYy0+dC52YWxpZC50d29faW52X3AgPSAw
OworfQorCisvKiBBY2Nlc3NvciBmb3IgaGVscGVyIHZhcmlhYmxlLiAgKi8KK3N0YXRpYyBpbnQg
ZWNfZ2V0X2FfaXNfcG1pbnVzMyhzdHJ1Y3QgbXBpX2VjX2N0eCAqZWMpCit7CisJTVBJIHRtcDsK
KworCWlmICghZWMtPnQudmFsaWQuYV9pc19wbWludXMzKSB7CisJCWVjLT50LnZhbGlkLmFfaXNf
cG1pbnVzMyA9IDE7CisJCXRtcCA9IG1waV9hbGxvY19saWtlKGVjLT5wKTsKKwkJbXBpX3N1Yl91
aSh0bXAsIGVjLT5wLCAzKTsKKwkJZWMtPnQuYV9pc19wbWludXMzID0gIW1waV9jbXAoZWMtPmEs
IHRtcCk7CisJCW1waV9mcmVlKHRtcCk7CisJfQorCisJcmV0dXJuIGVjLT50LmFfaXNfcG1pbnVz
MzsKK30KKworLyogQWNjZXNzb3IgZm9yIGhlbHBlciB2YXJpYWJsZS4gICovCitzdGF0aWMgTVBJ
IGVjX2dldF90d29faW52X3Aoc3RydWN0IG1waV9lY19jdHggKmVjKQoreworCWlmICghZWMtPnQu
dmFsaWQudHdvX2ludl9wKSB7CisJCWVjLT50LnZhbGlkLnR3b19pbnZfcCA9IDE7CisJCWlmICgh
ZWMtPnQudHdvX2ludl9wKQorCQkJZWMtPnQudHdvX2ludl9wID0gbXBpX2FsbG9jKDApOworCQll
Y19pbnZtKGVjLT50LnR3b19pbnZfcCwgbXBpX2NvbnN0KE1QSV9DX1RXTyksIGVjKTsKKwl9CisJ
cmV0dXJuIGVjLT50LnR3b19pbnZfcDsKK30KKworc3RhdGljIGNvbnN0IGNoYXIgKmNvbnN0IGN1
cnZlMjU1MTlfYmFkX3BvaW50c1tdID0geworCSIweDdmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZWQiLAorCSIweDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiLAor
CSIweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDEiLAorCSIweDAwYjg0OTVmMTYwNTYyODZmZGIxMzI5Y2ViOGQwOWRhNmFjNDlm
ZjFmYWUzNTYxNmFlYjg0MTNiN2M3YWViZTAiLAorCSIweDU3MTE5ZmQwZGQ0ZTIyZDg4NjhlMWM1
OGM0NWM0NDA0NWJlZjgzOWM1NWIxZDBiMTI0OGM1MGEzYmM5NTljNWYiLAorCSIweDdmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZWMi
LAorCSIweDdmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZWUiLAorCU5VTEwKK307CisKK3N0YXRpYyBjb25zdCBjaGFyICpjb25zdCBj
dXJ2ZTQ0OF9iYWRfcG9pbnRzW10gPSB7CisJIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmUiCisJImZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmIiwKKwkiMHgwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMCIKKwkiMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAiLAorCSIweDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwIgorCSIw
MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMSIs
CisJIjB4ZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmUiCisJImZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZlIiwKKwkiMHhmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm
ZmZmZmZmZmZmZmZmZmZmZiIKKwkiMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAw
MDAwMDAwMDAwMDAwMDAwMDAwMDAiLAorCU5VTEwKK307CisKK3N0YXRpYyBjb25zdCBjaGFyICpj
b25zdCAqYmFkX3BvaW50c190YWJsZVtdID0geworCWN1cnZlMjU1MTlfYmFkX3BvaW50cywKKwlj
dXJ2ZTQ0OF9iYWRfcG9pbnRzLAorfTsKKworc3RhdGljIHZvaWQgbXBpX2VjX2NvZWZmaWNpZW50
X25vcm1hbGl6ZShNUEkgYSwgTVBJIHApCit7CisJaWYgKGEtPnNpZ24pIHsKKwkJbXBpX3Jlc2l6
ZShhLCBwLT5ubGltYnMpOworCQltcGloZWxwX3N1Yl9uKGEtPmQsIHAtPmQsIGEtPmQsIHAtPm5s
aW1icyk7CisJCWEtPm5saW1icyA9IHAtPm5saW1iczsKKwkJYS0+c2lnbiA9IDA7CisJfQorfQor
CisvKiBUaGlzIGZ1bmN0aW9uIGluaXRpYWxpemVkIGEgY29udGV4dCBmb3IgZWxsaXB0aWMgY3Vy
dmUgYmFzZWQgb24gdGhlCisgKiBmaWVsZCBHRihwKS4gIFAgaXMgdGhlIHByaW1lIHNwZWNpZnlp
bmcgdGhpcyBmaWVsZCwgQSBpcyB0aGUgZmlyc3QKKyAqIGNvZWZmaWNpZW50LiAgQ1RYIGlzIGV4
cGVjdGVkIHRvIGJlIHplcm9pemVkLgorICovCit2b2lkIG1waV9lY19pbml0KHN0cnVjdCBtcGlf
ZWNfY3R4ICpjdHgsIGVudW0gZ2NyeV9tcGlfZWNfbW9kZWxzIG1vZGVsLAorCQkJZW51bSBlY2Nf
ZGlhbGVjdHMgZGlhbGVjdCwKKwkJCWludCBmbGFncywgTVBJIHAsIE1QSSBhLCBNUEkgYikKK3sK
KwlpbnQgaTsKKwlzdGF0aWMgaW50IHVzZV9iYXJyZXR0ID0gLTEgLyogVE9ETzogMSBvciAtMSAq
LzsKKworCW1waV9lY19jb2VmZmljaWVudF9ub3JtYWxpemUoYSwgcCk7CisJbXBpX2VjX2NvZWZm
aWNpZW50X25vcm1hbGl6ZShiLCBwKTsKKworCS8qIEZpeG1lOiBEbyB3ZSB3YW50IHRvIGNoZWNr
IHNvbWUgY29uc3RyYWludHM/IGUuZy4gIGEgPCBwICAqLworCisJY3R4LT5tb2RlbCA9IG1vZGVs
OworCWN0eC0+ZGlhbGVjdCA9IGRpYWxlY3Q7CisJY3R4LT5mbGFncyA9IGZsYWdzOworCWlmIChk
aWFsZWN0ID09IEVDQ19ESUFMRUNUX0VEMjU1MTkpCisJCWN0eC0+bmJpdHMgPSAyNTY7CisJZWxz
ZQorCQljdHgtPm5iaXRzID0gbXBpX2dldF9uYml0cyhwKTsKKwljdHgtPnAgPSBtcGlfY29weShw
KTsKKwljdHgtPmEgPSBtcGlfY29weShhKTsKKwljdHgtPmIgPSBtcGlfY29weShiKTsKKworCWN0
eC0+dC5wX2JhcnJldHQgPSB1c2VfYmFycmV0dCA+IDAgPyBtcGlfYmFycmV0dF9pbml0KGN0eC0+
cCwgMCkgOiBOVUxMOworCisJbXBpX2VjX2dldF9yZXNldChjdHgpOworCisJaWYgKG1vZGVsID09
IE1QSV9FQ19NT05UR09NRVJZKSB7CisJCWZvciAoaSA9IDA7IGkgPCBESU0oYmFkX3BvaW50c190
YWJsZSk7IGkrKykgeworCQkJTVBJIHBfY2FuZGlkYXRlID0gbXBpX3NjYW52YWwoYmFkX3BvaW50
c190YWJsZVtpXVswXSk7CisJCQlpbnQgbWF0Y2hfcCA9ICFtcGlfY21wKGN0eC0+cCwgcF9jYW5k
aWRhdGUpOworCQkJaW50IGo7CisKKwkJCW1waV9mcmVlKHBfY2FuZGlkYXRlKTsKKwkJCWlmICgh
bWF0Y2hfcCkKKwkJCQljb250aW51ZTsKKworCQkJZm9yIChqID0gMDsgaSA8IERJTShjdHgtPnQu
c2NyYXRjaCkgJiYgYmFkX3BvaW50c190YWJsZVtpXVtqXTsgaisrKQorCQkJCWN0eC0+dC5zY3Jh
dGNoW2pdID0gbXBpX3NjYW52YWwoYmFkX3BvaW50c190YWJsZVtpXVtqXSk7CisJCX0KKwl9IGVs
c2UgeworCQkvKiBBbGxvY2F0ZSBzY3JhdGNoIHZhcmlhYmxlcy4gICovCisJCWZvciAoaSA9IDA7
IGkgPCBESU0oY3R4LT50LnNjcmF0Y2gpOyBpKyspCisJCQljdHgtPnQuc2NyYXRjaFtpXSA9IG1w
aV9hbGxvY19saWtlKGN0eC0+cCk7CisJfQorCisJY3R4LT5hZGRtID0gZWNfYWRkbTsKKwljdHgt
PnN1Ym0gPSBlY19zdWJtOworCWN0eC0+bXVsbSA9IGVjX211bG07CisJY3R4LT5tdWwyID0gZWNf
bXVsMjsKKwljdHgtPnBvdzIgPSBlY19wb3cyOworCisJZm9yIChpID0gMDsgZmllbGRfdGFibGVb
aV0ucDsgaSsrKSB7CisJCU1QSSBmX3A7CisKKwkJZl9wID0gbXBpX3NjYW52YWwoZmllbGRfdGFi
bGVbaV0ucCk7CisJCWlmICghZl9wKQorCQkJYnJlYWs7CisKKwkJaWYgKCFtcGlfY21wKHAsIGZf
cCkpIHsKKwkJCWN0eC0+YWRkbSA9IGZpZWxkX3RhYmxlW2ldLmFkZG07CisJCQljdHgtPnN1Ym0g
PSBmaWVsZF90YWJsZVtpXS5zdWJtOworCQkJY3R4LT5tdWxtID0gZmllbGRfdGFibGVbaV0ubXVs
bTsKKwkJCWN0eC0+bXVsMiA9IGZpZWxkX3RhYmxlW2ldLm11bDI7CisJCQljdHgtPnBvdzIgPSBm
aWVsZF90YWJsZVtpXS5wb3cyOworCQkJbXBpX2ZyZWUoZl9wKTsKKworCQkJbXBpX3Jlc2l6ZShj
dHgtPmEsIGN0eC0+cC0+bmxpbWJzKTsKKwkJCWN0eC0+YS0+bmxpbWJzID0gY3R4LT5wLT5ubGlt
YnM7CisKKwkJCW1waV9yZXNpemUoY3R4LT5iLCBjdHgtPnAtPm5saW1icyk7CisJCQljdHgtPmIt
Pm5saW1icyA9IGN0eC0+cC0+bmxpbWJzOworCisJCQlmb3IgKGkgPSAwOyBpIDwgRElNKGN0eC0+
dC5zY3JhdGNoKSAmJiBjdHgtPnQuc2NyYXRjaFtpXTsgaSsrKQorCQkJCWN0eC0+dC5zY3JhdGNo
W2ldLT5ubGltYnMgPSBjdHgtPnAtPm5saW1iczsKKworCQkJYnJlYWs7CisJCX0KKworCQltcGlf
ZnJlZShmX3ApOworCX0KK30KK0VYUE9SVF9TWU1CT0xfR1BMKG1waV9lY19pbml0KTsKKwordm9p
ZCBtcGlfZWNfZGVpbml0KHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJaW50IGk7CisKKwlt
cGlfYmFycmV0dF9mcmVlKGN0eC0+dC5wX2JhcnJldHQpOworCisJLyogRG9tYWluIHBhcmFtZXRl
ci4gICovCisJbXBpX2ZyZWUoY3R4LT5wKTsKKwltcGlfZnJlZShjdHgtPmEpOworCW1waV9mcmVl
KGN0eC0+Yik7CisJbXBpX3BvaW50X3JlbGVhc2UoY3R4LT5HKTsKKwltcGlfZnJlZShjdHgtPm4p
OworCisJLyogVGhlIGtleS4gICovCisJbXBpX3BvaW50X3JlbGVhc2UoY3R4LT5RKTsKKwltcGlf
ZnJlZShjdHgtPmQpOworCisJLyogUHJpdmF0ZSBkYXRhIG9mIGVjLmMuICAqLworCW1waV9mcmVl
KGN0eC0+dC50d29faW52X3ApOworCisJZm9yIChpID0gMDsgaSA8IERJTShjdHgtPnQuc2NyYXRj
aCk7IGkrKykKKwkJbXBpX2ZyZWUoY3R4LT50LnNjcmF0Y2hbaV0pOworfQorRVhQT1JUX1NZTUJP
TF9HUEwobXBpX2VjX2RlaW5pdCk7CisKKy8qIENvbXB1dGUgdGhlIGFmZmluZSBjb29yZGluYXRl
cyBmcm9tIHRoZSBwcm9qZWN0aXZlIGNvb3JkaW5hdGVzIGluCisgKiBQT0lOVC4gIFNldCB0aGVt
IGludG8gWCBhbmQgWS4gIElmIG9uZSBjb29yZGluYXRlIGlzIG5vdCByZXF1aXJlZCwKKyAqIFgg
b3IgWSBtYXkgYmUgcGFzc2VkIGFzIE5VTEwuICBDVFggaXMgdGhlIHVzdWFsIGNvbnRleHQuIFJl
dHVybnM6IDAKKyAqIG9uIHN1Y2Nlc3Mgb3IgITAgaWYgUE9JTlQgaXMgYXQgaW5maW5pdHkuCisg
Ki8KK2ludCBtcGlfZWNfZ2V0X2FmZmluZShNUEkgeCwgTVBJIHksIE1QSV9QT0lOVCBwb2ludCwg
c3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwlpZiAoIW1waV9jbXBfdWkocG9pbnQtPnosIDAp
KQorCQlyZXR1cm4gLTE7CisKKwlzd2l0Y2ggKGN0eC0+bW9kZWwpIHsKKwljYXNlIE1QSV9FQ19X
RUlFUlNUUkFTUzogLyogVXNpbmcgSmFjb2JpYW4gY29vcmRpbmF0ZXMuICAqLworCQl7CisJCQlN
UEkgejEsIHoyLCB6MzsKKworCQkJejEgPSBtcGlfbmV3KDApOworCQkJejIgPSBtcGlfbmV3KDAp
OworCQkJZWNfaW52bSh6MSwgcG9pbnQtPnosIGN0eCk7ICAvKiB6MSA9IHpeKC0xKSBtb2QgcCAg
Ki8KKwkJCWVjX211bG0oejIsIHoxLCB6MSwgY3R4KTsgICAgLyogejIgPSB6XigtMikgbW9kIHAg
ICovCisKKwkJCWlmICh4KQorCQkJCWVjX211bG0oeCwgcG9pbnQtPngsIHoyLCBjdHgpOworCisJ
CQlpZiAoeSkgeworCQkJCXozID0gbXBpX25ldygwKTsKKwkJCQllY19tdWxtKHozLCB6MiwgejEs
IGN0eCk7ICAgICAgLyogejMgPSB6XigtMykgbW9kIHAgKi8KKwkJCQllY19tdWxtKHksIHBvaW50
LT55LCB6MywgY3R4KTsKKwkJCQltcGlfZnJlZSh6Myk7CisJCQl9CisKKwkJCW1waV9mcmVlKHoy
KTsKKwkJCW1waV9mcmVlKHoxKTsKKwkJfQorCQlyZXR1cm4gMDsKKworCWNhc2UgTVBJX0VDX01P
TlRHT01FUlk6CisJCXsKKwkJCWlmICh4KQorCQkJCW1waV9zZXQoeCwgcG9pbnQtPngpOworCisJ
CQlpZiAoeSkgeworCQkJCWxvZ19mYXRhbCgiJXM6IEdldHRpbmcgWS1jb29yZGluYXRlIG9uICVz
IGlzIG5vdCBzdXBwb3J0ZWRcbiIsCisJCQkJCQkibXBpX2VjX2dldF9hZmZpbmUiLCAiTW9udGdv
bWVyeSIpOworCQkJCXJldHVybiAtMTsKKwkJCX0KKwkJfQorCQlyZXR1cm4gMDsKKworCWNhc2Ug
TVBJX0VDX0VEV0FSRFM6CisJCXsKKwkJCU1QSSB6OworCisJCQl6ID0gbXBpX25ldygwKTsKKwkJ
CWVjX2ludm0oeiwgcG9pbnQtPnosIGN0eCk7CisKKwkJCW1waV9yZXNpemUoeiwgY3R4LT5wLT5u
bGltYnMpOworCQkJei0+bmxpbWJzID0gY3R4LT5wLT5ubGltYnM7CisKKwkJCWlmICh4KSB7CisJ
CQkJbXBpX3Jlc2l6ZSh4LCBjdHgtPnAtPm5saW1icyk7CisJCQkJeC0+bmxpbWJzID0gY3R4LT5w
LT5ubGltYnM7CisJCQkJY3R4LT5tdWxtKHgsIHBvaW50LT54LCB6LCBjdHgpOworCQkJfQorCQkJ
aWYgKHkpIHsKKwkJCQltcGlfcmVzaXplKHksIGN0eC0+cC0+bmxpbWJzKTsKKwkJCQl5LT5ubGlt
YnMgPSBjdHgtPnAtPm5saW1iczsKKwkJCQljdHgtPm11bG0oeSwgcG9pbnQtPnksIHosIGN0eCk7
CisJCQl9CisKKwkJCW1waV9mcmVlKHopOworCQl9CisJCXJldHVybiAwOworCisJZGVmYXVsdDoK
KwkJcmV0dXJuIC0xOworCX0KK30KK0VYUE9SVF9TWU1CT0xfR1BMKG1waV9lY19nZXRfYWZmaW5l
KTsKKworLyogIFJFU1VMVCA9IDIgKiBQT0lOVCAgKFdlaWVyc3RyYXNzIHZlcnNpb24pLiAqLwor
c3RhdGljIHZvaWQgZHVwX3BvaW50X3dlaWVyc3RyYXNzKE1QSV9QT0lOVCByZXN1bHQsCisJCU1Q
SV9QT0lOVCBwb2ludCwgc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKyNkZWZpbmUgeDMgKHJl
c3VsdC0+eCkKKyNkZWZpbmUgeTMgKHJlc3VsdC0+eSkKKyNkZWZpbmUgejMgKHJlc3VsdC0+eikK
KyNkZWZpbmUgdDEgKGN0eC0+dC5zY3JhdGNoWzBdKQorI2RlZmluZSB0MiAoY3R4LT50LnNjcmF0
Y2hbMV0pCisjZGVmaW5lIHQzIChjdHgtPnQuc2NyYXRjaFsyXSkKKyNkZWZpbmUgbDEgKGN0eC0+
dC5zY3JhdGNoWzNdKQorI2RlZmluZSBsMiAoY3R4LT50LnNjcmF0Y2hbNF0pCisjZGVmaW5lIGwz
IChjdHgtPnQuc2NyYXRjaFs1XSkKKworCWlmICghbXBpX2NtcF91aShwb2ludC0+eSwgMCkgfHwg
IW1waV9jbXBfdWkocG9pbnQtPnosIDApKSB7CisJCS8qIFBfeSA9PSAwIHx8IFBfeiA9PSAwID0+
IFsxOjE6MF0gKi8KKwkJbXBpX3NldF91aSh4MywgMSk7CisJCW1waV9zZXRfdWkoeTMsIDEpOwor
CQltcGlfc2V0X3VpKHozLCAwKTsKKwl9IGVsc2UgeworCQlpZiAoZWNfZ2V0X2FfaXNfcG1pbnVz
MyhjdHgpKSB7CisJCQkvKiBVc2UgdGhlIGZhc3RlciBjYXNlLiAgKi8KKwkJCS8qIEwxID0gMyhY
IC0gWl4yKShYICsgWl4yKSAqLworCQkJLyogICAgICAgICAgICAgICAgICAgICAgICAgIFQxOiB1
c2VkIGZvciBaXjIuICovCisJCQkvKiAgICAgICAgICAgICAgICAgICAgICAgICAgVDI6IHVzZWQg
Zm9yIHRoZSByaWdodCB0ZXJtLiAqLworCQkJZWNfcG93Mih0MSwgcG9pbnQtPnosIGN0eCk7CisJ
CQllY19zdWJtKGwxLCBwb2ludC0+eCwgdDEsIGN0eCk7CisJCQllY19tdWxtKGwxLCBsMSwgbXBp
X2NvbnN0KE1QSV9DX1RIUkVFKSwgY3R4KTsKKwkJCWVjX2FkZG0odDIsIHBvaW50LT54LCB0MSwg
Y3R4KTsKKwkJCWVjX211bG0obDEsIGwxLCB0MiwgY3R4KTsKKwkJfSBlbHNlIHsKKwkJCS8qIFN0
YW5kYXJkIGNhc2UuICovCisJCQkvKiBMMSA9IDNYXjIgKyBhWl40ICovCisJCQkvKiAgICAgICAg
ICAgICAgICAgICAgICAgICAgVDE6IHVzZWQgZm9yIGFaXjQuICovCisJCQllY19wb3cyKGwxLCBw
b2ludC0+eCwgY3R4KTsKKwkJCWVjX211bG0obDEsIGwxLCBtcGlfY29uc3QoTVBJX0NfVEhSRUUp
LCBjdHgpOworCQkJZWNfcG93bSh0MSwgcG9pbnQtPnosIG1waV9jb25zdChNUElfQ19GT1VSKSwg
Y3R4KTsKKwkJCWVjX211bG0odDEsIHQxLCBjdHgtPmEsIGN0eCk7CisJCQllY19hZGRtKGwxLCBs
MSwgdDEsIGN0eCk7CisJCX0KKwkJLyogWjMgPSAyWVogKi8KKwkJZWNfbXVsbSh6MywgcG9pbnQt
PnksIHBvaW50LT56LCBjdHgpOworCQllY19tdWwyKHozLCB6MywgY3R4KTsKKworCQkvKiBMMiA9
IDRYWV4yICovCisJCS8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVDI6IHVzZWQgZm9y
IFkyOyByZXF1aXJlZCBsYXRlci4gKi8KKwkJZWNfcG93Mih0MiwgcG9pbnQtPnksIGN0eCk7CisJ
CWVjX211bG0obDIsIHQyLCBwb2ludC0+eCwgY3R4KTsKKwkJZWNfbXVsbShsMiwgbDIsIG1waV9j
b25zdChNUElfQ19GT1VSKSwgY3R4KTsKKworCQkvKiBYMyA9IEwxXjIgLSAyTDIgKi8KKwkJLyog
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUMTogdXNlZCBmb3IgTDJeMi4gKi8KKwkJZWNf
cG93Mih4MywgbDEsIGN0eCk7CisJCWVjX211bDIodDEsIGwyLCBjdHgpOworCQllY19zdWJtKHgz
LCB4MywgdDEsIGN0eCk7CisKKwkJLyogTDMgPSA4WV40ICovCisJCS8qICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgVDI6IHRha2VuIGZyb20gYWJvdmUuICovCisJCWVjX3BvdzIodDIsIHQy
LCBjdHgpOworCQllY19tdWxtKGwzLCB0MiwgbXBpX2NvbnN0KE1QSV9DX0VJR0hUKSwgY3R4KTsK
KworCQkvKiBZMyA9IEwxKEwyIC0gWDMpIC0gTDMgKi8KKwkJZWNfc3VibSh5MywgbDIsIHgzLCBj
dHgpOworCQllY19tdWxtKHkzLCB5MywgbDEsIGN0eCk7CisJCWVjX3N1Ym0oeTMsIHkzLCBsMywg
Y3R4KTsKKwl9CisKKyN1bmRlZiB4MworI3VuZGVmIHkzCisjdW5kZWYgejMKKyN1bmRlZiB0MQor
I3VuZGVmIHQyCisjdW5kZWYgdDMKKyN1bmRlZiBsMQorI3VuZGVmIGwyCisjdW5kZWYgbDMKK30K
KworLyogIFJFU1VMVCA9IDIgKiBQT0lOVCAgKE1vbnRnb21lcnkgdmVyc2lvbikuICovCitzdGF0
aWMgdm9pZCBkdXBfcG9pbnRfbW9udGdvbWVyeShNUElfUE9JTlQgcmVzdWx0LAorCQkJCU1QSV9Q
T0lOVCBwb2ludCwgc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sKKwkodm9pZClyZXN1bHQ7CisJ
KHZvaWQpcG9pbnQ7CisJKHZvaWQpY3R4OworCWxvZ19mYXRhbCgiJXM6ICVzIG5vdCB5ZXQgc3Vw
cG9ydGVkXG4iLAorCQkJIm1waV9lY19kdXBfcG9pbnQiLCAiTW9udGdvbWVyeSIpOworfQorCisv
KiAgUkVTVUxUID0gMiAqIFBPSU5UICAoVHdpc3RlZCBFZHdhcmRzIHZlcnNpb24pLiAqLworc3Rh
dGljIHZvaWQgZHVwX3BvaW50X2Vkd2FyZHMoTVBJX1BPSU5UIHJlc3VsdCwKKwkJTVBJX1BPSU5U
IHBvaW50LCBzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworI2RlZmluZSBYMSAocG9pbnQtPngp
CisjZGVmaW5lIFkxIChwb2ludC0+eSkKKyNkZWZpbmUgWjEgKHBvaW50LT56KQorI2RlZmluZSBY
MyAocmVzdWx0LT54KQorI2RlZmluZSBZMyAocmVzdWx0LT55KQorI2RlZmluZSBaMyAocmVzdWx0
LT56KQorI2RlZmluZSBCIChjdHgtPnQuc2NyYXRjaFswXSkKKyNkZWZpbmUgQyAoY3R4LT50LnNj
cmF0Y2hbMV0pCisjZGVmaW5lIEQgKGN0eC0+dC5zY3JhdGNoWzJdKQorI2RlZmluZSBFIChjdHgt
PnQuc2NyYXRjaFszXSkKKyNkZWZpbmUgRiAoY3R4LT50LnNjcmF0Y2hbNF0pCisjZGVmaW5lIEgg
KGN0eC0+dC5zY3JhdGNoWzVdKQorI2RlZmluZSBKIChjdHgtPnQuc2NyYXRjaFs2XSkKKworCS8q
IENvbXB1dGU6IChYXzMgOiBZXzMgOiBaXzMpID0gMiggWF8xIDogWV8xIDogWl8xICkgKi8KKwor
CS8qIEIgPSAoWF8xICsgWV8xKV4yICAqLworCWN0eC0+YWRkbShCLCBYMSwgWTEsIGN0eCk7CisJ
Y3R4LT5wb3cyKEIsIEIsIGN0eCk7CisKKwkvKiBDID0gWF8xXjIgKi8KKwkvKiBEID0gWV8xXjIg
Ki8KKwljdHgtPnBvdzIoQywgWDEsIGN0eCk7CisJY3R4LT5wb3cyKEQsIFkxLCBjdHgpOworCisJ
LyogRSA9IGFDICovCisJaWYgKGN0eC0+ZGlhbGVjdCA9PSBFQ0NfRElBTEVDVF9FRDI1NTE5KQor
CQljdHgtPnN1Ym0oRSwgY3R4LT5wLCBDLCBjdHgpOworCWVsc2UKKwkJY3R4LT5tdWxtKEUsIGN0
eC0+YSwgQywgY3R4KTsKKworCS8qIEYgPSBFICsgRCAqLworCWN0eC0+YWRkbShGLCBFLCBELCBj
dHgpOworCisJLyogSCA9IFpfMV4yICovCisJY3R4LT5wb3cyKEgsIFoxLCBjdHgpOworCisJLyog
SiA9IEYgLSAySCAqLworCWN0eC0+bXVsMihKLCBILCBjdHgpOworCWN0eC0+c3VibShKLCBGLCBK
LCBjdHgpOworCisJLyogWF8zID0gKEIgLSBDIC0gRCkgwrcgSiAqLworCWN0eC0+c3VibShYMywg
QiwgQywgY3R4KTsKKwljdHgtPnN1Ym0oWDMsIFgzLCBELCBjdHgpOworCWN0eC0+bXVsbShYMywg
WDMsIEosIGN0eCk7CisKKwkvKiBZXzMgPSBGIMK3IChFIC0gRCkgKi8KKwljdHgtPnN1Ym0oWTMs
IEUsIEQsIGN0eCk7CisJY3R4LT5tdWxtKFkzLCBZMywgRiwgY3R4KTsKKworCS8qIFpfMyA9IEYg
wrcgSiAqLworCWN0eC0+bXVsbShaMywgRiwgSiwgY3R4KTsKKworI3VuZGVmIFgxCisjdW5kZWYg
WTEKKyN1bmRlZiBaMQorI3VuZGVmIFgzCisjdW5kZWYgWTMKKyN1bmRlZiBaMworI3VuZGVmIEIK
KyN1bmRlZiBDCisjdW5kZWYgRAorI3VuZGVmIEUKKyN1bmRlZiBGCisjdW5kZWYgSAorI3VuZGVm
IEoKK30KKworLyogIFJFU1VMVCA9IDIgKiBQT0lOVCAgKi8KK3N0YXRpYyB2b2lkCittcGlfZWNf
ZHVwX3BvaW50KE1QSV9QT0lOVCByZXN1bHQsIE1QSV9QT0lOVCBwb2ludCwgc3RydWN0IG1waV9l
Y19jdHggKmN0eCkKK3sKKwlzd2l0Y2ggKGN0eC0+bW9kZWwpIHsKKwljYXNlIE1QSV9FQ19XRUlF
UlNUUkFTUzoKKwkJZHVwX3BvaW50X3dlaWVyc3RyYXNzKHJlc3VsdCwgcG9pbnQsIGN0eCk7CisJ
CWJyZWFrOworCWNhc2UgTVBJX0VDX01PTlRHT01FUlk6CisJCWR1cF9wb2ludF9tb250Z29tZXJ5
KHJlc3VsdCwgcG9pbnQsIGN0eCk7CisJCWJyZWFrOworCWNhc2UgTVBJX0VDX0VEV0FSRFM6CisJ
CWR1cF9wb2ludF9lZHdhcmRzKHJlc3VsdCwgcG9pbnQsIGN0eCk7CisJCWJyZWFrOworCX0KK30K
KworLyogUkVTVUxUID0gUDEgKyBQMiAgKFdlaWVyc3RyYXNzIHZlcnNpb24pLiovCitzdGF0aWMg
dm9pZCBhZGRfcG9pbnRzX3dlaWVyc3RyYXNzKE1QSV9QT0lOVCByZXN1bHQsCisJCU1QSV9QT0lO
VCBwMSwgTVBJX1BPSU5UIHAyLAorCQlzdHJ1Y3QgbXBpX2VjX2N0eCAqY3R4KQoreworI2RlZmlu
ZSB4MSAocDEtPngpCisjZGVmaW5lIHkxIChwMS0+eSkKKyNkZWZpbmUgejEgKHAxLT56KQorI2Rl
ZmluZSB4MiAocDItPngpCisjZGVmaW5lIHkyIChwMi0+eSkKKyNkZWZpbmUgejIgKHAyLT56KQor
I2RlZmluZSB4MyAocmVzdWx0LT54KQorI2RlZmluZSB5MyAocmVzdWx0LT55KQorI2RlZmluZSB6
MyAocmVzdWx0LT56KQorI2RlZmluZSBsMSAoY3R4LT50LnNjcmF0Y2hbMF0pCisjZGVmaW5lIGwy
IChjdHgtPnQuc2NyYXRjaFsxXSkKKyNkZWZpbmUgbDMgKGN0eC0+dC5zY3JhdGNoWzJdKQorI2Rl
ZmluZSBsNCAoY3R4LT50LnNjcmF0Y2hbM10pCisjZGVmaW5lIGw1IChjdHgtPnQuc2NyYXRjaFs0
XSkKKyNkZWZpbmUgbDYgKGN0eC0+dC5zY3JhdGNoWzVdKQorI2RlZmluZSBsNyAoY3R4LT50LnNj
cmF0Y2hbNl0pCisjZGVmaW5lIGw4IChjdHgtPnQuc2NyYXRjaFs3XSkKKyNkZWZpbmUgbDkgKGN0
eC0+dC5zY3JhdGNoWzhdKQorI2RlZmluZSB0MSAoY3R4LT50LnNjcmF0Y2hbOV0pCisjZGVmaW5l
IHQyIChjdHgtPnQuc2NyYXRjaFsxMF0pCisKKwlpZiAoKCFtcGlfY21wKHgxLCB4MikpICYmICgh
bXBpX2NtcCh5MSwgeTIpKSAmJiAoIW1waV9jbXAoejEsIHoyKSkpIHsKKwkJLyogU2FtZSBwb2lu
dDsgbmVlZCB0byBjYWxsIHRoZSBkdXBsaWNhdGUgZnVuY3Rpb24uICAqLworCQltcGlfZWNfZHVw
X3BvaW50KHJlc3VsdCwgcDEsIGN0eCk7CisJfSBlbHNlIGlmICghbXBpX2NtcF91aSh6MSwgMCkp
IHsKKwkJLyogUDEgaXMgYXQgaW5maW5pdHkuICAqLworCQltcGlfc2V0KHgzLCBwMi0+eCk7CisJ
CW1waV9zZXQoeTMsIHAyLT55KTsKKwkJbXBpX3NldCh6MywgcDItPnopOworCX0gZWxzZSBpZiAo
IW1waV9jbXBfdWkoejIsIDApKSB7CisJCS8qIFAyIGlzIGF0IGluZmluaXR5LiAgKi8KKwkJbXBp
X3NldCh4MywgcDEtPngpOworCQltcGlfc2V0KHkzLCBwMS0+eSk7CisJCW1waV9zZXQoejMsIHAx
LT56KTsKKwl9IGVsc2UgeworCQlpbnQgejFfaXNfb25lID0gIW1waV9jbXBfdWkoejEsIDEpOwor
CQlpbnQgejJfaXNfb25lID0gIW1waV9jbXBfdWkoejIsIDEpOworCisJCS8qIGwxID0geDEgejJe
MiAgKi8KKwkJLyogbDIgPSB4MiB6MV4yICAqLworCQlpZiAoejJfaXNfb25lKQorCQkJbXBpX3Nl
dChsMSwgeDEpOworCQllbHNlIHsKKwkJCWVjX3BvdzIobDEsIHoyLCBjdHgpOworCQkJZWNfbXVs
bShsMSwgbDEsIHgxLCBjdHgpOworCQl9CisJCWlmICh6MV9pc19vbmUpCisJCQltcGlfc2V0KGwy
LCB4Mik7CisJCWVsc2UgeworCQkJZWNfcG93MihsMiwgejEsIGN0eCk7CisJCQllY19tdWxtKGwy
LCBsMiwgeDIsIGN0eCk7CisJCX0KKwkJLyogbDMgPSBsMSAtIGwyICovCisJCWVjX3N1Ym0obDMs
IGwxLCBsMiwgY3R4KTsKKwkJLyogbDQgPSB5MSB6Ml4zICAqLworCQllY19wb3dtKGw0LCB6Miwg
bXBpX2NvbnN0KE1QSV9DX1RIUkVFKSwgY3R4KTsKKwkJZWNfbXVsbShsNCwgbDQsIHkxLCBjdHgp
OworCQkvKiBsNSA9IHkyIHoxXjMgICovCisJCWVjX3Bvd20obDUsIHoxLCBtcGlfY29uc3QoTVBJ
X0NfVEhSRUUpLCBjdHgpOworCQllY19tdWxtKGw1LCBsNSwgeTIsIGN0eCk7CisJCS8qIGw2ID0g
bDQgLSBsNSAgKi8KKwkJZWNfc3VibShsNiwgbDQsIGw1LCBjdHgpOworCisJCWlmICghbXBpX2Nt
cF91aShsMywgMCkpIHsKKwkJCWlmICghbXBpX2NtcF91aShsNiwgMCkpIHsKKwkJCQkvKiBQMSBh
bmQgUDIgYXJlIHRoZSBzYW1lIC0gdXNlIGR1cGxpY2F0ZSBmdW5jdGlvbi4gKi8KKwkJCQltcGlf
ZWNfZHVwX3BvaW50KHJlc3VsdCwgcDEsIGN0eCk7CisJCQl9IGVsc2UgeworCQkJCS8qIFAxIGlz
IHRoZSBpbnZlcnNlIG9mIFAyLiAgKi8KKwkJCQltcGlfc2V0X3VpKHgzLCAxKTsKKwkJCQltcGlf
c2V0X3VpKHkzLCAxKTsKKwkJCQltcGlfc2V0X3VpKHozLCAwKTsKKwkJCX0KKwkJfSBlbHNlIHsK
KwkJCS8qIGw3ID0gbDEgKyBsMiAgKi8KKwkJCWVjX2FkZG0obDcsIGwxLCBsMiwgY3R4KTsKKwkJ
CS8qIGw4ID0gbDQgKyBsNSAgKi8KKwkJCWVjX2FkZG0obDgsIGw0LCBsNSwgY3R4KTsKKwkJCS8q
IHozID0gejEgejIgbDMgICovCisJCQllY19tdWxtKHozLCB6MSwgejIsIGN0eCk7CisJCQllY19t
dWxtKHozLCB6MywgbDMsIGN0eCk7CisJCQkvKiB4MyA9IGw2XjIgLSBsNyBsM14yICAqLworCQkJ
ZWNfcG93Mih0MSwgbDYsIGN0eCk7CisJCQllY19wb3cyKHQyLCBsMywgY3R4KTsKKwkJCWVjX211
bG0odDIsIHQyLCBsNywgY3R4KTsKKwkJCWVjX3N1Ym0oeDMsIHQxLCB0MiwgY3R4KTsKKwkJCS8q
IGw5ID0gbDcgbDNeMiAtIDIgeDMgICovCisJCQllY19tdWwyKHQxLCB4MywgY3R4KTsKKwkJCWVj
X3N1Ym0obDksIHQyLCB0MSwgY3R4KTsKKwkJCS8qIHkzID0gKGw5IGw2IC0gbDggbDNeMykvMiAg
Ki8KKwkJCWVjX211bG0obDksIGw5LCBsNiwgY3R4KTsKKwkJCWVjX3Bvd20odDEsIGwzLCBtcGlf
Y29uc3QoTVBJX0NfVEhSRUUpLCBjdHgpOyAvKiBmaXhtZTogVXNlIHNhdmVkIHZhbHVlKi8KKwkJ
CWVjX211bG0odDEsIHQxLCBsOCwgY3R4KTsKKwkJCWVjX3N1Ym0oeTMsIGw5LCB0MSwgY3R4KTsK
KwkJCWVjX211bG0oeTMsIHkzLCBlY19nZXRfdHdvX2ludl9wKGN0eCksIGN0eCk7CisJCX0KKwl9
CisKKyN1bmRlZiB4MQorI3VuZGVmIHkxCisjdW5kZWYgejEKKyN1bmRlZiB4MgorI3VuZGVmIHky
CisjdW5kZWYgejIKKyN1bmRlZiB4MworI3VuZGVmIHkzCisjdW5kZWYgejMKKyN1bmRlZiBsMQor
I3VuZGVmIGwyCisjdW5kZWYgbDMKKyN1bmRlZiBsNAorI3VuZGVmIGw1CisjdW5kZWYgbDYKKyN1
bmRlZiBsNworI3VuZGVmIGw4CisjdW5kZWYgbDkKKyN1bmRlZiB0MQorI3VuZGVmIHQyCit9CisK
Ky8qIFJFU1VMVCA9IFAxICsgUDIgIChNb250Z29tZXJ5IHZlcnNpb24pLiovCitzdGF0aWMgdm9p
ZCBhZGRfcG9pbnRzX21vbnRnb21lcnkoTVBJX1BPSU5UIHJlc3VsdCwKKwkJTVBJX1BPSU5UIHAx
LCBNUElfUE9JTlQgcDIsCisJCXN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJKHZvaWQpcmVz
dWx0OworCSh2b2lkKXAxOworCSh2b2lkKXAyOworCSh2b2lkKWN0eDsKKwlsb2dfZmF0YWwoIiVz
OiAlcyBub3QgeWV0IHN1cHBvcnRlZFxuIiwKKwkJCSJtcGlfZWNfYWRkX3BvaW50cyIsICJNb250
Z29tZXJ5Iik7Cit9CisKKy8qIFJFU1VMVCA9IFAxICsgUDIgIChUd2lzdGVkIEVkd2FyZHMgdmVy
c2lvbikuKi8KK3N0YXRpYyB2b2lkIGFkZF9wb2ludHNfZWR3YXJkcyhNUElfUE9JTlQgcmVzdWx0
LAorCQlNUElfUE9JTlQgcDEsIE1QSV9QT0lOVCBwMiwKKwkJc3RydWN0IG1waV9lY19jdHggKmN0
eCkKK3sKKyNkZWZpbmUgWDEgKHAxLT54KQorI2RlZmluZSBZMSAocDEtPnkpCisjZGVmaW5lIFox
IChwMS0+eikKKyNkZWZpbmUgWDIgKHAyLT54KQorI2RlZmluZSBZMiAocDItPnkpCisjZGVmaW5l
IFoyIChwMi0+eikKKyNkZWZpbmUgWDMgKHJlc3VsdC0+eCkKKyNkZWZpbmUgWTMgKHJlc3VsdC0+
eSkKKyNkZWZpbmUgWjMgKHJlc3VsdC0+eikKKyNkZWZpbmUgQSAoY3R4LT50LnNjcmF0Y2hbMF0p
CisjZGVmaW5lIEIgKGN0eC0+dC5zY3JhdGNoWzFdKQorI2RlZmluZSBDIChjdHgtPnQuc2NyYXRj
aFsyXSkKKyNkZWZpbmUgRCAoY3R4LT50LnNjcmF0Y2hbM10pCisjZGVmaW5lIEUgKGN0eC0+dC5z
Y3JhdGNoWzRdKQorI2RlZmluZSBGIChjdHgtPnQuc2NyYXRjaFs1XSkKKyNkZWZpbmUgRyAoY3R4
LT50LnNjcmF0Y2hbNl0pCisjZGVmaW5lIHRtcCAoY3R4LT50LnNjcmF0Y2hbN10pCisKKwlwb2lu
dF9yZXNpemUocmVzdWx0LCBjdHgpOworCisJLyogQ29tcHV0ZTogKFhfMyA6IFlfMyA6IFpfMykg
PSAoWF8xIDogWV8xIDogWl8xKSArIChYXzIgOiBZXzIgOiBaXzMpICovCisKKwkvKiBBID0gWjEg
wrcgWjIgKi8KKwljdHgtPm11bG0oQSwgWjEsIFoyLCBjdHgpOworCisJLyogQiA9IEFeMiAqLwor
CWN0eC0+cG93MihCLCBBLCBjdHgpOworCisJLyogQyA9IFgxIMK3IFgyICovCisJY3R4LT5tdWxt
KEMsIFgxLCBYMiwgY3R4KTsKKworCS8qIEQgPSBZMSDCtyBZMiAqLworCWN0eC0+bXVsbShELCBZ
MSwgWTIsIGN0eCk7CisKKwkvKiBFID0gZCDCtyBDIMK3IEQgKi8KKwljdHgtPm11bG0oRSwgY3R4
LT5iLCBDLCBjdHgpOworCWN0eC0+bXVsbShFLCBFLCBELCBjdHgpOworCisJLyogRiA9IEIgLSBF
ICovCisJY3R4LT5zdWJtKEYsIEIsIEUsIGN0eCk7CisKKwkvKiBHID0gQiArIEUgKi8KKwljdHgt
PmFkZG0oRywgQiwgRSwgY3R4KTsKKworCS8qIFhfMyA9IEEgwrcgRiDCtyAoKFhfMSArIFlfMSkg
wrcgKFhfMiArIFlfMikgLSBDIC0gRCkgKi8KKwljdHgtPmFkZG0odG1wLCBYMSwgWTEsIGN0eCk7
CisJY3R4LT5hZGRtKFgzLCBYMiwgWTIsIGN0eCk7CisJY3R4LT5tdWxtKFgzLCBYMywgdG1wLCBj
dHgpOworCWN0eC0+c3VibShYMywgWDMsIEMsIGN0eCk7CisJY3R4LT5zdWJtKFgzLCBYMywgRCwg
Y3R4KTsKKwljdHgtPm11bG0oWDMsIFgzLCBGLCBjdHgpOworCWN0eC0+bXVsbShYMywgWDMsIEEs
IGN0eCk7CisKKwkvKiBZXzMgPSBBIMK3IEcgwrcgKEQgLSBhQykgKi8KKwlpZiAoY3R4LT5kaWFs
ZWN0ID09IEVDQ19ESUFMRUNUX0VEMjU1MTkpIHsKKwkJY3R4LT5hZGRtKFkzLCBELCBDLCBjdHgp
OworCX0gZWxzZSB7CisJCWN0eC0+bXVsbShZMywgY3R4LT5hLCBDLCBjdHgpOworCQljdHgtPnN1
Ym0oWTMsIEQsIFkzLCBjdHgpOworCX0KKwljdHgtPm11bG0oWTMsIFkzLCBHLCBjdHgpOworCWN0
eC0+bXVsbShZMywgWTMsIEEsIGN0eCk7CisKKwkvKiBaXzMgPSBGIMK3IEcgKi8KKwljdHgtPm11
bG0oWjMsIEYsIEcsIGN0eCk7CisKKworI3VuZGVmIFgxCisjdW5kZWYgWTEKKyN1bmRlZiBaMQor
I3VuZGVmIFgyCisjdW5kZWYgWTIKKyN1bmRlZiBaMgorI3VuZGVmIFgzCisjdW5kZWYgWTMKKyN1
bmRlZiBaMworI3VuZGVmIEEKKyN1bmRlZiBCCisjdW5kZWYgQworI3VuZGVmIEQKKyN1bmRlZiBF
CisjdW5kZWYgRgorI3VuZGVmIEcKKyN1bmRlZiB0bXAKK30KKworLyogQ29tcHV0ZSBhIHN0ZXAg
b2YgTW9udGdvbWVyeSBMYWRkZXIgKG9ubHkgdXNlIFggYW5kIFogaW4gdGhlIHBvaW50KS4KKyAq
IElucHV0czogIFAxLCBQMiwgYW5kIHgtY29vcmRpbmF0ZSBvZiBESUYgPSBQMSAtIFAxLgorICog
T3V0cHV0czogUFJEID0gMiAqIFAxIGFuZCAgU1VNID0gUDEgKyBQMi4KKyAqLworc3RhdGljIHZv
aWQgbW9udGdvbWVyeV9sYWRkZXIoTVBJX1BPSU5UIHByZCwgTVBJX1BPSU5UIHN1bSwKKwkJTVBJ
X1BPSU5UIHAxLCBNUElfUE9JTlQgcDIsIE1QSSBkaWZfeCwKKwkJc3RydWN0IG1waV9lY19jdHgg
KmN0eCkKK3sKKwljdHgtPmFkZG0oc3VtLT54LCBwMi0+eCwgcDItPnosIGN0eCk7CisJY3R4LT5z
dWJtKHAyLT56LCBwMi0+eCwgcDItPnosIGN0eCk7CisJY3R4LT5hZGRtKHByZC0+eCwgcDEtPngs
IHAxLT56LCBjdHgpOworCWN0eC0+c3VibShwMS0+eiwgcDEtPngsIHAxLT56LCBjdHgpOworCWN0
eC0+bXVsbShwMi0+eCwgcDEtPnosIHN1bS0+eCwgY3R4KTsKKwljdHgtPm11bG0ocDItPnosIHBy
ZC0+eCwgcDItPnosIGN0eCk7CisJY3R4LT5wb3cyKHAxLT54LCBwcmQtPngsIGN0eCk7CisJY3R4
LT5wb3cyKHAxLT56LCBwMS0+eiwgY3R4KTsKKwljdHgtPmFkZG0oc3VtLT54LCBwMi0+eCwgcDIt
PnosIGN0eCk7CisJY3R4LT5zdWJtKHAyLT56LCBwMi0+eCwgcDItPnosIGN0eCk7CisJY3R4LT5t
dWxtKHByZC0+eCwgcDEtPngsIHAxLT56LCBjdHgpOworCWN0eC0+c3VibShwMS0+eiwgcDEtPngs
IHAxLT56LCBjdHgpOworCWN0eC0+cG93MihzdW0tPngsIHN1bS0+eCwgY3R4KTsKKwljdHgtPnBv
dzIoc3VtLT56LCBwMi0+eiwgY3R4KTsKKwljdHgtPm11bG0ocHJkLT56LCBwMS0+eiwgY3R4LT5h
LCBjdHgpOyAvKiBDVFgtPkE6IChhLTIpLzQgKi8KKwljdHgtPm11bG0oc3VtLT56LCBzdW0tPnos
IGRpZl94LCBjdHgpOworCWN0eC0+YWRkbShwcmQtPnosIHAxLT54LCBwcmQtPnosIGN0eCk7CisJ
Y3R4LT5tdWxtKHByZC0+eiwgcHJkLT56LCBwMS0+eiwgY3R4KTsKK30KKworLyogUkVTVUxUID0g
UDEgKyBQMiAqLwordm9pZCBtcGlfZWNfYWRkX3BvaW50cyhNUElfUE9JTlQgcmVzdWx0LAorCQlN
UElfUE9JTlQgcDEsIE1QSV9QT0lOVCBwMiwKKwkJc3RydWN0IG1waV9lY19jdHggKmN0eCkKK3sK
Kwlzd2l0Y2ggKGN0eC0+bW9kZWwpIHsKKwljYXNlIE1QSV9FQ19XRUlFUlNUUkFTUzoKKwkJYWRk
X3BvaW50c193ZWllcnN0cmFzcyhyZXN1bHQsIHAxLCBwMiwgY3R4KTsKKwkJYnJlYWs7CisJY2Fz
ZSBNUElfRUNfTU9OVEdPTUVSWToKKwkJYWRkX3BvaW50c19tb250Z29tZXJ5KHJlc3VsdCwgcDEs
IHAyLCBjdHgpOworCQlicmVhazsKKwljYXNlIE1QSV9FQ19FRFdBUkRTOgorCQlhZGRfcG9pbnRz
X2Vkd2FyZHMocmVzdWx0LCBwMSwgcDIsIGN0eCk7CisJCWJyZWFrOworCX0KK30KK0VYUE9SVF9T
WU1CT0xfR1BMKG1waV9lY19hZGRfcG9pbnRzKTsKKworLyogU2NhbGFyIHBvaW50IG11bHRpcGxp
Y2F0aW9uIC0gdGhlIG1haW4gZnVuY3Rpb24gZm9yIEVDQy4gIElmIHRha2VzCisgKiBhbiBpbnRl
Z2VyIFNDQUxBUiBhbmQgYSBQT0lOVCBhcyB3ZWxsIGFzIHRoZSB1c3VhbCBjb250ZXh0IENUWC4K
KyAqIFJFU1VMVCB3aWxsIGJlIHNldCB0byB0aGUgcmVzdWx0aW5nIHBvaW50LgorICovCit2b2lk
IG1waV9lY19tdWxfcG9pbnQoTVBJX1BPSU5UIHJlc3VsdCwKKwkJCU1QSSBzY2FsYXIsIE1QSV9Q
T0lOVCBwb2ludCwKKwkJCXN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJTVBJIHgxLCB5MSwg
ejEsIGssIGgsIHl5OworCXVuc2lnbmVkIGludCBpLCBsb29wczsKKwlzdHJ1Y3QgZ2NyeV9tcGlf
cG9pbnQgcDEsIHAyLCBwMWludjsKKworCWlmIChjdHgtPm1vZGVsID09IE1QSV9FQ19FRFdBUkRT
KSB7CisJCS8qIFNpbXBsZSBsZWZ0IHRvIHJpZ2h0IGJpbmFyeSBtZXRob2QuICBBbGdvcml0aG0g
My4yNyBmcm9tCisJCSAqIHthdXRob3I9e0hhbmtlcnNvbiwgRGFycmVsIGFuZCBNZW5lemVzLCBB
bGZyZWQgSi4gYW5kIFZhbnN0b25lLCBTY290dH0sCisJCSAqICB0aXRsZSA9IHtHdWlkZSB0byBF
bGxpcHRpYyBDdXJ2ZSBDcnlwdG9ncmFwaHl9LAorCQkgKiAgeWVhciA9IHsyMDAzfSwgaXNibiA9
IHswMzg3OTUyNzNYfSwKKwkJICogIHVybCA9IHtodHRwOi8vd3d3LmNhY3IubWF0aC51d2F0ZXJs
b28uY2EvZWNjL30sCisJCSAqICBwdWJsaXNoZXIgPSB7U3ByaW5nZXItVmVybGFnIE5ldyBZb3Jr
LCBJbmMufX0KKwkJICovCisJCXVuc2lnbmVkIGludCBuYml0czsKKwkJaW50IGo7CisKKwkJaWYg
KG1waV9jbXAoc2NhbGFyLCBjdHgtPnApID49IDApCisJCQluYml0cyA9IG1waV9nZXRfbmJpdHMo
c2NhbGFyKTsKKwkJZWxzZQorCQkJbmJpdHMgPSBtcGlfZ2V0X25iaXRzKGN0eC0+cCk7CisKKwkJ
bXBpX3NldF91aShyZXN1bHQtPngsIDApOworCQltcGlfc2V0X3VpKHJlc3VsdC0+eSwgMSk7CisJ
CW1waV9zZXRfdWkocmVzdWx0LT56LCAxKTsKKwkJcG9pbnRfcmVzaXplKHBvaW50LCBjdHgpOwor
CisJCXBvaW50X3Jlc2l6ZShyZXN1bHQsIGN0eCk7CisJCXBvaW50X3Jlc2l6ZShwb2ludCwgY3R4
KTsKKworCQlmb3IgKGogPSBuYml0cy0xOyBqID49IDA7IGotLSkgeworCQkJbXBpX2VjX2R1cF9w
b2ludChyZXN1bHQsIHJlc3VsdCwgY3R4KTsKKwkJCWlmIChtcGlfdGVzdF9iaXQoc2NhbGFyLCBq
KSkKKwkJCQltcGlfZWNfYWRkX3BvaW50cyhyZXN1bHQsIHJlc3VsdCwgcG9pbnQsIGN0eCk7CisJ
CX0KKwkJcmV0dXJuOworCX0gZWxzZSBpZiAoY3R4LT5tb2RlbCA9PSBNUElfRUNfTU9OVEdPTUVS
WSkgeworCQl1bnNpZ25lZCBpbnQgbmJpdHM7CisJCWludCBqOworCQlzdHJ1Y3QgZ2NyeV9tcGlf
cG9pbnQgcDFfLCBwMl87CisJCU1QSV9QT0lOVCBxMSwgcTIsIHByZCwgc3VtOworCQl1bnNpZ25l
ZCBsb25nIHN3OworCQltcGlfc2l6ZV90IHJzaXplOworCQlpbnQgc2NhbGFyX2NvcGllZCA9IDA7
CisKKwkJLyogQ29tcHV0ZSBzY2FsYXIgcG9pbnQgbXVsdGlwbGljYXRpb24gd2l0aCBNb250Z29t
ZXJ5IExhZGRlci4KKwkJICogTm90ZSB0aGF0IHdlIGRvbid0IHVzZSBZLWNvb3JkaW5hdGUgaW4g
dGhlIHBvaW50cyBhdCBhbGwuCisJCSAqIFJFU1VMVC0+WSB3aWxsIGJlIGZpbGxlZCBieSB6ZXJv
LgorCQkgKi8KKworCQluYml0cyA9IG1waV9nZXRfbmJpdHMoc2NhbGFyKTsKKwkJcG9pbnRfaW5p
dCgmcDEpOworCQlwb2ludF9pbml0KCZwMik7CisJCXBvaW50X2luaXQoJnAxXyk7CisJCXBvaW50
X2luaXQoJnAyXyk7CisJCW1waV9zZXRfdWkocDEueCwgMSk7CisJCW1waV9mcmVlKHAyLngpOwor
CQlwMi54ID0gbXBpX2NvcHkocG9pbnQtPngpOworCQltcGlfc2V0X3VpKHAyLnosIDEpOworCisJ
CXBvaW50X3Jlc2l6ZSgmcDEsIGN0eCk7CisJCXBvaW50X3Jlc2l6ZSgmcDIsIGN0eCk7CisJCXBv
aW50X3Jlc2l6ZSgmcDFfLCBjdHgpOworCQlwb2ludF9yZXNpemUoJnAyXywgY3R4KTsKKworCQlt
cGlfcmVzaXplKHBvaW50LT54LCBjdHgtPnAtPm5saW1icyk7CisJCXBvaW50LT54LT5ubGltYnMg
PSBjdHgtPnAtPm5saW1iczsKKworCQlxMSA9ICZwMTsKKwkJcTIgPSAmcDI7CisJCXByZCA9ICZw
MV87CisJCXN1bSA9ICZwMl87CisKKwkJZm9yIChqID0gbmJpdHMtMTsgaiA+PSAwOyBqLS0pIHsK
KwkJCU1QSV9QT0lOVCB0OworCisJCQlzdyA9IG1waV90ZXN0X2JpdChzY2FsYXIsIGopOworCQkJ
cG9pbnRfc3dhcF9jb25kKHExLCBxMiwgc3csIGN0eCk7CisJCQltb250Z29tZXJ5X2xhZGRlcihw
cmQsIHN1bSwgcTEsIHEyLCBwb2ludC0+eCwgY3R4KTsKKwkJCXBvaW50X3N3YXBfY29uZChwcmQs
IHN1bSwgc3csIGN0eCk7CisJCQl0ID0gcTE7ICBxMSA9IHByZDsgIHByZCA9IHQ7CisJCQl0ID0g
cTI7ICBxMiA9IHN1bTsgIHN1bSA9IHQ7CisJCX0KKworCQltcGlfY2xlYXIocmVzdWx0LT55KTsK
KwkJc3cgPSAobmJpdHMgJiAxKTsKKwkJcG9pbnRfc3dhcF9jb25kKCZwMSwgJnAxXywgc3csIGN0
eCk7CisKKwkJcnNpemUgPSBwMS56LT5ubGltYnM7CisJCU1QTl9OT1JNQUxJWkUocDEuei0+ZCwg
cnNpemUpOworCQlpZiAocnNpemUgPT0gMCkgeworCQkJbXBpX3NldF91aShyZXN1bHQtPngsIDEp
OworCQkJbXBpX3NldF91aShyZXN1bHQtPnosIDApOworCQl9IGVsc2UgeworCQkJejEgPSBtcGlf
bmV3KDApOworCQkJZWNfaW52bSh6MSwgcDEueiwgY3R4KTsKKwkJCWVjX211bG0ocmVzdWx0LT54
LCBwMS54LCB6MSwgY3R4KTsKKwkJCW1waV9zZXRfdWkocmVzdWx0LT56LCAxKTsKKwkJCW1waV9m
cmVlKHoxKTsKKwkJfQorCisJCXBvaW50X2ZyZWUoJnAxKTsKKwkJcG9pbnRfZnJlZSgmcDIpOwor
CQlwb2ludF9mcmVlKCZwMV8pOworCQlwb2ludF9mcmVlKCZwMl8pOworCQlpZiAoc2NhbGFyX2Nv
cGllZCkKKwkJCW1waV9mcmVlKHNjYWxhcik7CisJCXJldHVybjsKKwl9CisKKwl4MSA9IG1waV9h
bGxvY19saWtlKGN0eC0+cCk7CisJeTEgPSBtcGlfYWxsb2NfbGlrZShjdHgtPnApOworCWggID0g
bXBpX2FsbG9jX2xpa2UoY3R4LT5wKTsKKwlrICA9IG1waV9jb3B5KHNjYWxhcik7CisJeXkgPSBt
cGlfY29weShwb2ludC0+eSk7CisKKwlpZiAobXBpX2hhc19zaWduKGspKSB7CisJCWstPnNpZ24g
PSAwOworCQllY19pbnZtKHl5LCB5eSwgY3R4KTsKKwl9CisKKwlpZiAoIW1waV9jbXBfdWkocG9p
bnQtPnosIDEpKSB7CisJCW1waV9zZXQoeDEsIHBvaW50LT54KTsKKwkJbXBpX3NldCh5MSwgeXkp
OworCX0gZWxzZSB7CisJCU1QSSB6MiwgejM7CisKKwkJejIgPSBtcGlfYWxsb2NfbGlrZShjdHgt
PnApOworCQl6MyA9IG1waV9hbGxvY19saWtlKGN0eC0+cCk7CisJCWVjX211bG0oejIsIHBvaW50
LT56LCBwb2ludC0+eiwgY3R4KTsKKwkJZWNfbXVsbSh6MywgcG9pbnQtPnosIHoyLCBjdHgpOwor
CQllY19pbnZtKHoyLCB6MiwgY3R4KTsKKwkJZWNfbXVsbSh4MSwgcG9pbnQtPngsIHoyLCBjdHgp
OworCQllY19pbnZtKHozLCB6MywgY3R4KTsKKwkJZWNfbXVsbSh5MSwgeXksIHozLCBjdHgpOwor
CQltcGlfZnJlZSh6Mik7CisJCW1waV9mcmVlKHozKTsKKwl9CisJejEgPSBtcGlfY29weShtcGlf
Y29uc3QoTVBJX0NfT05FKSk7CisKKwltcGlfbXVsKGgsIGssIG1waV9jb25zdChNUElfQ19USFJF
RSkpOyAvKiBoID0gM2sgKi8KKwlsb29wcyA9IG1waV9nZXRfbmJpdHMoaCk7CisJaWYgKGxvb3Bz
IDwgMikgeworCQkvKiBJZiBTQ0FMQVIgaXMgemVybywgdGhlIGFib3ZlIG1waV9tdWwgc2V0cyBI
IHRvIHplcm8gYW5kIHRodXMKKwkJICogTE9PUHMgd2lsbCBiZSB6ZXJvLiAgVG8gYXZvaWQgYW4g
dW5kZXJmbG93IG9mIEkgaW4gdGhlIG1haW4KKwkJICogbG9vcCB3ZSBzZXQgTE9PUCB0byAyIGFu
ZCB0aGUgcmVzdWx0IHRvICgwLDAsMCkuCisJCSAqLworCQlsb29wcyA9IDI7CisJCW1waV9jbGVh
cihyZXN1bHQtPngpOworCQltcGlfY2xlYXIocmVzdWx0LT55KTsKKwkJbXBpX2NsZWFyKHJlc3Vs
dC0+eik7CisJfSBlbHNlIHsKKwkJbXBpX3NldChyZXN1bHQtPngsIHBvaW50LT54KTsKKwkJbXBp
X3NldChyZXN1bHQtPnksIHl5KTsKKwkJbXBpX3NldChyZXN1bHQtPnosIHBvaW50LT56KTsKKwl9
CisJbXBpX2ZyZWUoeXkpOyB5eSA9IE5VTEw7CisKKwlwMS54ID0geDE7IHgxID0gTlVMTDsKKwlw
MS55ID0geTE7IHkxID0gTlVMTDsKKwlwMS56ID0gejE7IHoxID0gTlVMTDsKKwlwb2ludF9pbml0
KCZwMik7CisJcG9pbnRfaW5pdCgmcDFpbnYpOworCisJLyogSW52ZXJ0IHBvaW50OiB5ID0gcCAt
IHkgbW9kIHAgICovCisJcG9pbnRfc2V0KCZwMWludiwgJnAxKTsKKwllY19zdWJtKHAxaW52Lnks
IGN0eC0+cCwgcDFpbnYueSwgY3R4KTsKKworCWZvciAoaSA9IGxvb3BzLTI7IGkgPiAwOyBpLS0p
IHsKKwkJbXBpX2VjX2R1cF9wb2ludChyZXN1bHQsIHJlc3VsdCwgY3R4KTsKKwkJaWYgKG1waV90
ZXN0X2JpdChoLCBpKSA9PSAxICYmIG1waV90ZXN0X2JpdChrLCBpKSA9PSAwKSB7CisJCQlwb2lu
dF9zZXQoJnAyLCByZXN1bHQpOworCQkJbXBpX2VjX2FkZF9wb2ludHMocmVzdWx0LCAmcDIsICZw
MSwgY3R4KTsKKwkJfQorCQlpZiAobXBpX3Rlc3RfYml0KGgsIGkpID09IDAgJiYgbXBpX3Rlc3Rf
Yml0KGssIGkpID09IDEpIHsKKwkJCXBvaW50X3NldCgmcDIsIHJlc3VsdCk7CisJCQltcGlfZWNf
YWRkX3BvaW50cyhyZXN1bHQsICZwMiwgJnAxaW52LCBjdHgpOworCQl9CisJfQorCisJcG9pbnRf
ZnJlZSgmcDEpOworCXBvaW50X2ZyZWUoJnAyKTsKKwlwb2ludF9mcmVlKCZwMWludik7CisJbXBp
X2ZyZWUoaCk7CisJbXBpX2ZyZWUoayk7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChtcGlfZWNfbXVs
X3BvaW50KTsKKworLyogUmV0dXJuIHRydWUgaWYgUE9JTlQgaXMgb24gdGhlIGN1cnZlIGRlc2Ny
aWJlZCBieSBDVFguICAqLworaW50IG1waV9lY19jdXJ2ZV9wb2ludChNUElfUE9JTlQgcG9pbnQs
IHN0cnVjdCBtcGlfZWNfY3R4ICpjdHgpCit7CisJaW50IHJlcyA9IDA7CisJTVBJIHgsIHksIHc7
CisKKwl4ID0gbXBpX25ldygwKTsKKwl5ID0gbXBpX25ldygwKTsKKwl3ID0gbXBpX25ldygwKTsK
KworCS8qIENoZWNrIHRoYXQgdGhlIHBvaW50IGlzIGluIHJhbmdlLiAgVGhpcyBuZWVkcyB0byBi
ZSBkb25lIGhlcmUgYW5kCisJICogbm90IGFmdGVyIGNvbnZlcnNpb24gdG8gYWZmaW5lIGNvb3Jk
aW5hdGVzLgorCSAqLworCWlmIChtcGlfY21wYWJzKHBvaW50LT54LCBjdHgtPnApID49IDApCisJ
CWdvdG8gbGVhdmU7CisJaWYgKG1waV9jbXBhYnMocG9pbnQtPnksIGN0eC0+cCkgPj0gMCkKKwkJ
Z290byBsZWF2ZTsKKwlpZiAobXBpX2NtcGFicyhwb2ludC0+eiwgY3R4LT5wKSA+PSAwKQorCQln
b3RvIGxlYXZlOworCisJc3dpdGNoIChjdHgtPm1vZGVsKSB7CisJY2FzZSBNUElfRUNfV0VJRVJT
VFJBU1M6CisJCXsKKwkJCU1QSSB4eHg7CisKKwkJCWlmIChtcGlfZWNfZ2V0X2FmZmluZSh4LCB5
LCBwb2ludCwgY3R4KSkKKwkJCQlnb3RvIGxlYXZlOworCisJCQl4eHggPSBtcGlfbmV3KDApOwor
CisJCQkvKiB5XjIgPT0geF4zICsgYcK3eCArIGIgKi8KKwkJCWVjX3BvdzIoeSwgeSwgY3R4KTsK
KworCQkJZWNfcG93Myh4eHgsIHgsIGN0eCk7CisJCQllY19tdWxtKHcsIGN0eC0+YSwgeCwgY3R4
KTsKKwkJCWVjX2FkZG0odywgdywgY3R4LT5iLCBjdHgpOworCQkJZWNfYWRkbSh3LCB3LCB4eHgs
IGN0eCk7CisKKwkJCWlmICghbXBpX2NtcCh5LCB3KSkKKwkJCQlyZXMgPSAxOworCisJCQltcGlf
ZnJlZSh4eHgpOworCQl9CisJCWJyZWFrOworCisJY2FzZSBNUElfRUNfTU9OVEdPTUVSWToKKwkJ
eworI2RlZmluZSB4eCB5CisJCQkvKiBXaXRoIE1vbnRnb21lcnkgY3VydmUsIG9ubHkgWC1jb29y
ZGluYXRlIGlzIHZhbGlkLiAqLworCQkJaWYgKG1waV9lY19nZXRfYWZmaW5lKHgsIE5VTEwsIHBv
aW50LCBjdHgpKQorCQkJCWdvdG8gbGVhdmU7CisKKwkJCS8qIFRoZSBlcXVhdGlvbiBpczogYiAq
IHleMiA9PSB4XjMgKyBhIMK3IHheMiArIHggKi8KKwkJCS8qIFdlIGNoZWNrIGlmIHJpZ2h0IGhh
bmQgaXMgcXVhZHJhdGljIHJlc2lkdWUgb3Igbm90IGJ5CisJCQkgKiBFdWxlcidzIGNyaXRlcmlv
bi4KKwkJCSAqLworCQkJLyogQ1RYLT5BIGhhcyAoYS0yKS80IGFuZCBDVFgtPkIgaGFzIGJeLTEg
Ki8KKwkJCWVjX211bG0odywgY3R4LT5hLCBtcGlfY29uc3QoTVBJX0NfRk9VUiksIGN0eCk7CisJ
CQllY19hZGRtKHcsIHcsIG1waV9jb25zdChNUElfQ19UV08pLCBjdHgpOworCQkJZWNfbXVsbSh3
LCB3LCB4LCBjdHgpOworCQkJZWNfcG93Mih4eCwgeCwgY3R4KTsKKwkJCWVjX2FkZG0odywgdywg
eHgsIGN0eCk7CisJCQllY19hZGRtKHcsIHcsIG1waV9jb25zdChNUElfQ19PTkUpLCBjdHgpOwor
CQkJZWNfbXVsbSh3LCB3LCB4LCBjdHgpOworCQkJZWNfbXVsbSh3LCB3LCBjdHgtPmIsIGN0eCk7
CisjdW5kZWYgeHgKKwkJCS8qIENvbXB1dGUgRXVsZXIncyBjcml0ZXJpb246IHdeKHAtMSkvMiAq
LworI2RlZmluZSBwX21pbnVzMSB5CisJCQllY19zdWJtKHBfbWludXMxLCBjdHgtPnAsIG1waV9j
b25zdChNUElfQ19PTkUpLCBjdHgpOworCQkJbXBpX3JzaGlmdChwX21pbnVzMSwgcF9taW51czEs
IDEpOworCQkJZWNfcG93bSh3LCB3LCBwX21pbnVzMSwgY3R4KTsKKworCQkJcmVzID0gIW1waV9j
bXBfdWkodywgMSk7CisjdW5kZWYgcF9taW51czEKKwkJfQorCQlicmVhazsKKworCWNhc2UgTVBJ
X0VDX0VEV0FSRFM6CisJCXsKKwkJCWlmIChtcGlfZWNfZ2V0X2FmZmluZSh4LCB5LCBwb2ludCwg
Y3R4KSkKKwkJCQlnb3RvIGxlYXZlOworCisJCQltcGlfcmVzaXplKHcsIGN0eC0+cC0+bmxpbWJz
KTsKKwkJCXctPm5saW1icyA9IGN0eC0+cC0+bmxpbWJzOworCisJCQkvKiBhIMK3IHheMiArIHle
MiAtIDEgLSBiIMK3IHheMiDCtyB5XjIgPT0gMCAqLworCQkJY3R4LT5wb3cyKHgsIHgsIGN0eCk7
CisJCQljdHgtPnBvdzIoeSwgeSwgY3R4KTsKKwkJCWlmIChjdHgtPmRpYWxlY3QgPT0gRUNDX0RJ
QUxFQ1RfRUQyNTUxOSkKKwkJCQljdHgtPnN1Ym0odywgY3R4LT5wLCB4LCBjdHgpOworCQkJZWxz
ZQorCQkJCWN0eC0+bXVsbSh3LCBjdHgtPmEsIHgsIGN0eCk7CisJCQljdHgtPmFkZG0odywgdywg
eSwgY3R4KTsKKwkJCWN0eC0+bXVsbSh4LCB4LCB5LCBjdHgpOworCQkJY3R4LT5tdWxtKHgsIHgs
IGN0eC0+YiwgY3R4KTsKKwkJCWN0eC0+c3VibSh3LCB3LCB4LCBjdHgpOworCQkJaWYgKCFtcGlf
Y21wX3VpKHcsIDEpKQorCQkJCXJlcyA9IDE7CisJCX0KKwkJYnJlYWs7CisJfQorCitsZWF2ZToK
KwltcGlfZnJlZSh3KTsKKwltcGlfZnJlZSh4KTsKKwltcGlfZnJlZSh5KTsKKworCXJldHVybiBy
ZXM7Cit9CitFWFBPUlRfU1lNQk9MX0dQTChtcGlfZWNfY3VydmVfcG9pbnQpOwotLSAKMi4xOS4x
LjMuZ2U1NmU0ZjcKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkxpbnV4LXN0bTMyIG1haWxpbmcgbGlzdApMaW51eC1zdG0zMkBzdC1tZC1tYWlsbWFuLnN0
b3JtcmVwbHkuY29tCmh0dHBzOi8vc3QtbWQtbWFpbG1hbi5zdG9ybXJlcGx5LmNvbS9tYWlsbWFu
L2xpc3RpbmZvL2xpbnV4LXN0bTMyCg==
